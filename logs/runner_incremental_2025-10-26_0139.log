nohup: ignoring input
==== Stage 1: forget_inc={0,8,11,40,51}; forget_seen={}; all={0,8,11,40,51,66,67,88,94,57} ====
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:54: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,66,67,88,94,57', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:163: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [00:14<11:55, 14.60s/it]  4%|▍         | 2/50 [00:24<09:22, 11.71s/it]  6%|▌         | 3/50 [00:33<08:21, 10.67s/it]  8%|▊         | 4/50 [00:43<07:48, 10.18s/it] 10%|█         | 5/50 [00:52<07:27,  9.95s/it] 12%|█▏        | 6/50 [01:02<07:08,  9.75s/it][loss] ep 0 it 0 total=8.5977 mle=1.8293 pcon=5.2950 forget=1.4733 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 50 total=8.6425 mle=1.9035 pcon=5.2884 forget=1.4506 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 100 total=8.5285 mle=1.7937 pcon=5.2815 forget=1.4534 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 150 total=8.4503 mle=1.7177 pcon=5.2750 forget=1.4576 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 200 total=8.4973 mle=1.7454 pcon=5.2685 forget=1.4834 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 250 total=8.5017 mle=1.7720 pcon=5.2623 forget=1.4675 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 300 total=8.4491 mle=1.7796 pcon=5.2562 forget=1.4134 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 350 total=8.4942 mle=1.8205 pcon=5.2502 forget=1.4235 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 1 it 10 total=8.4306 mle=1.7634 pcon=5.2445 forget=1.4227 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 60 total=8.4302 mle=1.7535 pcon=5.2386 forget=1.4380 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 110 total=8.3022 mle=1.6299 pcon=5.2328 forget=1.4395 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 160 total=8.3852 mle=1.7728 pcon=5.2273 forget=1.3852 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 210 total=8.5324 mle=1.8929 pcon=5.2216 forget=1.4179 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 260 total=8.5410 mle=1.9198 pcon=5.2166 forget=1.4047 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 310 total=8.5246 mle=1.8776 pcon=5.2118 forget=1.4352 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 360 total=8.4085 mle=1.7378 pcon=5.2067 forget=1.4640 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 2 it 20 total=8.4199 mle=1.7940 pcon=5.2015 forget=1.4244 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 70 total=8.3202 mle=1.7351 pcon=5.1964 forget=1.3887 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 120 total=8.3616 mle=1.7631 pcon=5.1913 forget=1.4071 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 170 total=8.1840 mle=1.5782 pcon=5.1867 forget=1.4191 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 220 total=8.5175 mle=1.9285 pcon=5.1818 forget=1.4072 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 270 total=8.3467 mle=1.7577 pcon=5.1773 forget=1.4117 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 320 total=8.4557 mle=1.8544 pcon=5.1729 forget=1.4285 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 370 total=8.2941 mle=1.7251 pcon=5.1683 forget=1.4006 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 3 it 30 total=8.4086 mle=1.8505 pcon=5.1641 forget=1.3939 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 80 total=8.4611 mle=1.9259 pcon=5.1595 forget=1.3757 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 130 total=8.2602 mle=1.7047 pcon=5.1554 forget=1.4001 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 180 total=8.3622 mle=1.8257 pcon=5.1509 forget=1.3856 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 230 total=8.2369 mle=1.6841 pcon=5.1468 forget=1.4060 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 280 total=8.2285 mle=1.6610 pcon=5.1430 forget=1.4245 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 330 total=8.2956 mle=1.7348 pcon=5.1396 forget=1.4212 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 380 total=8.2171 mle=1.6826 pcon=5.1357 forget=1.3988 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 4 it 40 total=8.1217 mle=1.5626 pcon=5.1320 forget=1.4271 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 90 total=8.2741 mle=1.7434 pcon=5.1285 forget=1.4021 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 140 total=8.1066 mle=1.5868 pcon=5.1249 forget=1.3949 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 190 total=8.4355 mle=1.8984 pcon=5.1214 forget=1.4157 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 240 total=8.3869 mle=1.8174 pcon=5.1180 forget=1.4515 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 290 total=8.2604 mle=1.7326 pcon=5.1146 forget=1.4132 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 340 total=8.1162 mle=1.6129 pcon=5.1113 forget=1.3921 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 5 it 0 total=8.1513 mle=1.6443 pcon=5.1079 forget=1.3991 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 50 total=8.2177 mle=1.7287 pcon=5.1048 forget=1.3842 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 100 total=8.3073 mle=1.7831 pcon=5.1016 forget=1.4226 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 150 total=8.4533 mle=1.9554 pcon=5.0988 forget=1.3991 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 200 total=8.2772 mle=1.7876 pcon=5.0959 forget=1.3937 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 250 total=8.2095 mle=1.7153 pcon=5.0928 forget=1.4013 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 300 total=8.2841 mle=1.8000 pcon=5.0902 forget=1.3939 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 350 total=8.2352 mle=1.7382 pcon=5.0871 forget=1.4098 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 6 it 10 total=8.3860 mle=1.9009 pcon=5.0839 forget=1.4013 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 60 total=8.1605 mle=1.6960 pcon=5.0813 forget=1.3831 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 110 total=8.1229 mle=1.6665 pcon=5.0788 forget=1.3776 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 160 total=8.2217 mle=1.7503 pcon=5.0764 forget=1.3950 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 210 total=8.2964 mle=1.8401 pcon=5.0734 forget=1.3829 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 260 total=8.3773 mle=1.9181 pcon=5.0710 forget=1.3882 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 310 total=8.3628 mle=1.8856 pcon=5.0684 forget=1.4088 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 360 total=8.2491 mle=1.7967 pcon=5.0662 forget=1.3862 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 14%|█▍        | 7/50 [01:11<06:52,  9.60s/it] 16%|█▌        | 8/50 [01:20<06:42,  9.58s/it] 18%|█▊        | 9/50 [01:30<06:27,  9.46s/it] 20%|██        | 10/50 [01:39<06:22,  9.57s/it] 22%|██▏       | 11/50 [01:49<06:17,  9.68s/it] 24%|██▍       | 12/50 [01:59<06:08,  9.70s/it] 26%|██▌       | 13/50 [02:09<06:03,  9.84s/it] 28%|██▊       | 14/50 [02:19<05:51,  9.75s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 7 it 20 total=8.1651 mle=1.6983 pcon=5.0637 forget=1.4032 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 70 total=8.0089 mle=1.5600 pcon=5.0617 forget=1.3872 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 120 total=8.0508 mle=1.6357 pcon=5.0592 forget=1.3559 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 170 total=8.1335 mle=1.7032 pcon=5.0570 forget=1.3733 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 220 total=8.2959 mle=1.8493 pcon=5.0549 forget=1.3917 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 270 total=8.2142 mle=1.7791 pcon=5.0527 forget=1.3824 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 320 total=8.3026 mle=1.8619 pcon=5.0507 forget=1.3901 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 370 total=8.0247 mle=1.5858 pcon=5.0486 forget=1.3903 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 8 it 30 total=8.1947 mle=1.7237 pcon=5.0467 forget=1.4242 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 80 total=7.9580 mle=1.5442 pcon=5.0444 forget=1.3693 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 130 total=8.2208 mle=1.7863 pcon=5.0425 forget=1.3920 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 180 total=8.1192 mle=1.7035 pcon=5.0402 forget=1.3756 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 230 total=8.0504 mle=1.6567 pcon=5.0382 forget=1.3555 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 280 total=8.0247 mle=1.6261 pcon=5.0358 forget=1.3628 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 330 total=7.9084 mle=1.4992 pcon=5.0337 forget=1.3756 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 380 total=8.4101 mle=2.0014 pcon=5.0317 forget=1.3769 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 9 it 40 total=8.1283 mle=1.7484 pcon=5.0297 forget=1.3502 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 90 total=8.0429 mle=1.6575 pcon=5.0276 forget=1.3579 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 140 total=8.0197 mle=1.6067 pcon=5.0255 forget=1.3875 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 190 total=8.1203 mle=1.7539 pcon=5.0235 forget=1.3429 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 240 total=8.1875 mle=1.7748 pcon=5.0214 forget=1.3913 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 290 total=8.0269 mle=1.6605 pcon=5.0196 forget=1.3468 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 340 total=8.0577 mle=1.6892 pcon=5.0177 forget=1.3509 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 10 it 0 total=7.8118 mle=1.4427 pcon=5.0157 forget=1.3535 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 50 total=7.9853 mle=1.6277 pcon=5.0141 forget=1.3435 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 100 total=8.0957 mle=1.7324 pcon=5.0121 forget=1.3512 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 150 total=8.1066 mle=1.7522 pcon=5.0102 forget=1.3442 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 200 total=7.9429 mle=1.5850 pcon=5.0080 forget=1.3499 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 250 total=8.0002 mle=1.6119 pcon=5.0062 forget=1.3821 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 300 total=7.9237 mle=1.5598 pcon=5.0044 forget=1.3595 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 350 total=7.9532 mle=1.5917 pcon=5.0027 forget=1.3588 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 11 it 10 total=8.0786 mle=1.7014 pcon=5.0008 forget=1.3764 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 60 total=8.0127 mle=1.6511 pcon=4.9992 forget=1.3624 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 110 total=8.0003 mle=1.6281 pcon=4.9977 forget=1.3745 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 160 total=7.9502 mle=1.5927 pcon=4.9958 forget=1.3617 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 210 total=8.0678 mle=1.7044 pcon=4.9942 forget=1.3692 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 260 total=7.9966 mle=1.6250 pcon=4.9930 forget=1.3786 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 310 total=8.1454 mle=1.7753 pcon=4.9914 forget=1.3788 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 360 total=7.9819 mle=1.6020 pcon=4.9899 forget=1.3899 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 20 total=8.0316 mle=1.6249 pcon=4.9885 forget=1.4182 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 70 total=7.8734 mle=1.4835 pcon=4.9873 forget=1.4026 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 120 total=8.0352 mle=1.6382 pcon=4.9860 forget=1.4110 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 170 total=8.1147 mle=1.7008 pcon=4.9848 forget=1.4292 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 220 total=7.9592 mle=1.5588 pcon=4.9837 forget=1.4167 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 270 total=8.0986 mle=1.6935 pcon=4.9827 forget=1.4225 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 320 total=8.2825 mle=1.8547 pcon=4.9819 forget=1.4460 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 370 total=8.2948 mle=1.8803 pcon=4.9807 forget=1.4338 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 30 total=7.9824 mle=1.5548 pcon=4.9799 forget=1.4478 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 80 total=8.1267 mle=1.6889 pcon=4.9790 forget=1.4588 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 130 total=7.9646 mle=1.5161 pcon=4.9779 forget=1.4706 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 180 total=8.0291 mle=1.5463 pcon=4.9770 forget=1.5058 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 230 total=8.1448 mle=1.7026 pcon=4.9759 forget=1.4662 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 280 total=8.0218 mle=1.5656 pcon=4.9746 forget=1.4816 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 330 total=8.1276 mle=1.6745 pcon=4.9735 forget=1.4796 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 380 total=8.1778 mle=1.7235 pcon=4.9723 forget=1.4820 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 40 total=8.1525 mle=1.6823 pcon=4.9708 forget=1.4993 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 30%|███       | 15/50 [02:28<05:38,  9.68s/it] 32%|███▏      | 16/50 [02:38<05:26,  9.60s/it] 34%|███▍      | 17/50 [02:47<05:15,  9.57s/it] 36%|███▌      | 18/50 [02:57<05:07,  9.62s/it] 38%|███▊      | 19/50 [03:06<04:57,  9.58s/it] 40%|████      | 20/50 [03:16<04:48,  9.61s/it] 42%|████▏     | 21/50 [03:26<04:39,  9.62s/it][loss] ep 14 it 90 total=8.1212 mle=1.6694 pcon=4.9696 forget=1.4822 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 140 total=8.0222 mle=1.5562 pcon=4.9679 forget=1.4981 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 190 total=8.0222 mle=1.5637 pcon=4.9662 forget=1.4922 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 240 total=8.1080 mle=1.6610 pcon=4.9645 forget=1.4825 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 290 total=8.0851 mle=1.6156 pcon=4.9626 forget=1.5069 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 340 total=8.3223 mle=1.8475 pcon=4.9608 forget=1.5139 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 0 total=8.1471 mle=1.6926 pcon=4.9583 forget=1.4962 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 50 total=8.0651 mle=1.6299 pcon=4.9558 forget=1.4794 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 100 total=8.0870 mle=1.6929 pcon=4.9536 forget=1.4405 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 150 total=7.9754 mle=1.5498 pcon=4.9508 forget=1.4748 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 200 total=7.9277 mle=1.5404 pcon=4.9482 forget=1.4390 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 250 total=8.0445 mle=1.6472 pcon=4.9459 forget=1.4513 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 300 total=8.0639 mle=1.7184 pcon=4.9432 forget=1.4023 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 350 total=8.0969 mle=1.7927 pcon=4.9404 forget=1.3638 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 16 it 10 total=8.0288 mle=1.7583 pcon=4.9375 forget=1.3330 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 60 total=8.0177 mle=1.7636 pcon=4.9342 forget=1.3198 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 110 total=7.9028 mle=1.6623 pcon=4.9314 forget=1.3091 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 160 total=7.7141 mle=1.5531 pcon=4.9283 forget=1.2328 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 210 total=7.8426 mle=1.6159 pcon=4.9246 forget=1.3022 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 260 total=7.7117 mle=1.5030 pcon=4.9211 forget=1.2875 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 310 total=7.8692 mle=1.6794 pcon=4.9176 forget=1.2722 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 360 total=7.7366 mle=1.6692 pcon=4.9142 forget=1.1532 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 17 it 20 total=7.9050 mle=1.8125 pcon=4.9106 forget=1.1818 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 70 total=7.6181 mle=1.5145 pcon=4.9067 forget=1.1969 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 120 total=7.7064 mle=1.6462 pcon=4.9026 forget=1.1575 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 170 total=7.8326 mle=1.8111 pcon=4.8990 forget=1.1225 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 220 total=7.8255 mle=1.7739 pcon=4.8952 forget=1.1565 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 270 total=7.8368 mle=1.7870 pcon=4.8912 forget=1.1585 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 320 total=7.6958 mle=1.6199 pcon=4.8870 forget=1.1890 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 370 total=7.6827 mle=1.5482 pcon=4.8829 forget=1.2516 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 18 it 30 total=7.6195 mle=1.5255 pcon=4.8787 forget=1.2152 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 80 total=7.8109 mle=1.7960 pcon=4.8748 forget=1.1401 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 130 total=7.6598 mle=1.5752 pcon=4.8704 forget=1.2142 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 180 total=7.6847 mle=1.5673 pcon=4.8663 forget=1.2511 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 230 total=7.5816 mle=1.4955 pcon=4.8620 forget=1.2241 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 280 total=7.6268 mle=1.5675 pcon=4.8574 forget=1.2019 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 330 total=7.8869 mle=1.8130 pcon=4.8530 forget=1.2209 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 380 total=7.7225 mle=1.6930 pcon=4.8485 forget=1.1810 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 19 it 40 total=7.7183 mle=1.5934 pcon=4.8442 forget=1.2806 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 90 total=7.6333 mle=1.6082 pcon=4.8399 forget=1.1852 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 140 total=7.7183 mle=1.6606 pcon=4.8354 forget=1.2223 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 190 total=7.7730 mle=1.7284 pcon=4.8313 forget=1.2133 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 240 total=7.8528 mle=1.8002 pcon=4.8269 forget=1.2256 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 290 total=7.7080 mle=1.5788 pcon=4.8225 forget=1.3067 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 340 total=7.7799 mle=1.6873 pcon=4.8184 forget=1.2742 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 0 total=7.8775 mle=1.8029 pcon=4.8141 forget=1.2604 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 50 total=7.6847 mle=1.6147 pcon=4.8101 forget=1.2600 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 100 total=7.5760 mle=1.4809 pcon=4.8060 forget=1.2890 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 150 total=7.9199 mle=1.8533 pcon=4.8022 forget=1.2643 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 200 total=7.6922 mle=1.6440 pcon=4.7983 forget=1.2499 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 250 total=7.7397 mle=1.6882 pcon=4.7944 forget=1.2571 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 300 total=7.9280 mle=1.9094 pcon=4.7903 forget=1.2283 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 350 total=7.7417 mle=1.7026 pcon=4.7862 forget=1.2529 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 10 total=7.7260 mle=1.6899 pcon=4.7824 forget=1.2538 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 60 total=7.6089 mle=1.5719 pcon=4.7788 forget=1.2582 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 110 total=7.6546 mle=1.6148 pcon=4.7751 forget=1.2647 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 160 total=7.6024 mle=1.5633 pcon=4.7716 forget=1.2674 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 44%|████▍     | 22/50 [03:35<04:29,  9.62s/it] 46%|████▌     | 23/50 [03:46<04:24,  9.81s/it] 48%|████▊     | 24/50 [03:56<04:18,  9.93s/it] 50%|█████     | 25/50 [04:06<04:12, 10.08s/it] 52%|█████▏    | 26/50 [04:16<04:00, 10.04s/it] 54%|█████▍    | 27/50 [04:26<03:52, 10.10s/it] 56%|█████▌    | 28/50 [04:37<03:43, 10.18s/it] 58%|█████▊    | 29/50 [04:47<03:30, 10.04s/it][loss] ep 21 it 210 total=7.7111 mle=1.6548 pcon=4.7683 forget=1.2880 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 260 total=7.8368 mle=1.7907 pcon=4.7651 forget=1.2810 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 310 total=7.7308 mle=1.6721 pcon=4.7619 forget=1.2968 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 360 total=7.8346 mle=1.7552 pcon=4.7591 forget=1.3203 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 20 total=7.7193 mle=1.6534 pcon=4.7563 forget=1.3096 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 70 total=7.5561 mle=1.4855 pcon=4.7536 forget=1.3170 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 120 total=7.5898 mle=1.4952 pcon=4.7511 forget=1.3435 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 170 total=7.6867 mle=1.6013 pcon=4.7487 forget=1.3367 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 220 total=7.8792 mle=1.7922 pcon=4.7463 forget=1.3406 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 270 total=7.8447 mle=1.7490 pcon=4.7439 forget=1.3518 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 320 total=7.7336 mle=1.6291 pcon=4.7418 forget=1.3627 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 370 total=7.8544 mle=1.7483 pcon=4.7396 forget=1.3665 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 30 total=7.9478 mle=1.8297 pcon=4.7377 forget=1.3804 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 80 total=7.7560 mle=1.6435 pcon=4.7357 forget=1.3768 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 130 total=7.8272 mle=1.7205 pcon=4.7336 forget=1.3730 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 180 total=7.8072 mle=1.6973 pcon=4.7319 forget=1.3780 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 230 total=7.8572 mle=1.7483 pcon=4.7301 forget=1.3788 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 280 total=7.7825 mle=1.6513 pcon=4.7284 forget=1.4028 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 330 total=7.9619 mle=1.8584 pcon=4.7267 forget=1.3768 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 380 total=7.7136 mle=1.5976 pcon=4.7253 forget=1.3907 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 40 total=7.7619 mle=1.6425 pcon=4.7236 forget=1.3957 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 90 total=7.8556 mle=1.7468 pcon=4.7220 forget=1.3869 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 140 total=7.8731 mle=1.7593 pcon=4.7203 forget=1.3936 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 190 total=7.8254 mle=1.7096 pcon=4.7187 forget=1.3971 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 240 total=7.8117 mle=1.6991 pcon=4.7173 forget=1.3952 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 290 total=7.6223 mle=1.4956 pcon=4.7159 forget=1.4107 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 340 total=7.6403 mle=1.5366 pcon=4.7147 forget=1.3890 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 0 total=7.7752 mle=1.6531 pcon=4.7132 forget=1.4088 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 50 total=7.8473 mle=1.7342 pcon=4.7120 forget=1.4011 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 100 total=7.6556 mle=1.5470 pcon=4.7108 forget=1.3978 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 150 total=7.8147 mle=1.7161 pcon=4.7096 forget=1.3890 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 200 total=8.0705 mle=1.9514 pcon=4.7083 forget=1.4108 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 250 total=7.9184 mle=1.8318 pcon=4.7070 forget=1.3797 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 300 total=7.6224 mle=1.5236 pcon=4.7058 forget=1.3930 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 350 total=7.7053 mle=1.5978 pcon=4.7048 forget=1.4028 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 10 total=7.8194 mle=1.7404 pcon=4.7036 forget=1.3754 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 60 total=7.7642 mle=1.6672 pcon=4.7023 forget=1.3947 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 110 total=7.6978 mle=1.6278 pcon=4.7014 forget=1.3687 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 160 total=7.7338 mle=1.6693 pcon=4.7004 forget=1.3641 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 210 total=7.7280 mle=1.6656 pcon=4.6995 forget=1.3630 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 260 total=7.6550 mle=1.6116 pcon=4.6985 forget=1.3448 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 310 total=7.7015 mle=1.6527 pcon=4.6975 forget=1.3513 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 360 total=7.6786 mle=1.6031 pcon=4.6964 forget=1.3791 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 20 total=7.7329 mle=1.6833 pcon=4.6954 forget=1.3542 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 70 total=7.6584 mle=1.6164 pcon=4.6945 forget=1.3476 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 120 total=7.6509 mle=1.6142 pcon=4.6934 forget=1.3433 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 170 total=7.6929 mle=1.6581 pcon=4.6925 forget=1.3424 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 220 total=7.7249 mle=1.6934 pcon=4.6915 forget=1.3400 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 270 total=7.8218 mle=1.7934 pcon=4.6905 forget=1.3379 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 320 total=7.5395 mle=1.5136 pcon=4.6898 forget=1.3361 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 370 total=7.7283 mle=1.7098 pcon=4.6887 forget=1.3297 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 28 it 30 total=7.6763 mle=1.6590 pcon=4.6879 forget=1.3294 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 80 total=7.7468 mle=1.7354 pcon=4.6869 forget=1.3246 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 130 total=7.5945 mle=1.5795 pcon=4.6859 forget=1.3291 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 180 total=7.5675 mle=1.5462 pcon=4.6850 forget=1.3363 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 230 total=7.7490 mle=1.7398 pcon=4.6842 forget=1.3251 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 280 total=7.7180 mle=1.7226 pcon=4.6832 forget=1.3122 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 330 total=7.7538 mle=1.7476 pcon=4.6823 forget=1.3239 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 380 total=7.7709 mle=1.7714 pcon=4.6813 forget=1.3182 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 29 it 40 total=7.6406 mle=1.6416 pcon=4.6804 forget=1.3186 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 60%|██████    | 30/50 [04:56<03:18,  9.91s/it] 62%|██████▏   | 31/50 [05:05<03:04,  9.74s/it] 64%|██████▍   | 32/50 [05:15<02:54,  9.71s/it] 66%|██████▌   | 33/50 [05:25<02:47,  9.84s/it] 68%|██████▊   | 34/50 [05:35<02:38,  9.89s/it] 70%|███████   | 35/50 [05:45<02:28,  9.89s/it] 72%|███████▏  | 36/50 [05:55<02:16,  9.76s/it][loss] ep 29 it 90 total=7.6650 mle=1.6749 pcon=4.6797 forget=1.3104 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 140 total=7.9263 mle=1.9381 pcon=4.6787 forget=1.3094 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 190 total=7.4891 mle=1.4928 pcon=4.6780 forget=1.3184 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 240 total=7.6450 mle=1.6599 pcon=4.6772 forget=1.3079 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 290 total=7.5683 mle=1.5808 pcon=4.6763 forget=1.3113 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 340 total=7.6711 mle=1.6850 pcon=4.6754 forget=1.3107 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 30 it 0 total=7.8339 mle=1.8525 pcon=4.6745 forget=1.3068 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 50 total=7.5015 mle=1.5092 pcon=4.6737 forget=1.3187 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 100 total=7.6277 mle=1.6478 pcon=4.6729 forget=1.3070 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 150 total=7.7231 mle=1.7329 pcon=4.6722 forget=1.3180 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 200 total=7.6106 mle=1.6198 pcon=4.6716 forget=1.3192 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 250 total=7.7920 mle=1.8074 pcon=4.6709 forget=1.3138 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 300 total=7.6456 mle=1.6581 pcon=4.6701 forget=1.3174 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 350 total=7.5602 mle=1.5707 pcon=4.6691 forget=1.3203 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 31 it 10 total=7.8689 mle=1.8747 pcon=4.6685 forget=1.3258 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 60 total=7.5630 mle=1.5752 pcon=4.6678 forget=1.3201 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 110 total=7.5473 mle=1.5522 pcon=4.6670 forget=1.3281 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 160 total=7.6238 mle=1.6251 pcon=4.6665 forget=1.3322 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 210 total=7.5831 mle=1.5755 pcon=4.6658 forget=1.3418 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 260 total=7.6357 mle=1.6258 pcon=4.6653 forget=1.3446 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 310 total=7.8061 mle=1.7977 pcon=4.6645 forget=1.3439 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 360 total=7.6500 mle=1.6380 pcon=4.6639 forget=1.3481 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 20 total=7.7238 mle=1.7087 pcon=4.6632 forget=1.3520 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 70 total=7.6562 mle=1.6400 pcon=4.6626 forget=1.3535 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 120 total=7.9729 mle=1.9470 pcon=4.6620 forget=1.3639 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 170 total=7.7764 mle=1.7651 pcon=4.6614 forget=1.3499 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 220 total=7.6689 mle=1.6395 pcon=4.6607 forget=1.3686 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 270 total=7.7808 mle=1.7493 pcon=4.6602 forget=1.3713 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 320 total=7.8144 mle=1.7832 pcon=4.6597 forget=1.3716 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 370 total=7.6980 mle=1.6579 pcon=4.6592 forget=1.3808 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 30 total=7.5987 mle=1.5646 pcon=4.6586 forget=1.3755 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 80 total=7.6116 mle=1.5652 pcon=4.6581 forget=1.3883 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 130 total=7.7106 mle=1.6590 pcon=4.6574 forget=1.3943 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 180 total=7.7612 mle=1.7017 pcon=4.6568 forget=1.4027 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 230 total=7.6936 mle=1.6407 pcon=4.6565 forget=1.3965 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 280 total=7.7800 mle=1.7221 pcon=4.6560 forget=1.4020 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 330 total=7.7437 mle=1.6864 pcon=4.6555 forget=1.4018 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 380 total=7.5534 mle=1.4947 pcon=4.6551 forget=1.4036 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 40 total=7.7698 mle=1.7071 pcon=4.6547 forget=1.4081 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 90 total=7.8017 mle=1.7260 pcon=4.6542 forget=1.4215 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 140 total=7.6923 mle=1.6149 pcon=4.6536 forget=1.4237 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 190 total=7.9120 mle=1.8399 pcon=4.6533 forget=1.4188 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 240 total=7.8421 mle=1.7488 pcon=4.6528 forget=1.4406 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 290 total=7.8999 mle=1.8207 pcon=4.6524 forget=1.4268 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 340 total=7.7218 mle=1.6355 pcon=4.6520 forget=1.4343 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 0 total=7.7618 mle=1.6731 pcon=4.6516 forget=1.4372 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 50 total=7.8556 mle=1.7676 pcon=4.6512 forget=1.4367 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 100 total=7.7821 mle=1.6920 pcon=4.6508 forget=1.4392 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 150 total=7.9539 mle=1.8511 pcon=4.6503 forget=1.4524 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 200 total=7.7975 mle=1.6911 pcon=4.6499 forget=1.4565 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 250 total=7.6480 mle=1.5360 pcon=4.6496 forget=1.4624 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 300 total=7.7455 mle=1.6315 pcon=4.6492 forget=1.4648 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 350 total=7.7688 mle=1.6367 pcon=4.6489 forget=1.4831 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 10 total=7.8007 mle=1.6820 pcon=4.6485 forget=1.4703 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 60 total=7.7531 mle=1.6258 pcon=4.6481 forget=1.4791 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 110 total=7.8982 mle=1.7887 pcon=4.6477 forget=1.4618 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 160 total=7.8448 mle=1.7203 pcon=4.6474 forget=1.4770 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 210 total=7.9222 mle=1.7973 pcon=4.6469 forget=1.4780 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 260 total=7.9205 mle=1.7785 pcon=4.6468 forget=1.4952 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 310 total=7.7070 mle=1.5701 pcon=4.6466 forget=1.4903 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 74%|███████▍  | 37/50 [06:04<02:05,  9.66s/it] 76%|███████▌  | 38/50 [06:14<01:55,  9.63s/it] 78%|███████▊  | 39/50 [06:23<01:46,  9.67s/it] 80%|████████  | 40/50 [06:33<01:37,  9.75s/it] 82%|████████▏ | 41/50 [06:43<01:28,  9.81s/it] 84%|████████▍ | 42/50 [06:53<01:18,  9.84s/it] 86%|████████▌ | 43/50 [07:03<01:09,  9.93s/it] 88%|████████▊ | 44/50 [07:14<01:00, 10.09s/it][loss] ep 36 it 360 total=7.7773 mle=1.6420 pcon=4.6464 forget=1.4888 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 20 total=7.7776 mle=1.6365 pcon=4.6462 forget=1.4949 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 70 total=7.7490 mle=1.6123 pcon=4.6459 forget=1.4909 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 120 total=7.7776 mle=1.6355 pcon=4.6456 forget=1.4964 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 170 total=7.7357 mle=1.5864 pcon=4.6454 forget=1.5038 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 220 total=7.8369 mle=1.6934 pcon=4.6453 forget=1.4982 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 270 total=7.8139 mle=1.6846 pcon=4.6450 forget=1.4843 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 320 total=7.7671 mle=1.6231 pcon=4.6449 forget=1.4990 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 370 total=7.8036 mle=1.6409 pcon=4.6448 forget=1.5179 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 30 total=7.6277 mle=1.4863 pcon=4.6448 forget=1.4966 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 80 total=7.8776 mle=1.7267 pcon=4.6444 forget=1.5065 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 130 total=7.9253 mle=1.7735 pcon=4.6442 forget=1.5076 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 180 total=7.7446 mle=1.5757 pcon=4.6440 forget=1.5249 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 230 total=7.6913 mle=1.5382 pcon=4.6438 forget=1.5093 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 280 total=7.8847 mle=1.7052 pcon=4.6437 forget=1.5358 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 330 total=7.8187 mle=1.6339 pcon=4.6436 forget=1.5412 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 380 total=8.0142 mle=1.8460 pcon=4.6436 forget=1.5247 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 40 total=7.7508 mle=1.5830 pcon=4.6435 forget=1.5243 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 90 total=7.7801 mle=1.6191 pcon=4.6433 forget=1.5177 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 140 total=7.8400 mle=1.6592 pcon=4.6433 forget=1.5376 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 190 total=7.8302 mle=1.6563 pcon=4.6431 forget=1.5307 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 240 total=8.0277 mle=1.8523 pcon=4.6431 forget=1.5323 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 290 total=7.7554 mle=1.5747 pcon=4.6430 forget=1.5377 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 340 total=7.8132 mle=1.6284 pcon=4.6432 forget=1.5416 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 0 total=7.7896 mle=1.6096 pcon=4.6432 forget=1.5368 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 50 total=7.8290 mle=1.6470 pcon=4.6429 forget=1.5391 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 100 total=7.8433 mle=1.6628 pcon=4.6429 forget=1.5376 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 150 total=7.7643 mle=1.5662 pcon=4.6429 forget=1.5552 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 200 total=8.0033 mle=1.7901 pcon=4.6426 forget=1.5705 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 250 total=8.1439 mle=1.9537 pcon=4.6425 forget=1.5478 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 300 total=7.9448 mle=1.7442 pcon=4.6424 forget=1.5582 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 350 total=8.0009 mle=1.8067 pcon=4.6423 forget=1.5519 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 10 total=7.8764 mle=1.6760 pcon=4.6421 forget=1.5582 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 60 total=7.9433 mle=1.7500 pcon=4.6421 forget=1.5512 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 110 total=7.8807 mle=1.6761 pcon=4.6418 forget=1.5628 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 160 total=7.9786 mle=1.7965 pcon=4.6418 forget=1.5403 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 210 total=7.8168 mle=1.6199 pcon=4.6417 forget=1.5552 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 260 total=7.9514 mle=1.7464 pcon=4.6414 forget=1.5636 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 310 total=7.7219 mle=1.5147 pcon=4.6413 forget=1.5658 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 360 total=7.8724 mle=1.6747 pcon=4.6410 forget=1.5568 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 20 total=7.8070 mle=1.5925 pcon=4.6409 forget=1.5735 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 70 total=7.7446 mle=1.5471 pcon=4.6408 forget=1.5566 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 120 total=8.0314 mle=1.8207 pcon=4.6409 forget=1.5698 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 170 total=7.9488 mle=1.7462 pcon=4.6406 forget=1.5621 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 220 total=7.7731 mle=1.5600 pcon=4.6406 forget=1.5725 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 270 total=8.0718 mle=1.8687 pcon=4.6405 forget=1.5625 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 320 total=7.8476 mle=1.6481 pcon=4.6403 forget=1.5592 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 370 total=7.7630 mle=1.5521 pcon=4.6403 forget=1.5706 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 30 total=7.8780 mle=1.6681 pcon=4.6403 forget=1.5696 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 80 total=7.8390 mle=1.6381 pcon=4.6403 forget=1.5606 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 130 total=7.9687 mle=1.7563 pcon=4.6401 forget=1.5723 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 180 total=7.8725 mle=1.6682 pcon=4.6401 forget=1.5642 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 230 total=7.8041 mle=1.6048 pcon=4.6401 forget=1.5592 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 280 total=7.8346 mle=1.6345 pcon=4.6401 forget=1.5600 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 330 total=7.7297 mle=1.5134 pcon=4.6400 forget=1.5764 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 380 total=7.8851 mle=1.6743 pcon=4.6398 forget=1.5710 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 40 total=8.1129 mle=1.8803 pcon=4.6398 forget=1.5927 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 90 total=7.6829 mle=1.4864 pcon=4.6399 forget=1.5566 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 140 total=7.9907 mle=1.7607 pcon=4.6398 forget=1.5902 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 190 total=7.9887 mle=1.7758 pcon=4.6399 forget=1.5730 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 240 total=7.8635 mle=1.6369 pcon=4.6399 forget=1.5867 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 290 total=7.9111 mle=1.6854 pcon=4.6397 forget=1.5859 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 90%|█████████ | 45/50 [07:24<00:51, 10.28s/it] 92%|█████████▏| 46/50 [07:34<00:40, 10.16s/it] 94%|█████████▍| 47/50 [07:44<00:30, 10.15s/it] 96%|█████████▌| 48/50 [07:55<00:20, 10.25s/it] 98%|█████████▊| 49/50 [08:05<00:10, 10.13s/it]100%|██████████| 50/50 [08:15<00:00, 10.24s/it]100%|██████████| 50/50 [08:15<00:00,  9.92s/it]
[loss] ep 44 it 340 total=7.8973 mle=1.6660 pcon=4.6397 forget=1.5916 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 0 total=7.8911 mle=1.6640 pcon=4.6398 forget=1.5874 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 50 total=7.9140 mle=1.6935 pcon=4.6397 forget=1.5807 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 100 total=7.8852 mle=1.6529 pcon=4.6397 forget=1.5926 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 150 total=7.8834 mle=1.6731 pcon=4.6397 forget=1.5706 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 200 total=7.7610 mle=1.5441 pcon=4.6396 forget=1.5772 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 250 total=7.8977 mle=1.6634 pcon=4.6397 forget=1.5946 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 300 total=7.8231 mle=1.6038 pcon=4.6398 forget=1.5795 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 350 total=8.0012 mle=1.7709 pcon=4.6398 forget=1.5905 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 10 total=7.8995 mle=1.6752 pcon=4.6397 forget=1.5846 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 60 total=8.0322 mle=1.8034 pcon=4.6397 forget=1.5891 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 110 total=7.9381 mle=1.7150 pcon=4.6398 forget=1.5833 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 160 total=7.8288 mle=1.5996 pcon=4.6397 forget=1.5895 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 210 total=7.8241 mle=1.5870 pcon=4.6396 forget=1.5974 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 260 total=7.8970 mle=1.6553 pcon=4.6394 forget=1.6023 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 310 total=7.9514 mle=1.7160 pcon=4.6393 forget=1.5960 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 360 total=7.7606 mle=1.5202 pcon=4.6393 forget=1.6011 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 20 total=8.1066 mle=1.8713 pcon=4.6395 forget=1.5959 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 70 total=7.7975 mle=1.5627 pcon=4.6395 forget=1.5953 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 120 total=7.8966 mle=1.6549 pcon=4.6397 forget=1.6020 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 170 total=7.9870 mle=1.7450 pcon=4.6395 forget=1.6024 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 220 total=7.9490 mle=1.7159 pcon=4.6394 forget=1.5936 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 270 total=7.9259 mle=1.6825 pcon=4.6394 forget=1.6040 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 320 total=7.8728 mle=1.6213 pcon=4.6393 forget=1.6122 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 370 total=7.9805 mle=1.7317 pcon=4.6393 forget=1.6094 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 30 total=7.9273 mle=1.6741 pcon=4.6393 forget=1.6139 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 80 total=7.9483 mle=1.7203 pcon=4.6393 forget=1.5887 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 130 total=7.7792 mle=1.5335 pcon=4.6393 forget=1.6064 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 180 total=7.8719 mle=1.6277 pcon=4.6393 forget=1.6049 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 230 total=7.9703 mle=1.7125 pcon=4.6394 forget=1.6184 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 280 total=7.9102 mle=1.6588 pcon=4.6394 forget=1.6120 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 330 total=7.9180 mle=1.6671 pcon=4.6394 forget=1.6115 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 380 total=7.8551 mle=1.6051 pcon=4.6396 forget=1.6104 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 40 total=7.9918 mle=1.7489 pcon=4.6398 forget=1.6031 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 90 total=8.0285 mle=1.7636 pcon=4.6398 forget=1.6251 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 140 total=8.1191 mle=1.8617 pcon=4.6399 forget=1.6175 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 190 total=8.0013 mle=1.7542 pcon=4.6401 forget=1.6070 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 240 total=7.9023 mle=1.6430 pcon=4.6401 forget=1.6193 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 290 total=7.8608 mle=1.6063 pcon=4.6401 forget=1.6144 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 340 total=8.0405 mle=1.7801 pcon=4.6400 forget=1.6205 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-inc1: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:52,  2.26it/s]  3%|▎         | 11/391 [00:00<00:14, 25.73it/s]  5%|▌         | 21/391 [00:00<00:08, 44.15it/s]  8%|▊         | 31/391 [00:00<00:06, 58.30it/s] 10%|█         | 41/391 [00:00<00:05, 68.51it/s] 13%|█▎        | 51/391 [00:00<00:04, 76.34it/s] 16%|█▌        | 61/391 [00:01<00:04, 80.93it/s] 18%|█▊        | 71/391 [00:01<00:03, 84.97it/s] 21%|██        | 81/391 [00:01<00:03, 88.01it/s] 23%|██▎       | 91/391 [00:01<00:03, 89.99it/s] 26%|██▌       | 101/391 [00:01<00:03, 91.44it/s] 28%|██▊       | 111/391 [00:01<00:03, 92.35it/s] 31%|███       | 121/391 [00:01<00:02, 93.02it/s] 34%|███▎      | 131/391 [00:01<00:02, 93.80it/s] 36%|███▌      | 141/391 [00:01<00:02, 94.35it/s] 39%|███▊      | 151/391 [00:02<00:02, 94.70it/s] 41%|████      | 161/391 [00:02<00:02, 95.06it/s] 44%|████▎     | 171/391 [00:02<00:02, 94.86it/s] 46%|████▋     | 181/391 [00:02<00:02, 95.13it/s] 49%|████▉     | 191/391 [00:02<00:02, 95.33it/s] 51%|█████▏    | 201/391 [00:02<00:01, 95.42it/s] 54%|█████▍    | 211/391 [00:02<00:01, 95.41it/s] 57%|█████▋    | 221/391 [00:02<00:01, 95.43it/s] 59%|█████▉    | 231/391 [00:02<00:01, 95.49it/s] 62%|██████▏   | 241/391 [00:02<00:01, 95.48it/s] 64%|██████▍   | 251/391 [00:03<00:01, 95.59it/s] 67%|██████▋   | 261/391 [00:03<00:01, 95.52it/s] 69%|██████▉   | 271/391 [00:03<00:01, 95.33it/s] 72%|███████▏  | 281/391 [00:03<00:01, 95.37it/s] 74%|███████▍  | 291/391 [00:03<00:01, 95.77it/s] 77%|███████▋  | 301/391 [00:03<00:00, 95.51it/s] 80%|███████▉  | 311/391 [00:03<00:00, 95.34it/s] 82%|████████▏ | 321/391 [00:03<00:00, 95.38it/s] 85%|████████▍ | 331/391 [00:03<00:00, 95.55it/s] 87%|████████▋ | 341/391 [00:04<00:00, 95.43it/s] 90%|████████▉ | 351/391 [00:04<00:00, 95.58it/s] 92%|█████████▏| 361/391 [00:04<00:00, 95.11it/s] 95%|█████████▍| 371/391 [00:04<00:00, 95.96it/s] 97%|█████████▋| 381/391 [00:04<00:00, 96.55it/s]100%|██████████| 391/391 [00:04<00:00, 94.60it/s]100%|██████████| 391/391 [00:04<00:00, 86.13it/s]
50000 images processed, 4.642476797103882 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.19it/s] 10%|█         | 8/79 [00:00<00:03, 18.22it/s] 23%|██▎       | 18/79 [00:00<00:01, 38.32it/s] 35%|███▌      | 28/79 [00:00<00:00, 53.48it/s] 48%|████▊     | 38/79 [00:00<00:00, 64.94it/s] 61%|██████    | 48/79 [00:00<00:00, 73.32it/s] 73%|███████▎  | 58/79 [00:01<00:00, 79.87it/s] 86%|████████▌ | 68/79 [00:01<00:00, 84.61it/s] 99%|█████████▊| 78/79 [00:01<00:00, 87.97it/s]100%|██████████| 79/79 [00:02<00:00, 39.27it/s]
10000 images processed, 2.044412851333618 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-inc1/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:37,  2.08it/s]  5%|▌         | 11/204 [00:00<00:08, 24.02it/s] 10%|█         | 21/204 [00:00<00:04, 41.83it/s] 15%|█▌        | 31/204 [00:00<00:03, 55.97it/s] 20%|██        | 41/204 [00:00<00:02, 66.77it/s] 25%|██▌       | 51/204 [00:01<00:02, 74.76it/s] 30%|██▉       | 61/204 [00:01<00:01, 80.54it/s] 35%|███▍      | 71/204 [00:01<00:01, 84.59it/s] 40%|███▉      | 81/204 [00:01<00:01, 87.59it/s] 45%|████▍     | 91/204 [00:01<00:01, 89.70it/s] 50%|████▉     | 101/204 [00:01<00:01, 91.29it/s] 54%|█████▍    | 111/204 [00:01<00:01, 92.37it/s] 59%|█████▉    | 121/204 [00:01<00:00, 93.28it/s] 64%|██████▍   | 131/204 [00:01<00:00, 94.04it/s] 69%|██████▉   | 141/204 [00:01<00:00, 94.32it/s] 74%|███████▍  | 151/204 [00:02<00:00, 94.25it/s] 79%|███████▉  | 161/204 [00:02<00:00, 94.27it/s] 84%|████████▍ | 171/204 [00:02<00:00, 94.15it/s] 89%|████████▊ | 181/204 [00:02<00:00, 94.65it/s] 94%|█████████▎| 191/204 [00:02<00:00, 95.34it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.83it/s]100%|██████████| 204/204 [00:02<00:00, 77.82it/s]
26032 images processed, 2.6606271266937256 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.59it/s] 10%|█         | 8/79 [00:00<00:05, 14.04it/s] 23%|██▎       | 18/79 [00:00<00:01, 31.30it/s] 32%|███▏      | 25/79 [00:00<00:01, 39.71it/s] 44%|████▍     | 35/79 [00:01<00:00, 49.50it/s] 57%|█████▋    | 45/79 [00:01<00:00, 60.79it/s] 67%|██████▋   | 53/79 [00:01<00:00, 61.62it/s] 80%|███████▉  | 63/79 [00:01<00:00, 70.55it/s] 92%|█████████▏| 73/79 [00:01<00:00, 77.66it/s]100%|██████████| 79/79 [00:01<00:00, 49.93it/s]
10000 images processed, 1.615358591079712 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.91it/s] 14%|█▍        | 11/79 [00:00<00:03, 22.44it/s] 27%|██▋       | 21/79 [00:00<00:01, 39.51it/s] 39%|███▉      | 31/79 [00:00<00:00, 53.23it/s] 52%|█████▏    | 41/79 [00:00<00:00, 63.70it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.93it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.75it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.75it/s]100%|██████████| 79/79 [00:01<00:00, 58.53it/s]
10000 images processed, 1.3692615032196045 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  1.99it/s] 16%|█▌        | 11/70 [00:00<00:02, 23.39it/s] 30%|███       | 21/70 [00:00<00:01, 41.10it/s] 44%|████▍     | 31/70 [00:00<00:00, 55.13it/s] 59%|█████▊    | 41/70 [00:00<00:00, 65.89it/s] 73%|███████▎  | 51/70 [00:01<00:00, 74.46it/s] 87%|████████▋ | 61/70 [00:01<00:00, 80.85it/s]100%|██████████| 70/70 [00:01<00:00, 57.02it/s]
8925 images processed, 1.2568254470825195 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:45,  1.04s/it] 20%|██        | 9/45 [00:01<00:03, 10.53it/s] 31%|███       | 14/45 [00:01<00:01, 16.20it/s] 42%|████▏     | 19/45 [00:01<00:01, 13.28it/s] 64%|██████▍   | 29/45 [00:01<00:00, 24.41it/s] 78%|███████▊  | 35/45 [00:02<00:00, 17.67it/s]100%|██████████| 45/45 [00:02<00:00, 27.03it/s]100%|██████████| 45/45 [00:02<00:00, 18.14it/s]
5640 images processed, 2.502443790435791 seconds used

17.691163539886475
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.46  98.78
places365     72.69  79.75
LSUN          27.04  94.19
iSUN          76.18  79.50
dtd           47.15  89.36
AVG           45.70  88.31
Retain-Acc: 0.7385
Forget-as-OOD (retain known vs forget novel):
  FPR: 38.00 AUROC: 88.86 AUIN: 99.23
7.761035919189453
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-inc1_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-inc1_rf.png
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-seen: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:56,  2.21it/s]  3%|▎         | 11/391 [00:00<00:14, 25.45it/s]  5%|▌         | 21/391 [00:00<00:08, 43.97it/s]  8%|▊         | 31/391 [00:00<00:06, 58.09it/s] 10%|█         | 41/391 [00:00<00:05, 68.78it/s] 13%|█▎        | 51/391 [00:00<00:04, 76.74it/s] 16%|█▌        | 61/391 [00:01<00:03, 82.51it/s] 18%|█▊        | 71/391 [00:01<00:03, 86.68it/s] 21%|██        | 81/391 [00:01<00:03, 89.39it/s] 23%|██▎       | 91/391 [00:01<00:03, 91.58it/s] 26%|██▌       | 101/391 [00:01<00:03, 93.06it/s] 28%|██▊       | 111/391 [00:01<00:02, 93.95it/s] 31%|███       | 121/391 [00:01<00:02, 94.77it/s] 34%|███▎      | 131/391 [00:01<00:02, 95.23it/s] 36%|███▌      | 141/391 [00:01<00:02, 95.46it/s] 39%|███▊      | 151/391 [00:02<00:02, 95.78it/s] 41%|████      | 161/391 [00:02<00:02, 95.77it/s] 44%|████▎     | 171/391 [00:02<00:02, 95.79it/s] 46%|████▋     | 181/391 [00:02<00:02, 95.90it/s] 49%|████▉     | 191/391 [00:02<00:02, 95.74it/s] 51%|█████▏    | 201/391 [00:02<00:01, 95.94it/s] 54%|█████▍    | 211/391 [00:02<00:01, 96.08it/s] 57%|█████▋    | 221/391 [00:02<00:01, 95.80it/s] 59%|█████▉    | 231/391 [00:02<00:01, 95.78it/s] 62%|██████▏   | 241/391 [00:02<00:01, 95.75it/s] 64%|██████▍   | 251/391 [00:03<00:01, 95.71it/s] 67%|██████▋   | 261/391 [00:03<00:01, 95.90it/s] 69%|██████▉   | 271/391 [00:03<00:01, 95.83it/s] 72%|███████▏  | 281/391 [00:03<00:01, 96.05it/s] 74%|███████▍  | 291/391 [00:03<00:01, 96.14it/s] 77%|███████▋  | 301/391 [00:03<00:00, 96.13it/s] 80%|███████▉  | 311/391 [00:03<00:00, 96.07it/s] 82%|████████▏ | 321/391 [00:03<00:00, 95.85it/s] 85%|████████▍ | 331/391 [00:03<00:00, 95.86it/s] 87%|████████▋ | 341/391 [00:03<00:00, 95.82it/s] 90%|████████▉ | 351/391 [00:04<00:00, 95.67it/s] 92%|█████████▏| 361/391 [00:04<00:00, 95.57it/s] 95%|█████████▍| 371/391 [00:04<00:00, 96.26it/s] 97%|█████████▋| 381/391 [00:04<00:00, 96.83it/s]100%|██████████| 391/391 [00:04<00:00, 94.97it/s]100%|██████████| 391/391 [00:04<00:00, 86.62it/s]
50000 images processed, 4.5954978466033936 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:32,  2.36it/s] 14%|█▍        | 11/79 [00:00<00:02, 26.58it/s] 27%|██▋       | 21/79 [00:00<00:01, 45.09it/s] 39%|███▉      | 31/79 [00:00<00:00, 58.77it/s] 52%|█████▏    | 41/79 [00:00<00:00, 68.96it/s] 65%|██████▍   | 51/79 [00:00<00:00, 76.18it/s] 77%|███████▋  | 61/79 [00:01<00:00, 82.02it/s] 90%|████████▉ | 71/79 [00:01<00:00, 86.23it/s]100%|██████████| 79/79 [00:02<00:00, 34.43it/s]
10000 images processed, 2.31844162940979 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-seen/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:36,  2.11it/s]  5%|▌         | 11/204 [00:00<00:07, 24.47it/s] 10%|█         | 21/204 [00:00<00:04, 42.01it/s] 15%|█▌        | 31/204 [00:00<00:03, 55.85it/s] 20%|██        | 41/204 [00:00<00:02, 66.75it/s] 25%|██▌       | 51/204 [00:01<00:02, 74.92it/s] 30%|██▉       | 61/204 [00:01<00:01, 80.69it/s] 35%|███▍      | 71/204 [00:01<00:01, 84.99it/s] 40%|███▉      | 81/204 [00:01<00:01, 88.05it/s] 45%|████▍     | 91/204 [00:01<00:01, 90.41it/s] 50%|████▉     | 101/204 [00:01<00:01, 92.06it/s] 54%|█████▍    | 111/204 [00:01<00:01, 92.73it/s] 59%|█████▉    | 121/204 [00:01<00:00, 93.29it/s] 64%|██████▍   | 131/204 [00:01<00:00, 93.79it/s] 69%|██████▉   | 141/204 [00:01<00:00, 93.70it/s] 74%|███████▍  | 151/204 [00:02<00:00, 94.18it/s] 79%|███████▉  | 161/204 [00:02<00:00, 94.20it/s] 84%|████████▍ | 171/204 [00:02<00:00, 93.71it/s] 89%|████████▊ | 181/204 [00:02<00:00, 94.64it/s] 94%|█████████▎| 191/204 [00:02<00:00, 95.40it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.86it/s]100%|██████████| 204/204 [00:02<00:00, 78.02it/s]
26032 images processed, 2.6520276069641113 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:50,  1.54it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.10it/s] 25%|██▌       | 20/79 [00:00<00:01, 33.22it/s] 38%|███▊      | 30/79 [00:00<00:01, 47.45it/s] 51%|█████     | 40/79 [00:01<00:00, 59.18it/s] 63%|██████▎   | 50/79 [00:01<00:00, 68.41it/s] 76%|███████▌  | 60/79 [00:01<00:00, 75.90it/s] 89%|████████▊ | 70/79 [00:01<00:00, 81.73it/s]100%|██████████| 79/79 [00:01<00:00, 53.70it/s]
10000 images processed, 1.5057430267333984 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.98it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.28it/s] 27%|██▋       | 21/79 [00:00<00:01, 41.03it/s] 39%|███▉      | 31/79 [00:00<00:00, 55.23it/s] 52%|█████▏    | 41/79 [00:00<00:00, 66.13it/s] 65%|██████▍   | 51/79 [00:01<00:00, 74.42it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.84it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.54it/s]100%|██████████| 79/79 [00:01<00:00, 60.27it/s]
10000 images processed, 1.3317615985870361 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:38,  1.81it/s] 16%|█▌        | 11/70 [00:00<00:02, 21.71it/s] 30%|███       | 21/70 [00:00<00:01, 38.63it/s] 44%|████▍     | 31/70 [00:00<00:00, 52.47it/s] 59%|█████▊    | 41/70 [00:00<00:00, 63.23it/s] 73%|███████▎  | 51/70 [00:01<00:00, 72.24it/s] 87%|████████▋ | 61/70 [00:01<00:00, 79.06it/s]100%|██████████| 70/70 [00:01<00:00, 54.51it/s]
8925 images processed, 1.3117425441741943 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:51,  1.16s/it]  4%|▍         | 2/45 [00:01<00:24,  1.76it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.31it/s] 38%|███▊      | 17/45 [00:01<00:02, 12.91it/s] 56%|█████▌    | 25/45 [00:01<00:00, 21.09it/s] 73%|███████▎  | 33/45 [00:02<00:00, 17.77it/s] 96%|█████████▌| 43/45 [00:02<00:00, 26.96it/s]100%|██████████| 45/45 [00:02<00:00, 16.91it/s]
5640 images processed, 2.6799118518829346 seconds used

17.944154500961304
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.46  98.78
places365     72.69  79.75
LSUN          27.04  94.19
iSUN          76.18  79.50
dtd           47.15  89.36
AVG           45.70  88.31
Retain-Acc: 0.7385
Forget-as-OOD (retain known vs forget novel):
  FPR: 38.00 AUROC: 88.86 AUIN: 99.23
7.777113199234009
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-seen_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-seen_rf.png
==== Stage 2: forget_inc={66,67,88,94,57}; forget_seen={0,8,11,40,51}; all={0,8,11,40,51,66,67,88,94,57} ====
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:54: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1', lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,66,67,88,94,57', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:163: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [00:33<27:19, 33.47s/it]  4%|▍         | 2/50 [00:43<15:36, 19.51s/it]  6%|▌         | 3/50 [00:55<12:37, 16.11s/it]  8%|▊         | 4/50 [01:07<11:15, 14.68s/it] 10%|█         | 5/50 [01:20<10:28, 13.96s/it] 12%|█▏        | 6/50 [01:29<09:06, 12.42s/it][loss] ep 0 it 0 total=8.6050 mle=1.9352 pcon=5.2948 forget=1.3749 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 0 it 50 total=8.5193 mle=1.8787 pcon=5.2809 forget=1.3597 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 0 it 100 total=8.5639 mle=1.9468 pcon=5.2666 forget=1.3505 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 0 it 150 total=8.4620 mle=1.8480 pcon=5.2527 forget=1.3614 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 0 it 200 total=8.5431 mle=1.9482 pcon=5.2390 forget=1.3560 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 0 it 250 total=8.4122 mle=1.8243 pcon=5.2257 forget=1.3622 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 0 it 300 total=8.4247 mle=1.8516 pcon=5.2128 forget=1.3603 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 0 it 350 total=8.4985 mle=1.9367 pcon=5.2001 forget=1.3617 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 1 it 10 total=8.3979 mle=1.8462 pcon=5.1876 forget=1.3641 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 1 it 60 total=8.3013 mle=1.7795 pcon=5.1753 forget=1.3464 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 1 it 110 total=8.3773 mle=1.8522 pcon=5.1641 forget=1.3610 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 1 it 160 total=8.3213 mle=1.8077 pcon=5.1528 forget=1.3608 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 1 it 210 total=8.3602 mle=1.8434 pcon=5.1416 forget=1.3752 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 1 it 260 total=8.0881 mle=1.5863 pcon=5.1305 forget=1.3713 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 1 it 310 total=8.0911 mle=1.5986 pcon=5.1198 forget=1.3727 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 1 it 360 total=8.2173 mle=1.7000 pcon=5.1094 forget=1.4080 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 2 it 20 total=8.0207 mle=1.5695 pcon=5.0993 forget=1.3518 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 2 it 70 total=8.2146 mle=1.7735 pcon=5.0895 forget=1.3517 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 2 it 120 total=8.1237 mle=1.6798 pcon=5.0797 forget=1.3641 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 2 it 170 total=8.0935 mle=1.6366 pcon=5.0704 forget=1.3864 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 2 it 220 total=8.2040 mle=1.7883 pcon=5.0612 forget=1.3546 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 2 it 270 total=7.9536 mle=1.5581 pcon=5.0525 forget=1.3430 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 2 it 320 total=8.0776 mle=1.6651 pcon=5.0439 forget=1.3686 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 2 it 370 total=8.1841 mle=1.7821 pcon=5.0353 forget=1.3667 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 3 it 30 total=8.1778 mle=1.8113 pcon=5.0270 forget=1.3396 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 80 total=8.0123 mle=1.6435 pcon=5.0188 forget=1.3500 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 130 total=7.9977 mle=1.6271 pcon=5.0106 forget=1.3600 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 3 it 180 total=7.9556 mle=1.5870 pcon=5.0028 forget=1.3658 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 230 total=8.0371 mle=1.6925 pcon=4.9950 forget=1.3496 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 3 it 280 total=8.0139 mle=1.6510 pcon=4.9875 forget=1.3754 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 3 it 330 total=7.8952 mle=1.5537 pcon=4.9801 forget=1.3614 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 380 total=8.0560 mle=1.7228 pcon=4.9730 forget=1.3602 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 4 it 40 total=8.2203 mle=1.8754 pcon=4.9659 forget=1.3790 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 4 it 90 total=8.0822 mle=1.7603 pcon=4.9591 forget=1.3628 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 4 it 140 total=7.9926 mle=1.6544 pcon=4.9526 forget=1.3856 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 4 it 190 total=7.9582 mle=1.6355 pcon=4.9457 forget=1.3770 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 4 it 240 total=7.8872 mle=1.5738 pcon=4.9394 forget=1.3740 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 4 it 290 total=8.1358 mle=1.8396 pcon=4.9330 forget=1.3633 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 4 it 340 total=8.1371 mle=1.8482 pcon=4.9268 forget=1.3621 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 5 it 0 total=8.0138 mle=1.7277 pcon=4.9207 forget=1.3653 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 5 it 50 total=7.9379 mle=1.6712 pcon=4.9148 forget=1.3519 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 5 it 100 total=7.7785 mle=1.4887 pcon=4.9088 forget=1.3810 orth=0.0000 favg=0.0000 nr=55 nf=55 protos=540 fproto_sim=NA
[loss] ep 5 it 150 total=7.9627 mle=1.6958 pcon=4.9033 forget=1.3636 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 5 it 200 total=7.9602 mle=1.6963 pcon=4.8978 forget=1.3661 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 5 it 250 total=7.8198 mle=1.5721 pcon=4.8925 forget=1.3552 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 5 it 300 total=8.0001 mle=1.7748 pcon=4.8870 forget=1.3382 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 5 it 350 total=8.0083 mle=1.7863 pcon=4.8819 forget=1.3402 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 6 it 10 total=7.9006 mle=1.6664 pcon=4.8768 forget=1.3574 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 6 it 60 total=7.9419 mle=1.7037 pcon=4.8719 forget=1.3662 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 110 total=7.8088 mle=1.5780 pcon=4.8670 forget=1.3638 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 6 it 160 total=7.8073 mle=1.5944 pcon=4.8622 forget=1.3507 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 6 it 210 total=8.1815 mle=1.9640 pcon=4.8573 forget=1.3602 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 260 total=7.8294 mle=1.6359 pcon=4.8526 forget=1.3408 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 310 total=7.7538 mle=1.5380 pcon=4.8480 forget=1.3678 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 360 total=7.8271 mle=1.6235 pcon=4.8436 forget=1.3600 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
 14%|█▍        | 7/50 [01:39<08:14, 11.50s/it] 16%|█▌        | 8/50 [01:49<07:43, 11.04s/it] 18%|█▊        | 9/50 [01:59<07:21, 10.77s/it] 20%|██        | 10/50 [02:09<07:03, 10.58s/it] 22%|██▏       | 11/50 [02:19<06:47, 10.44s/it] 24%|██▍       | 12/50 [02:30<06:33, 10.35s/it] 26%|██▌       | 13/50 [02:40<06:22, 10.34s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 7 it 20 total=7.8564 mle=1.6841 pcon=4.8391 forget=1.3331 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 7 it 70 total=7.9487 mle=1.7666 pcon=4.8348 forget=1.3474 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 7 it 120 total=7.8000 mle=1.6530 pcon=4.8305 forget=1.3166 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 7 it 170 total=7.9676 mle=1.7959 pcon=4.8266 forget=1.3450 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 7 it 220 total=7.8135 mle=1.6491 pcon=4.8230 forget=1.3414 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 7 it 270 total=7.6833 mle=1.5295 pcon=4.8194 forget=1.3344 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 7 it 320 total=7.9053 mle=1.7448 pcon=4.8156 forget=1.3449 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 7 it 370 total=7.8462 mle=1.6713 pcon=4.8120 forget=1.3629 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 8 it 30 total=7.6551 mle=1.5045 pcon=4.8084 forget=1.3422 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 80 total=7.6797 mle=1.5392 pcon=4.8050 forget=1.3355 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 130 total=7.7872 mle=1.6576 pcon=4.8015 forget=1.3280 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 8 it 180 total=7.7131 mle=1.5803 pcon=4.7981 forget=1.3347 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 8 it 230 total=7.7402 mle=1.6000 pcon=4.7948 forget=1.3454 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 280 total=7.8222 mle=1.6841 pcon=4.7916 forget=1.3464 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 8 it 330 total=7.7959 mle=1.6477 pcon=4.7886 forget=1.3595 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 380 total=7.7607 mle=1.6362 pcon=4.7857 forget=1.3388 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 9 it 40 total=7.7441 mle=1.6329 pcon=4.7827 forget=1.3285 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 9 it 90 total=7.8314 mle=1.7290 pcon=4.7797 forget=1.3228 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 9 it 140 total=7.7468 mle=1.6286 pcon=4.7769 forget=1.3413 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 9 it 190 total=7.6731 mle=1.5643 pcon=4.7740 forget=1.3348 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 9 it 240 total=7.8777 mle=1.7702 pcon=4.7714 forget=1.3361 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 9 it 290 total=7.8089 mle=1.7133 pcon=4.7687 forget=1.3269 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 9 it 340 total=7.6425 mle=1.5516 pcon=4.7661 forget=1.3248 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 10 it 0 total=7.8050 mle=1.7109 pcon=4.7635 forget=1.3306 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 10 it 50 total=7.7652 mle=1.6894 pcon=4.7612 forget=1.3147 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 10 it 100 total=7.7258 mle=1.6188 pcon=4.7589 forget=1.3481 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 10 it 150 total=7.6125 mle=1.5244 pcon=4.7565 forget=1.3315 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 10 it 200 total=7.7083 mle=1.6121 pcon=4.7543 forget=1.3419 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 10 it 250 total=7.6891 mle=1.5974 pcon=4.7521 forget=1.3396 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 10 it 300 total=7.9245 mle=1.8524 pcon=4.7497 forget=1.3224 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 10 it 350 total=7.7066 mle=1.6488 pcon=4.7477 forget=1.3101 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 11 it 10 total=7.6718 mle=1.6105 pcon=4.7456 forget=1.3158 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 11 it 60 total=7.6333 mle=1.5877 pcon=4.7437 forget=1.3018 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 11 it 110 total=7.7547 mle=1.7107 pcon=4.7418 forget=1.3022 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 11 it 160 total=7.6065 mle=1.5673 pcon=4.7399 forget=1.2993 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 11 it 210 total=7.5923 mle=1.5592 pcon=4.7380 forget=1.2951 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 11 it 260 total=7.7271 mle=1.6941 pcon=4.7364 forget=1.2967 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 11 it 310 total=7.8457 mle=1.8049 pcon=4.7346 forget=1.3062 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 11 it 360 total=7.7293 mle=1.7121 pcon=4.7330 forget=1.2842 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 12 it 20 total=7.7009 mle=1.6982 pcon=4.7313 forget=1.2714 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 12 it 70 total=7.6719 mle=1.6553 pcon=4.7297 forget=1.2868 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 12 it 120 total=7.6440 mle=1.6337 pcon=4.7283 forget=1.2820 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 12 it 170 total=7.6158 mle=1.6066 pcon=4.7267 forget=1.2825 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 12 it 220 total=7.5528 mle=1.5485 pcon=4.7252 forget=1.2791 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 12 it 270 total=7.5380 mle=1.5346 pcon=4.7237 forget=1.2797 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 12 it 320 total=7.6497 mle=1.6480 pcon=4.7223 forget=1.2795 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 12 it 370 total=7.6167 mle=1.6464 pcon=4.7207 forget=1.2496 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 13 it 30 total=7.6232 mle=1.6364 pcon=4.7191 forget=1.2677 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 80 total=7.6188 mle=1.6530 pcon=4.7178 forget=1.2479 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 130 total=7.6170 mle=1.6402 pcon=4.7165 forget=1.2603 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 13 it 180 total=7.6229 mle=1.6591 pcon=4.7152 forget=1.2486 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 230 total=7.6073 mle=1.6533 pcon=4.7139 forget=1.2400 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 280 total=7.5826 mle=1.6262 pcon=4.7125 forget=1.2439 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
 28%|██▊       | 14/50 [02:50<06:05, 10.15s/it] 30%|███       | 15/50 [02:59<05:50, 10.03s/it] 32%|███▏      | 16/50 [03:09<05:37,  9.92s/it] 34%|███▍      | 17/50 [03:19<05:24,  9.84s/it] 36%|███▌      | 18/50 [03:29<05:15,  9.85s/it] 38%|███▊      | 19/50 [03:38<05:05,  9.86s/it] 40%|████      | 20/50 [03:48<04:55,  9.84s/it] 42%|████▏     | 21/50 [04:00<05:04, 10.49s/it][loss] ep 13 it 330 total=7.5075 mle=1.5658 pcon=4.7110 forget=1.2307 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 13 it 380 total=7.4951 mle=1.5570 pcon=4.7098 forget=1.2284 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 14 it 40 total=7.5654 mle=1.6196 pcon=4.7083 forget=1.2375 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 14 it 90 total=7.7845 mle=1.8565 pcon=4.7070 forget=1.2210 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 14 it 140 total=7.6363 mle=1.7030 pcon=4.7057 forget=1.2276 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 14 it 190 total=7.5248 mle=1.5989 pcon=4.7044 forget=1.2216 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 14 it 240 total=7.8093 mle=1.8685 pcon=4.7032 forget=1.2377 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 14 it 290 total=7.7598 mle=1.8283 pcon=4.7021 forget=1.2295 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 14 it 340 total=7.5962 mle=1.6567 pcon=4.7010 forget=1.2384 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 15 it 0 total=7.5347 mle=1.6072 pcon=4.6997 forget=1.2278 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 15 it 50 total=7.6953 mle=1.7436 pcon=4.6986 forget=1.2531 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 100 total=7.6478 mle=1.7286 pcon=4.6975 forget=1.2217 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 15 it 150 total=7.5145 mle=1.5926 pcon=4.6964 forget=1.2256 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 200 total=7.5917 mle=1.6779 pcon=4.6952 forget=1.2186 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 250 total=7.6567 mle=1.7335 pcon=4.6941 forget=1.2291 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 300 total=7.5773 mle=1.6568 pcon=4.6930 forget=1.2276 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 15 it 350 total=7.5024 mle=1.5826 pcon=4.6920 forget=1.2278 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 16 it 10 total=7.4849 mle=1.5670 pcon=4.6910 forget=1.2269 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 16 it 60 total=7.6601 mle=1.7400 pcon=4.6899 forget=1.2302 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 16 it 110 total=7.4746 mle=1.5570 pcon=4.6891 forget=1.2286 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 16 it 160 total=7.4878 mle=1.5674 pcon=4.6881 forget=1.2322 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 16 it 210 total=7.6069 mle=1.6831 pcon=4.6871 forget=1.2367 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 16 it 260 total=7.6570 mle=1.7173 pcon=4.6862 forget=1.2535 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 16 it 310 total=7.4942 mle=1.5631 pcon=4.6852 forget=1.2458 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 16 it 360 total=7.4512 mle=1.5272 pcon=4.6843 forget=1.2396 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 17 it 20 total=7.9729 mle=2.0362 pcon=4.6834 forget=1.2532 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 70 total=7.7223 mle=1.7915 pcon=4.6826 forget=1.2481 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 120 total=7.5829 mle=1.6440 pcon=4.6816 forget=1.2573 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 17 it 170 total=7.5032 mle=1.5598 pcon=4.6808 forget=1.2625 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 220 total=7.7466 mle=1.8047 pcon=4.6801 forget=1.2618 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 17 it 270 total=7.7602 mle=1.8091 pcon=4.6792 forget=1.2718 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 17 it 320 total=7.5614 mle=1.6186 pcon=4.6783 forget=1.2645 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 370 total=7.5404 mle=1.5836 pcon=4.6775 forget=1.2793 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 30 total=7.5400 mle=1.5860 pcon=4.6769 forget=1.2772 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 80 total=7.6382 mle=1.6794 pcon=4.6762 forget=1.2826 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 130 total=7.6376 mle=1.6757 pcon=4.6756 forget=1.2863 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 18 it 180 total=7.6656 mle=1.7042 pcon=4.6749 forget=1.2865 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 18 it 230 total=7.5665 mle=1.6053 pcon=4.6744 forget=1.2868 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 18 it 280 total=7.7261 mle=1.7583 pcon=4.6736 forget=1.2941 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 330 total=7.7693 mle=1.8072 pcon=4.6731 forget=1.2890 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 18 it 380 total=7.6734 mle=1.7009 pcon=4.6724 forget=1.3001 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 19 it 40 total=7.6830 mle=1.7171 pcon=4.6719 forget=1.2940 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 19 it 90 total=7.5023 mle=1.5334 pcon=4.6713 forget=1.2976 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 19 it 140 total=7.7191 mle=1.7409 pcon=4.6707 forget=1.3076 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 19 it 190 total=7.7513 mle=1.7763 pcon=4.6700 forget=1.3050 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 19 it 240 total=7.6575 mle=1.6805 pcon=4.6694 forget=1.3076 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 19 it 290 total=7.6255 mle=1.6459 pcon=4.6690 forget=1.3106 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 19 it 340 total=7.6724 mle=1.6819 pcon=4.6685 forget=1.3221 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 20 it 0 total=7.6472 mle=1.6574 pcon=4.6679 forget=1.3219 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 20 it 50 total=7.4833 mle=1.4991 pcon=4.6676 forget=1.3166 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 20 it 100 total=7.7794 mle=1.7979 pcon=4.6672 forget=1.3143 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 150 total=7.7494 mle=1.7588 pcon=4.6670 forget=1.3236 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 200 total=7.6018 mle=1.6060 pcon=4.6666 forget=1.3293 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 20 it 250 total=7.6490 mle=1.6538 pcon=4.6663 forget=1.3289 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 300 total=7.7476 mle=1.7459 pcon=4.6658 forget=1.3359 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 350 total=7.7213 mle=1.7258 pcon=4.6653 forget=1.3302 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 21 it 10 total=7.6158 mle=1.6253 pcon=4.6649 forget=1.3256 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 21 it 60 total=7.6852 mle=1.6846 pcon=4.6645 forget=1.3362 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
 44%|████▍     | 22/50 [04:10<04:45, 10.20s/it] 46%|████▌     | 23/50 [04:19<04:30, 10.02s/it] 48%|████▊     | 24/50 [04:29<04:17,  9.90s/it] 50%|█████     | 25/50 [04:38<04:02,  9.71s/it] 52%|█████▏    | 26/50 [04:48<03:50,  9.62s/it] 54%|█████▍    | 27/50 [04:57<03:39,  9.55s/it] 56%|█████▌    | 28/50 [05:06<03:28,  9.48s/it] 58%|█████▊    | 29/50 [05:16<03:19,  9.49s/it][loss] ep 21 it 110 total=7.8030 mle=1.8038 pcon=4.6641 forget=1.3352 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 21 it 160 total=7.6513 mle=1.6524 pcon=4.6638 forget=1.3351 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 21 it 210 total=7.5819 mle=1.5822 pcon=4.6635 forget=1.3362 orth=0.0000 favg=0.0000 nr=55 nf=55 protos=540 fproto_sim=NA
[loss] ep 21 it 260 total=7.6739 mle=1.6722 pcon=4.6632 forget=1.3385 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 21 it 310 total=7.5494 mle=1.5394 pcon=4.6629 forget=1.3470 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 21 it 360 total=7.6029 mle=1.5990 pcon=4.6627 forget=1.3412 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 22 it 20 total=7.8176 mle=1.8180 pcon=4.6624 forget=1.3372 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 22 it 70 total=7.5927 mle=1.5810 pcon=4.6621 forget=1.3497 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 120 total=7.6293 mle=1.6245 pcon=4.6619 forget=1.3428 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 22 it 170 total=7.6143 mle=1.6103 pcon=4.6617 forget=1.3424 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 220 total=7.6813 mle=1.6639 pcon=4.6614 forget=1.3560 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 22 it 270 total=7.9893 mle=1.9756 pcon=4.6611 forget=1.3525 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 320 total=7.6921 mle=1.6746 pcon=4.6609 forget=1.3565 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 370 total=7.7011 mle=1.6919 pcon=4.6606 forget=1.3486 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 23 it 30 total=7.7531 mle=1.7293 pcon=4.6604 forget=1.3634 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 23 it 80 total=7.7205 mle=1.7100 pcon=4.6601 forget=1.3505 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 23 it 130 total=7.6096 mle=1.5997 pcon=4.6597 forget=1.3502 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 23 it 180 total=7.7173 mle=1.7091 pcon=4.6595 forget=1.3487 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 23 it 230 total=7.8766 mle=1.8569 pcon=4.6593 forget=1.3605 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 23 it 280 total=7.6094 mle=1.5918 pcon=4.6590 forget=1.3586 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 23 it 330 total=7.6820 mle=1.6712 pcon=4.6585 forget=1.3522 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 23 it 380 total=7.6626 mle=1.6528 pcon=4.6584 forget=1.3514 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 24 it 40 total=7.6754 mle=1.6630 pcon=4.6583 forget=1.3541 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 24 it 90 total=7.6300 mle=1.6091 pcon=4.6581 forget=1.3629 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 24 it 140 total=7.6950 mle=1.6761 pcon=4.6578 forget=1.3611 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 24 it 190 total=7.8449 mle=1.8269 pcon=4.6575 forget=1.3605 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 24 it 240 total=7.7873 mle=1.7622 pcon=4.6573 forget=1.3678 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 24 it 290 total=7.8543 mle=1.8291 pcon=4.6570 forget=1.3681 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 24 it 340 total=7.7413 mle=1.7212 pcon=4.6569 forget=1.3633 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 0 total=7.6422 mle=1.6248 pcon=4.6567 forget=1.3607 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 50 total=7.7039 mle=1.6837 pcon=4.6565 forget=1.3637 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 100 total=7.5433 mle=1.5287 pcon=4.6562 forget=1.3584 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 25 it 150 total=7.7668 mle=1.7492 pcon=4.6561 forget=1.3614 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 25 it 200 total=7.8792 mle=1.8439 pcon=4.6561 forget=1.3792 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 25 it 250 total=7.5860 mle=1.5717 pcon=4.6557 forget=1.3586 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 25 it 300 total=7.7955 mle=1.7716 pcon=4.6555 forget=1.3684 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 350 total=7.6686 mle=1.6564 pcon=4.6553 forget=1.3569 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 10 total=7.7261 mle=1.7140 pcon=4.6550 forget=1.3570 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 26 it 60 total=7.6571 mle=1.6400 pcon=4.6548 forget=1.3624 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 110 total=7.6262 mle=1.6183 pcon=4.6546 forget=1.3532 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 26 it 160 total=7.6796 mle=1.6637 pcon=4.6545 forget=1.3615 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 210 total=7.9601 mle=1.9507 pcon=4.6542 forget=1.3552 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 260 total=7.6718 mle=1.6612 pcon=4.6539 forget=1.3566 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 26 it 310 total=7.6403 mle=1.6343 pcon=4.6538 forget=1.3523 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 360 total=7.6330 mle=1.6159 pcon=4.6534 forget=1.3636 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 27 it 20 total=7.6457 mle=1.6369 pcon=4.6533 forget=1.3555 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 27 it 70 total=7.6575 mle=1.6414 pcon=4.6532 forget=1.3629 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 27 it 120 total=7.8916 mle=1.8770 pcon=4.6528 forget=1.3618 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 27 it 170 total=7.5984 mle=1.5907 pcon=4.6526 forget=1.3551 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 27 it 220 total=7.7589 mle=1.7451 pcon=4.6524 forget=1.3613 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 27 it 270 total=7.6607 mle=1.6512 pcon=4.6523 forget=1.3572 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 27 it 320 total=7.5771 mle=1.5579 pcon=4.6521 forget=1.3670 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 27 it 370 total=7.7124 mle=1.6989 pcon=4.6519 forget=1.3616 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 28 it 30 total=7.6441 mle=1.6354 pcon=4.6518 forget=1.3569 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 28 it 80 total=7.6561 mle=1.6355 pcon=4.6515 forget=1.3691 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 28 it 130 total=7.6777 mle=1.6675 pcon=4.6514 forget=1.3589 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 28 it 180 total=7.6165 mle=1.5967 pcon=4.6512 forget=1.3686 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 28 it 230 total=7.7222 mle=1.7141 pcon=4.6511 forget=1.3570 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 28 it 280 total=7.7174 mle=1.7047 pcon=4.6509 forget=1.3618 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 28 it 330 total=7.6661 mle=1.6412 pcon=4.6506 forget=1.3743 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 28 it 380 total=7.7892 mle=1.7739 pcon=4.6504 forget=1.3650 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 29 it 40 total=7.7363 mle=1.7167 pcon=4.6500 forget=1.3695 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
 60%|██████    | 30/50 [05:25<03:09,  9.46s/it] 62%|██████▏   | 31/50 [05:35<03:03,  9.65s/it] 64%|██████▍   | 32/50 [05:48<03:09, 10.51s/it] 66%|██████▌   | 33/50 [06:03<03:24, 12.02s/it] 68%|██████▊   | 34/50 [06:19<03:28, 13.05s/it] 70%|███████   | 35/50 [06:34<03:24, 13.66s/it] 72%|███████▏  | 36/50 [06:49<03:16, 14.07s/it] 74%|███████▍  | 37/50 [07:04<03:06, 14.33s/it][loss] ep 29 it 90 total=7.7265 mle=1.7072 pcon=4.6501 forget=1.3692 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 29 it 140 total=7.6337 mle=1.6201 pcon=4.6500 forget=1.3636 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 29 it 190 total=7.6600 mle=1.6475 pcon=4.6498 forget=1.3626 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 29 it 240 total=7.5871 mle=1.5731 pcon=4.6497 forget=1.3643 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 29 it 290 total=7.6707 mle=1.6489 pcon=4.6495 forget=1.3723 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 29 it 340 total=7.6218 mle=1.6106 pcon=4.6494 forget=1.3618 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 30 it 0 total=7.7584 mle=1.7385 pcon=4.6492 forget=1.3706 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 30 it 50 total=7.7302 mle=1.7141 pcon=4.6490 forget=1.3672 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 30 it 100 total=7.6265 mle=1.6111 pcon=4.6489 forget=1.3665 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 30 it 150 total=7.7094 mle=1.6971 pcon=4.6488 forget=1.3636 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 30 it 200 total=7.7188 mle=1.7063 pcon=4.6486 forget=1.3638 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 30 it 250 total=7.9465 mle=1.9329 pcon=4.6486 forget=1.3650 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 30 it 300 total=7.8647 mle=1.8529 pcon=4.6485 forget=1.3633 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 30 it 350 total=7.7795 mle=1.7611 pcon=4.6482 forget=1.3701 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 10 total=7.6775 mle=1.6639 pcon=4.6480 forget=1.3656 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 31 it 60 total=7.5907 mle=1.5665 pcon=4.6478 forget=1.3764 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 31 it 110 total=7.6745 mle=1.6591 pcon=4.6476 forget=1.3679 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 160 total=7.6497 mle=1.6366 pcon=4.6474 forget=1.3657 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 210 total=7.6524 mle=1.6317 pcon=4.6472 forget=1.3734 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 260 total=7.5582 mle=1.5387 pcon=4.6472 forget=1.3723 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 31 it 310 total=7.6717 mle=1.6511 pcon=4.6471 forget=1.3736 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 31 it 360 total=7.5845 mle=1.5707 pcon=4.6469 forget=1.3669 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 32 it 20 total=7.7012 mle=1.6816 pcon=4.6468 forget=1.3728 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 70 total=7.6503 mle=1.6273 pcon=4.6466 forget=1.3765 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 32 it 120 total=7.7483 mle=1.7268 pcon=4.6463 forget=1.3752 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 32 it 170 total=7.6578 mle=1.6392 pcon=4.6460 forget=1.3726 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 32 it 220 total=7.6609 mle=1.6408 pcon=4.6460 forget=1.3742 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 270 total=7.7079 mle=1.6805 pcon=4.6458 forget=1.3816 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 320 total=7.6845 mle=1.6622 pcon=4.6456 forget=1.3767 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 370 total=7.7091 mle=1.6841 pcon=4.6455 forget=1.3795 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 33 it 30 total=7.9660 mle=1.9485 pcon=4.6454 forget=1.3721 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 33 it 80 total=7.9968 mle=1.9710 pcon=4.6453 forget=1.3805 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 33 it 130 total=7.8757 mle=1.8527 pcon=4.6452 forget=1.3777 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 33 it 180 total=7.6929 mle=1.6600 pcon=4.6452 forget=1.3877 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 33 it 230 total=7.6356 mle=1.6079 pcon=4.6451 forget=1.3826 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 33 it 280 total=7.7718 mle=1.7449 pcon=4.6451 forget=1.3818 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 33 it 330 total=7.7801 mle=1.7590 pcon=4.6451 forget=1.3761 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 33 it 380 total=7.6705 mle=1.6501 pcon=4.6449 forget=1.3754 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 34 it 40 total=7.8595 mle=1.8355 pcon=4.6448 forget=1.3792 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 34 it 90 total=7.6782 mle=1.6536 pcon=4.6447 forget=1.3798 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 34 it 140 total=8.0096 mle=1.9739 pcon=4.6446 forget=1.3912 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 34 it 190 total=7.8399 mle=1.8049 pcon=4.6445 forget=1.3905 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 34 it 240 total=7.6888 mle=1.6678 pcon=4.6444 forget=1.3766 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 34 it 290 total=7.6742 mle=1.6527 pcon=4.6443 forget=1.3773 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 34 it 340 total=7.5414 mle=1.5131 pcon=4.6441 forget=1.3841 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 0 total=7.5509 mle=1.5257 pcon=4.6440 forget=1.3812 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 50 total=7.8397 mle=1.8131 pcon=4.6438 forget=1.3827 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 35 it 100 total=7.6076 mle=1.5730 pcon=4.6438 forget=1.3909 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 150 total=7.7183 mle=1.6905 pcon=4.6437 forget=1.3841 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 35 it 200 total=7.6625 mle=1.6319 pcon=4.6438 forget=1.3868 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 35 it 250 total=7.6192 mle=1.5812 pcon=4.6437 forget=1.3942 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 35 it 300 total=7.5458 mle=1.5182 pcon=4.6437 forget=1.3839 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 350 total=7.5129 mle=1.4887 pcon=4.6436 forget=1.3806 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 36 it 10 total=7.7507 mle=1.7253 pcon=4.6434 forget=1.3821 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 36 it 60 total=7.8567 mle=1.8344 pcon=4.6434 forget=1.3789 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 36 it 110 total=7.7503 mle=1.7146 pcon=4.6433 forget=1.3925 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 36 it 160 total=7.8644 mle=1.8257 pcon=4.6433 forget=1.3955 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 36 it 210 total=7.7589 mle=1.7310 pcon=4.6430 forget=1.3849 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 36 it 260 total=7.7734 mle=1.7468 pcon=4.6430 forget=1.3836 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 36 it 310 total=7.6829 mle=1.6586 pcon=4.6430 forget=1.3813 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 36 it 360 total=7.6381 mle=1.6164 pcon=4.6429 forget=1.3788 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 37 it 20 total=7.6550 mle=1.6266 pcon=4.6428 forget=1.3856 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
 76%|███████▌  | 38/50 [07:19<02:56, 14.67s/it] 78%|███████▊  | 39/50 [07:37<02:50, 15.49s/it] 80%|████████  | 40/50 [07:53<02:36, 15.61s/it] 82%|████████▏ | 41/50 [08:08<02:19, 15.55s/it] 84%|████████▍ | 42/50 [08:23<02:03, 15.41s/it] 86%|████████▌ | 43/50 [08:39<01:47, 15.39s/it] 88%|████████▊ | 44/50 [08:54<01:32, 15.44s/it] 90%|█████████ | 45/50 [09:09<01:16, 15.38s/it][loss] ep 37 it 70 total=7.6178 mle=1.5841 pcon=4.6428 forget=1.3909 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 37 it 120 total=7.7034 mle=1.6716 pcon=4.6428 forget=1.3890 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 37 it 170 total=7.7515 mle=1.7227 pcon=4.6427 forget=1.3861 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 37 it 220 total=7.6566 mle=1.6217 pcon=4.6426 forget=1.3924 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 37 it 270 total=7.7622 mle=1.7314 pcon=4.6425 forget=1.3882 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 37 it 320 total=7.8756 mle=1.8376 pcon=4.6426 forget=1.3954 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 37 it 370 total=7.6366 mle=1.6052 pcon=4.6425 forget=1.3889 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 38 it 30 total=7.5803 mle=1.5607 pcon=4.6426 forget=1.3771 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 38 it 80 total=7.6586 mle=1.6275 pcon=4.6425 forget=1.3886 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 38 it 130 total=7.7176 mle=1.6768 pcon=4.6425 forget=1.3983 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 38 it 180 total=7.7444 mle=1.7090 pcon=4.6424 forget=1.3931 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 38 it 230 total=7.7673 mle=1.7355 pcon=4.6424 forget=1.3895 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 38 it 280 total=7.7293 mle=1.6985 pcon=4.6424 forget=1.3884 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 38 it 330 total=7.6743 mle=1.6325 pcon=4.6424 forget=1.3994 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 38 it 380 total=7.8893 mle=1.8560 pcon=4.6422 forget=1.3910 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 39 it 40 total=7.6910 mle=1.6641 pcon=4.6422 forget=1.3848 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 90 total=7.6615 mle=1.6241 pcon=4.6421 forget=1.3953 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 140 total=7.6216 mle=1.5912 pcon=4.6420 forget=1.3884 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 190 total=7.7520 mle=1.7266 pcon=4.6419 forget=1.3836 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 39 it 240 total=7.7426 mle=1.7105 pcon=4.6418 forget=1.3903 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 290 total=7.9061 mle=1.8784 pcon=4.6418 forget=1.3859 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 39 it 340 total=7.6909 mle=1.6723 pcon=4.6420 forget=1.3767 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 40 it 0 total=7.6596 mle=1.6349 pcon=4.6419 forget=1.3829 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 40 it 50 total=7.6092 mle=1.5833 pcon=4.6417 forget=1.3842 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 40 it 100 total=7.5959 mle=1.5649 pcon=4.6416 forget=1.3894 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 40 it 150 total=7.7850 mle=1.7667 pcon=4.6414 forget=1.3770 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 40 it 200 total=7.6392 mle=1.6132 pcon=4.6414 forget=1.3847 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 40 it 250 total=7.7517 mle=1.7292 pcon=4.6413 forget=1.3812 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 40 it 300 total=7.6400 mle=1.6058 pcon=4.6412 forget=1.3930 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 40 it 350 total=7.8423 mle=1.8136 pcon=4.6412 forget=1.3875 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 41 it 10 total=7.8887 mle=1.8674 pcon=4.6410 forget=1.3802 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 41 it 60 total=7.6044 mle=1.5866 pcon=4.6410 forget=1.3768 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 41 it 110 total=7.7250 mle=1.7037 pcon=4.6409 forget=1.3804 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 41 it 160 total=7.8533 mle=1.8291 pcon=4.6409 forget=1.3833 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 41 it 210 total=7.6569 mle=1.6379 pcon=4.6409 forget=1.3780 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 41 it 260 total=7.6448 mle=1.6180 pcon=4.6407 forget=1.3862 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 41 it 310 total=7.6732 mle=1.6551 pcon=4.6406 forget=1.3775 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 41 it 360 total=7.6078 mle=1.5859 pcon=4.6405 forget=1.3815 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 42 it 20 total=7.6969 mle=1.6791 pcon=4.6405 forget=1.3773 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 42 it 70 total=7.7229 mle=1.7002 pcon=4.6404 forget=1.3824 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 42 it 120 total=7.6194 mle=1.6037 pcon=4.6404 forget=1.3753 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 42 it 170 total=7.6527 mle=1.6372 pcon=4.6404 forget=1.3751 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 42 it 220 total=7.7125 mle=1.6898 pcon=4.6403 forget=1.3824 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 42 it 270 total=7.8200 mle=1.7881 pcon=4.6402 forget=1.3917 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 42 it 320 total=7.8383 mle=1.8225 pcon=4.6400 forget=1.3758 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 42 it 370 total=7.4636 mle=1.4457 pcon=4.6398 forget=1.3781 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 43 it 30 total=7.8131 mle=1.7969 pcon=4.6398 forget=1.3764 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 43 it 80 total=7.6610 mle=1.6436 pcon=4.6398 forget=1.3776 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 43 it 130 total=7.6649 mle=1.6460 pcon=4.6397 forget=1.3792 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 43 it 180 total=7.7421 mle=1.7244 pcon=4.6397 forget=1.3780 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 43 it 230 total=7.7739 mle=1.7633 pcon=4.6396 forget=1.3709 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 43 it 280 total=7.8230 mle=1.8127 pcon=4.6396 forget=1.3707 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 43 it 330 total=7.7519 mle=1.7210 pcon=4.6396 forget=1.3913 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 43 it 380 total=7.6129 mle=1.5997 pcon=4.6397 forget=1.3735 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 44 it 40 total=7.6643 mle=1.6457 pcon=4.6397 forget=1.3789 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 44 it 90 total=7.7509 mle=1.7393 pcon=4.6397 forget=1.3719 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 44 it 140 total=7.6731 mle=1.6549 pcon=4.6396 forget=1.3786 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 44 it 190 total=7.7291 mle=1.7126 pcon=4.6397 forget=1.3769 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 44 it 240 total=7.6015 mle=1.5804 pcon=4.6396 forget=1.3814 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 44 it 290 total=7.6898 mle=1.6745 pcon=4.6396 forget=1.3756 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 44 it 340 total=7.6125 mle=1.6042 pcon=4.6396 forget=1.3687 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 0 total=7.5980 mle=1.5837 pcon=4.6396 forget=1.3747 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
 92%|█████████▏| 46/50 [09:25<01:01, 15.45s/it] 94%|█████████▍| 47/50 [09:40<00:46, 15.44s/it] 96%|█████████▌| 48/50 [09:56<00:30, 15.48s/it] 98%|█████████▊| 49/50 [10:11<00:15, 15.49s/it]100%|██████████| 50/50 [10:27<00:00, 15.41s/it]100%|██████████| 50/50 [10:27<00:00, 12.54s/it]
[loss] ep 45 it 50 total=7.7681 mle=1.7538 pcon=4.6396 forget=1.3747 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 45 it 100 total=7.8339 mle=1.8204 pcon=4.6397 forget=1.3737 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 150 total=7.6734 mle=1.6552 pcon=4.6397 forget=1.3785 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 45 it 200 total=7.7530 mle=1.7391 pcon=4.6397 forget=1.3742 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 45 it 250 total=7.7030 mle=1.6963 pcon=4.6397 forget=1.3670 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 45 it 300 total=7.5842 mle=1.5612 pcon=4.6397 forget=1.3833 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 350 total=7.7075 mle=1.6849 pcon=4.6397 forget=1.3829 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 46 it 10 total=7.6365 mle=1.6195 pcon=4.6397 forget=1.3772 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 46 it 60 total=7.7352 mle=1.7211 pcon=4.6398 forget=1.3742 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 46 it 110 total=7.7375 mle=1.7153 pcon=4.6398 forget=1.3823 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 46 it 160 total=7.6318 mle=1.6126 pcon=4.6398 forget=1.3794 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 46 it 210 total=7.7401 mle=1.7226 pcon=4.6397 forget=1.3779 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 46 it 260 total=7.5946 mle=1.5738 pcon=4.6395 forget=1.3813 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 46 it 310 total=7.6569 mle=1.6384 pcon=4.6394 forget=1.3791 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 46 it 360 total=7.7295 mle=1.7140 pcon=4.6394 forget=1.3761 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 47 it 20 total=7.9705 mle=1.9491 pcon=4.6394 forget=1.3820 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 47 it 70 total=7.5593 mle=1.5470 pcon=4.6394 forget=1.3729 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 47 it 120 total=7.8191 mle=1.7950 pcon=4.6395 forget=1.3847 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 47 it 170 total=7.6707 mle=1.6559 pcon=4.6393 forget=1.3755 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 47 it 220 total=7.7189 mle=1.7049 pcon=4.6392 forget=1.3748 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 47 it 270 total=7.7784 mle=1.7523 pcon=4.6392 forget=1.3869 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 47 it 320 total=7.5940 mle=1.5752 pcon=4.6392 forget=1.3797 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 47 it 370 total=7.7972 mle=1.7776 pcon=4.6391 forget=1.3805 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 48 it 30 total=7.7040 mle=1.6922 pcon=4.6391 forget=1.3727 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 48 it 80 total=7.8278 mle=1.8153 pcon=4.6391 forget=1.3734 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 130 total=7.5259 mle=1.5102 pcon=4.6391 forget=1.3766 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 180 total=7.6348 mle=1.6193 pcon=4.6392 forget=1.3764 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 230 total=7.7095 mle=1.6996 pcon=4.6392 forget=1.3707 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 280 total=7.7533 mle=1.7355 pcon=4.6391 forget=1.3787 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 48 it 330 total=7.6950 mle=1.6815 pcon=4.6390 forget=1.3745 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 48 it 380 total=7.7129 mle=1.7018 pcon=4.6390 forget=1.3721 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 49 it 40 total=7.7569 mle=1.7415 pcon=4.6389 forget=1.3765 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 49 it 90 total=7.8167 mle=1.8093 pcon=4.6389 forget=1.3685 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 49 it 140 total=7.6650 mle=1.6529 pcon=4.6390 forget=1.3732 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 49 it 190 total=7.8452 mle=1.8265 pcon=4.6391 forget=1.3796 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 49 it 240 total=7.5747 mle=1.5612 pcon=4.6391 forget=1.3743 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 49 it 290 total=7.7795 mle=1.7659 pcon=4.6392 forget=1.3744 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 49 it 340 total=7.7057 mle=1.6940 pcon=4.6392 forget=1.3725 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc1: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:18,  1.97it/s]  3%|▎         | 11/391 [00:00<00:16, 23.03it/s]  5%|▌         | 21/391 [00:00<00:09, 40.67it/s]  8%|▊         | 31/391 [00:00<00:06, 54.71it/s] 10%|█         | 40/391 [00:00<00:05, 63.53it/s] 13%|█▎        | 50/391 [00:01<00:04, 72.65it/s] 15%|█▌        | 60/391 [00:01<00:04, 79.38it/s] 18%|█▊        | 70/391 [00:01<00:03, 84.30it/s] 20%|██        | 80/391 [00:01<00:03, 87.60it/s] 23%|██▎       | 90/391 [00:01<00:03, 89.71it/s] 26%|██▌       | 100/391 [00:01<00:03, 91.31it/s] 28%|██▊       | 110/391 [00:01<00:03, 92.69it/s] 31%|███       | 120/391 [00:01<00:02, 92.86it/s] 33%|███▎      | 130/391 [00:01<00:02, 93.93it/s] 36%|███▌      | 140/391 [00:01<00:02, 93.64it/s] 38%|███▊      | 150/391 [00:02<00:02, 94.20it/s] 41%|████      | 160/391 [00:02<00:02, 94.08it/s] 43%|████▎     | 170/391 [00:02<00:02, 93.48it/s] 46%|████▌     | 180/391 [00:02<00:02, 93.76it/s] 49%|████▊     | 190/391 [00:02<00:02, 93.67it/s] 51%|█████     | 200/391 [00:02<00:02, 94.14it/s] 54%|█████▎    | 210/391 [00:02<00:01, 94.16it/s] 56%|█████▋    | 220/391 [00:02<00:01, 93.45it/s] 59%|█████▉    | 230/391 [00:02<00:01, 93.92it/s] 61%|██████▏   | 240/391 [00:03<00:01, 93.59it/s] 64%|██████▍   | 250/391 [00:03<00:01, 93.82it/s] 66%|██████▋   | 260/391 [00:03<00:01, 94.31it/s] 69%|██████▉   | 270/391 [00:03<00:01, 94.92it/s] 72%|███████▏  | 280/391 [00:03<00:01, 94.16it/s] 74%|███████▍  | 290/391 [00:03<00:01, 93.73it/s] 77%|███████▋  | 300/391 [00:03<00:00, 94.10it/s] 79%|███████▉  | 310/391 [00:03<00:00, 94.33it/s] 82%|████████▏ | 320/391 [00:03<00:00, 94.96it/s] 84%|████████▍ | 330/391 [00:03<00:00, 95.35it/s] 87%|████████▋ | 340/391 [00:04<00:00, 95.21it/s] 90%|████████▉ | 350/391 [00:04<00:00, 94.42it/s] 92%|█████████▏| 360/391 [00:04<00:00, 94.66it/s] 95%|█████████▍| 370/391 [00:04<00:00, 95.55it/s] 97%|█████████▋| 380/391 [00:04<00:00, 96.23it/s]100%|█████████▉| 390/391 [00:04<00:00, 96.65it/s]100%|██████████| 391/391 [00:04<00:00, 84.27it/s]
50000 images processed, 4.730883836746216 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:42,  1.84it/s] 13%|█▎        | 10/79 [00:00<00:03, 19.94it/s] 25%|██▌       | 20/79 [00:00<00:01, 37.51it/s] 38%|███▊      | 30/79 [00:00<00:00, 51.80it/s] 51%|█████     | 40/79 [00:00<00:00, 62.49it/s] 63%|██████▎   | 50/79 [00:01<00:00, 70.77it/s] 76%|███████▌  | 60/79 [00:01<00:00, 77.65it/s] 89%|████████▊ | 70/79 [00:01<00:00, 82.82it/s]100%|██████████| 79/79 [00:01<00:00, 42.61it/s]
10000 images processed, 1.8747913837432861 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc1/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:03,  1.64it/s]  4%|▍         | 9/204 [00:00<00:11, 16.52it/s]  9%|▉         | 19/204 [00:00<00:05, 33.88it/s] 14%|█▍        | 29/204 [00:00<00:03, 48.35it/s] 19%|█▊        | 38/204 [00:01<00:02, 57.99it/s] 24%|██▎       | 48/204 [00:01<00:02, 67.72it/s] 28%|██▊       | 58/204 [00:01<00:01, 74.77it/s] 33%|███▎      | 68/204 [00:01<00:01, 79.44it/s] 38%|███▊      | 77/204 [00:01<00:01, 82.19it/s] 42%|████▏     | 86/204 [00:01<00:01, 83.84it/s] 47%|████▋     | 96/204 [00:01<00:01, 87.03it/s] 52%|█████▏    | 106/204 [00:01<00:01, 88.90it/s] 57%|█████▋    | 116/204 [00:01<00:00, 90.69it/s] 62%|██████▏   | 126/204 [00:01<00:00, 91.07it/s] 67%|██████▋   | 136/204 [00:02<00:00, 91.60it/s] 72%|███████▏  | 146/204 [00:02<00:00, 91.41it/s] 76%|███████▋  | 156/204 [00:02<00:00, 92.39it/s] 81%|████████▏ | 166/204 [00:02<00:00, 93.24it/s] 86%|████████▋ | 176/204 [00:02<00:00, 93.73it/s] 91%|█████████ | 186/204 [00:02<00:00, 94.54it/s] 96%|█████████▌| 196/204 [00:02<00:00, 94.97it/s]100%|██████████| 204/204 [00:02<00:00, 72.55it/s]
26032 images processed, 2.857085704803467 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:04,  1.21it/s] 13%|█▎        | 10/79 [00:00<00:04, 14.13it/s] 24%|██▍       | 19/79 [00:01<00:02, 27.20it/s] 37%|███▋      | 29/79 [00:01<00:01, 41.15it/s] 49%|████▉     | 39/79 [00:01<00:00, 53.35it/s] 62%|██████▏   | 49/79 [00:01<00:00, 63.08it/s] 73%|███████▎  | 58/79 [00:01<00:00, 69.25it/s] 86%|████████▌ | 68/79 [00:01<00:00, 75.44it/s] 97%|█████████▋| 77/79 [00:01<00:00, 73.68it/s]100%|██████████| 79/79 [00:01<00:00, 46.21it/s]
10000 images processed, 1.7452986240386963 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.77it/s] 13%|█▎        | 10/79 [00:00<00:03, 19.58it/s] 25%|██▌       | 20/79 [00:00<00:01, 36.80it/s] 38%|███▊      | 30/79 [00:00<00:00, 51.10it/s] 51%|█████     | 40/79 [00:00<00:00, 62.05it/s] 63%|██████▎   | 50/79 [00:01<00:00, 70.85it/s] 76%|███████▌  | 60/79 [00:01<00:00, 77.85it/s] 89%|████████▊ | 70/79 [00:01<00:00, 82.94it/s]100%|██████████| 79/79 [00:01<00:00, 56.84it/s]
10000 images processed, 1.4096856117248535 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.73it/s] 13%|█▎        | 9/70 [00:00<00:03, 17.23it/s] 27%|██▋       | 19/70 [00:00<00:01, 35.08it/s] 41%|████▏     | 29/70 [00:00<00:00, 49.97it/s] 56%|█████▌    | 39/70 [00:00<00:00, 61.56it/s] 70%|███████   | 49/70 [00:01<00:00, 70.87it/s] 84%|████████▍ | 59/70 [00:01<00:00, 78.03it/s] 99%|█████████▊| 69/70 [00:01<00:00, 83.33it/s]100%|██████████| 70/70 [00:01<00:00, 53.06it/s]
8925 images processed, 1.349560260772705 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:56,  1.29s/it] 16%|█▌        | 7/45 [00:01<00:05,  6.66it/s] 38%|███▊      | 17/45 [00:01<00:02, 11.50it/s] 51%|█████     | 23/45 [00:02<00:01, 15.34it/s] 73%|███████▎  | 33/45 [00:02<00:00, 17.72it/s] 96%|█████████▌| 43/45 [00:02<00:00, 26.29it/s]100%|██████████| 45/45 [00:02<00:00, 16.48it/s]
5640 images processed, 2.748615026473999 seconds used

18.5725736618042
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           7.04  98.46
places365     75.68  77.74
LSUN          44.41  87.15
iSUN          79.75  77.44
dtd           49.52  88.37
AVG           51.28  85.83
Retain-Acc: 0.7282
Forget-as-OOD (retain known vs forget novel):
  FPR: 41.80 AUROC: 89.11 AUIN: 99.26
9.686404466629028
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc1_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc1_rf.png
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc2: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:32,  2.56it/s]  3%|▎         | 11/391 [00:00<00:13, 28.21it/s]  5%|▌         | 21/391 [00:00<00:07, 47.10it/s]  8%|▊         | 31/391 [00:00<00:05, 60.96it/s] 10%|█         | 41/391 [00:00<00:04, 71.07it/s] 13%|█▎        | 51/391 [00:00<00:04, 78.25it/s] 16%|█▌        | 61/391 [00:01<00:03, 83.44it/s] 18%|█▊        | 71/391 [00:01<00:03, 87.15it/s] 21%|██        | 81/391 [00:01<00:03, 89.43it/s] 23%|██▎       | 91/391 [00:01<00:03, 91.07it/s] 26%|██▌       | 101/391 [00:01<00:03, 92.25it/s] 28%|██▊       | 111/391 [00:01<00:03, 92.97it/s] 31%|███       | 121/391 [00:01<00:02, 93.66it/s] 34%|███▎      | 131/391 [00:01<00:02, 93.94it/s] 36%|███▌      | 141/391 [00:01<00:02, 94.30it/s] 39%|███▊      | 151/391 [00:01<00:02, 94.56it/s] 41%|████      | 161/391 [00:02<00:02, 94.88it/s] 44%|████▎     | 171/391 [00:02<00:02, 94.95it/s] 46%|████▋     | 181/391 [00:02<00:02, 95.19it/s] 49%|████▉     | 191/391 [00:02<00:02, 95.19it/s] 51%|█████▏    | 201/391 [00:02<00:01, 95.51it/s] 54%|█████▍    | 211/391 [00:02<00:01, 95.58it/s] 57%|█████▋    | 221/391 [00:02<00:01, 95.46it/s] 59%|█████▉    | 231/391 [00:02<00:01, 95.58it/s] 62%|██████▏   | 241/391 [00:02<00:01, 95.42it/s] 64%|██████▍   | 251/391 [00:03<00:01, 95.35it/s] 67%|██████▋   | 261/391 [00:03<00:01, 95.49it/s] 69%|██████▉   | 271/391 [00:03<00:01, 95.38it/s] 72%|███████▏  | 281/391 [00:03<00:01, 95.19it/s] 74%|███████▍  | 291/391 [00:03<00:01, 95.24it/s] 77%|███████▋  | 301/391 [00:03<00:00, 95.17it/s] 80%|███████▉  | 311/391 [00:03<00:00, 95.55it/s] 82%|████████▏ | 321/391 [00:03<00:00, 95.11it/s] 85%|████████▍ | 331/391 [00:03<00:00, 95.24it/s] 87%|████████▋ | 341/391 [00:03<00:00, 95.46it/s] 90%|████████▉ | 351/391 [00:04<00:00, 95.38it/s] 92%|█████████▏| 361/391 [00:04<00:00, 94.86it/s] 95%|█████████▍| 371/391 [00:04<00:00, 95.80it/s] 97%|█████████▋| 381/391 [00:04<00:00, 96.45it/s]100%|██████████| 391/391 [00:04<00:00, 94.57it/s]100%|██████████| 391/391 [00:04<00:00, 87.17it/s]
50000 images processed, 4.573296546936035 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:31,  2.51it/s] 14%|█▍        | 11/79 [00:00<00:02, 27.62it/s] 27%|██▋       | 21/79 [00:00<00:01, 46.09it/s] 39%|███▉      | 31/79 [00:00<00:00, 59.59it/s] 52%|█████▏    | 41/79 [00:00<00:00, 69.29it/s] 65%|██████▍   | 51/79 [00:00<00:00, 76.33it/s] 77%|███████▋  | 61/79 [00:01<00:00, 82.00it/s] 90%|████████▉ | 71/79 [00:01<00:00, 86.11it/s]100%|██████████| 79/79 [00:02<00:00, 37.53it/s]
10000 images processed, 2.132081985473633 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc2/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:42,  1.98it/s]  5%|▌         | 11/204 [00:00<00:08, 23.21it/s] 10%|█         | 21/204 [00:00<00:04, 40.33it/s] 15%|█▌        | 31/204 [00:00<00:03, 53.91it/s] 20%|██        | 41/204 [00:00<00:02, 64.62it/s] 25%|██▌       | 51/204 [00:01<00:02, 72.94it/s] 30%|██▉       | 61/204 [00:01<00:01, 79.18it/s] 35%|███▍      | 71/204 [00:01<00:01, 83.73it/s] 40%|███▉      | 81/204 [00:01<00:01, 86.93it/s] 45%|████▍     | 91/204 [00:01<00:01, 89.47it/s] 50%|████▉     | 101/204 [00:01<00:01, 91.15it/s] 54%|█████▍    | 111/204 [00:01<00:01, 91.42it/s] 59%|█████▉    | 121/204 [00:01<00:00, 92.32it/s] 64%|██████▍   | 131/204 [00:01<00:00, 92.98it/s] 69%|██████▉   | 141/204 [00:01<00:00, 93.36it/s] 74%|███████▍  | 151/204 [00:02<00:00, 93.55it/s] 79%|███████▉  | 161/204 [00:02<00:00, 93.93it/s] 84%|████████▍ | 171/204 [00:02<00:00, 94.06it/s] 89%|████████▊ | 181/204 [00:02<00:00, 94.74it/s] 94%|█████████▎| 191/204 [00:02<00:00, 95.40it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.88it/s]100%|██████████| 204/204 [00:02<00:00, 76.70it/s]
26032 images processed, 2.695737838745117 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.69it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.58it/s] 27%|██▋       | 21/79 [00:00<00:01, 37.18it/s] 39%|███▉      | 31/79 [00:00<00:00, 51.15it/s] 52%|█████▏    | 41/79 [00:01<00:00, 62.24it/s] 65%|██████▍   | 51/79 [00:01<00:00, 70.88it/s] 77%|███████▋  | 61/79 [00:01<00:00, 77.76it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.04it/s]100%|██████████| 79/79 [00:01<00:00, 56.20it/s]
10000 images processed, 1.4361658096313477 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.96it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.11it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.75it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.86it/s] 52%|█████▏    | 41/79 [00:00<00:00, 65.73it/s] 65%|██████▍   | 51/79 [00:01<00:00, 74.15it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.62it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.34it/s]100%|██████████| 79/79 [00:01<00:00, 60.01it/s]
10000 images processed, 1.3363733291625977 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:30,  2.25it/s] 14%|█▍        | 10/70 [00:00<00:02, 23.53it/s] 29%|██▊       | 20/70 [00:00<00:01, 42.67it/s] 43%|████▎     | 30/70 [00:00<00:00, 57.14it/s] 57%|█████▋    | 40/70 [00:00<00:00, 67.98it/s] 71%|███████▏  | 50/70 [00:00<00:00, 76.25it/s] 86%|████████▌ | 60/70 [00:01<00:00, 82.30it/s]100%|██████████| 70/70 [00:01<00:00, 85.81it/s]100%|██████████| 70/70 [00:01<00:00, 59.69it/s]
8925 images processed, 1.1983296871185303 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:52,  1.20s/it] 24%|██▍       | 11/45 [00:01<00:02, 11.36it/s] 38%|███▊      | 17/45 [00:01<00:02, 11.62it/s] 53%|█████▎    | 24/45 [00:01<00:01, 17.90it/s] 73%|███████▎  | 33/45 [00:02<00:00, 16.35it/s] 96%|█████████▌| 43/45 [00:02<00:00, 24.81it/s]100%|██████████| 45/45 [00:02<00:00, 16.98it/s]
5640 images processed, 2.6725316047668457 seconds used

17.613476991653442
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.61  98.76
places365     72.77  80.09
LSUN          21.69  95.81
iSUN          77.78  78.94
dtd           45.74  89.67
AVG           44.72  88.66
Retain-Acc: 0.7292
Forget-as-OOD (retain known vs forget novel):
  FPR: 45.80 AUROC: 91.98 AUIN: 99.52
8.11093258857727
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc2_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc2_rf.png
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-seen: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:01<06:38,  1.02s/it]  3%|▎         | 11/391 [00:01<00:29, 12.97it/s]  5%|▌         | 21/391 [00:01<00:14, 25.58it/s]  8%|▊         | 31/391 [00:01<00:09, 38.18it/s] 10%|█         | 41/391 [00:01<00:07, 49.97it/s] 13%|█▎        | 51/391 [00:01<00:05, 60.28it/s] 16%|█▌        | 61/391 [00:01<00:04, 68.95it/s] 18%|█▊        | 71/391 [00:01<00:04, 75.80it/s] 21%|██        | 81/391 [00:01<00:03, 81.24it/s] 23%|██▎       | 91/391 [00:01<00:03, 85.37it/s] 26%|██▌       | 101/391 [00:02<00:03, 88.42it/s] 28%|██▊       | 111/391 [00:02<00:03, 90.55it/s] 31%|███       | 121/391 [00:02<00:02, 92.06it/s] 34%|███▎      | 131/391 [00:02<00:02, 93.01it/s] 36%|███▌      | 141/391 [00:02<00:02, 93.37it/s] 39%|███▊      | 151/391 [00:02<00:02, 93.89it/s] 41%|████      | 161/391 [00:02<00:02, 94.39it/s] 44%|████▎     | 171/391 [00:02<00:02, 94.64it/s] 46%|████▋     | 181/391 [00:02<00:02, 94.82it/s] 49%|████▉     | 191/391 [00:03<00:02, 94.99it/s] 51%|█████▏    | 201/391 [00:03<00:01, 95.07it/s] 54%|█████▍    | 211/391 [00:03<00:01, 95.30it/s] 57%|█████▋    | 221/391 [00:03<00:01, 95.55it/s] 59%|█████▉    | 231/391 [00:03<00:01, 95.73it/s] 62%|██████▏   | 241/391 [00:03<00:01, 94.90it/s] 64%|██████▍   | 251/391 [00:03<00:01, 95.04it/s] 67%|██████▋   | 261/391 [00:03<00:01, 95.14it/s] 69%|██████▉   | 271/391 [00:03<00:01, 95.07it/s] 72%|███████▏  | 281/391 [00:03<00:01, 95.19it/s] 74%|███████▍  | 291/391 [00:04<00:01, 95.33it/s] 77%|███████▋  | 301/391 [00:04<00:00, 95.34it/s] 80%|███████▉  | 311/391 [00:04<00:00, 95.44it/s] 82%|████████▏ | 321/391 [00:04<00:00, 95.61it/s] 85%|████████▍ | 331/391 [00:04<00:00, 95.64it/s] 87%|████████▋ | 341/391 [00:04<00:00, 95.54it/s] 90%|████████▉ | 351/391 [00:04<00:00, 95.68it/s] 92%|█████████▏| 361/391 [00:04<00:00, 95.24it/s] 95%|█████████▍| 371/391 [00:04<00:00, 96.05it/s] 97%|█████████▋| 381/391 [00:05<00:00, 96.69it/s]100%|██████████| 391/391 [00:05<00:00, 95.02it/s]100%|██████████| 391/391 [00:05<00:00, 76.48it/s]
50000 images processed, 5.192236661911011 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:32,  2.38it/s] 14%|█▍        | 11/79 [00:00<00:02, 26.60it/s] 27%|██▋       | 21/79 [00:00<00:01, 45.03it/s] 39%|███▉      | 31/79 [00:00<00:00, 58.79it/s] 52%|█████▏    | 41/79 [00:00<00:00, 68.87it/s] 65%|██████▍   | 51/79 [00:00<00:00, 76.20it/s] 77%|███████▋  | 61/79 [00:01<00:00, 81.97it/s] 90%|████████▉ | 71/79 [00:01<00:00, 86.14it/s]100%|██████████| 79/79 [00:01<00:00, 63.17it/s]
10000 images processed, 1.2781579494476318 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-seen/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:35,  2.12it/s]  5%|▌         | 11/204 [00:00<00:07, 24.50it/s] 10%|█         | 21/204 [00:00<00:04, 42.48it/s] 15%|█▌        | 31/204 [00:00<00:03, 56.32it/s] 20%|██        | 41/204 [00:00<00:02, 66.96it/s] 25%|██▌       | 51/204 [00:01<00:02, 74.77it/s] 30%|██▉       | 61/204 [00:01<00:01, 79.77it/s] 35%|███▍      | 71/204 [00:01<00:01, 83.58it/s] 40%|███▉      | 81/204 [00:01<00:01, 86.29it/s] 45%|████▍     | 91/204 [00:01<00:01, 88.45it/s] 50%|████▉     | 101/204 [00:01<00:01, 89.61it/s] 54%|█████▍    | 111/204 [00:01<00:01, 90.78it/s] 59%|█████▉    | 121/204 [00:01<00:00, 91.60it/s] 64%|██████▍   | 131/204 [00:01<00:00, 92.13it/s] 69%|██████▉   | 141/204 [00:01<00:00, 92.48it/s] 74%|███████▍  | 151/204 [00:02<00:00, 93.08it/s] 79%|███████▉  | 161/204 [00:02<00:00, 93.48it/s] 84%|████████▍ | 171/204 [00:02<00:00, 94.00it/s] 89%|████████▊ | 181/204 [00:02<00:00, 94.79it/s] 94%|█████████▎| 191/204 [00:02<00:00, 95.48it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.98it/s]100%|██████████| 204/204 [00:02<00:00, 77.56it/s]
26032 images processed, 2.669447898864746 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.68it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.50it/s] 27%|██▋       | 21/79 [00:00<00:01, 37.01it/s] 39%|███▉      | 31/79 [00:00<00:00, 50.93it/s] 52%|█████▏    | 41/79 [00:01<00:00, 62.16it/s] 65%|██████▍   | 51/79 [00:01<00:00, 70.88it/s] 77%|███████▋  | 61/79 [00:01<00:00, 77.71it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.83it/s]100%|██████████| 79/79 [00:01<00:00, 56.02it/s]
10000 images processed, 1.4319818019866943 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:37,  2.06it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.94it/s] 25%|██▌       | 20/79 [00:00<00:01, 40.56it/s] 38%|███▊      | 30/79 [00:00<00:00, 55.06it/s] 51%|█████     | 40/79 [00:00<00:00, 66.20it/s] 63%|██████▎   | 50/79 [00:01<00:00, 74.55it/s] 76%|███████▌  | 60/79 [00:01<00:00, 81.00it/s] 89%|████████▊ | 70/79 [00:01<00:00, 85.61it/s]100%|██████████| 79/79 [00:01<00:00, 60.84it/s]
10000 images processed, 1.3182532787322998 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:38,  1.81it/s] 16%|█▌        | 11/70 [00:00<00:02, 21.79it/s] 30%|███       | 21/70 [00:00<00:01, 38.96it/s] 44%|████▍     | 31/70 [00:00<00:00, 53.06it/s] 59%|█████▊    | 41/70 [00:00<00:00, 64.12it/s] 73%|███████▎  | 51/70 [00:01<00:00, 72.81it/s] 87%|████████▋ | 61/70 [00:01<00:00, 79.27it/s]100%|██████████| 70/70 [00:01<00:00, 54.50it/s]
8925 images processed, 1.3245091438293457 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:57,  1.31s/it]  7%|▋         | 3/45 [00:01<00:15,  2.65it/s] 24%|██▍       | 11/45 [00:01<00:02, 12.11it/s] 36%|███▌      | 16/45 [00:01<00:01, 16.24it/s] 44%|████▍     | 20/45 [00:01<00:01, 15.98it/s] 51%|█████     | 23/45 [00:02<00:01, 15.01it/s] 67%|██████▋   | 30/45 [00:02<00:00, 22.56it/s] 76%|███████▌  | 34/45 [00:02<00:00, 17.91it/s] 98%|█████████▊| 44/45 [00:02<00:00, 30.05it/s]100%|██████████| 45/45 [00:02<00:00, 16.29it/s]
5640 images processed, 2.7826948165893555 seconds used

17.535414457321167
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.73  98.74
places365     73.22  79.90
LSUN          22.69  95.67
iSUN          78.29  78.54
dtd           46.47  89.50
AVG           45.28  88.47
Retain-Acc: 0.7328
Forget-as-OOD (retain known vs forget novel):
  FPR: 43.50 AUROC: 90.86 AUIN: 98.79
7.622877359390259
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-seen_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-seen_rf.png
