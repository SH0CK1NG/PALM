nohup: ignoring input
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,11,40,51,57,66,67,88,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1.pt', load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=0.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=False, lora_impl='native', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='head', adapter_save_path=None, adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,57,66,67,88,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='randlabel', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
[debug] trainable_count = 112
[debug] trainable: encoder.conv1.weight
[debug] trainable: encoder.bn1.weight
[debug] trainable: encoder.bn1.bias
[debug] trainable: encoder.layer1.0.conv1.weight
[debug] trainable: encoder.layer1.0.bn1.weight
[debug] trainable: encoder.layer1.0.bn1.bias
[debug] trainable: encoder.layer1.0.conv2.weight
[debug] trainable: encoder.layer1.0.bn2.weight
[debug] trainable: encoder.layer1.0.bn2.bias
[debug] trainable: encoder.layer1.1.conv1.weight
[debug] trainable: encoder.layer1.1.bn1.weight
[debug] trainable: encoder.layer1.1.bn1.bias
[debug] trainable: encoder.layer1.1.conv2.weight
[debug] trainable: encoder.layer1.1.bn2.weight
[debug] trainable: encoder.layer1.1.bn2.bias
[debug] trainable: encoder.layer1.2.conv1.weight
[debug] trainable: encoder.layer1.2.bn1.weight
[debug] trainable: encoder.layer1.2.bn1.bias
[debug] trainable: encoder.layer1.2.conv2.weight
[debug] trainable: encoder.layer1.2.bn2.weight
[debug] trainable: encoder.layer1.2.bn2.bias
[debug] trainable: encoder.layer2.0.conv1.weight
[debug] trainable: encoder.layer2.0.bn1.weight
[debug] trainable: encoder.layer2.0.bn1.bias
[debug] trainable: encoder.layer2.0.conv2.weight
[debug] trainable: encoder.layer2.0.bn2.weight
[debug] trainable: encoder.layer2.0.bn2.bias
[debug] trainable: encoder.layer2.0.shortcut.0.weight
[debug] trainable: encoder.layer2.0.shortcut.1.weight
[debug] trainable: encoder.layer2.0.shortcut.1.bias
[debug] trainable: encoder.layer2.1.conv1.weight
[debug] trainable: encoder.layer2.1.bn1.weight
[debug] trainable: encoder.layer2.1.bn1.bias
[debug] trainable: encoder.layer2.1.conv2.weight
[debug] trainable: encoder.layer2.1.bn2.weight
[debug] trainable: encoder.layer2.1.bn2.bias
[debug] trainable: encoder.layer2.2.conv1.weight
[debug] trainable: encoder.layer2.2.bn1.weight
[debug] trainable: encoder.layer2.2.bn1.bias
[debug] trainable: encoder.layer2.2.conv2.weight
[debug] trainable: encoder.layer2.2.bn2.weight
[debug] trainable: encoder.layer2.2.bn2.bias
[debug] trainable: encoder.layer2.3.conv1.weight
[debug] trainable: encoder.layer2.3.bn1.weight
[debug] trainable: encoder.layer2.3.bn1.bias
[debug] trainable: encoder.layer2.3.conv2.weight
[debug] trainable: encoder.layer2.3.bn2.weight
[debug] trainable: encoder.layer2.3.bn2.bias
[debug] trainable: encoder.layer3.0.conv1.weight
[debug] trainable: encoder.layer3.0.bn1.weight
[debug][warn] non-LoRA trainables detected: ['encoder.conv1.weight', 'encoder.bn1.weight', 'encoder.bn1.bias', 'encoder.layer1.0.conv1.weight', 'encoder.layer1.0.bn1.weight', 'encoder.layer1.0.bn1.bias', 'encoder.layer1.0.conv2.weight', 'encoder.layer1.0.bn2.weight', 'encoder.layer1.0.bn2.bias', 'encoder.layer1.1.conv1.weight']
[trainable] param_count=21605312 tensors=112
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:553: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=bool(scaler is not None)):
/home/shaokun/PALM/trainer.py:641: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/torch/csrc/autograd/generated/python_variable_methods.cpp:835.)
  print(f"[loss-{args.forget_strategy}] ep {epoch} it {it} total={loss.item():.4f} ce_r={float(loss_retain):.4f} ce_f={float(loss_forget):.4f}")
  2%|▏         | 1/50 [00:40<33:13, 40.68s/it]  4%|▍         | 2/50 [00:57<21:26, 26.80s/it]  6%|▌         | 3/50 [01:16<18:04, 23.07s/it]  8%|▊         | 4/50 [01:36<16:54, 22.06s/it] 10%|█         | 5/50 [01:53<15:08, 20.19s/it] 12%|█▏        | 6/50 [02:11<14:07, 19.26s/it] 14%|█▍        | 7/50 [02:29<13:29, 18.82s/it] 16%|█▌        | 8/50 [02:47<13:01, 18.60s/it] 18%|█▊        | 9/50 [03:04<12:28, 18.25s/it] 20%|██        | 10/50 [03:22<12:04, 18.10s/it] 22%|██▏       | 11/50 [03:40<11:38, 17.92s/it] 24%|██▍       | 12/50 [03:56<11:08, 17.59s/it] 26%|██▌       | 13/50 [04:13<10:38, 17.26s/it] 28%|██▊       | 14/50 [04:31<10:28, 17.45s/it][loss-randlabel] ep 0 it 0 total=2.1038 ce_r=0.0101 ce_f=10.4683
[loss-randlabel] ep 0 it 50 total=2.2193 ce_r=0.0281 ce_f=10.9559
[loss-randlabel] ep 0 it 100 total=1.8397 ce_r=0.0230 ce_f=9.0836
[loss-randlabel] ep 0 it 150 total=2.1567 ce_r=0.0190 ce_f=10.6882
[loss-randlabel] ep 0 it 200 total=2.0305 ce_r=0.0089 ce_f=10.1078
[loss-randlabel] ep 0 it 250 total=1.9847 ce_r=0.0184 ce_f=9.8315
[loss-randlabel] ep 0 it 300 total=1.6623 ce_r=0.0313 ce_f=8.1548
[loss-randlabel] ep 0 it 350 total=1.8204 ce_r=0.0142 ce_f=9.0307
[loss-randlabel] ep 0 it 400 total=1.4822 ce_r=0.0662 ce_f=7.0800
[loss-randlabel] ep 1 it 20 total=1.6381 ce_r=0.0975 ce_f=7.7030
[loss-randlabel] ep 1 it 70 total=1.4722 ce_r=0.0726 ce_f=6.9978
[loss-randlabel] ep 1 it 120 total=1.1391 ce_r=0.0336 ce_f=5.5274
[loss-randlabel] ep 1 it 170 total=1.2416 ce_r=0.0650 ce_f=5.8831
[loss-randlabel] ep 1 it 220 total=1.0383 ce_r=0.0360 ce_f=5.0118
[loss-randlabel] ep 1 it 270 total=1.3277 ce_r=0.0443 ce_f=6.4171
[loss-randlabel] ep 1 it 320 total=1.1886 ce_r=0.0317 ce_f=5.7846
[loss-randlabel] ep 1 it 370 total=0.9204 ce_r=0.0341 ce_f=4.4318
[loss-randlabel] ep 1 it 420 total=1.0817 ce_r=0.0205 ce_f=5.3060
[loss-randlabel] ep 2 it 40 total=1.1349 ce_r=0.0306 ce_f=5.5216
[loss-randlabel] ep 2 it 90 total=1.0101 ce_r=0.0357 ce_f=4.8721
[loss-randlabel] ep 2 it 140 total=1.2548 ce_r=0.0288 ce_f=6.1301
[loss-randlabel] ep 2 it 190 total=1.0013 ce_r=0.0335 ce_f=4.8393
[loss-randlabel] ep 2 it 240 total=0.9464 ce_r=0.0265 ce_f=4.5995
[loss-randlabel] ep 2 it 290 total=1.1310 ce_r=0.0366 ce_f=5.4719
[loss-randlabel] ep 2 it 340 total=1.0505 ce_r=0.0298 ce_f=5.1034
[loss-randlabel] ep 2 it 390 total=1.0013 ce_r=0.0273 ce_f=4.8700
[loss-randlabel] ep 3 it 10 total=1.2808 ce_r=0.1117 ce_f=5.8453
[loss-randlabel] ep 3 it 60 total=1.0156 ce_r=0.0559 ce_f=4.7981
[loss-randlabel] ep 3 it 110 total=1.1570 ce_r=0.0473 ce_f=5.5488
[loss-randlabel] ep 3 it 160 total=1.0354 ce_r=0.0461 ce_f=4.9466
[loss-randlabel] ep 3 it 210 total=1.0537 ce_r=0.0448 ce_f=5.0442
[loss-randlabel] ep 3 it 260 total=1.1097 ce_r=0.0963 ce_f=5.0672
[loss-randlabel] ep 3 it 310 total=0.9747 ce_r=0.0272 ce_f=4.7375
[loss-randlabel] ep 3 it 360 total=1.0666 ce_r=0.0387 ce_f=5.1393
[loss-randlabel] ep 3 it 410 total=1.0616 ce_r=0.0654 ce_f=4.9810
[loss-randlabel] ep 4 it 30 total=1.1106 ce_r=0.0316 ce_f=5.3948
[loss-randlabel] ep 4 it 80 total=1.1297 ce_r=0.0877 ce_f=5.2099
[loss-randlabel] ep 4 it 130 total=1.1574 ce_r=0.0408 ce_f=5.5832
[loss-randlabel] ep 4 it 180 total=0.9068 ce_r=0.0186 ce_f=4.4408
[loss-randlabel] ep 4 it 230 total=1.0385 ce_r=0.0550 ce_f=4.9177
[loss-randlabel] ep 4 it 280 total=1.1524 ce_r=0.0224 ce_f=5.6500
[loss-randlabel] ep 4 it 330 total=1.1516 ce_r=0.0464 ce_f=5.5259
[loss-randlabel] ep 4 it 380 total=1.0215 ce_r=0.0618 ce_f=4.7985
[loss-randlabel] ep 5 it 0 total=1.0122 ce_r=0.0449 ce_f=4.8367
[loss-randlabel] ep 5 it 50 total=1.0225 ce_r=0.0496 ce_f=4.8647
[loss-randlabel] ep 5 it 100 total=1.0066 ce_r=0.0453 ce_f=4.8065
[loss-randlabel] ep 5 it 150 total=0.9681 ce_r=0.0328 ce_f=4.6762
[loss-randlabel] ep 5 it 200 total=1.0075 ce_r=0.0356 ce_f=4.8592
[loss-randlabel] ep 5 it 250 total=0.9240 ce_r=0.0592 ce_f=4.3242
[loss-randlabel] ep 5 it 300 total=0.9703 ce_r=0.0358 ce_f=4.6724
[loss-randlabel] ep 5 it 350 total=1.0940 ce_r=0.0338 ce_f=5.3008
[loss-randlabel] ep 5 it 400 total=1.0253 ce_r=0.0348 ce_f=4.9525
[loss-randlabel] ep 6 it 20 total=1.1538 ce_r=0.0579 ce_f=5.4792
[loss-randlabel] ep 6 it 70 total=0.9847 ce_r=0.0403 ce_f=4.7216
[loss-randlabel] ep 6 it 120 total=1.1711 ce_r=0.0795 ce_f=5.4578
[loss-randlabel] ep 6 it 170 total=0.9506 ce_r=0.0297 ce_f=4.6044
[loss-randlabel] ep 6 it 220 total=0.9670 ce_r=0.0525 ce_f=4.5725
[loss-randlabel] ep 6 it 270 total=1.0325 ce_r=0.0160 ce_f=5.0825
[loss-randlabel] ep 6 it 320 total=1.0188 ce_r=0.0224 ce_f=4.9819
[loss-randlabel] ep 6 it 370 total=0.9930 ce_r=0.0249 ce_f=4.8404
[loss-randlabel] ep 6 it 420 total=1.0640 ce_r=0.0414 ce_f=5.1134
[loss-randlabel] ep 7 it 40 total=0.9929 ce_r=0.0457 ce_f=4.7359
[loss-randlabel] ep 7 it 90 total=1.0109 ce_r=0.0392 ce_f=4.8588
[loss-randlabel] ep 7 it 140 total=1.0294 ce_r=0.0408 ce_f=4.9431
[loss-randlabel] ep 7 it 190 total=0.9870 ce_r=0.0656 ce_f=4.6070
[loss-randlabel] ep 7 it 240 total=0.9969 ce_r=0.0525 ce_f=4.7219
[loss-randlabel] ep 7 it 290 total=0.9166 ce_r=0.0213 ce_f=4.4763
[loss-randlabel] ep 7 it 340 total=0.9769 ce_r=0.0215 ce_f=4.7769
[loss-randlabel] ep 7 it 390 total=1.0448 ce_r=0.0202 ce_f=5.1228
[loss-randlabel] ep 8 it 10 total=1.0609 ce_r=0.0127 ce_f=5.2409
[loss-randlabel] ep 8 it 60 total=0.9675 ce_r=0.0264 ce_f=4.7055
[loss-randlabel] ep 8 it 110 total=0.8871 ce_r=0.0199 ce_f=4.3362
[loss-randlabel] ep 8 it 160 total=0.9718 ce_r=0.0177 ce_f=4.7709
[loss-randlabel] ep 8 it 210 total=1.0200 ce_r=0.0464 ce_f=4.8678
[loss-randlabel] ep 8 it 260 total=1.0717 ce_r=0.0803 ce_f=4.9571
[loss-randlabel] ep 8 it 310 total=1.0014 ce_r=0.0198 ce_f=4.9078
[loss-randlabel] ep 8 it 360 total=1.0487 ce_r=0.0167 ce_f=5.1599
[loss-randlabel] ep 8 it 410 total=1.0220 ce_r=0.0368 ce_f=4.9260
[loss-randlabel] ep 9 it 30 total=0.9997 ce_r=0.0403 ce_f=4.7967
[loss-randlabel] ep 9 it 80 total=0.9618 ce_r=0.0144 ce_f=4.7373
[loss-randlabel] ep 9 it 130 total=0.9319 ce_r=0.0253 ce_f=4.5331
[loss-randlabel] ep 9 it 180 total=1.0334 ce_r=0.0365 ce_f=4.9846
[loss-randlabel] ep 9 it 230 total=0.9846 ce_r=0.0330 ce_f=4.7580
[loss-randlabel] ep 9 it 280 total=0.9440 ce_r=0.0501 ce_f=4.4693
[loss-randlabel] ep 9 it 330 total=0.9441 ce_r=0.0428 ce_f=4.5067
[loss-randlabel] ep 9 it 380 total=0.9927 ce_r=0.0424 ce_f=4.7514
[loss-randlabel] ep 10 it 0 total=0.9768 ce_r=0.0190 ce_f=4.7889
[loss-randlabel] ep 10 it 50 total=0.9783 ce_r=0.0145 ce_f=4.8189
[loss-randlabel] ep 10 it 100 total=0.9718 ce_r=0.0249 ce_f=4.7348
[loss-randlabel] ep 10 it 150 total=1.0390 ce_r=0.0738 ce_f=4.8255
[loss-randlabel] ep 10 it 200 total=0.9719 ce_r=0.0198 ce_f=4.7604
[loss-randlabel] ep 10 it 250 total=0.9796 ce_r=0.0192 ce_f=4.8018
[loss-randlabel] ep 10 it 300 total=0.9764 ce_r=0.0203 ce_f=4.7807
[loss-randlabel] ep 10 it 350 total=0.9652 ce_r=0.0153 ce_f=4.7492
[loss-randlabel] ep 10 it 400 total=0.9700 ce_r=0.0249 ce_f=4.7257
[loss-randlabel] ep 11 it 20 total=0.8643 ce_r=0.0088 ce_f=4.2777
[loss-randlabel] ep 11 it 70 total=1.0628 ce_r=0.0385 ce_f=5.1219
[loss-randlabel] ep 11 it 120 total=0.9510 ce_r=0.0141 ce_f=4.6844
[loss-randlabel] ep 11 it 170 total=1.0120 ce_r=0.0159 ce_f=4.9803
[loss-randlabel] ep 11 it 220 total=1.0326 ce_r=0.0265 ce_f=5.0307
[loss-randlabel] ep 11 it 270 total=0.9961 ce_r=0.0591 ce_f=4.6849
[loss-randlabel] ep 11 it 320 total=1.0638 ce_r=0.0194 ce_f=5.2219
[loss-randlabel] ep 11 it 370 total=0.9644 ce_r=0.0268 ce_f=4.6879
[loss-randlabel] ep 11 it 420 total=0.9793 ce_r=0.0296 ce_f=4.7485
[loss-randlabel] ep 12 it 40 total=0.9397 ce_r=0.0287 ce_f=4.5548
[loss-randlabel] ep 12 it 90 total=1.1072 ce_r=0.0307 ce_f=5.3824
[loss-randlabel] ep 12 it 140 total=1.0389 ce_r=0.0358 ce_f=5.0153
[loss-randlabel] ep 12 it 190 total=0.9348 ce_r=0.0299 ce_f=4.5246
[loss-randlabel] ep 12 it 240 total=1.0467 ce_r=0.0203 ce_f=5.1322
[loss-randlabel] ep 12 it 290 total=1.0017 ce_r=0.0167 ce_f=4.9249
[loss-randlabel] ep 12 it 340 total=1.0476 ce_r=0.0194 ce_f=5.1411
[loss-randlabel] ep 12 it 390 total=0.9906 ce_r=0.0154 ce_f=4.8764
[loss-randlabel] ep 13 it 10 total=0.9320 ce_r=0.0385 ce_f=4.4678
[loss-randlabel] ep 13 it 60 total=1.0498 ce_r=0.0374 ce_f=5.0620
[loss-randlabel] ep 13 it 110 total=1.0092 ce_r=0.0309 ce_f=4.8914
[loss-randlabel] ep 13 it 160 total=0.9639 ce_r=0.0184 ce_f=4.7272
[loss-randlabel] ep 13 it 210 total=0.9654 ce_r=0.0166 ce_f=4.7440
[loss-randlabel] ep 13 it 260 total=0.9554 ce_r=0.0327 ce_f=4.6136
[loss-randlabel] ep 13 it 310 total=0.9884 ce_r=0.0182 ce_f=4.8511
[loss-randlabel] ep 13 it 360 total=0.9815 ce_r=0.0386 ce_f=4.7144
[loss-randlabel] ep 13 it 410 total=0.9703 ce_r=0.0114 ce_f=4.7948
[loss-randlabel] ep 14 it 30 total=0.9428 ce_r=0.0204 ce_f=4.6120
[loss-randlabel] ep 14 it 80 total=0.9783 ce_r=0.0325 ce_f=4.7291
[loss-randlabel] ep 14 it 130 total=1.0061 ce_r=0.0144 ce_f=4.9586 30%|███       | 15/50 [04:48<10:07, 17.35s/it] 32%|███▏      | 16/50 [05:05<09:51, 17.39s/it] 34%|███▍      | 17/50 [05:23<09:32, 17.36s/it] 36%|███▌      | 18/50 [05:40<09:14, 17.32s/it] 38%|███▊      | 19/50 [05:58<09:02, 17.51s/it] 40%|████      | 20/50 [06:15<08:38, 17.28s/it] 42%|████▏     | 21/50 [06:31<08:16, 17.11s/it] 44%|████▍     | 22/50 [06:48<07:53, 16.91s/it] 46%|████▌     | 23/50 [07:05<07:40, 17.05s/it] 48%|████▊     | 24/50 [07:22<07:21, 16.97s/it] 50%|█████     | 25/50 [07:38<06:59, 16.77s/it] 52%|█████▏    | 26/50 [07:55<06:41, 16.75s/it] 54%|█████▍    | 27/50 [08:13<06:33, 17.09s/it] 56%|█████▌    | 28/50 [08:29<06:12, 16.92s/it]
[loss-randlabel] ep 14 it 180 total=0.9510 ce_r=0.0132 ce_f=4.6890
[loss-randlabel] ep 14 it 230 total=1.0114 ce_r=0.1036 ce_f=4.5388
[loss-randlabel] ep 14 it 280 total=1.0097 ce_r=0.0475 ce_f=4.8113
[loss-randlabel] ep 14 it 330 total=0.9591 ce_r=0.0174 ce_f=4.7085
[loss-randlabel] ep 14 it 380 total=0.9781 ce_r=0.0137 ce_f=4.8219
[loss-randlabel] ep 15 it 0 total=0.9725 ce_r=0.0156 ce_f=4.7842
[loss-randlabel] ep 15 it 50 total=1.0348 ce_r=0.0293 ce_f=5.0278
[loss-randlabel] ep 15 it 100 total=0.9497 ce_r=0.0196 ce_f=4.6506
[loss-randlabel] ep 15 it 150 total=0.9570 ce_r=0.0105 ce_f=4.7323
[loss-randlabel] ep 15 it 200 total=0.9767 ce_r=0.0161 ce_f=4.8030
[loss-randlabel] ep 15 it 250 total=1.0226 ce_r=0.0199 ce_f=5.0136
[loss-randlabel] ep 15 it 300 total=1.0875 ce_r=0.0304 ce_f=5.2854
[loss-randlabel] ep 15 it 350 total=0.9786 ce_r=0.0136 ce_f=4.8246
[loss-randlabel] ep 15 it 400 total=0.9572 ce_r=0.0191 ce_f=4.6905
[loss-randlabel] ep 16 it 20 total=0.9982 ce_r=0.0560 ce_f=4.7112
[loss-randlabel] ep 16 it 70 total=0.9880 ce_r=0.0160 ce_f=4.8602
[loss-randlabel] ep 16 it 120 total=0.9848 ce_r=0.0155 ce_f=4.8467
[loss-randlabel] ep 16 it 170 total=0.9544 ce_r=0.0169 ce_f=4.6875
[loss-randlabel] ep 16 it 220 total=0.9510 ce_r=0.0090 ce_f=4.7101
[loss-randlabel] ep 16 it 270 total=0.9595 ce_r=0.0298 ce_f=4.6483
[loss-randlabel] ep 16 it 320 total=0.9680 ce_r=0.0126 ce_f=4.7768
[loss-randlabel] ep 16 it 370 total=1.0094 ce_r=0.0692 ce_f=4.7010
[loss-randlabel] ep 16 it 420 total=0.9572 ce_r=0.0165 ce_f=4.7036
[loss-randlabel] ep 17 it 40 total=0.9579 ce_r=0.0184 ce_f=4.6978
[loss-randlabel] ep 17 it 90 total=0.9647 ce_r=0.0202 ce_f=4.7227
[loss-randlabel] ep 17 it 140 total=0.9844 ce_r=0.0061 ce_f=4.8916
[loss-randlabel] ep 17 it 190 total=1.0242 ce_r=0.0630 ce_f=4.8062
[loss-randlabel] ep 17 it 240 total=0.9827 ce_r=0.0109 ce_f=4.8589
[loss-randlabel] ep 17 it 290 total=1.0634 ce_r=0.0616 ce_f=5.0092
[loss-randlabel] ep 17 it 340 total=0.9566 ce_r=0.0119 ce_f=4.7232
[loss-randlabel] ep 17 it 390 total=1.0135 ce_r=0.0239 ce_f=4.9479
[loss-randlabel] ep 18 it 10 total=1.0098 ce_r=0.0246 ce_f=4.9262
[loss-randlabel] ep 18 it 60 total=0.9597 ce_r=0.0359 ce_f=4.6190
[loss-randlabel] ep 18 it 110 total=0.9977 ce_r=0.0154 ce_f=4.9118
[loss-randlabel] ep 18 it 160 total=0.9279 ce_r=0.0080 ce_f=4.6000
[loss-randlabel] ep 18 it 210 total=1.0084 ce_r=0.0179 ce_f=4.9527
[loss-randlabel] ep 18 it 260 total=0.9787 ce_r=0.0190 ce_f=4.7984
[loss-randlabel] ep 18 it 310 total=1.0542 ce_r=0.0604 ce_f=4.9692
[loss-randlabel] ep 18 it 360 total=1.0345 ce_r=0.0401 ce_f=4.9721
[loss-randlabel] ep 18 it 410 total=0.9986 ce_r=0.0316 ce_f=4.8354
[loss-randlabel] ep 19 it 30 total=1.0755 ce_r=0.0603 ce_f=5.0760
[loss-randlabel] ep 19 it 80 total=0.9900 ce_r=0.0469 ce_f=4.7155
[loss-randlabel] ep 19 it 130 total=1.0342 ce_r=0.0332 ce_f=5.0051
[loss-randlabel] ep 19 it 180 total=1.0007 ce_r=0.0542 ce_f=4.7324
[loss-randlabel] ep 19 it 230 total=1.0182 ce_r=0.0246 ce_f=4.9683
[loss-randlabel] ep 19 it 280 total=0.9509 ce_r=0.0134 ce_f=4.6875
[loss-randlabel] ep 19 it 330 total=0.9605 ce_r=0.0128 ce_f=4.7389
[loss-randlabel] ep 19 it 380 total=0.9603 ce_r=0.0234 ce_f=4.6846
[loss-randlabel] ep 20 it 0 total=1.0016 ce_r=0.0361 ce_f=4.8272
[loss-randlabel] ep 20 it 50 total=1.0088 ce_r=0.0290 ce_f=4.8987
[loss-randlabel] ep 20 it 100 total=0.9557 ce_r=0.0244 ce_f=4.6564
[loss-randlabel] ep 20 it 150 total=1.0283 ce_r=0.0560 ce_f=4.8615
[loss-randlabel] ep 20 it 200 total=0.9666 ce_r=0.0130 ce_f=4.7678
[loss-randlabel] ep 20 it 250 total=0.9638 ce_r=0.0235 ce_f=4.7014
[loss-randlabel] ep 20 it 300 total=0.9768 ce_r=0.0302 ce_f=4.7332
[loss-randlabel] ep 20 it 350 total=0.9487 ce_r=0.0404 ce_f=4.5415
[loss-randlabel] ep 20 it 400 total=1.0866 ce_r=0.0229 ce_f=5.3183
[loss-randlabel] ep 21 it 20 total=0.9705 ce_r=0.0248 ce_f=4.7285
[loss-randlabel] ep 21 it 70 total=0.9439 ce_r=0.0235 ce_f=4.6022
[loss-randlabel] ep 21 it 120 total=1.0080 ce_r=0.0193 ce_f=4.9437
[loss-randlabel] ep 21 it 170 total=1.0112 ce_r=0.0480 ce_f=4.8159
[loss-randlabel] ep 21 it 220 total=0.9367 ce_r=0.0168 ce_f=4.5995
[loss-randlabel] ep 21 it 270 total=0.9773 ce_r=0.0474 ce_f=4.6496
[loss-randlabel] ep 21 it 320 total=1.0042 ce_r=0.0586 ce_f=4.7279
[loss-randlabel] ep 21 it 370 total=0.9451 ce_r=0.0150 ce_f=4.6503
[loss-randlabel] ep 21 it 420 total=0.9989 ce_r=0.0292 ce_f=4.8488
[loss-randlabel] ep 22 it 40 total=0.9837 ce_r=0.0109 ce_f=4.8640
[loss-randlabel] ep 22 it 90 total=0.9633 ce_r=0.0131 ce_f=4.7512
[loss-randlabel] ep 22 it 140 total=1.0264 ce_r=0.0349 ce_f=4.9577
[loss-randlabel] ep 22 it 190 total=0.9578 ce_r=0.0121 ce_f=4.7283
[loss-randlabel] ep 22 it 240 total=0.9848 ce_r=0.0144 ce_f=4.8524
[loss-randlabel] ep 22 it 290 total=1.0011 ce_r=0.0428 ce_f=4.7916
[loss-randlabel] ep 22 it 340 total=0.9953 ce_r=0.0420 ce_f=4.7662
[loss-randlabel] ep 22 it 390 total=0.9482 ce_r=0.0135 ce_f=4.6739
[loss-randlabel] ep 23 it 10 total=1.0314 ce_r=0.0830 ce_f=4.7422
[loss-randlabel] ep 23 it 60 total=0.9537 ce_r=0.0140 ce_f=4.6986
[loss-randlabel] ep 23 it 110 total=0.9577 ce_r=0.0379 ce_f=4.5991
[loss-randlabel] ep 23 it 160 total=0.9782 ce_r=0.0455 ce_f=4.6636
[loss-randlabel] ep 23 it 210 total=1.0151 ce_r=0.0368 ce_f=4.8915
[loss-randlabel] ep 23 it 260 total=0.8965 ce_r=0.0286 ce_f=4.3394
[loss-randlabel] ep 23 it 310 total=1.0207 ce_r=0.0548 ce_f=4.8296
[loss-randlabel] ep 23 it 360 total=0.9772 ce_r=0.0112 ce_f=4.8299
[loss-randlabel] ep 23 it 410 total=1.0063 ce_r=0.0489 ce_f=4.7868
[loss-randlabel] ep 24 it 30 total=1.0019 ce_r=0.0140 ce_f=4.9395
[loss-randlabel] ep 24 it 80 total=1.0856 ce_r=0.0399 ce_f=5.2287
[loss-randlabel] ep 24 it 130 total=0.9508 ce_r=0.0164 ce_f=4.6723
[loss-randlabel] ep 24 it 180 total=0.9203 ce_r=0.0241 ce_f=4.4813
[loss-randlabel] ep 24 it 230 total=0.9551 ce_r=0.0111 ce_f=4.7201
[loss-randlabel] ep 24 it 280 total=0.9568 ce_r=0.0346 ce_f=4.6108
[loss-randlabel] ep 24 it 330 total=1.0011 ce_r=0.0165 ce_f=4.9230
[loss-randlabel] ep 24 it 380 total=0.9910 ce_r=0.0324 ce_f=4.7932
[loss-randlabel] ep 25 it 0 total=0.9310 ce_r=0.0118 ce_f=4.5964
[loss-randlabel] ep 25 it 50 total=0.9358 ce_r=0.0107 ce_f=4.6257
[loss-randlabel] ep 25 it 100 total=0.9184 ce_r=0.0230 ce_f=4.4772
[loss-randlabel] ep 25 it 150 total=0.9744 ce_r=0.0285 ce_f=4.7295
[loss-randlabel] ep 25 it 200 total=1.1583 ce_r=0.0214 ce_f=5.6847
[loss-randlabel] ep 25 it 250 total=1.0039 ce_r=0.0522 ce_f=4.7588
[loss-randlabel] ep 25 it 300 total=0.9502 ce_r=0.0099 ce_f=4.7016
[loss-randlabel] ep 25 it 350 total=0.9864 ce_r=0.0123 ce_f=4.8705
[loss-randlabel] ep 25 it 400 total=1.0008 ce_r=0.0428 ce_f=4.7903
[loss-randlabel] ep 26 it 20 total=1.0219 ce_r=0.0149 ce_f=5.0350
[loss-randlabel] ep 26 it 70 total=0.9518 ce_r=0.0169 ce_f=4.6747
[loss-randlabel] ep 26 it 120 total=0.9652 ce_r=0.0129 ce_f=4.7617
[loss-randlabel] ep 26 it 170 total=0.9266 ce_r=0.0126 ce_f=4.5698
[loss-randlabel] ep 26 it 220 total=1.0111 ce_r=0.0267 ce_f=4.9220
[loss-randlabel] ep 26 it 270 total=0.9932 ce_r=0.0120 ce_f=4.9064
[loss-randlabel] ep 26 it 320 total=1.0037 ce_r=0.0257 ce_f=4.8897
[loss-randlabel] ep 26 it 370 total=0.9548 ce_r=0.0130 ce_f=4.7091
[loss-randlabel] ep 26 it 420 total=0.9897 ce_r=0.0255 ce_f=4.8212
[loss-randlabel] ep 27 it 40 total=0.9422 ce_r=0.0170 ce_f=4.6261
[loss-randlabel] ep 27 it 90 total=0.9575 ce_r=0.0149 ce_f=4.7131
[loss-randlabel] ep 27 it 140 total=0.9664 ce_r=0.0099 ce_f=4.7825
[loss-randlabel] ep 27 it 190 total=0.9784 ce_r=0.0121 ce_f=4.8315
[loss-randlabel] ep 27 it 240 total=1.0117 ce_r=0.0532 ce_f=4.7922
[loss-randlabel] ep 27 it 290 total=1.0245 ce_r=0.0280 ce_f=4.9821
[loss-randlabel] ep 27 it 340 total=0.9747 ce_r=0.0115 ce_f=4.8158
[loss-randlabel] ep 27 it 390 total=1.0220 ce_r=0.0143 ce_f=5.0383
[loss-randlabel] ep 28 it 10 total=1.0307 ce_r=0.0554 ce_f=4.8766
[loss-randlabel] ep 28 it 60 total=0.9513 ce_r=0.0131 ce_f=4.6908
[loss-randlabel] ep 28 it 110 total=0.9416 ce_r=0.0061 ce_f=4.6775
[loss-randlabel] ep 28 it 160 total=0.9616 ce_r=0.0115 ce_f=4.7503
[loss-randlabel] ep 28 it 210 total=1.0349 ce_r=0.0842 ce_f=4.7538
 58%|█████▊    | 29/50 [08:46<05:54, 16.89s/it] 60%|██████    | 30/50 [09:04<05:41, 17.08s/it] 62%|██████▏   | 31/50 [09:22<05:32, 17.50s/it] 64%|██████▍   | 32/50 [09:39<05:09, 17.20s/it] 66%|██████▌   | 33/50 [09:56<04:54, 17.34s/it] 68%|██████▊   | 34/50 [10:14<04:40, 17.50s/it] 70%|███████   | 35/50 [10:32<04:23, 17.59s/it] 72%|███████▏  | 36/50 [10:49<04:05, 17.53s/it] 74%|███████▍  | 37/50 [11:05<03:40, 16.99s/it] 76%|███████▌  | 38/50 [11:22<03:22, 16.85s/it] 78%|███████▊  | 39/50 [11:38<03:04, 16.79s/it] 80%|████████  | 40/50 [11:55<02:47, 16.71s/it] 82%|████████▏ | 41/50 [12:12<02:32, 16.93s/it] 84%|████████▍ | 42/50 [12:29<02:16, 17.01s/it][loss-randlabel] ep 28 it 260 total=1.0239 ce_r=0.0465 ce_f=4.8868
[loss-randlabel] ep 28 it 310 total=0.9850 ce_r=0.0331 ce_f=4.7599
[loss-randlabel] ep 28 it 360 total=0.9787 ce_r=0.0364 ce_f=4.7118
[loss-randlabel] ep 28 it 410 total=0.9801 ce_r=0.0330 ce_f=4.7356
[loss-randlabel] ep 29 it 30 total=0.9454 ce_r=0.0174 ce_f=4.6399
[loss-randlabel] ep 29 it 80 total=1.0155 ce_r=0.0336 ce_f=4.9096
[loss-randlabel] ep 29 it 130 total=1.0117 ce_r=0.0370 ce_f=4.8737
[loss-randlabel] ep 29 it 180 total=0.9615 ce_r=0.0101 ce_f=4.7572
[loss-randlabel] ep 29 it 230 total=1.0019 ce_r=0.0541 ce_f=4.7394
[loss-randlabel] ep 29 it 280 total=0.9816 ce_r=0.0152 ce_f=4.8320
[loss-randlabel] ep 29 it 330 total=0.9697 ce_r=0.0258 ce_f=4.7194
[loss-randlabel] ep 29 it 380 total=0.9925 ce_r=0.0136 ce_f=4.8943
[loss-randlabel] ep 30 it 0 total=0.9573 ce_r=0.0375 ce_f=4.5993
[loss-randlabel] ep 30 it 50 total=0.9517 ce_r=0.0151 ce_f=4.6828
[loss-randlabel] ep 30 it 100 total=1.0211 ce_r=0.0396 ce_f=4.9071
[loss-randlabel] ep 30 it 150 total=0.9356 ce_r=0.0115 ce_f=4.6203
[loss-randlabel] ep 30 it 200 total=0.9832 ce_r=0.0411 ce_f=4.7101
[loss-randlabel] ep 30 it 250 total=0.9589 ce_r=0.0171 ce_f=4.7085
[loss-randlabel] ep 30 it 300 total=1.0100 ce_r=0.0577 ce_f=4.7613
[loss-randlabel] ep 30 it 350 total=0.9426 ce_r=0.0083 ce_f=4.6713
[loss-randlabel] ep 30 it 400 total=0.9835 ce_r=0.0338 ce_f=4.7487
[loss-randlabel] ep 31 it 20 total=0.9782 ce_r=0.0116 ce_f=4.8328
[loss-randlabel] ep 31 it 70 total=0.9906 ce_r=0.0281 ce_f=4.8125
[loss-randlabel] ep 31 it 120 total=1.0054 ce_r=0.0387 ce_f=4.8334
[loss-randlabel] ep 31 it 170 total=0.9830 ce_r=0.0515 ce_f=4.6576
[loss-randlabel] ep 31 it 220 total=0.9639 ce_r=0.0197 ce_f=4.7212
[loss-randlabel] ep 31 it 270 total=0.9973 ce_r=0.0613 ce_f=4.6803
[loss-randlabel] ep 31 it 320 total=0.9669 ce_r=0.0122 ce_f=4.7734
[loss-randlabel] ep 31 it 370 total=1.1487 ce_r=0.0196 ce_f=5.6454
[loss-randlabel] ep 31 it 420 total=0.9613 ce_r=0.0210 ce_f=4.7016
[loss-randlabel] ep 32 it 40 total=0.9768 ce_r=0.0373 ce_f=4.6971
[loss-randlabel] ep 32 it 90 total=0.9922 ce_r=0.0362 ce_f=4.7803
[loss-randlabel] ep 32 it 140 total=1.0218 ce_r=0.0847 ce_f=4.6854
[loss-randlabel] ep 32 it 190 total=0.9502 ce_r=0.0111 ce_f=4.6956
[loss-randlabel] ep 32 it 240 total=0.9329 ce_r=0.0118 ce_f=4.6053
[loss-randlabel] ep 32 it 290 total=1.0226 ce_r=0.0707 ce_f=4.7599
[loss-randlabel] ep 32 it 340 total=1.0157 ce_r=0.0396 ce_f=4.8804
[loss-randlabel] ep 32 it 390 total=0.9791 ce_r=0.0120 ce_f=4.8356
[loss-randlabel] ep 33 it 10 total=0.9671 ce_r=0.0125 ce_f=4.7733
[loss-randlabel] ep 33 it 60 total=0.9756 ce_r=0.0179 ce_f=4.7890
[loss-randlabel] ep 33 it 110 total=0.9715 ce_r=0.0141 ce_f=4.7869
[loss-randlabel] ep 33 it 160 total=0.9651 ce_r=0.0267 ce_f=4.6920
[loss-randlabel] ep 33 it 210 total=0.9477 ce_r=0.0086 ce_f=4.6958
[loss-randlabel] ep 33 it 260 total=0.9689 ce_r=0.0134 ce_f=4.7779
[loss-randlabel] ep 33 it 310 total=0.9501 ce_r=0.0259 ce_f=4.6207
[loss-randlabel] ep 33 it 360 total=0.9804 ce_r=0.0320 ce_f=4.7420
[loss-randlabel] ep 33 it 410 total=0.9486 ce_r=0.0276 ce_f=4.6049
[loss-randlabel] ep 34 it 30 total=0.9592 ce_r=0.0070 ce_f=4.7609
[loss-randlabel] ep 34 it 80 total=0.9278 ce_r=0.0107 ce_f=4.5853
[loss-randlabel] ep 34 it 130 total=0.9693 ce_r=0.0094 ce_f=4.7997
[loss-randlabel] ep 34 it 180 total=0.9679 ce_r=0.0141 ce_f=4.7691
[loss-randlabel] ep 34 it 230 total=1.0030 ce_r=0.0161 ce_f=4.9346
[loss-randlabel] ep 34 it 280 total=0.9633 ce_r=0.0269 ce_f=4.6820
[loss-randlabel] ep 34 it 330 total=0.9581 ce_r=0.0257 ce_f=4.6621
[loss-randlabel] ep 34 it 380 total=0.9344 ce_r=0.0096 ce_f=4.6243
[loss-randlabel] ep 35 it 0 total=0.9598 ce_r=0.0105 ce_f=4.7464
[loss-randlabel] ep 35 it 50 total=0.9877 ce_r=0.0095 ce_f=4.8910
[loss-randlabel] ep 35 it 100 total=0.9650 ce_r=0.0246 ce_f=4.7022
[loss-randlabel] ep 35 it 150 total=0.9759 ce_r=0.0135 ce_f=4.8118
[loss-randlabel] ep 35 it 200 total=0.9876 ce_r=0.0290 ce_f=4.7929
[loss-randlabel] ep 35 it 250 total=0.9344 ce_r=0.0082 ce_f=4.6310
[loss-randlabel] ep 35 it 300 total=0.9746 ce_r=0.0377 ce_f=4.6843
[loss-randlabel] ep 35 it 350 total=0.9699 ce_r=0.0103 ce_f=4.7981
[loss-randlabel] ep 35 it 400 total=0.9412 ce_r=0.0081 ce_f=4.6657
[loss-randlabel] ep 36 it 20 total=0.9824 ce_r=0.0081 ce_f=4.8713
[loss-randlabel] ep 36 it 70 total=0.9946 ce_r=0.0179 ce_f=4.8834
[loss-randlabel] ep 36 it 120 total=0.9857 ce_r=0.0206 ce_f=4.8256
[loss-randlabel] ep 36 it 170 total=0.9476 ce_r=0.0193 ce_f=4.6414
[loss-randlabel] ep 36 it 220 total=0.9893 ce_r=0.0328 ce_f=4.7822
[loss-randlabel] ep 36 it 270 total=0.9580 ce_r=0.0170 ce_f=4.7052
[loss-randlabel] ep 36 it 320 total=0.9612 ce_r=0.0201 ce_f=4.7054
[loss-randlabel] ep 36 it 370 total=0.9913 ce_r=0.0394 ce_f=4.7599
[loss-randlabel] ep 36 it 420 total=0.9522 ce_r=0.0129 ce_f=4.6964
[loss-randlabel] ep 37 it 40 total=0.9461 ce_r=0.0090 ce_f=4.6857
[loss-randlabel] ep 37 it 90 total=0.9931 ce_r=0.0465 ce_f=4.7330
[loss-randlabel] ep 37 it 140 total=0.9523 ce_r=0.0104 ce_f=4.7095
[loss-randlabel] ep 37 it 190 total=0.9895 ce_r=0.0502 ce_f=4.6968
[loss-randlabel] ep 37 it 240 total=0.9476 ce_r=0.0106 ce_f=4.6847
[loss-randlabel] ep 37 it 290 total=0.9882 ce_r=0.0206 ce_f=4.8378
[loss-randlabel] ep 37 it 340 total=0.9432 ce_r=0.0171 ce_f=4.6305
[loss-randlabel] ep 37 it 390 total=1.0066 ce_r=0.0362 ce_f=4.8518
[loss-randlabel] ep 38 it 10 total=0.9995 ce_r=0.0605 ce_f=4.6954
[loss-randlabel] ep 38 it 60 total=0.9893 ce_r=0.0083 ce_f=4.9052
[loss-randlabel] ep 38 it 110 total=0.9633 ce_r=0.0288 ce_f=4.6728
[loss-randlabel] ep 38 it 160 total=0.9688 ce_r=0.0162 ce_f=4.7630
[loss-randlabel] ep 38 it 210 total=0.9796 ce_r=0.0145 ce_f=4.8253
[loss-randlabel] ep 38 it 260 total=0.9602 ce_r=0.0137 ce_f=4.7325
[loss-randlabel] ep 38 it 310 total=0.9614 ce_r=0.0139 ce_f=4.7376
[loss-randlabel] ep 38 it 360 total=0.9458 ce_r=0.0105 ce_f=4.6769
[loss-randlabel] ep 38 it 410 total=1.0166 ce_r=0.0663 ce_f=4.7513
[loss-randlabel] ep 39 it 30 total=0.9484 ce_r=0.0079 ce_f=4.7024
[loss-randlabel] ep 39 it 80 total=0.9910 ce_r=0.0461 ce_f=4.7245
[loss-randlabel] ep 39 it 130 total=0.9581 ce_r=0.0232 ce_f=4.6745
[loss-randlabel] ep 39 it 180 total=0.9410 ce_r=0.0338 ce_f=4.5363
[loss-randlabel] ep 39 it 230 total=0.9823 ce_r=0.0423 ce_f=4.6997
[loss-randlabel] ep 39 it 280 total=0.9413 ce_r=0.0189 ce_f=4.6123
[loss-randlabel] ep 39 it 330 total=0.9993 ce_r=0.0168 ce_f=4.9124
[loss-randlabel] ep 39 it 380 total=0.9666 ce_r=0.0119 ce_f=4.7735
[loss-randlabel] ep 40 it 0 total=0.9443 ce_r=0.0221 ce_f=4.6112
[loss-randlabel] ep 40 it 50 total=0.9901 ce_r=0.0161 ce_f=4.8701
[loss-randlabel] ep 40 it 100 total=0.9625 ce_r=0.0092 ce_f=4.7662
[loss-randlabel] ep 40 it 150 total=0.9924 ce_r=0.0068 ce_f=4.9280
[loss-randlabel] ep 40 it 200 total=0.9615 ce_r=0.0231 ce_f=4.6920
[loss-randlabel] ep 40 it 250 total=1.0281 ce_r=0.0618 ce_f=4.8315
[loss-randlabel] ep 40 it 300 total=0.9789 ce_r=0.0515 ce_f=4.6373
[loss-randlabel] ep 40 it 350 total=0.9623 ce_r=0.0265 ce_f=4.6791
[loss-randlabel] ep 40 it 400 total=1.0538 ce_r=0.0699 ce_f=4.9194
[loss-randlabel] ep 41 it 20 total=0.9368 ce_r=0.0108 ce_f=4.6301
[loss-randlabel] ep 41 it 70 total=0.9641 ce_r=0.0272 ce_f=4.6844
[loss-randlabel] ep 41 it 120 total=0.9732 ce_r=0.0250 ce_f=4.7413
[loss-randlabel] ep 41 it 170 total=0.9520 ce_r=0.0081 ce_f=4.7197
[loss-randlabel] ep 41 it 220 total=0.9484 ce_r=0.0096 ce_f=4.6941
[loss-randlabel] ep 41 it 270 total=0.9358 ce_r=0.0166 ce_f=4.5959
[loss-randlabel] ep 41 it 320 total=0.9030 ce_r=0.0107 ce_f=4.4614
[loss-randlabel] ep 41 it 370 total=0.9537 ce_r=0.0203 ce_f=4.6669
[loss-randlabel] ep 41 it 420 total=1.0103 ce_r=0.0402 ce_f=4.8509
[loss-randlabel] ep 42 it 40 total=0.9652 ce_r=0.0223 ce_f=4.7144
[loss-randlabel] ep 42 it 90 total=0.9465 ce_r=0.0082 ce_f=4.6918
[loss-randlabel] ep 42 it 140 total=0.9406 ce_r=0.0157 ce_f=4.6247
[loss-randlabel] ep 42 it 190 total=0.9338 ce_r=0.0133 ce_f=4.6024
[loss-randlabel] ep 42 it 240 total=0.9382 ce_r=0.0104 ce_f=4.6392
[loss-randlabel] ep 42 it 290 total=0.9533 ce_r=0.0112 ce_f=4.7105
 86%|████████▌ | 43/50 [12:46<01:57, 16.75s/it] 88%|████████▊ | 44/50 [13:02<01:40, 16.70s/it] 90%|█████████ | 45/50 [13:18<01:22, 16.53s/it] 92%|█████████▏| 46/50 [13:35<01:06, 16.65s/it] 94%|█████████▍| 47/50 [13:52<00:50, 16.71s/it] 96%|█████████▌| 48/50 [14:08<00:33, 16.62s/it] 98%|█████████▊| 49/50 [14:25<00:16, 16.48s/it]100%|██████████| 50/50 [14:41<00:00, 16.49s/it]100%|██████████| 50/50 [14:41<00:00, 17.63s/it]
[loss-randlabel] ep 42 it 340 total=0.9522 ce_r=0.0200 ce_f=4.6609
[loss-randlabel] ep 42 it 390 total=0.9552 ce_r=0.0208 ce_f=4.6720
[loss-randlabel] ep 43 it 10 total=0.9638 ce_r=0.0103 ce_f=4.7673
[loss-randlabel] ep 43 it 60 total=0.9933 ce_r=0.0294 ce_f=4.8194
[loss-randlabel] ep 43 it 110 total=0.9503 ce_r=0.0136 ce_f=4.6837
[loss-randlabel] ep 43 it 160 total=0.9941 ce_r=0.0189 ce_f=4.8756
[loss-randlabel] ep 43 it 210 total=0.9880 ce_r=0.0194 ce_f=4.8431
[loss-randlabel] ep 43 it 260 total=0.9713 ce_r=0.0182 ce_f=4.7658
[loss-randlabel] ep 43 it 310 total=0.9988 ce_r=0.0118 ce_f=4.9352
[loss-randlabel] ep 43 it 360 total=0.9528 ce_r=0.0067 ce_f=4.7306
[loss-randlabel] ep 43 it 410 total=0.9585 ce_r=0.0087 ce_f=4.7487
[loss-randlabel] ep 44 it 30 total=0.9228 ce_r=0.0132 ce_f=4.5478
[loss-randlabel] ep 44 it 80 total=1.0152 ce_r=0.0370 ce_f=4.8910
[loss-randlabel] ep 44 it 130 total=0.9666 ce_r=0.0199 ce_f=4.7337
[loss-randlabel] ep 44 it 180 total=1.0161 ce_r=0.0668 ce_f=4.7463
[loss-randlabel] ep 44 it 230 total=1.0048 ce_r=0.0099 ce_f=4.9745
[loss-randlabel] ep 44 it 280 total=0.9356 ce_r=0.0096 ce_f=4.6300
[loss-randlabel] ep 44 it 330 total=0.9719 ce_r=0.0412 ce_f=4.6534
[loss-randlabel] ep 44 it 380 total=0.9356 ce_r=0.0191 ce_f=4.5828
[loss-randlabel] ep 45 it 0 total=0.9489 ce_r=0.0145 ce_f=4.6717
[loss-randlabel] ep 45 it 50 total=0.9559 ce_r=0.0240 ce_f=4.6594
[loss-randlabel] ep 45 it 100 total=0.9355 ce_r=0.0181 ce_f=4.5872
[loss-randlabel] ep 45 it 150 total=0.9620 ce_r=0.0125 ce_f=4.7478
[loss-randlabel] ep 45 it 200 total=1.0251 ce_r=0.0129 ce_f=5.0611
[loss-randlabel] ep 45 it 250 total=0.9377 ce_r=0.0080 ce_f=4.6483
[loss-randlabel] ep 45 it 300 total=0.9400 ce_r=0.0085 ce_f=4.6576
[loss-randlabel] ep 45 it 350 total=0.9762 ce_r=0.0123 ce_f=4.8191
[loss-randlabel] ep 45 it 400 total=1.0064 ce_r=0.0276 ce_f=4.8943
[loss-randlabel] ep 46 it 20 total=0.9694 ce_r=0.0049 ce_f=4.8223
[loss-randlabel] ep 46 it 70 total=0.9883 ce_r=0.0385 ce_f=4.7487
[loss-randlabel] ep 46 it 120 total=0.9957 ce_r=0.0123 ce_f=4.9168
[loss-randlabel] ep 46 it 170 total=1.0204 ce_r=0.0201 ce_f=5.0015
[loss-randlabel] ep 46 it 220 total=0.9944 ce_r=0.0159 ce_f=4.8921
[loss-randlabel] ep 46 it 270 total=0.9835 ce_r=0.0229 ce_f=4.8031
[loss-randlabel] ep 46 it 320 total=1.0277 ce_r=0.0228 ce_f=5.0245
[loss-randlabel] ep 46 it 370 total=0.9708 ce_r=0.0283 ce_f=4.7124
[loss-randlabel] ep 46 it 420 total=0.9519 ce_r=0.0101 ce_f=4.7085
[loss-randlabel] ep 47 it 40 total=0.9778 ce_r=0.0248 ce_f=4.7652
[loss-randlabel] ep 47 it 90 total=0.9631 ce_r=0.0101 ce_f=4.7648
[loss-randlabel] ep 47 it 140 total=1.0410 ce_r=0.0379 ce_f=5.0155
[loss-randlabel] ep 47 it 190 total=0.9744 ce_r=0.0193 ce_f=4.7754
[loss-randlabel] ep 47 it 240 total=0.9688 ce_r=0.0342 ce_f=4.6733
[loss-randlabel] ep 47 it 290 total=0.9858 ce_r=0.0438 ce_f=4.7102
[loss-randlabel] ep 47 it 340 total=0.8343 ce_r=0.0110 ce_f=4.1167
[loss-randlabel] ep 47 it 390 total=0.9948 ce_r=0.0467 ce_f=4.7403
[loss-randlabel] ep 48 it 10 total=0.9712 ce_r=0.0244 ce_f=4.7336
[loss-randlabel] ep 48 it 60 total=1.0208 ce_r=0.0785 ce_f=4.7115
[loss-randlabel] ep 48 it 110 total=1.0014 ce_r=0.0448 ce_f=4.7831
[loss-randlabel] ep 48 it 160 total=0.9733 ce_r=0.0201 ce_f=4.7658
[loss-randlabel] ep 48 it 210 total=0.9630 ce_r=0.0280 ce_f=4.6754
[loss-randlabel] ep 48 it 260 total=0.9563 ce_r=0.0179 ce_f=4.6921
[loss-randlabel] ep 48 it 310 total=0.9652 ce_r=0.0135 ce_f=4.7583
[loss-randlabel] ep 48 it 360 total=0.9456 ce_r=0.0135 ce_f=4.6606
[loss-randlabel] ep 48 it 410 total=1.0675 ce_r=0.0448 ce_f=5.1137
[loss-randlabel] ep 49 it 30 total=0.9606 ce_r=0.0102 ce_f=4.7518
[loss-randlabel] ep 49 it 80 total=0.9493 ce_r=0.0078 ce_f=4.7073
[loss-randlabel] ep 49 it 130 total=0.9786 ce_r=0.0367 ce_f=4.7096
[loss-randlabel] ep 49 it 180 total=0.9541 ce_r=0.0068 ce_f=4.7363
[loss-randlabel] ep 49 it 230 total=0.9572 ce_r=0.0080 ce_f=4.7462
[loss-randlabel] ep 49 it 280 total=0.9542 ce_r=0.0061 ce_f=4.7407
[loss-randlabel] ep 49 it 330 total=0.9975 ce_r=0.0154 ce_f=4.9107
[loss-randlabel] ep 49 it 380 total=0.9410 ce_r=0.0082 ce_f=4.6642
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1.pt
resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-inc1-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:35,  2.00it/s]  3%|▎         | 11/430 [00:00<00:17, 23.39it/s]  5%|▍         | 21/430 [00:00<00:09, 41.32it/s]  7%|▋         | 31/430 [00:00<00:07, 55.55it/s] 10%|▉         | 41/430 [00:00<00:05, 66.96it/s] 12%|█▏        | 52/430 [00:01<00:04, 76.80it/s] 15%|█▍        | 63/430 [00:01<00:04, 83.80it/s] 17%|█▋        | 73/430 [00:01<00:04, 87.61it/s] 20%|█▉        | 84/430 [00:01<00:03, 91.53it/s] 22%|██▏       | 94/430 [00:01<00:03, 93.82it/s] 24%|██▍       | 105/430 [00:01<00:03, 95.96it/s] 27%|██▋       | 116/430 [00:01<00:03, 97.43it/s] 30%|██▉       | 127/430 [00:01<00:03, 98.35it/s] 32%|███▏      | 138/430 [00:01<00:02, 99.20it/s] 35%|███▍      | 149/430 [00:01<00:02, 99.44it/s] 37%|███▋      | 160/430 [00:02<00:02, 99.43it/s] 40%|███▉      | 171/430 [00:02<00:02, 99.78it/s] 42%|████▏     | 182/430 [00:02<00:02, 99.96it/s] 45%|████▍     | 193/430 [00:02<00:02, 99.95it/s] 47%|████▋     | 204/430 [00:02<00:02, 100.29it/s] 50%|█████     | 215/430 [00:02<00:02, 100.45it/s] 53%|█████▎    | 226/430 [00:02<00:02, 100.36it/s] 55%|█████▌    | 237/430 [00:02<00:01, 100.39it/s] 58%|█████▊    | 248/430 [00:02<00:01, 100.47it/s] 60%|██████    | 259/430 [00:03<00:01, 100.52it/s] 63%|██████▎   | 270/430 [00:03<00:01, 100.63it/s] 65%|██████▌   | 281/430 [00:03<00:01, 100.61it/s] 68%|██████▊   | 292/430 [00:03<00:01, 99.54it/s]  70%|███████   | 303/430 [00:03<00:01, 99.77it/s] 73%|███████▎  | 313/430 [00:03<00:01, 99.38it/s] 75%|███████▌  | 324/430 [00:03<00:01, 99.92it/s] 78%|███████▊  | 335/430 [00:03<00:00, 100.09it/s] 80%|████████  | 346/430 [00:03<00:00, 100.32it/s] 83%|████████▎ | 357/430 [00:04<00:00, 100.23it/s] 86%|████████▌ | 368/430 [00:04<00:00, 100.53it/s] 88%|████████▊ | 379/430 [00:04<00:00, 100.57it/s] 91%|█████████ | 390/430 [00:04<00:00, 100.27it/s] 93%|█████████▎| 401/430 [00:04<00:00, 100.01it/s] 96%|█████████▌| 412/430 [00:04<00:00, 100.83it/s] 98%|█████████▊| 423/430 [00:04<00:00, 101.37it/s]100%|██████████| 430/430 [00:04<00:00, 89.64it/s] 
55000 images processed, 4.891847133636475 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:32,  2.58it/s]  9%|▉         | 8/86 [00:00<00:03, 20.65it/s] 21%|██        | 18/86 [00:00<00:01, 41.53it/s] 31%|███▏      | 27/86 [00:00<00:01, 54.94it/s] 43%|████▎     | 37/86 [00:00<00:00, 66.10it/s] 55%|█████▍    | 47/86 [00:00<00:00, 73.64it/s] 66%|██████▋   | 57/86 [00:01<00:00, 78.88it/s] 78%|███████▊  | 67/86 [00:01<00:00, 84.54it/s] 90%|████████▉ | 77/86 [00:01<00:00, 88.64it/s]100%|██████████| 86/86 [00:01<00:00, 65.00it/s]
11000 images processed, 1.3473587036132812 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-inc1-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:38,  2.06it/s]  4%|▍         | 9/204 [00:00<00:10, 19.43it/s]  8%|▊         | 17/204 [00:00<00:05, 32.99it/s] 13%|█▎        | 27/204 [00:00<00:03, 49.17it/s] 18%|█▊        | 37/204 [00:00<00:02, 61.88it/s] 23%|██▎       | 47/204 [00:01<00:02, 71.30it/s] 28%|██▊       | 57/204 [00:01<00:01, 78.69it/s] 33%|███▎      | 67/204 [00:01<00:01, 84.62it/s] 38%|███▊      | 77/204 [00:01<00:01, 89.02it/s] 43%|████▎     | 87/204 [00:01<00:01, 92.15it/s] 48%|████▊     | 97/204 [00:01<00:01, 94.05it/s] 52%|█████▏    | 107/204 [00:01<00:01, 95.50it/s] 57%|█████▋    | 117/204 [00:01<00:00, 96.71it/s] 62%|██████▏   | 127/204 [00:01<00:00, 97.64it/s] 67%|██████▋   | 137/204 [00:01<00:00, 98.10it/s] 72%|███████▏  | 147/204 [00:02<00:00, 98.48it/s] 77%|███████▋  | 157/204 [00:02<00:00, 98.80it/s] 82%|████████▏ | 167/204 [00:02<00:00, 98.73it/s] 87%|████████▋ | 177/204 [00:02<00:00, 98.74it/s] 92%|█████████▏| 188/204 [00:02<00:00, 99.68it/s] 98%|█████████▊| 199/204 [00:02<00:00, 100.26it/s]100%|██████████| 204/204 [00:02<00:00, 78.54it/s] 
26032 images processed, 2.6340930461883545 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.71it/s] 11%|█▏        | 9/79 [00:00<00:04, 16.78it/s] 24%|██▍       | 19/79 [00:00<00:01, 34.32it/s] 37%|███▋      | 29/79 [00:00<00:01, 49.28it/s] 49%|████▉     | 39/79 [00:01<00:00, 61.35it/s] 62%|██████▏   | 49/79 [00:01<00:00, 70.38it/s] 75%|███████▍  | 59/79 [00:01<00:00, 78.23it/s] 89%|████████▊ | 70/79 [00:01<00:00, 85.14it/s]100%|██████████| 79/79 [00:01<00:00, 55.63it/s]
10000 images processed, 1.4506235122680664 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.11it/s] 14%|█▍        | 11/79 [00:00<00:02, 24.22it/s] 24%|██▍       | 19/79 [00:00<00:01, 37.09it/s] 37%|███▋      | 29/79 [00:00<00:00, 52.33it/s] 49%|████▉     | 39/79 [00:00<00:00, 64.88it/s] 62%|██████▏   | 49/79 [00:01<00:00, 73.88it/s] 76%|███████▌  | 60/79 [00:01<00:00, 82.14it/s] 90%|████████▉ | 71/79 [00:01<00:00, 88.02it/s]100%|██████████| 79/79 [00:01<00:00, 61.29it/s]
10000 images processed, 1.3076684474945068 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:31,  2.18it/s] 10%|█         | 7/70 [00:00<00:04, 15.72it/s] 24%|██▍       | 17/70 [00:00<00:01, 36.86it/s] 39%|███▊      | 27/70 [00:00<00:00, 53.32it/s] 53%|█████▎    | 37/70 [00:00<00:00, 65.77it/s] 69%|██████▊   | 48/70 [00:00<00:00, 76.21it/s] 84%|████████▍ | 59/70 [00:01<00:00, 83.76it/s]100%|██████████| 70/70 [00:01<00:00, 88.58it/s]100%|██████████| 70/70 [00:01<00:00, 58.59it/s]
8925 images processed, 1.22318696975708 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:40,  1.09it/s]  4%|▍         | 2/45 [00:01<00:19,  2.24it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.65it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.73it/s] 49%|████▉     | 22/45 [00:01<00:00, 24.00it/s] 60%|██████    | 27/45 [00:01<00:00, 25.64it/s] 73%|███████▎  | 33/45 [00:01<00:00, 22.36it/s] 89%|████████▉ | 40/45 [00:02<00:00, 29.75it/s]100%|██████████| 45/45 [00:02<00:00, 25.14it/s]100%|██████████| 45/45 [00:02<00:00, 19.03it/s]
5640 images processed, 2.4023208618164062 seconds used

16.8570659160614
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.38  98.70  96.55
places365     74.24  77.98  78.52
LSUN          13.75  97.01  97.09
iSUN          73.47  82.24  86.10
dtd           59.50  85.12  91.58
AVG           45.27  88.21  89.97
Retain-Acc: 0.7297
Forget-as-OOD (retain known vs forget novel):
  FPR: 36.40 AUROC: 89.96 AUIN: 99.37
8.561020374298096
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1.pt
resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-seen-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:19,  2.16it/s]  3%|▎         | 11/430 [00:00<00:16, 24.95it/s]  5%|▍         | 21/430 [00:00<00:09, 42.85it/s]  7%|▋         | 31/430 [00:00<00:07, 56.59it/s] 10%|▉         | 41/430 [00:00<00:05, 67.25it/s] 12%|█▏        | 51/430 [00:00<00:05, 75.30it/s] 14%|█▍        | 61/430 [00:01<00:04, 81.36it/s] 17%|█▋        | 71/430 [00:01<00:04, 86.04it/s] 19%|█▉        | 81/430 [00:01<00:03, 89.03it/s] 21%|██        | 91/430 [00:01<00:03, 91.89it/s] 24%|██▎       | 102/430 [00:01<00:03, 94.96it/s] 26%|██▋       | 113/430 [00:01<00:03, 96.98it/s] 29%|██▉       | 124/430 [00:01<00:03, 98.38it/s] 31%|███▏      | 135/430 [00:01<00:02, 99.34it/s] 34%|███▍      | 146/430 [00:01<00:02, 100.05it/s] 37%|███▋      | 157/430 [00:02<00:02, 100.40it/s] 39%|███▉      | 168/430 [00:02<00:02, 100.45it/s] 42%|████▏     | 179/430 [00:02<00:02, 100.77it/s] 44%|████▍     | 190/430 [00:02<00:02, 100.91it/s] 47%|████▋     | 201/430 [00:02<00:02, 101.11it/s] 49%|████▉     | 212/430 [00:02<00:02, 101.21it/s] 52%|█████▏    | 223/430 [00:02<00:02, 101.36it/s] 54%|█████▍    | 234/430 [00:02<00:01, 101.30it/s] 57%|█████▋    | 245/430 [00:02<00:01, 101.36it/s] 60%|█████▉    | 256/430 [00:03<00:01, 101.37it/s] 62%|██████▏   | 267/430 [00:03<00:01, 101.43it/s] 65%|██████▍   | 278/430 [00:03<00:01, 100.59it/s] 67%|██████▋   | 289/430 [00:03<00:01, 100.25it/s] 70%|██████▉   | 300/430 [00:03<00:01, 100.56it/s] 72%|███████▏  | 311/430 [00:03<00:01, 100.78it/s] 75%|███████▍  | 322/430 [00:03<00:01, 100.88it/s] 77%|███████▋  | 333/430 [00:03<00:00, 101.03it/s] 80%|████████  | 344/430 [00:03<00:00, 101.28it/s] 83%|████████▎ | 355/430 [00:04<00:00, 101.26it/s] 85%|████████▌ | 366/430 [00:04<00:00, 101.02it/s] 88%|████████▊ | 377/430 [00:04<00:00, 100.85it/s] 90%|█████████ | 388/430 [00:04<00:00, 101.01it/s] 93%|█████████▎| 399/430 [00:04<00:00, 100.39it/s] 95%|█████████▌| 410/430 [00:04<00:00, 100.88it/s] 98%|█████████▊| 421/430 [00:04<00:00, 101.43it/s]100%|██████████| 430/430 [00:04<00:00, 90.33it/s] 
55000 images processed, 4.852424383163452 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:37,  2.29it/s] 13%|█▎        | 11/86 [00:00<00:02, 25.72it/s] 24%|██▍       | 21/86 [00:00<00:01, 43.79it/s] 36%|███▌      | 31/86 [00:00<00:00, 57.68it/s] 48%|████▊     | 41/86 [00:00<00:00, 68.50it/s] 59%|█████▉    | 51/86 [00:00<00:00, 76.43it/s] 71%|███████   | 61/86 [00:01<00:00, 81.71it/s] 83%|████████▎ | 71/86 [00:01<00:00, 86.47it/s] 94%|█████████▍| 81/86 [00:01<00:00, 89.92it/s]100%|██████████| 86/86 [00:01<00:00, 64.60it/s]
11000 images processed, 1.3565354347229004 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-seen-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:38,  2.06it/s]  4%|▍         | 9/204 [00:00<00:09, 19.56it/s]  9%|▉         | 19/204 [00:00<00:04, 38.83it/s] 14%|█▍        | 29/204 [00:00<00:03, 54.43it/s] 19%|█▊        | 38/204 [00:00<00:02, 59.79it/s] 23%|██▎       | 47/204 [00:01<00:02, 67.15it/s] 28%|██▊       | 57/204 [00:01<00:01, 75.56it/s] 32%|███▏      | 66/204 [00:01<00:01, 79.25it/s] 37%|███▋      | 76/204 [00:01<00:01, 84.99it/s] 42%|████▏     | 86/204 [00:01<00:01, 89.12it/s] 47%|████▋     | 96/204 [00:01<00:01, 89.89it/s] 52%|█████▏    | 106/204 [00:01<00:01, 92.33it/s] 57%|█████▋    | 116/204 [00:01<00:01, 87.92it/s] 61%|██████▏   | 125/204 [00:01<00:00, 86.06it/s] 66%|██████▌   | 134/204 [00:01<00:00, 82.06it/s] 71%|███████   | 145/204 [00:02<00:00, 87.29it/s] 76%|███████▌  | 155/204 [00:02<00:00, 90.73it/s] 81%|████████  | 165/204 [00:02<00:00, 93.16it/s] 86%|████████▌ | 175/204 [00:02<00:00, 93.85it/s] 91%|█████████ | 185/204 [00:02<00:00, 94.48it/s] 96%|█████████▌| 195/204 [00:02<00:00, 92.68it/s]100%|██████████| 204/204 [00:02<00:00, 74.46it/s]
26032 images processed, 2.849011182785034 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.61it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.83it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.59it/s] 39%|███▉      | 31/79 [00:00<00:00, 51.03it/s] 52%|█████▏    | 41/79 [00:01<00:00, 63.06it/s] 65%|██████▍   | 51/79 [00:01<00:00, 72.57it/s] 78%|███████▊  | 62/79 [00:01<00:00, 80.70it/s] 92%|█████████▏| 73/79 [00:01<00:00, 86.79it/s]100%|██████████| 79/79 [00:01<00:00, 56.04it/s]
10000 images processed, 1.4425296783447266 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.02it/s]  8%|▊         | 6/79 [00:00<00:05, 12.52it/s] 18%|█▊        | 14/79 [00:00<00:02, 28.37it/s] 29%|██▉       | 23/79 [00:00<00:01, 43.05it/s] 41%|████      | 32/79 [00:00<00:00, 54.14it/s] 54%|█████▍    | 43/79 [00:01<00:00, 67.31it/s] 68%|██████▊   | 54/79 [00:01<00:00, 77.00it/s] 82%|████████▏ | 65/79 [00:01<00:00, 84.18it/s] 96%|█████████▌| 76/79 [00:01<00:00, 89.31it/s]100%|██████████| 79/79 [00:01<00:00, 57.17it/s]
10000 images processed, 1.3998446464538574 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.96it/s] 16%|█▌        | 11/70 [00:00<00:02, 23.18it/s] 30%|███       | 21/70 [00:00<00:01, 41.11it/s] 44%|████▍     | 31/70 [00:00<00:00, 55.80it/s] 59%|█████▊    | 41/70 [00:00<00:00, 67.22it/s] 74%|███████▍  | 52/70 [00:01<00:00, 77.06it/s] 90%|█████████ | 63/70 [00:01<00:00, 84.19it/s]100%|██████████| 70/70 [00:01<00:00, 57.99it/s]
8925 images processed, 1.2348508834838867 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:38,  1.13it/s]  4%|▍         | 2/45 [00:01<00:18,  2.31it/s] 27%|██▋       | 12/45 [00:01<00:01, 18.07it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.06it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.57it/s] 56%|█████▌    | 25/45 [00:01<00:00, 25.28it/s] 73%|███████▎  | 33/45 [00:01<00:00, 23.45it/s] 82%|████████▏ | 37/45 [00:02<00:00, 26.14it/s]100%|██████████| 45/45 [00:02<00:00, 21.21it/s]
5640 images processed, 2.1450085639953613 seconds used

16.939014673233032
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.38  98.70  96.55
places365     74.24  77.98  78.52
LSUN          13.75  97.01  97.09
iSUN          73.47  82.24  86.10
dtd           59.50  85.12  91.58
AVG           45.27  88.21  89.97
Retain-Acc: 0.7297
Forget-as-OOD (retain known vs forget novel):
  FPR: 36.40 AUROC: 89.96 AUIN: 99.37
8.242790937423706
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-seen-forget_rf.png
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,11,40,51,57,66,67,88,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2.pt', load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=0.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=False, lora_impl='native', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='head', adapter_save_path=None, adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,57,66,67,88,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='randlabel', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
[debug] trainable_count = 112
[debug] trainable: encoder.conv1.weight
[debug] trainable: encoder.bn1.weight
[debug] trainable: encoder.bn1.bias
[debug] trainable: encoder.layer1.0.conv1.weight
[debug] trainable: encoder.layer1.0.bn1.weight
[debug] trainable: encoder.layer1.0.bn1.bias
[debug] trainable: encoder.layer1.0.conv2.weight
[debug] trainable: encoder.layer1.0.bn2.weight
[debug] trainable: encoder.layer1.0.bn2.bias
[debug] trainable: encoder.layer1.1.conv1.weight
[debug] trainable: encoder.layer1.1.bn1.weight
[debug] trainable: encoder.layer1.1.bn1.bias
[debug] trainable: encoder.layer1.1.conv2.weight
[debug] trainable: encoder.layer1.1.bn2.weight
[debug] trainable: encoder.layer1.1.bn2.bias
[debug] trainable: encoder.layer1.2.conv1.weight
[debug] trainable: encoder.layer1.2.bn1.weight
[debug] trainable: encoder.layer1.2.bn1.bias
[debug] trainable: encoder.layer1.2.conv2.weight
[debug] trainable: encoder.layer1.2.bn2.weight
[debug] trainable: encoder.layer1.2.bn2.bias
[debug] trainable: encoder.layer2.0.conv1.weight
[debug] trainable: encoder.layer2.0.bn1.weight
[debug] trainable: encoder.layer2.0.bn1.bias
[debug] trainable: encoder.layer2.0.conv2.weight
[debug] trainable: encoder.layer2.0.bn2.weight
[debug] trainable: encoder.layer2.0.bn2.bias
[debug] trainable: encoder.layer2.0.shortcut.0.weight
[debug] trainable: encoder.layer2.0.shortcut.1.weight
[debug] trainable: encoder.layer2.0.shortcut.1.bias
[debug] trainable: encoder.layer2.1.conv1.weight
[debug] trainable: encoder.layer2.1.bn1.weight
[debug] trainable: encoder.layer2.1.bn1.bias
[debug] trainable: encoder.layer2.1.conv2.weight
[debug] trainable: encoder.layer2.1.bn2.weight
[debug] trainable: encoder.layer2.1.bn2.bias
[debug] trainable: encoder.layer2.2.conv1.weight
[debug] trainable: encoder.layer2.2.bn1.weight
[debug] trainable: encoder.layer2.2.bn1.bias
[debug] trainable: encoder.layer2.2.conv2.weight
[debug] trainable: encoder.layer2.2.bn2.weight
[debug] trainable: encoder.layer2.2.bn2.bias
[debug] trainable: encoder.layer2.3.conv1.weight
[debug] trainable: encoder.layer2.3.bn1.weight
[debug] trainable: encoder.layer2.3.bn1.bias
[debug] trainable: encoder.layer2.3.conv2.weight
[debug] trainable: encoder.layer2.3.bn2.weight
[debug] trainable: encoder.layer2.3.bn2.bias
[debug] trainable: encoder.layer3.0.conv1.weight
[debug] trainable: encoder.layer3.0.bn1.weight
[debug][warn] non-LoRA trainables detected: ['encoder.conv1.weight', 'encoder.bn1.weight', 'encoder.bn1.bias', 'encoder.layer1.0.conv1.weight', 'encoder.layer1.0.bn1.weight', 'encoder.layer1.0.bn1.bias', 'encoder.layer1.0.conv2.weight', 'encoder.layer1.0.bn2.weight', 'encoder.layer1.0.bn2.bias', 'encoder.layer1.1.conv1.weight']
[trainable] param_count=21605312 tensors=112
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:553: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=bool(scaler is not None)):
/home/shaokun/PALM/trainer.py:641: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/torch/csrc/autograd/generated/python_variable_methods.cpp:835.)
  print(f"[loss-{args.forget_strategy}] ep {epoch} it {it} total={loss.item():.4f} ce_r={float(loss_retain):.4f} ce_f={float(loss_forget):.4f}")
  2%|▏         | 1/50 [00:37<30:53, 37.84s/it]  4%|▍         | 2/50 [00:54<20:06, 25.13s/it]  6%|▌         | 3/50 [01:10<16:40, 21.29s/it]  8%|▊         | 4/50 [01:27<14:50, 19.36s/it] 10%|█         | 5/50 [01:44<13:59, 18.65s/it] 12%|█▏        | 6/50 [02:00<13:04, 17.83s/it] 14%|█▍        | 7/50 [02:17<12:24, 17.31s/it] 16%|█▌        | 8/50 [02:33<11:53, 16.99s/it] 18%|█▊        | 9/50 [02:49<11:23, 16.68s/it] 20%|██        | 10/50 [03:05<11:03, 16.60s/it] 22%|██▏       | 11/50 [03:22<10:47, 16.61s/it] 24%|██▍       | 12/50 [03:38<10:22, 16.39s/it] 26%|██▌       | 13/50 [03:54<10:07, 16.43s/it] 28%|██▊       | 14/50 [04:11<09:49, 16.38s/it][loss-randlabel] ep 0 it 0 total=2.0897 ce_r=0.0103 ce_f=10.3971
[loss-randlabel] ep 0 it 50 total=2.0720 ce_r=0.0284 ce_f=10.2176
[loss-randlabel] ep 0 it 100 total=1.9285 ce_r=0.0231 ce_f=9.5266
[loss-randlabel] ep 0 it 150 total=1.8714 ce_r=0.0133 ce_f=9.2902
[loss-randlabel] ep 0 it 200 total=2.0203 ce_r=0.0076 ce_f=10.0635
[loss-randlabel] ep 0 it 250 total=1.9559 ce_r=0.0184 ce_f=9.6874
[loss-randlabel] ep 0 it 300 total=1.7873 ce_r=0.0346 ce_f=8.7635
[loss-randlabel] ep 0 it 350 total=1.4544 ce_r=0.0162 ce_f=7.1909
[loss-randlabel] ep 0 it 400 total=1.2436 ce_r=0.0519 ce_f=5.9586
[loss-randlabel] ep 1 it 20 total=1.3063 ce_r=0.0669 ce_f=6.1971
[loss-randlabel] ep 1 it 70 total=1.0570 ce_r=0.0625 ce_f=4.9727
[loss-randlabel] ep 1 it 120 total=1.1775 ce_r=0.0217 ce_f=5.7794
[loss-randlabel] ep 1 it 170 total=1.0607 ce_r=0.0588 ce_f=5.0093
[loss-randlabel] ep 1 it 220 total=1.1672 ce_r=0.0261 ce_f=5.7057
[loss-randlabel] ep 1 it 270 total=1.0357 ce_r=0.0351 ce_f=5.0031
[loss-randlabel] ep 1 it 320 total=0.8369 ce_r=0.0197 ce_f=4.0861
[loss-randlabel] ep 1 it 370 total=0.9893 ce_r=0.0243 ce_f=4.8246
[loss-randlabel] ep 1 it 420 total=1.0242 ce_r=0.0198 ce_f=5.0223
[loss-randlabel] ep 2 it 40 total=0.9773 ce_r=0.0282 ce_f=4.7456
[loss-randlabel] ep 2 it 90 total=1.0299 ce_r=0.0241 ce_f=5.0291
[loss-randlabel] ep 2 it 140 total=1.1130 ce_r=0.0296 ce_f=5.4170
[loss-randlabel] ep 2 it 190 total=1.0705 ce_r=0.0266 ce_f=5.2193
[loss-randlabel] ep 2 it 240 total=1.0387 ce_r=0.0168 ce_f=5.1097
[loss-randlabel] ep 2 it 290 total=1.1366 ce_r=0.0299 ce_f=5.5339
[loss-randlabel] ep 2 it 340 total=1.0328 ce_r=0.0230 ce_f=5.0492
[loss-randlabel] ep 2 it 390 total=1.1687 ce_r=0.0234 ce_f=5.7267
[loss-randlabel] ep 3 it 10 total=1.1202 ce_r=0.1326 ce_f=4.9382
[loss-randlabel] ep 3 it 60 total=1.1426 ce_r=0.0343 ce_f=5.5414
[loss-randlabel] ep 3 it 110 total=1.1059 ce_r=0.0391 ce_f=5.3340
[loss-randlabel] ep 3 it 160 total=1.0880 ce_r=0.0444 ce_f=5.2180
[loss-randlabel] ep 3 it 210 total=0.9921 ce_r=0.0397 ce_f=4.7623
[loss-randlabel] ep 3 it 260 total=1.0903 ce_r=0.1076 ce_f=4.9138
[loss-randlabel] ep 3 it 310 total=0.9780 ce_r=0.0220 ce_f=4.7801
[loss-randlabel] ep 3 it 360 total=1.2242 ce_r=0.0295 ce_f=5.9731
[loss-randlabel] ep 3 it 410 total=1.0906 ce_r=0.0591 ce_f=5.1575
[loss-randlabel] ep 4 it 30 total=0.9963 ce_r=0.0220 ce_f=4.8716
[loss-randlabel] ep 4 it 80 total=1.1200 ce_r=0.0783 ce_f=5.2082
[loss-randlabel] ep 4 it 130 total=0.9799 ce_r=0.0372 ce_f=4.7133
[loss-randlabel] ep 4 it 180 total=0.9761 ce_r=0.0192 ce_f=4.7844
[loss-randlabel] ep 4 it 230 total=1.0266 ce_r=0.0561 ce_f=4.8525
[loss-randlabel] ep 4 it 280 total=1.0053 ce_r=0.0230 ce_f=4.9113
[loss-randlabel] ep 4 it 330 total=0.9859 ce_r=0.0389 ce_f=4.7351
[loss-randlabel] ep 4 it 380 total=1.0982 ce_r=0.0404 ce_f=5.2891
[loss-randlabel] ep 5 it 0 total=0.9804 ce_r=0.0472 ce_f=4.6658
[loss-randlabel] ep 5 it 50 total=1.0369 ce_r=0.0435 ce_f=4.9669
[loss-randlabel] ep 5 it 100 total=0.9878 ce_r=0.0458 ce_f=4.7099
[loss-randlabel] ep 5 it 150 total=1.0562 ce_r=0.0273 ce_f=5.1443
[loss-randlabel] ep 5 it 200 total=0.9953 ce_r=0.0399 ce_f=4.7770
[loss-randlabel] ep 5 it 250 total=1.0477 ce_r=0.0626 ce_f=4.9253
[loss-randlabel] ep 5 it 300 total=0.9093 ce_r=0.0301 ce_f=4.3961
[loss-randlabel] ep 5 it 350 total=1.0827 ce_r=0.0196 ce_f=5.3154
[loss-randlabel] ep 5 it 400 total=0.9665 ce_r=0.0340 ce_f=4.6629
[loss-randlabel] ep 6 it 20 total=0.9957 ce_r=0.0545 ce_f=4.7060
[loss-randlabel] ep 6 it 70 total=1.0424 ce_r=0.0461 ce_f=4.9812
[loss-randlabel] ep 6 it 120 total=0.9868 ce_r=0.0956 ce_f=4.4563
[loss-randlabel] ep 6 it 170 total=1.0027 ce_r=0.0306 ce_f=4.8603
[loss-randlabel] ep 6 it 220 total=0.9968 ce_r=0.0383 ce_f=4.7927
[loss-randlabel] ep 6 it 270 total=0.9909 ce_r=0.0185 ce_f=4.8621
[loss-randlabel] ep 6 it 320 total=1.1229 ce_r=0.0223 ce_f=5.5032
[loss-randlabel] ep 6 it 370 total=1.0237 ce_r=0.0251 ce_f=4.9931
[loss-randlabel] ep 6 it 420 total=1.1049 ce_r=0.0425 ce_f=5.3118
[loss-randlabel] ep 7 it 40 total=1.1348 ce_r=0.0389 ce_f=5.4795
[loss-randlabel] ep 7 it 90 total=1.0027 ce_r=0.0276 ce_f=4.8751
[loss-randlabel] ep 7 it 140 total=0.9916 ce_r=0.0309 ce_f=4.8034
[loss-randlabel] ep 7 it 190 total=1.0170 ce_r=0.0340 ce_f=4.9149
[loss-randlabel] ep 7 it 240 total=0.9721 ce_r=0.0565 ce_f=4.5779
[loss-randlabel] ep 7 it 290 total=1.0030 ce_r=0.0205 ce_f=4.9126
[loss-randlabel] ep 7 it 340 total=0.9752 ce_r=0.0186 ce_f=4.7830
[loss-randlabel] ep 7 it 390 total=0.9933 ce_r=0.0168 ce_f=4.8826
[loss-randlabel] ep 8 it 10 total=0.9382 ce_r=0.0127 ce_f=4.6278
[loss-randlabel] ep 8 it 60 total=0.9754 ce_r=0.0239 ce_f=4.7578
[loss-randlabel] ep 8 it 110 total=0.9311 ce_r=0.0235 ce_f=4.5379
[loss-randlabel] ep 8 it 160 total=0.9714 ce_r=0.0173 ce_f=4.7703
[loss-randlabel] ep 8 it 210 total=1.0032 ce_r=0.0509 ce_f=4.7619
[loss-randlabel] ep 8 it 260 total=0.9870 ce_r=0.0671 ce_f=4.5992
[loss-randlabel] ep 8 it 310 total=1.0513 ce_r=0.0219 ce_f=5.1466
[loss-randlabel] ep 8 it 360 total=1.0306 ce_r=0.0168 ce_f=5.0689
[loss-randlabel] ep 8 it 410 total=1.0160 ce_r=0.0255 ce_f=4.9530
[loss-randlabel] ep 9 it 30 total=1.0314 ce_r=0.0429 ce_f=4.9426
[loss-randlabel] ep 9 it 80 total=0.9913 ce_r=0.0154 ce_f=4.8797
[loss-randlabel] ep 9 it 130 total=0.9499 ce_r=0.0108 ce_f=4.6951
[loss-randlabel] ep 9 it 180 total=0.9731 ce_r=0.0360 ce_f=4.6854
[loss-randlabel] ep 9 it 230 total=1.0274 ce_r=0.0336 ce_f=4.9691
[loss-randlabel] ep 9 it 280 total=0.9961 ce_r=0.0558 ce_f=4.7015
[loss-randlabel] ep 9 it 330 total=0.9377 ce_r=0.0328 ce_f=4.5250
[loss-randlabel] ep 9 it 380 total=1.0193 ce_r=0.0431 ce_f=4.8810
[loss-randlabel] ep 10 it 0 total=0.9840 ce_r=0.0223 ce_f=4.8085
[loss-randlabel] ep 10 it 50 total=0.9478 ce_r=0.0128 ce_f=4.6751
[loss-randlabel] ep 10 it 100 total=0.9491 ce_r=0.0158 ce_f=4.6666
[loss-randlabel] ep 10 it 150 total=1.0868 ce_r=0.0682 ce_f=5.0929
[loss-randlabel] ep 10 it 200 total=0.9782 ce_r=0.0207 ce_f=4.7876
[loss-randlabel] ep 10 it 250 total=1.0581 ce_r=0.0177 ce_f=5.2019
[loss-randlabel] ep 10 it 300 total=1.0026 ce_r=0.0228 ce_f=4.8989
[loss-randlabel] ep 10 it 350 total=0.9755 ce_r=0.0149 ce_f=4.8034
[loss-randlabel] ep 10 it 400 total=1.0121 ce_r=0.0193 ce_f=4.9638
[loss-randlabel] ep 11 it 20 total=0.9480 ce_r=0.0094 ce_f=4.6933
[loss-randlabel] ep 11 it 70 total=1.0608 ce_r=0.0382 ce_f=5.1130
[loss-randlabel] ep 11 it 120 total=0.9455 ce_r=0.0147 ce_f=4.6539
[loss-randlabel] ep 11 it 170 total=0.9833 ce_r=0.0156 ce_f=4.8385
[loss-randlabel] ep 11 it 220 total=0.9798 ce_r=0.0283 ce_f=4.7575
[loss-randlabel] ep 11 it 270 total=1.0329 ce_r=0.0476 ce_f=4.9268
[loss-randlabel] ep 11 it 320 total=0.9833 ce_r=0.0105 ce_f=4.8640
[loss-randlabel] ep 11 it 370 total=0.9849 ce_r=0.0251 ce_f=4.7990
[loss-randlabel] ep 11 it 420 total=0.9999 ce_r=0.0258 ce_f=4.8704
[loss-randlabel] ep 12 it 40 total=0.9766 ce_r=0.0287 ce_f=4.7391
[loss-randlabel] ep 12 it 90 total=1.0282 ce_r=0.0278 ce_f=5.0017
[loss-randlabel] ep 12 it 140 total=1.0592 ce_r=0.0342 ce_f=5.1248
[loss-randlabel] ep 12 it 190 total=0.9854 ce_r=0.0292 ce_f=4.7809
[loss-randlabel] ep 12 it 240 total=0.9493 ce_r=0.0227 ce_f=4.6331
[loss-randlabel] ep 12 it 290 total=0.9498 ce_r=0.0149 ce_f=4.6745
[loss-randlabel] ep 12 it 340 total=1.0433 ce_r=0.0291 ce_f=5.0712
[loss-randlabel] ep 12 it 390 total=0.9959 ce_r=0.0131 ce_f=4.9140
[loss-randlabel] ep 13 it 10 total=0.9732 ce_r=0.0395 ce_f=4.6685
[loss-randlabel] ep 13 it 60 total=0.9583 ce_r=0.0362 ce_f=4.6105
[loss-randlabel] ep 13 it 110 total=1.0004 ce_r=0.0361 ce_f=4.8214
[loss-randlabel] ep 13 it 160 total=0.9499 ce_r=0.0188 ce_f=4.6557
[loss-randlabel] ep 13 it 210 total=0.9679 ce_r=0.0183 ce_f=4.7479
[loss-randlabel] ep 13 it 260 total=1.0523 ce_r=0.0276 ce_f=5.1235
[loss-randlabel] ep 13 it 310 total=0.9559 ce_r=0.0188 ce_f=4.6855
[loss-randlabel] ep 13 it 360 total=0.9740 ce_r=0.0199 ce_f=4.7704
[loss-randlabel] ep 13 it 410 total=0.9571 ce_r=0.0107 ce_f=4.7319
[loss-randlabel] ep 14 it 30 total=0.9671 ce_r=0.0194 ce_f=4.7385
[loss-randlabel] ep 14 it 80 total=0.9686 ce_r=0.0186 ce_f=4.7498
[loss-randlabel] ep 14 it 130 total=0.9339 ce_r=0.0136 ce_f=4.6018
 30%|███       | 15/50 [04:27<09:38, 16.52s/it] 32%|███▏      | 16/50 [04:43<09:13, 16.27s/it] 34%|███▍      | 17/50 [05:00<08:57, 16.30s/it] 36%|███▌      | 18/50 [05:16<08:43, 16.36s/it] 38%|███▊      | 19/50 [05:32<08:26, 16.34s/it] 40%|████      | 20/50 [05:49<08:10, 16.34s/it] 42%|████▏     | 21/50 [06:05<07:50, 16.21s/it] 44%|████▍     | 22/50 [06:21<07:33, 16.21s/it] 46%|████▌     | 23/50 [06:37<07:19, 16.27s/it] 48%|████▊     | 24/50 [06:54<07:05, 16.35s/it] 50%|█████     | 25/50 [07:10<06:45, 16.23s/it] 52%|█████▏    | 26/50 [07:26<06:30, 16.26s/it] 54%|█████▍    | 27/50 [07:42<06:12, 16.19s/it] 56%|█████▌    | 28/50 [07:58<05:55, 16.15s/it][loss-randlabel] ep 14 it 180 total=0.9348 ce_r=0.0105 ce_f=4.6213
[loss-randlabel] ep 14 it 230 total=1.0998 ce_r=0.0512 ce_f=5.2433
[loss-randlabel] ep 14 it 280 total=1.0076 ce_r=0.0423 ce_f=4.8266
[loss-randlabel] ep 14 it 330 total=1.0184 ce_r=0.0139 ce_f=5.0226
[loss-randlabel] ep 14 it 380 total=0.9651 ce_r=0.0075 ce_f=4.7879
[loss-randlabel] ep 15 it 0 total=0.9578 ce_r=0.0138 ce_f=4.7201
[loss-randlabel] ep 15 it 50 total=0.9949 ce_r=0.0291 ce_f=4.8287
[loss-randlabel] ep 15 it 100 total=0.9400 ce_r=0.0097 ce_f=4.6514
[loss-randlabel] ep 15 it 150 total=0.9911 ce_r=0.0090 ce_f=4.9105
[loss-randlabel] ep 15 it 200 total=1.0306 ce_r=0.0233 ce_f=5.0361
[loss-randlabel] ep 15 it 250 total=1.0182 ce_r=0.0233 ce_f=4.9745
[loss-randlabel] ep 15 it 300 total=0.9772 ce_r=0.0295 ce_f=4.7386
[loss-randlabel] ep 15 it 350 total=0.9422 ce_r=0.0121 ce_f=4.6504
[loss-randlabel] ep 15 it 400 total=0.9778 ce_r=0.0143 ce_f=4.8171
[loss-randlabel] ep 16 it 20 total=0.9736 ce_r=0.0494 ce_f=4.6208
[loss-randlabel] ep 16 it 70 total=0.9747 ce_r=0.0166 ce_f=4.7908
[loss-randlabel] ep 16 it 120 total=0.9897 ce_r=0.0160 ce_f=4.8685
[loss-randlabel] ep 16 it 170 total=1.0232 ce_r=0.0186 ce_f=5.0232
[loss-randlabel] ep 16 it 220 total=0.9821 ce_r=0.0114 ce_f=4.8537
[loss-randlabel] ep 16 it 270 total=1.0077 ce_r=0.0312 ce_f=4.8827
[loss-randlabel] ep 16 it 320 total=0.9408 ce_r=0.0108 ce_f=4.6504
[loss-randlabel] ep 16 it 370 total=1.0285 ce_r=0.0628 ce_f=4.8284
[loss-randlabel] ep 16 it 420 total=1.0197 ce_r=0.0237 ce_f=4.9800
[loss-randlabel] ep 17 it 40 total=1.0175 ce_r=0.0145 ce_f=5.0149
[loss-randlabel] ep 17 it 90 total=0.9818 ce_r=0.0191 ce_f=4.8135
[loss-randlabel] ep 17 it 140 total=0.9907 ce_r=0.0059 ce_f=4.9240
[loss-randlabel] ep 17 it 190 total=1.0801 ce_r=0.0595 ce_f=5.1029
[loss-randlabel] ep 17 it 240 total=1.0287 ce_r=0.0143 ce_f=5.0721
[loss-randlabel] ep 17 it 290 total=1.0093 ce_r=0.0613 ce_f=4.7400
[loss-randlabel] ep 17 it 340 total=0.9691 ce_r=0.0177 ce_f=4.7570
[loss-randlabel] ep 17 it 390 total=0.9924 ce_r=0.0390 ce_f=4.7669
[loss-randlabel] ep 18 it 10 total=0.9903 ce_r=0.0208 ce_f=4.8475
[loss-randlabel] ep 18 it 60 total=0.9949 ce_r=0.0230 ce_f=4.8591
[loss-randlabel] ep 18 it 110 total=0.9135 ce_r=0.0125 ce_f=4.5049
[loss-randlabel] ep 18 it 160 total=0.9356 ce_r=0.0073 ce_f=4.6417
[loss-randlabel] ep 18 it 210 total=0.9677 ce_r=0.0208 ce_f=4.7342
[loss-randlabel] ep 18 it 260 total=0.9820 ce_r=0.0182 ce_f=4.8188
[loss-randlabel] ep 18 it 310 total=1.0393 ce_r=0.0657 ce_f=4.8682
[loss-randlabel] ep 18 it 360 total=1.0009 ce_r=0.0352 ce_f=4.8286
[loss-randlabel] ep 18 it 410 total=1.0500 ce_r=0.0315 ce_f=5.0924
[loss-randlabel] ep 19 it 30 total=1.0490 ce_r=0.0488 ce_f=5.0012
[loss-randlabel] ep 19 it 80 total=1.0969 ce_r=0.0551 ce_f=5.2090
[loss-randlabel] ep 19 it 130 total=0.9765 ce_r=0.0337 ce_f=4.7137
[loss-randlabel] ep 19 it 180 total=0.9900 ce_r=0.0560 ce_f=4.6700
[loss-randlabel] ep 19 it 230 total=1.0212 ce_r=0.0217 ce_f=4.9975
[loss-randlabel] ep 19 it 280 total=0.9877 ce_r=0.0107 ce_f=4.8850
[loss-randlabel] ep 19 it 330 total=0.9583 ce_r=0.0099 ce_f=4.7419
[loss-randlabel] ep 19 it 380 total=0.9957 ce_r=0.0218 ce_f=4.8698
[loss-randlabel] ep 20 it 0 total=0.9749 ce_r=0.0379 ce_f=4.6849
[loss-randlabel] ep 20 it 50 total=0.9602 ce_r=0.0314 ce_f=4.6443
[loss-randlabel] ep 20 it 100 total=0.9529 ce_r=0.0178 ce_f=4.6755
[loss-randlabel] ep 20 it 150 total=0.9975 ce_r=0.0487 ce_f=4.7440
[loss-randlabel] ep 20 it 200 total=0.9959 ce_r=0.0096 ce_f=4.9314
[loss-randlabel] ep 20 it 250 total=0.9461 ce_r=0.0328 ce_f=4.5662
[loss-randlabel] ep 20 it 300 total=0.9416 ce_r=0.0296 ce_f=4.5602
[loss-randlabel] ep 20 it 350 total=1.0173 ce_r=0.0346 ce_f=4.9135
[loss-randlabel] ep 20 it 400 total=0.9925 ce_r=0.0182 ce_f=4.8714
[loss-randlabel] ep 21 it 20 total=1.0157 ce_r=0.0134 ce_f=5.0115
[loss-randlabel] ep 21 it 70 total=0.9779 ce_r=0.0221 ce_f=4.7785
[loss-randlabel] ep 21 it 120 total=0.9451 ce_r=0.0199 ce_f=4.6262
[loss-randlabel] ep 21 it 170 total=0.9933 ce_r=0.0263 ce_f=4.8346
[loss-randlabel] ep 21 it 220 total=0.9573 ce_r=0.0108 ce_f=4.7328
[loss-randlabel] ep 21 it 270 total=1.0784 ce_r=0.0485 ce_f=5.1493
[loss-randlabel] ep 21 it 320 total=0.9854 ce_r=0.0286 ce_f=4.7840
[loss-randlabel] ep 21 it 370 total=0.9913 ce_r=0.0154 ce_f=4.8797
[loss-randlabel] ep 21 it 420 total=0.9814 ce_r=0.0224 ce_f=4.7949
[loss-randlabel] ep 22 it 40 total=0.9694 ce_r=0.0101 ce_f=4.7966
[loss-randlabel] ep 22 it 90 total=0.9393 ce_r=0.0104 ce_f=4.6445
[loss-randlabel] ep 22 it 140 total=1.0060 ce_r=0.0374 ce_f=4.8431
[loss-randlabel] ep 22 it 190 total=0.9611 ce_r=0.0129 ce_f=4.7407
[loss-randlabel] ep 22 it 240 total=0.9354 ce_r=0.0133 ce_f=4.6105
[loss-randlabel] ep 22 it 290 total=1.0068 ce_r=0.0487 ce_f=4.7906
[loss-randlabel] ep 22 it 340 total=0.9358 ce_r=0.0349 ce_f=4.5048
[loss-randlabel] ep 22 it 390 total=0.9847 ce_r=0.0207 ce_f=4.8197
[loss-randlabel] ep 23 it 10 total=1.0257 ce_r=0.0922 ce_f=4.6677
[loss-randlabel] ep 23 it 60 total=0.9799 ce_r=0.0150 ce_f=4.8247
[loss-randlabel] ep 23 it 110 total=0.9653 ce_r=0.0336 ce_f=4.6587
[loss-randlabel] ep 23 it 160 total=1.0067 ce_r=0.0364 ce_f=4.8515
[loss-randlabel] ep 23 it 210 total=0.9596 ce_r=0.0258 ce_f=4.6688
[loss-randlabel] ep 23 it 260 total=0.9622 ce_r=0.0241 ce_f=4.6907
[loss-randlabel] ep 23 it 310 total=1.0305 ce_r=0.0610 ce_f=4.8477
[loss-randlabel] ep 23 it 360 total=0.9778 ce_r=0.0104 ce_f=4.8369
[loss-randlabel] ep 23 it 410 total=0.9779 ce_r=0.0526 ce_f=4.6268
[loss-randlabel] ep 24 it 30 total=0.9595 ce_r=0.0151 ce_f=4.7223
[loss-randlabel] ep 24 it 80 total=1.0905 ce_r=0.0561 ce_f=5.1720
[loss-randlabel] ep 24 it 130 total=0.9979 ce_r=0.0209 ce_f=4.8850
[loss-randlabel] ep 24 it 180 total=0.9411 ce_r=0.0218 ce_f=4.5962
[loss-randlabel] ep 24 it 230 total=1.0091 ce_r=0.0090 ce_f=5.0002
[loss-randlabel] ep 24 it 280 total=0.9832 ce_r=0.0323 ce_f=4.7547
[loss-randlabel] ep 24 it 330 total=0.9607 ce_r=0.0136 ce_f=4.7357
[loss-randlabel] ep 24 it 380 total=0.9791 ce_r=0.0301 ce_f=4.7450
[loss-randlabel] ep 25 it 0 total=0.9382 ce_r=0.0155 ce_f=4.6134
[loss-randlabel] ep 25 it 50 total=1.0082 ce_r=0.0104 ce_f=4.9891
[loss-randlabel] ep 25 it 100 total=0.9949 ce_r=0.0145 ce_f=4.9019
[loss-randlabel] ep 25 it 150 total=0.9866 ce_r=0.0593 ce_f=4.6365
[loss-randlabel] ep 25 it 200 total=0.9826 ce_r=0.0202 ce_f=4.8121
[loss-randlabel] ep 25 it 250 total=1.0230 ce_r=0.0533 ce_f=4.8482
[loss-randlabel] ep 25 it 300 total=0.9254 ce_r=0.0122 ce_f=4.5658
[loss-randlabel] ep 25 it 350 total=0.9798 ce_r=0.0083 ce_f=4.8574
[loss-randlabel] ep 25 it 400 total=0.9917 ce_r=0.0353 ce_f=4.7820
[loss-randlabel] ep 26 it 20 total=0.9763 ce_r=0.0176 ce_f=4.7935
[loss-randlabel] ep 26 it 70 total=0.9861 ce_r=0.0189 ce_f=4.8361
[loss-randlabel] ep 26 it 120 total=0.9573 ce_r=0.0134 ce_f=4.7198
[loss-randlabel] ep 26 it 170 total=0.9832 ce_r=0.0100 ce_f=4.8659
[loss-randlabel] ep 26 it 220 total=0.9982 ce_r=0.0308 ce_f=4.8370
[loss-randlabel] ep 26 it 270 total=0.9680 ce_r=0.0118 ce_f=4.7814
[loss-randlabel] ep 26 it 320 total=0.9879 ce_r=0.0311 ce_f=4.7836
[loss-randlabel] ep 26 it 370 total=0.9595 ce_r=0.0102 ce_f=4.7463
[loss-randlabel] ep 26 it 420 total=0.9492 ce_r=0.0288 ce_f=4.6020
[loss-randlabel] ep 27 it 40 total=0.9565 ce_r=0.0166 ce_f=4.6998
[loss-randlabel] ep 27 it 90 total=0.9448 ce_r=0.0115 ce_f=4.6663
[loss-randlabel] ep 27 it 140 total=0.9613 ce_r=0.0093 ce_f=4.7600
[loss-randlabel] ep 27 it 190 total=0.9738 ce_r=0.0155 ce_f=4.7917
[loss-randlabel] ep 27 it 240 total=1.0056 ce_r=0.0533 ce_f=4.7615
[loss-randlabel] ep 27 it 290 total=0.9703 ce_r=0.0316 ce_f=4.6931
[loss-randlabel] ep 27 it 340 total=0.9563 ce_r=0.0102 ce_f=4.7305
[loss-randlabel] ep 27 it 390 total=0.9954 ce_r=0.0094 ce_f=4.9299
[loss-randlabel] ep 28 it 10 total=0.9800 ce_r=0.0684 ce_f=4.5580
[loss-randlabel] ep 28 it 60 total=0.9541 ce_r=0.0099 ce_f=4.7207
[loss-randlabel] ep 28 it 110 total=1.0116 ce_r=0.0060 ce_f=5.0279
[loss-randlabel] ep 28 it 160 total=0.9717 ce_r=0.0124 ce_f=4.7964
[loss-randlabel] ep 28 it 210 total=0.9925 ce_r=0.0916 ce_f=4.5045
 58%|█████▊    | 29/50 [08:14<05:38, 16.14s/it] 60%|██████    | 30/50 [08:31<05:24, 16.24s/it] 62%|██████▏   | 31/50 [08:47<05:10, 16.32s/it] 64%|██████▍   | 32/50 [09:03<04:52, 16.23s/it] 66%|██████▌   | 33/50 [09:19<04:35, 16.22s/it] 68%|██████▊   | 34/50 [09:36<04:20, 16.29s/it] 70%|███████   | 35/50 [09:52<04:03, 16.26s/it] 72%|███████▏  | 36/50 [10:08<03:46, 16.15s/it] 74%|███████▍  | 37/50 [10:24<03:30, 16.16s/it] 76%|███████▌  | 38/50 [10:40<03:13, 16.17s/it] 78%|███████▊  | 39/50 [10:56<02:56, 16.09s/it] 80%|████████  | 40/50 [11:13<02:42, 16.21s/it] 82%|████████▏ | 41/50 [11:29<02:26, 16.27s/it] 84%|████████▍ | 42/50 [11:45<02:10, 16.25s/it][loss-randlabel] ep 28 it 260 total=1.0298 ce_r=0.0346 ce_f=4.9760
[loss-randlabel] ep 28 it 310 total=1.0202 ce_r=0.0382 ce_f=4.9100
[loss-randlabel] ep 28 it 360 total=1.0250 ce_r=0.0390 ce_f=4.9300
[loss-randlabel] ep 28 it 410 total=1.0212 ce_r=0.0409 ce_f=4.9013
[loss-randlabel] ep 29 it 30 total=0.9652 ce_r=0.0162 ce_f=4.7450
[loss-randlabel] ep 29 it 80 total=0.9745 ce_r=0.0270 ce_f=4.7376
[loss-randlabel] ep 29 it 130 total=0.9638 ce_r=0.0305 ce_f=4.6668
[loss-randlabel] ep 29 it 180 total=0.9576 ce_r=0.0076 ce_f=4.7498
[loss-randlabel] ep 29 it 230 total=0.9734 ce_r=0.0541 ce_f=4.5966
[loss-randlabel] ep 29 it 280 total=0.9205 ce_r=0.0159 ce_f=4.5232
[loss-randlabel] ep 29 it 330 total=0.9529 ce_r=0.0223 ce_f=4.6532
[loss-randlabel] ep 29 it 380 total=0.9424 ce_r=0.0137 ce_f=4.6437
[loss-randlabel] ep 30 it 0 total=0.9435 ce_r=0.0153 ce_f=4.6410
[loss-randlabel] ep 30 it 50 total=0.9522 ce_r=0.0145 ce_f=4.6887
[loss-randlabel] ep 30 it 100 total=0.9638 ce_r=0.0325 ce_f=4.6564
[loss-randlabel] ep 30 it 150 total=0.9524 ce_r=0.0181 ce_f=4.6715
[loss-randlabel] ep 30 it 200 total=0.9870 ce_r=0.0540 ce_f=4.6648
[loss-randlabel] ep 30 it 250 total=0.9715 ce_r=0.0156 ce_f=4.7798
[loss-randlabel] ep 30 it 300 total=1.0007 ce_r=0.0562 ce_f=4.7226
[loss-randlabel] ep 30 it 350 total=0.9464 ce_r=0.0104 ce_f=4.6799
[loss-randlabel] ep 30 it 400 total=0.9564 ce_r=0.0297 ce_f=4.6336
[loss-randlabel] ep 31 it 20 total=0.9344 ce_r=0.0098 ce_f=4.6232
[loss-randlabel] ep 31 it 70 total=0.9886 ce_r=0.0215 ce_f=4.8355
[loss-randlabel] ep 31 it 120 total=0.9844 ce_r=0.0503 ce_f=4.6702
[loss-randlabel] ep 31 it 170 total=1.0076 ce_r=0.0520 ce_f=4.7779
[loss-randlabel] ep 31 it 220 total=0.9672 ce_r=0.0180 ce_f=4.7457
[loss-randlabel] ep 31 it 270 total=1.0323 ce_r=0.0583 ce_f=4.8703
[loss-randlabel] ep 31 it 320 total=0.9652 ce_r=0.0130 ce_f=4.7611
[loss-randlabel] ep 31 it 370 total=1.0209 ce_r=0.0281 ce_f=4.9640
[loss-randlabel] ep 31 it 420 total=0.9844 ce_r=0.0361 ce_f=4.7415
[loss-randlabel] ep 32 it 40 total=0.9506 ce_r=0.0276 ce_f=4.6151
[loss-randlabel] ep 32 it 90 total=1.0148 ce_r=0.0552 ce_f=4.7982
[loss-randlabel] ep 32 it 140 total=0.9891 ce_r=0.0421 ce_f=4.7349
[loss-randlabel] ep 32 it 190 total=0.9502 ce_r=0.0123 ce_f=4.6897
[loss-randlabel] ep 32 it 240 total=0.9705 ce_r=0.0095 ce_f=4.8048
[loss-randlabel] ep 32 it 290 total=1.0232 ce_r=0.0772 ce_f=4.7301
[loss-randlabel] ep 32 it 340 total=0.9659 ce_r=0.0524 ce_f=4.5678
[loss-randlabel] ep 32 it 390 total=0.9527 ce_r=0.0108 ce_f=4.7099
[loss-randlabel] ep 33 it 10 total=0.9672 ce_r=0.0138 ce_f=4.7669
[loss-randlabel] ep 33 it 60 total=0.9839 ce_r=0.0166 ce_f=4.8365
[loss-randlabel] ep 33 it 110 total=0.9729 ce_r=0.0156 ce_f=4.7866
[loss-randlabel] ep 33 it 160 total=0.9885 ce_r=0.0312 ce_f=4.7860
[loss-randlabel] ep 33 it 210 total=0.9610 ce_r=0.0083 ce_f=4.7638
[loss-randlabel] ep 33 it 260 total=0.9621 ce_r=0.0113 ce_f=4.7538
[loss-randlabel] ep 33 it 310 total=0.9577 ce_r=0.0200 ce_f=4.6888
[loss-randlabel] ep 33 it 360 total=0.9683 ce_r=0.0396 ce_f=4.6436
[loss-randlabel] ep 33 it 410 total=0.9569 ce_r=0.0105 ce_f=4.7320
[loss-randlabel] ep 34 it 30 total=0.9599 ce_r=0.0073 ce_f=4.7630
[loss-randlabel] ep 34 it 80 total=0.9372 ce_r=0.0101 ce_f=4.6354
[loss-randlabel] ep 34 it 130 total=0.9539 ce_r=0.0119 ce_f=4.7099
[loss-randlabel] ep 34 it 180 total=0.9654 ce_r=0.0084 ce_f=4.7853
[loss-randlabel] ep 34 it 230 total=0.9552 ce_r=0.0184 ce_f=4.6839
[loss-randlabel] ep 34 it 280 total=0.9976 ce_r=0.0284 ce_f=4.8460
[loss-randlabel] ep 34 it 330 total=0.9591 ce_r=0.0219 ce_f=4.6861
[loss-randlabel] ep 34 it 380 total=0.9868 ce_r=0.0096 ce_f=4.8863
[loss-randlabel] ep 35 it 0 total=0.9807 ce_r=0.0137 ce_f=4.8351
[loss-randlabel] ep 35 it 50 total=0.9439 ce_r=0.0131 ce_f=4.6544
[loss-randlabel] ep 35 it 100 total=0.9962 ce_r=0.0169 ce_f=4.8965
[loss-randlabel] ep 35 it 150 total=0.9633 ce_r=0.0131 ce_f=4.7513
[loss-randlabel] ep 35 it 200 total=0.9713 ce_r=0.0284 ce_f=4.7145
[loss-randlabel] ep 35 it 250 total=0.9359 ce_r=0.0065 ce_f=4.6470
[loss-randlabel] ep 35 it 300 total=0.9926 ce_r=0.0477 ce_f=4.7248
[loss-randlabel] ep 35 it 350 total=0.9493 ce_r=0.0096 ce_f=4.6980
[loss-randlabel] ep 35 it 400 total=0.9827 ce_r=0.0098 ce_f=4.8643
[loss-randlabel] ep 36 it 20 total=0.9276 ce_r=0.0083 ce_f=4.5962
[loss-randlabel] ep 36 it 70 total=0.9906 ce_r=0.0190 ce_f=4.8582
[loss-randlabel] ep 36 it 120 total=0.9510 ce_r=0.0215 ce_f=4.6471
[loss-randlabel] ep 36 it 170 total=0.9551 ce_r=0.0128 ce_f=4.7119
[loss-randlabel] ep 36 it 220 total=0.9908 ce_r=0.0330 ce_f=4.7894
[loss-randlabel] ep 36 it 270 total=0.9838 ce_r=0.0168 ce_f=4.8354
[loss-randlabel] ep 36 it 320 total=0.9807 ce_r=0.0189 ce_f=4.8093
[loss-randlabel] ep 36 it 370 total=1.0266 ce_r=0.0885 ce_f=4.6908
[loss-randlabel] ep 36 it 420 total=1.0343 ce_r=0.0107 ce_f=5.1181
[loss-randlabel] ep 37 it 40 total=0.9614 ce_r=0.0081 ce_f=4.7667
[loss-randlabel] ep 37 it 90 total=0.9755 ce_r=0.0215 ce_f=4.7700
[loss-randlabel] ep 37 it 140 total=0.9767 ce_r=0.0095 ce_f=4.8360
[loss-randlabel] ep 37 it 190 total=1.0187 ce_r=0.0510 ce_f=4.8383
[loss-randlabel] ep 37 it 240 total=0.9662 ce_r=0.0073 ce_f=4.7945
[loss-randlabel] ep 37 it 290 total=0.9551 ce_r=0.0156 ce_f=4.6972
[loss-randlabel] ep 37 it 340 total=0.9698 ce_r=0.0199 ce_f=4.7495
[loss-randlabel] ep 37 it 390 total=0.9710 ce_r=0.0303 ce_f=4.7035
[loss-randlabel] ep 38 it 10 total=0.9879 ce_r=0.0284 ce_f=4.7975
[loss-randlabel] ep 38 it 60 total=0.9710 ce_r=0.0077 ce_f=4.8163
[loss-randlabel] ep 38 it 110 total=0.9642 ce_r=0.0266 ce_f=4.6878
[loss-randlabel] ep 38 it 160 total=0.9268 ce_r=0.0473 ce_f=4.3975
[loss-randlabel] ep 38 it 210 total=1.0065 ce_r=0.0158 ce_f=4.9533
[loss-randlabel] ep 38 it 260 total=0.9875 ce_r=0.0172 ce_f=4.8518
[loss-randlabel] ep 38 it 310 total=0.9455 ce_r=0.0091 ce_f=4.6818
[loss-randlabel] ep 38 it 360 total=0.9514 ce_r=0.0117 ce_f=4.6980
[loss-randlabel] ep 38 it 410 total=0.9982 ce_r=0.0483 ce_f=4.7495
[loss-randlabel] ep 39 it 30 total=0.9763 ce_r=0.0085 ce_f=4.8388
[loss-randlabel] ep 39 it 80 total=1.0034 ce_r=0.0609 ce_f=4.7123
[loss-randlabel] ep 39 it 130 total=0.9865 ce_r=0.0222 ce_f=4.8216
[loss-randlabel] ep 39 it 180 total=0.9793 ce_r=0.0363 ce_f=4.7148
[loss-randlabel] ep 39 it 230 total=0.9871 ce_r=0.0380 ce_f=4.7458
[loss-randlabel] ep 39 it 280 total=0.9651 ce_r=0.0168 ce_f=4.7418
[loss-randlabel] ep 39 it 330 total=0.9912 ce_r=0.0124 ce_f=4.8943
[loss-randlabel] ep 39 it 380 total=1.0006 ce_r=0.0096 ce_f=4.9551
[loss-randlabel] ep 40 it 0 total=0.9676 ce_r=0.0180 ce_f=4.7483
[loss-randlabel] ep 40 it 50 total=0.9561 ce_r=0.0132 ce_f=4.7140
[loss-randlabel] ep 40 it 100 total=0.9364 ce_r=0.0070 ce_f=4.6468
[loss-randlabel] ep 40 it 150 total=0.9625 ce_r=0.0063 ce_f=4.7807
[loss-randlabel] ep 40 it 200 total=0.9601 ce_r=0.0334 ce_f=4.6331
[loss-randlabel] ep 40 it 250 total=1.0041 ce_r=0.0729 ce_f=4.6561
[loss-randlabel] ep 40 it 300 total=0.9617 ce_r=0.0456 ce_f=4.5802
[loss-randlabel] ep 40 it 350 total=1.0107 ce_r=0.0356 ce_f=4.8755
[loss-randlabel] ep 40 it 400 total=1.0226 ce_r=0.0455 ce_f=4.8852
[loss-randlabel] ep 41 it 20 total=0.9960 ce_r=0.0087 ce_f=4.9364
[loss-randlabel] ep 41 it 70 total=0.9741 ce_r=0.0248 ce_f=4.7465
[loss-randlabel] ep 41 it 120 total=1.0098 ce_r=0.0250 ce_f=4.9238
[loss-randlabel] ep 41 it 170 total=0.9659 ce_r=0.0073 ce_f=4.7930
[loss-randlabel] ep 41 it 220 total=0.9685 ce_r=0.0083 ce_f=4.8011
[loss-randlabel] ep 41 it 270 total=0.9924 ce_r=0.0373 ce_f=4.7754
[loss-randlabel] ep 41 it 320 total=0.9674 ce_r=0.0240 ce_f=4.7168
[loss-randlabel] ep 41 it 370 total=0.9873 ce_r=0.0217 ce_f=4.8278
[loss-randlabel] ep 41 it 420 total=0.9867 ce_r=0.0327 ce_f=4.7700
[loss-randlabel] ep 42 it 40 total=0.9562 ce_r=0.0184 ce_f=4.6890
[loss-randlabel] ep 42 it 90 total=0.9601 ce_r=0.0084 ce_f=4.7584
[loss-randlabel] ep 42 it 140 total=0.9836 ce_r=0.0057 ce_f=4.8896
[loss-randlabel] ep 42 it 190 total=1.0282 ce_r=0.0266 ce_f=5.0076
[loss-randlabel] ep 42 it 240 total=0.9487 ce_r=0.0087 ce_f=4.7001
[loss-randlabel] ep 42 it 290 total=0.9558 ce_r=0.0133 ce_f=4.7128
 86%|████████▌ | 43/50 [12:01<01:53, 16.23s/it] 88%|████████▊ | 44/50 [12:17<01:36, 16.15s/it] 90%|█████████ | 45/50 [12:33<01:20, 16.06s/it] 92%|█████████▏| 46/50 [12:49<01:04, 16.02s/it] 94%|█████████▍| 47/50 [13:05<00:48, 16.07s/it] 96%|█████████▌| 48/50 [13:21<00:32, 16.02s/it] 98%|█████████▊| 49/50 [13:37<00:15, 16.00s/it]100%|██████████| 50/50 [13:53<00:00, 15.95s/it]100%|██████████| 50/50 [13:53<00:00, 16.67s/it]
[loss-randlabel] ep 42 it 340 total=0.9638 ce_r=0.0283 ce_f=4.6775
[loss-randlabel] ep 42 it 390 total=0.9865 ce_r=0.0237 ce_f=4.8141
[loss-randlabel] ep 43 it 10 total=0.9758 ce_r=0.0108 ce_f=4.8247
[loss-randlabel] ep 43 it 60 total=0.9394 ce_r=0.0303 ce_f=4.5456
[loss-randlabel] ep 43 it 110 total=0.9609 ce_r=0.0119 ce_f=4.7450
[loss-randlabel] ep 43 it 160 total=0.9516 ce_r=0.0140 ce_f=4.6883
[loss-randlabel] ep 43 it 210 total=1.0014 ce_r=0.0147 ce_f=4.9338
[loss-randlabel] ep 43 it 260 total=0.9399 ce_r=0.0180 ce_f=4.6095
[loss-randlabel] ep 43 it 310 total=0.9380 ce_r=0.0107 ce_f=4.6367
[loss-randlabel] ep 43 it 360 total=0.9833 ce_r=0.0064 ce_f=4.8843
[loss-randlabel] ep 43 it 410 total=0.9400 ce_r=0.0132 ce_f=4.6341
[loss-randlabel] ep 44 it 30 total=0.9791 ce_r=0.0170 ce_f=4.8101
[loss-randlabel] ep 44 it 80 total=0.9888 ce_r=0.0364 ce_f=4.7621
[loss-randlabel] ep 44 it 130 total=0.8522 ce_r=0.0200 ce_f=4.1606
[loss-randlabel] ep 44 it 180 total=1.0202 ce_r=0.0732 ce_f=4.7348
[loss-randlabel] ep 44 it 230 total=0.9693 ce_r=0.0104 ce_f=4.7948
[loss-randlabel] ep 44 it 280 total=0.8877 ce_r=0.0057 ce_f=4.4096
[loss-randlabel] ep 44 it 330 total=0.9547 ce_r=0.0263 ce_f=4.6423
[loss-randlabel] ep 44 it 380 total=0.9680 ce_r=0.0136 ce_f=4.7719
[loss-randlabel] ep 45 it 0 total=0.9487 ce_r=0.0146 ce_f=4.6707
[loss-randlabel] ep 45 it 50 total=0.9513 ce_r=0.0129 ce_f=4.6920
[loss-randlabel] ep 45 it 100 total=0.9648 ce_r=0.0147 ce_f=4.7504
[loss-randlabel] ep 45 it 150 total=0.9399 ce_r=0.0123 ce_f=4.6379
[loss-randlabel] ep 45 it 200 total=0.9090 ce_r=0.0113 ce_f=4.4889
[loss-randlabel] ep 45 it 250 total=0.9495 ce_r=0.0077 ce_f=4.7092
[loss-randlabel] ep 45 it 300 total=0.9828 ce_r=0.0089 ce_f=4.8695
[loss-randlabel] ep 45 it 350 total=0.9585 ce_r=0.0113 ce_f=4.7358
[loss-randlabel] ep 45 it 400 total=0.9802 ce_r=0.0270 ce_f=4.7664
[loss-randlabel] ep 46 it 20 total=0.9159 ce_r=0.0059 ce_f=4.5499
[loss-randlabel] ep 46 it 70 total=0.9951 ce_r=0.0180 ce_f=4.8853
[loss-randlabel] ep 46 it 120 total=0.9575 ce_r=0.0117 ce_f=4.7290
[loss-randlabel] ep 46 it 170 total=0.9858 ce_r=0.0352 ce_f=4.7527
[loss-randlabel] ep 46 it 220 total=0.9594 ce_r=0.0144 ce_f=4.7250
[loss-randlabel] ep 46 it 270 total=0.9596 ce_r=0.0256 ce_f=4.6701
[loss-randlabel] ep 46 it 320 total=0.9575 ce_r=0.0192 ce_f=4.6918
[loss-randlabel] ep 46 it 370 total=0.9924 ce_r=0.0346 ce_f=4.7891
[loss-randlabel] ep 46 it 420 total=0.9784 ce_r=0.0126 ce_f=4.8289
[loss-randlabel] ep 47 it 40 total=0.9633 ce_r=0.0291 ce_f=4.6710
[loss-randlabel] ep 47 it 90 total=0.9460 ce_r=0.0067 ce_f=4.6965
[loss-randlabel] ep 47 it 140 total=0.9558 ce_r=0.0412 ce_f=4.5729
[loss-randlabel] ep 47 it 190 total=0.9844 ce_r=0.0439 ce_f=4.7024
[loss-randlabel] ep 47 it 240 total=0.9907 ce_r=0.0265 ce_f=4.8206
[loss-randlabel] ep 47 it 290 total=0.9786 ce_r=0.0471 ce_f=4.6577
[loss-randlabel] ep 47 it 340 total=0.9372 ce_r=0.0131 ce_f=4.6205
[loss-randlabel] ep 47 it 390 total=1.0005 ce_r=0.0455 ce_f=4.7748
[loss-randlabel] ep 48 it 10 total=0.9610 ce_r=0.0224 ce_f=4.6928
[loss-randlabel] ep 48 it 60 total=1.0237 ce_r=0.0668 ce_f=4.7846
[loss-randlabel] ep 48 it 110 total=1.0066 ce_r=0.0482 ce_f=4.7919
[loss-randlabel] ep 48 it 160 total=0.9716 ce_r=0.0241 ce_f=4.7378
[loss-randlabel] ep 48 it 210 total=0.9816 ce_r=0.0277 ce_f=4.7698
[loss-randlabel] ep 48 it 260 total=0.9805 ce_r=0.0130 ce_f=4.8375
[loss-randlabel] ep 48 it 310 total=0.9619 ce_r=0.0114 ce_f=4.7522
[loss-randlabel] ep 48 it 360 total=0.9623 ce_r=0.0104 ce_f=4.7594
[loss-randlabel] ep 48 it 410 total=1.0227 ce_r=0.0147 ce_f=5.0399
[loss-randlabel] ep 49 it 30 total=0.9852 ce_r=0.0102 ce_f=4.8750
[loss-randlabel] ep 49 it 80 total=0.9174 ce_r=0.0093 ce_f=4.5406
[loss-randlabel] ep 49 it 130 total=0.9709 ce_r=0.0207 ce_f=4.7507
[loss-randlabel] ep 49 it 180 total=0.9557 ce_r=0.0069 ce_f=4.7440
[loss-randlabel] ep 49 it 230 total=0.9447 ce_r=0.0088 ce_f=4.6793
[loss-randlabel] ep 49 it 280 total=0.9664 ce_r=0.0074 ce_f=4.7947
[loss-randlabel] ep 49 it 330 total=0.9979 ce_r=0.0263 ce_f=4.8582
[loss-randlabel] ep 49 it 380 total=0.9721 ce_r=0.0082 ce_f=4.8197
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2.pt
resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc1-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<02:48,  2.54it/s]  2%|▏         | 10/430 [00:00<00:16, 25.18it/s]  5%|▍         | 20/430 [00:00<00:09, 45.11it/s]  7%|▋         | 30/430 [00:00<00:06, 59.44it/s]  9%|▉         | 40/430 [00:00<00:05, 70.76it/s] 12%|█▏        | 51/430 [00:00<00:04, 79.88it/s] 14%|█▍        | 62/430 [00:01<00:04, 86.09it/s] 17%|█▋        | 73/430 [00:01<00:03, 90.37it/s] 20%|█▉        | 84/430 [00:01<00:03, 93.64it/s] 22%|██▏       | 95/430 [00:01<00:03, 95.73it/s] 25%|██▍       | 106/430 [00:01<00:03, 97.14it/s] 27%|██▋       | 117/430 [00:01<00:03, 98.38it/s] 30%|██▉       | 128/430 [00:01<00:03, 98.93it/s] 32%|███▏      | 138/430 [00:01<00:02, 98.97it/s] 35%|███▍      | 149/430 [00:01<00:02, 98.87it/s] 37%|███▋      | 159/430 [00:02<00:02, 98.55it/s] 40%|███▉      | 170/430 [00:02<00:02, 99.20it/s] 42%|████▏     | 180/430 [00:02<00:02, 98.33it/s] 44%|████▍     | 190/430 [00:02<00:02, 92.07it/s] 47%|████▋     | 201/430 [00:02<00:02, 94.66it/s] 49%|████▉     | 212/430 [00:02<00:02, 96.51it/s] 52%|█████▏    | 223/430 [00:02<00:02, 97.99it/s] 54%|█████▍    | 234/430 [00:02<00:01, 98.93it/s] 57%|█████▋    | 245/430 [00:02<00:01, 99.61it/s] 60%|█████▉    | 256/430 [00:02<00:01, 100.10it/s] 62%|██████▏   | 267/430 [00:03<00:01, 99.80it/s]  65%|██████▍   | 278/430 [00:03<00:01, 100.15it/s] 67%|██████▋   | 289/430 [00:03<00:01, 100.45it/s] 70%|██████▉   | 300/430 [00:03<00:01, 100.54it/s] 72%|███████▏  | 311/430 [00:03<00:01, 100.42it/s] 75%|███████▍  | 322/430 [00:03<00:01, 100.61it/s] 77%|███████▋  | 333/430 [00:03<00:00, 100.78it/s] 80%|████████  | 344/430 [00:03<00:00, 100.82it/s] 83%|████████▎ | 355/430 [00:03<00:00, 100.84it/s] 85%|████████▌ | 366/430 [00:04<00:00, 100.91it/s] 88%|████████▊ | 377/430 [00:04<00:00, 100.70it/s] 90%|█████████ | 388/430 [00:04<00:00, 99.49it/s]  93%|█████████▎| 398/430 [00:04<00:00, 93.94it/s] 95%|█████████▌| 409/430 [00:04<00:00, 96.43it/s] 98%|█████████▊| 420/430 [00:04<00:00, 98.18it/s]100%|██████████| 430/430 [00:04<00:00, 97.36it/s]100%|██████████| 430/430 [00:04<00:00, 90.55it/s]
55000 images processed, 4.842273235321045 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:34,  2.50it/s] 12%|█▏        | 10/86 [00:00<00:02, 25.45it/s] 23%|██▎       | 20/86 [00:00<00:01, 45.38it/s] 35%|███▍      | 30/86 [00:00<00:00, 59.54it/s] 47%|████▋     | 40/86 [00:00<00:00, 69.95it/s] 58%|█████▊    | 50/86 [00:00<00:00, 77.79it/s] 70%|██████▉   | 60/86 [00:01<00:00, 83.28it/s] 81%|████████▏ | 70/86 [00:01<00:00, 87.75it/s] 93%|█████████▎| 80/86 [00:01<00:00, 90.91it/s]100%|██████████| 86/86 [00:01<00:00, 66.76it/s]
11000 images processed, 1.313464879989624 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc1-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:33,  2.17it/s]  5%|▌         | 11/204 [00:00<00:07, 24.81it/s] 10%|█         | 21/204 [00:00<00:04, 43.02it/s] 15%|█▌        | 31/204 [00:00<00:03, 57.62it/s] 20%|██        | 41/204 [00:00<00:02, 68.74it/s] 25%|██▌       | 52/204 [00:00<00:01, 78.08it/s] 30%|███       | 62/204 [00:01<00:01, 84.18it/s] 35%|███▌      | 72/204 [00:01<00:01, 88.65it/s] 40%|████      | 82/204 [00:01<00:01, 91.59it/s] 45%|████▌     | 92/204 [00:01<00:01, 93.30it/s] 50%|█████     | 103/204 [00:01<00:01, 95.35it/s] 55%|█████▌    | 113/204 [00:01<00:00, 96.20it/s] 60%|██████    | 123/204 [00:01<00:00, 97.24it/s] 66%|██████▌   | 134/204 [00:01<00:00, 98.17it/s] 71%|███████   | 145/204 [00:01<00:00, 98.84it/s] 76%|███████▋  | 156/204 [00:02<00:00, 99.32it/s] 82%|████████▏ | 167/204 [00:02<00:00, 99.61it/s] 87%|████████▋ | 178/204 [00:02<00:00, 99.93it/s] 93%|█████████▎| 189/204 [00:02<00:00, 100.44it/s] 98%|█████████▊| 200/204 [00:02<00:00, 100.77it/s]100%|██████████| 204/204 [00:02<00:00, 81.30it/s] 
26032 images processed, 2.5467689037323 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.68it/s] 11%|█▏        | 9/79 [00:00<00:04, 16.71it/s] 23%|██▎       | 18/79 [00:00<00:01, 31.82it/s] 32%|███▏      | 25/79 [00:00<00:01, 40.20it/s] 44%|████▍     | 35/79 [00:01<00:00, 54.40it/s] 57%|█████▋    | 45/79 [00:01<00:00, 65.54it/s] 70%|██████▉   | 55/79 [00:01<00:00, 74.50it/s] 84%|████████▎ | 66/79 [00:01<00:00, 82.36it/s] 97%|█████████▋| 77/79 [00:01<00:00, 87.98it/s]100%|██████████| 79/79 [00:01<00:00, 53.88it/s]
10000 images processed, 1.4995412826538086 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.94it/s] 14%|█▍        | 11/79 [00:00<00:02, 22.96it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.92it/s] 39%|███▉      | 31/79 [00:00<00:00, 55.67it/s] 52%|█████▏    | 41/79 [00:00<00:00, 67.27it/s] 65%|██████▍   | 51/79 [00:01<00:00, 76.12it/s] 78%|███████▊  | 62/79 [00:01<00:00, 83.69it/s] 92%|█████████▏| 73/79 [00:01<00:00, 89.03it/s]100%|██████████| 79/79 [00:01<00:00, 61.15it/s]
10000 images processed, 1.3110637664794922 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  2.00it/s] 10%|█         | 7/70 [00:00<00:04, 14.72it/s] 23%|██▎       | 16/70 [00:00<00:01, 32.12it/s] 37%|███▋      | 26/70 [00:00<00:00, 48.95it/s] 51%|█████▏    | 36/70 [00:00<00:00, 62.33it/s] 67%|██████▋   | 47/70 [00:01<00:00, 73.58it/s] 83%|████████▎ | 58/70 [00:01<00:00, 81.76it/s] 99%|█████████▊| 69/70 [00:01<00:00, 87.66it/s]100%|██████████| 70/70 [00:01<00:00, 55.93it/s]
8925 images processed, 1.281336784362793 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.06it/s]  4%|▍         | 2/45 [00:01<00:19,  2.22it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.51it/s] 38%|███▊      | 17/45 [00:01<00:01, 17.69it/s] 51%|█████     | 23/45 [00:01<00:00, 22.27it/s] 73%|███████▎  | 33/45 [00:02<00:00, 22.97it/s] 82%|████████▏ | 37/45 [00:02<00:00, 23.71it/s]100%|██████████| 45/45 [00:02<00:00, 20.02it/s]
5640 images processed, 2.2693192958831787 seconds used

16.642778635025024
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.41  98.70  96.57
places365     75.57  77.14  77.51
LSUN          18.31  96.13  96.31
iSUN          74.27  81.60  85.33
dtd           57.13  85.97  92.07
AVG           46.14  87.91  89.56
Retain-Acc: 0.7307
Forget-as-OOD (retain known vs forget novel):
  FPR: 46.60 AUROC: 88.32 AUIN: 99.26
8.491274118423462
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2.pt
resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc2-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:27,  2.07it/s]  3%|▎         | 11/430 [00:00<00:17, 24.16it/s]  5%|▍         | 21/430 [00:00<00:09, 42.29it/s]  7%|▋         | 31/430 [00:00<00:07, 56.67it/s] 10%|▉         | 41/430 [00:00<00:05, 67.06it/s] 12%|█▏        | 51/430 [00:01<00:05, 75.62it/s] 14%|█▍        | 61/430 [00:01<00:04, 81.88it/s] 17%|█▋        | 71/430 [00:01<00:04, 86.87it/s] 19%|█▉        | 81/430 [00:01<00:03, 89.00it/s] 21%|██        | 91/430 [00:01<00:03, 88.57it/s] 23%|██▎       | 101/430 [00:01<00:03, 90.84it/s] 26%|██▌       | 112/430 [00:01<00:03, 93.90it/s] 29%|██▊       | 123/430 [00:01<00:03, 96.12it/s] 31%|███       | 134/430 [00:01<00:03, 97.43it/s] 33%|███▎      | 144/430 [00:01<00:02, 98.13it/s] 36%|███▌      | 155/430 [00:02<00:02, 98.89it/s] 39%|███▊      | 166/430 [00:02<00:02, 99.37it/s] 41%|████      | 177/430 [00:02<00:02, 99.77it/s] 44%|████▎     | 188/430 [00:02<00:02, 96.42it/s] 46%|████▌     | 198/430 [00:02<00:02, 94.03it/s] 49%|████▊     | 209/430 [00:02<00:02, 96.01it/s] 51%|█████     | 220/430 [00:02<00:02, 97.60it/s] 54%|█████▎    | 231/430 [00:02<00:02, 98.55it/s] 56%|█████▋    | 242/430 [00:02<00:01, 99.33it/s] 59%|█████▉    | 253/430 [00:03<00:01, 99.82it/s] 61%|██████▏   | 264/430 [00:03<00:01, 100.20it/s] 64%|██████▍   | 275/430 [00:03<00:01, 100.59it/s] 67%|██████▋   | 286/430 [00:03<00:01, 100.70it/s] 69%|██████▉   | 297/430 [00:03<00:01, 100.73it/s] 72%|███████▏  | 308/430 [00:03<00:01, 100.93it/s] 74%|███████▍  | 319/430 [00:03<00:01, 100.74it/s] 77%|███████▋  | 330/430 [00:03<00:00, 100.71it/s] 79%|███████▉  | 341/430 [00:03<00:00, 100.91it/s] 82%|████████▏ | 352/430 [00:04<00:00, 100.82it/s] 84%|████████▍ | 363/430 [00:04<00:00, 100.76it/s] 87%|████████▋ | 374/430 [00:04<00:00, 100.77it/s] 90%|████████▉ | 385/430 [00:04<00:00, 100.91it/s] 92%|█████████▏| 396/430 [00:04<00:00, 100.61it/s] 95%|█████████▍| 407/430 [00:04<00:00, 100.61it/s] 97%|█████████▋| 418/430 [00:04<00:00, 101.23it/s]100%|█████████▉| 429/430 [00:04<00:00, 101.64it/s]100%|██████████| 430/430 [00:04<00:00, 89.13it/s] 
55000 images processed, 4.918683052062988 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:34,  2.44it/s] 13%|█▎        | 11/86 [00:00<00:02, 27.44it/s] 24%|██▍       | 21/86 [00:00<00:01, 46.55it/s] 36%|███▌      | 31/86 [00:00<00:00, 59.57it/s] 48%|████▊     | 41/86 [00:00<00:00, 70.25it/s] 59%|█████▉    | 51/86 [00:00<00:00, 77.99it/s] 71%|███████   | 61/86 [00:01<00:00, 83.43it/s] 83%|████████▎ | 71/86 [00:01<00:00, 87.74it/s] 94%|█████████▍| 81/86 [00:01<00:00, 90.99it/s]100%|██████████| 86/86 [00:01<00:00, 66.63it/s]
11000 images processed, 1.3176639080047607 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc2-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:39,  2.04it/s]  5%|▌         | 11/204 [00:00<00:08, 23.95it/s] 10%|█         | 21/204 [00:00<00:04, 42.31it/s] 15%|█▌        | 31/204 [00:00<00:03, 57.05it/s] 20%|██        | 41/204 [00:00<00:02, 66.80it/s] 25%|██▌       | 51/204 [00:01<00:02, 75.68it/s] 30%|███       | 62/204 [00:01<00:01, 82.99it/s] 35%|███▌      | 72/204 [00:01<00:01, 87.44it/s] 40%|████      | 82/204 [00:01<00:01, 90.70it/s] 45%|████▌     | 92/204 [00:01<00:01, 92.70it/s] 50%|█████     | 102/204 [00:01<00:01, 94.43it/s] 55%|█████▍    | 112/204 [00:01<00:00, 92.27it/s] 60%|█████▉    | 122/204 [00:01<00:00, 94.34it/s] 65%|██████▍   | 132/204 [00:01<00:00, 95.93it/s] 70%|██████▉   | 142/204 [00:01<00:00, 97.07it/s] 75%|███████▍  | 152/204 [00:02<00:00, 97.80it/s] 79%|███████▉  | 162/204 [00:02<00:00, 98.35it/s] 85%|████████▍ | 173/204 [00:02<00:00, 98.93it/s] 90%|█████████ | 184/204 [00:02<00:00, 99.70it/s] 96%|█████████▌| 195/204 [00:02<00:00, 100.28it/s]100%|██████████| 204/204 [00:02<00:00, 79.87it/s] 
26032 images processed, 2.5945489406585693 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:57,  1.36it/s]  9%|▉         | 7/79 [00:00<00:06, 10.82it/s] 20%|██        | 16/79 [00:00<00:02, 25.22it/s] 29%|██▉       | 23/79 [00:01<00:01, 34.40it/s] 42%|████▏     | 33/79 [00:01<00:00, 48.67it/s] 54%|█████▍    | 43/79 [00:01<00:00, 60.38it/s] 67%|██████▋   | 53/79 [00:01<00:00, 70.05it/s] 81%|████████  | 64/79 [00:01<00:00, 78.77it/s] 95%|█████████▍| 75/79 [00:01<00:00, 85.00it/s]100%|██████████| 79/79 [00:01<00:00, 47.05it/s]
10000 images processed, 1.7130179405212402 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.01it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.45it/s] 27%|██▋       | 21/79 [00:00<00:01, 41.27it/s] 38%|███▊      | 30/79 [00:00<00:00, 53.14it/s] 51%|█████     | 40/79 [00:00<00:00, 64.92it/s] 63%|██████▎   | 50/79 [00:01<00:00, 72.82it/s] 77%|███████▋  | 61/79 [00:01<00:00, 81.27it/s] 91%|█████████ | 72/79 [00:01<00:00, 87.20it/s]100%|██████████| 79/79 [00:01<00:00, 60.62it/s]
10000 images processed, 1.3281705379486084 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  2.03it/s] 14%|█▍        | 10/70 [00:00<00:02, 21.43it/s] 29%|██▊       | 20/70 [00:00<00:01, 39.53it/s] 43%|████▎     | 30/70 [00:00<00:00, 54.00it/s] 57%|█████▋    | 40/70 [00:00<00:00, 65.31it/s] 73%|███████▎  | 51/70 [00:01<00:00, 75.67it/s] 87%|████████▋ | 61/70 [00:01<00:00, 77.43it/s]100%|██████████| 70/70 [00:01<00:00, 56.25it/s]
8925 images processed, 1.2758760452270508 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:44,  1.01s/it] 13%|█▎        | 6/45 [00:01<00:05,  7.05it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.68it/s] 47%|████▋     | 21/45 [00:01<00:01, 18.28it/s] 69%|██████▉   | 31/45 [00:01<00:00, 30.71it/s] 82%|████████▏ | 37/45 [00:02<00:00, 23.52it/s]100%|██████████| 45/45 [00:02<00:00, 23.94it/s]100%|██████████| 45/45 [00:02<00:00, 18.40it/s]
5640 images processed, 2.482741594314575 seconds used

17.19618821144104
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.67  98.84  96.91
places365     73.45  78.19  78.41
LSUN          13.35  97.24  97.41
iSUN          69.85  83.02  86.42
dtd           55.16  86.44  92.28
AVG           43.30  88.75  90.29
Retain-Acc: 0.7270
Forget-as-OOD (retain known vs forget novel):
  FPR: 36.60 AUROC: 91.70 AUIN: 99.54
8.129269361495972
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc2-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc2-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2.pt
resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-seen-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:51,  1.86it/s]  3%|▎         | 11/430 [00:00<00:18, 22.25it/s]  5%|▍         | 21/430 [00:00<00:10, 39.93it/s]  7%|▋         | 31/430 [00:00<00:07, 54.45it/s] 10%|▉         | 42/430 [00:00<00:05, 67.37it/s] 12%|█▏        | 53/430 [00:01<00:04, 77.01it/s] 15%|█▍        | 64/430 [00:01<00:04, 84.00it/s] 17%|█▋        | 75/430 [00:01<00:03, 89.15it/s] 20%|██        | 86/430 [00:01<00:03, 92.66it/s] 23%|██▎       | 97/430 [00:01<00:03, 95.18it/s] 25%|██▌       | 108/430 [00:01<00:03, 96.99it/s] 28%|██▊       | 119/430 [00:01<00:03, 98.20it/s] 30%|███       | 130/430 [00:01<00:03, 99.03it/s] 33%|███▎      | 141/430 [00:01<00:02, 99.31it/s] 35%|███▌      | 152/430 [00:02<00:02, 99.61it/s] 38%|███▊      | 163/430 [00:02<00:02, 99.86it/s] 40%|████      | 174/430 [00:02<00:02, 100.09it/s] 43%|████▎     | 185/430 [00:02<00:02, 99.71it/s]  45%|████▌     | 195/430 [00:02<00:02, 99.66it/s] 48%|████▊     | 206/430 [00:02<00:02, 99.83it/s] 50%|█████     | 217/430 [00:02<00:02, 99.98it/s] 53%|█████▎    | 228/430 [00:02<00:02, 100.21it/s] 56%|█████▌    | 239/430 [00:02<00:01, 100.36it/s] 58%|█████▊    | 250/430 [00:03<00:01, 100.67it/s] 61%|██████    | 261/430 [00:03<00:01, 100.71it/s] 63%|██████▎   | 272/430 [00:03<00:01, 100.77it/s] 66%|██████▌   | 283/430 [00:03<00:01, 100.95it/s] 68%|██████▊   | 294/430 [00:03<00:01, 100.95it/s] 71%|███████   | 305/430 [00:03<00:01, 101.01it/s] 73%|███████▎  | 316/430 [00:03<00:01, 100.94it/s] 76%|███████▌  | 327/430 [00:03<00:01, 100.94it/s] 79%|███████▊  | 338/430 [00:03<00:00, 95.06it/s]  81%|████████  | 348/430 [00:04<00:00, 95.21it/s] 83%|████████▎ | 358/430 [00:04<00:00, 96.47it/s] 86%|████████▌ | 369/430 [00:04<00:00, 97.62it/s] 88%|████████▊ | 380/430 [00:04<00:00, 98.52it/s] 91%|█████████ | 390/430 [00:04<00:00, 98.88it/s] 93%|█████████▎| 400/430 [00:04<00:00, 99.10it/s] 96%|█████████▌| 411/430 [00:04<00:00, 99.94it/s] 98%|█████████▊| 422/430 [00:04<00:00, 100.71it/s]100%|██████████| 430/430 [00:04<00:00, 88.87it/s] 
55000 images processed, 4.967566967010498 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:42,  2.02it/s] 10%|█         | 9/86 [00:00<00:04, 19.11it/s] 21%|██        | 18/86 [00:00<00:01, 35.94it/s] 33%|███▎      | 28/86 [00:00<00:01, 51.09it/s] 44%|████▍     | 38/86 [00:00<00:00, 63.07it/s] 56%|█████▌    | 48/86 [00:01<00:00, 71.68it/s] 67%|██████▋   | 58/86 [00:01<00:00, 78.10it/s] 79%|███████▉  | 68/86 [00:01<00:00, 83.53it/s] 91%|█████████ | 78/86 [00:01<00:00, 87.84it/s]100%|██████████| 86/86 [00:01<00:00, 60.58it/s]
11000 images processed, 1.4460554122924805 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-seen-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:26,  2.35it/s]  5%|▌         | 11/204 [00:00<00:07, 26.52it/s] 10%|█         | 21/204 [00:00<00:04, 45.60it/s] 15%|█▌        | 31/204 [00:00<00:02, 59.73it/s] 20%|██        | 41/204 [00:00<00:02, 69.52it/s] 25%|██▍       | 50/204 [00:00<00:02, 71.75it/s] 29%|██▉       | 60/204 [00:01<00:01, 79.45it/s] 34%|███▍      | 70/204 [00:01<00:01, 85.06it/s] 39%|███▉      | 80/204 [00:01<00:01, 89.31it/s] 44%|████▍     | 90/204 [00:01<00:01, 90.97it/s] 49%|████▉     | 100/204 [00:01<00:01, 93.42it/s] 54%|█████▍    | 110/204 [00:01<00:00, 94.88it/s] 59%|█████▉    | 120/204 [00:01<00:00, 95.76it/s] 64%|██████▎   | 130/204 [00:01<00:00, 96.68it/s] 69%|██████▊   | 140/204 [00:01<00:00, 96.81it/s] 74%|███████▎  | 150/204 [00:01<00:00, 97.63it/s] 78%|███████▊  | 160/204 [00:02<00:00, 98.25it/s] 83%|████████▎ | 170/204 [00:02<00:00, 98.42it/s] 88%|████████▊ | 180/204 [00:02<00:00, 98.80it/s] 94%|█████████▎| 191/204 [00:02<00:00, 99.68it/s] 99%|█████████▉| 202/204 [00:02<00:00, 100.23it/s]100%|██████████| 204/204 [00:02<00:00, 81.08it/s] 
26032 images processed, 2.5536484718322754 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.74it/s] 13%|█▎        | 10/79 [00:00<00:03, 19.31it/s] 24%|██▍       | 19/79 [00:00<00:01, 34.57it/s] 35%|███▌      | 28/79 [00:00<00:01, 47.32it/s] 48%|████▊     | 38/79 [00:00<00:00, 59.79it/s] 61%|██████    | 48/79 [00:01<00:00, 70.09it/s] 75%|███████▍  | 59/79 [00:01<00:00, 78.69it/s] 89%|████████▊ | 70/79 [00:01<00:00, 85.25it/s]100%|██████████| 79/79 [00:01<00:00, 40.22it/s]
10000 images processed, 2.025721549987793 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.13it/s] 11%|█▏        | 9/79 [00:00<00:03, 19.97it/s] 24%|██▍       | 19/79 [00:00<00:01, 39.37it/s] 37%|███▋      | 29/79 [00:00<00:00, 54.66it/s] 49%|████▉     | 39/79 [00:00<00:00, 66.34it/s] 62%|██████▏   | 49/79 [00:00<00:00, 74.95it/s] 75%|███████▍  | 59/79 [00:01<00:00, 81.75it/s] 89%|████████▊ | 70/79 [00:01<00:00, 87.77it/s]100%|██████████| 79/79 [00:01<00:00, 61.71it/s]
10000 images processed, 1.3006064891815186 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:38,  1.79it/s] 16%|█▌        | 11/70 [00:00<00:02, 21.57it/s] 30%|███       | 21/70 [00:00<00:01, 39.04it/s] 44%|████▍     | 31/70 [00:00<00:00, 53.74it/s] 59%|█████▊    | 41/70 [00:00<00:00, 65.60it/s] 74%|███████▍  | 52/70 [00:01<00:00, 75.78it/s] 90%|█████████ | 63/70 [00:01<00:00, 83.24it/s]100%|██████████| 70/70 [00:01<00:00, 55.88it/s]
8925 images processed, 1.284134864807129 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:40,  1.08it/s]  4%|▍         | 2/45 [00:01<00:19,  2.24it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.62it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.32it/s] 51%|█████     | 23/45 [00:01<00:01, 21.62it/s] 73%|███████▎  | 33/45 [00:02<00:00, 23.05it/s] 93%|█████████▎| 42/45 [00:02<00:00, 32.22it/s]100%|██████████| 45/45 [00:02<00:00, 20.96it/s]
5640 images processed, 2.1808743476867676 seconds used

17.48170280456543
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.73  98.82  96.72
places365     73.29  78.02  77.40
LSUN          13.23  97.22  97.27
iSUN          70.49  82.68  85.63
dtd           55.30  86.32  91.88
AVG           43.41  88.61  89.78
Retain-Acc: 0.7314
Forget-as-OOD (retain known vs forget novel):
  FPR: 41.20 AUROC: 90.00 AUIN: 98.76
8.425387859344482
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-seen-forget_rf.png
[done] continual incremental run finished. Adapters at: checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack
