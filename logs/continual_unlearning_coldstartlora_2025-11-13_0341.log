nohup: ignoring input
runner-incremental-continual-forget.sh: line 76: [false: command not found
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:168: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [00:18<15:03, 18.43s/it]  4%|▍         | 2/50 [00:31<12:05, 15.11s/it]  6%|▌         | 3/50 [00:42<10:19, 13.18s/it]  8%|▊         | 4/50 [00:52<09:16, 12.09s/it] 10%|█         | 5/50 [01:05<09:13, 12.29s/it] 12%|█▏        | 6/50 [01:14<08:20, 11.37s/it][loss] ep 0 it 0 total=8.2699 mle=1.6072 pcon=5.2432 forget=1.4196 orth=0.0000 favg=0.0000 nr=107 nf=6 protos=630 fproto_sim=NA
[loss] ep 0 it 50 total=8.1639 mle=1.5562 pcon=5.2372 forget=1.3705 orth=0.0000 favg=0.0000 nr=104 nf=5 protos=630 fproto_sim=NA
[loss] ep 0 it 100 total=8.1255 mle=1.5304 pcon=5.2314 forget=1.3637 orth=0.0000 favg=0.0000 nr=98 nf=5 protos=630 fproto_sim=NA
[loss] ep 0 it 150 total=8.0972 mle=1.5298 pcon=5.2261 forget=1.3414 orth=0.0000 favg=0.0000 nr=102 nf=4 protos=630 fproto_sim=NA
[loss] ep 0 it 200 total=7.9863 mle=1.3709 pcon=5.2203 forget=1.3950 orth=0.0000 favg=0.0000 nr=107 nf=10 protos=630 fproto_sim=NA
[loss] ep 0 it 250 total=8.2024 mle=1.5960 pcon=5.2153 forget=1.3912 orth=0.0000 favg=0.0000 nr=100 nf=4 protos=630 fproto_sim=NA
[loss] ep 0 it 300 total=7.9254 mle=1.3189 pcon=5.2104 forget=1.3961 orth=0.0000 favg=0.0000 nr=106 nf=8 protos=630 fproto_sim=NA
[loss] ep 0 it 350 total=8.1036 mle=1.5100 pcon=5.2056 forget=1.3880 orth=0.0000 favg=0.0000 nr=101 nf=11 protos=630 fproto_sim=NA
[loss] ep 0 it 400 total=8.1123 mle=1.5029 pcon=5.2012 forget=1.4082 orth=0.0000 favg=0.0000 nr=101 nf=11 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 1 it 20 total=8.0435 mle=1.4898 pcon=5.1969 forget=1.3568 orth=0.0000 favg=0.0000 nr=110 nf=9 protos=630 fproto_sim=NA
[loss] ep 1 it 70 total=8.0440 mle=1.5085 pcon=5.1924 forget=1.3431 orth=0.0000 favg=0.0000 nr=94 nf=7 protos=630 fproto_sim=NA
[loss] ep 1 it 120 total=7.9818 mle=1.4116 pcon=5.1878 forget=1.3823 orth=0.0000 favg=0.0000 nr=107 nf=4 protos=630 fproto_sim=NA
[loss] ep 1 it 170 total=7.9816 mle=1.4513 pcon=5.1836 forget=1.3468 orth=0.0000 favg=0.0000 nr=101 nf=8 protos=630 fproto_sim=NA
[loss] ep 1 it 220 total=8.0047 mle=1.4915 pcon=5.1795 forget=1.3337 orth=0.0000 favg=0.0000 nr=110 nf=1 protos=630 fproto_sim=NA
[loss] ep 1 it 270 total=8.2843 mle=1.5538 pcon=5.1757 forget=1.5548 orth=0.0000 favg=0.0000 nr=105 nf=2 protos=630 fproto_sim=NA
[loss] ep 1 it 320 total=8.2556 mle=1.7124 pcon=5.1716 forget=1.3716 orth=0.0000 favg=0.0000 nr=104 nf=6 protos=630 fproto_sim=NA
[loss] ep 1 it 370 total=8.0869 mle=1.5018 pcon=5.1682 forget=1.4168 orth=0.0000 favg=0.0000 nr=104 nf=7 protos=630 fproto_sim=NA
[loss] ep 1 it 420 total=8.0763 mle=1.4903 pcon=5.1647 forget=1.4213 orth=0.0000 favg=0.0000 nr=103 nf=7 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 2 it 40 total=8.0901 mle=1.5706 pcon=5.1613 forget=1.3581 orth=0.0000 favg=0.0000 nr=108 nf=7 protos=630 fproto_sim=NA
[loss] ep 2 it 90 total=7.9917 mle=1.4493 pcon=5.1579 forget=1.3846 orth=0.0000 favg=0.0000 nr=97 nf=5 protos=630 fproto_sim=NA
[loss] ep 2 it 140 total=8.1273 mle=1.6130 pcon=5.1546 forget=1.3597 orth=0.0000 favg=0.0000 nr=103 nf=4 protos=630 fproto_sim=NA
[loss] ep 2 it 190 total=7.8452 mle=1.3491 pcon=5.1515 forget=1.3446 orth=0.0000 favg=0.0000 nr=113 nf=7 protos=630 fproto_sim=NA
[loss] ep 2 it 240 total=7.9543 mle=1.4155 pcon=5.1484 forget=1.3904 orth=0.0000 favg=0.0000 nr=107 nf=6 protos=630 fproto_sim=NA
[loss] ep 2 it 290 total=7.9855 mle=1.4950 pcon=5.1455 forget=1.3450 orth=0.0000 favg=0.0000 nr=112 nf=3 protos=630 fproto_sim=NA
[loss] ep 2 it 340 total=8.0669 mle=1.5416 pcon=5.1424 forget=1.3829 orth=0.0000 favg=0.0000 nr=100 nf=11 protos=630 fproto_sim=NA
[loss] ep 2 it 390 total=8.1349 mle=1.5527 pcon=5.1401 forget=1.4421 orth=0.0000 favg=0.0000 nr=97 nf=9 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 3 it 10 total=7.9703 mle=1.4699 pcon=5.1373 forget=1.3631 orth=0.0000 favg=0.0000 nr=107 nf=5 protos=630 fproto_sim=NA
[loss] ep 3 it 60 total=8.0796 mle=1.5435 pcon=5.1346 forget=1.4015 orth=0.0000 favg=0.0000 nr=104 nf=6 protos=630 fproto_sim=NA
[loss] ep 3 it 110 total=8.1646 mle=1.6740 pcon=5.1325 forget=1.3581 orth=0.0000 favg=0.0000 nr=107 nf=4 protos=630 fproto_sim=NA
[loss] ep 3 it 160 total=8.0213 mle=1.5352 pcon=5.1296 forget=1.3566 orth=0.0000 favg=0.0000 nr=101 nf=4 protos=630 fproto_sim=NA
[loss] ep 3 it 210 total=8.2029 mle=1.6892 pcon=5.1272 forget=1.3865 orth=0.0000 favg=0.0000 nr=104 nf=11 protos=630 fproto_sim=NA
[loss] ep 3 it 260 total=8.1877 mle=1.6734 pcon=5.1248 forget=1.3894 orth=0.0000 favg=0.0000 nr=108 nf=9 protos=630 fproto_sim=NA
[loss] ep 3 it 310 total=8.0324 mle=1.5590 pcon=5.1225 forget=1.3510 orth=0.0000 favg=0.0000 nr=113 nf=4 protos=630 fproto_sim=NA
[loss] ep 3 it 360 total=7.8921 mle=1.3987 pcon=5.1201 forget=1.3733 orth=0.0000 favg=0.0000 nr=105 nf=5 protos=630 fproto_sim=NA
[loss] ep 3 it 410 total=7.8571 mle=1.3866 pcon=5.1180 forget=1.3525 orth=0.0000 favg=0.0000 nr=102 nf=6 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 4 it 30 total=7.9000 mle=1.4388 pcon=5.1158 forget=1.3455 orth=0.0000 favg=0.0000 nr=108 nf=4 protos=630 fproto_sim=NA
[loss] ep 4 it 80 total=8.0171 mle=1.5454 pcon=5.1135 forget=1.3582 orth=0.0000 favg=0.0000 nr=106 nf=8 protos=630 fproto_sim=NA
[loss] ep 4 it 130 total=8.0401 mle=1.5184 pcon=5.1117 forget=1.4101 orth=0.0000 favg=0.0000 nr=99 nf=7 protos=630 fproto_sim=NA
[loss] ep 4 it 180 total=8.0621 mle=1.5994 pcon=5.1099 forget=1.3528 orth=0.0000 favg=0.0000 nr=106 nf=6 protos=630 fproto_sim=NA
[loss] ep 4 it 230 total=8.0916 mle=1.6353 pcon=5.1080 forget=1.3483 orth=0.0000 favg=0.0000 nr=107 nf=3 protos=630 fproto_sim=NA
[loss] ep 4 it 280 total=7.9924 mle=1.5118 pcon=5.1060 forget=1.3746 orth=0.0000 favg=0.0000 nr=106 nf=10 protos=630 fproto_sim=NA
[loss] ep 4 it 330 total=8.1409 mle=1.6269 pcon=5.1042 forget=1.4098 orth=0.0000 favg=0.0000 nr=103 nf=8 protos=630 fproto_sim=NA
[loss] ep 4 it 380 total=7.9752 mle=1.5028 pcon=5.1026 forget=1.3699 orth=0.0000 favg=0.0000 nr=100 nf=12 protos=630 fproto_sim=NA
[loss] ep 5 it 0 total=7.9092 mle=1.4648 pcon=5.1010 forget=1.3434 orth=0.0000 favg=0.0000 nr=106 nf=5 protos=630 fproto_sim=NA
[loss] ep 5 it 50 total=8.1436 mle=1.6900 pcon=5.0995 forget=1.3541 orth=0.0000 favg=0.0000 nr=105 nf=4 protos=630 fproto_sim=NA
[loss] ep 5 it 100 total=8.0698 mle=1.5936 pcon=5.0982 forget=1.3780 orth=0.0000 favg=0.0000 nr=105 nf=5 protos=630 fproto_sim=NA
[loss] ep 5 it 150 total=8.0274 mle=1.5639 pcon=5.0967 forget=1.3669 orth=0.0000 favg=0.0000 nr=103 nf=6 protos=630 fproto_sim=NA
[loss] ep 5 it 200 total=7.8568 mle=1.3729 pcon=5.0953 forget=1.3886 orth=0.0000 favg=0.0000 nr=107 nf=4 protos=630 fproto_sim=NA
[loss] ep 5 it 250 total=8.0767 mle=1.5937 pcon=5.0937 forget=1.3893 orth=0.0000 favg=0.0000 nr=102 nf=7 protos=630 fproto_sim=NA
[loss] ep 5 it 300 total=8.0317 mle=1.5649 pcon=5.0920 forget=1.3748 orth=0.0000 favg=0.0000 nr=99 nf=10 protos=630 fproto_sim=NA
[loss] ep 5 it 350 total=7.8779 mle=1.4204 pcon=5.0907 forget=1.3667 orth=0.0000 favg=0.0000 nr=115 nf=3 protos=630 fproto_sim=NA
[loss] ep 5 it 400 total=7.9279 mle=1.4420 pcon=5.0893 forget=1.3966 orth=0.0000 favg=0.0000 nr=101 nf=6 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 6 it 20 total=8.0758 mle=1.5745 pcon=5.0880 forget=1.4133 orth=0.0000 favg=0.0000 nr=109 nf=5 protos=630 fproto_sim=NA
[loss] ep 6 it 70 total=7.8972 mle=1.4700 pcon=5.0867 forget=1.3405 orth=0.0000 favg=0.0000 nr=104 nf=7 protos=630 fproto_sim=NA
 14%|█▍        | 7/50 [01:26<08:10, 11.41s/it] 16%|█▌        | 8/50 [01:36<07:48, 11.15s/it] 18%|█▊        | 9/50 [01:47<07:37, 11.15s/it] 20%|██        | 10/50 [01:58<07:17, 10.95s/it] 22%|██▏       | 11/50 [02:08<06:50, 10.52s/it] 24%|██▍       | 12/50 [02:18<06:41, 10.58s/it][loss] ep 6 it 120 total=8.0841 mle=1.5877 pcon=5.0853 forget=1.4111 orth=0.0000 favg=0.0000 nr=107 nf=4 protos=630 fproto_sim=NA
[loss] ep 6 it 170 total=7.8400 mle=1.3583 pcon=5.0843 forget=1.3973 orth=0.0000 favg=0.0000 nr=107 nf=5 protos=630 fproto_sim=NA
[loss] ep 6 it 220 total=7.9649 mle=1.5164 pcon=5.0831 forget=1.3655 orth=0.0000 favg=0.0000 nr=100 nf=8 protos=630 fproto_sim=NA
[loss] ep 6 it 270 total=7.9056 mle=1.4779 pcon=5.0822 forget=1.3455 orth=0.0000 favg=0.0000 nr=98 nf=8 protos=630 fproto_sim=NA
[loss] ep 6 it 320 total=8.0095 mle=1.5431 pcon=5.0810 forget=1.3855 orth=0.0000 favg=0.0000 nr=112 nf=2 protos=630 fproto_sim=NA
[loss] ep 6 it 370 total=7.9780 mle=1.5538 pcon=5.0797 forget=1.3445 orth=0.0000 favg=0.0000 nr=109 nf=9 protos=630 fproto_sim=NA
[loss] ep 6 it 420 total=7.9503 mle=1.5167 pcon=5.0789 forget=1.3547 orth=0.0000 favg=0.0000 nr=104 nf=2 protos=630 fproto_sim=NA
[loss] ep 7 it 40 total=7.9834 mle=1.5554 pcon=5.0780 forget=1.3500 orth=0.0000 favg=0.0000 nr=104 nf=4 protos=630 fproto_sim=NA
[loss] ep 7 it 90 total=7.9052 mle=1.4653 pcon=5.0770 forget=1.3628 orth=0.0000 favg=0.0000 nr=106 nf=5 protos=630 fproto_sim=NA
[loss] ep 7 it 140 total=8.1304 mle=1.5551 pcon=5.0759 forget=1.4993 orth=0.0000 favg=0.0000 nr=108 nf=8 protos=630 fproto_sim=NA
[loss] ep 7 it 190 total=7.9718 mle=1.4923 pcon=5.0750 forget=1.4045 orth=0.0000 favg=0.0000 nr=107 nf=8 protos=630 fproto_sim=NA
[loss] ep 7 it 240 total=7.8887 mle=1.4512 pcon=5.0742 forget=1.3632 orth=0.0000 favg=0.0000 nr=105 nf=8 protos=630 fproto_sim=NA
[loss] ep 7 it 290 total=7.9544 mle=1.4803 pcon=5.0732 forget=1.4009 orth=0.0000 favg=0.0000 nr=108 nf=5 protos=630 fproto_sim=NA
[loss] ep 7 it 340 total=7.9808 mle=1.5653 pcon=5.0719 forget=1.3436 orth=0.0000 favg=0.0000 nr=104 nf=6 protos=630 fproto_sim=NA
[loss] ep 7 it 390 total=7.8431 mle=1.4396 pcon=5.0711 forget=1.3324 orth=0.0000 favg=0.0000 nr=103 nf=3 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 8 it 10 total=8.1042 mle=1.7048 pcon=5.0702 forget=1.3292 orth=0.0000 favg=0.0000 nr=108 nf=3 protos=630 fproto_sim=NA
[loss] ep 8 it 60 total=7.8704 mle=1.4736 pcon=5.0692 forget=1.3276 orth=0.0000 favg=0.0000 nr=106 nf=4 protos=630 fproto_sim=NA
[loss] ep 8 it 110 total=7.9680 mle=1.5593 pcon=5.0681 forget=1.3405 orth=0.0000 favg=0.0000 nr=99 nf=4 protos=630 fproto_sim=NA
[loss] ep 8 it 160 total=7.9150 mle=1.5224 pcon=5.0671 forget=1.3255 orth=0.0000 favg=0.0000 nr=110 nf=6 protos=630 fproto_sim=NA
[loss] ep 8 it 210 total=7.8025 mle=1.4044 pcon=5.0660 forget=1.3321 orth=0.0000 favg=0.0000 nr=102 nf=8 protos=630 fproto_sim=NA
[loss] ep 8 it 260 total=7.8832 mle=1.4531 pcon=5.0648 forget=1.3653 orth=0.0000 favg=0.0000 nr=101 nf=6 protos=630 fproto_sim=NA
[loss] ep 8 it 310 total=7.9817 mle=1.5742 pcon=5.0639 forget=1.3436 orth=0.0000 favg=0.0000 nr=99 nf=3 protos=630 fproto_sim=NA
[loss] ep 8 it 360 total=7.9559 mle=1.4608 pcon=5.0631 forget=1.4320 orth=0.0000 favg=0.0000 nr=100 nf=8 protos=630 fproto_sim=NA
[loss] ep 8 it 410 total=7.9215 mle=1.5096 pcon=5.0622 forget=1.3497 orth=0.0000 favg=0.0000 nr=108 nf=8 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 9 it 30 total=7.9004 mle=1.5119 pcon=5.0610 forget=1.3275 orth=0.0000 favg=0.0000 nr=99 nf=6 protos=630 fproto_sim=NA
[loss] ep 9 it 80 total=7.8766 mle=1.4802 pcon=5.0603 forget=1.3361 orth=0.0000 favg=0.0000 nr=112 nf=3 protos=630 fproto_sim=NA
[loss] ep 9 it 130 total=8.1144 mle=1.6976 pcon=5.0594 forget=1.3575 orth=0.0000 favg=0.0000 nr=103 nf=5 protos=630 fproto_sim=NA
[loss] ep 9 it 180 total=7.9558 mle=1.4975 pcon=5.0587 forget=1.3996 orth=0.0000 favg=0.0000 nr=111 nf=6 protos=630 fproto_sim=NA
[loss] ep 9 it 230 total=7.8934 mle=1.4937 pcon=5.0577 forget=1.3421 orth=0.0000 favg=0.0000 nr=101 nf=5 protos=630 fproto_sim=NA
[loss] ep 9 it 280 total=7.7604 mle=1.3708 pcon=5.0567 forget=1.3330 orth=0.0000 favg=0.0000 nr=102 nf=8 protos=630 fproto_sim=NA
[loss] ep 9 it 330 total=8.0264 mle=1.6034 pcon=5.0558 forget=1.3672 orth=0.0000 favg=0.0000 nr=106 nf=9 protos=630 fproto_sim=NA
[loss] ep 9 it 380 total=8.0532 mle=1.6387 pcon=5.0549 forget=1.3596 orth=0.0000 favg=0.0000 nr=104 nf=6 protos=630 fproto_sim=NA
[loss] ep 10 it 0 total=8.0445 mle=1.6287 pcon=5.0540 forget=1.3618 orth=0.0000 favg=0.0000 nr=114 nf=3 protos=630 fproto_sim=NA
[loss] ep 10 it 50 total=7.7584 mle=1.3567 pcon=5.0531 forget=1.3486 orth=0.0000 favg=0.0000 nr=101 nf=4 protos=630 fproto_sim=NA
[loss] ep 10 it 100 total=7.9518 mle=1.5569 pcon=5.0520 forget=1.3429 orth=0.0000 favg=0.0000 nr=97 nf=3 protos=630 fproto_sim=NA
[loss] ep 10 it 150 total=8.0159 mle=1.6262 pcon=5.0510 forget=1.3388 orth=0.0000 favg=0.0000 nr=110 nf=3 protos=630 fproto_sim=NA
[loss] ep 10 it 200 total=8.1474 mle=1.6907 pcon=5.0502 forget=1.4065 orth=0.0000 favg=0.0000 nr=105 nf=7 protos=630 fproto_sim=NA
[loss] ep 10 it 250 total=7.9293 mle=1.5288 pcon=5.0494 forget=1.3510 orth=0.0000 favg=0.0000 nr=103 nf=8 protos=630 fproto_sim=NA
[loss] ep 10 it 300 total=8.1083 mle=1.6783 pcon=5.0481 forget=1.3819 orth=0.0000 favg=0.0000 nr=108 nf=8 protos=630 fproto_sim=NA
[loss] ep 10 it 350 total=7.9501 mle=1.5413 pcon=5.0471 forget=1.3616 orth=0.0000 favg=0.0000 nr=107 nf=6 protos=630 fproto_sim=NA
[loss] ep 10 it 400 total=7.9789 mle=1.5616 pcon=5.0463 forget=1.3711 orth=0.0000 favg=0.0000 nr=116 nf=3 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 11 it 20 total=7.9360 mle=1.5582 pcon=5.0457 forget=1.3321 orth=0.0000 favg=0.0000 nr=106 nf=2 protos=630 fproto_sim=NA
[loss] ep 11 it 70 total=7.9398 mle=1.5431 pcon=5.0447 forget=1.3520 orth=0.0000 favg=0.0000 nr=106 nf=7 protos=630 fproto_sim=NA
[loss] ep 11 it 120 total=8.0650 mle=1.6335 pcon=5.0439 forget=1.3876 orth=0.0000 favg=0.0000 nr=102 nf=10 protos=630 fproto_sim=NA
[loss] ep 11 it 170 total=8.1524 mle=1.7286 pcon=5.0431 forget=1.3806 orth=0.0000 favg=0.0000 nr=99 nf=13 protos=630 fproto_sim=NA
[loss] ep 11 it 220 total=8.0488 mle=1.6467 pcon=5.0423 forget=1.3598 orth=0.0000 favg=0.0000 nr=99 nf=9 protos=630 fproto_sim=NA
[loss] ep 11 it 270 total=7.8483 mle=1.4598 pcon=5.0415 forget=1.3470 orth=0.0000 favg=0.0000 nr=109 nf=7 protos=630 fproto_sim=NA
[loss] ep 11 it 320 total=7.8033 mle=1.4020 pcon=5.0408 forget=1.3606 orth=0.0000 favg=0.0000 nr=104 nf=6 protos=630 fproto_sim=NA
[loss] ep 11 it 370 total=7.8892 mle=1.5121 pcon=5.0398 forget=1.3372 orth=0.0000 favg=0.0000 nr=106 nf=3 protos=630 fproto_sim=NA
[loss] ep 11 it 420 total=7.9205 mle=1.4835 pcon=5.0392 forget=1.3979 orth=0.0000 favg=0.0000 nr=106 nf=8 protos=630 fproto_sim=NA
[loss] ep 12 it 40 total=8.0501 mle=1.6367 pcon=5.0385 forget=1.3749 orth=0.0000 favg=0.0000 nr=98 nf=6 protos=630 fproto_sim=NA
[loss] ep 12 it 90 total=7.8889 mle=1.4952 pcon=5.0373 forget=1.3564 orth=0.0000 favg=0.0000 nr=109 nf=5 protos=630 fproto_sim=NA
[loss] ep 12 it 140 total=7.9258 mle=1.4788 pcon=5.0367 forget=1.4103 orth=0.0000 favg=0.0000 nr=103 nf=6 protos=630 fproto_sim=NA
[loss] ep 12 it 190 total=8.0061 mle=1.5345 pcon=5.0358 forget=1.4357 orth=0.0000 favg=0.0000 nr=109 nf=4 protos=630 fproto_sim=NA
[loss] ep 12 it 240 total=7.8762 mle=1.4607 pcon=5.0351 forget=1.3804 orth=0.0000 favg=0.0000 nr=98 nf=7 protos=630 fproto_sim=NA
[loss] ep 12 it 290 total=7.9248 mle=1.5224 pcon=5.0348 forget=1.3676 orth=0.0000 favg=0.0000 nr=105 nf=4 protos=630 fproto_sim=NA
[loss] ep 12 it 340 total=7.9399 mle=1.5574 pcon=5.0346 forget=1.3479 orth=0.0000 favg=0.0000 nr=109 nf=4 protos=630 fproto_sim=NA
 26%|██▌       | 13/50 [02:28<06:25, 10.41s/it] 28%|██▊       | 14/50 [02:38<06:07, 10.21s/it] 30%|███       | 15/50 [02:48<05:55, 10.14s/it] 32%|███▏      | 16/50 [02:59<05:51, 10.34s/it] 34%|███▍      | 17/50 [03:09<05:42, 10.37s/it] 36%|███▌      | 18/50 [03:20<05:38, 10.59s/it] 38%|███▊      | 19/50 [03:31<05:31, 10.69s/it][loss] ep 12 it 390 total=7.9350 mle=1.5325 pcon=5.0342 forget=1.3682 orth=0.0000 favg=0.0000 nr=107 nf=7 protos=630 fproto_sim=NA
[loss] ep 13 it 10 total=7.9152 mle=1.5143 pcon=5.0336 forget=1.3673 orth=0.0000 favg=0.0000 nr=108 nf=7 protos=630 fproto_sim=NA
[loss] ep 13 it 60 total=7.9407 mle=1.5495 pcon=5.0328 forget=1.3584 orth=0.0000 favg=0.0000 nr=103 nf=5 protos=630 fproto_sim=NA
[loss] ep 13 it 110 total=8.0162 mle=1.5998 pcon=5.0320 forget=1.3845 orth=0.0000 favg=0.0000 nr=106 nf=7 protos=630 fproto_sim=NA
[loss] ep 13 it 160 total=8.0103 mle=1.6060 pcon=5.0314 forget=1.3730 orth=0.0000 favg=0.0000 nr=104 nf=3 protos=630 fproto_sim=NA
[loss] ep 13 it 210 total=7.9150 mle=1.5008 pcon=5.0309 forget=1.3833 orth=0.0000 favg=0.0000 nr=109 nf=6 protos=630 fproto_sim=NA
[loss] ep 13 it 260 total=7.8374 mle=1.4475 pcon=5.0303 forget=1.3596 orth=0.0000 favg=0.0000 nr=106 nf=4 protos=630 fproto_sim=NA
[loss] ep 13 it 310 total=8.0106 mle=1.5674 pcon=5.0299 forget=1.4132 orth=0.0000 favg=0.0000 nr=97 nf=10 protos=630 fproto_sim=NA
[loss] ep 13 it 360 total=7.8844 mle=1.4909 pcon=5.0292 forget=1.3644 orth=0.0000 favg=0.0000 nr=106 nf=4 protos=630 fproto_sim=NA
[loss] ep 13 it 410 total=8.0926 mle=1.6246 pcon=5.0285 forget=1.4395 orth=0.0000 favg=0.0000 nr=111 nf=3 protos=630 fproto_sim=NA
[loss] ep 14 it 30 total=8.0142 mle=1.5999 pcon=5.0280 forget=1.3863 orth=0.0000 favg=0.0000 nr=104 nf=5 protos=630 fproto_sim=NA
[loss] ep 14 it 80 total=8.0374 mle=1.6426 pcon=5.0273 forget=1.3675 orth=0.0000 favg=0.0000 nr=101 nf=9 protos=630 fproto_sim=NA
[loss] ep 14 it 130 total=7.9242 mle=1.5266 pcon=5.0269 forget=1.3707 orth=0.0000 favg=0.0000 nr=110 nf=5 protos=630 fproto_sim=NA
[loss] ep 14 it 180 total=7.8347 mle=1.4274 pcon=5.0260 forget=1.3813 orth=0.0000 favg=0.0000 nr=99 nf=5 protos=630 fproto_sim=NA
[loss] ep 14 it 230 total=7.9411 mle=1.5160 pcon=5.0256 forget=1.3995 orth=0.0000 favg=0.0000 nr=108 nf=10 protos=630 fproto_sim=NA
[loss] ep 14 it 280 total=7.9967 mle=1.5200 pcon=5.0247 forget=1.4520 orth=0.0000 favg=0.0000 nr=106 nf=5 protos=630 fproto_sim=NA
[loss] ep 14 it 330 total=7.9488 mle=1.5269 pcon=5.0240 forget=1.3980 orth=0.0000 favg=0.0000 nr=110 nf=3 protos=630 fproto_sim=NA
[loss] ep 14 it 380 total=7.9505 mle=1.5224 pcon=5.0234 forget=1.4046 orth=0.0000 favg=0.0000 nr=105 nf=8 protos=630 fproto_sim=NA
[loss] ep 15 it 0 total=8.1449 mle=1.6098 pcon=5.0226 forget=1.5125 orth=0.0000 favg=0.0000 nr=103 nf=2 protos=630 fproto_sim=NA
[loss] ep 15 it 50 total=8.0034 mle=1.5991 pcon=5.0222 forget=1.3821 orth=0.0000 favg=0.0000 nr=93 nf=9 protos=630 fproto_sim=NA
[loss] ep 15 it 100 total=7.9301 mle=1.4874 pcon=5.0215 forget=1.4212 orth=0.0000 favg=0.0000 nr=104 nf=6 protos=630 fproto_sim=NA
[loss] ep 15 it 150 total=7.8904 mle=1.4840 pcon=5.0207 forget=1.3857 orth=0.0000 favg=0.0000 nr=106 nf=6 protos=630 fproto_sim=NA
[loss] ep 15 it 200 total=8.0600 mle=1.6570 pcon=5.0201 forget=1.3829 orth=0.0000 favg=0.0000 nr=107 nf=7 protos=630 fproto_sim=NA
[loss] ep 15 it 250 total=7.8870 mle=1.4310 pcon=5.0195 forget=1.4366 orth=0.0000 favg=0.0000 nr=103 nf=7 protos=630 fproto_sim=NA
[loss] ep 15 it 300 total=7.9509 mle=1.5463 pcon=5.0188 forget=1.3858 orth=0.0000 favg=0.0000 nr=106 nf=7 protos=630 fproto_sim=NA
[loss] ep 15 it 350 total=7.8782 mle=1.4744 pcon=5.0183 forget=1.3855 orth=0.0000 favg=0.0000 nr=97 nf=5 protos=630 fproto_sim=NA
[loss] ep 15 it 400 total=7.9864 mle=1.5913 pcon=5.0177 forget=1.3775 orth=0.0000 favg=0.0000 nr=100 nf=6 protos=630 fproto_sim=NA
[loss] ep 16 it 20 total=8.0892 mle=1.7120 pcon=5.0174 forget=1.3598 orth=0.0000 favg=0.0000 nr=108 nf=2 protos=630 fproto_sim=NA
[loss] ep 16 it 70 total=7.9560 mle=1.5167 pcon=5.0171 forget=1.4222 orth=0.0000 favg=0.0000 nr=112 nf=5 protos=630 fproto_sim=NA
[loss] ep 16 it 120 total=7.8716 mle=1.4678 pcon=5.0166 forget=1.3872 orth=0.0000 favg=0.0000 nr=111 nf=4 protos=630 fproto_sim=NA
[loss] ep 16 it 170 total=8.0466 mle=1.6592 pcon=5.0161 forget=1.3713 orth=0.0000 favg=0.0000 nr=110 nf=5 protos=630 fproto_sim=NA
[loss] ep 16 it 220 total=8.0864 mle=1.6845 pcon=5.0151 forget=1.3868 orth=0.0000 favg=0.0000 nr=95 nf=7 protos=630 fproto_sim=NA
[loss] ep 16 it 270 total=7.8349 mle=1.4163 pcon=5.0145 forget=1.4041 orth=0.0000 favg=0.0000 nr=106 nf=5 protos=630 fproto_sim=NA
[loss] ep 16 it 320 total=7.8653 mle=1.5015 pcon=5.0137 forget=1.3501 orth=0.0000 favg=0.0000 nr=102 nf=5 protos=630 fproto_sim=NA
[loss] ep 16 it 370 total=8.0077 mle=1.5953 pcon=5.0130 forget=1.3995 orth=0.0000 favg=0.0000 nr=109 nf=2 protos=630 fproto_sim=NA
[loss] ep 16 it 420 total=7.9126 mle=1.5460 pcon=5.0126 forget=1.3540 orth=0.0000 favg=0.0000 nr=106 nf=2 protos=630 fproto_sim=NA
[loss] ep 17 it 40 total=8.0585 mle=1.6576 pcon=5.0122 forget=1.3888 orth=0.0000 favg=0.0000 nr=102 nf=5 protos=630 fproto_sim=NA
[loss] ep 17 it 90 total=8.1011 mle=1.6985 pcon=5.0118 forget=1.3908 orth=0.0000 favg=0.0000 nr=111 nf=6 protos=630 fproto_sim=NA
[loss] ep 17 it 140 total=7.9135 mle=1.5458 pcon=5.0109 forget=1.3569 orth=0.0000 favg=0.0000 nr=103 nf=4 protos=630 fproto_sim=NA
[loss] ep 17 it 190 total=8.0159 mle=1.6326 pcon=5.0100 forget=1.3733 orth=0.0000 favg=0.0000 nr=98 nf=8 protos=630 fproto_sim=NA
[loss] ep 17 it 240 total=7.9046 mle=1.5192 pcon=5.0092 forget=1.3762 orth=0.0000 favg=0.0000 nr=107 nf=3 protos=630 fproto_sim=NA
[loss] ep 17 it 290 total=7.9321 mle=1.5336 pcon=5.0087 forget=1.3898 orth=0.0000 favg=0.0000 nr=103 nf=10 protos=630 fproto_sim=NA
[loss] ep 17 it 340 total=7.8915 mle=1.5164 pcon=5.0080 forget=1.3670 orth=0.0000 favg=0.0000 nr=102 nf=8 protos=630 fproto_sim=NA
[loss] ep 17 it 390 total=7.9266 mle=1.4744 pcon=5.0075 forget=1.4447 orth=0.0000 favg=0.0000 nr=96 nf=8 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 18 it 10 total=7.8461 mle=1.4708 pcon=5.0071 forget=1.3682 orth=0.0000 favg=0.0000 nr=106 nf=9 protos=630 fproto_sim=NA
[loss] ep 18 it 60 total=7.8933 mle=1.5313 pcon=5.0066 forget=1.3555 orth=0.0000 favg=0.0000 nr=106 nf=9 protos=630 fproto_sim=NA
[loss] ep 18 it 110 total=7.9937 mle=1.5572 pcon=5.0059 forget=1.4306 orth=0.0000 favg=0.0000 nr=109 nf=5 protos=630 fproto_sim=NA
[loss] ep 18 it 160 total=7.9126 mle=1.5464 pcon=5.0051 forget=1.3611 orth=0.0000 favg=0.0000 nr=110 nf=4 protos=630 fproto_sim=NA
[loss] ep 18 it 210 total=7.9215 mle=1.5321 pcon=5.0047 forget=1.3848 orth=0.0000 favg=0.0000 nr=109 nf=4 protos=630 fproto_sim=NA
[loss] ep 18 it 260 total=8.0600 mle=1.7092 pcon=5.0041 forget=1.3468 orth=0.0000 favg=0.0000 nr=103 nf=6 protos=630 fproto_sim=NA
[loss] ep 18 it 310 total=7.8082 mle=1.4698 pcon=5.0033 forget=1.3351 orth=0.0000 favg=0.0000 nr=107 nf=7 protos=630 fproto_sim=NA
[loss] ep 18 it 360 total=7.8772 mle=1.5214 pcon=5.0025 forget=1.3533 orth=0.0000 favg=0.0000 nr=108 nf=2 protos=630 fproto_sim=NA
[loss] ep 18 it 410 total=7.9358 mle=1.5765 pcon=5.0017 forget=1.3576 orth=0.0000 favg=0.0000 nr=97 nf=6 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 19 it 30 total=8.0378 mle=1.6049 pcon=5.0011 forget=1.4318 orth=0.0000 favg=0.0000 nr=102 nf=4 protos=630 fproto_sim=NA
[loss] ep 19 it 80 total=8.1039 mle=1.7129 pcon=5.0006 forget=1.3904 orth=0.0000 favg=0.0000 nr=106 nf=4 protos=630 fproto_sim=NA
[loss] ep 19 it 130 total=7.9328 mle=1.5570 pcon=4.9997 forget=1.3760 orth=0.0000 favg=0.0000 nr=101 nf=5 protos=630 fproto_sim=NA
[loss] ep 19 it 180 total=7.9542 mle=1.5475 pcon=4.9991 forget=1.4077 orth=0.0000 favg=0.0000 nr=110 nf=3 protos=630 fproto_sim=NA
[loss] ep 19 it 230 total=7.9149 mle=1.5348 pcon=4.9985 forget=1.3816 orth=0.0000 favg=0.0000 nr=108 nf=6 protos=630 fproto_sim=NA
[loss] ep 19 it 280 total=7.8614 mle=1.5037 pcon=4.9981 forget=1.3595 orth=0.0000 favg=0.0000 nr=105 nf=5 protos=630 fproto_sim=NA
 40%|████      | 20/50 [03:41<05:15, 10.53s/it] 42%|████▏     | 21/50 [03:52<05:08, 10.63s/it] 44%|████▍     | 22/50 [04:03<05:00, 10.73s/it] 46%|████▌     | 23/50 [04:14<04:46, 10.62s/it] 48%|████▊     | 24/50 [04:25<04:42, 10.87s/it] 50%|█████     | 25/50 [04:36<04:31, 10.85s/it][loss] ep 19 it 330 total=8.0287 mle=1.6405 pcon=4.9971 forget=1.3910 orth=0.0000 favg=0.0000 nr=99 nf=6 protos=630 fproto_sim=NA
[loss] ep 19 it 380 total=7.8777 mle=1.4896 pcon=4.9963 forget=1.3918 orth=0.0000 favg=0.0000 nr=101 nf=8 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 20 it 0 total=7.7521 mle=1.3682 pcon=4.9956 forget=1.3883 orth=0.0000 favg=0.0000 nr=106 nf=9 protos=630 fproto_sim=NA
[loss] ep 20 it 50 total=8.0310 mle=1.6596 pcon=4.9949 forget=1.3765 orth=0.0000 favg=0.0000 nr=97 nf=10 protos=630 fproto_sim=NA
[loss] ep 20 it 100 total=7.9600 mle=1.5702 pcon=4.9941 forget=1.3957 orth=0.0000 favg=0.0000 nr=100 nf=10 protos=630 fproto_sim=NA
[loss] ep 20 it 150 total=7.8361 mle=1.4660 pcon=4.9935 forget=1.3766 orth=0.0000 favg=0.0000 nr=99 nf=9 protos=630 fproto_sim=NA
[loss] ep 20 it 200 total=7.8854 mle=1.5195 pcon=4.9926 forget=1.3733 orth=0.0000 favg=0.0000 nr=101 nf=9 protos=630 fproto_sim=NA
[loss] ep 20 it 250 total=8.0285 mle=1.7176 pcon=4.9919 forget=1.3190 orth=0.0000 favg=0.0000 nr=106 nf=6 protos=630 fproto_sim=NA
[loss] ep 20 it 300 total=7.8359 mle=1.4790 pcon=4.9909 forget=1.3659 orth=0.0000 favg=0.0000 nr=105 nf=9 protos=630 fproto_sim=NA
[loss] ep 20 it 350 total=7.9069 mle=1.5422 pcon=4.9899 forget=1.3748 orth=0.0000 favg=0.0000 nr=109 nf=5 protos=630 fproto_sim=NA
[loss] ep 20 it 400 total=7.9438 mle=1.6257 pcon=4.9890 forget=1.3290 orth=0.0000 favg=0.0000 nr=104 nf=10 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 21 it 20 total=7.9315 mle=1.5352 pcon=4.9881 forget=1.4082 orth=0.0000 favg=0.0000 nr=111 nf=3 protos=630 fproto_sim=NA
[loss] ep 21 it 70 total=7.9041 mle=1.5105 pcon=4.9870 forget=1.4066 orth=0.0000 favg=0.0000 nr=100 nf=10 protos=630 fproto_sim=NA
[loss] ep 21 it 120 total=7.9008 mle=1.5620 pcon=4.9861 forget=1.3527 orth=0.0000 favg=0.0000 nr=100 nf=7 protos=630 fproto_sim=NA
[loss] ep 21 it 170 total=8.0269 mle=1.5917 pcon=4.9852 forget=1.4500 orth=0.0000 favg=0.0000 nr=100 nf=7 protos=630 fproto_sim=NA
[loss] ep 21 it 220 total=7.8478 mle=1.5539 pcon=4.9841 forget=1.3098 orth=0.0000 favg=0.0000 nr=106 nf=3 protos=630 fproto_sim=NA
[loss] ep 21 it 270 total=7.9809 mle=1.5791 pcon=4.9832 forget=1.4185 orth=0.0000 favg=0.0000 nr=102 nf=7 protos=630 fproto_sim=NA
[loss] ep 21 it 320 total=7.8901 mle=1.5181 pcon=4.9823 forget=1.3897 orth=0.0000 favg=0.0000 nr=102 nf=7 protos=630 fproto_sim=NA
[loss] ep 21 it 370 total=8.0027 mle=1.5730 pcon=4.9811 forget=1.4486 orth=0.0000 favg=0.0000 nr=112 nf=4 protos=630 fproto_sim=NA
[loss] ep 21 it 420 total=7.8166 mle=1.5125 pcon=4.9799 forget=1.3242 orth=0.0000 favg=0.0000 nr=103 nf=5 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 22 it 40 total=7.9062 mle=1.5508 pcon=4.9788 forget=1.3767 orth=0.0000 favg=0.0000 nr=92 nf=12 protos=630 fproto_sim=NA
[loss] ep 22 it 90 total=8.1321 mle=1.7517 pcon=4.9775 forget=1.4029 orth=0.0000 favg=0.0000 nr=102 nf=7 protos=630 fproto_sim=NA
[loss] ep 22 it 140 total=7.7803 mle=1.4764 pcon=4.9762 forget=1.3277 orth=0.0000 favg=0.0000 nr=104 nf=7 protos=630 fproto_sim=NA
[loss] ep 22 it 190 total=7.9364 mle=1.5444 pcon=4.9751 forget=1.4169 orth=0.0000 favg=0.0000 nr=105 nf=4 protos=630 fproto_sim=NA
[loss] ep 22 it 240 total=8.0197 mle=1.5397 pcon=4.9736 forget=1.5063 orth=0.0000 favg=0.0000 nr=102 nf=5 protos=630 fproto_sim=NA
[loss] ep 22 it 290 total=7.7727 mle=1.4973 pcon=4.9722 forget=1.3032 orth=0.0000 favg=0.0000 nr=108 nf=2 protos=630 fproto_sim=NA
[loss] ep 22 it 340 total=7.8179 mle=1.5347 pcon=4.9711 forget=1.3121 orth=0.0000 favg=0.0000 nr=108 nf=3 protos=630 fproto_sim=NA
[loss] ep 22 it 390 total=7.9151 mle=1.5912 pcon=4.9698 forget=1.3541 orth=0.0000 favg=0.0000 nr=108 nf=6 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 23 it 10 total=7.7732 mle=1.4453 pcon=4.9681 forget=1.3598 orth=0.0000 favg=0.0000 nr=112 nf=6 protos=630 fproto_sim=NA
[loss] ep 23 it 60 total=7.6737 mle=1.4184 pcon=4.9667 forget=1.2886 orth=0.0000 favg=0.0000 nr=108 nf=4 protos=630 fproto_sim=NA
[loss] ep 23 it 110 total=7.9143 mle=1.6513 pcon=4.9650 forget=1.2980 orth=0.0000 favg=0.0000 nr=98 nf=11 protos=630 fproto_sim=NA
[loss] ep 23 it 160 total=7.8161 mle=1.4355 pcon=4.9634 forget=1.4172 orth=0.0000 favg=0.0000 nr=109 nf=5 protos=630 fproto_sim=NA
[loss] ep 23 it 210 total=7.7937 mle=1.5386 pcon=4.9620 forget=1.2931 orth=0.0000 favg=0.0000 nr=111 nf=3 protos=630 fproto_sim=NA
[loss] ep 23 it 260 total=7.7840 mle=1.5328 pcon=4.9608 forget=1.2904 orth=0.0000 favg=0.0000 nr=111 nf=5 protos=630 fproto_sim=NA
[loss] ep 23 it 310 total=8.0399 mle=1.6978 pcon=4.9593 forget=1.3828 orth=0.0000 favg=0.0000 nr=101 nf=8 protos=630 fproto_sim=NA
[loss] ep 23 it 360 total=7.9964 mle=1.6532 pcon=4.9578 forget=1.3854 orth=0.0000 favg=0.0000 nr=102 nf=6 protos=630 fproto_sim=NA
[loss] ep 23 it 410 total=7.8425 mle=1.4838 pcon=4.9560 forget=1.4027 orth=0.0000 favg=0.0000 nr=98 nf=7 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 24 it 30 total=7.8122 mle=1.5140 pcon=4.9544 forget=1.3438 orth=0.0000 favg=0.0000 nr=106 nf=6 protos=630 fproto_sim=NA
[loss] ep 24 it 80 total=7.8281 mle=1.6021 pcon=4.9525 forget=1.2735 orth=0.0000 favg=0.0000 nr=108 nf=4 protos=630 fproto_sim=NA
[loss] ep 24 it 130 total=7.9828 mle=1.5972 pcon=4.9508 forget=1.4347 orth=0.0000 favg=0.0000 nr=107 nf=3 protos=630 fproto_sim=NA
[loss] ep 24 it 180 total=7.9007 mle=1.6103 pcon=4.9493 forget=1.3412 orth=0.0000 favg=0.0000 nr=105 nf=7 protos=630 fproto_sim=NA
[loss] ep 24 it 230 total=7.7068 mle=1.4744 pcon=4.9477 forget=1.2847 orth=0.0000 favg=0.0000 nr=103 nf=6 protos=630 fproto_sim=NA
[loss] ep 24 it 280 total=7.7017 mle=1.4800 pcon=4.9461 forget=1.2756 orth=0.0000 favg=0.0000 nr=104 nf=4 protos=630 fproto_sim=NA
[loss] ep 24 it 330 total=7.9257 mle=1.6374 pcon=4.9444 forget=1.3439 orth=0.0000 favg=0.0000 nr=107 nf=6 protos=630 fproto_sim=NA
[loss] ep 24 it 380 total=7.8045 mle=1.5151 pcon=4.9432 forget=1.3462 orth=0.0000 favg=0.0000 nr=102 nf=7 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 25 it 0 total=7.7682 mle=1.5551 pcon=4.9416 forget=1.2716 orth=0.0000 favg=0.0000 nr=111 nf=5 protos=630 fproto_sim=NA
[loss] ep 25 it 50 total=7.8778 mle=1.5167 pcon=4.9401 forget=1.4210 orth=0.0000 favg=0.0000 nr=101 nf=6 protos=630 fproto_sim=NA
[loss] ep 25 it 100 total=8.2090 mle=1.6695 pcon=4.9384 forget=1.6011 orth=0.0000 favg=0.0000 nr=112 nf=4 protos=630 fproto_sim=NA
[loss] ep 25 it 150 total=7.7817 mle=1.5134 pcon=4.9365 forget=1.3317 orth=0.0000 favg=0.0000 nr=103 nf=7 protos=630 fproto_sim=NA
[loss] ep 25 it 200 total=8.0109 mle=1.5789 pcon=4.9350 forget=1.4969 orth=0.0000 favg=0.0000 nr=103 nf=2 protos=630 fproto_sim=NA
[loss] ep 25 it 250 total=8.1074 mle=1.6449 pcon=4.9333 forget=1.5292 orth=0.0000 favg=0.0000 nr=108 nf=8 protos=630 fproto_sim=NA
[loss] ep 25 it 300 total=7.9513 mle=1.5568 pcon=4.9316 forget=1.4629 orth=0.0000 favg=0.0000 nr=97 nf=7 protos=630 fproto_sim=NA
 52%|█████▏    | 26/50 [04:47<04:23, 10.99s/it] 54%|█████▍    | 27/50 [04:59<04:15, 11.13s/it] 56%|█████▌    | 28/50 [05:10<04:04, 11.11s/it] 58%|█████▊    | 29/50 [05:20<03:49, 10.92s/it] 60%|██████    | 30/50 [05:30<03:33, 10.69s/it] 62%|██████▏   | 31/50 [05:41<03:23, 10.70s/it] 64%|██████▍   | 32/50 [05:50<03:02, 10.14s/it][loss] ep 25 it 350 total=7.7761 mle=1.5179 pcon=4.9301 forget=1.3281 orth=0.0000 favg=0.0000 nr=109 nf=3 protos=630 fproto_sim=NA
[loss] ep 25 it 400 total=7.8973 mle=1.6805 pcon=4.9284 forget=1.2884 orth=0.0000 favg=0.0000 nr=100 nf=8 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 26 it 20 total=7.9636 mle=1.5940 pcon=4.9268 forget=1.4428 orth=0.0000 favg=0.0000 nr=106 nf=10 protos=630 fproto_sim=NA
[loss] ep 26 it 70 total=8.2687 mle=1.8016 pcon=4.9253 forget=1.5418 orth=0.0000 favg=0.0000 nr=103 nf=5 protos=630 fproto_sim=NA
[loss] ep 26 it 120 total=7.7596 mle=1.4732 pcon=4.9237 forget=1.3627 orth=0.0000 favg=0.0000 nr=102 nf=6 protos=630 fproto_sim=NA
[loss] ep 26 it 170 total=7.9276 mle=1.5401 pcon=4.9221 forget=1.4654 orth=0.0000 favg=0.0000 nr=106 nf=7 protos=630 fproto_sim=NA
[loss] ep 26 it 220 total=7.7911 mle=1.6046 pcon=4.9206 forget=1.2659 orth=0.0000 favg=0.0000 nr=108 nf=4 protos=630 fproto_sim=NA
[loss] ep 26 it 270 total=7.6835 mle=1.5032 pcon=4.9191 forget=1.2613 orth=0.0000 favg=0.0000 nr=107 nf=6 protos=630 fproto_sim=NA
[loss] ep 26 it 320 total=7.8209 mle=1.6339 pcon=4.9175 forget=1.2696 orth=0.0000 favg=0.0000 nr=106 nf=7 protos=630 fproto_sim=NA
[loss] ep 26 it 370 total=7.8729 mle=1.5795 pcon=4.9161 forget=1.3772 orth=0.0000 favg=0.0000 nr=106 nf=5 protos=630 fproto_sim=NA
[loss] ep 26 it 420 total=7.7045 mle=1.4598 pcon=4.9146 forget=1.3301 orth=0.0000 favg=0.0000 nr=108 nf=7 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 27 it 40 total=7.7698 mle=1.5883 pcon=4.9132 forget=1.2683 orth=0.0000 favg=0.0000 nr=111 nf=5 protos=630 fproto_sim=NA
[loss] ep 27 it 90 total=7.8793 mle=1.6394 pcon=4.9118 forget=1.3282 orth=0.0000 favg=0.0000 nr=104 nf=7 protos=630 fproto_sim=NA
[loss] ep 27 it 140 total=7.7296 mle=1.5480 pcon=4.9105 forget=1.2712 orth=0.0000 favg=0.0000 nr=105 nf=2 protos=630 fproto_sim=NA
[loss] ep 27 it 190 total=7.8951 mle=1.5826 pcon=4.9090 forget=1.4035 orth=0.0000 favg=0.0000 nr=97 nf=3 protos=630 fproto_sim=NA
[loss] ep 27 it 240 total=7.8536 mle=1.6827 pcon=4.9074 forget=1.2635 orth=0.0000 favg=0.0000 nr=100 nf=5 protos=630 fproto_sim=NA
[loss] ep 27 it 290 total=7.8142 mle=1.5085 pcon=4.9061 forget=1.3996 orth=0.0000 favg=0.0000 nr=104 nf=6 protos=630 fproto_sim=NA
[loss] ep 27 it 340 total=7.8523 mle=1.6418 pcon=4.9050 forget=1.3056 orth=0.0000 favg=0.0000 nr=102 nf=11 protos=630 fproto_sim=NA
[loss] ep 27 it 390 total=7.7705 mle=1.4892 pcon=4.9037 forget=1.3776 orth=0.0000 favg=0.0000 nr=112 nf=3 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 28 it 10 total=7.8400 mle=1.5333 pcon=4.9026 forget=1.4041 orth=0.0000 favg=0.0000 nr=111 nf=5 protos=630 fproto_sim=NA
[loss] ep 28 it 60 total=7.7139 mle=1.5433 pcon=4.9013 forget=1.2693 orth=0.0000 favg=0.0000 nr=110 nf=3 protos=630 fproto_sim=NA
[loss] ep 28 it 110 total=7.9446 mle=1.6057 pcon=4.9004 forget=1.4385 orth=0.0000 favg=0.0000 nr=98 nf=5 protos=630 fproto_sim=NA
[loss] ep 28 it 160 total=7.7048 mle=1.5339 pcon=4.8995 forget=1.2715 orth=0.0000 favg=0.0000 nr=109 nf=5 protos=630 fproto_sim=NA
[loss] ep 28 it 210 total=7.7808 mle=1.6127 pcon=4.8984 forget=1.2697 orth=0.0000 favg=0.0000 nr=111 nf=3 protos=630 fproto_sim=NA
[loss] ep 28 it 260 total=7.7438 mle=1.4970 pcon=4.8975 forget=1.3493 orth=0.0000 favg=0.0000 nr=100 nf=6 protos=630 fproto_sim=NA
[loss] ep 28 it 310 total=7.6111 mle=1.4202 pcon=4.8967 forget=1.2942 orth=0.0000 favg=0.0000 nr=109 nf=4 protos=630 fproto_sim=NA
[loss] ep 28 it 360 total=7.9109 mle=1.6903 pcon=4.8957 forget=1.3249 orth=0.0000 favg=0.0000 nr=100 nf=6 protos=630 fproto_sim=NA
[loss] ep 28 it 410 total=7.7745 mle=1.5227 pcon=4.8949 forget=1.3569 orth=0.0000 favg=0.0000 nr=109 nf=3 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 29 it 30 total=7.6930 mle=1.5197 pcon=4.8938 forget=1.2794 orth=0.0000 favg=0.0000 nr=116 nf=4 protos=630 fproto_sim=NA
[loss] ep 29 it 80 total=7.8547 mle=1.6278 pcon=4.8928 forget=1.3341 orth=0.0000 favg=0.0000 nr=103 nf=7 protos=630 fproto_sim=NA
[loss] ep 29 it 130 total=7.6698 mle=1.4712 pcon=4.8919 forget=1.3067 orth=0.0000 favg=0.0000 nr=106 nf=3 protos=630 fproto_sim=NA
[loss] ep 29 it 180 total=7.8105 mle=1.5869 pcon=4.8910 forget=1.3327 orth=0.0000 favg=0.0000 nr=106 nf=5 protos=630 fproto_sim=NA
[loss] ep 29 it 230 total=7.8872 mle=1.6846 pcon=4.8900 forget=1.3126 orth=0.0000 favg=0.0000 nr=102 nf=10 protos=630 fproto_sim=NA
[loss] ep 29 it 280 total=7.7980 mle=1.5926 pcon=4.8891 forget=1.3163 orth=0.0000 favg=0.0000 nr=105 nf=9 protos=630 fproto_sim=NA
[loss] ep 29 it 330 total=7.8664 mle=1.5742 pcon=4.8883 forget=1.4038 orth=0.0000 favg=0.0000 nr=110 nf=2 protos=630 fproto_sim=NA
[loss] ep 29 it 380 total=7.7708 mle=1.5301 pcon=4.8875 forget=1.3532 orth=0.0000 favg=0.0000 nr=105 nf=4 protos=630 fproto_sim=NA
[loss] ep 30 it 0 total=7.8587 mle=1.6010 pcon=4.8866 forget=1.3711 orth=0.0000 favg=0.0000 nr=103 nf=7 protos=630 fproto_sim=NA
[loss] ep 30 it 50 total=7.9085 mle=1.6509 pcon=4.8858 forget=1.3717 orth=0.0000 favg=0.0000 nr=97 nf=9 protos=630 fproto_sim=NA
[loss] ep 30 it 100 total=7.9549 mle=1.6757 pcon=4.8852 forget=1.3941 orth=0.0000 favg=0.0000 nr=108 nf=5 protos=630 fproto_sim=NA
[loss] ep 30 it 150 total=7.7047 mle=1.4423 pcon=4.8846 forget=1.3778 orth=0.0000 favg=0.0000 nr=101 nf=9 protos=630 fproto_sim=NA
[loss] ep 30 it 200 total=7.9979 mle=1.7063 pcon=4.8839 forget=1.4077 orth=0.0000 favg=0.0000 nr=106 nf=5 protos=630 fproto_sim=NA
[loss] ep 30 it 250 total=7.8607 mle=1.6640 pcon=4.8835 forget=1.3132 orth=0.0000 favg=0.0000 nr=103 nf=3 protos=630 fproto_sim=NA
[loss] ep 30 it 300 total=7.7676 mle=1.5434 pcon=4.8828 forget=1.3415 orth=0.0000 favg=0.0000 nr=106 nf=7 protos=630 fproto_sim=NA
[loss] ep 30 it 350 total=7.7622 mle=1.5553 pcon=4.8823 forget=1.3247 orth=0.0000 favg=0.0000 nr=104 nf=3 protos=630 fproto_sim=NA
[loss] ep 30 it 400 total=7.8879 mle=1.5692 pcon=4.8817 forget=1.4370 orth=0.0000 favg=0.0000 nr=97 nf=5 protos=630 fproto_sim=NA
[loss] ep 31 it 20 total=7.7625 mle=1.5250 pcon=4.8811 forget=1.3563 orth=0.0000 favg=0.0000 nr=103 nf=7 protos=630 fproto_sim=NA
[loss] ep 31 it 70 total=7.7501 mle=1.5330 pcon=4.8806 forget=1.3366 orth=0.0000 favg=0.0000 nr=102 nf=2 protos=630 fproto_sim=NA
[loss] ep 31 it 120 total=7.8485 mle=1.5647 pcon=4.8803 forget=1.4035 orth=0.0000 favg=0.0000 nr=105 nf=4 protos=630 fproto_sim=NA
[loss] ep 31 it 170 total=7.9422 mle=1.6311 pcon=4.8799 forget=1.4311 orth=0.0000 favg=0.0000 nr=107 nf=2 protos=630 fproto_sim=NA
[loss] ep 31 it 220 total=7.8127 mle=1.5649 pcon=4.8794 forget=1.3685 orth=0.0000 favg=0.0000 nr=105 nf=5 protos=630 fproto_sim=NA
[loss] ep 31 it 270 total=7.9375 mle=1.6846 pcon=4.8791 forget=1.3738 orth=0.0000 favg=0.0000 nr=103 nf=6 protos=630 fproto_sim=NA
[loss] ep 31 it 320 total=7.9483 mle=1.6381 pcon=4.8788 forget=1.4314 orth=0.0000 favg=0.0000 nr=106 nf=6 protos=630 fproto_sim=NA
[loss] ep 31 it 370 total=7.7147 mle=1.4461 pcon=4.8786 forget=1.3901 orth=0.0000 favg=0.0000 nr=103 nf=5 protos=630 fproto_sim=NA
[loss] ep 31 it 420 total=7.9412 mle=1.6828 pcon=4.8783 forget=1.3801 orth=0.0000 favg=0.0000 nr=101 nf=7 protos=630 fproto_sim=NA
[loss] ep 32 it 40 total=7.7900 mle=1.5338 pcon=4.8779 forget=1.3782 orth=0.0000 favg=0.0000 nr=105 nf=6 protos=630 fproto_sim=NA
 66%|██████▌   | 33/50 [06:00<02:51, 10.08s/it] 68%|██████▊   | 34/50 [06:10<02:43, 10.24s/it] 70%|███████   | 35/50 [06:23<02:44, 10.94s/it] 72%|███████▏  | 36/50 [06:34<02:32, 10.87s/it] 74%|███████▍  | 37/50 [06:45<02:21, 10.90s/it] 76%|███████▌  | 38/50 [06:55<02:09, 10.76s/it] 78%|███████▊  | 39/50 [07:06<01:57, 10.65s/it][loss] ep 32 it 90 total=7.8939 mle=1.6481 pcon=4.8777 forget=1.3681 orth=0.0000 favg=0.0000 nr=103 nf=3 protos=630 fproto_sim=NA
[loss] ep 32 it 140 total=7.7626 mle=1.5188 pcon=4.8773 forget=1.3665 orth=0.0000 favg=0.0000 nr=104 nf=5 protos=630 fproto_sim=NA
[loss] ep 32 it 190 total=7.9491 mle=1.6975 pcon=4.8770 forget=1.3746 orth=0.0000 favg=0.0000 nr=100 nf=7 protos=630 fproto_sim=NA
[loss] ep 32 it 240 total=8.0036 mle=1.7007 pcon=4.8767 forget=1.4263 orth=0.0000 favg=0.0000 nr=107 nf=8 protos=630 fproto_sim=NA
[loss] ep 32 it 290 total=7.9642 mle=1.6899 pcon=4.8767 forget=1.3976 orth=0.0000 favg=0.0000 nr=102 nf=7 protos=630 fproto_sim=NA
[loss] ep 32 it 340 total=7.7929 mle=1.5394 pcon=4.8765 forget=1.3770 orth=0.0000 favg=0.0000 nr=106 nf=8 protos=630 fproto_sim=NA
[loss] ep 32 it 390 total=7.8987 mle=1.6221 pcon=4.8765 forget=1.4001 orth=0.0000 favg=0.0000 nr=105 nf=7 protos=630 fproto_sim=NA
[loss] ep 33 it 10 total=7.8660 mle=1.5607 pcon=4.8764 forget=1.4290 orth=0.0000 favg=0.0000 nr=106 nf=8 protos=630 fproto_sim=NA
[loss] ep 33 it 60 total=7.8158 mle=1.5258 pcon=4.8763 forget=1.4137 orth=0.0000 favg=0.0000 nr=105 nf=7 protos=630 fproto_sim=NA
[loss] ep 33 it 110 total=7.9104 mle=1.5866 pcon=4.8764 forget=1.4475 orth=0.0000 favg=0.0000 nr=106 nf=9 protos=630 fproto_sim=NA
[loss] ep 33 it 160 total=7.8203 mle=1.5190 pcon=4.8762 forget=1.4251 orth=0.0000 favg=0.0000 nr=109 nf=6 protos=630 fproto_sim=NA
[loss] ep 33 it 210 total=7.8907 mle=1.6140 pcon=4.8761 forget=1.4007 orth=0.0000 favg=0.0000 nr=103 nf=4 protos=630 fproto_sim=NA
[loss] ep 33 it 260 total=7.9527 mle=1.6498 pcon=4.8762 forget=1.4267 orth=0.0000 favg=0.0000 nr=110 nf=4 protos=630 fproto_sim=NA
[loss] ep 33 it 310 total=7.9486 mle=1.5723 pcon=4.8762 forget=1.5001 orth=0.0000 favg=0.0000 nr=107 nf=1 protos=630 fproto_sim=NA
[loss] ep 33 it 360 total=7.7877 mle=1.4890 pcon=4.8763 forget=1.4224 orth=0.0000 favg=0.0000 nr=97 nf=11 protos=630 fproto_sim=NA
[loss] ep 33 it 410 total=7.9401 mle=1.5968 pcon=4.8764 forget=1.4669 orth=0.0000 favg=0.0000 nr=108 nf=4 protos=630 fproto_sim=NA
[loss] ep 34 it 30 total=7.7994 mle=1.4849 pcon=4.8767 forget=1.4378 orth=0.0000 favg=0.0000 nr=107 nf=7 protos=630 fproto_sim=NA
[loss] ep 34 it 80 total=7.8867 mle=1.5449 pcon=4.8767 forget=1.4651 orth=0.0000 favg=0.0000 nr=95 nf=7 protos=630 fproto_sim=NA
[loss] ep 34 it 130 total=7.8648 mle=1.5525 pcon=4.8769 forget=1.4355 orth=0.0000 favg=0.0000 nr=114 nf=4 protos=630 fproto_sim=NA
[loss] ep 34 it 180 total=7.7733 mle=1.4964 pcon=4.8772 forget=1.3997 orth=0.0000 favg=0.0000 nr=104 nf=5 protos=630 fproto_sim=NA
[loss] ep 34 it 230 total=7.8470 mle=1.5009 pcon=4.8775 forget=1.4687 orth=0.0000 favg=0.0000 nr=105 nf=7 protos=630 fproto_sim=NA
[loss] ep 34 it 280 total=7.8407 mle=1.5731 pcon=4.8776 forget=1.3901 orth=0.0000 favg=0.0000 nr=113 nf=1 protos=630 fproto_sim=NA
[loss] ep 34 it 330 total=8.0318 mle=1.5456 pcon=4.8777 forget=1.6084 orth=0.0000 favg=0.0000 nr=109 nf=5 protos=630 fproto_sim=NA
[loss] ep 34 it 380 total=7.9632 mle=1.5910 pcon=4.8777 forget=1.4945 orth=0.0000 favg=0.0000 nr=101 nf=5 protos=630 fproto_sim=NA
[loss] ep 35 it 0 total=7.9459 mle=1.6238 pcon=4.8778 forget=1.4443 orth=0.0000 favg=0.0000 nr=98 nf=8 protos=630 fproto_sim=NA
[loss] ep 35 it 50 total=8.0834 mle=1.7397 pcon=4.8778 forget=1.4658 orth=0.0000 favg=0.0000 nr=104 nf=5 protos=630 fproto_sim=NA
[loss] ep 35 it 100 total=7.9306 mle=1.6266 pcon=4.8781 forget=1.4259 orth=0.0000 favg=0.0000 nr=106 nf=6 protos=630 fproto_sim=NA
[loss] ep 35 it 150 total=7.9920 mle=1.6778 pcon=4.8782 forget=1.4361 orth=0.0000 favg=0.0000 nr=107 nf=5 protos=630 fproto_sim=NA
[loss] ep 35 it 200 total=8.0379 mle=1.6311 pcon=4.8781 forget=1.5287 orth=0.0000 favg=0.0000 nr=98 nf=6 protos=630 fproto_sim=NA
[loss] ep 35 it 250 total=7.8167 mle=1.5230 pcon=4.8782 forget=1.4155 orth=0.0000 favg=0.0000 nr=105 nf=11 protos=630 fproto_sim=NA
[loss] ep 35 it 300 total=7.8554 mle=1.5104 pcon=4.8784 forget=1.4666 orth=0.0000 favg=0.0000 nr=96 nf=10 protos=630 fproto_sim=NA
[loss] ep 35 it 350 total=7.8760 mle=1.5561 pcon=4.8787 forget=1.4412 orth=0.0000 favg=0.0000 nr=106 nf=4 protos=630 fproto_sim=NA
[loss] ep 35 it 400 total=7.8852 mle=1.5522 pcon=4.8789 forget=1.4541 orth=0.0000 favg=0.0000 nr=101 nf=3 protos=630 fproto_sim=NA
[loss] ep 36 it 20 total=7.9962 mle=1.6635 pcon=4.8791 forget=1.4536 orth=0.0000 favg=0.0000 nr=108 nf=4 protos=630 fproto_sim=NA
[loss] ep 36 it 70 total=7.8856 mle=1.5602 pcon=4.8792 forget=1.4461 orth=0.0000 favg=0.0000 nr=106 nf=10 protos=630 fproto_sim=NA
[loss] ep 36 it 120 total=7.8117 mle=1.4872 pcon=4.8793 forget=1.4452 orth=0.0000 favg=0.0000 nr=106 nf=3 protos=630 fproto_sim=NA
[loss] ep 36 it 170 total=7.9782 mle=1.6694 pcon=4.8796 forget=1.4292 orth=0.0000 favg=0.0000 nr=99 nf=11 protos=630 fproto_sim=NA
[loss] ep 36 it 220 total=7.9441 mle=1.5708 pcon=4.8797 forget=1.4936 orth=0.0000 favg=0.0000 nr=99 nf=5 protos=630 fproto_sim=NA
[loss] ep 36 it 270 total=8.0023 mle=1.6832 pcon=4.8798 forget=1.4393 orth=0.0000 favg=0.0000 nr=102 nf=5 protos=630 fproto_sim=NA
[loss] ep 36 it 320 total=7.8865 mle=1.5808 pcon=4.8799 forget=1.4258 orth=0.0000 favg=0.0000 nr=94 nf=14 protos=630 fproto_sim=NA
[loss] ep 36 it 370 total=7.9046 mle=1.6263 pcon=4.8801 forget=1.3982 orth=0.0000 favg=0.0000 nr=99 nf=8 protos=630 fproto_sim=NA
[loss] ep 36 it 420 total=7.8822 mle=1.6030 pcon=4.8800 forget=1.3992 orth=0.0000 favg=0.0000 nr=92 nf=11 protos=630 fproto_sim=NA
[loss] ep 37 it 40 total=7.9216 mle=1.6249 pcon=4.8800 forget=1.4166 orth=0.0000 favg=0.0000 nr=103 nf=10 protos=630 fproto_sim=NA
[loss] ep 37 it 90 total=7.9147 mle=1.5991 pcon=4.8800 forget=1.4356 orth=0.0000 favg=0.0000 nr=104 nf=8 protos=630 fproto_sim=NA
[loss] ep 37 it 140 total=7.8410 mle=1.4815 pcon=4.8800 forget=1.4794 orth=0.0000 favg=0.0000 nr=108 nf=5 protos=630 fproto_sim=NA
[loss] ep 37 it 190 total=8.0370 mle=1.6708 pcon=4.8801 forget=1.4861 orth=0.0000 favg=0.0000 nr=105 nf=7 protos=630 fproto_sim=NA
[loss] ep 37 it 240 total=8.1246 mle=1.6031 pcon=4.8801 forget=1.6414 orth=0.0000 favg=0.0000 nr=111 nf=1 protos=630 fproto_sim=NA
[loss] ep 37 it 290 total=7.9377 mle=1.6051 pcon=4.8800 forget=1.4526 orth=0.0000 favg=0.0000 nr=106 nf=8 protos=630 fproto_sim=NA
[loss] ep 37 it 340 total=7.8931 mle=1.6245 pcon=4.8801 forget=1.3885 orth=0.0000 favg=0.0000 nr=107 nf=6 protos=630 fproto_sim=NA
[loss] ep 37 it 390 total=7.8736 mle=1.5821 pcon=4.8800 forget=1.4115 orth=0.0000 favg=0.0000 nr=102 nf=5 protos=630 fproto_sim=NA
[loss] ep 38 it 10 total=7.8644 mle=1.5476 pcon=4.8800 forget=1.4368 orth=0.0000 favg=0.0000 nr=112 nf=4 protos=630 fproto_sim=NA
[loss] ep 38 it 60 total=7.9420 mle=1.5908 pcon=4.8798 forget=1.4714 orth=0.0000 favg=0.0000 nr=110 nf=2 protos=630 fproto_sim=NA
[loss] ep 38 it 110 total=7.7835 mle=1.5602 pcon=4.8796 forget=1.3437 orth=0.0000 favg=0.0000 nr=99 nf=5 protos=630 fproto_sim=NA
[loss] ep 38 it 160 total=7.9231 mle=1.5863 pcon=4.8797 forget=1.4571 orth=0.0000 favg=0.0000 nr=108 nf=5 protos=630 fproto_sim=NA
[loss] ep 38 it 210 total=7.8861 mle=1.5475 pcon=4.8797 forget=1.4589 orth=0.0000 favg=0.0000 nr=105 nf=6 protos=630 fproto_sim=NA
[loss] ep 38 it 260 total=7.8655 mle=1.6322 pcon=4.8795 forget=1.3539 orth=0.0000 favg=0.0000 nr=113 nf=4 protos=630 fproto_sim=NA
[loss] ep 38 it 310 total=7.8000 mle=1.5318 pcon=4.8794 forget=1.3888 orth=0.0000 favg=0.0000 nr=96 nf=7 protos=630 fproto_sim=NA
[loss] ep 38 it 360 total=7.7200 mle=1.5224 pcon=4.8793 forget=1.3183 orth=0.0000 favg=0.0000 nr=115 nf=3 protos=630 fproto_sim=NA
[loss] ep 38 it 410 total=7.8473 mle=1.6195 pcon=4.8794 forget=1.3483 orth=0.0000 favg=0.0000 nr=105 nf=9 protos=630 fproto_sim=NA
[loss] ep 39 it 30 total=7.9467 mle=1.5838 pcon=4.8794 forget=1.4835 orth=0.0000 favg=0.0000 nr=107 nf=6 protos=630 fproto_sim=NA
[loss] ep 39 it 80 total=7.8219 mle=1.5361 pcon=4.8794 forget=1.4063 orth=0.0000 favg=0.0000 nr=102 nf=7 protos=630 fproto_sim=NA
[loss] ep 39 it 130 total=7.7149 mle=1.5042 pcon=4.8795 forget=1.3312 orth=0.0000 favg=0.0000 nr=105 nf=3 protos=630 fproto_sim=NA
 80%|████████  | 40/50 [07:17<01:49, 10.92s/it] 82%|████████▏ | 41/50 [07:28<01:38, 10.98s/it] 84%|████████▍ | 42/50 [07:39<01:27, 10.99s/it] 86%|████████▌ | 43/50 [07:51<01:17, 11.13s/it] 88%|████████▊ | 44/50 [08:02<01:06, 11.12s/it] 90%|█████████ | 45/50 [08:12<00:54, 10.87s/it] 92%|█████████▏| 46/50 [08:23<00:44, 11.01s/it][loss] ep 39 it 180 total=7.8591 mle=1.6356 pcon=4.8794 forget=1.3440 orth=0.0000 favg=0.0000 nr=102 nf=6 protos=630 fproto_sim=NA
[loss] ep 39 it 230 total=7.8410 mle=1.5480 pcon=4.8792 forget=1.4137 orth=0.0000 favg=0.0000 nr=105 nf=8 protos=630 fproto_sim=NA
[loss] ep 39 it 280 total=7.7875 mle=1.5575 pcon=4.8793 forget=1.3507 orth=0.0000 favg=0.0000 nr=110 nf=4 protos=630 fproto_sim=NA
[loss] ep 39 it 330 total=7.8721 mle=1.6097 pcon=4.8793 forget=1.3830 orth=0.0000 favg=0.0000 nr=108 nf=4 protos=630 fproto_sim=NA
[loss] ep 39 it 380 total=7.9946 mle=1.6844 pcon=4.8792 forget=1.4310 orth=0.0000 favg=0.0000 nr=104 nf=8 protos=630 fproto_sim=NA
[loss] ep 40 it 0 total=7.8971 mle=1.6383 pcon=4.8790 forget=1.3798 orth=0.0000 favg=0.0000 nr=102 nf=8 protos=630 fproto_sim=NA
[loss] ep 40 it 50 total=7.9807 mle=1.6627 pcon=4.8789 forget=1.4390 orth=0.0000 favg=0.0000 nr=96 nf=9 protos=630 fproto_sim=NA
[loss] ep 40 it 100 total=7.9132 mle=1.6097 pcon=4.8787 forget=1.4248 orth=0.0000 favg=0.0000 nr=104 nf=9 protos=630 fproto_sim=NA
[loss] ep 40 it 150 total=7.8262 mle=1.5641 pcon=4.8789 forget=1.3832 orth=0.0000 favg=0.0000 nr=105 nf=7 protos=630 fproto_sim=NA
[loss] ep 40 it 200 total=7.7438 mle=1.5478 pcon=4.8787 forget=1.3173 orth=0.0000 favg=0.0000 nr=113 nf=3 protos=630 fproto_sim=NA
[loss] ep 40 it 250 total=7.7464 mle=1.5301 pcon=4.8787 forget=1.3377 orth=0.0000 favg=0.0000 nr=100 nf=9 protos=630 fproto_sim=NA
[loss] ep 40 it 300 total=7.7931 mle=1.6073 pcon=4.8786 forget=1.3072 orth=0.0000 favg=0.0000 nr=100 nf=4 protos=630 fproto_sim=NA
[loss] ep 40 it 350 total=8.0310 mle=1.7242 pcon=4.8786 forget=1.4283 orth=0.0000 favg=0.0000 nr=100 nf=12 protos=630 fproto_sim=NA
[loss] ep 40 it 400 total=7.8097 mle=1.6389 pcon=4.8787 forget=1.2921 orth=0.0000 favg=0.0000 nr=98 nf=6 protos=630 fproto_sim=NA
[loss] ep 41 it 20 total=7.9389 mle=1.6714 pcon=4.8784 forget=1.3891 orth=0.0000 favg=0.0000 nr=102 nf=7 protos=630 fproto_sim=NA
[loss] ep 41 it 70 total=7.9720 mle=1.6844 pcon=4.8783 forget=1.4093 orth=0.0000 favg=0.0000 nr=101 nf=7 protos=630 fproto_sim=NA
[loss] ep 41 it 120 total=7.7604 mle=1.5013 pcon=4.8782 forget=1.3809 orth=0.0000 favg=0.0000 nr=106 nf=4 protos=630 fproto_sim=NA
[loss] ep 41 it 170 total=7.8579 mle=1.6810 pcon=4.8779 forget=1.2990 orth=0.0000 favg=0.0000 nr=98 nf=5 protos=630 fproto_sim=NA
[loss] ep 41 it 220 total=7.8631 mle=1.6535 pcon=4.8779 forget=1.3317 orth=0.0000 favg=0.0000 nr=103 nf=3 protos=630 fproto_sim=NA
[loss] ep 41 it 270 total=7.7726 mle=1.5283 pcon=4.8778 forget=1.3666 orth=0.0000 favg=0.0000 nr=107 nf=8 protos=630 fproto_sim=NA
[loss] ep 41 it 320 total=7.7746 mle=1.5861 pcon=4.8778 forget=1.3107 orth=0.0000 favg=0.0000 nr=106 nf=8 protos=630 fproto_sim=NA
[loss] ep 41 it 370 total=7.7997 mle=1.4798 pcon=4.8777 forget=1.4422 orth=0.0000 favg=0.0000 nr=108 nf=2 protos=630 fproto_sim=NA
[loss] ep 41 it 420 total=8.0099 mle=1.7564 pcon=4.8776 forget=1.3758 orth=0.0000 favg=0.0000 nr=106 nf=4 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 42 it 40 total=7.7475 mle=1.5280 pcon=4.8776 forget=1.3419 orth=0.0000 favg=0.0000 nr=110 nf=2 protos=630 fproto_sim=NA
[loss] ep 42 it 90 total=8.0116 mle=1.6031 pcon=4.8774 forget=1.5311 orth=0.0000 favg=0.0000 nr=109 nf=4 protos=630 fproto_sim=NA
[loss] ep 42 it 140 total=7.9404 mle=1.6147 pcon=4.8774 forget=1.4483 orth=0.0000 favg=0.0000 nr=107 nf=9 protos=630 fproto_sim=NA
[loss] ep 42 it 190 total=7.7819 mle=1.5307 pcon=4.8774 forget=1.3738 orth=0.0000 favg=0.0000 nr=103 nf=6 protos=630 fproto_sim=NA
[loss] ep 42 it 240 total=7.7634 mle=1.5866 pcon=4.8772 forget=1.2996 orth=0.0000 favg=0.0000 nr=106 nf=4 protos=630 fproto_sim=NA
[loss] ep 42 it 290 total=7.8109 mle=1.5934 pcon=4.8771 forget=1.3404 orth=0.0000 favg=0.0000 nr=105 nf=5 protos=630 fproto_sim=NA
[loss] ep 42 it 340 total=7.8666 mle=1.6449 pcon=4.8771 forget=1.3446 orth=0.0000 favg=0.0000 nr=102 nf=6 protos=630 fproto_sim=NA
[loss] ep 42 it 390 total=7.9538 mle=1.6469 pcon=4.8769 forget=1.4300 orth=0.0000 favg=0.0000 nr=106 nf=10 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 43 it 10 total=7.8907 mle=1.6891 pcon=4.8767 forget=1.3249 orth=0.0000 favg=0.0000 nr=103 nf=7 protos=630 fproto_sim=NA
[loss] ep 43 it 60 total=7.8394 mle=1.6320 pcon=4.8767 forget=1.3308 orth=0.0000 favg=0.0000 nr=110 nf=7 protos=630 fproto_sim=NA
[loss] ep 43 it 110 total=7.8521 mle=1.6414 pcon=4.8766 forget=1.3341 orth=0.0000 favg=0.0000 nr=91 nf=8 protos=630 fproto_sim=NA
[loss] ep 43 it 160 total=7.8882 mle=1.6129 pcon=4.8765 forget=1.3987 orth=0.0000 favg=0.0000 nr=109 nf=2 protos=630 fproto_sim=NA
[loss] ep 43 it 210 total=7.8110 mle=1.6132 pcon=4.8764 forget=1.3213 orth=0.0000 favg=0.0000 nr=99 nf=10 protos=630 fproto_sim=NA
[loss] ep 43 it 260 total=7.9977 mle=1.6653 pcon=4.8763 forget=1.4561 orth=0.0000 favg=0.0000 nr=105 nf=5 protos=630 fproto_sim=NA
[loss] ep 43 it 310 total=7.9189 mle=1.6779 pcon=4.8761 forget=1.3649 orth=0.0000 favg=0.0000 nr=109 nf=3 protos=630 fproto_sim=NA
[loss] ep 43 it 360 total=7.9026 mle=1.6405 pcon=4.8760 forget=1.3861 orth=0.0000 favg=0.0000 nr=106 nf=6 protos=630 fproto_sim=NA
[loss] ep 43 it 410 total=7.9761 mle=1.7169 pcon=4.8758 forget=1.3835 orth=0.0000 favg=0.0000 nr=108 nf=5 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 44 it 30 total=7.8866 mle=1.6137 pcon=4.8756 forget=1.3973 orth=0.0000 favg=0.0000 nr=107 nf=5 protos=630 fproto_sim=NA
[loss] ep 44 it 80 total=7.8696 mle=1.6295 pcon=4.8754 forget=1.3646 orth=0.0000 favg=0.0000 nr=105 nf=6 protos=630 fproto_sim=NA
[loss] ep 44 it 130 total=7.8255 mle=1.5834 pcon=4.8753 forget=1.3669 orth=0.0000 favg=0.0000 nr=105 nf=8 protos=630 fproto_sim=NA
[loss] ep 44 it 180 total=6.4815 mle=1.6061 pcon=4.8754 forget=0.0000 orth=0.0000 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 230 total=7.7702 mle=1.5130 pcon=4.8751 forget=1.3821 orth=0.0000 favg=0.0000 nr=114 nf=3 protos=630 fproto_sim=NA
[loss] ep 44 it 280 total=7.8970 mle=1.6630 pcon=4.8751 forget=1.3589 orth=0.0000 favg=0.0000 nr=98 nf=8 protos=630 fproto_sim=NA
[loss] ep 44 it 330 total=7.8977 mle=1.7388 pcon=4.8749 forget=1.2840 orth=0.0000 favg=0.0000 nr=112 nf=6 protos=630 fproto_sim=NA
[loss] ep 44 it 380 total=7.6763 mle=1.5115 pcon=4.8749 forget=1.2899 orth=0.0000 favg=0.0000 nr=108 nf=7 protos=630 fproto_sim=NA
[loss] ep 45 it 0 total=7.8317 mle=1.6314 pcon=4.8747 forget=1.3255 orth=0.0000 favg=0.0000 nr=98 nf=8 protos=630 fproto_sim=NA
[loss] ep 45 it 50 total=7.8674 mle=1.5581 pcon=4.8746 forget=1.4348 orth=0.0000 favg=0.0000 nr=105 nf=6 protos=630 fproto_sim=NA
[loss] ep 45 it 100 total=7.7872 mle=1.6038 pcon=4.8747 forget=1.3087 orth=0.0000 favg=0.0000 nr=98 nf=14 protos=630 fproto_sim=NA
[loss] ep 45 it 150 total=7.7919 mle=1.5424 pcon=4.8747 forget=1.3748 orth=0.0000 favg=0.0000 nr=97 nf=9 protos=630 fproto_sim=NA
[loss] ep 45 it 200 total=7.6811 mle=1.5320 pcon=4.8746 forget=1.2746 orth=0.0000 favg=0.0000 nr=109 nf=3 protos=630 fproto_sim=NA
[loss] ep 45 it 250 total=7.8044 mle=1.5760 pcon=4.8744 forget=1.3540 orth=0.0000 favg=0.0000 nr=103 nf=4 protos=630 fproto_sim=NA
[loss] ep 45 it 300 total=7.7382 mle=1.5808 pcon=4.8743 forget=1.2831 orth=0.0000 favg=0.0000 nr=112 nf=5 protos=630 fproto_sim=NA
[loss] ep 45 it 350 total=7.8778 mle=1.6103 pcon=4.8743 forget=1.3932 orth=0.0000 favg=0.0000 nr=103 nf=5 protos=630 fproto_sim=NA
[loss] ep 45 it 400 total=7.7785 mle=1.5300 pcon=4.8743 forget=1.3742 orth=0.0000 favg=0.0000 nr=107 nf=3 protos=630 fproto_sim=NA
 94%|█████████▍| 47/50 [08:34<00:32, 10.93s/it] 96%|█████████▌| 48/50 [08:45<00:21, 10.91s/it] 98%|█████████▊| 49/50 [08:55<00:10, 10.64s/it]100%|██████████| 50/50 [09:05<00:00, 10.59s/it]100%|██████████| 50/50 [09:05<00:00, 10.92s/it]
[loss] ep 46 it 20 total=7.8114 mle=1.5434 pcon=4.8743 forget=1.3937 orth=0.0000 favg=0.0000 nr=99 nf=7 protos=630 fproto_sim=NA
[loss] ep 46 it 70 total=7.9964 mle=1.6958 pcon=4.8744 forget=1.4262 orth=0.0000 favg=0.0000 nr=104 nf=6 protos=630 fproto_sim=NA
[loss] ep 46 it 120 total=7.8040 mle=1.6084 pcon=4.8744 forget=1.3213 orth=0.0000 favg=0.0000 nr=101 nf=10 protos=630 fproto_sim=NA
[loss] ep 46 it 170 total=7.7976 mle=1.6202 pcon=4.8744 forget=1.3030 orth=0.0000 favg=0.0000 nr=96 nf=7 protos=630 fproto_sim=NA
[loss] ep 46 it 220 total=7.7082 mle=1.4931 pcon=4.8743 forget=1.3408 orth=0.0000 favg=0.0000 nr=101 nf=6 protos=630 fproto_sim=NA
[loss] ep 46 it 270 total=7.9093 mle=1.6242 pcon=4.8741 forget=1.4111 orth=0.0000 favg=0.0000 nr=103 nf=6 protos=630 fproto_sim=NA
[loss] ep 46 it 320 total=7.8308 mle=1.5558 pcon=4.8740 forget=1.4009 orth=0.0000 favg=0.0000 nr=98 nf=16 protos=630 fproto_sim=NA
[loss] ep 46 it 370 total=7.8539 mle=1.5792 pcon=4.8740 forget=1.4006 orth=0.0000 favg=0.0000 nr=105 nf=8 protos=630 fproto_sim=NA
[loss] ep 46 it 420 total=7.7538 mle=1.5360 pcon=4.8740 forget=1.3439 orth=0.0000 favg=0.0000 nr=106 nf=4 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[loss] ep 47 it 40 total=7.8199 mle=1.5900 pcon=4.8740 forget=1.3559 orth=0.0000 favg=0.0000 nr=110 nf=4 protos=630 fproto_sim=NA
[loss] ep 47 it 90 total=7.7985 mle=1.5170 pcon=4.8742 forget=1.4073 orth=0.0000 favg=0.0000 nr=98 nf=3 protos=630 fproto_sim=NA
[loss] ep 47 it 140 total=7.8433 mle=1.5727 pcon=4.8741 forget=1.3965 orth=0.0000 favg=0.0000 nr=102 nf=9 protos=630 fproto_sim=NA
[loss] ep 47 it 190 total=7.8194 mle=1.5343 pcon=4.8743 forget=1.4108 orth=0.0000 favg=0.0000 nr=100 nf=10 protos=630 fproto_sim=NA
[loss] ep 47 it 240 total=7.6534 mle=1.4975 pcon=4.8741 forget=1.2818 orth=0.0000 favg=0.0000 nr=111 nf=3 protos=630 fproto_sim=NA
[loss] ep 47 it 290 total=7.7003 mle=1.4945 pcon=4.8739 forget=1.3319 orth=0.0000 favg=0.0000 nr=99 nf=11 protos=630 fproto_sim=NA
[loss] ep 47 it 340 total=7.7235 mle=1.5684 pcon=4.8738 forget=1.2813 orth=0.0000 favg=0.0000 nr=110 nf=3 protos=630 fproto_sim=NA
[loss] ep 47 it 390 total=8.0419 mle=1.7379 pcon=4.8737 forget=1.4302 orth=0.0000 favg=0.0000 nr=101 nf=5 protos=630 fproto_sim=NA
[loss] ep 48 it 10 total=7.8822 mle=1.6482 pcon=4.8737 forget=1.3604 orth=0.0000 favg=0.0000 nr=102 nf=5 protos=630 fproto_sim=NA
[loss] ep 48 it 60 total=7.9253 mle=1.6858 pcon=4.8736 forget=1.3659 orth=0.0000 favg=0.0000 nr=97 nf=7 protos=630 fproto_sim=NA
[loss] ep 48 it 110 total=7.8107 mle=1.6432 pcon=4.8735 forget=1.2939 orth=0.0000 favg=0.0000 nr=111 nf=5 protos=630 fproto_sim=NA
[loss] ep 48 it 160 total=7.8399 mle=1.6104 pcon=4.8732 forget=1.3562 orth=0.0000 favg=0.0000 nr=103 nf=10 protos=630 fproto_sim=NA
[loss] ep 48 it 210 total=7.9962 mle=1.6337 pcon=4.8733 forget=1.4892 orth=0.0000 favg=0.0000 nr=100 nf=5 protos=630 fproto_sim=NA
[loss] ep 48 it 260 total=7.8669 mle=1.6023 pcon=4.8735 forget=1.3911 orth=0.0000 favg=0.0000 nr=109 nf=9 protos=630 fproto_sim=NA
[loss] ep 48 it 310 total=7.7093 mle=1.5516 pcon=4.8734 forget=1.2843 orth=0.0000 favg=0.0000 nr=101 nf=9 protos=630 fproto_sim=NA
[loss] ep 48 it 360 total=7.9291 mle=1.6329 pcon=4.8735 forget=1.4228 orth=0.0000 favg=0.0000 nr=98 nf=5 protos=630 fproto_sim=NA
[loss] ep 48 it 410 total=7.9705 mle=1.5923 pcon=4.8734 forget=1.5048 orth=0.0000 favg=0.0000 nr=108 nf=4 protos=630 fproto_sim=NA
[loss] ep 49 it 30 total=7.8192 mle=1.5084 pcon=4.8734 forget=1.4374 orth=0.0000 favg=0.0000 nr=98 nf=3 protos=630 fproto_sim=NA
[loss] ep 49 it 80 total=7.6729 mle=1.5221 pcon=4.8736 forget=1.2773 orth=0.0000 favg=0.0000 nr=107 nf=4 protos=630 fproto_sim=NA
[loss] ep 49 it 130 total=7.7520 mle=1.5142 pcon=4.8734 forget=1.3644 orth=0.0000 favg=0.0000 nr=103 nf=4 protos=630 fproto_sim=NA
[loss] ep 49 it 180 total=7.8856 mle=1.7320 pcon=4.8733 forget=1.2803 orth=0.0000 favg=0.0000 nr=101 nf=6 protos=630 fproto_sim=NA
[loss] ep 49 it 230 total=7.7821 mle=1.6179 pcon=4.8733 forget=1.2909 orth=0.0000 favg=0.0000 nr=101 nf=2 protos=630 fproto_sim=NA
[loss] ep 49 it 280 total=7.9112 mle=1.6191 pcon=4.8735 forget=1.4186 orth=0.0000 favg=0.0000 nr=100 nf=9 protos=630 fproto_sim=NA
[loss] ep 49 it 330 total=7.7959 mle=1.6020 pcon=4.8734 forget=1.3205 orth=0.0000 favg=0.0000 nr=102 nf=10 protos=630 fproto_sim=NA
[loss] ep 49 it 380 total=7.8799 mle=1.6978 pcon=4.8733 forget=1.3088 orth=0.0000 favg=0.0000 nr=107 nf=6 protos=630 fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-inc1-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:46,  1.89it/s]  3%|▎         | 11/430 [00:00<00:18, 22.38it/s]  5%|▍         | 20/430 [00:00<00:10, 37.60it/s]  7%|▋         | 30/430 [00:00<00:07, 52.15it/s]  9%|▉         | 40/430 [00:00<00:06, 62.74it/s] 12%|█▏        | 50/430 [00:01<00:05, 70.92it/s] 14%|█▍        | 60/430 [00:01<00:04, 77.06it/s] 16%|█▋        | 70/430 [00:01<00:04, 81.83it/s] 19%|█▊        | 80/430 [00:01<00:04, 85.11it/s] 21%|██        | 90/430 [00:01<00:03, 87.37it/s] 23%|██▎       | 100/430 [00:01<00:03, 88.95it/s] 26%|██▌       | 110/430 [00:01<00:03, 90.06it/s] 28%|██▊       | 120/430 [00:01<00:03, 90.89it/s] 30%|███       | 130/430 [00:01<00:03, 91.76it/s] 33%|███▎      | 140/430 [00:02<00:03, 92.66it/s] 35%|███▍      | 150/430 [00:02<00:02, 93.45it/s] 37%|███▋      | 160/430 [00:02<00:02, 94.20it/s] 40%|███▉      | 170/430 [00:02<00:02, 94.82it/s] 42%|████▏     | 180/430 [00:02<00:02, 95.15it/s] 44%|████▍     | 190/430 [00:02<00:02, 95.49it/s] 47%|████▋     | 200/430 [00:02<00:02, 95.71it/s] 49%|████▉     | 210/430 [00:02<00:02, 95.72it/s] 51%|█████     | 220/430 [00:02<00:02, 95.95it/s] 53%|█████▎    | 230/430 [00:02<00:02, 95.40it/s] 56%|█████▌    | 240/430 [00:03<00:01, 95.49it/s] 58%|█████▊    | 250/430 [00:03<00:01, 95.71it/s] 60%|██████    | 260/430 [00:03<00:01, 95.76it/s] 63%|██████▎   | 270/430 [00:03<00:01, 96.05it/s] 65%|██████▌   | 280/430 [00:03<00:01, 96.18it/s] 67%|██████▋   | 290/430 [00:03<00:01, 96.15it/s] 70%|██████▉   | 300/430 [00:03<00:01, 96.18it/s] 72%|███████▏  | 310/430 [00:03<00:01, 96.22it/s] 74%|███████▍  | 320/430 [00:03<00:01, 96.32it/s] 77%|███████▋  | 330/430 [00:04<00:01, 96.33it/s] 79%|███████▉  | 340/430 [00:04<00:00, 96.46it/s] 81%|████████▏ | 350/430 [00:04<00:00, 96.37it/s] 84%|████████▎ | 360/430 [00:04<00:00, 96.12it/s] 86%|████████▌ | 370/430 [00:04<00:00, 96.06it/s] 88%|████████▊ | 380/430 [00:04<00:00, 96.05it/s] 91%|█████████ | 390/430 [00:04<00:00, 96.19it/s] 93%|█████████▎| 400/430 [00:04<00:00, 96.04it/s] 95%|█████████▌| 410/430 [00:04<00:00, 96.55it/s] 98%|█████████▊| 420/430 [00:04<00:00, 96.77it/s]100%|██████████| 430/430 [00:05<00:00, 94.83it/s]100%|██████████| 430/430 [00:05<00:00, 85.08it/s]
55000 images processed, 5.104121446609497 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:35,  2.38it/s] 10%|█         | 9/86 [00:00<00:03, 22.00it/s] 22%|██▏       | 19/86 [00:00<00:01, 41.69it/s] 34%|███▎      | 29/86 [00:00<00:01, 56.67it/s] 45%|████▌     | 39/86 [00:00<00:00, 67.79it/s] 57%|█████▋    | 49/86 [00:00<00:00, 75.81it/s] 67%|██████▋   | 58/86 [00:01<00:00, 79.76it/s] 79%|███████▉  | 68/86 [00:01<00:00, 84.72it/s] 91%|█████████ | 78/86 [00:01<00:00, 88.48it/s]100%|██████████| 86/86 [00:01<00:00, 64.33it/s]
11000 images processed, 1.349602222442627 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:42,  1.99it/s]  5%|▌         | 11/204 [00:00<00:08, 23.25it/s] 10%|█         | 21/204 [00:00<00:04, 40.51it/s] 15%|█▌        | 31/204 [00:00<00:03, 53.84it/s] 20%|██        | 41/204 [00:00<00:02, 63.92it/s] 25%|██▍       | 50/204 [00:01<00:02, 70.71it/s] 29%|██▉       | 60/204 [00:01<00:01, 76.61it/s] 34%|███▍      | 70/204 [00:01<00:01, 80.82it/s] 39%|███▉      | 80/204 [00:01<00:01, 83.89it/s] 44%|████▍     | 90/204 [00:01<00:01, 85.95it/s] 49%|████▉     | 100/204 [00:01<00:01, 87.77it/s] 54%|█████▍    | 110/204 [00:01<00:01, 89.07it/s] 59%|█████▉    | 120/204 [00:01<00:00, 89.49it/s] 64%|██████▎   | 130/204 [00:01<00:00, 90.29it/s] 69%|██████▊   | 140/204 [00:02<00:00, 90.73it/s] 74%|███████▎  | 150/204 [00:02<00:00, 91.91it/s] 78%|███████▊  | 160/204 [00:02<00:00, 93.03it/s] 83%|████████▎ | 170/204 [00:02<00:00, 93.56it/s] 88%|████████▊ | 180/204 [00:02<00:00, 93.90it/s] 93%|█████████▎| 190/204 [00:02<00:00, 94.79it/s] 98%|█████████▊| 200/204 [00:02<00:00, 95.43it/s]100%|██████████| 204/204 [00:02<00:00, 75.57it/s]
26032 images processed, 2.7364871501922607 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:51,  1.53it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.84it/s] 25%|██▌       | 20/79 [00:00<00:01, 33.09it/s] 38%|███▊      | 30/79 [00:00<00:01, 47.04it/s] 51%|█████     | 40/79 [00:01<00:00, 58.47it/s] 63%|██████▎   | 50/79 [00:01<00:00, 67.46it/s] 76%|███████▌  | 60/79 [00:01<00:00, 74.62it/s] 89%|████████▊ | 70/79 [00:01<00:00, 80.72it/s]100%|██████████| 79/79 [00:01<00:00, 52.52it/s]
10000 images processed, 1.5261266231536865 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:41,  1.88it/s] 14%|█▍        | 11/79 [00:00<00:03, 22.38it/s] 27%|██▋       | 21/79 [00:00<00:01, 39.79it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.00it/s] 52%|█████▏    | 41/79 [00:00<00:00, 65.07it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.57it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.14it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.01it/s]100%|██████████| 79/79 [00:01<00:00, 59.09it/s]
10000 images processed, 1.357736349105835 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:33,  2.05it/s] 13%|█▎        | 9/70 [00:00<00:03, 19.34it/s] 23%|██▎       | 16/70 [00:00<00:01, 30.91it/s] 36%|███▌      | 25/70 [00:00<00:00, 45.69it/s] 49%|████▊     | 34/70 [00:00<00:00, 57.37it/s] 61%|██████▏   | 43/70 [00:01<00:00, 65.89it/s] 76%|███████▌  | 53/70 [00:01<00:00, 74.82it/s] 90%|█████████ | 63/70 [00:01<00:00, 81.34it/s]100%|██████████| 70/70 [00:01<00:00, 54.25it/s]
8925 images processed, 1.3175499439239502 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:44,  1.01s/it] 11%|█         | 5/45 [00:01<00:06,  5.73it/s] 33%|███▎      | 15/45 [00:01<00:01, 19.53it/s] 47%|████▋     | 21/45 [00:01<00:01, 19.31it/s] 58%|█████▊    | 26/45 [00:01<00:00, 22.17it/s] 73%|███████▎  | 33/45 [00:02<00:00, 21.15it/s] 82%|████████▏ | 37/45 [00:02<00:00, 20.96it/s]100%|██████████| 45/45 [00:02<00:00, 19.22it/s]
5640 images processed, 2.363382339477539 seconds used

17.366869688034058
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.27  99.75  93.13
places365     39.29  94.49  80.16
LSUN           1.79  99.34  95.61
iSUN          33.71  95.33  85.24
dtd           21.54  96.70  88.03
AVG           19.52  97.12  88.43
[incremental] Overall: 0.9220 New: 0.9220 Old: nan
1.8068244457244873
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-inc1-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:14,  2.20it/s]  2%|▏         | 9/430 [00:00<00:20, 20.50it/s]  4%|▍         | 18/430 [00:00<00:10, 37.77it/s]  7%|▋         | 28/430 [00:00<00:07, 52.79it/s]  9%|▊         | 37/430 [00:00<00:06, 61.72it/s] 11%|█         | 47/430 [00:00<00:05, 70.89it/s] 13%|█▎        | 57/430 [00:01<00:04, 77.47it/s] 16%|█▌        | 67/430 [00:01<00:04, 80.79it/s] 18%|█▊        | 77/430 [00:01<00:04, 84.72it/s] 20%|██        | 87/430 [00:01<00:03, 87.33it/s] 23%|██▎       | 97/430 [00:01<00:03, 89.62it/s] 25%|██▍       | 107/430 [00:01<00:03, 91.06it/s] 27%|██▋       | 117/430 [00:01<00:03, 92.33it/s] 30%|██▉       | 127/430 [00:01<00:03, 93.73it/s] 32%|███▏      | 137/430 [00:01<00:03, 94.12it/s] 34%|███▍      | 147/430 [00:02<00:02, 94.77it/s] 37%|███▋      | 157/430 [00:02<00:02, 95.37it/s] 39%|███▉      | 167/430 [00:02<00:02, 95.74it/s] 41%|████      | 177/430 [00:02<00:02, 95.83it/s] 43%|████▎     | 187/430 [00:02<00:02, 96.21it/s] 46%|████▌     | 197/430 [00:02<00:02, 96.30it/s] 48%|████▊     | 207/430 [00:02<00:02, 95.93it/s] 50%|█████     | 217/430 [00:02<00:02, 96.07it/s] 53%|█████▎    | 227/430 [00:02<00:02, 96.14it/s] 55%|█████▌    | 237/430 [00:02<00:02, 96.31it/s] 57%|█████▋    | 247/430 [00:03<00:01, 96.56it/s] 60%|█████▉    | 257/430 [00:03<00:01, 96.46it/s] 62%|██████▏   | 267/430 [00:03<00:01, 96.59it/s] 64%|██████▍   | 277/430 [00:03<00:01, 96.62it/s] 67%|██████▋   | 287/430 [00:03<00:01, 96.76it/s] 69%|██████▉   | 297/430 [00:03<00:01, 96.76it/s] 71%|███████▏  | 307/430 [00:03<00:01, 96.75it/s] 74%|███████▎  | 317/430 [00:03<00:01, 96.76it/s] 76%|███████▌  | 327/430 [00:03<00:01, 96.91it/s] 78%|███████▊  | 337/430 [00:04<00:00, 96.92it/s] 81%|████████  | 347/430 [00:04<00:00, 96.99it/s] 83%|████████▎ | 357/430 [00:04<00:00, 96.90it/s] 85%|████████▌ | 367/430 [00:04<00:00, 97.06it/s] 88%|████████▊ | 377/430 [00:04<00:00, 96.96it/s] 90%|█████████ | 387/430 [00:04<00:00, 97.10it/s] 92%|█████████▏| 397/430 [00:04<00:00, 97.07it/s] 95%|█████████▍| 407/430 [00:04<00:00, 96.99it/s] 97%|█████████▋| 417/430 [00:04<00:00, 97.34it/s] 99%|█████████▉| 427/430 [00:04<00:00, 97.50it/s]100%|██████████| 430/430 [00:04<00:00, 86.38it/s]
55000 images processed, 5.065987586975098 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:37,  2.28it/s] 12%|█▏        | 10/86 [00:00<00:03, 23.62it/s] 22%|██▏       | 19/86 [00:00<00:01, 40.70it/s] 34%|███▎      | 29/86 [00:00<00:01, 55.25it/s] 44%|████▍     | 38/86 [00:00<00:00, 64.69it/s] 56%|█████▌    | 48/86 [00:00<00:00, 72.79it/s] 67%|██████▋   | 58/86 [00:01<00:00, 78.49it/s] 79%|███████▉  | 68/86 [00:01<00:00, 83.25it/s] 91%|█████████ | 78/86 [00:01<00:00, 86.49it/s]100%|██████████| 86/86 [00:01<00:00, 62.75it/s]
11000 images processed, 1.3943350315093994 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-inc1-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:39,  2.04it/s]  5%|▌         | 11/204 [00:00<00:08, 23.80it/s] 10%|█         | 21/204 [00:00<00:04, 41.75it/s] 15%|█▌        | 31/204 [00:00<00:03, 55.96it/s] 20%|██        | 41/204 [00:00<00:02, 66.83it/s] 25%|██▌       | 51/204 [00:01<00:02, 74.91it/s] 30%|██▉       | 61/204 [00:01<00:01, 80.88it/s] 35%|███▍      | 71/204 [00:01<00:01, 84.96it/s] 40%|███▉      | 81/204 [00:01<00:01, 87.77it/s] 45%|████▍     | 91/204 [00:01<00:01, 89.53it/s] 50%|████▉     | 101/204 [00:01<00:01, 90.75it/s] 54%|█████▍    | 111/204 [00:01<00:01, 92.08it/s] 59%|█████▉    | 121/204 [00:01<00:00, 92.86it/s] 64%|██████▍   | 131/204 [00:01<00:00, 93.55it/s] 69%|██████▉   | 141/204 [00:01<00:00, 93.95it/s] 74%|███████▍  | 151/204 [00:02<00:00, 94.08it/s] 79%|███████▉  | 161/204 [00:02<00:00, 94.44it/s] 84%|████████▍ | 171/204 [00:02<00:00, 94.55it/s] 89%|████████▊ | 181/204 [00:02<00:00, 94.64it/s] 94%|█████████▎| 191/204 [00:02<00:00, 95.38it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.85it/s]100%|██████████| 204/204 [00:02<00:00, 77.66it/s]
26032 images processed, 2.6650023460388184 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:47,  1.63it/s] 10%|█         | 8/79 [00:00<00:04, 14.38it/s] 23%|██▎       | 18/79 [00:00<00:01, 31.99it/s] 35%|███▌      | 28/79 [00:00<00:01, 46.93it/s] 48%|████▊     | 38/79 [00:01<00:00, 59.21it/s] 61%|██████    | 48/79 [00:01<00:00, 68.52it/s] 73%|███████▎  | 58/79 [00:01<00:00, 75.83it/s] 86%|████████▌ | 68/79 [00:01<00:00, 81.70it/s] 99%|█████████▊| 78/79 [00:01<00:00, 86.06it/s]100%|██████████| 79/79 [00:01<00:00, 53.67it/s]
10000 images processed, 1.5085651874542236 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.96it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.07it/s] 25%|██▌       | 20/79 [00:00<00:01, 38.92it/s] 38%|███▊      | 30/79 [00:00<00:00, 53.16it/s] 51%|█████     | 40/79 [00:00<00:00, 64.10it/s] 63%|██████▎   | 50/79 [00:01<00:00, 71.52it/s] 76%|███████▌  | 60/79 [00:01<00:00, 78.60it/s] 89%|████████▊ | 70/79 [00:01<00:00, 83.87it/s]100%|██████████| 79/79 [00:01<00:00, 58.97it/s]
10000 images processed, 1.3595154285430908 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.87it/s] 14%|█▍        | 10/70 [00:00<00:02, 20.40it/s] 27%|██▋       | 19/70 [00:00<00:01, 36.46it/s] 41%|████▏     | 29/70 [00:00<00:00, 51.05it/s] 56%|█████▌    | 39/70 [00:00<00:00, 62.19it/s] 70%|███████   | 49/70 [00:01<00:00, 71.49it/s] 84%|████████▍ | 59/70 [00:01<00:00, 78.62it/s] 99%|█████████▊| 69/70 [00:01<00:00, 83.89it/s]100%|██████████| 70/70 [00:01<00:00, 54.78it/s]
8925 images processed, 1.308210849761963 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.12it/s]  4%|▍         | 2/45 [00:01<00:19,  2.23it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.57it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.80it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.62it/s] 56%|█████▌    | 25/45 [00:01<00:00, 23.61it/s] 73%|███████▎  | 33/45 [00:01<00:00, 24.24it/s] 82%|████████▏ | 37/45 [00:02<00:00, 26.62it/s]100%|██████████| 45/45 [00:02<00:00, 21.02it/s]
5640 images processed, 2.1708996295928955 seconds used

17.098508596420288
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.63  99.39  98.33
places365     72.36  78.17  78.39
LSUN           8.77  97.89  97.95
iSUN          69.12  82.93  86.31
dtd           42.27  89.90  94.17
AVG           39.03  89.65  91.03
Retain-Acc: 0.7296
Forget-as-OOD (retain known vs forget novel):
  FPR: 40.00 AUROC: 89.81 AUIN: 99.37
8.329528093338013
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:22,  2.12it/s]  2%|▏         | 10/430 [00:00<00:19, 21.74it/s]  4%|▍         | 18/430 [00:00<00:11, 35.23it/s]  6%|▌         | 24/430 [00:00<00:09, 41.03it/s]  7%|▋         | 31/430 [00:00<00:08, 48.14it/s] 10%|▉         | 41/430 [00:01<00:06, 61.47it/s] 12%|█▏        | 51/430 [00:01<00:05, 71.26it/s] 14%|█▍        | 61/430 [00:01<00:04, 78.62it/s] 17%|█▋        | 71/430 [00:01<00:04, 83.80it/s] 19%|█▊        | 80/430 [00:01<00:04, 83.35it/s] 21%|██        | 89/430 [00:01<00:04, 81.87it/s] 23%|██▎       | 98/430 [00:01<00:04, 80.55it/s] 25%|██▍       | 107/430 [00:01<00:04, 79.22it/s] 27%|██▋       | 117/430 [00:01<00:03, 82.44it/s] 30%|██▉       | 127/430 [00:01<00:03, 86.42it/s] 32%|███▏      | 137/430 [00:02<00:03, 89.33it/s] 34%|███▍      | 147/430 [00:02<00:03, 91.55it/s] 37%|███▋      | 157/430 [00:02<00:02, 93.03it/s] 39%|███▉      | 167/430 [00:02<00:02, 94.16it/s] 41%|████      | 177/430 [00:02<00:02, 95.10it/s] 43%|████▎     | 187/430 [00:02<00:02, 95.63it/s] 46%|████▌     | 197/430 [00:02<00:02, 96.07it/s] 48%|████▊     | 207/430 [00:02<00:02, 96.06it/s] 50%|█████     | 217/430 [00:02<00:02, 96.38it/s] 53%|█████▎    | 227/430 [00:03<00:02, 96.36it/s] 55%|█████▌    | 237/430 [00:03<00:01, 96.56it/s] 57%|█████▋    | 247/430 [00:03<00:01, 96.64it/s] 60%|█████▉    | 257/430 [00:03<00:01, 96.78it/s] 62%|██████▏   | 267/430 [00:03<00:01, 96.61it/s] 64%|██████▍   | 277/430 [00:03<00:01, 96.73it/s] 67%|██████▋   | 287/430 [00:03<00:01, 96.94it/s] 69%|██████▉   | 297/430 [00:03<00:01, 96.79it/s] 71%|███████▏  | 307/430 [00:03<00:01, 96.89it/s] 74%|███████▎  | 317/430 [00:03<00:01, 96.87it/s] 76%|███████▌  | 327/430 [00:04<00:01, 96.91it/s] 78%|███████▊  | 337/430 [00:04<00:00, 96.94it/s] 81%|████████  | 347/430 [00:04<00:00, 96.58it/s] 83%|████████▎ | 357/430 [00:04<00:00, 83.35it/s] 85%|████████▌ | 366/430 [00:04<00:00, 83.77it/s] 87%|████████▋ | 375/430 [00:04<00:00, 82.47it/s] 90%|████████▉ | 385/430 [00:04<00:00, 86.36it/s] 92%|█████████▏| 395/430 [00:04<00:00, 89.20it/s] 94%|█████████▍| 405/430 [00:04<00:00, 90.51it/s] 97%|█████████▋| 415/430 [00:05<00:00, 92.67it/s] 99%|█████████▉| 425/430 [00:05<00:00, 94.14it/s]100%|██████████| 430/430 [00:05<00:00, 82.34it/s]
55000 images processed, 5.271137714385986 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:41,  2.04it/s] 12%|█▏        | 10/86 [00:00<00:03, 21.78it/s] 22%|██▏       | 19/86 [00:00<00:01, 38.12it/s] 34%|███▎      | 29/86 [00:00<00:01, 52.62it/s] 45%|████▌     | 39/86 [00:00<00:00, 63.44it/s] 57%|█████▋    | 49/86 [00:01<00:00, 71.51it/s] 69%|██████▊   | 59/86 [00:01<00:00, 78.04it/s] 80%|████████  | 69/86 [00:01<00:00, 83.46it/s] 92%|█████████▏| 79/86 [00:01<00:00, 87.39it/s]100%|██████████| 86/86 [00:01<00:00, 60.91it/s]
11000 images processed, 1.424567699432373 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:48,  1.87it/s]  5%|▌         | 11/204 [00:00<00:08, 22.08it/s] 10%|▉         | 20/204 [00:00<00:04, 36.87it/s] 15%|█▍        | 30/204 [00:00<00:03, 51.20it/s] 20%|█▉        | 40/204 [00:00<00:02, 62.06it/s] 25%|██▍       | 50/204 [00:01<00:02, 71.03it/s] 29%|██▉       | 60/204 [00:01<00:01, 77.72it/s] 34%|███▍      | 70/204 [00:01<00:01, 82.63it/s] 39%|███▉      | 80/204 [00:01<00:01, 86.12it/s] 44%|████▍     | 90/204 [00:01<00:01, 85.18it/s] 49%|████▊     | 99/204 [00:01<00:01, 86.38it/s] 53%|█████▎    | 108/204 [00:01<00:01, 86.00it/s] 57%|█████▋    | 117/204 [00:01<00:01, 85.22it/s] 62%|██████▏   | 126/204 [00:01<00:00, 85.19it/s] 67%|██████▋   | 136/204 [00:02<00:00, 87.73it/s] 72%|███████▏  | 146/204 [00:02<00:00, 89.82it/s] 76%|███████▋  | 156/204 [00:02<00:00, 89.14it/s] 81%|████████  | 165/204 [00:02<00:00, 87.38it/s] 85%|████████▌ | 174/204 [00:02<00:00, 87.35it/s] 90%|█████████ | 184/204 [00:02<00:00, 90.14it/s] 95%|█████████▌| 194/204 [00:02<00:00, 92.17it/s]100%|██████████| 204/204 [00:02<00:00, 92.56it/s]100%|██████████| 204/204 [00:02<00:00, 73.30it/s]
26032 images processed, 2.8221828937530518 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.59it/s]  8%|▊         | 6/79 [00:00<00:07, 10.43it/s] 20%|██        | 16/79 [00:00<00:02, 28.45it/s] 28%|██▊       | 22/79 [00:01<00:02, 27.74it/s] 41%|████      | 32/79 [00:01<00:01, 41.35it/s] 53%|█████▎    | 42/79 [00:01<00:00, 53.15it/s] 66%|██████▌   | 52/79 [00:01<00:00, 63.17it/s] 78%|███████▊  | 62/79 [00:01<00:00, 71.79it/s] 91%|█████████ | 72/79 [00:01<00:00, 78.56it/s]100%|██████████| 79/79 [00:02<00:00, 31.60it/s]
10000 images processed, 2.5411856174468994 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:54,  1.44it/s] 14%|█▍        | 11/79 [00:00<00:03, 17.97it/s] 24%|██▍       | 19/79 [00:00<00:02, 29.94it/s] 37%|███▋      | 29/79 [00:01<00:01, 44.11it/s] 48%|████▊     | 38/79 [00:01<00:00, 54.37it/s] 59%|█████▉    | 47/79 [00:01<00:00, 61.98it/s] 72%|███████▏  | 57/79 [00:01<00:00, 70.85it/s] 85%|████████▍ | 67/79 [00:01<00:00, 77.96it/s] 97%|█████████▋| 77/79 [00:01<00:00, 83.30it/s]100%|██████████| 79/79 [00:01<00:00, 50.95it/s]
10000 images processed, 1.5695343017578125 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.96it/s] 14%|█▍        | 10/70 [00:00<00:02, 21.09it/s] 29%|██▊       | 20/70 [00:00<00:01, 39.11it/s] 43%|████▎     | 30/70 [00:00<00:00, 53.56it/s] 57%|█████▋    | 40/70 [00:00<00:00, 64.48it/s] 71%|███████▏  | 50/70 [00:01<00:00, 73.40it/s] 86%|████████▌ | 60/70 [00:01<00:00, 80.08it/s]100%|██████████| 70/70 [00:01<00:00, 83.81it/s]100%|██████████| 70/70 [00:01<00:00, 56.12it/s]
8925 images processed, 1.2807719707489014 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:56,  1.28s/it]  4%|▍         | 2/45 [00:01<00:25,  1.71it/s] 16%|█▌        | 7/45 [00:01<00:05,  7.12it/s] 38%|███▊      | 17/45 [00:01<00:01, 17.88it/s] 51%|█████     | 23/45 [00:02<00:01, 16.51it/s] 67%|██████▋   | 30/45 [00:02<00:00, 23.29it/s] 76%|███████▌  | 34/45 [00:02<00:00, 25.22it/s] 87%|████████▋ | 39/45 [00:02<00:00, 20.94it/s]100%|██████████| 45/45 [00:02<00:00, 26.13it/s]100%|██████████| 45/45 [00:02<00:00, 15.93it/s]
5640 images processed, 2.8466601371765137 seconds used

19.382793426513672
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.27  99.75  93.13
places365     39.29  94.49  80.16
LSUN           1.79  99.34  95.61
iSUN          33.71  95.33  85.24
dtd           21.54  96.70  88.03
AVG           19.52  97.12  88.43
[incremental] Overall: 0.9220 New: 0.9220 Old: nan
[incremental] Final(Top-1): 0.9220  Average: 0.9220
1.7393248081207275
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-seen-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:15,  2.19it/s]  3%|▎         | 11/430 [00:00<00:16, 25.20it/s]  5%|▍         | 21/430 [00:00<00:09, 43.57it/s]  7%|▋         | 31/430 [00:00<00:06, 57.75it/s] 10%|▉         | 41/430 [00:00<00:05, 68.46it/s] 12%|█▏        | 51/430 [00:00<00:04, 76.42it/s] 14%|█▍        | 61/430 [00:01<00:04, 82.32it/s] 17%|█▋        | 71/430 [00:01<00:04, 86.51it/s] 19%|█▉        | 81/430 [00:01<00:03, 89.44it/s] 21%|██        | 91/430 [00:01<00:03, 91.31it/s] 23%|██▎       | 101/430 [00:01<00:03, 92.52it/s] 26%|██▌       | 111/430 [00:01<00:03, 93.73it/s] 28%|██▊       | 121/430 [00:01<00:03, 94.69it/s] 30%|███       | 131/430 [00:01<00:03, 95.47it/s] 33%|███▎      | 141/430 [00:01<00:03, 96.00it/s] 35%|███▌      | 151/430 [00:02<00:02, 96.29it/s] 37%|███▋      | 161/430 [00:02<00:02, 96.44it/s] 40%|███▉      | 171/430 [00:02<00:02, 96.59it/s] 42%|████▏     | 181/430 [00:02<00:02, 96.61it/s] 44%|████▍     | 191/430 [00:02<00:02, 96.68it/s] 47%|████▋     | 201/430 [00:02<00:02, 96.43it/s] 49%|████▉     | 211/430 [00:02<00:02, 96.59it/s] 51%|█████▏    | 221/430 [00:02<00:02, 96.79it/s] 54%|█████▎    | 231/430 [00:02<00:02, 96.49it/s] 56%|█████▌    | 241/430 [00:02<00:01, 96.49it/s] 58%|█████▊    | 251/430 [00:03<00:01, 96.49it/s] 61%|██████    | 261/430 [00:03<00:01, 96.35it/s] 63%|██████▎   | 271/430 [00:03<00:01, 96.40it/s] 65%|██████▌   | 281/430 [00:03<00:01, 96.19it/s] 68%|██████▊   | 291/430 [00:03<00:01, 96.25it/s] 70%|███████   | 301/430 [00:03<00:01, 96.34it/s] 72%|███████▏  | 311/430 [00:03<00:01, 96.23it/s] 75%|███████▍  | 321/430 [00:03<00:01, 96.33it/s] 77%|███████▋  | 331/430 [00:03<00:01, 96.56it/s] 79%|███████▉  | 341/430 [00:03<00:00, 95.82it/s] 82%|████████▏ | 351/430 [00:04<00:00, 96.15it/s] 84%|████████▍ | 361/430 [00:04<00:00, 96.27it/s] 86%|████████▋ | 371/430 [00:04<00:00, 96.19it/s] 89%|████████▊ | 381/430 [00:04<00:00, 96.22it/s] 91%|█████████ | 391/430 [00:04<00:00, 96.37it/s] 93%|█████████▎| 401/430 [00:04<00:00, 96.28it/s] 96%|█████████▌| 411/430 [00:04<00:00, 96.84it/s] 98%|█████████▊| 421/430 [00:04<00:00, 97.23it/s]100%|██████████| 430/430 [00:04<00:00, 87.54it/s]
55000 images processed, 5.02360463142395 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:41,  2.04it/s] 12%|█▏        | 10/86 [00:00<00:03, 21.81it/s] 22%|██▏       | 19/86 [00:00<00:01, 37.99it/s] 34%|███▎      | 29/86 [00:00<00:01, 52.69it/s] 45%|████▌     | 39/86 [00:00<00:00, 63.76it/s] 57%|█████▋    | 49/86 [00:01<00:00, 71.88it/s] 69%|██████▊   | 59/86 [00:01<00:00, 77.92it/s] 80%|████████  | 69/86 [00:01<00:00, 82.65it/s] 92%|█████████▏| 79/86 [00:01<00:00, 86.02it/s]100%|██████████| 86/86 [00:01<00:00, 60.55it/s]
11000 images processed, 1.4453210830688477 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-seen-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:53,  1.79it/s]  5%|▍         | 10/204 [00:00<00:09, 19.54it/s]  9%|▉         | 19/204 [00:00<00:05, 35.26it/s] 14%|█▎        | 28/204 [00:00<00:03, 47.92it/s] 19%|█▊        | 38/204 [00:00<00:02, 59.60it/s] 24%|██▎       | 48/204 [00:01<00:02, 69.26it/s] 28%|██▊       | 58/204 [00:01<00:01, 76.46it/s] 33%|███▎      | 68/204 [00:01<00:01, 81.85it/s] 38%|███▊      | 78/204 [00:01<00:01, 85.72it/s] 43%|████▎     | 88/204 [00:01<00:01, 88.50it/s] 48%|████▊     | 98/204 [00:01<00:01, 90.61it/s] 53%|█████▎    | 108/204 [00:01<00:01, 92.05it/s] 58%|█████▊    | 118/204 [00:01<00:00, 92.72it/s] 63%|██████▎   | 128/204 [00:01<00:00, 93.34it/s] 68%|██████▊   | 138/204 [00:02<00:00, 93.70it/s] 73%|███████▎  | 148/204 [00:02<00:00, 93.71it/s] 77%|███████▋  | 158/204 [00:02<00:00, 93.61it/s] 82%|████████▏ | 168/204 [00:02<00:00, 93.52it/s] 87%|████████▋ | 178/204 [00:02<00:00, 93.88it/s] 92%|█████████▏| 188/204 [00:02<00:00, 94.75it/s] 97%|█████████▋| 198/204 [00:02<00:00, 95.42it/s]100%|██████████| 204/204 [00:02<00:00, 74.73it/s]
26032 images processed, 2.7682037353515625 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:51,  1.52it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.85it/s] 27%|██▋       | 21/79 [00:00<00:01, 34.82it/s] 39%|███▉      | 31/79 [00:00<00:00, 48.53it/s] 52%|█████▏    | 41/79 [00:01<00:00, 59.87it/s] 65%|██████▍   | 51/79 [00:01<00:00, 68.93it/s] 77%|███████▋  | 61/79 [00:01<00:00, 76.16it/s] 90%|████████▉ | 71/79 [00:01<00:00, 81.96it/s]100%|██████████| 79/79 [00:01<00:00, 53.20it/s]
10000 images processed, 1.5180647373199463 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.74it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.89it/s] 27%|██▋       | 21/79 [00:00<00:01, 37.67it/s] 39%|███▉      | 31/79 [00:00<00:00, 51.74it/s] 52%|█████▏    | 41/79 [00:01<00:00, 62.95it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.67it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.68it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.92it/s]100%|██████████| 79/79 [00:01<00:00, 56.99it/s]
10000 images processed, 1.4084205627441406 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.77it/s] 16%|█▌        | 11/70 [00:00<00:02, 21.15it/s] 30%|███       | 21/70 [00:00<00:01, 37.92it/s] 44%|████▍     | 31/70 [00:00<00:00, 51.89it/s] 59%|█████▊    | 41/70 [00:00<00:00, 62.92it/s] 73%|███████▎  | 51/70 [00:01<00:00, 72.04it/s] 87%|████████▋ | 61/70 [00:01<00:00, 79.02it/s]100%|██████████| 70/70 [00:01<00:00, 53.99it/s]
8925 images processed, 1.324925184249878 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.04it/s]  4%|▍         | 2/45 [00:01<00:21,  2.03it/s] 27%|██▋       | 12/45 [00:01<00:02, 16.18it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.00it/s] 47%|████▋     | 21/45 [00:01<00:01, 20.87it/s] 69%|██████▉   | 31/45 [00:01<00:00, 35.24it/s] 82%|████████▏ | 37/45 [00:02<00:00, 22.36it/s]100%|██████████| 45/45 [00:02<00:00, 19.96it/s]
5640 images processed, 2.2775561809539795 seconds used

17.399826049804688
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.63  99.39  98.33
places365     72.36  78.17  78.39
LSUN           8.77  97.89  97.95
iSUN          69.12  82.93  86.31
dtd           42.27  89.90  94.17
AVG           39.03  89.65  91.03
Retain-Acc: 0.7296
Forget-as-OOD (retain known vs forget novel):
  FPR: 40.00 AUROC: 89.81 AUIN: 99.37
8.302180051803589
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage1-seen-forget_rf.png
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2', adapter_load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1', forget_classes='0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:168: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:274: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [00:22<18:22, 22.50s/it]  4%|▍         | 2/50 [00:38<15:08, 18.92s/it]  6%|▌         | 3/50 [00:54<13:47, 17.61s/it]  8%|▊         | 4/50 [01:11<13:05, 17.08s/it] 10%|█         | 5/50 [01:26<12:23, 16.52s/it] 12%|█▏        | 6/50 [01:42<11:48, 16.10s/it][loss] ep 0 it 0 total=9.3886 mle=1.6764 pcon=5.2430 forget=1.3836 orth=1.0856 favg=0.0000 nr=107 nf=5 protos=600 fproto_sim=NA
[loss] ep 0 it 50 total=9.2970 mle=1.6132 pcon=5.2296 forget=1.3686 orth=1.0856 favg=0.0000 nr=104 nf=5 protos=600 fproto_sim=NA
[loss] ep 0 it 100 total=9.3962 mle=1.7246 pcon=5.2169 forget=1.3693 orth=1.0854 favg=0.0000 nr=98 nf=9 protos=600 fproto_sim=NA
[loss] ep 0 it 150 total=9.3104 mle=1.6453 pcon=5.2047 forget=1.3752 orth=1.0851 favg=0.0000 nr=102 nf=6 protos=600 fproto_sim=NA
[loss] ep 0 it 200 total=9.0982 mle=1.5055 pcon=5.1924 forget=1.3155 orth=1.0848 favg=0.0000 nr=107 nf=1 protos=600 fproto_sim=NA
[loss] ep 0 it 250 total=9.3090 mle=1.5963 pcon=5.1812 forget=1.4472 orth=1.0843 favg=0.0000 nr=100 nf=8 protos=600 fproto_sim=NA
[loss] ep 0 it 300 total=9.0257 mle=1.4104 pcon=5.1704 forget=1.3611 orth=1.0838 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[loss] ep 0 it 350 total=9.1525 mle=1.5816 pcon=5.1598 forget=1.3279 orth=1.0831 favg=0.0000 nr=101 nf=7 protos=600 fproto_sim=NA
[loss] ep 0 it 400 total=9.1719 mle=1.5676 pcon=5.1499 forget=1.3720 orth=1.0824 favg=0.0000 nr=101 nf=8 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 1 it 20 total=9.1837 mle=1.5957 pcon=5.1403 forget=1.3661 orth=1.0816 favg=0.0000 nr=110 nf=3 protos=600 fproto_sim=NA
[loss] ep 1 it 70 total=9.1372 mle=1.5668 pcon=5.1308 forget=1.3589 orth=1.0807 favg=0.0000 nr=94 nf=4 protos=600 fproto_sim=NA
[loss] ep 1 it 120 total=9.1110 mle=1.4735 pcon=5.1215 forget=1.4363 orth=1.0797 favg=0.0000 nr=107 nf=6 protos=600 fproto_sim=NA
[loss] ep 1 it 170 total=9.0732 mle=1.4689 pcon=5.1126 forget=1.4131 orth=1.0786 favg=0.0000 nr=101 nf=6 protos=600 fproto_sim=NA
[loss] ep 1 it 220 total=9.0287 mle=1.4910 pcon=5.1042 forget=1.3560 orth=1.0775 favg=0.0000 nr=110 nf=6 protos=600 fproto_sim=NA
[loss] ep 1 it 270 total=9.1329 mle=1.5076 pcon=5.0963 forget=1.4528 orth=1.0762 favg=0.0000 nr=105 nf=7 protos=600 fproto_sim=NA
[loss] ep 1 it 320 total=9.1744 mle=1.6711 pcon=5.0883 forget=1.3401 orth=1.0749 favg=0.0000 nr=104 nf=6 protos=600 fproto_sim=NA
[loss] ep 1 it 370 total=9.1170 mle=1.5504 pcon=5.0811 forget=1.4119 orth=1.0735 favg=0.0000 nr=104 nf=6 protos=600 fproto_sim=NA
[loss] ep 1 it 420 total=9.0594 mle=1.5445 pcon=5.0739 forget=1.3690 orth=1.0720 favg=0.0000 nr=103 nf=5 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 2 it 40 total=9.1308 mle=1.5977 pcon=5.0670 forget=1.3956 orth=1.0705 favg=0.0000 nr=108 nf=4 protos=600 fproto_sim=NA
[loss] ep 2 it 90 total=8.9583 mle=1.4622 pcon=5.0603 forget=1.3670 orth=1.0688 favg=0.0000 nr=97 nf=9 protos=600 fproto_sim=NA
[loss] ep 2 it 140 total=9.0468 mle=1.6234 pcon=5.0540 forget=1.3023 orth=1.0671 favg=0.0000 nr=103 nf=3 protos=600 fproto_sim=NA
[loss] ep 2 it 190 total=8.8664 mle=1.4482 pcon=5.0479 forget=1.3050 orth=1.0653 favg=0.0000 nr=113 nf=2 protos=600 fproto_sim=NA
[loss] ep 2 it 240 total=8.9196 mle=1.4781 pcon=5.0418 forget=1.3362 orth=1.0635 favg=0.0000 nr=107 nf=6 protos=600 fproto_sim=NA
[loss] ep 2 it 290 total=8.9252 mle=1.4946 pcon=5.0360 forget=1.3329 orth=1.0616 favg=0.0000 nr=112 nf=3 protos=600 fproto_sim=NA
[loss] ep 2 it 340 total=8.9496 mle=1.5399 pcon=5.0304 forget=1.3196 orth=1.0597 favg=0.0000 nr=100 nf=6 protos=600 fproto_sim=NA
[loss] ep 2 it 390 total=9.0345 mle=1.6168 pcon=5.0253 forget=1.3347 orth=1.0578 favg=0.0000 nr=97 nf=9 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 3 it 10 total=8.8578 mle=1.4622 pcon=5.0201 forget=1.3197 orth=1.0558 favg=0.0000 nr=107 nf=6 protos=600 fproto_sim=NA
[loss] ep 3 it 60 total=8.9679 mle=1.5487 pcon=5.0151 forget=1.3504 orth=1.0537 favg=0.0000 nr=104 nf=6 protos=600 fproto_sim=NA
[loss] ep 3 it 110 total=9.0888 mle=1.7298 pcon=5.0104 forget=1.2969 orth=1.0516 favg=0.0000 nr=107 nf=4 protos=600 fproto_sim=NA
[loss] ep 3 it 160 total=8.9414 mle=1.5753 pcon=5.0054 forget=1.3112 orth=1.0495 favg=0.0000 nr=101 nf=11 protos=600 fproto_sim=NA
[loss] ep 3 it 210 total=9.0982 mle=1.7168 pcon=5.0008 forget=1.3332 orth=1.0473 favg=0.0000 nr=104 nf=6 protos=600 fproto_sim=NA
[loss] ep 3 it 260 total=9.0344 mle=1.6484 pcon=4.9964 forget=1.3444 orth=1.0452 favg=0.0000 nr=108 nf=5 protos=600 fproto_sim=NA
[loss] ep 3 it 310 total=8.8944 mle=1.5633 pcon=4.9921 forget=1.2960 orth=1.0430 favg=0.0000 nr=113 nf=2 protos=600 fproto_sim=NA
[loss] ep 3 it 360 total=8.8223 mle=1.4844 pcon=4.9880 forget=1.3092 orth=1.0408 favg=0.0000 nr=105 nf=7 protos=600 fproto_sim=NA
[loss] ep 3 it 410 total=8.8600 mle=1.4684 pcon=4.9839 forget=1.3693 orth=1.0385 favg=0.0000 nr=102 nf=4 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 4 it 30 total=8.8401 mle=1.4839 pcon=4.9801 forget=1.3399 orth=1.0362 favg=0.0000 nr=108 nf=6 protos=600 fproto_sim=NA
[loss] ep 4 it 80 total=8.9109 mle=1.5892 pcon=4.9763 forget=1.3115 orth=1.0340 favg=0.0000 nr=106 nf=4 protos=600 fproto_sim=NA
[loss] ep 4 it 130 total=8.8691 mle=1.4999 pcon=4.9728 forget=1.3647 orth=1.0316 favg=0.0000 nr=99 nf=8 protos=600 fproto_sim=NA
[loss] ep 4 it 180 total=8.9096 mle=1.5975 pcon=4.9694 forget=1.3135 orth=1.0293 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[loss] ep 4 it 230 total=9.0675 mle=1.6048 pcon=4.9661 forget=1.4697 orth=1.0269 favg=0.0000 nr=107 nf=5 protos=600 fproto_sim=NA
[loss] ep 4 it 280 total=8.8714 mle=1.5142 pcon=4.9627 forget=1.3699 orth=1.0246 favg=0.0000 nr=106 nf=4 protos=600 fproto_sim=NA
[loss] ep 4 it 330 total=8.9212 mle=1.6247 pcon=4.9595 forget=1.3148 orth=1.0222 favg=0.0000 nr=103 nf=8 protos=600 fproto_sim=NA
[loss] ep 4 it 380 total=8.7661 mle=1.4818 pcon=4.9565 forget=1.3080 orth=1.0198 favg=0.0000 nr=100 nf=6 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 5 it 0 total=8.7192 mle=1.4216 pcon=4.9536 forget=1.3266 orth=1.0174 favg=0.0000 nr=106 nf=8 protos=600 fproto_sim=NA
[loss] ep 5 it 50 total=9.0220 mle=1.6828 pcon=4.9508 forget=1.3734 orth=1.0149 favg=0.0000 nr=105 nf=6 protos=600 fproto_sim=NA
[loss] ep 5 it 100 total=8.9153 mle=1.6387 pcon=4.9482 forget=1.3158 orth=1.0125 favg=0.0000 nr=105 nf=6 protos=600 fproto_sim=NA
[loss] ep 5 it 150 total=8.9575 mle=1.5555 pcon=4.9454 forget=1.4466 orth=1.0100 favg=0.0000 nr=103 nf=9 protos=600 fproto_sim=NA
[loss] ep 5 it 200 total=8.6841 mle=1.4103 pcon=4.9428 forget=1.3235 orth=1.0075 favg=0.0000 nr=107 nf=8 protos=600 fproto_sim=NA
[loss] ep 5 it 250 total=8.8878 mle=1.5913 pcon=4.9401 forget=1.3514 orth=1.0050 favg=0.0000 nr=102 nf=5 protos=600 fproto_sim=NA
[loss] ep 5 it 300 total=8.8344 mle=1.5748 pcon=4.9375 forget=1.3197 orth=1.0024 favg=0.0000 nr=99 nf=8 protos=600 fproto_sim=NA
[loss] ep 5 it 350 total=8.7148 mle=1.4728 pcon=4.9349 forget=1.3072 orth=0.9999 favg=0.0000 nr=115 nf=3 protos=600 fproto_sim=NA
[loss] ep 5 it 400 total=8.7446 mle=1.4920 pcon=4.9326 forget=1.3226 orth=0.9974 favg=0.0000 nr=101 nf=9 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
 14%|█▍        | 7/50 [01:57<11:17, 15.77s/it] 16%|█▌        | 8/50 [02:10<10:34, 15.12s/it] 18%|█▊        | 9/50 [02:25<10:09, 14.87s/it] 20%|██        | 10/50 [02:40<10:06, 15.15s/it] 22%|██▏       | 11/50 [02:56<10:01, 15.41s/it] 24%|██▍       | 12/50 [03:13<09:54, 15.64s/it][loss] ep 6 it 20 total=8.8791 mle=1.6322 pcon=4.9303 forget=1.3216 orth=0.9950 favg=0.0000 nr=109 nf=9 protos=600 fproto_sim=NA
[loss] ep 6 it 70 total=8.6914 mle=1.4627 pcon=4.9280 forget=1.3083 orth=0.9925 favg=0.0000 nr=104 nf=6 protos=600 fproto_sim=NA
[loss] ep 6 it 120 total=8.8449 mle=1.6029 pcon=4.9256 forget=1.3265 orth=0.9900 favg=0.0000 nr=107 nf=5 protos=600 fproto_sim=NA
[loss] ep 6 it 170 total=8.6526 mle=1.4332 pcon=4.9236 forget=1.3083 orth=0.9875 favg=0.0000 nr=107 nf=6 protos=600 fproto_sim=NA
[loss] ep 6 it 220 total=8.7607 mle=1.5503 pcon=4.9215 forget=1.3039 orth=0.9849 favg=0.0000 nr=100 nf=5 protos=600 fproto_sim=NA
[loss] ep 6 it 270 total=8.7545 mle=1.5428 pcon=4.9195 forget=1.3097 orth=0.9825 favg=0.0000 nr=98 nf=10 protos=600 fproto_sim=NA
[loss] ep 6 it 320 total=8.7516 mle=1.5313 pcon=4.9174 forget=1.3230 orth=0.9799 favg=0.0000 nr=112 nf=1 protos=600 fproto_sim=NA
[loss] ep 6 it 370 total=8.7961 mle=1.5900 pcon=4.9153 forget=1.3136 orth=0.9772 favg=0.0000 nr=109 nf=6 protos=600 fproto_sim=NA
[loss] ep 6 it 420 total=8.7344 mle=1.5275 pcon=4.9136 forget=1.3187 orth=0.9746 favg=0.0000 nr=104 nf=9 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 7 it 40 total=8.7082 mle=1.5236 pcon=4.9118 forget=1.3007 orth=0.9721 favg=0.0000 nr=104 nf=4 protos=600 fproto_sim=NA
[loss] ep 7 it 90 total=8.7279 mle=1.5536 pcon=4.9100 forget=1.2947 orth=0.9695 favg=0.0000 nr=106 nf=4 protos=600 fproto_sim=NA
[loss] ep 7 it 140 total=8.7673 mle=1.5687 pcon=4.9082 forget=1.3235 orth=0.9669 favg=0.0000 nr=108 nf=1 protos=600 fproto_sim=NA
[loss] ep 7 it 190 total=8.7483 mle=1.5572 pcon=4.9064 forget=1.3204 orth=0.9643 favg=0.0000 nr=107 nf=5 protos=600 fproto_sim=NA
[loss] ep 7 it 240 total=8.6475 mle=1.4617 pcon=4.9048 forget=1.3192 orth=0.9617 favg=0.0000 nr=105 nf=7 protos=600 fproto_sim=NA
[loss] ep 7 it 290 total=8.6733 mle=1.5100 pcon=4.9030 forget=1.3011 orth=0.9592 favg=0.0000 nr=108 nf=3 protos=600 fproto_sim=NA
[loss] ep 7 it 340 total=8.7664 mle=1.5849 pcon=4.9012 forget=1.3237 orth=0.9566 favg=0.0000 nr=104 nf=3 protos=600 fproto_sim=NA
[loss] ep 7 it 390 total=8.6546 mle=1.4767 pcon=4.8996 forget=1.3243 orth=0.9540 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 8 it 10 total=8.8109 mle=1.6415 pcon=4.8982 forget=1.3198 orth=0.9514 favg=0.0000 nr=108 nf=9 protos=600 fproto_sim=NA
[loss] ep 8 it 60 total=8.7199 mle=1.5715 pcon=4.8966 forget=1.3030 orth=0.9488 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[loss] ep 8 it 110 total=8.8630 mle=1.5886 pcon=4.8951 forget=1.4330 orth=0.9463 favg=0.0000 nr=99 nf=8 protos=600 fproto_sim=NA
[loss] ep 8 it 160 total=8.7665 mle=1.6237 pcon=4.8936 forget=1.3055 orth=0.9438 favg=0.0000 nr=110 nf=3 protos=600 fproto_sim=NA
[loss] ep 8 it 210 total=8.6593 mle=1.5177 pcon=4.8921 forget=1.3083 orth=0.9412 favg=0.0000 nr=102 nf=7 protos=600 fproto_sim=NA
[loss] ep 8 it 260 total=8.6497 mle=1.5117 pcon=4.8906 forget=1.3088 orth=0.9387 favg=0.0000 nr=101 nf=9 protos=600 fproto_sim=NA
[loss] ep 8 it 310 total=8.7353 mle=1.6031 pcon=4.8892 forget=1.3068 orth=0.9362 favg=0.0000 nr=99 nf=3 protos=600 fproto_sim=NA
[loss] ep 8 it 360 total=8.6225 mle=1.5018 pcon=4.8880 forget=1.2989 orth=0.9337 favg=0.0000 nr=100 nf=4 protos=600 fproto_sim=NA
[loss] ep 8 it 410 total=8.6454 mle=1.5268 pcon=4.8868 forget=1.3005 orth=0.9312 favg=0.0000 nr=108 nf=4 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 9 it 30 total=8.6678 mle=1.5212 pcon=4.8855 forget=1.3324 orth=0.9287 favg=0.0000 nr=99 nf=7 protos=600 fproto_sim=NA
[loss] ep 9 it 80 total=8.6624 mle=1.5486 pcon=4.8844 forget=1.3032 orth=0.9262 favg=0.0000 nr=112 nf=2 protos=600 fproto_sim=NA
[loss] ep 9 it 130 total=8.7296 mle=1.6228 pcon=4.8832 forget=1.2999 orth=0.9237 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
[loss] ep 9 it 180 total=8.6331 mle=1.5260 pcon=4.8822 forget=1.3036 orth=0.9212 favg=0.0000 nr=111 nf=2 protos=600 fproto_sim=NA
[loss] ep 9 it 230 total=8.6571 mle=1.5514 pcon=4.8810 forget=1.3059 orth=0.9188 favg=0.0000 nr=101 nf=8 protos=600 fproto_sim=NA
[loss] ep 9 it 280 total=8.5271 mle=1.4156 pcon=4.8799 forget=1.3153 orth=0.9162 favg=0.0000 nr=102 nf=4 protos=600 fproto_sim=NA
[loss] ep 9 it 330 total=8.7286 mle=1.6025 pcon=4.8788 forget=1.3336 orth=0.9137 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
[loss] ep 9 it 380 total=8.7150 mle=1.6261 pcon=4.8777 forget=1.3000 orth=0.9112 favg=0.0000 nr=104 nf=7 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 10 it 0 total=8.7069 mle=1.6147 pcon=4.8766 forget=1.3070 orth=0.9086 favg=0.0000 nr=114 nf=2 protos=600 fproto_sim=NA
[loss] ep 10 it 50 total=8.5204 mle=1.4236 pcon=4.8754 forget=1.3153 orth=0.9060 favg=0.0000 nr=101 nf=9 protos=600 fproto_sim=NA
[loss] ep 10 it 100 total=8.7491 mle=1.6481 pcon=4.8743 forget=1.3232 orth=0.9035 favg=0.0000 nr=97 nf=5 protos=600 fproto_sim=NA
[loss] ep 10 it 150 total=8.8021 mle=1.7007 pcon=4.8732 forget=1.3271 orth=0.9010 favg=0.0000 nr=110 nf=6 protos=600 fproto_sim=NA
[loss] ep 10 it 200 total=8.8212 mle=1.7303 pcon=4.8722 forget=1.3201 orth=0.8985 favg=0.0000 nr=105 nf=9 protos=600 fproto_sim=NA
[loss] ep 10 it 250 total=8.6361 mle=1.5588 pcon=4.8713 forget=1.3100 orth=0.8959 favg=0.0000 nr=103 nf=7 protos=600 fproto_sim=NA
[loss] ep 10 it 300 total=8.7477 mle=1.6783 pcon=4.8700 forget=1.3060 orth=0.8935 favg=0.0000 nr=108 nf=5 protos=600 fproto_sim=NA
[loss] ep 10 it 350 total=8.7233 mle=1.6378 pcon=4.8689 forget=1.3257 orth=0.8908 favg=0.0000 nr=107 nf=6 protos=600 fproto_sim=NA
[loss] ep 10 it 400 total=8.6801 mle=1.6143 pcon=4.8681 forget=1.3094 orth=0.8882 favg=0.0000 nr=116 nf=4 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 11 it 20 total=8.6464 mle=1.5768 pcon=4.8673 forget=1.3166 orth=0.8856 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[loss] ep 11 it 70 total=8.6366 mle=1.5653 pcon=4.8662 forget=1.3220 orth=0.8831 favg=0.0000 nr=106 nf=2 protos=600 fproto_sim=NA
[loss] ep 11 it 120 total=8.6616 mle=1.6076 pcon=4.8654 forget=1.3081 orth=0.8805 favg=0.0000 nr=102 nf=5 protos=600 fproto_sim=NA
[loss] ep 11 it 170 total=8.7227 mle=1.6693 pcon=4.8645 forget=1.3110 orth=0.8779 favg=0.0000 nr=99 nf=7 protos=600 fproto_sim=NA
[loss] ep 11 it 220 total=8.6960 mle=1.6320 pcon=4.8636 forget=1.3253 orth=0.8751 favg=0.0000 nr=99 nf=11 protos=600 fproto_sim=NA
[loss] ep 11 it 270 total=8.6001 mle=1.5305 pcon=4.8628 forget=1.3344 orth=0.8723 favg=0.0000 nr=109 nf=5 protos=600 fproto_sim=NA
[loss] ep 11 it 320 total=8.5413 mle=1.5094 pcon=4.8619 forget=1.3004 orth=0.8695 favg=0.0000 nr=104 nf=1 protos=600 fproto_sim=NA
[loss] ep 11 it 370 total=8.5853 mle=1.5465 pcon=4.8612 forget=1.3109 orth=0.8667 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
[loss] ep 11 it 420 total=8.5998 mle=1.5523 pcon=4.8605 forget=1.3232 orth=0.8638 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
 26%|██▌       | 13/50 [03:29<09:46, 15.85s/it] 28%|██▊       | 14/50 [03:46<09:42, 16.18s/it] 30%|███       | 15/50 [04:01<09:19, 15.99s/it] 32%|███▏      | 16/50 [04:18<09:08, 16.13s/it] 34%|███▍      | 17/50 [04:34<08:48, 16.03s/it] 36%|███▌      | 18/50 [04:51<08:48, 16.53s/it][loss] ep 12 it 40 total=8.6577 mle=1.6305 pcon=4.8598 forget=1.3067 orth=0.8608 favg=0.0000 nr=98 nf=2 protos=600 fproto_sim=NA
[loss] ep 12 it 90 total=8.6378 mle=1.5739 pcon=4.8588 forget=1.3473 orth=0.8577 favg=0.0000 nr=109 nf=3 protos=600 fproto_sim=NA
[loss] ep 12 it 140 total=8.5562 mle=1.5252 pcon=4.8582 forget=1.3182 orth=0.8546 favg=0.0000 nr=103 nf=10 protos=600 fproto_sim=NA
[loss] ep 12 it 190 total=8.6135 mle=1.5886 pcon=4.8574 forget=1.3162 orth=0.8513 favg=0.0000 nr=109 nf=6 protos=600 fproto_sim=NA
[loss] ep 12 it 240 total=8.5917 mle=1.5592 pcon=4.8566 forget=1.3279 orth=0.8480 favg=0.0000 nr=98 nf=9 protos=600 fproto_sim=NA
[loss] ep 12 it 290 total=8.5849 mle=1.5584 pcon=4.8562 forget=1.3257 orth=0.8445 favg=0.0000 nr=105 nf=10 protos=600 fproto_sim=NA
[loss] ep 12 it 340 total=8.6882 mle=1.6002 pcon=4.8558 forget=1.3913 orth=0.8409 favg=0.0000 nr=109 nf=3 protos=600 fproto_sim=NA
[loss] ep 12 it 390 total=8.6014 mle=1.5880 pcon=4.8552 forget=1.3210 orth=0.8371 favg=0.0000 nr=107 nf=4 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 13 it 10 total=8.5814 mle=1.5737 pcon=4.8546 forget=1.3200 orth=0.8332 favg=0.0000 nr=108 nf=4 protos=600 fproto_sim=NA
[loss] ep 13 it 60 total=8.6929 mle=1.6363 pcon=4.8538 forget=1.3737 orth=0.8291 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
[loss] ep 13 it 110 total=8.6225 mle=1.6143 pcon=4.8530 forget=1.3303 orth=0.8249 favg=0.0000 nr=106 nf=7 protos=600 fproto_sim=NA
[loss] ep 13 it 160 total=8.6141 mle=1.6163 pcon=4.8524 forget=1.3249 orth=0.8205 favg=0.0000 nr=104 nf=5 protos=600 fproto_sim=NA
[loss] ep 13 it 210 total=8.5270 mle=1.5341 pcon=4.8519 forget=1.3252 orth=0.8158 favg=0.0000 nr=109 nf=6 protos=600 fproto_sim=NA
[loss] ep 13 it 260 total=8.5009 mle=1.5066 pcon=4.8511 forget=1.3321 orth=0.8110 favg=0.0000 nr=106 nf=4 protos=600 fproto_sim=NA
[loss] ep 13 it 310 total=8.6594 mle=1.6405 pcon=4.8506 forget=1.3623 orth=0.8060 favg=0.0000 nr=97 nf=7 protos=600 fproto_sim=NA
[loss] ep 13 it 360 total=8.5452 mle=1.5509 pcon=4.8498 forget=1.3437 orth=0.8007 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[loss] ep 13 it 410 total=8.6485 mle=1.6728 pcon=4.8491 forget=1.3312 orth=0.7953 favg=0.0000 nr=111 nf=3 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 14 it 30 total=8.6226 mle=1.6315 pcon=4.8486 forget=1.3529 orth=0.7897 favg=0.0000 nr=104 nf=9 protos=600 fproto_sim=NA
[loss] ep 14 it 80 total=8.5850 mle=1.6131 pcon=4.8479 forget=1.3403 orth=0.7838 favg=0.0000 nr=101 nf=11 protos=600 fproto_sim=NA
[loss] ep 14 it 130 total=8.5692 mle=1.6058 pcon=4.8474 forget=1.3385 orth=0.7776 favg=0.0000 nr=110 nf=6 protos=600 fproto_sim=NA
[loss] ep 14 it 180 total=8.4464 mle=1.4943 pcon=4.8465 forget=1.3345 orth=0.7712 favg=0.0000 nr=99 nf=17 protos=600 fproto_sim=NA
[loss] ep 14 it 230 total=8.5334 mle=1.5866 pcon=4.8460 forget=1.3362 orth=0.7645 favg=0.0000 nr=108 nf=3 protos=600 fproto_sim=NA
[loss] ep 14 it 280 total=8.5505 mle=1.5533 pcon=4.8451 forget=1.3944 orth=0.7576 favg=0.0000 nr=106 nf=7 protos=600 fproto_sim=NA
[loss] ep 14 it 330 total=8.4976 mle=1.5610 pcon=4.8446 forget=1.3416 orth=0.7504 favg=0.0000 nr=110 nf=7 protos=600 fproto_sim=NA
[loss] ep 14 it 380 total=8.5859 mle=1.6111 pcon=4.8441 forget=1.3879 orth=0.7429 favg=0.0000 nr=105 nf=5 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 15 it 0 total=8.5317 mle=1.5965 pcon=4.8434 forget=1.3566 orth=0.7351 favg=0.0000 nr=103 nf=4 protos=600 fproto_sim=NA
[loss] ep 15 it 50 total=8.4890 mle=1.5762 pcon=4.8428 forget=1.3429 orth=0.7271 favg=0.0000 nr=93 nf=10 protos=600 fproto_sim=NA
[loss] ep 15 it 100 total=8.5117 mle=1.5935 pcon=4.8422 forget=1.3572 orth=0.7187 favg=0.0000 nr=104 nf=9 protos=600 fproto_sim=NA
[loss] ep 15 it 150 total=8.4589 mle=1.5660 pcon=4.8416 forget=1.3412 orth=0.7102 favg=0.0000 nr=106 nf=9 protos=600 fproto_sim=NA
[loss] ep 15 it 200 total=8.5604 mle=1.6771 pcon=4.8411 forget=1.3409 orth=0.7014 favg=0.0000 nr=107 nf=2 protos=600 fproto_sim=NA
[loss] ep 15 it 250 total=8.3964 mle=1.5180 pcon=4.8405 forget=1.3456 orth=0.6923 favg=0.0000 nr=103 nf=7 protos=600 fproto_sim=NA
[loss] ep 15 it 300 total=8.4368 mle=1.5770 pcon=4.8400 forget=1.3370 orth=0.6829 favg=0.0000 nr=106 nf=4 protos=600 fproto_sim=NA
[loss] ep 15 it 350 total=8.3499 mle=1.4799 pcon=4.8394 forget=1.3572 orth=0.6733 favg=0.0000 nr=97 nf=9 protos=600 fproto_sim=NA
[loss] ep 15 it 400 total=8.4583 mle=1.6118 pcon=4.8389 forget=1.3441 orth=0.6635 favg=0.0000 nr=100 nf=9 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 16 it 20 total=8.5275 mle=1.6911 pcon=4.8384 forget=1.3446 orth=0.6534 favg=0.0000 nr=108 nf=3 protos=600 fproto_sim=NA
[loss] ep 16 it 70 total=8.4362 mle=1.6126 pcon=4.8380 forget=1.3425 orth=0.6431 favg=0.0000 nr=112 nf=3 protos=600 fproto_sim=NA
[loss] ep 16 it 120 total=8.3769 mle=1.5648 pcon=4.8376 forget=1.3418 orth=0.6326 favg=0.0000 nr=111 nf=2 protos=600 fproto_sim=NA
[loss] ep 16 it 170 total=7.1095 mle=1.6504 pcon=4.8372 forget=0.0000 orth=0.6220 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 220 total=8.5103 mle=1.6945 pcon=4.8364 forget=1.3682 orth=0.6112 favg=0.0000 nr=95 nf=8 protos=600 fproto_sim=NA
[loss] ep 16 it 270 total=8.3293 mle=1.5479 pcon=4.8360 forget=1.3452 orth=0.6002 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[loss] ep 16 it 320 total=8.3660 mle=1.5897 pcon=4.8354 forget=1.3518 orth=0.5891 favg=0.0000 nr=102 nf=6 protos=600 fproto_sim=NA
[loss] ep 16 it 370 total=8.4296 mle=1.6704 pcon=4.8348 forget=1.3466 orth=0.5779 favg=0.0000 nr=109 nf=6 protos=600 fproto_sim=NA
[loss] ep 16 it 420 total=8.3488 mle=1.5984 pcon=4.8345 forget=1.3494 orth=0.5665 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 17 it 40 total=8.4475 mle=1.6707 pcon=4.8341 forget=1.3873 orth=0.5554 favg=0.0000 nr=102 nf=6 protos=600 fproto_sim=NA
[loss] ep 17 it 90 total=8.4430 mle=1.7196 pcon=4.8338 forget=1.3455 orth=0.5441 favg=0.0000 nr=111 nf=2 protos=600 fproto_sim=NA
[loss] ep 17 it 140 total=8.2971 mle=1.5795 pcon=4.8332 forget=1.3517 orth=0.5326 favg=0.0000 nr=103 nf=8 protos=600 fproto_sim=NA
[loss] ep 17 it 190 total=8.4208 mle=1.6787 pcon=4.8326 forget=1.3885 orth=0.5210 favg=0.0000 nr=98 nf=7 protos=600 fproto_sim=NA
[loss] ep 17 it 240 total=8.2489 mle=1.5587 pcon=4.8321 forget=1.3488 orth=0.5094 favg=0.0000 nr=107 nf=5 protos=600 fproto_sim=NA
[loss] ep 17 it 290 total=8.3478 mle=1.6427 pcon=4.8318 forget=1.3755 orth=0.4978 favg=0.0000 nr=103 nf=3 protos=600 fproto_sim=NA
[loss] ep 17 it 340 total=8.2744 mle=1.6070 pcon=4.8314 forget=1.3499 orth=0.4862 favg=0.0000 nr=102 nf=5 protos=600 fproto_sim=NA
[loss] ep 17 it 390 total=8.2233 mle=1.5563 pcon=4.8311 forget=1.3612 orth=0.4746 favg=0.0000 nr=96 nf=9 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 18 it 10 total=8.2330 mle=1.5585 pcon=4.8309 forget=1.3806 orth=0.4631 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
 38%|███▊      | 19/50 [05:07<08:23, 16.24s/it] 40%|████      | 20/50 [05:24<08:10, 16.35s/it] 42%|████▏     | 21/50 [05:40<07:53, 16.33s/it] 44%|████▍     | 22/50 [05:57<07:43, 16.56s/it] 46%|████▌     | 23/50 [06:15<07:35, 16.87s/it] 48%|████▊     | 24/50 [06:30<07:09, 16.52s/it][loss] ep 18 it 60 total=8.2374 mle=1.5681 pcon=4.8306 forget=1.3871 orth=0.4516 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[loss] ep 18 it 110 total=8.2524 mle=1.6192 pcon=4.8302 forget=1.3627 orth=0.4402 favg=0.0000 nr=109 nf=4 protos=600 fproto_sim=NA
[loss] ep 18 it 160 total=8.2011 mle=1.5935 pcon=4.8298 forget=1.3489 orth=0.4289 favg=0.0000 nr=110 nf=6 protos=600 fproto_sim=NA
[loss] ep 18 it 210 total=8.1736 mle=1.5737 pcon=4.8297 forget=1.3526 orth=0.4176 favg=0.0000 nr=109 nf=6 protos=600 fproto_sim=NA
[loss] ep 18 it 260 total=8.3147 mle=1.7271 pcon=4.8295 forget=1.3516 orth=0.4065 favg=0.0000 nr=103 nf=10 protos=600 fproto_sim=NA
[loss] ep 18 it 310 total=8.1600 mle=1.5668 pcon=4.8291 forget=1.3687 orth=0.3955 favg=0.0000 nr=107 nf=7 protos=600 fproto_sim=NA
[loss] ep 18 it 360 total=8.1705 mle=1.5945 pcon=4.8288 forget=1.3627 orth=0.3846 favg=0.0000 nr=108 nf=7 protos=600 fproto_sim=NA
[loss] ep 18 it 410 total=8.1961 mle=1.6319 pcon=4.8283 forget=1.3622 orth=0.3737 favg=0.0000 nr=97 nf=9 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 19 it 30 total=8.1882 mle=1.6268 pcon=4.8280 forget=1.3703 orth=0.3631 favg=0.0000 nr=102 nf=9 protos=600 fproto_sim=NA
[loss] ep 19 it 80 total=8.2273 mle=1.6879 pcon=4.8279 forget=1.3590 orth=0.3525 favg=0.0000 nr=106 nf=7 protos=600 fproto_sim=NA
[loss] ep 19 it 130 total=8.1761 mle=1.6491 pcon=4.8276 forget=1.3572 orth=0.3421 favg=0.0000 nr=101 nf=9 protos=600 fproto_sim=NA
[loss] ep 19 it 180 total=8.0894 mle=1.5800 pcon=4.8274 forget=1.3501 orth=0.3319 favg=0.0000 nr=110 nf=3 protos=600 fproto_sim=NA
[loss] ep 19 it 230 total=8.0942 mle=1.5892 pcon=4.8272 forget=1.3560 orth=0.3219 favg=0.0000 nr=108 nf=6 protos=600 fproto_sim=NA
[loss] ep 19 it 280 total=8.0646 mle=1.5552 pcon=4.8271 forget=1.3703 orth=0.3120 favg=0.0000 nr=105 nf=7 protos=600 fproto_sim=NA
[loss] ep 19 it 330 total=8.1752 mle=1.6873 pcon=4.8268 forget=1.3588 orth=0.3023 favg=0.0000 nr=99 nf=6 protos=600 fproto_sim=NA
[loss] ep 19 it 380 total=8.0185 mle=1.5335 pcon=4.8266 forget=1.3658 orth=0.2927 favg=0.0000 nr=101 nf=7 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 20 it 0 total=7.9208 mle=1.4355 pcon=4.8263 forget=1.3755 orth=0.2834 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[loss] ep 20 it 50 total=8.1079 mle=1.6459 pcon=4.8262 forget=1.3616 orth=0.2742 favg=0.0000 nr=97 nf=8 protos=600 fproto_sim=NA
[loss] ep 20 it 100 total=8.0811 mle=1.6229 pcon=4.8260 forget=1.3668 orth=0.2653 favg=0.0000 nr=100 nf=8 protos=600 fproto_sim=NA
[loss] ep 20 it 150 total=8.0207 mle=1.5707 pcon=4.8259 forget=1.3676 orth=0.2566 favg=0.0000 nr=99 nf=9 protos=600 fproto_sim=NA
[loss] ep 20 it 200 total=8.0570 mle=1.6056 pcon=4.8257 forget=1.3777 orth=0.2480 favg=0.0000 nr=101 nf=7 protos=600 fproto_sim=NA
[loss] ep 20 it 250 total=8.1038 mle=1.6763 pcon=4.8256 forget=1.3623 orth=0.2396 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[loss] ep 20 it 300 total=7.9500 mle=1.5336 pcon=4.8253 forget=1.3595 orth=0.2315 favg=0.0000 nr=105 nf=4 protos=600 fproto_sim=NA
[loss] ep 20 it 350 total=8.0696 mle=1.6465 pcon=4.8251 forget=1.3744 orth=0.2236 favg=0.0000 nr=109 nf=4 protos=600 fproto_sim=NA
[loss] ep 20 it 400 total=8.0788 mle=1.6675 pcon=4.8251 forget=1.3704 orth=0.2159 favg=0.0000 nr=104 nf=2 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 21 it 20 total=7.9965 mle=1.5912 pcon=4.8249 forget=1.3721 orth=0.2084 favg=0.0000 nr=111 nf=5 protos=600 fproto_sim=NA
[loss] ep 21 it 70 total=7.9896 mle=1.5842 pcon=4.8247 forget=1.3796 orth=0.2011 favg=0.0000 nr=100 nf=9 protos=600 fproto_sim=NA
[loss] ep 21 it 120 total=8.0261 mle=1.6405 pcon=4.8247 forget=1.3668 orth=0.1940 favg=0.0000 nr=100 nf=7 protos=600 fproto_sim=NA
[loss] ep 21 it 170 total=8.0800 mle=1.7032 pcon=4.8248 forget=1.3649 orth=0.1871 favg=0.0000 nr=100 nf=8 protos=600 fproto_sim=NA
[loss] ep 21 it 220 total=7.9957 mle=1.6175 pcon=4.8247 forget=1.3731 orth=0.1805 favg=0.0000 nr=106 nf=9 protos=600 fproto_sim=NA
[loss] ep 21 it 270 total=8.0290 mle=1.6588 pcon=4.8248 forget=1.3713 orth=0.1741 favg=0.0000 nr=102 nf=6 protos=600 fproto_sim=NA
[loss] ep 21 it 320 total=7.9397 mle=1.5775 pcon=4.8248 forget=1.3695 orth=0.1679 favg=0.0000 nr=102 nf=6 protos=600 fproto_sim=NA
[loss] ep 21 it 370 total=8.0068 mle=1.6561 pcon=4.8246 forget=1.3641 orth=0.1619 favg=0.0000 nr=112 nf=3 protos=600 fproto_sim=NA
[loss] ep 21 it 420 total=7.9455 mle=1.5960 pcon=4.8244 forget=1.3689 orth=0.1561 favg=0.0000 nr=103 nf=8 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 22 it 40 total=7.9264 mle=1.5838 pcon=4.8244 forget=1.3677 orth=0.1505 favg=0.0000 nr=92 nf=2 protos=600 fproto_sim=NA
[loss] ep 22 it 90 total=8.0408 mle=1.7104 pcon=4.8243 forget=1.3610 orth=0.1451 favg=0.0000 nr=102 nf=5 protos=600 fproto_sim=NA
[loss] ep 22 it 140 total=7.8629 mle=1.5397 pcon=4.8242 forget=1.3589 orth=0.1400 favg=0.0000 nr=104 nf=9 protos=600 fproto_sim=NA
[loss] ep 22 it 190 total=7.8855 mle=1.5647 pcon=4.8243 forget=1.3615 orth=0.1350 favg=0.0000 nr=105 nf=6 protos=600 fproto_sim=NA
[loss] ep 22 it 240 total=7.8883 mle=1.5669 pcon=4.8242 forget=1.3671 orth=0.1302 favg=0.0000 nr=102 nf=3 protos=600 fproto_sim=NA
[loss] ep 22 it 290 total=7.8688 mle=1.5550 pcon=4.8240 forget=1.3642 orth=0.1256 favg=0.0000 nr=108 nf=8 protos=600 fproto_sim=NA
[loss] ep 22 it 340 total=7.9454 mle=1.6426 pcon=4.8241 forget=1.3576 orth=0.1211 favg=0.0000 nr=108 nf=5 protos=600 fproto_sim=NA
[loss] ep 22 it 390 total=7.9356 mle=1.6421 pcon=4.8241 forget=1.3526 orth=0.1168 favg=0.0000 nr=108 nf=5 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 23 it 10 total=7.9079 mle=1.5371 pcon=4.8239 forget=1.4342 orth=0.1128 favg=0.0000 nr=112 nf=2 protos=600 fproto_sim=NA
[loss] ep 23 it 60 total=7.8200 mle=1.5296 pcon=4.8238 forget=1.3578 orth=0.1088 favg=0.0000 nr=108 nf=7 protos=600 fproto_sim=NA
[loss] ep 23 it 110 total=7.9753 mle=1.6803 pcon=4.8236 forget=1.3663 orth=0.1051 favg=0.0000 nr=98 nf=4 protos=600 fproto_sim=NA
[loss] ep 23 it 160 total=7.9389 mle=1.4950 pcon=4.8235 forget=1.5190 orth=0.1015 favg=0.0000 nr=109 nf=4 protos=600 fproto_sim=NA
[loss] ep 23 it 210 total=7.8551 mle=1.5853 pcon=4.8235 forget=1.3484 orth=0.0980 favg=0.0000 nr=111 nf=4 protos=600 fproto_sim=NA
[loss] ep 23 it 260 total=7.8802 mle=1.6135 pcon=4.8235 forget=1.3484 orth=0.0947 favg=0.0000 nr=111 nf=2 protos=600 fproto_sim=NA
[loss] ep 23 it 310 total=7.9825 mle=1.7254 pcon=4.8234 forget=1.3422 orth=0.0915 favg=0.0000 nr=101 nf=5 protos=600 fproto_sim=NA
[loss] ep 23 it 360 total=7.9911 mle=1.7258 pcon=4.8234 forget=1.3535 orth=0.0884 favg=0.0000 nr=102 nf=5 protos=600 fproto_sim=NA
[loss] ep 23 it 410 total=7.8154 mle=1.5662 pcon=4.8231 forget=1.3406 orth=0.0855 favg=0.0000 nr=98 nf=10 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 24 it 30 total=7.8287 mle=1.5807 pcon=4.8228 forget=1.3424 orth=0.0827 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
 50%|█████     | 25/50 [06:47<06:52, 16.50s/it] 52%|█████▏    | 26/50 [07:03<06:32, 16.37s/it] 54%|█████▍    | 27/50 [07:19<06:13, 16.26s/it] 56%|█████▌    | 28/50 [07:35<05:55, 16.18s/it] 58%|█████▊    | 29/50 [07:50<05:33, 15.86s/it] 60%|██████    | 30/50 [08:04<05:09, 15.47s/it][loss] ep 24 it 80 total=7.9091 mle=1.6495 pcon=4.8226 forget=1.3571 orth=0.0800 favg=0.0000 nr=108 nf=5 protos=600 fproto_sim=NA
[loss] ep 24 it 130 total=7.8834 mle=1.6438 pcon=4.8224 forget=1.3398 orth=0.0775 favg=0.0000 nr=107 nf=10 protos=600 fproto_sim=NA
[loss] ep 24 it 180 total=7.8828 mle=1.6539 pcon=4.8223 forget=1.3316 orth=0.0750 favg=0.0000 nr=105 nf=8 protos=600 fproto_sim=NA
[loss] ep 24 it 230 total=7.7613 mle=1.5389 pcon=4.8222 forget=1.3276 orth=0.0727 favg=0.0000 nr=103 nf=7 protos=600 fproto_sim=NA
[loss] ep 24 it 280 total=7.7666 mle=1.5513 pcon=4.8220 forget=1.3229 orth=0.0704 favg=0.0000 nr=104 nf=7 protos=600 fproto_sim=NA
[loss] ep 24 it 330 total=7.9186 mle=1.6962 pcon=4.8219 forget=1.3322 orth=0.0683 favg=0.0000 nr=107 nf=8 protos=600 fproto_sim=NA
[loss] ep 24 it 380 total=7.8893 mle=1.5859 pcon=4.8220 forget=1.4152 orth=0.0662 favg=0.0000 nr=102 nf=7 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 25 it 0 total=7.8233 mle=1.6179 pcon=4.8219 forget=1.3193 orth=0.0642 favg=0.0000 nr=111 nf=4 protos=600 fproto_sim=NA
[loss] ep 25 it 50 total=7.7617 mle=1.5588 pcon=4.8219 forget=1.3187 orth=0.0623 favg=0.0000 nr=101 nf=12 protos=600 fproto_sim=NA
[loss] ep 25 it 100 total=7.9096 mle=1.7069 pcon=4.8216 forget=1.3206 orth=0.0605 favg=0.0000 nr=112 nf=4 protos=600 fproto_sim=NA
[loss] ep 25 it 150 total=7.8042 mle=1.5841 pcon=4.8213 forget=1.3401 orth=0.0588 favg=0.0000 nr=103 nf=7 protos=600 fproto_sim=NA
[loss] ep 25 it 200 total=7.8302 mle=1.6426 pcon=4.8213 forget=1.3093 orth=0.0571 favg=0.0000 nr=103 nf=5 protos=600 fproto_sim=NA
[loss] ep 25 it 250 total=7.8152 mle=1.6301 pcon=4.8210 forget=1.3087 orth=0.0555 favg=0.0000 nr=108 nf=4 protos=600 fproto_sim=NA
[loss] ep 25 it 300 total=7.7648 mle=1.5821 pcon=4.8208 forget=1.3080 orth=0.0540 favg=0.0000 nr=97 nf=5 protos=600 fproto_sim=NA
[loss] ep 25 it 350 total=7.7576 mle=1.5906 pcon=4.8207 forget=1.2938 orth=0.0525 favg=0.0000 nr=109 nf=2 protos=600 fproto_sim=NA
[loss] ep 25 it 400 total=7.8837 mle=1.7010 pcon=4.8204 forget=1.3111 orth=0.0511 favg=0.0000 nr=100 nf=7 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 26 it 20 total=7.8224 mle=1.6515 pcon=4.8203 forget=1.3008 orth=0.0498 favg=0.0000 nr=106 nf=4 protos=600 fproto_sim=NA
[loss] ep 26 it 70 total=8.0207 mle=1.8034 pcon=4.8201 forget=1.3486 orth=0.0485 favg=0.0000 nr=103 nf=5 protos=600 fproto_sim=NA
[loss] ep 26 it 120 total=7.6776 mle=1.5138 pcon=4.8200 forget=1.2966 orth=0.0472 favg=0.0000 nr=102 nf=7 protos=600 fproto_sim=NA
[loss] ep 26 it 170 total=7.7741 mle=1.5856 pcon=4.8197 forget=1.3227 orth=0.0461 favg=0.0000 nr=106 nf=8 protos=600 fproto_sim=NA
[loss] ep 26 it 220 total=7.8220 mle=1.6647 pcon=4.8196 forget=1.2929 orth=0.0449 favg=0.0000 nr=108 nf=6 protos=600 fproto_sim=NA
[loss] ep 26 it 270 total=7.7229 mle=1.5641 pcon=4.8193 forget=1.2955 orth=0.0439 favg=0.0000 nr=107 nf=3 protos=600 fproto_sim=NA
[loss] ep 26 it 320 total=7.8458 mle=1.6724 pcon=4.8191 forget=1.3115 orth=0.0428 favg=0.0000 nr=106 nf=2 protos=600 fproto_sim=NA
[loss] ep 26 it 370 total=7.7860 mle=1.6293 pcon=4.8191 forget=1.2958 orth=0.0418 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[loss] ep 26 it 420 total=7.6761 mle=1.5241 pcon=4.8188 forget=1.2923 orth=0.0409 favg=0.0000 nr=108 nf=3 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 27 it 40 total=7.7988 mle=1.6367 pcon=4.8187 forget=1.3035 orth=0.0399 favg=0.0000 nr=111 nf=4 protos=600 fproto_sim=NA
[loss] ep 27 it 90 total=7.8180 mle=1.6634 pcon=4.8185 forget=1.2971 orth=0.0391 favg=0.0000 nr=104 nf=10 protos=600 fproto_sim=NA
[loss] ep 27 it 140 total=7.7554 mle=1.6063 pcon=4.8184 forget=1.2926 orth=0.0382 favg=0.0000 nr=105 nf=8 protos=600 fproto_sim=NA
[loss] ep 27 it 190 total=7.7621 mle=1.6183 pcon=4.8182 forget=1.2881 orth=0.0374 favg=0.0000 nr=97 nf=9 protos=600 fproto_sim=NA
[loss] ep 27 it 240 total=7.8475 mle=1.7071 pcon=4.8179 forget=1.2859 orth=0.0366 favg=0.0000 nr=100 nf=4 protos=600 fproto_sim=NA
[loss] ep 27 it 290 total=7.7235 mle=1.5787 pcon=4.8177 forget=1.2912 orth=0.0359 favg=0.0000 nr=104 nf=7 protos=600 fproto_sim=NA
[loss] ep 27 it 340 total=7.8168 mle=1.6744 pcon=4.8176 forget=1.2896 orth=0.0352 favg=0.0000 nr=102 nf=5 protos=600 fproto_sim=NA
[loss] ep 27 it 390 total=7.6869 mle=1.5403 pcon=4.8174 forget=1.2947 orth=0.0345 favg=0.0000 nr=112 nf=4 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 28 it 10 total=7.8088 mle=1.5902 pcon=4.8173 forget=1.3675 orth=0.0338 favg=0.0000 nr=111 nf=5 protos=600 fproto_sim=NA
[loss] ep 28 it 60 total=7.7478 mle=1.5760 pcon=4.8171 forget=1.3216 orth=0.0332 favg=0.0000 nr=110 nf=4 protos=600 fproto_sim=NA
[loss] ep 28 it 110 total=7.8175 mle=1.6502 pcon=4.8171 forget=1.3176 orth=0.0325 favg=0.0000 nr=98 nf=9 protos=600 fproto_sim=NA
[loss] ep 28 it 160 total=7.7332 mle=1.5860 pcon=4.8172 forget=1.2981 orth=0.0320 favg=0.0000 nr=109 nf=3 protos=600 fproto_sim=NA
[loss] ep 28 it 210 total=7.7834 mle=1.6382 pcon=4.8170 forget=1.2968 orth=0.0314 favg=0.0000 nr=111 nf=5 protos=600 fproto_sim=NA
[loss] ep 28 it 260 total=7.6710 mle=1.5236 pcon=4.8171 forget=1.2994 orth=0.0308 favg=0.0000 nr=100 nf=6 protos=600 fproto_sim=NA
[loss] ep 28 it 310 total=7.6961 mle=1.4781 pcon=4.8172 forget=1.3705 orth=0.0303 favg=0.0000 nr=109 nf=4 protos=600 fproto_sim=NA
[loss] ep 28 it 360 total=7.9075 mle=1.7343 pcon=4.8170 forget=1.3263 orth=0.0298 favg=0.0000 nr=100 nf=5 protos=600 fproto_sim=NA
[loss] ep 28 it 410 total=7.7230 mle=1.5807 pcon=4.8171 forget=1.2959 orth=0.0293 favg=0.0000 nr=109 nf=7 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 29 it 30 total=7.6977 mle=1.5546 pcon=4.8169 forget=1.2973 orth=0.0289 favg=0.0000 nr=116 nf=3 protos=600 fproto_sim=NA
[loss] ep 29 it 80 total=7.8360 mle=1.6691 pcon=4.8168 forget=1.3217 orth=0.0284 favg=0.0000 nr=103 nf=8 protos=600 fproto_sim=NA
[loss] ep 29 it 130 total=7.6617 mle=1.5195 pcon=4.8168 forget=1.2974 orth=0.0280 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[loss] ep 29 it 180 total=7.7669 mle=1.6069 pcon=4.8166 forget=1.3158 orth=0.0276 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[loss] ep 29 it 230 total=7.8807 mle=1.7217 pcon=4.8164 forget=1.3154 orth=0.0272 favg=0.0000 nr=102 nf=5 protos=600 fproto_sim=NA
[loss] ep 29 it 280 total=7.7547 mle=1.5894 pcon=4.8163 forget=1.3221 orth=0.0268 favg=0.0000 nr=105 nf=3 protos=600 fproto_sim=NA
[loss] ep 29 it 330 total=7.7556 mle=1.6035 pcon=4.8162 forget=1.3095 orth=0.0264 favg=0.0000 nr=110 nf=8 protos=600 fproto_sim=NA
[loss] ep 29 it 380 total=7.7269 mle=1.5886 pcon=4.8161 forget=1.2961 orth=0.0260 favg=0.0000 nr=105 nf=4 protos=600 fproto_sim=NA
[loss] ep 30 it 0 total=7.7356 mle=1.5915 pcon=4.8160 forget=1.3024 orth=0.0257 favg=0.0000 nr=103 nf=3 protos=600 fproto_sim=NA
[loss] ep 30 it 50 total=7.8364 mle=1.6950 pcon=4.8158 forget=1.3003 orth=0.0253 favg=0.0000 nr=97 nf=7 protos=600 fproto_sim=NA
[loss] ep 30 it 100 total=7.8587 mle=1.7139 pcon=4.8158 forget=1.3040 orth=0.0250 favg=0.0000 nr=108 nf=5 protos=600 fproto_sim=NA
 62%|██████▏   | 31/50 [08:20<04:55, 15.53s/it] 64%|██████▍   | 32/50 [08:36<04:42, 15.71s/it] 66%|██████▌   | 33/50 [08:51<04:23, 15.50s/it] 68%|██████▊   | 34/50 [09:08<04:11, 15.74s/it] 70%|███████   | 35/50 [09:24<03:58, 15.87s/it] 72%|███████▏  | 36/50 [09:40<03:44, 16.05s/it] 74%|███████▍  | 37/50 [09:58<03:33, 16.46s/it][loss] ep 30 it 150 total=7.6500 mle=1.5048 pcon=4.8158 forget=1.3047 orth=0.0247 favg=0.0000 nr=101 nf=3 protos=600 fproto_sim=NA
[loss] ep 30 it 200 total=7.8506 mle=1.7113 pcon=4.8157 forget=1.2992 orth=0.0244 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
[loss] ep 30 it 250 total=7.8069 mle=1.6666 pcon=4.8158 forget=1.3004 orth=0.0241 favg=0.0000 nr=103 nf=8 protos=600 fproto_sim=NA
[loss] ep 30 it 300 total=7.7657 mle=1.5911 pcon=4.8156 forget=1.3352 orth=0.0238 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
[loss] ep 30 it 350 total=7.7388 mle=1.5936 pcon=4.8156 forget=1.3061 orth=0.0235 favg=0.0000 nr=104 nf=6 protos=600 fproto_sim=NA
[loss] ep 30 it 400 total=7.7286 mle=1.5869 pcon=4.8156 forget=1.3028 orth=0.0233 favg=0.0000 nr=97 nf=9 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 31 it 20 total=7.6769 mle=1.5327 pcon=4.8155 forget=1.3057 orth=0.0230 favg=0.0000 nr=103 nf=5 protos=600 fproto_sim=NA
[loss] ep 31 it 70 total=7.7059 mle=1.5666 pcon=4.8154 forget=1.3012 orth=0.0227 favg=0.0000 nr=102 nf=8 protos=600 fproto_sim=NA
[loss] ep 31 it 120 total=7.7298 mle=1.5695 pcon=4.8155 forget=1.3223 orth=0.0225 favg=0.0000 nr=105 nf=5 protos=600 fproto_sim=NA
[loss] ep 31 it 170 total=7.8110 mle=1.6697 pcon=4.8155 forget=1.3036 orth=0.0223 favg=0.0000 nr=107 nf=8 protos=600 fproto_sim=NA
[loss] ep 31 it 220 total=7.7463 mle=1.6039 pcon=4.8153 forget=1.3050 orth=0.0220 favg=0.0000 nr=105 nf=7 protos=600 fproto_sim=NA
[loss] ep 31 it 270 total=7.8282 mle=1.6900 pcon=4.8152 forget=1.3012 orth=0.0218 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
[loss] ep 31 it 320 total=7.7834 mle=1.6372 pcon=4.8152 forget=1.3095 orth=0.0216 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
[loss] ep 31 it 370 total=7.6663 mle=1.4846 pcon=4.8152 forget=1.3451 orth=0.0214 favg=0.0000 nr=103 nf=2 protos=600 fproto_sim=NA
[loss] ep 31 it 420 total=7.8421 mle=1.6932 pcon=4.8152 forget=1.3125 orth=0.0212 favg=0.0000 nr=101 nf=7 protos=600 fproto_sim=NA
[loss] ep 32 it 40 total=7.7451 mle=1.6035 pcon=4.8151 forget=1.3055 orth=0.0210 favg=0.0000 nr=105 nf=4 protos=600 fproto_sim=NA
[loss] ep 32 it 90 total=7.8493 mle=1.7043 pcon=4.8150 forget=1.3092 orth=0.0208 favg=0.0000 nr=103 nf=10 protos=600 fproto_sim=NA
[loss] ep 32 it 140 total=7.6927 mle=1.5499 pcon=4.8149 forget=1.3074 orth=0.0206 favg=0.0000 nr=104 nf=4 protos=600 fproto_sim=NA
[loss] ep 32 it 190 total=7.8721 mle=1.7250 pcon=4.8147 forget=1.3120 orth=0.0205 favg=0.0000 nr=100 nf=4 protos=600 fproto_sim=NA
[loss] ep 32 it 240 total=7.8567 mle=1.7015 pcon=4.8145 forget=1.3204 orth=0.0203 favg=0.0000 nr=107 nf=1 protos=600 fproto_sim=NA
[loss] ep 32 it 290 total=7.8940 mle=1.7311 pcon=4.8147 forget=1.3280 orth=0.0201 favg=0.0000 nr=102 nf=6 protos=600 fproto_sim=NA
[loss] ep 32 it 340 total=7.7234 mle=1.5748 pcon=4.8146 forget=1.3140 orth=0.0199 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[loss] ep 32 it 390 total=7.7816 mle=1.6388 pcon=4.8147 forget=1.3084 orth=0.0198 favg=0.0000 nr=105 nf=6 protos=600 fproto_sim=NA
[loss] ep 33 it 10 total=7.7513 mle=1.6049 pcon=4.8146 forget=1.3122 orth=0.0196 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
[loss] ep 33 it 60 total=7.7309 mle=1.5661 pcon=4.8146 forget=1.3308 orth=0.0195 favg=0.0000 nr=105 nf=4 protos=600 fproto_sim=NA
[loss] ep 33 it 110 total=7.7592 mle=1.6256 pcon=4.8146 forget=1.2997 orth=0.0193 favg=0.0000 nr=106 nf=2 protos=600 fproto_sim=NA
[loss] ep 33 it 160 total=7.6972 mle=1.5617 pcon=4.8145 forget=1.3019 orth=0.0192 favg=0.0000 nr=109 nf=3 protos=600 fproto_sim=NA
[loss] ep 33 it 210 total=7.7817 mle=1.6329 pcon=4.8144 forget=1.3154 orth=0.0190 favg=0.0000 nr=103 nf=8 protos=600 fproto_sim=NA
[loss] ep 33 it 260 total=7.8504 mle=1.7061 pcon=4.8145 forget=1.3109 orth=0.0189 favg=0.0000 nr=110 nf=6 protos=600 fproto_sim=NA
[loss] ep 33 it 310 total=7.7302 mle=1.5861 pcon=4.8145 forget=1.3108 orth=0.0188 favg=0.0000 nr=107 nf=4 protos=600 fproto_sim=NA
[loss] ep 33 it 360 total=7.6793 mle=1.5227 pcon=4.8145 forget=1.3235 orth=0.0186 favg=0.0000 nr=97 nf=8 protos=600 fproto_sim=NA
[loss] ep 33 it 410 total=7.7909 mle=1.6422 pcon=4.8144 forget=1.3157 orth=0.0185 favg=0.0000 nr=108 nf=9 protos=600 fproto_sim=NA
[loss] ep 34 it 30 total=7.6559 mle=1.5205 pcon=4.8146 forget=1.3024 orth=0.0184 favg=0.0000 nr=107 nf=2 protos=600 fproto_sim=NA
[loss] ep 34 it 80 total=7.7130 mle=1.5616 pcon=4.8145 forget=1.3186 orth=0.0183 favg=0.0000 nr=95 nf=8 protos=600 fproto_sim=NA
[loss] ep 34 it 130 total=7.7158 mle=1.5654 pcon=4.8146 forget=1.3177 orth=0.0182 favg=0.0000 nr=114 nf=5 protos=600 fproto_sim=NA
[loss] ep 34 it 180 total=7.6920 mle=1.5330 pcon=4.8147 forget=1.3263 orth=0.0181 favg=0.0000 nr=104 nf=6 protos=600 fproto_sim=NA
[loss] ep 34 it 230 total=7.6855 mle=1.5268 pcon=4.8147 forget=1.3260 orth=0.0179 favg=0.0000 nr=105 nf=4 protos=600 fproto_sim=NA
[loss] ep 34 it 280 total=7.7509 mle=1.5959 pcon=4.8148 forget=1.3224 orth=0.0178 favg=0.0000 nr=113 nf=7 protos=600 fproto_sim=NA
[loss] ep 34 it 330 total=7.7247 mle=1.5679 pcon=4.8147 forget=1.3244 orth=0.0177 favg=0.0000 nr=109 nf=5 protos=600 fproto_sim=NA
[loss] ep 34 it 380 total=7.7347 mle=1.5931 pcon=4.8146 forget=1.3093 orth=0.0176 favg=0.0000 nr=101 nf=7 protos=600 fproto_sim=NA
[loss] ep 35 it 0 total=7.7815 mle=1.6351 pcon=4.8145 forget=1.3143 orth=0.0175 favg=0.0000 nr=98 nf=7 protos=600 fproto_sim=NA
[loss] ep 35 it 50 total=7.9157 mle=1.7727 pcon=4.8145 forget=1.3111 orth=0.0174 favg=0.0000 nr=104 nf=10 protos=600 fproto_sim=NA
[loss] ep 35 it 100 total=7.7894 mle=1.6464 pcon=4.8144 forget=1.3113 orth=0.0174 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[loss] ep 35 it 150 total=7.8375 mle=1.6929 pcon=4.8143 forget=1.3130 orth=0.0173 favg=0.0000 nr=107 nf=4 protos=600 fproto_sim=NA
[loss] ep 35 it 200 total=7.7844 mle=1.6452 pcon=4.8141 forget=1.3079 orth=0.0172 favg=0.0000 nr=98 nf=5 protos=600 fproto_sim=NA
[loss] ep 35 it 250 total=7.7070 mle=1.5601 pcon=4.8141 forget=1.3157 orth=0.0171 favg=0.0000 nr=105 nf=4 protos=600 fproto_sim=NA
[loss] ep 35 it 300 total=7.6803 mle=1.5358 pcon=4.8141 forget=1.3134 orth=0.0170 favg=0.0000 nr=96 nf=7 protos=600 fproto_sim=NA
[loss] ep 35 it 350 total=7.7242 mle=1.5658 pcon=4.8142 forget=1.3273 orth=0.0169 favg=0.0000 nr=106 nf=11 protos=600 fproto_sim=NA
[loss] ep 35 it 400 total=7.7346 mle=1.5903 pcon=4.8142 forget=1.3132 orth=0.0168 favg=0.0000 nr=101 nf=10 protos=600 fproto_sim=NA
[loss] ep 36 it 20 total=7.8204 mle=1.6770 pcon=4.8144 forget=1.3123 orth=0.0167 favg=0.0000 nr=108 nf=4 protos=600 fproto_sim=NA
[loss] ep 36 it 70 total=7.7346 mle=1.5893 pcon=4.8143 forget=1.3144 orth=0.0167 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
[loss] ep 36 it 120 total=7.6608 mle=1.5167 pcon=4.8143 forget=1.3132 orth=0.0166 favg=0.0000 nr=106 nf=10 protos=600 fproto_sim=NA
[loss] ep 36 it 170 total=7.8589 mle=1.7132 pcon=4.8144 forget=1.3147 orth=0.0165 favg=0.0000 nr=99 nf=5 protos=600 fproto_sim=NA
[loss] ep 36 it 220 total=7.7230 mle=1.5773 pcon=4.8144 forget=1.3149 orth=0.0164 favg=0.0000 nr=99 nf=6 protos=600 fproto_sim=NA
[loss] ep 36 it 270 total=7.8373 mle=1.6939 pcon=4.8144 forget=1.3126 orth=0.0164 favg=0.0000 nr=102 nf=7 protos=600 fproto_sim=NA
[loss] ep 36 it 320 total=7.7504 mle=1.5903 pcon=4.8144 forget=1.3294 orth=0.0163 favg=0.0000 nr=94 nf=9 protos=600 fproto_sim=NA
[loss] ep 36 it 370 total=7.8130 mle=1.6627 pcon=4.8144 forget=1.3197 orth=0.0162 favg=0.0000 nr=99 nf=5 protos=600 fproto_sim=NA
[loss] ep 36 it 420 total=7.8363 mle=1.6462 pcon=4.8143 forget=1.3596 orth=0.0162 favg=0.0000 nr=92 nf=7 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 37 it 40 total=7.7894 mle=1.6469 pcon=4.8142 forget=1.3121 orth=0.0161 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
 76%|███████▌  | 38/50 [10:13<03:15, 16.29s/it] 78%|███████▊  | 39/50 [10:30<02:58, 16.23s/it] 80%|████████  | 40/50 [10:46<02:42, 16.24s/it] 82%|████████▏ | 41/50 [11:01<02:24, 16.03s/it] 84%|████████▍ | 42/50 [11:16<02:05, 15.71s/it] 86%|████████▌ | 43/50 [11:33<01:51, 15.90s/it] 88%|████████▊ | 44/50 [11:48<01:34, 15.67s/it][loss] ep 37 it 90 total=7.7601 mle=1.6103 pcon=4.8142 forget=1.3196 orth=0.0160 favg=0.0000 nr=104 nf=8 protos=600 fproto_sim=NA
[loss] ep 37 it 140 total=7.6840 mle=1.5490 pcon=4.8141 forget=1.3049 orth=0.0160 favg=0.0000 nr=108 nf=5 protos=600 fproto_sim=NA
[loss] ep 37 it 190 total=7.8283 mle=1.6889 pcon=4.8140 forget=1.3095 orth=0.0159 favg=0.0000 nr=105 nf=2 protos=600 fproto_sim=NA
[loss] ep 37 it 240 total=7.7720 mle=1.6321 pcon=4.8139 forget=1.3100 orth=0.0159 favg=0.0000 nr=111 nf=5 protos=600 fproto_sim=NA
[loss] ep 37 it 290 total=7.7935 mle=1.6419 pcon=4.8138 forget=1.3220 orth=0.0158 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[loss] ep 37 it 340 total=7.8661 mle=1.6783 pcon=4.8138 forget=1.3582 orth=0.0158 favg=0.0000 nr=107 nf=8 protos=600 fproto_sim=NA
[loss] ep 37 it 390 total=7.7729 mle=1.6286 pcon=4.8137 forget=1.3149 orth=0.0157 favg=0.0000 nr=102 nf=8 protos=600 fproto_sim=NA
[loss] ep 38 it 10 total=7.7194 mle=1.5910 pcon=4.8136 forget=1.2991 orth=0.0157 favg=0.0000 nr=112 nf=4 protos=600 fproto_sim=NA
[loss] ep 38 it 60 total=7.7352 mle=1.6000 pcon=4.8135 forget=1.3061 orth=0.0156 favg=0.0000 nr=110 nf=3 protos=600 fproto_sim=NA
[loss] ep 38 it 110 total=7.7505 mle=1.6101 pcon=4.8133 forget=1.3116 orth=0.0156 favg=0.0000 nr=99 nf=7 protos=600 fproto_sim=NA
[loss] ep 38 it 160 total=7.7966 mle=1.6264 pcon=4.8133 forget=1.3413 orth=0.0155 favg=0.0000 nr=108 nf=7 protos=600 fproto_sim=NA
[loss] ep 38 it 210 total=7.7141 mle=1.5704 pcon=4.8133 forget=1.3150 orth=0.0155 favg=0.0000 nr=105 nf=8 protos=600 fproto_sim=NA
[loss] ep 38 it 260 total=7.7585 mle=1.6328 pcon=4.8131 forget=1.2973 orth=0.0154 favg=0.0000 nr=113 nf=2 protos=600 fproto_sim=NA
[loss] ep 38 it 310 total=7.6922 mle=1.5558 pcon=4.8130 forget=1.3080 orth=0.0154 favg=0.0000 nr=96 nf=8 protos=600 fproto_sim=NA
[loss] ep 38 it 360 total=7.7077 mle=1.5711 pcon=4.8129 forget=1.3083 orth=0.0153 favg=0.0000 nr=115 nf=3 protos=600 fproto_sim=NA
[loss] ep 38 it 410 total=7.7603 mle=1.6253 pcon=4.8130 forget=1.3067 orth=0.0153 favg=0.0000 nr=105 nf=5 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 39 it 30 total=7.7352 mle=1.6035 pcon=4.8130 forget=1.3035 orth=0.0152 favg=0.0000 nr=107 nf=3 protos=600 fproto_sim=NA
[loss] ep 39 it 80 total=7.6744 mle=1.5435 pcon=4.8130 forget=1.3027 orth=0.0152 favg=0.0000 nr=102 nf=6 protos=600 fproto_sim=NA
[loss] ep 39 it 130 total=7.7042 mle=1.5656 pcon=4.8130 forget=1.3104 orth=0.0152 favg=0.0000 nr=105 nf=4 protos=600 fproto_sim=NA
[loss] ep 39 it 180 total=7.8015 mle=1.6661 pcon=4.8130 forget=1.3074 orth=0.0151 favg=0.0000 nr=102 nf=6 protos=600 fproto_sim=NA
[loss] ep 39 it 230 total=7.7501 mle=1.6039 pcon=4.8129 forget=1.3182 orth=0.0151 favg=0.0000 nr=105 nf=5 protos=600 fproto_sim=NA
[loss] ep 39 it 280 total=7.6940 mle=1.5585 pcon=4.8130 forget=1.3075 orth=0.0150 favg=0.0000 nr=110 nf=3 protos=600 fproto_sim=NA
[loss] ep 39 it 330 total=7.7386 mle=1.6070 pcon=4.8130 forget=1.3035 orth=0.0150 favg=0.0000 nr=108 nf=6 protos=600 fproto_sim=NA
[loss] ep 39 it 380 total=7.8451 mle=1.7063 pcon=4.8130 forget=1.3109 orth=0.0150 favg=0.0000 nr=104 nf=2 protos=600 fproto_sim=NA
[loss] ep 40 it 0 total=7.8187 mle=1.6750 pcon=4.8129 forget=1.3158 orth=0.0149 favg=0.0000 nr=102 nf=6 protos=600 fproto_sim=NA
[loss] ep 40 it 50 total=7.8273 mle=1.6968 pcon=4.8128 forget=1.3028 orth=0.0149 favg=0.0000 nr=96 nf=9 protos=600 fproto_sim=NA
[loss] ep 40 it 100 total=7.7748 mle=1.6351 pcon=4.8127 forget=1.3121 orth=0.0149 favg=0.0000 nr=104 nf=10 protos=600 fproto_sim=NA
[loss] ep 40 it 150 total=7.6952 mle=1.5729 pcon=4.8129 forget=1.2946 orth=0.0148 favg=0.0000 nr=105 nf=3 protos=600 fproto_sim=NA
[loss] ep 40 it 200 total=7.6988 mle=1.5735 pcon=4.8128 forget=1.2977 orth=0.0148 favg=0.0000 nr=113 nf=2 protos=600 fproto_sim=NA
[loss] ep 40 it 250 total=7.7359 mle=1.6021 pcon=4.8127 forget=1.3063 orth=0.0148 favg=0.0000 nr=100 nf=6 protos=600 fproto_sim=NA
[loss] ep 40 it 300 total=7.7564 mle=1.6291 pcon=4.8127 forget=1.2998 orth=0.0147 favg=0.0000 nr=100 nf=7 protos=600 fproto_sim=NA
[loss] ep 40 it 350 total=7.8943 mle=1.7585 pcon=4.8127 forget=1.3084 orth=0.0147 favg=0.0000 nr=100 nf=7 protos=600 fproto_sim=NA
[loss] ep 40 it 400 total=7.7781 mle=1.6496 pcon=4.8128 forget=1.3010 orth=0.0147 favg=0.0000 nr=98 nf=10 protos=600 fproto_sim=NA
[loss] ep 41 it 20 total=7.8279 mle=1.6710 pcon=4.8127 forget=1.3295 orth=0.0147 favg=0.0000 nr=102 nf=4 protos=600 fproto_sim=NA
[loss] ep 41 it 70 total=7.8367 mle=1.7009 pcon=4.8126 forget=1.3085 orth=0.0146 favg=0.0000 nr=101 nf=5 protos=600 fproto_sim=NA
[loss] ep 41 it 120 total=7.6934 mle=1.5565 pcon=4.8127 forget=1.3096 orth=0.0146 favg=0.0000 nr=106 nf=7 protos=600 fproto_sim=NA
[loss] ep 41 it 170 total=7.8219 mle=1.6878 pcon=4.8124 forget=1.3070 orth=0.0146 favg=0.0000 nr=98 nf=7 protos=600 fproto_sim=NA
[loss] ep 41 it 220 total=7.8228 mle=1.6931 pcon=4.8124 forget=1.3027 orth=0.0146 favg=0.0000 nr=103 nf=9 protos=600 fproto_sim=NA
[loss] ep 41 it 270 total=7.7170 mle=1.5699 pcon=4.8123 forget=1.3203 orth=0.0145 favg=0.0000 nr=107 nf=6 protos=600 fproto_sim=NA
[loss] ep 41 it 320 total=7.7805 mle=1.6367 pcon=4.8124 forget=1.3168 orth=0.0145 favg=0.0000 nr=106 nf=6 protos=600 fproto_sim=NA
[loss] ep 41 it 370 total=7.6484 mle=1.5166 pcon=4.8124 forget=1.3048 orth=0.0145 favg=0.0000 nr=108 nf=5 protos=600 fproto_sim=NA
[loss] ep 41 it 420 total=7.9537 mle=1.8082 pcon=4.8124 forget=1.3186 orth=0.0145 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[loss] ep 42 it 40 total=7.6709 mle=1.5482 pcon=4.8124 forget=1.2958 orth=0.0145 favg=0.0000 nr=110 nf=5 protos=600 fproto_sim=NA
[loss] ep 42 it 90 total=7.7356 mle=1.6081 pcon=4.8123 forget=1.3008 orth=0.0144 favg=0.0000 nr=109 nf=5 protos=600 fproto_sim=NA
[loss] ep 42 it 140 total=7.7956 mle=1.6648 pcon=4.8123 forget=1.3040 orth=0.0144 favg=0.0000 nr=107 nf=3 protos=600 fproto_sim=NA
[loss] ep 42 it 190 total=7.7160 mle=1.5888 pcon=4.8124 forget=1.3004 orth=0.0144 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
[loss] ep 42 it 240 total=7.7266 mle=1.5946 pcon=4.8124 forget=1.3052 orth=0.0144 favg=0.0000 nr=106 nf=5 protos=600 fproto_sim=NA
[loss] ep 42 it 290 total=7.7492 mle=1.6166 pcon=4.8124 forget=1.3058 orth=0.0144 favg=0.0000 nr=105 nf=7 protos=600 fproto_sim=NA
[loss] ep 42 it 340 total=7.8252 mle=1.6909 pcon=4.8124 forget=1.3076 orth=0.0143 favg=0.0000 nr=102 nf=7 protos=600 fproto_sim=NA
[loss] ep 42 it 390 total=7.8168 mle=1.6881 pcon=4.8123 forget=1.3020 orth=0.0143 favg=0.0000 nr=106 nf=4 protos=600 fproto_sim=NA
[loss] ep 43 it 10 total=7.9069 mle=1.7086 pcon=4.8122 forget=1.3718 orth=0.0143 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
[loss] ep 43 it 60 total=7.8358 mle=1.7066 pcon=4.8122 forget=1.3027 orth=0.0143 favg=0.0000 nr=110 nf=3 protos=600 fproto_sim=NA
[loss] ep 43 it 110 total=7.8178 mle=1.6890 pcon=4.8122 forget=1.3024 orth=0.0143 favg=0.0000 nr=91 nf=12 protos=600 fproto_sim=NA
[loss] ep 43 it 160 total=7.8117 mle=1.6299 pcon=4.8122 forget=1.3553 orth=0.0143 favg=0.0000 nr=109 nf=2 protos=600 fproto_sim=NA
[loss] ep 43 it 210 total=7.8112 mle=1.6749 pcon=4.8121 forget=1.3099 orth=0.0143 favg=0.0000 nr=99 nf=10 protos=600 fproto_sim=NA
[loss] ep 43 it 260 total=7.8085 mle=1.6755 pcon=4.8121 forget=1.3067 orth=0.0142 favg=0.0000 nr=105 nf=5 protos=600 fproto_sim=NA
[loss] ep 43 it 310 total=7.9029 mle=1.7352 pcon=4.8120 forget=1.3414 orth=0.0142 favg=0.0000 nr=109 nf=5 protos=600 fproto_sim=NA
[loss] ep 43 it 360 total=7.7627 mle=1.6415 pcon=4.8119 forget=1.2950 orth=0.0142 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
[loss] ep 43 it 410 total=7.8997 mle=1.7505 pcon=4.8118 forget=1.3232 orth=0.0142 favg=0.0000 nr=108 nf=8 protos=600 fproto_sim=NA
 90%|█████████ | 45/50 [12:03<01:17, 15.56s/it] 92%|█████████▏| 46/50 [12:21<01:05, 16.40s/it] 94%|█████████▍| 47/50 [12:38<00:49, 16.54s/it] 96%|█████████▌| 48/50 [12:54<00:32, 16.33s/it] 98%|█████████▊| 49/50 [13:12<00:16, 16.75s/it]100%|██████████| 50/50 [13:29<00:00, 16.75s/it]100%|██████████| 50/50 [13:29<00:00, 16.18s/it]
[loss] ep 44 it 30 total=7.7759 mle=1.6485 pcon=4.8117 forget=1.3015 orth=0.0142 favg=0.0000 nr=107 nf=4 protos=600 fproto_sim=NA
[loss] ep 44 it 80 total=7.7874 mle=1.6541 pcon=4.8116 forget=1.3075 orth=0.0142 favg=0.0000 nr=105 nf=7 protos=600 fproto_sim=NA
[loss] ep 44 it 130 total=7.7286 mle=1.6014 pcon=4.8115 forget=1.3015 orth=0.0142 favg=0.0000 nr=105 nf=5 protos=600 fproto_sim=NA
[loss] ep 44 it 180 total=7.7474 mle=1.6256 pcon=4.8116 forget=1.2960 orth=0.0142 favg=0.0000 nr=115 nf=1 protos=600 fproto_sim=NA
[loss] ep 44 it 230 total=7.7298 mle=1.5639 pcon=4.8115 forget=1.3403 orth=0.0142 favg=0.0000 nr=114 nf=3 protos=600 fproto_sim=NA
[loss] ep 44 it 280 total=7.8286 mle=1.6906 pcon=4.8115 forget=1.3123 orth=0.0141 favg=0.0000 nr=98 nf=6 protos=600 fproto_sim=NA
[loss] ep 44 it 330 total=7.8389 mle=1.7157 pcon=4.8114 forget=1.2977 orth=0.0141 favg=0.0000 nr=112 nf=3 protos=600 fproto_sim=NA
[loss] ep 44 it 380 total=7.6921 mle=1.5668 pcon=4.8115 forget=1.2997 orth=0.0141 favg=0.0000 nr=108 nf=2 protos=600 fproto_sim=NA
[loss] ep 45 it 0 total=7.8144 mle=1.6713 pcon=4.8114 forget=1.3176 orth=0.0141 favg=0.0000 nr=98 nf=9 protos=600 fproto_sim=NA
[loss] ep 45 it 50 total=7.7468 mle=1.5694 pcon=4.8113 forget=1.3521 orth=0.0141 favg=0.0000 nr=105 nf=8 protos=600 fproto_sim=NA
[loss] ep 45 it 100 total=7.7692 mle=1.6308 pcon=4.8114 forget=1.3129 orth=0.0141 favg=0.0000 nr=98 nf=6 protos=600 fproto_sim=NA
[loss] ep 45 it 150 total=7.6544 mle=1.5332 pcon=4.8115 forget=1.2956 orth=0.0141 favg=0.0000 nr=97 nf=6 protos=600 fproto_sim=NA
[loss] ep 45 it 200 total=7.6987 mle=1.5718 pcon=4.8114 forget=1.3013 orth=0.0141 favg=0.0000 nr=109 nf=5 protos=600 fproto_sim=NA
[loss] ep 45 it 250 total=7.7367 mle=1.6101 pcon=4.8113 forget=1.3012 orth=0.0141 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
[loss] ep 45 it 300 total=7.7425 mle=1.6240 pcon=4.8113 forget=1.2931 orth=0.0141 favg=0.0000 nr=112 nf=1 protos=600 fproto_sim=NA
[loss] ep 45 it 350 total=7.7857 mle=1.6586 pcon=4.8113 forget=1.3017 orth=0.0141 favg=0.0000 nr=103 nf=10 protos=600 fproto_sim=NA
[loss] ep 45 it 400 total=7.7230 mle=1.6008 pcon=4.8114 forget=1.2967 orth=0.0141 favg=0.0000 nr=107 nf=9 protos=600 fproto_sim=NA
[loss] ep 46 it 20 total=7.7903 mle=1.5938 pcon=4.8114 forget=1.3709 orth=0.0141 favg=0.0000 nr=99 nf=4 protos=600 fproto_sim=NA
[loss] ep 46 it 70 total=7.8454 mle=1.7206 pcon=4.8115 forget=1.2992 orth=0.0141 favg=0.0000 nr=104 nf=8 protos=600 fproto_sim=NA
[loss] ep 46 it 120 total=7.8025 mle=1.6816 pcon=4.8116 forget=1.2952 orth=0.0141 favg=0.0000 nr=101 nf=4 protos=600 fproto_sim=NA
[loss] ep 46 it 170 total=7.7778 mle=1.6312 pcon=4.8117 forget=1.3208 orth=0.0141 favg=0.0000 nr=96 nf=7 protos=600 fproto_sim=NA
[loss] ep 46 it 220 total=7.6318 mle=1.5073 pcon=4.8116 forget=1.2988 orth=0.0140 favg=0.0000 nr=101 nf=11 protos=600 fproto_sim=NA
[loss] ep 46 it 270 total=7.7809 mle=1.6300 pcon=4.8115 forget=1.3254 orth=0.0140 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
[loss] ep 46 it 320 total=7.6951 mle=1.5767 pcon=4.8115 forget=1.2929 orth=0.0140 favg=0.0000 nr=98 nf=3 protos=600 fproto_sim=NA
[loss] ep 46 it 370 total=7.7508 mle=1.6223 pcon=4.8116 forget=1.3029 orth=0.0140 favg=0.0000 nr=105 nf=6 protos=600 fproto_sim=NA
[loss] ep 46 it 420 total=7.7194 mle=1.5926 pcon=4.8115 forget=1.3013 orth=0.0140 favg=0.0000 nr=106 nf=3 protos=600 fproto_sim=NA
[loss] ep 47 it 40 total=7.7588 mle=1.6330 pcon=4.8116 forget=1.3002 orth=0.0140 favg=0.0000 nr=110 nf=8 protos=600 fproto_sim=NA
[loss] ep 47 it 90 total=7.6878 mle=1.5575 pcon=4.8118 forget=1.3045 orth=0.0140 favg=0.0000 nr=98 nf=7 protos=600 fproto_sim=NA
[loss] ep 47 it 140 total=7.7042 mle=1.5669 pcon=4.8118 forget=1.3115 orth=0.0140 favg=0.0000 nr=102 nf=8 protos=600 fproto_sim=NA
[loss] ep 47 it 190 total=7.7134 mle=1.5870 pcon=4.8119 forget=1.3005 orth=0.0140 favg=0.0000 nr=100 nf=8 protos=600 fproto_sim=NA
[loss] ep 47 it 240 total=7.6605 mle=1.5365 pcon=4.8118 forget=1.2982 orth=0.0140 favg=0.0000 nr=111 nf=4 protos=600 fproto_sim=NA
[loss] ep 47 it 290 total=7.6616 mle=1.5343 pcon=4.8116 forget=1.3016 orth=0.0140 favg=0.0000 nr=99 nf=8 protos=600 fproto_sim=NA
[loss] ep 47 it 340 total=7.7567 mle=1.6292 pcon=4.8115 forget=1.3019 orth=0.0140 favg=0.0000 nr=110 nf=7 protos=600 fproto_sim=NA
[loss] ep 47 it 390 total=7.8491 mle=1.7270 pcon=4.8115 forget=1.2966 orth=0.0140 favg=0.0000 nr=101 nf=4 protos=600 fproto_sim=NA
[loss] ep 48 it 10 total=7.8099 mle=1.6864 pcon=4.8114 forget=1.2981 orth=0.0140 favg=0.0000 nr=102 nf=3 protos=600 fproto_sim=NA
[loss] ep 48 it 60 total=7.8046 mle=1.6788 pcon=4.8113 forget=1.3004 orth=0.0140 favg=0.0000 nr=97 nf=6 protos=600 fproto_sim=NA
[loss] ep 48 it 110 total=7.7983 mle=1.6729 pcon=4.8114 forget=1.3000 orth=0.0140 favg=0.0000 nr=111 nf=6 protos=600 fproto_sim=NA
[loss] ep 48 it 160 total=7.7998 mle=1.6271 pcon=4.8111 forget=1.3475 orth=0.0140 favg=0.0000 nr=103 nf=6 protos=600 fproto_sim=NA
[loss] ep 48 it 210 total=7.8000 mle=1.6466 pcon=4.8112 forget=1.3282 orth=0.0140 favg=0.0000 nr=100 nf=10 protos=600 fproto_sim=NA
[loss] ep 48 it 260 total=7.8039 mle=1.6401 pcon=4.8114 forget=1.3385 orth=0.0140 favg=0.0000 nr=109 nf=5 protos=600 fproto_sim=NA
[loss] ep 48 it 310 total=7.7330 mle=1.6107 pcon=4.8113 forget=1.2970 orth=0.0140 favg=0.0000 nr=101 nf=5 protos=600 fproto_sim=NA
[loss] ep 48 it 360 total=7.8226 mle=1.6840 pcon=4.8114 forget=1.3132 orth=0.0140 favg=0.0000 nr=98 nf=12 protos=600 fproto_sim=NA
[loss] ep 48 it 410 total=7.7929 mle=1.6658 pcon=4.8114 forget=1.3018 orth=0.0140 favg=0.0000 nr=108 nf=5 protos=600 fproto_sim=NA
[loss] ep 49 it 30 total=7.6928 mle=1.5624 pcon=4.8114 forget=1.3050 orth=0.0140 favg=0.0000 nr=98 nf=13 protos=600 fproto_sim=NA
[loss] ep 49 it 80 total=7.7293 mle=1.5982 pcon=4.8115 forget=1.3056 orth=0.0140 favg=0.0000 nr=107 nf=5 protos=600 fproto_sim=NA
[loss] ep 49 it 130 total=7.6502 mle=1.5240 pcon=4.8115 forget=1.3007 orth=0.0140 favg=0.0000 nr=103 nf=11 protos=600 fproto_sim=NA
[loss] ep 49 it 180 total=7.8864 mle=1.7542 pcon=4.8114 forget=1.3069 orth=0.0140 favg=0.0000 nr=101 nf=9 protos=600 fproto_sim=NA
[loss] ep 49 it 230 total=7.7816 mle=1.6573 pcon=4.8115 forget=1.2988 orth=0.0140 favg=0.0000 nr=101 nf=13 protos=600 fproto_sim=NA
[loss] ep 49 it 280 total=7.8043 mle=1.6644 pcon=4.8117 forget=1.3141 orth=0.0140 favg=0.0000 nr=100 nf=5 protos=600 fproto_sim=NA
[loss] ep 49 it 330 total=7.7770 mle=1.6061 pcon=4.8117 forget=1.3452 orth=0.0140 favg=0.0000 nr=102 nf=3 protos=600 fproto_sim=NA
[loss] ep 49 it 380 total=7.8036 mle=1.6853 pcon=4.8116 forget=1.2927 orth=0.0140 favg=0.0000 nr=107 nf=7 protos=600 fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc1-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<04:30,  1.58it/s]  3%|▎         | 11/430 [00:00<00:21, 19.41it/s]  5%|▍         | 21/430 [00:00<00:11, 35.42it/s]  7%|▋         | 31/430 [00:00<00:08, 49.52it/s] 10%|▉         | 41/430 [00:01<00:06, 61.11it/s] 12%|█▏        | 51/430 [00:01<00:05, 70.29it/s] 14%|█▍        | 61/430 [00:01<00:04, 77.09it/s] 17%|█▋        | 71/430 [00:01<00:04, 82.38it/s] 19%|█▉        | 81/430 [00:01<00:04, 86.45it/s] 21%|██        | 91/430 [00:01<00:03, 89.49it/s] 23%|██▎       | 101/430 [00:01<00:03, 85.76it/s] 26%|██▌       | 110/430 [00:01<00:03, 82.04it/s] 28%|██▊       | 119/430 [00:01<00:04, 75.86it/s] 30%|███       | 129/430 [00:02<00:03, 80.66it/s] 32%|███▏      | 139/430 [00:02<00:03, 84.31it/s] 35%|███▍      | 149/430 [00:02<00:03, 87.27it/s] 37%|███▋      | 159/430 [00:02<00:03, 89.31it/s] 39%|███▉      | 169/430 [00:02<00:02, 90.90it/s] 42%|████▏     | 179/430 [00:02<00:02, 92.20it/s] 44%|████▍     | 189/430 [00:02<00:02, 93.34it/s] 46%|████▋     | 199/430 [00:02<00:02, 94.03it/s] 49%|████▊     | 209/430 [00:02<00:02, 94.80it/s] 51%|█████     | 219/430 [00:03<00:02, 95.33it/s] 53%|█████▎    | 229/430 [00:03<00:02, 95.73it/s] 56%|█████▌    | 239/430 [00:03<00:01, 95.96it/s] 58%|█████▊    | 249/430 [00:03<00:01, 95.96it/s] 60%|██████    | 259/430 [00:03<00:01, 96.12it/s] 63%|██████▎   | 269/430 [00:03<00:01, 96.24it/s] 65%|██████▍   | 279/430 [00:03<00:01, 95.47it/s] 67%|██████▋   | 289/430 [00:03<00:01, 95.86it/s] 70%|██████▉   | 299/430 [00:03<00:01, 96.11it/s] 72%|███████▏  | 309/430 [00:03<00:01, 96.30it/s] 74%|███████▍  | 319/430 [00:04<00:01, 96.25it/s] 77%|███████▋  | 329/430 [00:04<00:01, 96.33it/s] 79%|███████▉  | 339/430 [00:04<00:00, 96.19it/s] 81%|████████  | 349/430 [00:04<00:00, 96.29it/s] 83%|████████▎ | 359/430 [00:04<00:00, 96.22it/s] 86%|████████▌ | 369/430 [00:04<00:00, 96.26it/s] 88%|████████▊ | 379/430 [00:04<00:00, 96.50it/s] 90%|█████████ | 389/430 [00:04<00:00, 96.48it/s] 93%|█████████▎| 399/430 [00:04<00:00, 95.50it/s] 95%|█████████▌| 409/430 [00:04<00:00, 96.02it/s] 97%|█████████▋| 419/430 [00:05<00:00, 96.58it/s]100%|█████████▉| 429/430 [00:05<00:00, 96.93it/s]100%|██████████| 430/430 [00:05<00:00, 82.44it/s]
55000 images processed, 5.272478818893433 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:36,  2.31it/s]  6%|▌         | 5/86 [00:00<00:07, 11.57it/s] 16%|█▋        | 14/86 [00:00<00:02, 31.69it/s] 27%|██▋       | 23/86 [00:00<00:01, 47.10it/s] 38%|███▊      | 33/86 [00:00<00:00, 59.94it/s] 50%|█████     | 43/86 [00:00<00:00, 69.71it/s] 62%|██████▏   | 53/86 [00:01<00:00, 76.96it/s] 73%|███████▎  | 63/86 [00:01<00:00, 82.69it/s] 85%|████████▍ | 73/86 [00:01<00:00, 86.97it/s] 97%|█████████▋| 83/86 [00:01<00:00, 89.87it/s]100%|██████████| 86/86 [00:01<00:00, 61.01it/s]
11000 images processed, 1.4225776195526123 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:26,  1.39it/s]  4%|▍         | 9/204 [00:00<00:13, 14.35it/s]  9%|▉         | 19/204 [00:00<00:06, 30.14it/s] 14%|█▍        | 29/204 [00:01<00:03, 44.20it/s] 19%|█▉        | 39/204 [00:01<00:02, 55.88it/s] 24%|██▍       | 49/204 [00:01<00:02, 65.39it/s] 29%|██▉       | 59/204 [00:01<00:01, 72.84it/s] 33%|███▎      | 68/204 [00:01<00:01, 74.61it/s] 38%|███▊      | 77/204 [00:01<00:01, 72.09it/s] 42%|████▏     | 85/204 [00:01<00:01, 66.46it/s] 46%|████▌     | 93/204 [00:01<00:01, 67.75it/s] 50%|█████     | 103/204 [00:01<00:01, 74.57it/s] 55%|█████▌    | 113/204 [00:02<00:01, 79.75it/s] 60%|██████    | 123/204 [00:02<00:00, 82.91it/s] 65%|██████▌   | 133/204 [00:02<00:00, 86.02it/s] 70%|███████   | 143/204 [00:02<00:00, 87.73it/s] 75%|███████▌  | 153/204 [00:02<00:00, 89.67it/s] 80%|███████▉  | 163/204 [00:02<00:00, 90.83it/s] 85%|████████▍ | 173/204 [00:02<00:00, 91.05it/s] 90%|████████▉ | 183/204 [00:02<00:00, 92.47it/s] 95%|█████████▍| 193/204 [00:02<00:00, 93.59it/s]100%|█████████▉| 203/204 [00:03<00:00, 94.37it/s]100%|██████████| 204/204 [00:03<00:00, 66.72it/s]
26032 images processed, 3.1130130290985107 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.61it/s] 11%|█▏        | 9/79 [00:00<00:04, 14.08it/s] 23%|██▎       | 18/79 [00:00<00:02, 28.19it/s] 34%|███▍      | 27/79 [00:01<00:01, 40.50it/s] 47%|████▋     | 37/79 [00:01<00:00, 52.83it/s] 58%|█████▊    | 46/79 [00:01<00:00, 61.46it/s] 70%|██████▉   | 55/79 [00:01<00:00, 68.42it/s] 81%|████████  | 64/79 [00:01<00:00, 73.53it/s] 94%|█████████▎| 74/79 [00:01<00:00, 80.01it/s]100%|██████████| 79/79 [00:01<00:00, 46.45it/s]
10000 images processed, 1.7360165119171143 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.95it/s] 13%|█▎        | 10/79 [00:00<00:03, 20.84it/s] 25%|██▌       | 20/79 [00:00<00:01, 38.79it/s] 38%|███▊      | 30/79 [00:00<00:00, 53.37it/s] 51%|█████     | 40/79 [00:00<00:00, 64.45it/s] 63%|██████▎   | 50/79 [00:01<00:00, 72.83it/s] 76%|███████▌  | 60/79 [00:01<00:00, 79.55it/s] 89%|████████▊ | 70/79 [00:01<00:00, 84.46it/s]100%|██████████| 79/79 [00:01<00:00, 59.13it/s]
10000 images processed, 1.3584086894989014 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:38,  1.81it/s] 14%|█▍        | 10/70 [00:00<00:03, 19.89it/s] 29%|██▊       | 20/70 [00:00<00:01, 37.50it/s] 43%|████▎     | 30/70 [00:00<00:00, 51.79it/s] 57%|█████▋    | 40/70 [00:00<00:00, 62.72it/s] 71%|███████▏  | 50/70 [00:01<00:00, 71.78it/s] 86%|████████▌ | 60/70 [00:01<00:00, 78.77it/s]100%|██████████| 70/70 [00:01<00:00, 82.29it/s]100%|██████████| 70/70 [00:01<00:00, 54.17it/s]
8925 images processed, 1.3275001049041748 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.04it/s]  9%|▉         | 4/45 [00:01<00:08,  4.67it/s] 13%|█▎        | 6/45 [00:01<00:06,  6.46it/s] 36%|███▌      | 16/45 [00:01<00:01, 21.79it/s] 47%|████▋     | 21/45 [00:01<00:01, 15.67it/s] 56%|█████▌    | 25/45 [00:02<00:01, 17.28it/s] 78%|███████▊  | 35/45 [00:02<00:00, 23.13it/s] 87%|████████▋ | 39/45 [00:02<00:00, 23.05it/s] 93%|█████████▎| 42/45 [00:02<00:00, 23.49it/s]100%|██████████| 45/45 [00:02<00:00, 17.17it/s]
5640 images processed, 2.6431238651275635 seconds used

18.550026893615723
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.16  99.81  93.95
places365     37.14  94.85  79.54
LSUN           1.88  99.54  95.81
iSUN          29.59  95.98  86.76
dtd           18.72  97.25  89.45
AVG           17.70  97.49  89.10
[incremental] Overall: 0.9300 New: 0.9300 Old: 0.9300
1.9783213138580322
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc1-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:36,  1.98it/s]  2%|▏         | 9/430 [00:00<00:22, 18.99it/s]  4%|▍         | 17/430 [00:00<00:12, 33.12it/s]  6%|▌         | 25/430 [00:00<00:09, 44.75it/s]  8%|▊         | 33/430 [00:00<00:07, 53.85it/s] 10%|▉         | 41/430 [00:01<00:06, 60.77it/s] 11%|█▏        | 49/430 [00:01<00:05, 65.92it/s] 13%|█▎        | 57/430 [00:01<00:05, 67.25it/s] 15%|█▌        | 65/430 [00:01<00:05, 69.09it/s] 17%|█▋        | 73/430 [00:01<00:04, 71.68it/s] 19%|█▉        | 81/430 [00:01<00:04, 73.59it/s] 21%|██        | 89/430 [00:01<00:04, 75.01it/s] 23%|██▎       | 97/430 [00:01<00:04, 76.23it/s] 24%|██▍       | 105/430 [00:01<00:04, 77.05it/s] 27%|██▋       | 114/430 [00:01<00:04, 78.34it/s] 28%|██▊       | 122/430 [00:02<00:03, 78.15it/s] 30%|███       | 130/430 [00:02<00:03, 76.37it/s] 32%|███▏      | 138/430 [00:02<00:03, 76.95it/s] 34%|███▍      | 146/430 [00:02<00:03, 77.61it/s] 36%|███▌      | 154/430 [00:02<00:03, 77.96it/s] 38%|███▊      | 162/430 [00:02<00:03, 78.43it/s] 40%|███▉      | 170/430 [00:02<00:03, 71.24it/s] 41%|████▏     | 178/430 [00:02<00:03, 64.57it/s] 43%|████▎     | 185/430 [00:03<00:04, 57.20it/s] 44%|████▍     | 191/430 [00:03<00:04, 54.50it/s] 46%|████▋     | 199/430 [00:03<00:03, 59.10it/s] 48%|████▊     | 206/430 [00:03<00:03, 60.15it/s] 50%|████▉     | 213/430 [00:03<00:03, 62.17it/s] 51%|█████▏    | 221/430 [00:03<00:03, 64.14it/s] 53%|█████▎    | 229/430 [00:03<00:02, 67.23it/s] 55%|█████▍    | 236/430 [00:03<00:02, 67.85it/s] 57%|█████▋    | 243/430 [00:03<00:02, 68.40it/s] 58%|█████▊    | 251/430 [00:04<00:02, 71.60it/s] 60%|██████    | 259/430 [00:04<00:02, 73.66it/s] 62%|██████▏   | 267/430 [00:04<00:02, 72.55it/s] 64%|██████▍   | 275/430 [00:04<00:02, 74.48it/s] 66%|██████▌   | 283/430 [00:04<00:01, 76.01it/s] 68%|██████▊   | 291/430 [00:04<00:01, 74.27it/s] 70%|██████▉   | 299/430 [00:04<00:01, 72.96it/s] 71%|███████▏  | 307/430 [00:04<00:01, 72.14it/s] 73%|███████▎  | 315/430 [00:04<00:01, 71.57it/s] 75%|███████▌  | 323/430 [00:04<00:01, 71.23it/s] 77%|███████▋  | 331/430 [00:05<00:01, 70.94it/s] 79%|███████▉  | 339/430 [00:05<00:01, 70.80it/s] 81%|████████  | 347/430 [00:05<00:01, 73.09it/s] 83%|████████▎ | 355/430 [00:05<00:01, 74.01it/s] 84%|████████▍ | 363/430 [00:05<00:00, 75.51it/s] 86%|████████▋ | 371/430 [00:05<00:00, 74.16it/s] 88%|████████▊ | 379/430 [00:05<00:00, 71.13it/s] 90%|█████████ | 387/430 [00:05<00:00, 70.93it/s] 92%|█████████▏| 395/430 [00:05<00:00, 70.55it/s] 94%|█████████▎| 403/430 [00:06<00:00, 70.55it/s] 96%|█████████▌| 411/430 [00:06<00:00, 70.74it/s] 97%|█████████▋| 419/430 [00:06<00:00, 73.07it/s] 99%|█████████▉| 427/430 [00:06<00:00, 74.89it/s]100%|██████████| 430/430 [00:06<00:00, 66.57it/s]
55000 images processed, 6.587912321090698 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:46,  1.84it/s]  9%|▉         | 8/86 [00:00<00:05, 15.55it/s] 17%|█▋        | 15/86 [00:00<00:02, 26.81it/s] 24%|██▍       | 21/86 [00:00<00:01, 34.56it/s] 33%|███▎      | 28/86 [00:00<00:01, 42.28it/s] 41%|████      | 35/86 [00:01<00:01, 48.65it/s] 49%|████▉     | 42/86 [00:01<00:00, 53.94it/s] 58%|█████▊    | 50/86 [00:01<00:00, 60.21it/s] 66%|██████▋   | 57/86 [00:01<00:00, 62.38it/s] 76%|███████▌  | 65/86 [00:01<00:00, 66.16it/s] 84%|████████▎ | 72/86 [00:01<00:00, 66.58it/s] 93%|█████████▎| 80/86 [00:01<00:00, 67.48it/s]100%|██████████| 86/86 [00:01<00:00, 47.53it/s]
11000 images processed, 1.8353383541107178 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc1-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:01<03:39,  1.08s/it]  4%|▍         | 8/204 [00:01<00:21,  8.97it/s]  7%|▋         | 15/204 [00:01<00:10, 17.61it/s] 11%|█         | 22/204 [00:01<00:06, 26.00it/s] 14%|█▍        | 29/204 [00:01<00:05, 33.99it/s] 18%|█▊        | 36/204 [00:01<00:04, 40.24it/s] 21%|██        | 43/204 [00:01<00:03, 46.14it/s] 25%|██▍       | 50/204 [00:01<00:03, 50.81it/s] 28%|██▊       | 57/204 [00:01<00:02, 54.93it/s] 31%|███▏      | 64/204 [00:02<00:02, 56.58it/s] 35%|███▍      | 71/204 [00:02<00:02, 59.33it/s] 38%|███▊      | 78/204 [00:02<00:02, 61.62it/s] 42%|████▏     | 85/204 [00:02<00:01, 62.98it/s] 46%|████▌     | 93/204 [00:02<00:01, 64.56it/s] 49%|████▉     | 100/204 [00:02<00:01, 65.22it/s] 53%|█████▎    | 108/204 [00:02<00:01, 66.29it/s] 56%|█████▋    | 115/204 [00:02<00:01, 65.25it/s] 60%|█████▉    | 122/204 [00:02<00:01, 65.02it/s] 63%|██████▎   | 129/204 [00:03<00:01, 62.68it/s] 67%|██████▋   | 136/204 [00:03<00:01, 64.13it/s] 70%|███████   | 143/204 [00:03<00:00, 64.00it/s] 74%|███████▎  | 150/204 [00:03<00:00, 63.79it/s] 77%|███████▋  | 157/204 [00:03<00:00, 63.36it/s] 80%|████████  | 164/204 [00:03<00:00, 63.73it/s] 84%|████████▍ | 172/204 [00:03<00:00, 65.35it/s] 88%|████████▊ | 179/204 [00:03<00:00, 65.72it/s] 91%|█████████ | 186/204 [00:03<00:00, 66.38it/s] 95%|█████████▍| 193/204 [00:04<00:00, 62.70it/s] 98%|█████████▊| 200/204 [00:04<00:00, 64.21it/s]100%|██████████| 204/204 [00:04<00:00, 48.55it/s]
26032 images processed, 4.245640277862549 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:57,  1.36it/s] 10%|█         | 8/79 [00:00<00:05, 12.28it/s] 15%|█▌        | 12/79 [00:00<00:03, 17.01it/s] 24%|██▍       | 19/79 [00:01<00:02, 27.62it/s] 33%|███▎      | 26/79 [00:01<00:01, 35.95it/s] 42%|████▏     | 33/79 [00:01<00:01, 43.80it/s] 51%|█████     | 40/79 [00:01<00:00, 48.58it/s] 59%|█████▉    | 47/79 [00:01<00:00, 52.66it/s] 68%|██████▊   | 54/79 [00:01<00:00, 56.68it/s] 77%|███████▋  | 61/79 [00:01<00:00, 52.36it/s] 87%|████████▋ | 69/79 [00:01<00:00, 57.21it/s] 97%|█████████▋| 77/79 [00:01<00:00, 60.76it/s]100%|██████████| 79/79 [00:03<00:00, 24.70it/s]
10000 images processed, 3.2975687980651855 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.68it/s] 10%|█         | 8/79 [00:00<00:04, 14.61it/s] 19%|█▉        | 15/79 [00:00<00:02, 25.55it/s] 28%|██▊       | 22/79 [00:00<00:01, 35.13it/s] 37%|███▋      | 29/79 [00:01<00:01, 43.06it/s] 46%|████▌     | 36/79 [00:01<00:00, 48.86it/s] 54%|█████▍    | 43/79 [00:01<00:00, 52.27it/s] 63%|██████▎   | 50/79 [00:01<00:00, 56.05it/s] 72%|███████▏  | 57/79 [00:01<00:00, 59.30it/s] 81%|████████  | 64/79 [00:01<00:00, 61.79it/s] 91%|█████████ | 72/79 [00:01<00:00, 64.19it/s]100%|██████████| 79/79 [00:01<00:00, 44.65it/s]
10000 images processed, 1.7943940162658691 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:40,  1.71it/s] 11%|█▏        | 8/70 [00:00<00:04, 14.57it/s] 21%|██▏       | 15/70 [00:00<00:02, 26.06it/s] 31%|███▏      | 22/70 [00:00<00:01, 35.65it/s] 41%|████▏     | 29/70 [00:01<00:00, 43.20it/s] 51%|█████▏    | 36/70 [00:01<00:00, 49.35it/s] 61%|██████▏   | 43/70 [00:01<00:00, 54.21it/s] 71%|███████▏  | 50/70 [00:01<00:00, 57.86it/s] 81%|████████▏ | 57/70 [00:01<00:00, 61.06it/s] 91%|█████████▏| 64/70 [00:01<00:00, 62.76it/s]100%|██████████| 70/70 [00:01<00:00, 42.66it/s]
8925 images processed, 1.6714375019073486 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.03it/s]  4%|▍         | 2/45 [00:01<00:21,  2.03it/s] 16%|█▌        | 7/45 [00:01<00:06,  5.66it/s] 31%|███       | 14/45 [00:01<00:02, 12.98it/s] 47%|████▋     | 21/45 [00:01<00:01, 20.85it/s] 58%|█████▊    | 26/45 [00:02<00:01, 11.98it/s] 76%|███████▌  | 34/45 [00:02<00:00, 18.72it/s] 87%|████████▋ | 39/45 [00:02<00:00, 19.54it/s]100%|██████████| 45/45 [00:03<00:00, 14.75it/s]
5640 images processed, 3.073343276977539 seconds used

24.338045835494995
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.62  99.36  98.24
places365     75.12  77.49  78.61
LSUN           9.59  97.67  97.70
iSUN          70.10  82.73  86.38
dtd           40.53  89.87  94.02
AVG           39.59  89.43  90.99
Retain-Acc: 0.7267
Forget-as-OOD (retain known vs forget novel):
  FPR: 47.20 AUROC: 86.63 AUIN: 99.14
8.524837493896484
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc2-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:24,  2.10it/s]  2%|▏         | 9/430 [00:00<00:21, 19.64it/s]  4%|▍         | 17/430 [00:00<00:12, 33.25it/s]  6%|▌         | 25/430 [00:00<00:09, 44.90it/s]  8%|▊         | 33/430 [00:00<00:07, 53.97it/s] 10%|▉         | 41/430 [00:01<00:06, 58.04it/s] 11%|█         | 48/430 [00:01<00:06, 61.15it/s] 13%|█▎        | 55/430 [00:01<00:05, 63.08it/s] 14%|█▍        | 62/430 [00:01<00:05, 64.51it/s] 16%|█▋        | 70/430 [00:01<00:05, 67.94it/s] 18%|█▊        | 78/430 [00:01<00:05, 69.22it/s] 20%|██        | 86/430 [00:01<00:04, 71.81it/s] 22%|██▏       | 94/430 [00:01<00:04, 71.24it/s] 24%|██▎       | 102/430 [00:01<00:04, 70.83it/s] 26%|██▌       | 110/430 [00:01<00:04, 70.50it/s] 27%|██▋       | 118/430 [00:02<00:04, 70.96it/s] 29%|██▉       | 126/430 [00:02<00:04, 69.80it/s] 31%|███       | 134/430 [00:02<00:04, 70.01it/s] 33%|███▎      | 142/430 [00:02<00:04, 69.91it/s] 35%|███▍      | 150/430 [00:02<00:04, 69.98it/s] 37%|███▋      | 158/430 [00:02<00:03, 69.89it/s] 39%|███▊      | 166/430 [00:02<00:03, 70.65it/s] 40%|████      | 174/430 [00:02<00:03, 69.54it/s] 42%|████▏     | 182/430 [00:03<00:03, 69.73it/s] 44%|████▍     | 189/430 [00:03<00:03, 69.67it/s] 46%|████▌     | 197/430 [00:03<00:03, 69.36it/s] 48%|████▊     | 205/430 [00:03<00:03, 69.54it/s] 50%|████▉     | 213/430 [00:03<00:03, 69.75it/s] 51%|█████▏    | 221/430 [00:03<00:02, 69.80it/s] 53%|█████▎    | 229/430 [00:03<00:02, 69.86it/s] 55%|█████▌    | 237/430 [00:03<00:02, 69.81it/s] 57%|█████▋    | 245/430 [00:03<00:02, 70.78it/s] 59%|█████▉    | 253/430 [00:04<00:02, 65.98it/s] 61%|██████    | 261/430 [00:04<00:02, 67.89it/s] 62%|██████▏   | 268/430 [00:04<00:02, 66.51it/s] 64%|██████▍   | 275/430 [00:04<00:02, 66.94it/s] 66%|██████▌   | 283/430 [00:04<00:02, 67.84it/s] 68%|██████▊   | 291/430 [00:04<00:02, 68.48it/s] 70%|██████▉   | 299/430 [00:04<00:01, 68.92it/s] 71%|███████▏  | 307/430 [00:04<00:01, 70.09it/s] 73%|███████▎  | 315/430 [00:04<00:01, 70.18it/s] 75%|███████▌  | 323/430 [00:05<00:01, 69.70it/s] 77%|███████▋  | 331/430 [00:05<00:01, 70.33it/s] 79%|███████▉  | 339/430 [00:05<00:01, 69.41it/s] 81%|████████  | 347/430 [00:05<00:01, 70.46it/s] 83%|████████▎ | 355/430 [00:05<00:01, 70.32it/s] 84%|████████▍ | 363/430 [00:05<00:00, 70.30it/s] 86%|████████▋ | 371/430 [00:05<00:00, 70.41it/s] 88%|████████▊ | 379/430 [00:05<00:00, 70.03it/s] 90%|█████████ | 387/430 [00:05<00:00, 69.66it/s] 92%|█████████▏| 395/430 [00:06<00:00, 70.69it/s] 94%|█████████▎| 403/430 [00:06<00:00, 69.54it/s] 96%|█████████▌| 411/430 [00:06<00:00, 69.90it/s] 97%|█████████▋| 419/430 [00:06<00:00, 70.19it/s] 99%|█████████▉| 427/430 [00:06<00:00, 70.38it/s]100%|██████████| 430/430 [00:06<00:00, 65.26it/s]
55000 images processed, 6.643262624740601 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:35,  2.41it/s]  9%|▉         | 8/86 [00:00<00:04, 19.35it/s] 17%|█▋        | 15/86 [00:00<00:02, 32.32it/s] 26%|██▌       | 22/86 [00:00<00:01, 42.19it/s] 35%|███▍      | 30/86 [00:00<00:01, 50.70it/s] 43%|████▎     | 37/86 [00:00<00:00, 55.60it/s] 52%|█████▏    | 45/86 [00:01<00:00, 60.03it/s] 62%|██████▏   | 53/86 [00:01<00:00, 62.98it/s] 71%|███████   | 61/86 [00:01<00:00, 65.02it/s] 80%|████████  | 69/86 [00:01<00:00, 66.65it/s] 90%|████████▉ | 77/86 [00:01<00:00, 67.37it/s] 98%|█████████▊| 84/86 [00:01<00:00, 60.41it/s]100%|██████████| 86/86 [00:01<00:00, 49.98it/s]
11000 images processed, 1.743119716644287 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:40,  1.26it/s]  4%|▍         | 8/204 [00:00<00:16, 11.76it/s]  7%|▋         | 15/204 [00:00<00:08, 22.10it/s] 11%|█         | 22/204 [00:01<00:05, 31.49it/s] 14%|█▍        | 29/204 [00:01<00:04, 39.76it/s] 18%|█▊        | 36/204 [00:01<00:03, 46.49it/s] 21%|██        | 43/204 [00:01<00:03, 51.97it/s] 25%|██▌       | 51/204 [00:01<00:02, 56.65it/s] 29%|██▉       | 59/204 [00:01<00:02, 60.16it/s] 32%|███▏      | 66/204 [00:01<00:02, 61.87it/s] 36%|███▌      | 73/204 [00:01<00:02, 63.46it/s] 40%|███▉      | 81/204 [00:01<00:01, 65.04it/s] 44%|████▎     | 89/204 [00:02<00:01, 66.28it/s] 48%|████▊     | 97/204 [00:02<00:01, 66.95it/s] 51%|█████▏    | 105/204 [00:02<00:01, 67.65it/s] 55%|█████▌    | 113/204 [00:02<00:01, 67.56it/s] 59%|█████▉    | 120/204 [00:02<00:01, 66.74it/s] 62%|██████▏   | 127/204 [00:02<00:01, 63.92it/s] 66%|██████▌   | 134/204 [00:02<00:01, 64.32it/s] 69%|██████▉   | 141/204 [00:02<00:00, 64.84it/s] 73%|███████▎  | 148/204 [00:02<00:00, 64.91it/s] 76%|███████▌  | 155/204 [00:03<00:00, 64.70it/s] 79%|███████▉  | 162/204 [00:03<00:00, 65.39it/s] 83%|████████▎ | 170/204 [00:03<00:00, 67.08it/s] 87%|████████▋ | 178/204 [00:03<00:00, 67.53it/s] 91%|█████████ | 186/204 [00:03<00:00, 68.31it/s] 95%|█████████▌| 194/204 [00:03<00:00, 69.18it/s] 99%|█████████▉| 202/204 [00:03<00:00, 68.93it/s]100%|██████████| 204/204 [00:03<00:00, 53.63it/s]
26032 images processed, 3.84270977973938 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.78it/s]  3%|▎         | 2/79 [00:00<00:22,  3.35it/s]  9%|▉         | 7/79 [00:00<00:05, 12.73it/s] 18%|█▊        | 14/79 [00:00<00:02, 25.15it/s] 27%|██▋       | 21/79 [00:01<00:01, 35.43it/s] 35%|███▌      | 28/79 [00:01<00:01, 43.57it/s] 44%|████▍     | 35/79 [00:01<00:00, 49.87it/s] 52%|█████▏    | 41/79 [00:01<00:00, 51.02it/s] 61%|██████    | 48/79 [00:01<00:00, 54.20it/s] 70%|██████▉   | 55/79 [00:01<00:00, 57.86it/s] 78%|███████▊  | 62/79 [00:01<00:00, 61.15it/s] 87%|████████▋ | 69/79 [00:01<00:00, 63.16it/s] 96%|█████████▌| 76/79 [00:01<00:00, 64.69it/s]100%|██████████| 79/79 [00:02<00:00, 28.83it/s]
10000 images processed, 2.775979518890381 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:05,  1.18it/s] 10%|█         | 8/79 [00:00<00:06, 10.99it/s] 19%|█▉        | 15/79 [00:01<00:03, 20.72it/s] 28%|██▊       | 22/79 [00:01<00:01, 29.74it/s] 37%|███▋      | 29/79 [00:01<00:01, 37.96it/s] 46%|████▌     | 36/79 [00:01<00:00, 44.83it/s] 54%|█████▍    | 43/79 [00:01<00:00, 50.58it/s] 65%|██████▍   | 51/79 [00:01<00:00, 55.99it/s] 75%|███████▍  | 59/79 [00:01<00:00, 60.02it/s] 85%|████████▍ | 67/79 [00:01<00:00, 62.94it/s] 95%|█████████▍| 75/79 [00:01<00:00, 64.78it/s]100%|██████████| 79/79 [00:01<00:00, 39.64it/s]
10000 images processed, 2.028444290161133 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:37,  1.86it/s] 10%|█         | 7/70 [00:00<00:04, 13.96it/s] 20%|██        | 14/70 [00:00<00:02, 25.43it/s] 29%|██▊       | 20/70 [00:00<00:01, 32.98it/s] 37%|███▋      | 26/70 [00:00<00:01, 38.93it/s] 46%|████▌     | 32/70 [00:01<00:00, 42.75it/s] 56%|█████▌    | 39/70 [00:01<00:00, 49.43it/s] 67%|██████▋   | 47/70 [00:01<00:00, 55.55it/s] 79%|███████▊  | 55/70 [00:01<00:00, 59.84it/s] 90%|█████████ | 63/70 [00:01<00:00, 62.87it/s]100%|██████████| 70/70 [00:01<00:00, 42.74it/s]
8925 images processed, 1.6660783290863037 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:40,  1.08it/s]  4%|▍         | 2/45 [00:01<00:23,  1.83it/s] 18%|█▊        | 8/45 [00:01<00:03,  9.45it/s] 29%|██▉       | 13/45 [00:01<00:02, 15.83it/s] 40%|████      | 18/45 [00:01<00:01, 15.71it/s] 56%|█████▌    | 25/45 [00:01<00:00, 23.71it/s] 71%|███████   | 32/45 [00:01<00:00, 31.59it/s] 82%|████████▏ | 37/45 [00:02<00:00, 17.26it/s] 98%|█████████▊| 44/45 [00:02<00:00, 23.64it/s]100%|██████████| 45/45 [00:02<00:00, 16.66it/s]
5640 images processed, 2.720933198928833 seconds used

23.188488721847534
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.72  99.73  95.11
places365     46.56  93.37  76.17
LSUN           7.36  98.46  90.41
iSUN          42.06  94.25  81.75
dtd           26.52  96.24  89.97
AVG           24.85  96.41  86.68
[incremental] Overall: 0.8850 New: 0.8860 Old: 0.8840
2.039276599884033
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc2-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:37,  1.97it/s]  3%|▎         | 11/430 [00:00<00:18, 23.14it/s]  5%|▍         | 21/430 [00:00<00:10, 40.72it/s]  7%|▋         | 31/430 [00:00<00:07, 55.06it/s] 10%|▉         | 41/430 [00:00<00:05, 65.49it/s] 12%|█▏        | 51/430 [00:01<00:05, 74.07it/s] 14%|█▍        | 61/430 [00:01<00:04, 80.08it/s] 17%|█▋        | 71/430 [00:01<00:04, 83.62it/s] 19%|█▉        | 81/430 [00:01<00:03, 87.27it/s] 21%|██        | 91/430 [00:01<00:03, 89.10it/s] 23%|██▎       | 101/430 [00:01<00:03, 90.00it/s] 26%|██▌       | 111/430 [00:01<00:03, 91.43it/s] 28%|██▊       | 121/430 [00:01<00:03, 92.67it/s] 30%|███       | 131/430 [00:01<00:03, 93.71it/s] 33%|███▎      | 141/430 [00:01<00:03, 93.44it/s] 35%|███▌      | 151/430 [00:02<00:02, 93.49it/s] 37%|███▋      | 161/430 [00:02<00:02, 93.91it/s] 40%|███▉      | 171/430 [00:02<00:02, 94.86it/s] 42%|████▏     | 181/430 [00:02<00:02, 95.34it/s] 44%|████▍     | 191/430 [00:02<00:02, 95.61it/s] 47%|████▋     | 201/430 [00:02<00:02, 95.84it/s] 49%|████▉     | 211/430 [00:02<00:02, 96.20it/s] 51%|█████▏    | 221/430 [00:02<00:02, 96.33it/s] 54%|█████▎    | 231/430 [00:02<00:02, 96.48it/s] 56%|█████▌    | 241/430 [00:03<00:01, 96.17it/s] 58%|█████▊    | 251/430 [00:03<00:01, 96.14it/s] 61%|██████    | 261/430 [00:03<00:01, 95.69it/s] 63%|██████▎   | 271/430 [00:03<00:01, 95.91it/s] 65%|██████▌   | 281/430 [00:03<00:01, 95.72it/s] 68%|██████▊   | 291/430 [00:03<00:01, 95.62it/s] 70%|███████   | 301/430 [00:03<00:01, 95.92it/s] 72%|███████▏  | 311/430 [00:03<00:01, 95.83it/s] 75%|███████▍  | 321/430 [00:03<00:01, 95.86it/s] 77%|███████▋  | 331/430 [00:03<00:01, 96.04it/s] 79%|███████▉  | 341/430 [00:04<00:00, 96.19it/s] 82%|████████▏ | 351/430 [00:04<00:00, 96.22it/s] 84%|████████▍ | 361/430 [00:04<00:00, 95.66it/s] 86%|████████▋ | 371/430 [00:04<00:00, 95.72it/s] 89%|████████▊ | 381/430 [00:04<00:00, 96.07it/s] 91%|█████████ | 391/430 [00:04<00:00, 96.31it/s] 93%|█████████▎| 401/430 [00:04<00:00, 96.13it/s] 96%|█████████▌| 411/430 [00:04<00:00, 96.70it/s] 98%|█████████▊| 421/430 [00:04<00:00, 97.12it/s]100%|██████████| 430/430 [00:05<00:00, 85.95it/s]
55000 images processed, 5.110066652297974 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:33,  2.56it/s]  6%|▌         | 5/86 [00:00<00:06, 12.23it/s] 16%|█▋        | 14/86 [00:00<00:02, 32.36it/s] 27%|██▋       | 23/86 [00:00<00:01, 47.35it/s] 37%|███▋      | 32/86 [00:00<00:00, 59.07it/s] 49%|████▉     | 42/86 [00:00<00:00, 68.73it/s] 59%|█████▉    | 51/86 [00:01<00:00, 74.16it/s] 71%|███████   | 61/86 [00:01<00:00, 79.74it/s] 83%|████████▎ | 71/86 [00:01<00:00, 84.09it/s] 94%|█████████▍| 81/86 [00:01<00:00, 87.18it/s]100%|██████████| 86/86 [00:01<00:00, 61.03it/s]
11000 images processed, 1.432760238647461 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc2-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:29,  2.27it/s]  4%|▍         | 9/204 [00:00<00:09, 20.88it/s]  9%|▉         | 18/204 [00:00<00:04, 38.06it/s] 14%|█▎        | 28/204 [00:00<00:03, 53.72it/s] 19%|█▊        | 38/204 [00:00<00:02, 65.52it/s] 24%|██▎       | 48/204 [00:00<00:02, 74.05it/s] 28%|██▊       | 58/204 [00:01<00:01, 80.37it/s] 33%|███▎      | 68/204 [00:01<00:01, 84.79it/s] 38%|███▊      | 78/204 [00:01<00:01, 87.54it/s] 43%|████▎     | 88/204 [00:01<00:01, 89.88it/s] 48%|████▊     | 98/204 [00:01<00:01, 89.67it/s] 53%|█████▎    | 108/204 [00:01<00:01, 91.29it/s] 58%|█████▊    | 118/204 [00:01<00:00, 92.36it/s] 63%|██████▎   | 128/204 [00:01<00:00, 93.36it/s] 68%|██████▊   | 138/204 [00:01<00:00, 93.91it/s] 73%|███████▎  | 148/204 [00:02<00:00, 94.36it/s] 77%|███████▋  | 158/204 [00:02<00:00, 94.87it/s] 82%|████████▏ | 168/204 [00:02<00:00, 95.00it/s] 87%|████████▋ | 178/204 [00:02<00:00, 87.61it/s] 92%|█████████▏| 187/204 [00:02<00:00, 81.59it/s] 97%|█████████▋| 197/204 [00:02<00:00, 84.91it/s]100%|██████████| 204/204 [00:02<00:00, 76.07it/s]
26032 images processed, 2.71955943107605 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:50,  1.56it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.11it/s] 22%|██▏       | 17/79 [00:00<00:02, 22.13it/s] 34%|███▍      | 27/79 [00:01<00:01, 36.30it/s] 44%|████▍     | 35/79 [00:01<00:00, 44.93it/s] 57%|█████▋    | 45/79 [00:01<00:00, 56.17it/s] 67%|██████▋   | 53/79 [00:01<00:00, 58.17it/s] 80%|███████▉  | 63/79 [00:01<00:00, 67.49it/s] 92%|█████████▏| 73/79 [00:01<00:00, 75.25it/s]100%|██████████| 79/79 [00:02<00:00, 27.55it/s]
10000 images processed, 2.9336025714874268 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.96it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.13it/s] 25%|██▌       | 20/79 [00:00<00:01, 39.41it/s] 38%|███▊      | 30/79 [00:00<00:00, 53.87it/s] 49%|████▉     | 39/79 [00:00<00:00, 61.53it/s] 61%|██████    | 48/79 [00:01<00:00, 68.14it/s] 73%|███████▎  | 58/79 [00:01<00:00, 76.13it/s] 86%|████████▌ | 68/79 [00:01<00:00, 82.10it/s] 99%|█████████▊| 78/79 [00:01<00:00, 86.50it/s]100%|██████████| 79/79 [00:01<00:00, 58.48it/s]
10000 images processed, 1.3708128929138184 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:31,  2.17it/s] 13%|█▎        | 9/70 [00:00<00:03, 20.31it/s] 24%|██▍       | 17/70 [00:00<00:01, 33.98it/s] 37%|███▋      | 26/70 [00:00<00:00, 47.48it/s] 51%|█████▏    | 36/70 [00:00<00:00, 60.23it/s] 66%|██████▌   | 46/70 [00:01<00:00, 70.15it/s] 80%|████████  | 56/70 [00:01<00:00, 77.74it/s] 94%|█████████▍| 66/70 [00:01<00:00, 83.36it/s]100%|██████████| 70/70 [00:01<00:00, 55.96it/s]
8925 images processed, 1.2804346084594727 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:38,  1.14it/s]  4%|▍         | 2/45 [00:01<00:19,  2.15it/s] 16%|█▌        | 7/45 [00:01<00:04,  7.99it/s] 38%|███▊      | 17/45 [00:01<00:01, 22.09it/s] 49%|████▉     | 22/45 [00:01<00:01, 16.66it/s] 58%|█████▊    | 26/45 [00:02<00:01, 12.76it/s] 76%|███████▌  | 34/45 [00:02<00:00, 16.67it/s] 87%|████████▋ | 39/45 [00:02<00:00, 17.40it/s]100%|██████████| 45/45 [00:02<00:00, 15.22it/s]
5640 images processed, 2.976677417755127 seconds used

19.66249370574951
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.57  99.37  98.26
places365     74.38  78.16  79.29
LSUN           7.43  98.21  98.34
iSUN          68.26  83.64  87.18
dtd           39.84  90.09  94.15
AVG           38.49  89.89  91.44
Retain-Acc: 0.7235
Forget-as-OOD (retain known vs forget novel):
  FPR: 46.60 AUROC: 90.88 AUIN: 99.50
8.222657918930054
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc2-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-inc2-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:02,  2.35it/s]  2%|▏         | 8/430 [00:00<00:22, 18.89it/s]  4%|▍         | 17/430 [00:00<00:11, 36.65it/s]  6%|▋         | 27/430 [00:00<00:07, 52.32it/s]  9%|▊         | 37/430 [00:00<00:06, 63.81it/s] 11%|█         | 47/430 [00:00<00:05, 72.72it/s] 13%|█▎        | 57/430 [00:01<00:04, 79.64it/s] 16%|█▌        | 67/430 [00:01<00:04, 84.56it/s] 18%|█▊        | 77/430 [00:01<00:04, 88.11it/s] 20%|██        | 87/430 [00:01<00:03, 90.52it/s] 23%|██▎       | 97/430 [00:01<00:03, 91.92it/s] 25%|██▍       | 107/430 [00:01<00:03, 92.89it/s] 27%|██▋       | 117/430 [00:01<00:03, 94.00it/s] 30%|██▉       | 127/430 [00:01<00:03, 94.39it/s] 32%|███▏      | 137/430 [00:01<00:03, 94.82it/s] 34%|███▍      | 147/430 [00:02<00:02, 95.40it/s] 37%|███▋      | 157/430 [00:02<00:02, 95.84it/s] 39%|███▉      | 167/430 [00:02<00:02, 95.46it/s] 41%|████      | 177/430 [00:02<00:02, 95.70it/s] 43%|████▎     | 187/430 [00:02<00:02, 96.09it/s] 46%|████▌     | 197/430 [00:02<00:02, 95.79it/s] 48%|████▊     | 207/430 [00:02<00:02, 95.89it/s] 50%|█████     | 217/430 [00:02<00:02, 96.13it/s] 53%|█████▎    | 227/430 [00:02<00:02, 96.14it/s] 55%|█████▌    | 237/430 [00:02<00:02, 96.01it/s] 57%|█████▋    | 247/430 [00:03<00:01, 96.15it/s] 60%|█████▉    | 257/430 [00:03<00:01, 96.15it/s] 62%|██████▏   | 267/430 [00:03<00:01, 96.37it/s] 64%|██████▍   | 277/430 [00:03<00:01, 96.40it/s] 67%|██████▋   | 287/430 [00:03<00:01, 96.06it/s] 69%|██████▉   | 297/430 [00:03<00:01, 96.21it/s] 71%|███████▏  | 307/430 [00:03<00:01, 96.37it/s] 74%|███████▎  | 317/430 [00:03<00:01, 96.23it/s] 76%|███████▌  | 327/430 [00:03<00:01, 96.36it/s] 78%|███████▊  | 337/430 [00:03<00:00, 96.56it/s] 81%|████████  | 347/430 [00:04<00:00, 96.53it/s] 83%|████████▎ | 357/430 [00:04<00:00, 96.45it/s] 85%|████████▌ | 367/430 [00:04<00:00, 96.62it/s] 88%|████████▊ | 377/430 [00:04<00:00, 96.72it/s] 90%|█████████ | 387/430 [00:04<00:00, 96.79it/s] 92%|█████████▏| 397/430 [00:04<00:00, 96.61it/s] 95%|█████████▍| 407/430 [00:04<00:00, 96.13it/s] 97%|█████████▋| 417/430 [00:04<00:00, 96.71it/s] 99%|█████████▉| 427/430 [00:04<00:00, 97.12it/s]100%|██████████| 430/430 [00:04<00:00, 86.88it/s]
55000 images processed, 5.0181968212127686 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:34,  2.45it/s] 13%|█▎        | 11/86 [00:00<00:02, 27.15it/s] 24%|██▍       | 21/86 [00:00<00:01, 45.88it/s] 36%|███▌      | 31/86 [00:00<00:00, 59.79it/s] 48%|████▊     | 41/86 [00:00<00:00, 69.79it/s] 59%|█████▉    | 51/86 [00:00<00:00, 76.56it/s] 71%|███████   | 61/86 [00:01<00:00, 82.10it/s] 83%|████████▎ | 71/86 [00:01<00:00, 86.51it/s] 94%|█████████▍| 81/86 [00:01<00:00, 89.61it/s]100%|██████████| 86/86 [00:01<00:00, 65.80it/s]
11000 images processed, 1.3216757774353027 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:32,  2.20it/s]  5%|▍         | 10/204 [00:00<00:08, 22.84it/s] 10%|▉         | 20/204 [00:00<00:04, 41.15it/s] 15%|█▍        | 30/204 [00:00<00:03, 54.91it/s] 20%|█▉        | 40/204 [00:00<00:02, 65.63it/s] 24%|██▍       | 49/204 [00:00<00:02, 71.93it/s] 29%|██▉       | 59/204 [00:01<00:01, 78.60it/s] 34%|███▍      | 69/204 [00:01<00:01, 82.97it/s] 39%|███▊      | 79/204 [00:01<00:01, 86.00it/s] 44%|████▎     | 89/204 [00:01<00:01, 88.35it/s] 49%|████▊     | 99/204 [00:01<00:01, 90.03it/s] 53%|█████▎    | 109/204 [00:01<00:01, 91.44it/s] 58%|█████▊    | 119/204 [00:01<00:00, 92.57it/s] 63%|██████▎   | 129/204 [00:01<00:00, 92.70it/s] 68%|██████▊   | 139/204 [00:01<00:00, 93.54it/s] 73%|███████▎  | 149/204 [00:02<00:00, 94.07it/s] 78%|███████▊  | 159/204 [00:02<00:00, 94.59it/s] 83%|████████▎ | 169/204 [00:02<00:00, 94.67it/s] 88%|████████▊ | 179/204 [00:02<00:00, 94.71it/s] 93%|█████████▎| 189/204 [00:02<00:00, 95.42it/s] 98%|█████████▊| 199/204 [00:02<00:00, 95.84it/s]100%|██████████| 204/204 [00:02<00:00, 77.65it/s]
26032 images processed, 2.663553476333618 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:47,  1.63it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.07it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.55it/s] 37%|███▋      | 29/79 [00:00<00:01, 45.87it/s] 49%|████▉     | 39/79 [00:01<00:00, 57.75it/s] 62%|██████▏   | 49/79 [00:01<00:00, 67.59it/s] 75%|███████▍  | 59/79 [00:01<00:00, 75.40it/s] 87%|████████▋ | 69/79 [00:01<00:00, 81.44it/s]100%|██████████| 79/79 [00:02<00:00, 20.30it/s]100%|██████████| 79/79 [00:02<00:00, 30.09it/s]
10000 images processed, 2.659855604171753 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.95it/s] 14%|█▍        | 11/79 [00:00<00:02, 22.85it/s] 27%|██▋       | 21/79 [00:00<00:01, 39.99it/s] 39%|███▉      | 31/79 [00:00<00:00, 53.79it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.98it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.51it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.08it/s] 90%|████████▉ | 71/79 [00:01<00:00, 84.96it/s]100%|██████████| 79/79 [00:01<00:00, 59.45it/s]
10000 images processed, 1.3471577167510986 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:31,  2.16it/s] 13%|█▎        | 9/70 [00:00<00:03, 20.03it/s] 26%|██▌       | 18/70 [00:00<00:01, 37.09it/s] 40%|████      | 28/70 [00:00<00:00, 52.64it/s] 54%|█████▍    | 38/70 [00:00<00:00, 64.10it/s] 69%|██████▊   | 48/70 [00:00<00:00, 73.25it/s] 83%|████████▎ | 58/70 [00:01<00:00, 80.03it/s] 97%|█████████▋| 68/70 [00:01<00:00, 84.98it/s]100%|██████████| 70/70 [00:01<00:00, 57.25it/s]
8925 images processed, 1.2511005401611328 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.10it/s]  4%|▍         | 2/45 [00:01<00:19,  2.23it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.49it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.84it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.40it/s] 56%|█████▌    | 25/45 [00:01<00:00, 24.75it/s] 71%|███████   | 32/45 [00:01<00:00, 34.37it/s] 82%|████████▏ | 37/45 [00:02<00:00, 23.66it/s]100%|██████████| 45/45 [00:02<00:00, 20.96it/s]
5640 images processed, 2.1686601638793945 seconds used

18.04068613052368
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.72  99.73  95.11
places365     46.56  93.37  76.17
LSUN           7.36  98.46  90.41
iSUN          42.06  94.25  81.75
dtd           26.52  96.24  89.97
AVG           24.85  96.41  86.68
[incremental] Overall: 0.8850 New: 0.8860 Old: 0.8840
[incremental] Final(Top-1): 0.8850  Average: 0.9035
1.92722487449646
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-seen-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<04:01,  1.77it/s]  2%|▏         | 9/430 [00:00<00:24, 17.27it/s]  4%|▍         | 17/430 [00:00<00:13, 30.46it/s]  6%|▌         | 25/430 [00:00<00:09, 42.00it/s]  8%|▊         | 33/430 [00:00<00:07, 49.88it/s] 10%|▉         | 41/430 [00:01<00:06, 57.18it/s] 11%|█▏        | 49/430 [00:01<00:06, 61.98it/s] 13%|█▎        | 57/430 [00:01<00:05, 64.96it/s] 15%|█▌        | 65/430 [00:01<00:05, 68.21it/s] 17%|█▋        | 73/430 [00:01<00:05, 69.16it/s] 19%|█▉        | 81/430 [00:01<00:04, 71.68it/s] 21%|██        | 89/430 [00:01<00:04, 72.91it/s] 23%|██▎       | 97/430 [00:01<00:04, 72.44it/s] 24%|██▍       | 105/430 [00:01<00:04, 73.51it/s] 26%|██▋       | 113/430 [00:02<00:04, 72.68it/s] 28%|██▊       | 121/430 [00:02<00:04, 73.95it/s] 30%|███       | 129/430 [00:02<00:04, 72.89it/s] 32%|███▏      | 137/430 [00:02<00:03, 73.92it/s] 34%|███▍      | 146/430 [00:02<00:03, 76.07it/s] 36%|███▋      | 156/430 [00:02<00:03, 80.95it/s] 39%|███▊      | 166/430 [00:02<00:03, 85.56it/s] 41%|████      | 175/430 [00:02<00:03, 83.51it/s] 43%|████▎     | 184/430 [00:02<00:03, 80.40it/s] 45%|████▍     | 193/430 [00:03<00:02, 80.05it/s] 47%|████▋     | 202/430 [00:03<00:02, 77.40it/s] 49%|████▉     | 210/430 [00:03<00:02, 77.52it/s] 51%|█████     | 218/430 [00:03<00:02, 76.30it/s] 53%|█████▎    | 226/430 [00:03<00:02, 75.62it/s] 54%|█████▍    | 234/430 [00:03<00:02, 75.79it/s] 56%|█████▋    | 242/430 [00:03<00:02, 74.68it/s] 58%|█████▊    | 250/430 [00:03<00:02, 75.78it/s] 60%|██████    | 258/430 [00:03<00:02, 75.84it/s] 62%|██████▏   | 266/430 [00:04<00:02, 74.24it/s] 64%|██████▎   | 274/430 [00:04<00:02, 75.32it/s] 66%|██████▌   | 282/430 [00:04<00:02, 73.68it/s] 67%|██████▋   | 290/430 [00:04<00:01, 74.50it/s] 69%|██████▉   | 298/430 [00:04<00:01, 73.65it/s] 71%|███████   | 306/430 [00:04<00:01, 74.90it/s] 73%|███████▎  | 314/430 [00:04<00:01, 75.90it/s] 75%|███████▍  | 322/430 [00:04<00:01, 74.00it/s] 77%|███████▋  | 330/430 [00:04<00:01, 75.35it/s] 79%|███████▊  | 338/430 [00:05<00:01, 75.34it/s] 80%|████████  | 346/430 [00:05<00:01, 74.53it/s] 82%|████████▏ | 354/430 [00:05<00:01, 75.63it/s] 84%|████████▍ | 362/430 [00:05<00:00, 75.99it/s] 86%|████████▌ | 370/430 [00:05<00:00, 74.61it/s] 88%|████████▊ | 378/430 [00:05<00:00, 75.78it/s] 90%|████████▉ | 386/430 [00:05<00:00, 75.96it/s] 92%|█████████▏| 394/430 [00:05<00:00, 74.68it/s] 93%|█████████▎| 402/430 [00:05<00:00, 75.65it/s] 95%|█████████▌| 410/430 [00:05<00:00, 76.10it/s] 97%|█████████▋| 418/430 [00:06<00:00, 74.91it/s] 99%|█████████▉| 426/430 [00:06<00:00, 75.96it/s]100%|██████████| 430/430 [00:06<00:00, 68.98it/s]
55000 images processed, 6.347329378128052 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:40,  2.11it/s] 10%|█         | 9/86 [00:00<00:03, 19.51it/s] 20%|█▉        | 17/86 [00:00<00:02, 33.61it/s] 28%|██▊       | 24/86 [00:00<00:01, 42.40it/s] 37%|███▋      | 32/86 [00:00<00:01, 51.32it/s] 45%|████▌     | 39/86 [00:01<00:00, 56.00it/s] 55%|█████▍    | 47/86 [00:01<00:00, 61.06it/s] 63%|██████▎   | 54/86 [00:01<00:00, 62.75it/s] 71%|███████   | 61/86 [00:01<00:00, 64.22it/s] 80%|████████  | 69/86 [00:01<00:00, 67.78it/s] 90%|████████▉ | 77/86 [00:01<00:00, 68.21it/s] 99%|█████████▉| 85/86 [00:01<00:00, 70.23it/s]100%|██████████| 86/86 [00:01<00:00, 51.34it/s]
11000 images processed, 1.6995775699615479 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-seen-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:43,  1.96it/s]  3%|▎         | 7/204 [00:00<00:13, 14.37it/s]  7%|▋         | 14/204 [00:00<00:06, 27.34it/s] 11%|█         | 22/204 [00:00<00:04, 39.84it/s] 14%|█▍        | 29/204 [00:00<00:03, 47.50it/s] 18%|█▊        | 37/204 [00:01<00:03, 55.47it/s] 22%|██▏       | 44/204 [00:01<00:02, 58.68it/s] 25%|██▌       | 52/204 [00:01<00:02, 63.11it/s] 29%|██▉       | 59/204 [00:01<00:02, 64.45it/s] 33%|███▎      | 67/204 [00:01<00:02, 65.78it/s] 37%|███▋      | 75/204 [00:01<00:01, 67.87it/s] 40%|████      | 82/204 [00:01<00:01, 67.91it/s] 44%|████▍     | 90/204 [00:01<00:01, 68.77it/s] 48%|████▊     | 98/204 [00:01<00:01, 70.46it/s] 52%|█████▏    | 106/204 [00:02<00:01, 70.11it/s] 56%|█████▌    | 114/204 [00:02<00:01, 71.45it/s] 60%|█████▉    | 122/204 [00:02<00:01, 71.08it/s] 64%|██████▎   | 130/204 [00:02<00:01, 69.66it/s] 68%|██████▊   | 138/204 [00:02<00:00, 69.93it/s] 72%|███████▏  | 146/204 [00:02<00:00, 71.35it/s] 75%|███████▌  | 154/204 [00:02<00:00, 70.83it/s] 79%|███████▉  | 162/204 [00:02<00:00, 72.31it/s] 83%|████████▎ | 170/204 [00:02<00:00, 71.36it/s] 87%|████████▋ | 178/204 [00:03<00:00, 71.03it/s] 91%|█████████ | 186/204 [00:03<00:00, 72.37it/s] 95%|█████████▌| 194/204 [00:03<00:00, 73.01it/s] 99%|█████████▉| 202/204 [00:03<00:00, 72.85it/s]100%|██████████| 204/204 [00:03<00:00, 60.35it/s]
26032 images processed, 3.41961669921875 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.73it/s]  9%|▉         | 7/79 [00:00<00:05, 12.90it/s] 18%|█▊        | 14/79 [00:00<00:02, 25.18it/s] 27%|██▋       | 21/79 [00:00<00:01, 34.70it/s] 37%|███▋      | 29/79 [00:01<00:01, 44.85it/s] 46%|████▌     | 36/79 [00:01<00:00, 50.96it/s] 56%|█████▌    | 44/79 [00:01<00:00, 57.75it/s] 65%|██████▍   | 51/79 [00:01<00:00, 60.65it/s] 75%|███████▍  | 59/79 [00:01<00:00, 65.24it/s] 85%|████████▍ | 67/79 [00:01<00:00, 66.64it/s] 95%|█████████▍| 75/79 [00:01<00:00, 68.93it/s]100%|██████████| 79/79 [00:01<00:00, 46.11it/s]
10000 images processed, 1.7476794719696045 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.18it/s]  6%|▋         | 5/79 [00:00<00:06, 11.00it/s] 15%|█▌        | 12/79 [00:00<00:02, 25.27it/s] 25%|██▌       | 20/79 [00:00<00:01, 37.62it/s] 35%|███▌      | 28/79 [00:00<00:01, 48.08it/s] 44%|████▍     | 35/79 [00:01<00:00, 53.35it/s] 54%|█████▍    | 43/79 [00:01<00:00, 59.06it/s] 63%|██████▎   | 50/79 [00:01<00:00, 61.86it/s] 73%|███████▎  | 58/79 [00:01<00:00, 66.47it/s] 84%|████████▎ | 66/79 [00:01<00:00, 68.02it/s] 94%|█████████▎| 74/79 [00:01<00:00, 70.22it/s]100%|██████████| 79/79 [00:01<00:00, 49.56it/s]
10000 images processed, 1.6147475242614746 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:38,  1.77it/s] 11%|█▏        | 8/70 [00:00<00:04, 15.37it/s] 23%|██▎       | 16/70 [00:00<00:01, 28.60it/s] 34%|███▍      | 24/70 [00:00<00:01, 40.10it/s] 44%|████▍     | 31/70 [00:00<00:00, 47.32it/s] 56%|█████▌    | 39/70 [00:01<00:00, 54.77it/s] 67%|██████▋   | 47/70 [00:01<00:00, 59.25it/s] 79%|███████▊  | 55/70 [00:01<00:00, 64.32it/s] 90%|█████████ | 63/70 [00:01<00:00, 66.01it/s]100%|██████████| 70/70 [00:01<00:00, 45.78it/s]
8925 images processed, 1.560171365737915 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.02it/s]  9%|▉         | 4/45 [00:01<00:08,  4.66it/s] 27%|██▋       | 12/45 [00:01<00:02, 15.94it/s] 38%|███▊      | 17/45 [00:01<00:01, 17.48it/s] 51%|█████     | 23/45 [00:01<00:01, 21.24it/s] 69%|██████▉   | 31/45 [00:01<00:00, 31.03it/s] 80%|████████  | 36/45 [00:02<00:00, 22.68it/s] 98%|█████████▊| 44/45 [00:02<00:00, 30.89it/s]100%|██████████| 45/45 [00:02<00:00, 20.08it/s]
5640 images processed, 2.2644505500793457 seconds used

20.289992809295654
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.59  99.36  98.16
places365     74.59  78.00  78.38
LSUN           7.41  98.19  98.25
iSUN          69.25  83.28  86.43
dtd           40.21  89.96  93.81
AVG           38.81  89.76  91.01
Retain-Acc: 0.7268
Forget-as-OOD (retain known vs forget novel):
  FPR: 47.00 AUROC: 88.75 AUIN: 98.60
7.870081663131714
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage2-seen-forget_rf.png
==== Stage 3: inc={100,101,102,103,104}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3', adapter_load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2', forget_classes='0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='100,101,102,103,104', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:168: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:274: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [00:26<21:22, 26.17s/it]  4%|▍         | 2/50 [00:45<17:47, 22.25s/it]  6%|▌         | 3/50 [01:03<15:49, 20.21s/it]  8%|▊         | 4/50 [01:20<14:39, 19.11s/it] 10%|█         | 5/50 [01:41<14:40, 19.56s/it] 12%|█▏        | 6/50 [02:00<14:17, 19.49s/it][loss] ep 0 it 0 total=11.2549 mle=1.6702 pcon=5.2430 forget=1.3676 orth=2.9742 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 0 it 50 total=11.2225 mle=1.6465 pcon=5.2268 forget=1.3768 orth=2.9725 favg=0.0000 nr=104 nf=7 protos=570 fproto_sim=NA
[loss] ep 0 it 100 total=11.2680 mle=1.7173 pcon=5.2114 forget=1.3701 orth=2.9692 favg=0.0000 nr=98 nf=6 protos=570 fproto_sim=NA
[loss] ep 0 it 150 total=11.1619 mle=1.6904 pcon=5.1965 forget=1.3112 orth=2.9638 favg=0.0000 nr=102 nf=6 protos=570 fproto_sim=NA
[loss] ep 0 it 200 total=11.0147 mle=1.5600 pcon=5.1818 forget=1.3169 orth=2.9560 favg=0.0000 nr=107 nf=5 protos=570 fproto_sim=NA
[loss] ep 0 it 250 total=11.0923 mle=1.6062 pcon=5.1683 forget=1.3719 orth=2.9460 favg=0.0000 nr=100 nf=8 protos=570 fproto_sim=NA
[loss] ep 0 it 300 total=11.0224 mle=1.4287 pcon=5.1553 forget=1.5048 orth=2.9336 favg=0.0000 nr=106 nf=3 protos=570 fproto_sim=NA
[loss] ep 0 it 350 total=10.9798 mle=1.6006 pcon=5.1427 forget=1.3177 orth=2.9189 favg=0.0000 nr=101 nf=4 protos=570 fproto_sim=NA
[loss] ep 0 it 400 total=10.8654 mle=1.5297 pcon=5.1309 forget=1.3031 orth=2.9017 favg=0.0000 nr=101 nf=4 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 1 it 20 total=11.0682 mle=1.5823 pcon=5.1196 forget=1.4843 orth=2.8820 favg=0.0000 nr=110 nf=2 protos=570 fproto_sim=NA
[loss] ep 1 it 70 total=10.9062 mle=1.5782 pcon=5.1085 forget=1.3597 orth=2.8597 favg=0.0000 nr=94 nf=14 protos=570 fproto_sim=NA
[loss] ep 1 it 120 total=10.8453 mle=1.5255 pcon=5.0978 forget=1.3872 orth=2.8348 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 1 it 170 total=10.7591 mle=1.5254 pcon=5.0876 forget=1.3390 orth=2.8071 favg=0.0000 nr=101 nf=7 protos=570 fproto_sim=NA
[loss] ep 1 it 220 total=10.7571 mle=1.4989 pcon=5.0780 forget=1.4035 orth=2.7766 favg=0.0000 nr=110 nf=7 protos=570 fproto_sim=NA
[loss] ep 1 it 270 total=10.7438 mle=1.5511 pcon=5.0689 forget=1.3806 orth=2.7432 favg=0.0000 nr=105 nf=11 protos=570 fproto_sim=NA
[loss] ep 1 it 320 total=10.8625 mle=1.6949 pcon=5.0599 forget=1.4009 orth=2.7067 favg=0.0000 nr=104 nf=5 protos=570 fproto_sim=NA
[loss] ep 1 it 370 total=10.6617 mle=1.5916 pcon=5.0518 forget=1.3510 orth=2.6672 favg=0.0000 nr=104 nf=5 protos=570 fproto_sim=NA
[loss] ep 1 it 420 total=10.5368 mle=1.5098 pcon=5.0437 forget=1.3587 orth=2.6246 favg=0.0000 nr=103 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 2 it 40 total=10.5049 mle=1.5903 pcon=5.0361 forget=1.2998 orth=2.5787 favg=0.0000 nr=108 nf=5 protos=570 fproto_sim=NA
[loss] ep 2 it 90 total=10.3565 mle=1.4708 pcon=5.0287 forget=1.3274 orth=2.5297 favg=0.0000 nr=97 nf=8 protos=570 fproto_sim=NA
[loss] ep 2 it 140 total=10.4313 mle=1.6064 pcon=5.0218 forget=1.3258 orth=2.4773 favg=0.0000 nr=103 nf=4 protos=570 fproto_sim=NA
[loss] ep 2 it 190 total=10.2761 mle=1.4625 pcon=5.0152 forget=1.3766 orth=2.4218 favg=0.0000 nr=113 nf=1 protos=570 fproto_sim=NA
[loss] ep 2 it 240 total=10.1340 mle=1.4562 pcon=5.0086 forget=1.3059 orth=2.3632 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 2 it 290 total=10.1138 mle=1.5052 pcon=5.0024 forget=1.3045 orth=2.3016 favg=0.0000 nr=112 nf=5 protos=570 fproto_sim=NA
[loss] ep 2 it 340 total=10.0736 mle=1.5534 pcon=4.9964 forget=1.2866 orth=2.2372 favg=0.0000 nr=100 nf=5 protos=570 fproto_sim=NA
[loss] ep 2 it 390 total=10.1471 mle=1.6405 pcon=4.9911 forget=1.3452 orth=2.1703 favg=0.0000 nr=97 nf=9 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 3 it 10 total=9.8876 mle=1.4774 pcon=4.9856 forget=1.3238 orth=2.1009 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 3 it 60 total=9.9143 mle=1.5805 pcon=4.9803 forget=1.3238 orth=2.0297 favg=0.0000 nr=104 nf=10 protos=570 fproto_sim=NA
[loss] ep 3 it 110 total=9.9924 mle=1.7070 pcon=4.9755 forget=1.3529 orth=1.9570 favg=0.0000 nr=107 nf=7 protos=570 fproto_sim=NA
[loss] ep 3 it 160 total=9.7526 mle=1.5805 pcon=4.9704 forget=1.3185 orth=1.8832 favg=0.0000 nr=101 nf=6 protos=570 fproto_sim=NA
[loss] ep 3 it 210 total=9.8376 mle=1.7522 pcon=4.9657 forget=1.3109 orth=1.8088 favg=0.0000 nr=104 nf=4 protos=570 fproto_sim=NA
[loss] ep 3 it 260 total=9.6653 mle=1.6227 pcon=4.9612 forget=1.3469 orth=1.7344 favg=0.0000 nr=108 nf=3 protos=570 fproto_sim=NA
[loss] ep 3 it 310 total=9.6159 mle=1.6137 pcon=4.9568 forget=1.3849 orth=1.6604 favg=0.0000 nr=113 nf=4 protos=570 fproto_sim=NA
[loss] ep 3 it 360 total=9.3878 mle=1.5061 pcon=4.9527 forget=1.3416 orth=1.5874 favg=0.0000 nr=105 nf=8 protos=570 fproto_sim=NA
[loss] ep 3 it 410 total=9.2355 mle=1.4627 pcon=4.9486 forget=1.3083 orth=1.5158 favg=0.0000 nr=102 nf=7 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 4 it 30 total=9.2212 mle=1.5339 pcon=4.9449 forget=1.2960 orth=1.4464 favg=0.0000 nr=108 nf=7 protos=570 fproto_sim=NA
[loss] ep 4 it 80 total=9.4037 mle=1.6296 pcon=4.9411 forget=1.4537 orth=1.3794 favg=0.0000 nr=106 nf=5 protos=570 fproto_sim=NA
[loss] ep 4 it 130 total=9.1360 mle=1.5350 pcon=4.9377 forget=1.3483 orth=1.3151 favg=0.0000 nr=99 nf=6 protos=570 fproto_sim=NA
[loss] ep 4 it 180 total=9.2215 mle=1.6179 pcon=4.9345 forget=1.4155 orth=1.2536 favg=0.0000 nr=106 nf=7 protos=570 fproto_sim=NA
[loss] ep 4 it 230 total=9.1400 mle=1.6255 pcon=4.9312 forget=1.3876 orth=1.1956 favg=0.0000 nr=107 nf=7 protos=570 fproto_sim=NA
[loss] ep 4 it 280 total=8.9063 mle=1.5264 pcon=4.9279 forget=1.3112 orth=1.1409 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 4 it 330 total=9.0163 mle=1.6350 pcon=4.9249 forget=1.3669 orth=1.0895 favg=0.0000 nr=103 nf=4 protos=570 fproto_sim=NA
[loss] ep 4 it 380 total=8.7715 mle=1.4996 pcon=4.9220 forget=1.3086 orth=1.0413 favg=0.0000 nr=100 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 5 it 0 total=8.6657 mle=1.4646 pcon=4.9192 forget=1.2855 orth=0.9964 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 5 it 50 total=8.9046 mle=1.7080 pcon=4.9166 forget=1.3253 orth=0.9548 favg=0.0000 nr=105 nf=10 protos=570 fproto_sim=NA
[loss] ep 5 it 100 total=8.7608 mle=1.6158 pcon=4.9142 forget=1.3148 orth=0.9161 favg=0.0000 nr=105 nf=7 protos=570 fproto_sim=NA
[loss] ep 5 it 150 total=8.6565 mle=1.5745 pcon=4.9116 forget=1.2902 orth=0.8803 favg=0.0000 nr=103 nf=5 protos=570 fproto_sim=NA
[loss] ep 5 it 200 total=8.5399 mle=1.4477 pcon=4.9091 forget=1.3360 orth=0.8471 favg=0.0000 nr=107 nf=1 protos=570 fproto_sim=NA
[loss] ep 5 it 250 total=8.7395 mle=1.6236 pcon=4.9066 forget=1.3929 orth=0.8165 favg=0.0000 nr=102 nf=7 protos=570 fproto_sim=NA
[loss] ep 5 it 300 total=8.6756 mle=1.6071 pcon=4.9041 forget=1.3763 orth=0.7881 favg=0.0000 nr=99 nf=6 protos=570 fproto_sim=NA
[loss] ep 5 it 350 total=8.4569 mle=1.5095 pcon=4.9018 forget=1.2842 orth=0.7614 favg=0.0000 nr=115 nf=4 protos=570 fproto_sim=NA
[loss] ep 5 it 400 total=8.5234 mle=1.5471 pcon=4.8997 forget=1.3397 orth=0.7369 favg=0.0000 nr=101 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
 14%|█▍        | 7/50 [02:17<13:23, 18.69s/it] 16%|█▌        | 8/50 [02:38<13:29, 19.27s/it] 18%|█▊        | 9/50 [02:55<12:43, 18.61s/it] 20%|██        | 10/50 [03:14<12:26, 18.67s/it] 22%|██▏       | 11/50 [03:31<11:58, 18.42s/it] 24%|██▍       | 12/50 [03:49<11:29, 18.14s/it][loss] ep 6 it 20 total=8.5354 mle=1.6551 pcon=4.8975 forget=1.2688 orth=0.7140 favg=0.0000 nr=109 nf=1 protos=570 fproto_sim=NA
[loss] ep 6 it 70 total=8.3741 mle=1.4853 pcon=4.8954 forget=1.3010 orth=0.6925 favg=0.0000 nr=104 nf=6 protos=570 fproto_sim=NA
[loss] ep 6 it 120 total=8.4740 mle=1.6222 pcon=4.8933 forget=1.2862 orth=0.6724 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 6 it 170 total=8.3116 mle=1.4581 pcon=4.8914 forget=1.3087 orth=0.6534 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 6 it 220 total=8.4202 mle=1.5801 pcon=4.8895 forget=1.3152 orth=0.6354 favg=0.0000 nr=100 nf=4 protos=570 fproto_sim=NA
[loss] ep 6 it 270 total=8.3686 mle=1.5588 pcon=4.8878 forget=1.3034 orth=0.6186 favg=0.0000 nr=98 nf=9 protos=570 fproto_sim=NA
[loss] ep 6 it 320 total=8.3274 mle=1.5573 pcon=4.8858 forget=1.2819 orth=0.6025 favg=0.0000 nr=112 nf=4 protos=570 fproto_sim=NA
[loss] ep 6 it 370 total=8.3968 mle=1.6217 pcon=4.8839 forget=1.3040 orth=0.5872 favg=0.0000 nr=109 nf=1 protos=570 fproto_sim=NA
[loss] ep 6 it 420 total=8.2872 mle=1.5339 pcon=4.8823 forget=1.2984 orth=0.5727 favg=0.0000 nr=104 nf=5 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 7 it 40 total=8.2871 mle=1.5545 pcon=4.8807 forget=1.2932 orth=0.5587 favg=0.0000 nr=104 nf=10 protos=570 fproto_sim=NA
[loss] ep 7 it 90 total=8.3150 mle=1.5794 pcon=4.8791 forget=1.3112 orth=0.5454 favg=0.0000 nr=106 nf=10 protos=570 fproto_sim=NA
[loss] ep 7 it 140 total=8.3045 mle=1.5785 pcon=4.8774 forget=1.3159 orth=0.5327 favg=0.0000 nr=108 nf=6 protos=570 fproto_sim=NA
[loss] ep 7 it 190 total=8.2868 mle=1.5952 pcon=4.8758 forget=1.2952 orth=0.5205 favg=0.0000 nr=107 nf=5 protos=570 fproto_sim=NA
[loss] ep 7 it 240 total=8.2063 mle=1.5063 pcon=4.8743 forget=1.3168 orth=0.5089 favg=0.0000 nr=105 nf=3 protos=570 fproto_sim=NA
[loss] ep 7 it 290 total=8.1817 mle=1.5252 pcon=4.8727 forget=1.2862 orth=0.4977 favg=0.0000 nr=108 nf=6 protos=570 fproto_sim=NA
[loss] ep 7 it 340 total=8.3096 mle=1.6089 pcon=4.8709 forget=1.3429 orth=0.4868 favg=0.0000 nr=104 nf=9 protos=570 fproto_sim=NA
[loss] ep 7 it 390 total=8.1394 mle=1.4973 pcon=4.8696 forget=1.2961 orth=0.4765 favg=0.0000 nr=103 nf=11 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 8 it 10 total=8.2642 mle=1.6524 pcon=4.8681 forget=1.2771 orth=0.4665 favg=0.0000 nr=108 nf=1 protos=570 fproto_sim=NA
[loss] ep 8 it 60 total=8.2124 mle=1.5866 pcon=4.8666 forget=1.3023 orth=0.4570 favg=0.0000 nr=106 nf=8 protos=570 fproto_sim=NA
[loss] ep 8 it 110 total=8.2660 mle=1.6241 pcon=4.8652 forget=1.3290 orth=0.4477 favg=0.0000 nr=99 nf=13 protos=570 fproto_sim=NA
[loss] ep 8 it 160 total=8.2077 mle=1.6259 pcon=4.8638 forget=1.2791 orth=0.4390 favg=0.0000 nr=110 nf=4 protos=570 fproto_sim=NA
[loss] ep 8 it 210 total=8.1486 mle=1.5558 pcon=4.8624 forget=1.2999 orth=0.4304 favg=0.0000 nr=102 nf=7 protos=570 fproto_sim=NA
[loss] ep 8 it 260 total=8.1179 mle=1.5389 pcon=4.8609 forget=1.2958 orth=0.4222 favg=0.0000 nr=101 nf=8 protos=570 fproto_sim=NA
[loss] ep 8 it 310 total=8.1431 mle=1.5788 pcon=4.8596 forget=1.2905 orth=0.4143 favg=0.0000 nr=99 nf=12 protos=570 fproto_sim=NA
[loss] ep 8 it 360 total=8.0766 mle=1.5252 pcon=4.8585 forget=1.2863 orth=0.4066 favg=0.0000 nr=100 nf=9 protos=570 fproto_sim=NA
[loss] ep 8 it 410 total=8.1204 mle=1.5322 pcon=4.8572 forget=1.3317 orth=0.3993 favg=0.0000 nr=108 nf=3 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 9 it 30 total=8.0951 mle=1.5220 pcon=4.8560 forget=1.3249 orth=0.3921 favg=0.0000 nr=99 nf=10 protos=570 fproto_sim=NA
[loss] ep 9 it 80 total=8.1112 mle=1.5826 pcon=4.8550 forget=1.2884 orth=0.3852 favg=0.0000 nr=112 nf=6 protos=570 fproto_sim=NA
[loss] ep 9 it 130 total=8.2021 mle=1.6586 pcon=4.8539 forget=1.3110 orth=0.3786 favg=0.0000 nr=103 nf=8 protos=570 fproto_sim=NA
[loss] ep 9 it 180 total=8.1159 mle=1.5684 pcon=4.8530 forget=1.3223 orth=0.3722 favg=0.0000 nr=111 nf=3 protos=570 fproto_sim=NA
[loss] ep 9 it 230 total=8.0872 mle=1.5718 pcon=4.8518 forget=1.2976 orth=0.3660 favg=0.0000 nr=101 nf=8 protos=570 fproto_sim=NA
[loss] ep 9 it 280 total=7.9592 mle=1.4683 pcon=4.8508 forget=1.2801 orth=0.3600 favg=0.0000 nr=102 nf=5 protos=570 fproto_sim=NA
[loss] ep 9 it 330 total=8.1065 mle=1.6259 pcon=4.8498 forget=1.2765 orth=0.3543 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 9 it 380 total=8.1329 mle=1.6573 pcon=4.8488 forget=1.2781 orth=0.3488 favg=0.0000 nr=104 nf=8 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 10 it 0 total=8.0753 mle=1.6083 pcon=4.8478 forget=1.2758 orth=0.3434 favg=0.0000 nr=114 nf=5 protos=570 fproto_sim=NA
[loss] ep 10 it 50 total=7.9616 mle=1.4526 pcon=4.8469 forget=1.3239 orth=0.3383 favg=0.0000 nr=101 nf=9 protos=570 fproto_sim=NA
[loss] ep 10 it 100 total=8.1296 mle=1.6668 pcon=4.8460 forget=1.2836 orth=0.3333 favg=0.0000 nr=97 nf=11 protos=570 fproto_sim=NA
[loss] ep 10 it 150 total=8.1372 mle=1.6784 pcon=4.8450 forget=1.2851 orth=0.3286 favg=0.0000 nr=110 nf=5 protos=570 fproto_sim=NA
[loss] ep 10 it 200 total=8.1653 mle=1.7244 pcon=4.8442 forget=1.2727 orth=0.3241 favg=0.0000 nr=105 nf=3 protos=570 fproto_sim=NA
[loss] ep 10 it 250 total=8.0352 mle=1.5724 pcon=4.8434 forget=1.2996 orth=0.3198 favg=0.0000 nr=103 nf=4 protos=570 fproto_sim=NA
[loss] ep 10 it 300 total=8.1256 mle=1.6917 pcon=4.8422 forget=1.2761 orth=0.3156 favg=0.0000 nr=108 nf=4 protos=570 fproto_sim=NA
[loss] ep 10 it 350 total=8.1084 mle=1.6618 pcon=4.8414 forget=1.2935 orth=0.3116 favg=0.0000 nr=107 nf=5 protos=570 fproto_sim=NA
[loss] ep 10 it 400 total=8.0700 mle=1.6349 pcon=4.8407 forget=1.2867 orth=0.3077 favg=0.0000 nr=116 nf=4 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 11 it 20 total=8.0525 mle=1.6048 pcon=4.8400 forget=1.3036 orth=0.3040 favg=0.0000 nr=106 nf=10 protos=570 fproto_sim=NA
[loss] ep 11 it 70 total=7.9696 mle=1.5607 pcon=4.8391 forget=1.2693 orth=0.3004 favg=0.0000 nr=106 nf=4 protos=570 fproto_sim=NA
[loss] ep 11 it 120 total=8.0373 mle=1.6212 pcon=4.8385 forget=1.2807 orth=0.2969 favg=0.0000 nr=102 nf=4 protos=570 fproto_sim=NA
[loss] ep 11 it 170 total=8.1127 mle=1.6867 pcon=4.8378 forget=1.2947 orth=0.2935 favg=0.0000 nr=99 nf=5 protos=570 fproto_sim=NA
[loss] ep 11 it 220 total=8.0455 mle=1.6344 pcon=4.8371 forget=1.2838 orth=0.2903 favg=0.0000 nr=99 nf=5 protos=570 fproto_sim=NA
[loss] ep 11 it 270 total=7.9417 mle=1.5595 pcon=4.8365 forget=1.2586 orth=0.2871 favg=0.0000 nr=109 nf=4 protos=570 fproto_sim=NA
[loss] ep 11 it 320 total=7.9159 mle=1.5312 pcon=4.8358 forget=1.2648 orth=0.2841 favg=0.0000 nr=104 nf=9 protos=570 fproto_sim=NA
[loss] ep 11 it 370 total=7.9497 mle=1.5486 pcon=4.8352 forget=1.2848 orth=0.2811 favg=0.0000 nr=106 nf=8 protos=570 fproto_sim=NA
[loss] ep 11 it 420 total=7.9264 mle=1.5540 pcon=4.8347 forget=1.2594 orth=0.2783 favg=0.0000 nr=106 nf=5 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
 26%|██▌       | 13/50 [04:07<11:12, 18.17s/it] 28%|██▊       | 14/50 [04:31<11:50, 19.75s/it] 30%|███       | 15/50 [04:45<10:33, 18.11s/it] 32%|███▏      | 16/50 [05:00<09:44, 17.19s/it] 34%|███▍      | 17/50 [05:15<09:01, 16.42s/it] 36%|███▌      | 18/50 [05:30<08:33, 16.04s/it][loss] ep 12 it 40 total=8.0113 mle=1.6358 pcon=4.8342 forget=1.2658 orth=0.2755 favg=0.0000 nr=98 nf=12 protos=570 fproto_sim=NA
[loss] ep 12 it 90 total=8.0707 mle=1.5815 pcon=4.8335 forget=1.3829 orth=0.2728 favg=0.0000 nr=109 nf=8 protos=570 fproto_sim=NA
[loss] ep 12 it 140 total=7.9028 mle=1.5446 pcon=4.8331 forget=1.2549 orth=0.2702 favg=0.0000 nr=103 nf=5 protos=570 fproto_sim=NA
[loss] ep 12 it 190 total=7.9881 mle=1.5952 pcon=4.8325 forget=1.2929 orth=0.2676 favg=0.0000 nr=109 nf=3 protos=570 fproto_sim=NA
[loss] ep 12 it 240 total=7.9540 mle=1.5602 pcon=4.8319 forget=1.2967 orth=0.2651 favg=0.0000 nr=98 nf=8 protos=570 fproto_sim=NA
[loss] ep 12 it 290 total=7.9227 mle=1.5777 pcon=4.8317 forget=1.2507 orth=0.2627 favg=0.0000 nr=105 nf=3 protos=570 fproto_sim=NA
[loss] ep 12 it 340 total=8.1068 mle=1.6331 pcon=4.8314 forget=1.3820 orth=0.2603 favg=0.0000 nr=109 nf=3 protos=570 fproto_sim=NA
[loss] ep 12 it 390 total=7.9826 mle=1.5946 pcon=4.8310 forget=1.2989 orth=0.2580 favg=0.0000 nr=107 nf=3 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 13 it 10 total=7.9578 mle=1.6018 pcon=4.8306 forget=1.2696 orth=0.2557 favg=0.0000 nr=108 nf=6 protos=570 fproto_sim=NA
[loss] ep 13 it 60 total=7.9839 mle=1.6486 pcon=4.8300 forget=1.2517 orth=0.2535 favg=0.0000 nr=103 nf=8 protos=570 fproto_sim=NA
[loss] ep 13 it 110 total=7.9840 mle=1.6482 pcon=4.8294 forget=1.2551 orth=0.2514 favg=0.0000 nr=106 nf=3 protos=570 fproto_sim=NA
[loss] ep 13 it 160 total=7.9677 mle=1.6175 pcon=4.8290 forget=1.2719 orth=0.2493 favg=0.0000 nr=104 nf=6 protos=570 fproto_sim=NA
[loss] ep 13 it 210 total=7.9151 mle=1.5731 pcon=4.8286 forget=1.2661 orth=0.2473 favg=0.0000 nr=109 nf=3 protos=570 fproto_sim=NA
[loss] ep 13 it 260 total=7.8911 mle=1.5465 pcon=4.8281 forget=1.2712 orth=0.2453 favg=0.0000 nr=106 nf=7 protos=570 fproto_sim=NA
[loss] ep 13 it 310 total=7.9741 mle=1.6331 pcon=4.8277 forget=1.2700 orth=0.2434 favg=0.0000 nr=97 nf=8 protos=570 fproto_sim=NA
[loss] ep 13 it 360 total=7.9014 mle=1.5705 pcon=4.8272 forget=1.2622 orth=0.2415 favg=0.0000 nr=106 nf=4 protos=570 fproto_sim=NA
[loss] ep 13 it 410 total=7.9796 mle=1.6645 pcon=4.8267 forget=1.2488 orth=0.2396 favg=0.0000 nr=111 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 14 it 30 total=8.0466 mle=1.6507 pcon=4.8263 forget=1.3318 orth=0.2378 favg=0.0000 nr=104 nf=7 protos=570 fproto_sim=NA
[loss] ep 14 it 80 total=7.9723 mle=1.6566 pcon=4.8258 forget=1.2539 orth=0.2360 favg=0.0000 nr=101 nf=4 protos=570 fproto_sim=NA
[loss] ep 14 it 130 total=6.6851 mle=1.6253 pcon=4.8255 forget=0.0000 orth=0.2343 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 180 total=7.8646 mle=1.5524 pcon=4.8248 forget=1.2548 orth=0.2326 favg=0.0000 nr=99 nf=3 protos=570 fproto_sim=NA
[loss] ep 14 it 230 total=7.8905 mle=1.5842 pcon=4.8245 forget=1.2509 orth=0.2309 favg=0.0000 nr=108 nf=2 protos=570 fproto_sim=NA
[loss] ep 14 it 280 total=7.8813 mle=1.5709 pcon=4.8239 forget=1.2573 orth=0.2292 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 14 it 330 total=7.9024 mle=1.5676 pcon=4.8234 forget=1.2838 orth=0.2276 favg=0.0000 nr=110 nf=4 protos=570 fproto_sim=NA
[loss] ep 14 it 380 total=7.9310 mle=1.6047 pcon=4.8231 forget=1.2772 orth=0.2260 favg=0.0000 nr=105 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 15 it 0 total=7.9347 mle=1.6111 pcon=4.8226 forget=1.2765 orth=0.2245 favg=0.0000 nr=103 nf=10 protos=570 fproto_sim=NA
[loss] ep 15 it 50 total=7.9038 mle=1.5953 pcon=4.8222 forget=1.2634 orth=0.2229 favg=0.0000 nr=93 nf=10 protos=570 fproto_sim=NA
[loss] ep 15 it 100 total=7.9237 mle=1.6033 pcon=4.8218 forget=1.2772 orth=0.2214 favg=0.0000 nr=104 nf=4 protos=570 fproto_sim=NA
[loss] ep 15 it 150 total=7.9058 mle=1.5892 pcon=4.8212 forget=1.2753 orth=0.2200 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 15 it 200 total=8.0307 mle=1.6713 pcon=4.8209 forget=1.3199 orth=0.2185 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 15 it 250 total=7.8807 mle=1.5545 pcon=4.8204 forget=1.2887 orth=0.2172 favg=0.0000 nr=103 nf=5 protos=570 fproto_sim=NA
[loss] ep 15 it 300 total=7.9214 mle=1.6106 pcon=4.8200 forget=1.2749 orth=0.2158 favg=0.0000 nr=106 nf=3 protos=570 fproto_sim=NA
[loss] ep 15 it 350 total=7.8448 mle=1.5186 pcon=4.8197 forget=1.2921 orth=0.2144 favg=0.0000 nr=97 nf=10 protos=570 fproto_sim=NA
[loss] ep 15 it 400 total=7.9446 mle=1.6178 pcon=4.8192 forget=1.2945 orth=0.2131 favg=0.0000 nr=100 nf=3 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 16 it 20 total=7.9976 mle=1.6776 pcon=4.8189 forget=1.2892 orth=0.2118 favg=0.0000 nr=108 nf=10 protos=570 fproto_sim=NA
[loss] ep 16 it 70 total=7.9818 mle=1.6114 pcon=4.8187 forget=1.3410 orth=0.2106 favg=0.0000 nr=112 nf=5 protos=570 fproto_sim=NA
[loss] ep 16 it 120 total=7.9560 mle=1.5904 pcon=4.8184 forget=1.3379 orth=0.2093 favg=0.0000 nr=111 nf=6 protos=570 fproto_sim=NA
[loss] ep 16 it 170 total=7.9716 mle=1.6572 pcon=4.8181 forget=1.2882 orth=0.2081 favg=0.0000 nr=110 nf=7 protos=570 fproto_sim=NA
[loss] ep 16 it 220 total=8.0109 mle=1.6710 pcon=4.8176 forget=1.3155 orth=0.2069 favg=0.0000 nr=95 nf=7 protos=570 fproto_sim=NA
[loss] ep 16 it 270 total=7.8559 mle=1.5416 pcon=4.8172 forget=1.2914 orth=0.2057 favg=0.0000 nr=106 nf=8 protos=570 fproto_sim=NA
[loss] ep 16 it 320 total=7.9163 mle=1.6015 pcon=4.8168 forget=1.2934 orth=0.2046 favg=0.0000 nr=102 nf=6 protos=570 fproto_sim=NA
[loss] ep 16 it 370 total=7.9806 mle=1.6644 pcon=4.8163 forget=1.2964 orth=0.2035 favg=0.0000 nr=109 nf=6 protos=570 fproto_sim=NA
[loss] ep 16 it 420 total=7.9288 mle=1.6107 pcon=4.8161 forget=1.2996 orth=0.2024 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 17 it 40 total=8.0099 mle=1.6908 pcon=4.8160 forget=1.3019 orth=0.2013 favg=0.0000 nr=102 nf=6 protos=570 fproto_sim=NA
[loss] ep 17 it 90 total=8.0808 mle=1.7056 pcon=4.8158 forget=1.3592 orth=0.2002 favg=0.0000 nr=111 nf=5 protos=570 fproto_sim=NA
[loss] ep 17 it 140 total=7.9296 mle=1.6021 pcon=4.8153 forget=1.3131 orth=0.1991 favg=0.0000 nr=103 nf=4 protos=570 fproto_sim=NA
[loss] ep 17 it 190 total=8.0190 mle=1.6900 pcon=4.8149 forget=1.3159 orth=0.1981 favg=0.0000 nr=98 nf=8 protos=570 fproto_sim=NA
[loss] ep 17 it 240 total=7.8979 mle=1.5771 pcon=4.8146 forget=1.3092 orth=0.1971 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 17 it 290 total=7.9814 mle=1.6600 pcon=4.8144 forget=1.3110 orth=0.1961 favg=0.0000 nr=103 nf=9 protos=570 fproto_sim=NA
[loss] ep 17 it 340 total=7.9180 mle=1.5950 pcon=4.8141 forget=1.3139 orth=0.1951 favg=0.0000 nr=102 nf=8 protos=570 fproto_sim=NA
[loss] ep 17 it 390 total=7.8812 mle=1.5455 pcon=4.8139 forget=1.3277 orth=0.1941 favg=0.0000 nr=96 nf=6 protos=570 fproto_sim=NA
[loss] ep 18 it 10 total=7.8993 mle=1.5656 pcon=4.8138 forget=1.3269 orth=0.1931 favg=0.0000 nr=106 nf=7 protos=570 fproto_sim=NA
[loss] ep 18 it 60 total=7.8931 mle=1.5662 pcon=4.8135 forget=1.3212 orth=0.1922 favg=0.0000 nr=106 nf=3 protos=570 fproto_sim=NA
[loss] ep 18 it 110 total=7.9592 mle=1.6255 pcon=4.8133 forget=1.3291 orth=0.1913 favg=0.0000 nr=109 nf=4 protos=570 fproto_sim=NA
[loss] ep 18 it 160 total=7.9420 mle=1.6091 pcon=4.8130 forget=1.3295 orth=0.1904 favg=0.0000 nr=110 nf=4 protos=570 fproto_sim=NA
 38%|███▊      | 19/50 [05:46<08:16, 16.02s/it] 40%|████      | 20/50 [06:00<07:48, 15.61s/it] 42%|████▏     | 21/50 [06:15<07:27, 15.42s/it] 44%|████▍     | 22/50 [06:32<07:23, 15.83s/it] 46%|████▌     | 23/50 [06:48<07:07, 15.83s/it] 48%|████▊     | 24/50 [07:04<06:54, 15.92s/it] 50%|█████     | 25/50 [07:20<06:34, 15.77s/it][loss] ep 18 it 210 total=7.9656 mle=1.5946 pcon=4.8129 forget=1.3686 orth=0.1894 favg=0.0000 nr=109 nf=5 protos=570 fproto_sim=NA
[loss] ep 18 it 260 total=8.0444 mle=1.7103 pcon=4.8128 forget=1.3328 orth=0.1885 favg=0.0000 nr=103 nf=6 protos=570 fproto_sim=NA
[loss] ep 18 it 310 total=7.9076 mle=1.5683 pcon=4.8125 forget=1.3392 orth=0.1877 favg=0.0000 nr=107 nf=4 protos=570 fproto_sim=NA
[loss] ep 18 it 360 total=7.9460 mle=1.5993 pcon=4.8122 forget=1.3476 orth=0.1868 favg=0.0000 nr=108 nf=5 protos=570 fproto_sim=NA
[loss] ep 18 it 410 total=7.9767 mle=1.6320 pcon=4.8119 forget=1.3467 orth=0.1860 favg=0.0000 nr=97 nf=10 protos=570 fproto_sim=NA
[loss] ep 19 it 30 total=7.9838 mle=1.6468 pcon=4.8117 forget=1.3401 orth=0.1852 favg=0.0000 nr=102 nf=4 protos=570 fproto_sim=NA
[loss] ep 19 it 80 total=8.0605 mle=1.7138 pcon=4.8116 forget=1.3508 orth=0.1844 favg=0.0000 nr=106 nf=4 protos=570 fproto_sim=NA
[loss] ep 19 it 130 total=8.0148 mle=1.6737 pcon=4.8113 forget=1.3463 orth=0.1836 favg=0.0000 nr=101 nf=6 protos=570 fproto_sim=NA
[loss] ep 19 it 180 total=8.0140 mle=1.5957 pcon=4.8112 forget=1.4244 orth=0.1828 favg=0.0000 nr=110 nf=7 protos=570 fproto_sim=NA
[loss] ep 19 it 230 total=7.9703 mle=1.5929 pcon=4.8111 forget=1.3843 orth=0.1820 favg=0.0000 nr=108 nf=5 protos=570 fproto_sim=NA
[loss] ep 19 it 280 total=7.9146 mle=1.5701 pcon=4.8110 forget=1.3522 orth=0.1813 favg=0.0000 nr=105 nf=8 protos=570 fproto_sim=NA
[loss] ep 19 it 330 total=8.0406 mle=1.6670 pcon=4.8109 forget=1.3822 orth=0.1805 favg=0.0000 nr=99 nf=5 protos=570 fproto_sim=NA
[loss] ep 19 it 380 total=7.8682 mle=1.5236 pcon=4.8107 forget=1.3541 orth=0.1798 favg=0.0000 nr=101 nf=7 protos=570 fproto_sim=NA
[loss] ep 20 it 0 total=7.7977 mle=1.4486 pcon=4.8106 forget=1.3594 orth=0.1791 favg=0.0000 nr=106 nf=5 protos=570 fproto_sim=NA
[loss] ep 20 it 50 total=8.0105 mle=1.6539 pcon=4.8105 forget=1.3677 orth=0.1784 favg=0.0000 nr=97 nf=6 protos=570 fproto_sim=NA
[loss] ep 20 it 100 total=8.0014 mle=1.6582 pcon=4.8104 forget=1.3551 orth=0.1777 favg=0.0000 nr=100 nf=7 protos=570 fproto_sim=NA
[loss] ep 20 it 150 total=7.9605 mle=1.6061 pcon=4.8104 forget=1.3669 orth=0.1770 favg=0.0000 nr=99 nf=7 protos=570 fproto_sim=NA
[loss] ep 20 it 200 total=7.9607 mle=1.6147 pcon=4.8103 forget=1.3593 orth=0.1763 favg=0.0000 nr=101 nf=3 protos=570 fproto_sim=NA
[loss] ep 20 it 250 total=8.0700 mle=1.6885 pcon=4.8102 forget=1.3957 orth=0.1757 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 20 it 300 total=7.9243 mle=1.5667 pcon=4.8101 forget=1.3725 orth=0.1750 favg=0.0000 nr=105 nf=6 protos=570 fproto_sim=NA
[loss] ep 20 it 350 total=8.0072 mle=1.6574 pcon=4.8099 forget=1.3655 orth=0.1744 favg=0.0000 nr=109 nf=6 protos=570 fproto_sim=NA
[loss] ep 20 it 400 total=8.0860 mle=1.6924 pcon=4.8099 forget=1.4099 orth=0.1737 favg=0.0000 nr=104 nf=5 protos=570 fproto_sim=NA
[loss] ep 21 it 20 total=7.9485 mle=1.6066 pcon=4.8098 forget=1.3590 orth=0.1731 favg=0.0000 nr=111 nf=3 protos=570 fproto_sim=NA
[loss] ep 21 it 70 total=7.9669 mle=1.6024 pcon=4.8097 forget=1.3823 orth=0.1725 favg=0.0000 nr=100 nf=7 protos=570 fproto_sim=NA
[loss] ep 21 it 120 total=7.9811 mle=1.6323 pcon=4.8097 forget=1.3673 orth=0.1718 favg=0.0000 nr=100 nf=6 protos=570 fproto_sim=NA
[loss] ep 21 it 170 total=8.0252 mle=1.6771 pcon=4.8098 forget=1.3670 orth=0.1712 favg=0.0000 nr=100 nf=7 protos=570 fproto_sim=NA
[loss] ep 21 it 220 total=7.9852 mle=1.6356 pcon=4.8097 forget=1.3692 orth=0.1706 favg=0.0000 nr=106 nf=5 protos=570 fproto_sim=NA
[loss] ep 21 it 270 total=8.0192 mle=1.6473 pcon=4.8098 forget=1.3921 orth=0.1700 favg=0.0000 nr=102 nf=4 protos=570 fproto_sim=NA
[loss] ep 21 it 320 total=7.9419 mle=1.5888 pcon=4.8099 forget=1.3738 orth=0.1695 favg=0.0000 nr=102 nf=8 protos=570 fproto_sim=NA
[loss] ep 21 it 370 total=7.9887 mle=1.6371 pcon=4.8098 forget=1.3730 orth=0.1689 favg=0.0000 nr=112 nf=3 protos=570 fproto_sim=NA
[loss] ep 21 it 420 total=7.9297 mle=1.5777 pcon=4.8097 forget=1.3740 orth=0.1683 favg=0.0000 nr=103 nf=8 protos=570 fproto_sim=NA
[loss] ep 22 it 40 total=7.9337 mle=1.5743 pcon=4.8096 forget=1.3820 orth=0.1678 favg=0.0000 nr=92 nf=10 protos=570 fproto_sim=NA
[loss] ep 22 it 90 total=8.0875 mle=1.7276 pcon=4.8096 forget=1.3830 orth=0.1673 favg=0.0000 nr=102 nf=11 protos=570 fproto_sim=NA
[loss] ep 22 it 140 total=7.8985 mle=1.5555 pcon=4.8096 forget=1.3668 orth=0.1667 favg=0.0000 nr=104 nf=2 protos=570 fproto_sim=NA
[loss] ep 22 it 190 total=7.9381 mle=1.5881 pcon=4.8096 forget=1.3741 orth=0.1662 favg=0.0000 nr=105 nf=8 protos=570 fproto_sim=NA
[loss] ep 22 it 240 total=7.9404 mle=1.5873 pcon=4.8095 forget=1.3779 orth=0.1657 favg=0.0000 nr=102 nf=8 protos=570 fproto_sim=NA
[loss] ep 22 it 290 total=7.9654 mle=1.5485 pcon=4.8095 forget=1.4423 orth=0.1652 favg=0.0000 nr=108 nf=5 protos=570 fproto_sim=NA
[loss] ep 22 it 340 total=7.9618 mle=1.6160 pcon=4.8096 forget=1.3716 orth=0.1647 favg=0.0000 nr=108 nf=8 protos=570 fproto_sim=NA
[loss] ep 22 it 390 total=7.9774 mle=1.6489 pcon=4.8096 forget=1.3548 orth=0.1642 favg=0.0000 nr=108 nf=2 protos=570 fproto_sim=NA
[loss] ep 23 it 10 total=7.9206 mle=1.5590 pcon=4.8094 forget=1.3885 orth=0.1637 favg=0.0000 nr=112 nf=4 protos=570 fproto_sim=NA
[loss] ep 23 it 60 total=7.8962 mle=1.5436 pcon=4.8094 forget=1.3800 orth=0.1632 favg=0.0000 nr=108 nf=5 protos=570 fproto_sim=NA
[loss] ep 23 it 110 total=8.0068 mle=1.6642 pcon=4.8093 forget=1.3706 orth=0.1627 favg=0.0000 nr=98 nf=7 protos=570 fproto_sim=NA
[loss] ep 23 it 160 total=7.8397 mle=1.4949 pcon=4.8092 forget=1.3733 orth=0.1623 favg=0.0000 nr=109 nf=2 protos=570 fproto_sim=NA
[loss] ep 23 it 210 total=8.0056 mle=1.6222 pcon=4.8093 forget=1.4123 orth=0.1618 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[loss] ep 23 it 260 total=7.9701 mle=1.6100 pcon=4.8094 forget=1.3893 orth=0.1613 favg=0.0000 nr=111 nf=6 protos=570 fproto_sim=NA
[loss] ep 23 it 310 total=8.0504 mle=1.7103 pcon=4.8095 forget=1.3698 orth=0.1609 favg=0.0000 nr=101 nf=5 protos=570 fproto_sim=NA
[loss] ep 23 it 360 total=8.0616 mle=1.7138 pcon=4.8095 forget=1.3778 orth=0.1604 favg=0.0000 nr=102 nf=10 protos=570 fproto_sim=NA
[loss] ep 23 it 410 total=7.9324 mle=1.5857 pcon=4.8094 forget=1.3774 orth=0.1600 favg=0.0000 nr=98 nf=9 protos=570 fproto_sim=NA
[loss] ep 24 it 30 total=7.9310 mle=1.5814 pcon=4.8093 forget=1.3807 orth=0.1595 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 24 it 80 total=7.9995 mle=1.6431 pcon=4.8091 forget=1.3881 orth=0.1591 favg=0.0000 nr=108 nf=6 protos=570 fproto_sim=NA
[loss] ep 24 it 130 total=8.0038 mle=1.6611 pcon=4.8091 forget=1.3749 orth=0.1587 favg=0.0000 nr=107 nf=3 protos=570 fproto_sim=NA
[loss] ep 24 it 180 total=8.0273 mle=1.6703 pcon=4.8091 forget=1.3896 orth=0.1583 favg=0.0000 nr=105 nf=4 protos=570 fproto_sim=NA
[loss] ep 24 it 230 total=7.9180 mle=1.5750 pcon=4.8092 forget=1.3760 orth=0.1579 favg=0.0000 nr=103 nf=5 protos=570 fproto_sim=NA
[loss] ep 24 it 280 total=7.8808 mle=1.5491 pcon=4.8092 forget=1.3651 orth=0.1575 favg=0.0000 nr=104 nf=5 protos=570 fproto_sim=NA
[loss] ep 24 it 330 total=6.6926 mle=1.7263 pcon=4.8092 forget=0.0000 orth=0.1571 favg=0.0000 nr=107 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 380 total=7.9197 mle=1.5871 pcon=4.8094 forget=1.3665 orth=0.1567 favg=0.0000 nr=102 nf=5 protos=570 fproto_sim=NA
[loss] ep 25 it 0 total=7.9766 mle=1.6391 pcon=4.8094 forget=1.3718 orth=0.1563 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[loss] ep 25 it 50 total=7.8840 mle=1.5473 pcon=4.8095 forget=1.3712 orth=0.1559 favg=0.0000 nr=101 nf=6 protos=570 fproto_sim=NA
[loss] ep 25 it 100 total=8.0943 mle=1.7504 pcon=4.8094 forget=1.3790 orth=0.1555 favg=0.0000 nr=112 nf=4 protos=570 fproto_sim=NA
[loss] ep 25 it 150 total=7.8995 mle=1.5567 pcon=4.8093 forget=1.3783 orth=0.1552 favg=0.0000 nr=103 nf=9 protos=570 fproto_sim=NA
[loss] ep 25 it 200 total=7.9970 mle=1.6441 pcon=4.8094 forget=1.3886 orth=0.1548 favg=0.0000 nr=103 nf=8 protos=570 fproto_sim=NA
[loss] ep 25 it 250 total=8.0416 mle=1.6600 pcon=4.8094 forget=1.4178 orth=0.1544 favg=0.0000 nr=108 nf=4 protos=570 fproto_sim=NA
 52%|█████▏    | 26/50 [07:35<06:14, 15.59s/it] 54%|█████▍    | 27/50 [07:50<05:59, 15.62s/it] 56%|█████▌    | 28/50 [08:05<05:38, 15.38s/it] 58%|█████▊    | 29/50 [08:20<05:18, 15.18s/it] 60%|██████    | 30/50 [08:34<04:59, 14.96s/it] 62%|██████▏   | 31/50 [08:49<04:44, 14.97s/it] 64%|██████▍   | 32/50 [09:06<04:37, 15.43s/it][loss] ep 25 it 300 total=7.9163 mle=1.5914 pcon=4.8093 forget=1.3615 orth=0.1541 favg=0.0000 nr=97 nf=10 protos=570 fproto_sim=NA
[loss] ep 25 it 350 total=7.9238 mle=1.5897 pcon=4.8094 forget=1.3711 orth=0.1537 favg=0.0000 nr=109 nf=8 protos=570 fproto_sim=NA
[loss] ep 25 it 400 total=8.1467 mle=1.7304 pcon=4.8093 forget=1.4536 orth=0.1534 favg=0.0000 nr=100 nf=6 protos=570 fproto_sim=NA
[loss] ep 26 it 20 total=7.9757 mle=1.6423 pcon=4.8093 forget=1.3711 orth=0.1530 favg=0.0000 nr=106 nf=5 protos=570 fproto_sim=NA
[loss] ep 26 it 70 total=8.1428 mle=1.8122 pcon=4.8093 forget=1.3686 orth=0.1527 favg=0.0000 nr=103 nf=8 protos=570 fproto_sim=NA
[loss] ep 26 it 120 total=7.8666 mle=1.5403 pcon=4.8093 forget=1.3647 orth=0.1524 favg=0.0000 nr=102 nf=10 protos=570 fproto_sim=NA
[loss] ep 26 it 170 total=7.9027 mle=1.5762 pcon=4.8092 forget=1.3652 orth=0.1520 favg=0.0000 nr=106 nf=3 protos=570 fproto_sim=NA
[loss] ep 26 it 220 total=8.0130 mle=1.6914 pcon=4.8092 forget=1.3606 orth=0.1517 favg=0.0000 nr=108 nf=5 protos=570 fproto_sim=NA
[loss] ep 26 it 270 total=7.9185 mle=1.5876 pcon=4.8091 forget=1.3704 orth=0.1514 favg=0.0000 nr=107 nf=5 protos=570 fproto_sim=NA
[loss] ep 26 it 320 total=7.9896 mle=1.6770 pcon=4.8091 forget=1.3524 orth=0.1511 favg=0.0000 nr=106 nf=4 protos=570 fproto_sim=NA
[loss] ep 26 it 370 total=7.9375 mle=1.6134 pcon=4.8092 forget=1.3641 orth=0.1508 favg=0.0000 nr=106 nf=7 protos=570 fproto_sim=NA
[loss] ep 26 it 420 total=7.8609 mle=1.5238 pcon=4.8091 forget=1.3775 orth=0.1505 favg=0.0000 nr=108 nf=4 protos=570 fproto_sim=NA
[loss] ep 27 it 40 total=7.9817 mle=1.6615 pcon=4.8092 forget=1.3609 orth=0.1501 favg=0.0000 nr=111 nf=5 protos=570 fproto_sim=NA
[loss] ep 27 it 90 total=7.9777 mle=1.6685 pcon=4.8091 forget=1.3503 orth=0.1498 favg=0.0000 nr=104 nf=3 protos=570 fproto_sim=NA
[loss] ep 27 it 140 total=7.8824 mle=1.5764 pcon=4.8092 forget=1.3473 orth=0.1495 favg=0.0000 nr=105 nf=5 protos=570 fproto_sim=NA
[loss] ep 27 it 190 total=7.9431 mle=1.6145 pcon=4.8092 forget=1.3702 orth=0.1492 favg=0.0000 nr=97 nf=10 protos=570 fproto_sim=NA
[loss] ep 27 it 240 total=8.0143 mle=1.7036 pcon=4.8090 forget=1.3528 orth=0.1489 favg=0.0000 nr=100 nf=11 protos=570 fproto_sim=NA
[loss] ep 27 it 290 total=7.8482 mle=1.5440 pcon=4.8090 forget=1.3465 orth=0.1486 favg=0.0000 nr=104 nf=8 protos=570 fproto_sim=NA
[loss] ep 27 it 340 total=8.0212 mle=1.6993 pcon=4.8090 forget=1.3646 orth=0.1484 favg=0.0000 nr=102 nf=4 protos=570 fproto_sim=NA
[loss] ep 27 it 390 total=7.8697 mle=1.5610 pcon=4.8090 forget=1.3516 orth=0.1481 favg=0.0000 nr=112 nf=6 protos=570 fproto_sim=NA
[loss] ep 28 it 10 total=7.9115 mle=1.6034 pcon=4.8091 forget=1.3513 orth=0.1478 favg=0.0000 nr=111 nf=4 protos=570 fproto_sim=NA
[loss] ep 28 it 60 total=7.8916 mle=1.5647 pcon=4.8090 forget=1.3704 orth=0.1475 favg=0.0000 nr=110 nf=6 protos=570 fproto_sim=NA
[loss] ep 28 it 110 total=7.9436 mle=1.6310 pcon=4.8092 forget=1.3562 orth=0.1472 favg=0.0000 nr=98 nf=7 protos=570 fproto_sim=NA
[loss] ep 28 it 160 total=7.9307 mle=1.6181 pcon=4.8094 forget=1.3563 orth=0.1470 favg=0.0000 nr=109 nf=3 protos=570 fproto_sim=NA
[loss] ep 28 it 210 total=7.9345 mle=1.6154 pcon=4.8094 forget=1.3630 orth=0.1467 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[loss] ep 28 it 260 total=7.8526 mle=1.5506 pcon=4.8095 forget=1.3461 orth=0.1465 favg=0.0000 nr=100 nf=7 protos=570 fproto_sim=NA
[loss] ep 28 it 310 total=7.7871 mle=1.4870 pcon=4.8097 forget=1.3443 orth=0.1462 favg=0.0000 nr=109 nf=6 protos=570 fproto_sim=NA
[loss] ep 28 it 360 total=8.0471 mle=1.7495 pcon=4.8096 forget=1.3420 orth=0.1459 favg=0.0000 nr=100 nf=6 protos=570 fproto_sim=NA
[loss] ep 28 it 410 total=7.8772 mle=1.5848 pcon=4.8098 forget=1.3370 orth=0.1457 favg=0.0000 nr=109 nf=6 protos=570 fproto_sim=NA
[loss] ep 29 it 30 total=7.9103 mle=1.6033 pcon=4.8097 forget=1.3519 orth=0.1454 favg=0.0000 nr=116 nf=2 protos=570 fproto_sim=NA
[loss] ep 29 it 80 total=7.9864 mle=1.6704 pcon=4.8097 forget=1.3611 orth=0.1452 favg=0.0000 nr=103 nf=3 protos=570 fproto_sim=NA
[loss] ep 29 it 130 total=7.8258 mle=1.5332 pcon=4.8097 forget=1.3379 orth=0.1449 favg=0.0000 nr=106 nf=8 protos=570 fproto_sim=NA
[loss] ep 29 it 180 total=7.9192 mle=1.6173 pcon=4.8096 forget=1.3476 orth=0.1447 favg=0.0000 nr=106 nf=4 protos=570 fproto_sim=NA
[loss] ep 29 it 230 total=8.0428 mle=1.7469 pcon=4.8095 forget=1.3420 orth=0.1445 favg=0.0000 nr=102 nf=8 protos=570 fproto_sim=NA
[loss] ep 29 it 280 total=7.9189 mle=1.6017 pcon=4.8095 forget=1.3634 orth=0.1442 favg=0.0000 nr=105 nf=7 protos=570 fproto_sim=NA
[loss] ep 29 it 330 total=7.9296 mle=1.6199 pcon=4.8095 forget=1.3562 orth=0.1440 favg=0.0000 nr=110 nf=2 protos=570 fproto_sim=NA
[loss] ep 29 it 380 total=7.8824 mle=1.5938 pcon=4.8095 forget=1.3354 orth=0.1438 favg=0.0000 nr=105 nf=9 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 30 it 0 total=7.9169 mle=1.6193 pcon=4.8094 forget=1.3447 orth=0.1435 favg=0.0000 nr=103 nf=9 protos=570 fproto_sim=NA
[loss] ep 30 it 50 total=8.0210 mle=1.7237 pcon=4.8093 forget=1.3447 orth=0.1433 favg=0.0000 nr=97 nf=7 protos=570 fproto_sim=NA
[loss] ep 30 it 100 total=8.0151 mle=1.7140 pcon=4.8094 forget=1.3486 orth=0.1431 favg=0.0000 nr=108 nf=3 protos=570 fproto_sim=NA
[loss] ep 30 it 150 total=7.7950 mle=1.5034 pcon=4.8094 forget=1.3393 orth=0.1429 favg=0.0000 nr=101 nf=8 protos=570 fproto_sim=NA
[loss] ep 30 it 200 total=8.0034 mle=1.7040 pcon=4.8094 forget=1.3474 orth=0.1427 favg=0.0000 nr=106 nf=7 protos=570 fproto_sim=NA
[loss] ep 30 it 250 total=7.9734 mle=1.6763 pcon=4.8096 forget=1.3451 orth=0.1424 favg=0.0000 nr=103 nf=7 protos=570 fproto_sim=NA
[loss] ep 30 it 300 total=7.9006 mle=1.5942 pcon=4.8095 forget=1.3547 orth=0.1422 favg=0.0000 nr=106 nf=3 protos=570 fproto_sim=NA
[loss] ep 30 it 350 total=7.8908 mle=1.5632 pcon=4.8095 forget=1.3760 orth=0.1420 favg=0.0000 nr=104 nf=6 protos=570 fproto_sim=NA
[loss] ep 30 it 400 total=7.8858 mle=1.5906 pcon=4.8095 forget=1.3439 orth=0.1418 favg=0.0000 nr=97 nf=8 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 31 it 20 total=7.8794 mle=1.5452 pcon=4.8095 forget=1.3831 orth=0.1416 favg=0.0000 nr=103 nf=7 protos=570 fproto_sim=NA
[loss] ep 31 it 70 total=7.8622 mle=1.5695 pcon=4.8095 forget=1.3419 orth=0.1414 favg=0.0000 nr=102 nf=10 protos=570 fproto_sim=NA
[loss] ep 31 it 120 total=7.8498 mle=1.5608 pcon=4.8095 forget=1.3383 orth=0.1412 favg=0.0000 nr=105 nf=6 protos=570 fproto_sim=NA
[loss] ep 31 it 170 total=7.9726 mle=1.6727 pcon=4.8095 forget=1.3494 orth=0.1410 favg=0.0000 nr=107 nf=7 protos=570 fproto_sim=NA
[loss] ep 31 it 220 total=7.9067 mle=1.6161 pcon=4.8093 forget=1.3405 orth=0.1408 favg=0.0000 nr=105 nf=6 protos=570 fproto_sim=NA
[loss] ep 31 it 270 total=7.9992 mle=1.6963 pcon=4.8093 forget=1.3530 orth=0.1406 favg=0.0000 nr=103 nf=9 protos=570 fproto_sim=NA
[loss] ep 31 it 320 total=7.9397 mle=1.6551 pcon=4.8093 forget=1.3349 orth=0.1404 favg=0.0000 nr=106 nf=7 protos=570 fproto_sim=NA
[loss] ep 31 it 370 total=7.7800 mle=1.4992 pcon=4.8093 forget=1.3313 orth=0.1402 favg=0.0000 nr=103 nf=12 protos=570 fproto_sim=NA
[loss] ep 31 it 420 total=8.0028 mle=1.7143 pcon=4.8093 forget=1.3392 orth=0.1400 favg=0.0000 nr=101 nf=6 protos=570 fproto_sim=NA
[loss] ep 32 it 40 total=7.8877 mle=1.5990 pcon=4.8092 forget=1.3396 orth=0.1398 favg=0.0000 nr=105 nf=5 protos=570 fproto_sim=NA
[loss] ep 32 it 90 total=7.9976 mle=1.6877 pcon=4.8092 forget=1.3611 orth=0.1397 favg=0.0000 nr=103 nf=5 protos=570 fproto_sim=NA
[loss] ep 32 it 140 total=7.8945 mle=1.5603 pcon=4.8090 forget=1.3858 orth=0.1395 favg=0.0000 nr=104 nf=8 protos=570 fproto_sim=NA
[loss] ep 32 it 190 total=7.9745 mle=1.6990 pcon=4.8088 forget=1.3275 orth=0.1393 favg=0.0000 nr=100 nf=8 protos=570 fproto_sim=NA
 66%|██████▌   | 33/50 [09:21<04:18, 15.20s/it] 68%|██████▊   | 34/50 [09:39<04:17, 16.09s/it] 70%|███████   | 35/50 [09:54<03:59, 15.99s/it] 72%|███████▏  | 36/50 [10:10<03:42, 15.91s/it] 74%|███████▍  | 37/50 [10:26<03:27, 15.94s/it] 76%|███████▌  | 38/50 [10:42<03:10, 15.85s/it] 78%|███████▊  | 39/50 [10:57<02:50, 15.52s/it][loss] ep 32 it 240 total=8.0232 mle=1.7149 pcon=4.8087 forget=1.3605 orth=0.1391 favg=0.0000 nr=107 nf=7 protos=570 fproto_sim=NA
[loss] ep 32 it 290 total=8.0499 mle=1.7677 pcon=4.8087 forget=1.3344 orth=0.1389 favg=0.0000 nr=102 nf=8 protos=570 fproto_sim=NA
[loss] ep 32 it 340 total=7.8664 mle=1.5809 pcon=4.8087 forget=1.3380 orth=0.1388 favg=0.0000 nr=106 nf=5 protos=570 fproto_sim=NA
[loss] ep 32 it 390 total=7.9368 mle=1.6599 pcon=4.8088 forget=1.3296 orth=0.1386 favg=0.0000 nr=105 nf=6 protos=570 fproto_sim=NA
[loss] ep 33 it 10 total=7.9043 mle=1.6170 pcon=4.8087 forget=1.3402 orth=0.1384 favg=0.0000 nr=106 nf=4 protos=570 fproto_sim=NA
[loss] ep 33 it 60 total=7.8641 mle=1.5867 pcon=4.8086 forget=1.3306 orth=0.1383 favg=0.0000 nr=105 nf=9 protos=570 fproto_sim=NA
[loss] ep 33 it 110 total=7.8762 mle=1.5985 pcon=4.8086 forget=1.3309 orth=0.1381 favg=0.0000 nr=106 nf=8 protos=570 fproto_sim=NA
[loss] ep 33 it 160 total=7.8653 mle=1.5745 pcon=4.8085 forget=1.3443 orth=0.1379 favg=0.0000 nr=109 nf=8 protos=570 fproto_sim=NA
[loss] ep 33 it 210 total=7.9298 mle=1.6494 pcon=4.8084 forget=1.3342 orth=0.1378 favg=0.0000 nr=103 nf=9 protos=570 fproto_sim=NA
[loss] ep 33 it 260 total=7.9900 mle=1.6981 pcon=4.8084 forget=1.3459 orth=0.1376 favg=0.0000 nr=110 nf=5 protos=570 fproto_sim=NA
[loss] ep 33 it 310 total=7.8710 mle=1.5935 pcon=4.8084 forget=1.3317 orth=0.1375 favg=0.0000 nr=107 nf=7 protos=570 fproto_sim=NA
[loss] ep 33 it 360 total=7.8634 mle=1.5391 pcon=4.8083 forget=1.3786 orth=0.1373 favg=0.0000 nr=97 nf=3 protos=570 fproto_sim=NA
[loss] ep 33 it 410 total=8.0590 mle=1.6421 pcon=4.8083 forget=1.4715 orth=0.1371 favg=0.0000 nr=108 nf=4 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 34 it 30 total=7.8153 mle=1.5445 pcon=4.8084 forget=1.3254 orth=0.1370 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 34 it 80 total=7.8667 mle=1.5811 pcon=4.8083 forget=1.3405 orth=0.1369 favg=0.0000 nr=95 nf=13 protos=570 fproto_sim=NA
[loss] ep 34 it 130 total=7.8579 mle=1.5837 pcon=4.8083 forget=1.3292 orth=0.1367 favg=0.0000 nr=114 nf=3 protos=570 fproto_sim=NA
[loss] ep 34 it 180 total=7.8367 mle=1.5205 pcon=4.8084 forget=1.3712 orth=0.1366 favg=0.0000 nr=104 nf=7 protos=570 fproto_sim=NA
[loss] ep 34 it 230 total=7.8127 mle=1.5346 pcon=4.8084 forget=1.3333 orth=0.1364 favg=0.0000 nr=105 nf=10 protos=570 fproto_sim=NA
[loss] ep 34 it 280 total=7.8996 mle=1.6190 pcon=4.8084 forget=1.3359 orth=0.1363 favg=0.0000 nr=113 nf=5 protos=570 fproto_sim=NA
[loss] ep 34 it 330 total=7.8526 mle=1.5780 pcon=4.8083 forget=1.3301 orth=0.1362 favg=0.0000 nr=109 nf=3 protos=570 fproto_sim=NA
[loss] ep 34 it 380 total=7.8711 mle=1.5857 pcon=4.8082 forget=1.3412 orth=0.1360 favg=0.0000 nr=101 nf=4 protos=570 fproto_sim=NA
[loss] ep 35 it 0 total=7.9148 mle=1.6412 pcon=4.8080 forget=1.3297 orth=0.1359 favg=0.0000 nr=98 nf=5 protos=570 fproto_sim=NA
[loss] ep 35 it 50 total=8.0533 mle=1.7659 pcon=4.8079 forget=1.3437 orth=0.1358 favg=0.0000 nr=104 nf=4 protos=570 fproto_sim=NA
[loss] ep 35 it 100 total=7.9237 mle=1.6314 pcon=4.8078 forget=1.3489 orth=0.1356 favg=0.0000 nr=106 nf=5 protos=570 fproto_sim=NA
[loss] ep 35 it 150 total=7.9590 mle=1.6893 pcon=4.8078 forget=1.3265 orth=0.1355 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 35 it 200 total=7.9276 mle=1.6442 pcon=4.8075 forget=1.3404 orth=0.1354 favg=0.0000 nr=98 nf=10 protos=570 fproto_sim=NA
[loss] ep 35 it 250 total=7.8200 mle=1.5437 pcon=4.8075 forget=1.3335 orth=0.1353 favg=0.0000 nr=105 nf=3 protos=570 fproto_sim=NA
[loss] ep 35 it 300 total=7.8052 mle=1.5319 pcon=4.8074 forget=1.3308 orth=0.1352 favg=0.0000 nr=96 nf=7 protos=570 fproto_sim=NA
[loss] ep 35 it 350 total=7.8457 mle=1.5701 pcon=4.8075 forget=1.3331 orth=0.1350 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 35 it 400 total=7.8575 mle=1.5959 pcon=4.8075 forget=1.3192 orth=0.1349 favg=0.0000 nr=101 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 36 it 20 total=7.9986 mle=1.6927 pcon=4.8076 forget=1.3635 orth=0.1348 favg=0.0000 nr=108 nf=6 protos=570 fproto_sim=NA
[loss] ep 36 it 70 total=7.8787 mle=1.5987 pcon=4.8075 forget=1.3379 orth=0.1347 favg=0.0000 nr=106 nf=7 protos=570 fproto_sim=NA
[loss] ep 36 it 120 total=7.8098 mle=1.5343 pcon=4.8075 forget=1.3334 orth=0.1346 favg=0.0000 nr=106 nf=3 protos=570 fproto_sim=NA
[loss] ep 36 it 170 total=7.9899 mle=1.7095 pcon=4.8076 forget=1.3383 orth=0.1345 favg=0.0000 nr=99 nf=6 protos=570 fproto_sim=NA
[loss] ep 36 it 220 total=7.9150 mle=1.6079 pcon=4.8076 forget=1.3652 orth=0.1344 favg=0.0000 nr=99 nf=8 protos=570 fproto_sim=NA
[loss] ep 36 it 270 total=7.9459 mle=1.6746 pcon=4.8075 forget=1.3295 orth=0.1343 favg=0.0000 nr=102 nf=8 protos=570 fproto_sim=NA
[loss] ep 36 it 320 total=7.8670 mle=1.5966 pcon=4.8075 forget=1.3287 orth=0.1342 favg=0.0000 nr=94 nf=6 protos=570 fproto_sim=NA
[loss] ep 36 it 370 total=8.0112 mle=1.6768 pcon=4.8075 forget=1.3929 orth=0.1341 favg=0.0000 nr=99 nf=9 protos=570 fproto_sim=NA
[loss] ep 36 it 420 total=7.9091 mle=1.6212 pcon=4.8073 forget=1.3466 orth=0.1340 favg=0.0000 nr=92 nf=9 protos=570 fproto_sim=NA
[loss] ep 37 it 40 total=7.9527 mle=1.6725 pcon=4.8073 forget=1.3391 orth=0.1339 favg=0.0000 nr=103 nf=2 protos=570 fproto_sim=NA
[loss] ep 37 it 90 total=7.9034 mle=1.6303 pcon=4.8072 forget=1.3322 orth=0.1338 favg=0.0000 nr=104 nf=4 protos=570 fproto_sim=NA
[loss] ep 37 it 140 total=7.8184 mle=1.5452 pcon=4.8071 forget=1.3325 orth=0.1337 favg=0.0000 nr=108 nf=1 protos=570 fproto_sim=NA
[loss] ep 37 it 190 total=7.9712 mle=1.6933 pcon=4.8070 forget=1.3373 orth=0.1336 favg=0.0000 nr=105 nf=10 protos=570 fproto_sim=NA
[loss] ep 37 it 240 total=7.9002 mle=1.6266 pcon=4.8069 forget=1.3333 orth=0.1335 favg=0.0000 nr=111 nf=6 protos=570 fproto_sim=NA
[loss] ep 37 it 290 total=7.9445 mle=1.6643 pcon=4.8068 forget=1.3401 orth=0.1334 favg=0.0000 nr=106 nf=5 protos=570 fproto_sim=NA
[loss] ep 37 it 340 total=8.0225 mle=1.6847 pcon=4.8068 forget=1.3977 orth=0.1333 favg=0.0000 nr=107 nf=4 protos=570 fproto_sim=NA
[loss] ep 37 it 390 total=7.8833 mle=1.6063 pcon=4.8066 forget=1.3372 orth=0.1332 favg=0.0000 nr=102 nf=4 protos=570 fproto_sim=NA
[loss] ep 38 it 10 total=7.8778 mle=1.5968 pcon=4.8065 forget=1.3413 orth=0.1331 favg=0.0000 nr=112 nf=2 protos=570 fproto_sim=NA
[loss] ep 38 it 60 total=7.8991 mle=1.6024 pcon=4.8064 forget=1.3573 orth=0.1331 favg=0.0000 nr=110 nf=6 protos=570 fproto_sim=NA
[loss] ep 38 it 110 total=7.8670 mle=1.5939 pcon=4.8062 forget=1.3340 orth=0.1330 favg=0.0000 nr=99 nf=8 protos=570 fproto_sim=NA
[loss] ep 38 it 160 total=7.9001 mle=1.6329 pcon=4.8062 forget=1.3281 orth=0.1329 favg=0.0000 nr=108 nf=5 protos=570 fproto_sim=NA
[loss] ep 38 it 210 total=7.8473 mle=1.5730 pcon=4.8061 forget=1.3353 orth=0.1328 favg=0.0000 nr=105 nf=6 protos=570 fproto_sim=NA
[loss] ep 38 it 260 total=8.0534 mle=1.6648 pcon=4.8059 forget=1.4500 orth=0.1328 favg=0.0000 nr=113 nf=5 protos=570 fproto_sim=NA
[loss] ep 38 it 310 total=7.8478 mle=1.5607 pcon=4.8059 forget=1.3485 orth=0.1327 favg=0.0000 nr=96 nf=6 protos=570 fproto_sim=NA
[loss] ep 38 it 360 total=7.8609 mle=1.5901 pcon=4.8058 forget=1.3324 orth=0.1326 favg=0.0000 nr=115 nf=4 protos=570 fproto_sim=NA
[loss] ep 38 it 410 total=7.9107 mle=1.6302 pcon=4.8058 forget=1.3421 orth=0.1325 favg=0.0000 nr=105 nf=3 protos=570 fproto_sim=NA
[loss] ep 39 it 30 total=7.8531 mle=1.6032 pcon=4.8058 forget=1.3116 orth=0.1325 favg=0.0000 nr=107 nf=2 protos=570 fproto_sim=NA
[loss] ep 39 it 80 total=7.8342 mle=1.5632 pcon=4.8058 forget=1.3328 orth=0.1324 favg=0.0000 nr=102 nf=3 protos=570 fproto_sim=NA
[loss] ep 39 it 130 total=7.8937 mle=1.6043 pcon=4.8058 forget=1.3512 orth=0.1323 favg=0.0000 nr=105 nf=9 protos=570 fproto_sim=NA
 80%|████████  | 40/50 [11:13<02:36, 15.70s/it] 82%|████████▏ | 41/50 [11:28<02:19, 15.51s/it] 84%|████████▍ | 42/50 [11:42<02:01, 15.21s/it] 86%|████████▌ | 43/50 [11:59<01:48, 15.54s/it] 88%|████████▊ | 44/50 [12:14<01:33, 15.54s/it] 90%|█████████ | 45/50 [12:30<01:17, 15.56s/it] 92%|█████████▏| 46/50 [12:45<01:02, 15.59s/it][loss] ep 39 it 180 total=7.9383 mle=1.6590 pcon=4.8057 forget=1.3413 orth=0.1323 favg=0.0000 nr=102 nf=8 protos=570 fproto_sim=NA
[loss] ep 39 it 230 total=7.9022 mle=1.6217 pcon=4.8056 forget=1.3427 orth=0.1322 favg=0.0000 nr=105 nf=7 protos=570 fproto_sim=NA
[loss] ep 39 it 280 total=7.8894 mle=1.5834 pcon=4.8056 forget=1.3683 orth=0.1321 favg=0.0000 nr=110 nf=5 protos=570 fproto_sim=NA
[loss] ep 39 it 330 total=7.8816 mle=1.6198 pcon=4.8056 forget=1.3241 orth=0.1321 favg=0.0000 nr=108 nf=5 protos=570 fproto_sim=NA
[loss] ep 39 it 380 total=7.9867 mle=1.7207 pcon=4.8055 forget=1.3284 orth=0.1320 favg=0.0000 nr=104 nf=5 protos=570 fproto_sim=NA
[loss] ep 40 it 0 total=7.9665 mle=1.6986 pcon=4.8054 forget=1.3305 orth=0.1320 favg=0.0000 nr=102 nf=9 protos=570 fproto_sim=NA
[loss] ep 40 it 50 total=7.9662 mle=1.6969 pcon=4.8053 forget=1.3321 orth=0.1319 favg=0.0000 nr=96 nf=5 protos=570 fproto_sim=NA
[loss] ep 40 it 100 total=7.9275 mle=1.6572 pcon=4.8052 forget=1.3333 orth=0.1319 favg=0.0000 nr=104 nf=3 protos=570 fproto_sim=NA
[loss] ep 40 it 150 total=7.8491 mle=1.5807 pcon=4.8053 forget=1.3313 orth=0.1318 favg=0.0000 nr=105 nf=8 protos=570 fproto_sim=NA
[loss] ep 40 it 200 total=7.8527 mle=1.5661 pcon=4.8052 forget=1.3497 orth=0.1318 favg=0.0000 nr=113 nf=6 protos=570 fproto_sim=NA
[loss] ep 40 it 250 total=7.8861 mle=1.6040 pcon=4.8052 forget=1.3452 orth=0.1317 favg=0.0000 nr=100 nf=6 protos=570 fproto_sim=NA
[loss] ep 40 it 300 total=7.9191 mle=1.6391 pcon=4.8051 forget=1.3432 orth=0.1316 favg=0.0000 nr=100 nf=6 protos=570 fproto_sim=NA
[loss] ep 40 it 350 total=8.0052 mle=1.7421 pcon=4.8051 forget=1.3263 orth=0.1316 favg=0.0000 nr=100 nf=3 protos=570 fproto_sim=NA
[loss] ep 40 it 400 total=7.9335 mle=1.6557 pcon=4.8052 forget=1.3411 orth=0.1316 favg=0.0000 nr=98 nf=4 protos=570 fproto_sim=NA
[loss] ep 41 it 20 total=7.9630 mle=1.6838 pcon=4.8051 forget=1.3427 orth=0.1315 favg=0.0000 nr=102 nf=11 protos=570 fproto_sim=NA
[loss] ep 41 it 70 total=7.9498 mle=1.6789 pcon=4.8050 forget=1.3345 orth=0.1315 favg=0.0000 nr=101 nf=10 protos=570 fproto_sim=NA
[loss] ep 41 it 120 total=7.8441 mle=1.5630 pcon=4.8050 forget=1.3447 orth=0.1314 favg=0.0000 nr=106 nf=5 protos=570 fproto_sim=NA
[loss] ep 41 it 170 total=7.9742 mle=1.6887 pcon=4.8047 forget=1.3494 orth=0.1314 favg=0.0000 nr=98 nf=11 protos=570 fproto_sim=NA
[loss] ep 41 it 220 total=7.9521 mle=1.6650 pcon=4.8047 forget=1.3510 orth=0.1313 favg=0.0000 nr=103 nf=4 protos=570 fproto_sim=NA
[loss] ep 41 it 270 total=7.8308 mle=1.5613 pcon=4.8047 forget=1.3335 orth=0.1313 favg=0.0000 nr=107 nf=4 protos=570 fproto_sim=NA
[loss] ep 41 it 320 total=7.8978 mle=1.6225 pcon=4.8047 forget=1.3394 orth=0.1313 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 41 it 370 total=7.7901 mle=1.5303 pcon=4.8047 forget=1.3239 orth=0.1312 favg=0.0000 nr=108 nf=5 protos=570 fproto_sim=NA
[loss] ep 41 it 420 total=8.0489 mle=1.7737 pcon=4.8047 forget=1.3393 orth=0.1312 favg=0.0000 nr=106 nf=8 protos=570 fproto_sim=NA
[loss] ep 42 it 40 total=7.8312 mle=1.5654 pcon=4.8047 forget=1.3299 orth=0.1311 favg=0.0000 nr=110 nf=2 protos=570 fproto_sim=NA
[loss] ep 42 it 90 total=7.8895 mle=1.6211 pcon=4.8046 forget=1.3327 orth=0.1311 favg=0.0000 nr=109 nf=6 protos=570 fproto_sim=NA
[loss] ep 42 it 140 total=7.9309 mle=1.6415 pcon=4.8046 forget=1.3538 orth=0.1311 favg=0.0000 nr=107 nf=6 protos=570 fproto_sim=NA
[loss] ep 42 it 190 total=7.8880 mle=1.5842 pcon=4.8047 forget=1.3681 orth=0.1310 favg=0.0000 nr=103 nf=8 protos=570 fproto_sim=NA
[loss] ep 42 it 240 total=7.9144 mle=1.6213 pcon=4.8047 forget=1.3575 orth=0.1310 favg=0.0000 nr=106 nf=8 protos=570 fproto_sim=NA
[loss] ep 42 it 290 total=7.9147 mle=1.6308 pcon=4.8046 forget=1.3483 orth=0.1310 favg=0.0000 nr=105 nf=6 protos=570 fproto_sim=NA
[loss] ep 42 it 340 total=8.0164 mle=1.6940 pcon=4.8046 forget=1.3869 orth=0.1309 favg=0.0000 nr=102 nf=9 protos=570 fproto_sim=NA
[loss] ep 42 it 390 total=7.9838 mle=1.6781 pcon=4.8046 forget=1.3702 orth=0.1309 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 43 it 10 total=7.9776 mle=1.7071 pcon=4.8045 forget=1.3351 orth=0.1309 favg=0.0000 nr=103 nf=8 protos=570 fproto_sim=NA
[loss] ep 43 it 60 total=7.9815 mle=1.6985 pcon=4.8045 forget=1.3477 orth=0.1309 favg=0.0000 nr=110 nf=3 protos=570 fproto_sim=NA
[loss] ep 43 it 110 total=7.9584 mle=1.6770 pcon=4.8044 forget=1.3462 orth=0.1308 favg=0.0000 nr=91 nf=9 protos=570 fproto_sim=NA
[loss] ep 43 it 160 total=7.9297 mle=1.6533 pcon=4.8044 forget=1.3412 orth=0.1308 favg=0.0000 nr=109 nf=7 protos=570 fproto_sim=NA
[loss] ep 43 it 210 total=7.9640 mle=1.6420 pcon=4.8043 forget=1.3869 orth=0.1308 favg=0.0000 nr=99 nf=7 protos=570 fproto_sim=NA
[loss] ep 43 it 260 total=8.0270 mle=1.6594 pcon=4.8043 forget=1.4326 orth=0.1307 favg=0.0000 nr=105 nf=8 protos=570 fproto_sim=NA
[loss] ep 43 it 310 total=7.9879 mle=1.7251 pcon=4.8042 forget=1.3279 orth=0.1307 favg=0.0000 nr=109 nf=3 protos=570 fproto_sim=NA
[loss] ep 43 it 360 total=7.9582 mle=1.6373 pcon=4.8041 forget=1.3861 orth=0.1307 favg=0.0000 nr=106 nf=6 protos=570 fproto_sim=NA
[loss] ep 43 it 410 total=8.0180 mle=1.7469 pcon=4.8040 forget=1.3363 orth=0.1307 favg=0.0000 nr=108 nf=3 protos=570 fproto_sim=NA
[loss] ep 44 it 30 total=8.0098 mle=1.6777 pcon=4.8039 forget=1.3975 orth=0.1307 favg=0.0000 nr=107 nf=8 protos=570 fproto_sim=NA
[loss] ep 44 it 80 total=7.9520 mle=1.6847 pcon=4.8038 forget=1.3328 orth=0.1306 favg=0.0000 nr=105 nf=10 protos=570 fproto_sim=NA
[loss] ep 44 it 130 total=7.8786 mle=1.6220 pcon=4.8037 forget=1.3223 orth=0.1306 favg=0.0000 nr=105 nf=3 protos=570 fproto_sim=NA
[loss] ep 44 it 180 total=7.8847 mle=1.6185 pcon=4.8039 forget=1.3318 orth=0.1306 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 44 it 230 total=7.8527 mle=1.5608 pcon=4.8037 forget=1.3575 orth=0.1306 favg=0.0000 nr=114 nf=5 protos=570 fproto_sim=NA
[loss] ep 44 it 280 total=7.9382 mle=1.6690 pcon=4.8038 forget=1.3349 orth=0.1306 favg=0.0000 nr=98 nf=10 protos=570 fproto_sim=NA
[loss] ep 44 it 330 total=8.3422 mle=1.7198 pcon=4.8037 forget=1.6882 orth=0.1305 favg=0.0000 nr=112 nf=1 protos=570 fproto_sim=NA
[loss] ep 44 it 380 total=7.8887 mle=1.5902 pcon=4.8037 forget=1.3642 orth=0.1305 favg=0.0000 nr=108 nf=4 protos=570 fproto_sim=NA
[loss] ep 45 it 0 total=7.9469 mle=1.6728 pcon=4.8037 forget=1.3399 orth=0.1305 favg=0.0000 nr=98 nf=3 protos=570 fproto_sim=NA
[loss] ep 45 it 50 total=7.8635 mle=1.5947 pcon=4.8035 forget=1.3348 orth=0.1305 favg=0.0000 nr=105 nf=4 protos=570 fproto_sim=NA
[loss] ep 45 it 100 total=8.1654 mle=1.6431 pcon=4.8037 forget=1.5881 orth=0.1305 favg=0.0000 nr=98 nf=3 protos=570 fproto_sim=NA
[loss] ep 45 it 150 total=7.7976 mle=1.5345 pcon=4.8037 forget=1.3290 orth=0.1305 favg=0.0000 nr=97 nf=8 protos=570 fproto_sim=NA
[loss] ep 45 it 200 total=7.8518 mle=1.5726 pcon=4.8036 forget=1.3451 orth=0.1305 favg=0.0000 nr=109 nf=4 protos=570 fproto_sim=NA
[loss] ep 45 it 250 total=7.8919 mle=1.6129 pcon=4.8036 forget=1.3451 orth=0.1304 favg=0.0000 nr=103 nf=11 protos=570 fproto_sim=NA
[loss] ep 45 it 300 total=7.9302 mle=1.6160 pcon=4.8036 forget=1.3802 orth=0.1304 favg=0.0000 nr=112 nf=6 protos=570 fproto_sim=NA
[loss] ep 45 it 350 total=7.9256 mle=1.6577 pcon=4.8035 forget=1.3340 orth=0.1304 favg=0.0000 nr=103 nf=7 protos=570 fproto_sim=NA
[loss] ep 45 it 400 total=7.8436 mle=1.5689 pcon=4.8036 forget=1.3406 orth=0.1304 favg=0.0000 nr=107 nf=4 protos=570 fproto_sim=NA
[loss] ep 46 it 20 total=7.8667 mle=1.5504 pcon=4.8036 forget=1.3823 orth=0.1304 favg=0.0000 nr=99 nf=11 protos=570 fproto_sim=NA
[loss] ep 46 it 70 total=8.0137 mle=1.7088 pcon=4.8037 forget=1.3708 orth=0.1304 favg=0.0000 nr=104 nf=6 protos=570 fproto_sim=NA
[loss] ep 46 it 120 total=7.9291 mle=1.6707 pcon=4.8038 forget=1.3243 orth=0.1304 favg=0.0000 nr=101 nf=6 protos=570 fproto_sim=NA
[loss] ep 46 it 170 total=7.9274 mle=1.6454 pcon=4.8039 forget=1.3478 orth=0.1304 favg=0.0000 nr=96 nf=6 protos=570 fproto_sim=NA
[loss] ep 46 it 220 total=7.8039 mle=1.5258 pcon=4.8038 forget=1.3440 orth=0.1304 favg=0.0000 nr=101 nf=6 protos=570 fproto_sim=NA
 94%|█████████▍| 47/50 [13:01<00:46, 15.65s/it] 96%|█████████▌| 48/50 [13:16<00:30, 15.27s/it] 98%|█████████▊| 49/50 [13:31<00:15, 15.40s/it]100%|██████████| 50/50 [13:50<00:00, 16.26s/it]100%|██████████| 50/50 [13:50<00:00, 16.60s/it]
[loss] ep 46 it 270 total=7.9495 mle=1.6577 pcon=4.8036 forget=1.3579 orth=0.1304 favg=0.0000 nr=103 nf=8 protos=570 fproto_sim=NA
[loss] ep 46 it 320 total=7.8636 mle=1.5969 pcon=4.8036 forget=1.3327 orth=0.1304 favg=0.0000 nr=98 nf=4 protos=570 fproto_sim=NA
[loss] ep 46 it 370 total=7.8935 mle=1.6152 pcon=4.8037 forget=1.3443 orth=0.1304 favg=0.0000 nr=105 nf=4 protos=570 fproto_sim=NA
[loss] ep 46 it 420 total=7.8808 mle=1.5834 pcon=4.8036 forget=1.3633 orth=0.1303 favg=0.0000 nr=106 nf=7 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[loss] ep 47 it 40 total=7.9151 mle=1.6460 pcon=4.8037 forget=1.3351 orth=0.1303 favg=0.0000 nr=110 nf=1 protos=570 fproto_sim=NA
[loss] ep 47 it 90 total=7.8492 mle=1.5663 pcon=4.8040 forget=1.3486 orth=0.1303 favg=0.0000 nr=98 nf=12 protos=570 fproto_sim=NA
[loss] ep 47 it 140 total=7.8483 mle=1.5816 pcon=4.8039 forget=1.3325 orth=0.1303 favg=0.0000 nr=102 nf=4 protos=570 fproto_sim=NA
[loss] ep 47 it 190 total=7.8710 mle=1.5787 pcon=4.8040 forget=1.3579 orth=0.1303 favg=0.0000 nr=100 nf=5 protos=570 fproto_sim=NA
[loss] ep 47 it 240 total=7.8036 mle=1.5379 pcon=4.8038 forget=1.3316 orth=0.1303 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[loss] ep 47 it 290 total=7.8177 mle=1.5570 pcon=4.8037 forget=1.3267 orth=0.1303 favg=0.0000 nr=99 nf=5 protos=570 fproto_sim=NA
[loss] ep 47 it 340 total=7.8688 mle=1.6176 pcon=4.8036 forget=1.3173 orth=0.1303 favg=0.0000 nr=110 nf=4 protos=570 fproto_sim=NA
[loss] ep 47 it 390 total=8.0078 mle=1.7313 pcon=4.8036 forget=1.3425 orth=0.1303 favg=0.0000 nr=101 nf=8 protos=570 fproto_sim=NA
[loss] ep 48 it 10 total=7.9645 mle=1.6883 pcon=4.8035 forget=1.3424 orth=0.1303 favg=0.0000 nr=102 nf=9 protos=570 fproto_sim=NA
[loss] ep 48 it 60 total=7.9797 mle=1.6774 pcon=4.8035 forget=1.3685 orth=0.1303 favg=0.0000 nr=97 nf=8 protos=570 fproto_sim=NA
[loss] ep 48 it 110 total=8.0082 mle=1.6672 pcon=4.8036 forget=1.4071 orth=0.1303 favg=0.0000 nr=111 nf=2 protos=570 fproto_sim=NA
[loss] ep 48 it 160 total=7.8907 mle=1.6192 pcon=4.8034 forget=1.3379 orth=0.1303 favg=0.0000 nr=103 nf=7 protos=570 fproto_sim=NA
[loss] ep 48 it 210 total=7.9615 mle=1.6941 pcon=4.8035 forget=1.3337 orth=0.1303 favg=0.0000 nr=100 nf=4 protos=570 fproto_sim=NA
[loss] ep 48 it 260 total=7.9191 mle=1.6340 pcon=4.8036 forget=1.3512 orth=0.1303 favg=0.0000 nr=109 nf=2 protos=570 fproto_sim=NA
[loss] ep 48 it 310 total=7.8741 mle=1.6136 pcon=4.8036 forget=1.3265 orth=0.1303 favg=0.0000 nr=101 nf=7 protos=570 fproto_sim=NA
[loss] ep 48 it 360 total=7.9623 mle=1.7032 pcon=4.8036 forget=1.3251 orth=0.1303 favg=0.0000 nr=98 nf=6 protos=570 fproto_sim=NA
[loss] ep 48 it 410 total=7.9645 mle=1.6537 pcon=4.8036 forget=1.3768 orth=0.1303 favg=0.0000 nr=108 nf=6 protos=570 fproto_sim=NA
[loss] ep 49 it 30 total=7.8255 mle=1.5628 pcon=4.8036 forget=1.3287 orth=0.1303 favg=0.0000 nr=98 nf=7 protos=570 fproto_sim=NA
[loss] ep 49 it 80 total=7.8908 mle=1.6132 pcon=4.8037 forget=1.3436 orth=0.1303 favg=0.0000 nr=107 nf=7 protos=570 fproto_sim=NA
[loss] ep 49 it 130 total=7.8021 mle=1.5250 pcon=4.8036 forget=1.3431 orth=0.1303 favg=0.0000 nr=103 nf=4 protos=570 fproto_sim=NA
[loss] ep 49 it 180 total=8.0271 mle=1.7667 pcon=4.8036 forget=1.3264 orth=0.1303 favg=0.0000 nr=101 nf=5 protos=570 fproto_sim=NA
[loss] ep 49 it 230 total=7.9045 mle=1.6416 pcon=4.8036 forget=1.3289 orth=0.1303 favg=0.0000 nr=101 nf=6 protos=570 fproto_sim=NA
[loss] ep 49 it 280 total=7.9510 mle=1.6596 pcon=4.8039 forget=1.3572 orth=0.1303 favg=0.0000 nr=100 nf=7 protos=570 fproto_sim=NA
[loss] ep 49 it 330 total=7.8689 mle=1.6118 pcon=4.8039 forget=1.3229 orth=0.1303 favg=0.0000 nr=102 nf=3 protos=570 fproto_sim=NA
[loss] ep 49 it 380 total=8.0192 mle=1.6941 pcon=4.8038 forget=1.3910 orth=0.1303 favg=0.0000 nr=107 nf=1 protos=570 fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc1-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:15,  2.20it/s]  2%|▏         | 10/430 [00:00<00:18, 22.60it/s]  5%|▍         | 20/430 [00:00<00:10, 40.81it/s]  7%|▋         | 30/430 [00:00<00:07, 55.11it/s]  9%|▉         | 40/430 [00:00<00:05, 65.87it/s] 12%|█▏        | 50/430 [00:00<00:05, 74.51it/s] 14%|█▍        | 60/430 [00:01<00:04, 80.79it/s] 16%|█▋        | 70/430 [00:01<00:04, 85.37it/s] 19%|█▊        | 80/430 [00:01<00:04, 87.32it/s] 21%|██        | 90/430 [00:01<00:03, 89.45it/s] 23%|██▎       | 100/430 [00:01<00:03, 91.42it/s] 26%|██▌       | 110/430 [00:01<00:03, 92.52it/s] 28%|██▊       | 120/430 [00:01<00:03, 93.60it/s] 30%|███       | 130/430 [00:01<00:03, 94.57it/s] 33%|███▎      | 140/430 [00:01<00:03, 95.06it/s] 35%|███▍      | 150/430 [00:02<00:02, 95.55it/s] 37%|███▋      | 160/430 [00:02<00:02, 95.92it/s] 40%|███▉      | 170/430 [00:02<00:02, 96.13it/s] 42%|████▏     | 180/430 [00:02<00:02, 94.90it/s] 44%|████▍     | 190/430 [00:02<00:02, 94.93it/s] 47%|████▋     | 200/430 [00:02<00:02, 95.09it/s] 49%|████▉     | 210/430 [00:02<00:02, 95.45it/s] 51%|█████     | 220/430 [00:02<00:02, 95.65it/s] 53%|█████▎    | 230/430 [00:02<00:02, 95.79it/s] 56%|█████▌    | 240/430 [00:02<00:01, 95.89it/s] 58%|█████▊    | 250/430 [00:03<00:01, 95.97it/s] 60%|██████    | 260/430 [00:03<00:01, 96.25it/s] 63%|██████▎   | 270/430 [00:03<00:01, 96.23it/s] 65%|██████▌   | 280/430 [00:03<00:01, 95.30it/s] 67%|██████▋   | 290/430 [00:03<00:01, 95.02it/s] 70%|██████▉   | 300/430 [00:03<00:01, 95.28it/s] 72%|███████▏  | 310/430 [00:03<00:01, 95.49it/s] 74%|███████▍  | 320/430 [00:03<00:01, 95.75it/s] 77%|███████▋  | 330/430 [00:03<00:01, 95.97it/s] 79%|███████▉  | 340/430 [00:04<00:00, 96.19it/s] 81%|████████▏ | 350/430 [00:04<00:00, 96.32it/s] 84%|████████▎ | 360/430 [00:04<00:00, 96.35it/s] 86%|████████▌ | 370/430 [00:04<00:00, 96.43it/s] 88%|████████▊ | 380/430 [00:04<00:00, 96.05it/s] 91%|█████████ | 390/430 [00:04<00:00, 95.89it/s] 93%|█████████▎| 400/430 [00:04<00:00, 94.92it/s] 95%|█████████▌| 410/430 [00:04<00:00, 95.63it/s] 98%|█████████▊| 420/430 [00:04<00:00, 96.20it/s]100%|██████████| 430/430 [00:04<00:00, 94.41it/s]100%|██████████| 430/430 [00:04<00:00, 86.55it/s]
55000 images processed, 5.045658826828003 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:38,  2.20it/s] 13%|█▎        | 11/86 [00:00<00:02, 25.13it/s] 24%|██▍       | 21/86 [00:00<00:01, 42.97it/s] 35%|███▍      | 30/86 [00:00<00:01, 55.17it/s] 47%|████▋     | 40/86 [00:00<00:00, 66.50it/s] 58%|█████▊    | 50/86 [00:00<00:00, 74.73it/s] 70%|██████▉   | 60/86 [00:01<00:00, 80.70it/s] 81%|████████▏ | 70/86 [00:01<00:00, 85.56it/s] 93%|█████████▎| 80/86 [00:01<00:00, 89.10it/s]100%|██████████| 86/86 [00:01<00:00, 63.43it/s]
11000 images processed, 1.3693482875823975 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:31,  2.22it/s]  4%|▍         | 9/204 [00:00<00:09, 20.43it/s]  9%|▉         | 19/204 [00:00<00:04, 39.83it/s] 14%|█▍        | 29/204 [00:00<00:03, 54.48it/s] 19%|█▉        | 39/204 [00:00<00:02, 65.66it/s] 24%|██▎       | 48/204 [00:00<00:02, 70.72it/s] 28%|██▊       | 58/204 [00:01<00:01, 76.93it/s] 33%|███▎      | 68/204 [00:01<00:01, 81.65it/s] 38%|███▊      | 77/204 [00:01<00:01, 82.82it/s] 42%|████▏     | 86/204 [00:01<00:01, 80.93it/s] 47%|████▋     | 96/204 [00:01<00:01, 84.04it/s] 51%|█████▏    | 105/204 [00:01<00:01, 84.90it/s] 56%|█████▌    | 114/204 [00:01<00:01, 85.10it/s] 61%|██████    | 124/204 [00:01<00:00, 87.80it/s] 66%|██████▌   | 134/204 [00:01<00:00, 89.76it/s] 71%|███████   | 144/204 [00:02<00:00, 91.08it/s] 75%|███████▌  | 154/204 [00:02<00:00, 92.27it/s] 80%|████████  | 164/204 [00:02<00:00, 93.20it/s] 85%|████████▌ | 174/204 [00:02<00:00, 93.51it/s] 90%|█████████ | 184/204 [00:02<00:00, 94.63it/s] 95%|█████████▌| 194/204 [00:02<00:00, 95.38it/s]100%|██████████| 204/204 [00:02<00:00, 95.07it/s]100%|██████████| 204/204 [00:02<00:00, 75.79it/s]
26032 images processed, 2.729856252670288 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.61it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.88it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.22it/s] 39%|███▉      | 31/79 [00:00<00:00, 50.17it/s] 52%|█████▏    | 41/79 [00:01<00:00, 61.59it/s] 65%|██████▍   | 51/79 [00:01<00:00, 70.56it/s] 77%|███████▋  | 61/79 [00:01<00:00, 77.65it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.97it/s]100%|██████████| 79/79 [00:01<00:00, 54.81it/s]
10000 images processed, 1.4682002067565918 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.96it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.17it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.88it/s] 39%|███▉      | 31/79 [00:00<00:00, 55.11it/s] 52%|█████▏    | 41/79 [00:00<00:00, 66.10it/s] 65%|██████▍   | 51/79 [00:01<00:00, 74.48it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.85it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.60it/s]100%|██████████| 79/79 [00:01<00:00, 60.18it/s]
10000 images processed, 1.331641674041748 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  2.01it/s] 16%|█▌        | 11/70 [00:00<00:02, 23.54it/s] 30%|███       | 21/70 [00:00<00:01, 41.13it/s] 44%|████▍     | 31/70 [00:00<00:00, 55.22it/s] 59%|█████▊    | 41/70 [00:00<00:00, 65.93it/s] 73%|███████▎  | 51/70 [00:01<00:00, 74.51it/s] 87%|████████▋ | 61/70 [00:01<00:00, 80.85it/s]100%|██████████| 70/70 [00:01<00:00, 57.17it/s]
8925 images processed, 1.2541353702545166 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.13it/s]  4%|▍         | 2/45 [00:00<00:18,  2.32it/s] 27%|██▋       | 12/45 [00:01<00:01, 18.15it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.07it/s] 49%|████▉     | 22/45 [00:01<00:00, 23.78it/s] 58%|█████▊    | 26/45 [00:01<00:00, 26.72it/s] 73%|███████▎  | 33/45 [00:01<00:00, 22.46it/s] 87%|████████▋ | 39/45 [00:02<00:00, 28.36it/s]100%|██████████| 45/45 [00:02<00:00, 21.27it/s]
5640 images processed, 2.137611150741577 seconds used

16.854936122894287
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.67  99.73  94.96
places365     49.11  92.94  77.04
LSUN           4.74  98.95  93.04
iSUN          42.67  93.72  81.21
dtd           24.89  96.24  89.77
AVG           24.62  96.32  87.20
[incremental] Overall: 0.8820 New: 0.8780 Old: 0.8820
1.986809492111206
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc1-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<04:00,  1.78it/s]  3%|▎         | 11/430 [00:00<00:19, 21.36it/s]  5%|▍         | 21/430 [00:00<00:10, 38.20it/s]  7%|▋         | 31/430 [00:00<00:07, 52.37it/s] 10%|▉         | 41/430 [00:00<00:06, 63.74it/s] 12%|█▏        | 51/430 [00:01<00:05, 72.39it/s] 14%|█▍        | 61/430 [00:01<00:04, 78.66it/s] 17%|█▋        | 71/430 [00:01<00:04, 83.74it/s] 19%|█▉        | 81/430 [00:01<00:04, 86.82it/s] 21%|██        | 91/430 [00:01<00:03, 89.56it/s] 23%|██▎       | 101/430 [00:01<00:03, 91.44it/s] 26%|██▌       | 111/430 [00:01<00:03, 91.94it/s] 28%|██▊       | 121/430 [00:01<00:03, 93.29it/s] 30%|███       | 131/430 [00:01<00:03, 93.50it/s] 33%|███▎      | 141/430 [00:02<00:03, 93.51it/s] 35%|███▌      | 151/430 [00:02<00:02, 94.52it/s] 37%|███▋      | 161/430 [00:02<00:02, 94.41it/s] 40%|███▉      | 171/430 [00:02<00:02, 95.17it/s] 42%|████▏     | 181/430 [00:02<00:02, 95.58it/s] 44%|████▍     | 191/430 [00:02<00:02, 94.69it/s] 47%|████▋     | 201/430 [00:02<00:02, 95.29it/s] 49%|████▉     | 211/430 [00:02<00:02, 94.94it/s] 51%|█████▏    | 221/430 [00:02<00:02, 95.20it/s] 54%|█████▎    | 231/430 [00:02<00:02, 95.34it/s] 56%|█████▌    | 241/430 [00:03<00:01, 95.35it/s] 58%|█████▊    | 251/430 [00:03<00:01, 95.64it/s] 61%|██████    | 261/430 [00:03<00:01, 95.25it/s] 63%|██████▎   | 271/430 [00:03<00:01, 95.48it/s] 65%|██████▌   | 281/430 [00:03<00:01, 95.58it/s] 68%|██████▊   | 291/430 [00:03<00:01, 95.64it/s] 70%|███████   | 301/430 [00:03<00:01, 95.43it/s] 72%|███████▏  | 311/430 [00:03<00:01, 95.55it/s] 75%|███████▍  | 321/430 [00:03<00:01, 95.60it/s] 77%|███████▋  | 331/430 [00:04<00:01, 95.90it/s] 79%|███████▉  | 341/430 [00:04<00:00, 96.07it/s] 82%|████████▏ | 351/430 [00:04<00:00, 96.15it/s] 84%|████████▍ | 361/430 [00:04<00:00, 96.13it/s] 86%|████████▋ | 371/430 [00:04<00:00, 94.88it/s] 89%|████████▊ | 381/430 [00:04<00:00, 95.38it/s] 91%|█████████ | 391/430 [00:04<00:00, 95.73it/s] 93%|█████████▎| 401/430 [00:04<00:00, 95.71it/s] 96%|█████████▌| 411/430 [00:04<00:00, 96.35it/s] 98%|█████████▊| 421/430 [00:04<00:00, 96.78it/s]100%|██████████| 430/430 [00:05<00:00, 84.96it/s]
55000 images processed, 5.172551393508911 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:38,  2.22it/s] 12%|█▏        | 10/86 [00:00<00:03, 22.76it/s] 22%|██▏       | 19/86 [00:00<00:01, 39.00it/s] 31%|███▏      | 27/86 [00:00<00:01, 49.63it/s] 43%|████▎     | 37/86 [00:00<00:00, 61.90it/s] 52%|█████▏    | 45/86 [00:00<00:00, 66.54it/s] 64%|██████▍   | 55/86 [00:01<00:00, 74.32it/s] 76%|███████▌  | 65/86 [00:01<00:00, 79.92it/s] 87%|████████▋ | 75/86 [00:01<00:00, 84.14it/s] 99%|█████████▉| 85/86 [00:01<00:00, 87.19it/s]100%|██████████| 86/86 [00:01<00:00, 60.57it/s]
11000 images processed, 1.446058750152588 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc1-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:45,  1.92it/s]  4%|▍         | 9/204 [00:00<00:10, 18.48it/s]  8%|▊         | 17/204 [00:00<00:05, 32.45it/s] 13%|█▎        | 27/204 [00:00<00:03, 48.06it/s] 18%|█▊        | 37/204 [00:00<00:02, 59.91it/s] 23%|██▎       | 47/204 [00:01<00:02, 69.63it/s] 27%|██▋       | 56/204 [00:01<00:02, 72.99it/s] 32%|███▏      | 66/204 [00:01<00:01, 79.16it/s] 37%|███▋      | 76/204 [00:01<00:01, 83.89it/s] 42%|████▏     | 86/204 [00:01<00:01, 86.15it/s] 47%|████▋     | 96/204 [00:01<00:01, 88.31it/s] 52%|█████▏    | 106/204 [00:01<00:01, 90.18it/s] 57%|█████▋    | 116/204 [00:01<00:00, 91.60it/s] 62%|██████▏   | 126/204 [00:01<00:00, 91.54it/s] 67%|██████▋   | 136/204 [00:02<00:00, 86.54it/s] 72%|███████▏  | 146/204 [00:02<00:00, 88.81it/s] 76%|███████▋  | 156/204 [00:02<00:00, 90.55it/s] 81%|████████▏ | 166/204 [00:02<00:00, 92.06it/s] 86%|████████▋ | 176/204 [00:02<00:00, 93.23it/s] 91%|█████████ | 186/204 [00:02<00:00, 86.65it/s] 96%|█████████▌| 195/204 [00:02<00:00, 81.23it/s]100%|██████████| 204/204 [00:02<00:00, 73.48it/s]100%|██████████| 204/204 [00:02<00:00, 70.84it/s]
26032 images processed, 2.925076484680176 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:50,  1.53it/s] 11%|█▏        | 9/79 [00:00<00:04, 14.50it/s] 24%|██▍       | 19/79 [00:00<00:01, 30.33it/s] 32%|███▏      | 25/79 [00:01<00:01, 32.91it/s] 44%|████▍     | 35/79 [00:01<00:00, 46.32it/s] 53%|█████▎    | 42/79 [00:01<00:00, 43.34it/s] 66%|██████▌   | 52/79 [00:01<00:00, 54.54it/s] 75%|███████▍  | 59/79 [00:01<00:00, 46.34it/s] 87%|████████▋ | 69/79 [00:01<00:00, 56.93it/s] 97%|█████████▋| 77/79 [00:01<00:00, 61.64it/s]100%|██████████| 79/79 [00:02<00:00, 38.50it/s]
10000 images processed, 2.1096110343933105 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:41,  1.90it/s] 14%|█▍        | 11/79 [00:00<00:03, 22.40it/s] 27%|██▋       | 21/79 [00:00<00:01, 39.72it/s] 39%|███▉      | 31/79 [00:00<00:00, 53.80it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.19it/s] 65%|██████▍   | 51/79 [00:01<00:00, 72.58it/s] 77%|███████▋  | 61/79 [00:01<00:00, 79.28it/s] 90%|████████▉ | 71/79 [00:01<00:00, 84.34it/s]100%|██████████| 79/79 [00:01<00:00, 58.83it/s]
10000 images processed, 1.3646512031555176 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  1.99it/s]  9%|▊         | 6/70 [00:00<00:05, 12.58it/s] 23%|██▎       | 16/70 [00:00<00:01, 33.08it/s] 37%|███▋      | 26/70 [00:00<00:00, 49.10it/s] 51%|█████▏    | 36/70 [00:00<00:00, 61.33it/s] 66%|██████▌   | 46/70 [00:01<00:00, 70.85it/s] 79%|███████▊  | 55/70 [00:01<00:00, 65.10it/s] 91%|█████████▏| 64/70 [00:01<00:00, 70.19it/s]100%|██████████| 70/70 [00:01<00:00, 51.36it/s]
8925 images processed, 1.3983442783355713 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:40,  1.09it/s] 11%|█         | 5/45 [00:01<00:07,  5.69it/s] 31%|███       | 14/45 [00:01<00:02, 13.59it/s] 47%|████▋     | 21/45 [00:02<00:01, 12.43it/s] 67%|██████▋   | 30/45 [00:02<00:00, 19.09it/s] 82%|████████▏ | 37/45 [00:02<00:00, 19.42it/s]100%|██████████| 45/45 [00:02<00:00, 16.99it/s]
5640 images processed, 2.6733760833740234 seconds used

18.760817289352417
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.65  99.38  98.31
places365     72.67  78.20  78.75
LSUN           8.26  98.02  98.11
iSUN          67.82  83.41  86.79
dtd           40.83  90.29  94.35
AVG           38.45  89.86  91.26
Retain-Acc: 0.7314
Forget-as-OOD (retain known vs forget novel):
  FPR: 43.40 AUROC: 89.17 AUIN: 99.32
8.31526494026184
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc2-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:05,  2.32it/s]  2%|▏         | 10/430 [00:00<00:17, 23.57it/s]  5%|▍         | 20/430 [00:00<00:09, 42.37it/s]  7%|▋         | 29/430 [00:00<00:07, 54.81it/s]  9%|▉         | 38/430 [00:00<00:06, 64.35it/s] 11%|█         | 47/430 [00:00<00:05, 68.28it/s] 13%|█▎        | 55/430 [00:01<00:12, 28.95it/s] 15%|█▍        | 63/430 [00:01<00:10, 34.99it/s] 17%|█▋        | 71/430 [00:01<00:08, 41.71it/s] 18%|█▊        | 78/430 [00:01<00:07, 46.55it/s] 20%|██        | 86/430 [00:02<00:06, 51.95it/s] 22%|██▏       | 94/430 [00:02<00:05, 57.84it/s] 24%|██▎       | 102/430 [00:02<00:05, 60.66it/s] 26%|██▌       | 110/430 [00:02<00:04, 64.41it/s] 27%|██▋       | 118/430 [00:02<00:04, 66.40it/s] 29%|██▉       | 126/430 [00:02<00:04, 69.59it/s] 31%|███       | 134/430 [00:02<00:04, 69.73it/s] 33%|███▎      | 142/430 [00:02<00:04, 71.81it/s] 35%|███▍      | 150/430 [00:02<00:03, 71.11it/s] 37%|███▋      | 158/430 [00:03<00:03, 72.33it/s] 39%|███▊      | 166/430 [00:03<00:03, 72.10it/s] 40%|████      | 174/430 [00:03<00:03, 73.73it/s] 42%|████▏     | 182/430 [00:03<00:03, 72.75it/s] 44%|████▍     | 190/430 [00:03<00:03, 74.23it/s] 46%|████▌     | 198/430 [00:03<00:03, 72.77it/s] 48%|████▊     | 206/430 [00:03<00:03, 74.28it/s] 50%|████▉     | 214/430 [00:03<00:02, 75.00it/s] 52%|█████▏    | 222/430 [00:03<00:02, 73.88it/s] 53%|█████▎    | 230/430 [00:03<00:02, 74.62it/s] 55%|█████▌    | 238/430 [00:04<00:02, 73.68it/s] 57%|█████▋    | 246/430 [00:04<00:02, 74.56it/s] 59%|█████▉    | 254/430 [00:04<00:02, 72.76it/s] 61%|██████    | 262/430 [00:04<00:02, 72.13it/s] 63%|██████▎   | 270/430 [00:04<00:02, 73.52it/s] 65%|██████▍   | 278/430 [00:04<00:02, 72.52it/s] 67%|██████▋   | 286/430 [00:04<00:01, 74.06it/s] 68%|██████▊   | 294/430 [00:04<00:01, 72.59it/s] 70%|███████   | 302/430 [00:04<00:01, 73.54it/s] 72%|███████▏  | 310/430 [00:05<00:01, 72.90it/s] 74%|███████▍  | 318/430 [00:05<00:01, 71.84it/s] 76%|███████▌  | 326/430 [00:05<00:01, 73.53it/s] 78%|███████▊  | 334/430 [00:05<00:01, 74.98it/s] 80%|███████▉  | 342/430 [00:05<00:01, 73.36it/s] 81%|████████▏ | 350/430 [00:05<00:01, 74.70it/s] 83%|████████▎ | 358/430 [00:05<00:00, 73.36it/s] 85%|████████▌ | 366/430 [00:05<00:00, 74.76it/s] 87%|████████▋ | 374/430 [00:05<00:00, 73.22it/s] 89%|████████▉ | 382/430 [00:06<00:00, 74.63it/s] 91%|█████████ | 390/430 [00:06<00:00, 73.27it/s] 93%|█████████▎| 398/430 [00:06<00:00, 71.30it/s] 94%|█████████▍| 406/430 [00:06<00:00, 73.32it/s] 96%|█████████▋| 414/430 [00:06<00:00, 73.96it/s] 98%|█████████▊| 422/430 [00:06<00:00, 73.83it/s]100%|██████████| 430/430 [00:06<00:00, 73.27it/s]100%|██████████| 430/430 [00:06<00:00, 63.94it/s]
55000 images processed, 6.796692132949829 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:37,  2.25it/s] 10%|█         | 9/86 [00:00<00:03, 20.17it/s] 20%|█▉        | 17/86 [00:00<00:02, 34.09it/s] 28%|██▊       | 24/86 [00:00<00:01, 43.08it/s] 37%|███▋      | 32/86 [00:00<00:01, 50.90it/s] 47%|████▋     | 40/86 [00:00<00:00, 58.23it/s] 56%|█████▌    | 48/86 [00:01<00:00, 63.82it/s] 65%|██████▌   | 56/86 [00:01<00:00, 68.23it/s] 74%|███████▍  | 64/86 [00:01<00:00, 71.16it/s] 84%|████████▎ | 72/86 [00:01<00:00, 73.52it/s] 93%|█████████▎| 80/86 [00:01<00:00, 75.31it/s]100%|██████████| 86/86 [00:01<00:00, 54.58it/s]
11000 images processed, 1.5895404815673828 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:38,  2.06it/s]  4%|▍         | 8/204 [00:00<00:11, 17.36it/s]  7%|▋         | 15/204 [00:00<00:06, 30.17it/s] 11%|█▏        | 23/204 [00:00<00:04, 41.82it/s] 15%|█▍        | 30/204 [00:00<00:03, 48.54it/s] 19%|█▊        | 38/204 [00:01<00:02, 56.55it/s] 23%|██▎       | 46/204 [00:01<00:02, 62.43it/s] 26%|██▋       | 54/204 [00:01<00:02, 64.47it/s] 30%|███       | 62/204 [00:01<00:02, 65.85it/s] 34%|███▍      | 70/204 [00:01<00:01, 68.89it/s] 38%|███▊      | 78/204 [00:01<00:01, 68.57it/s] 42%|████▏     | 86/204 [00:01<00:01, 70.80it/s] 46%|████▌     | 94/204 [00:01<00:01, 72.57it/s] 50%|█████     | 102/204 [00:01<00:01, 73.32it/s] 54%|█████▍    | 110/204 [00:01<00:01, 71.88it/s] 58%|█████▊    | 118/204 [00:02<00:01, 73.40it/s] 62%|██████▏   | 126/204 [00:02<00:01, 74.07it/s] 66%|██████▌   | 134/204 [00:02<00:00, 73.14it/s] 70%|██████▉   | 142/204 [00:02<00:00, 73.42it/s] 74%|███████▎  | 150/204 [00:02<00:00, 72.97it/s] 77%|███████▋  | 158/204 [00:02<00:00, 74.02it/s] 81%|████████▏ | 166/204 [00:02<00:00, 75.33it/s] 85%|████████▌ | 174/204 [00:02<00:00, 75.89it/s] 90%|████████▉ | 183/204 [00:02<00:00, 77.37it/s] 94%|█████████▍| 192/204 [00:03<00:00, 78.47it/s] 98%|█████████▊| 200/204 [00:03<00:00, 75.77it/s]100%|██████████| 204/204 [00:03<00:00, 62.79it/s]
26032 images processed, 3.3000285625457764 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.75it/s] 10%|█         | 8/79 [00:00<00:04, 14.98it/s] 19%|█▉        | 15/79 [00:00<00:02, 26.68it/s] 28%|██▊       | 22/79 [00:00<00:01, 36.53it/s] 38%|███▊      | 30/79 [00:00<00:01, 46.82it/s] 48%|████▊     | 38/79 [00:01<00:00, 54.74it/s] 57%|█████▋    | 45/79 [00:01<00:00, 58.30it/s] 67%|██████▋   | 53/79 [00:01<00:00, 63.34it/s] 77%|███████▋  | 61/79 [00:01<00:00, 65.27it/s] 87%|████████▋ | 69/79 [00:01<00:00, 68.68it/s] 97%|█████████▋| 77/79 [00:01<00:00, 69.04it/s]100%|██████████| 79/79 [00:01<00:00, 47.06it/s]
10000 images processed, 1.7071971893310547 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.14it/s]  9%|▉         | 7/79 [00:00<00:04, 15.17it/s] 19%|█▉        | 15/79 [00:00<00:02, 30.66it/s] 29%|██▉       | 23/79 [00:00<00:01, 42.94it/s] 38%|███▊      | 30/79 [00:00<00:00, 49.43it/s] 48%|████▊     | 38/79 [00:01<00:00, 55.38it/s] 58%|█████▊    | 46/79 [00:01<00:00, 61.15it/s] 67%|██████▋   | 53/79 [00:01<00:00, 63.01it/s] 77%|███████▋  | 61/79 [00:01<00:00, 67.15it/s] 87%|████████▋ | 69/79 [00:01<00:00, 67.99it/s] 97%|█████████▋| 77/79 [00:01<00:00, 70.18it/s]100%|██████████| 79/79 [00:01<00:00, 50.37it/s]
10000 images processed, 1.5897095203399658 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.93it/s] 11%|█▏        | 8/70 [00:00<00:03, 16.31it/s] 21%|██▏       | 15/70 [00:00<00:01, 28.71it/s] 31%|███▏      | 22/70 [00:00<00:01, 38.82it/s] 43%|████▎     | 30/70 [00:00<00:00, 48.69it/s] 53%|█████▎    | 37/70 [00:01<00:00, 53.94it/s] 64%|██████▍   | 45/70 [00:01<00:00, 58.77it/s] 76%|███████▌  | 53/70 [00:01<00:00, 63.94it/s] 87%|████████▋ | 61/70 [00:01<00:00, 65.71it/s] 99%|█████████▊| 69/70 [00:01<00:00, 68.50it/s]100%|██████████| 70/70 [00:01<00:00, 46.69it/s]
8925 images processed, 1.5267713069915771 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.04it/s] 11%|█         | 5/45 [00:01<00:06,  5.98it/s] 31%|███       | 14/45 [00:01<00:01, 18.55it/s] 42%|████▏     | 19/45 [00:01<00:01, 18.73it/s] 51%|█████     | 23/45 [00:01<00:01, 20.19it/s] 69%|██████▉   | 31/45 [00:01<00:00, 29.92it/s] 80%|████████  | 36/45 [00:02<00:00, 23.44it/s] 98%|█████████▊| 44/45 [00:02<00:00, 32.44it/s]100%|██████████| 45/45 [00:02<00:00, 20.73it/s]
5640 images processed, 2.1921942234039307 seconds used

20.32453417778015
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.67  99.73  94.96
places365     49.11  92.94  77.04
LSUN           4.74  98.95  93.04
iSUN          42.67  93.72  81.21
dtd           24.89  96.24  89.77
AVG           24.62  96.32  87.20
[incremental] Overall: 0.8820 New: 0.8860 Old: 0.8820
1.9516139030456543
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc2-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:40,  1.95it/s]  2%|▏         | 8/430 [00:00<00:25, 16.49it/s]  4%|▎         | 16/430 [00:00<00:13, 31.09it/s]  5%|▌         | 23/430 [00:00<00:10, 40.34it/s]  7%|▋         | 31/430 [00:00<00:07, 50.25it/s]  9%|▉         | 39/430 [00:01<00:06, 55.99it/s] 11%|█         | 47/430 [00:01<00:06, 61.98it/s] 13%|█▎        | 55/430 [00:01<00:05, 64.49it/s] 15%|█▍        | 63/430 [00:01<00:05, 67.74it/s] 17%|█▋        | 71/430 [00:01<00:05, 68.69it/s] 18%|█▊        | 79/430 [00:01<00:04, 70.52it/s] 20%|██        | 87/430 [00:01<00:04, 71.26it/s] 22%|██▏       | 95/430 [00:01<00:04, 72.65it/s] 24%|██▍       | 103/430 [00:01<00:04, 72.03it/s] 26%|██▌       | 111/430 [00:02<00:04, 71.42it/s] 28%|██▊       | 119/430 [00:02<00:04, 73.25it/s] 30%|██▉       | 127/430 [00:02<00:04, 72.33it/s] 31%|███▏      | 135/430 [00:02<00:04, 73.57it/s] 33%|███▎      | 143/430 [00:02<00:03, 72.98it/s] 35%|███▌      | 151/430 [00:02<00:03, 72.96it/s] 37%|███▋      | 159/430 [00:02<00:03, 71.64it/s] 39%|███▉      | 167/430 [00:02<00:03, 73.10it/s] 41%|████      | 175/430 [00:02<00:03, 72.12it/s] 43%|████▎     | 183/430 [00:03<00:03, 73.83it/s] 44%|████▍     | 191/430 [00:03<00:03, 72.62it/s] 46%|████▋     | 199/430 [00:03<00:03, 73.71it/s] 48%|████▊     | 207/430 [00:03<00:03, 73.11it/s] 50%|█████     | 215/430 [00:03<00:02, 74.00it/s] 52%|█████▏    | 223/430 [00:03<00:02, 73.18it/s] 54%|█████▎    | 231/430 [00:03<00:02, 72.07it/s] 56%|█████▌    | 239/430 [00:03<00:02, 73.00it/s] 57%|█████▋    | 247/430 [00:03<00:02, 72.31it/s] 59%|█████▉    | 255/430 [00:04<00:02, 71.55it/s] 61%|██████    | 263/430 [00:04<00:02, 72.72it/s] 63%|██████▎   | 271/430 [00:04<00:02, 72.49it/s] 65%|██████▍   | 279/430 [00:04<00:02, 72.94it/s] 67%|██████▋   | 287/430 [00:04<00:01, 73.04it/s] 69%|██████▊   | 295/430 [00:04<00:01, 70.97it/s] 70%|███████   | 303/430 [00:04<00:01, 70.68it/s] 72%|███████▏  | 311/430 [00:04<00:01, 72.06it/s] 74%|███████▍  | 319/430 [00:04<00:01, 71.68it/s] 76%|███████▌  | 327/430 [00:05<00:01, 71.35it/s] 78%|███████▊  | 335/430 [00:05<00:01, 73.20it/s] 80%|███████▉  | 343/430 [00:05<00:01, 72.22it/s] 82%|████████▏ | 351/430 [00:05<00:01, 73.74it/s] 83%|████████▎ | 359/430 [00:05<00:00, 72.55it/s] 85%|████████▌ | 367/430 [00:05<00:00, 73.44it/s] 87%|████████▋ | 375/430 [00:05<00:00, 72.83it/s] 89%|████████▉ | 383/430 [00:05<00:00, 73.69it/s] 91%|█████████ | 391/430 [00:05<00:00, 73.04it/s] 93%|█████████▎| 399/430 [00:05<00:00, 72.01it/s] 95%|█████████▍| 407/430 [00:06<00:00, 73.68it/s] 97%|█████████▋| 415/430 [00:06<00:00, 74.61it/s] 98%|█████████▊| 423/430 [00:06<00:00, 73.84it/s]100%|██████████| 430/430 [00:06<00:00, 67.08it/s]
55000 images processed, 6.527306795120239 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:37,  2.26it/s]  7%|▋         | 6/86 [00:00<00:05, 13.54it/s] 15%|█▌        | 13/86 [00:00<00:02, 27.44it/s] 23%|██▎       | 20/86 [00:00<00:01, 37.90it/s] 33%|███▎      | 28/86 [00:00<00:01, 46.92it/s] 42%|████▏     | 36/86 [00:00<00:00, 54.26it/s] 50%|█████     | 43/86 [00:01<00:00, 57.92it/s] 58%|█████▊    | 50/86 [00:01<00:00, 60.04it/s] 66%|██████▋   | 57/86 [00:01<00:00, 62.01it/s] 76%|███████▌  | 65/86 [00:01<00:00, 66.01it/s] 84%|████████▎ | 72/86 [00:01<00:00, 66.19it/s] 93%|█████████▎| 80/86 [00:01<00:00, 68.70it/s]100%|██████████| 86/86 [00:01<00:00, 49.88it/s]
11000 images processed, 1.7526872158050537 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc2-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:36,  2.10it/s]  4%|▍         | 8/204 [00:00<00:11, 17.41it/s]  8%|▊         | 16/204 [00:00<00:05, 31.94it/s] 12%|█▏        | 24/204 [00:00<00:04, 43.00it/s] 15%|█▌        | 31/204 [00:00<00:03, 49.45it/s] 19%|█▉        | 39/204 [00:01<00:02, 56.57it/s] 23%|██▎       | 46/204 [00:01<00:02, 58.90it/s] 26%|██▌       | 53/204 [00:01<00:02, 60.89it/s] 30%|██▉       | 61/204 [00:01<00:02, 63.19it/s] 34%|███▍      | 69/204 [00:01<00:02, 66.87it/s] 37%|███▋      | 76/204 [00:01<00:01, 66.59it/s] 41%|████      | 84/204 [00:01<00:01, 68.93it/s] 45%|████▌     | 92/204 [00:01<00:01, 69.21it/s] 49%|████▉     | 100/204 [00:01<00:01, 68.99it/s] 52%|█████▏    | 107/204 [00:02<00:01, 68.40it/s] 56%|█████▋    | 115/204 [00:02<00:01, 70.04it/s] 60%|██████    | 123/204 [00:02<00:01, 69.33it/s] 64%|██████▎   | 130/204 [00:02<00:01, 68.99it/s] 68%|██████▊   | 138/204 [00:02<00:00, 69.14it/s] 72%|███████▏  | 146/204 [00:02<00:00, 71.21it/s] 75%|███████▌  | 154/204 [00:02<00:00, 70.54it/s] 79%|███████▉  | 162/204 [00:02<00:00, 70.02it/s] 83%|████████▎ | 170/204 [00:02<00:00, 71.92it/s] 87%|████████▋ | 178/204 [00:03<00:00, 70.88it/s] 91%|█████████ | 186/204 [00:03<00:00, 70.54it/s] 95%|█████████▌| 194/204 [00:03<00:00, 72.37it/s] 99%|█████████▉| 202/204 [00:03<00:00, 71.45it/s]100%|██████████| 204/204 [00:03<00:00, 60.61it/s]
26032 images processed, 3.4030988216400146 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.61it/s] 11%|█▏        | 9/79 [00:00<00:04, 15.66it/s] 19%|█▉        | 15/79 [00:00<00:02, 24.58it/s] 28%|██▊       | 22/79 [00:00<00:01, 33.95it/s] 38%|███▊      | 30/79 [00:01<00:01, 42.89it/s] 48%|████▊     | 38/79 [00:01<00:00, 49.83it/s] 58%|█████▊    | 46/79 [00:01<00:00, 54.96it/s] 68%|██████▊   | 54/79 [00:01<00:00, 59.00it/s] 78%|███████▊  | 62/79 [00:01<00:00, 63.45it/s] 87%|████████▋ | 69/79 [00:01<00:00, 64.60it/s] 97%|█████████▋| 77/79 [00:01<00:00, 67.85it/s]100%|██████████| 79/79 [00:01<00:00, 44.42it/s]
10000 images processed, 1.8155596256256104 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.12it/s]  8%|▊         | 6/79 [00:00<00:05, 12.91it/s] 15%|█▌        | 12/79 [00:00<00:02, 24.30it/s] 24%|██▍       | 19/79 [00:00<00:01, 35.43it/s] 34%|███▍      | 27/79 [00:00<00:01, 46.21it/s] 43%|████▎     | 34/79 [00:01<00:00, 52.11it/s] 52%|█████▏    | 41/79 [00:01<00:00, 55.95it/s] 62%|██████▏   | 49/79 [00:01<00:00, 61.53it/s] 71%|███████   | 56/79 [00:01<00:00, 63.80it/s] 81%|████████  | 64/79 [00:01<00:00, 67.20it/s] 91%|█████████ | 72/79 [00:01<00:00, 68.38it/s]100%|██████████| 79/79 [00:01<00:00, 48.69it/s]
10000 images processed, 1.6436877250671387 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:32,  2.14it/s]  9%|▊         | 6/70 [00:00<00:04, 13.34it/s] 20%|██        | 14/70 [00:00<00:01, 29.24it/s] 30%|███       | 21/70 [00:00<00:01, 39.67it/s] 41%|████▏     | 29/70 [00:00<00:00, 49.75it/s] 51%|█████▏    | 36/70 [00:00<00:00, 54.40it/s] 63%|██████▎   | 44/70 [00:01<00:00, 60.42it/s] 73%|███████▎  | 51/70 [00:01<00:00, 62.92it/s] 84%|████████▍ | 59/70 [00:01<00:00, 66.66it/s] 96%|█████████▌| 67/70 [00:01<00:00, 68.08it/s]100%|██████████| 70/70 [00:01<00:00, 47.85it/s]
8925 images processed, 1.4903559684753418 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:40,  1.09it/s]  4%|▍         | 2/45 [00:01<00:20,  2.13it/s] 22%|██▏       | 10/45 [00:01<00:02, 13.82it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.65it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.21it/s] 56%|█████▌    | 25/45 [00:01<00:00, 24.92it/s] 73%|███████▎  | 33/45 [00:01<00:00, 23.81it/s] 82%|████████▏ | 37/45 [00:02<00:00, 25.27it/s]100%|██████████| 45/45 [00:02<00:00, 34.81it/s]100%|██████████| 45/45 [00:02<00:00, 20.21it/s]
5640 images processed, 2.2516021728515625 seconds used

20.56712532043457
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.63  99.38  98.33
places365     71.98  78.81  79.37
LSUN           6.93  98.34  98.47
iSUN          66.11  84.25  87.49
dtd           40.21  90.50  94.47
AVG           37.57  90.25  91.63
Retain-Acc: 0.7269
Forget-as-OOD (retain known vs forget novel):
  FPR: 45.40 AUROC: 90.86 AUIN: 99.50
8.266400814056396
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc2-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc2-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc3-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:01<12:16,  1.72s/it]  2%|▏         | 8/430 [00:01<01:11,  5.87it/s]  4%|▍         | 17/430 [00:01<00:29, 14.10it/s]  6%|▌         | 26/430 [00:02<00:17, 23.30it/s]  8%|▊         | 34/430 [00:02<00:12, 31.14it/s] 10%|█         | 44/430 [00:02<00:09, 42.37it/s] 13%|█▎        | 54/430 [00:02<00:07, 53.02it/s] 15%|█▍        | 64/430 [00:02<00:05, 62.51it/s] 17%|█▋        | 74/430 [00:02<00:05, 70.48it/s] 20%|█▉        | 84/430 [00:02<00:04, 76.49it/s] 22%|██▏       | 94/430 [00:02<00:04, 81.67it/s] 24%|██▍       | 104/430 [00:02<00:03, 85.73it/s] 27%|██▋       | 114/430 [00:02<00:03, 88.65it/s] 29%|██▉       | 124/430 [00:03<00:03, 90.84it/s] 31%|███       | 134/430 [00:03<00:03, 92.64it/s] 33%|███▎      | 144/430 [00:03<00:03, 93.72it/s] 36%|███▌      | 154/430 [00:03<00:02, 94.47it/s] 38%|███▊      | 164/430 [00:03<00:02, 95.26it/s] 40%|████      | 174/430 [00:03<00:02, 95.83it/s] 43%|████▎     | 184/430 [00:03<00:02, 96.18it/s] 45%|████▌     | 194/430 [00:03<00:02, 96.33it/s] 47%|████▋     | 204/430 [00:03<00:02, 96.39it/s] 50%|████▉     | 214/430 [00:04<00:02, 96.46it/s] 52%|█████▏    | 224/430 [00:04<00:02, 96.33it/s] 54%|█████▍    | 234/430 [00:04<00:02, 96.36it/s] 57%|█████▋    | 244/430 [00:04<00:01, 96.18it/s] 59%|█████▉    | 254/430 [00:04<00:01, 95.79it/s] 61%|██████▏   | 264/430 [00:04<00:01, 96.07it/s] 64%|██████▎   | 274/430 [00:04<00:01, 95.88it/s] 66%|██████▌   | 284/430 [00:04<00:01, 96.07it/s] 68%|██████▊   | 294/430 [00:04<00:01, 96.15it/s] 71%|███████   | 304/430 [00:04<00:01, 96.35it/s] 73%|███████▎  | 314/430 [00:05<00:01, 96.55it/s] 75%|███████▌  | 324/430 [00:05<00:01, 96.46it/s] 78%|███████▊  | 334/430 [00:05<00:00, 96.64it/s] 80%|████████  | 344/430 [00:05<00:00, 96.83it/s] 82%|████████▏ | 354/430 [00:05<00:00, 96.73it/s] 85%|████████▍ | 364/430 [00:05<00:00, 96.81it/s] 87%|████████▋ | 374/430 [00:05<00:00, 96.91it/s] 89%|████████▉ | 384/430 [00:05<00:00, 96.84it/s] 92%|█████████▏| 394/430 [00:05<00:00, 96.67it/s] 94%|█████████▍| 404/430 [00:05<00:00, 96.43it/s] 96%|█████████▋| 414/430 [00:06<00:00, 97.00it/s] 99%|█████████▊| 424/430 [00:06<00:00, 97.05it/s]100%|██████████| 430/430 [00:06<00:00, 68.60it/s]
55000 images processed, 6.3266685009002686 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:39,  2.13it/s] 12%|█▏        | 10/86 [00:00<00:03, 22.39it/s] 23%|██▎       | 20/86 [00:00<00:01, 40.84it/s] 35%|███▍      | 30/86 [00:00<00:01, 55.38it/s] 47%|████▋     | 40/86 [00:00<00:00, 66.43it/s] 58%|█████▊    | 50/86 [00:00<00:00, 74.37it/s] 70%|██████▉   | 60/86 [00:01<00:00, 80.54it/s] 81%|████████▏ | 70/86 [00:01<00:00, 85.28it/s] 93%|█████████▎| 80/86 [00:01<00:00, 88.83it/s]100%|██████████| 86/86 [00:01<00:00, 62.62it/s]
11000 images processed, 1.3880455493927002 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:42,  1.98it/s]  5%|▍         | 10/204 [00:00<00:09, 21.40it/s] 10%|▉         | 20/204 [00:00<00:04, 39.26it/s] 14%|█▍        | 29/204 [00:00<00:03, 51.71it/s] 19%|█▊        | 38/204 [00:00<00:02, 61.65it/s] 24%|██▎       | 48/204 [00:01<00:02, 70.62it/s] 28%|██▊       | 58/204 [00:01<00:01, 77.31it/s] 33%|███▎      | 67/204 [00:01<00:01, 79.70it/s] 38%|███▊      | 77/204 [00:01<00:01, 84.06it/s] 43%|████▎     | 87/204 [00:01<00:01, 87.02it/s] 48%|████▊     | 97/204 [00:01<00:01, 88.96it/s] 52%|█████▏    | 107/204 [00:01<00:01, 90.51it/s] 57%|█████▋    | 117/204 [00:01<00:00, 91.48it/s] 62%|██████▏   | 127/204 [00:01<00:00, 92.55it/s] 67%|██████▋   | 137/204 [00:01<00:00, 93.32it/s] 72%|███████▏  | 147/204 [00:02<00:00, 93.70it/s] 77%|███████▋  | 157/204 [00:02<00:00, 94.10it/s] 82%|████████▏ | 167/204 [00:02<00:00, 94.26it/s] 87%|████████▋ | 177/204 [00:02<00:00, 94.60it/s] 92%|█████████▏| 187/204 [00:02<00:00, 95.26it/s] 97%|█████████▋| 197/204 [00:02<00:00, 95.66it/s]100%|██████████| 204/204 [00:02<00:00, 76.02it/s]
26032 images processed, 2.7222373485565186 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:50,  1.54it/s] 10%|█         | 8/79 [00:00<00:06, 10.36it/s] 23%|██▎       | 18/79 [00:01<00:02, 24.46it/s] 30%|███       | 24/79 [00:01<00:02, 24.22it/s] 43%|████▎     | 34/79 [00:01<00:01, 36.61it/s] 51%|█████     | 40/79 [00:01<00:01, 31.40it/s] 63%|██████▎   | 50/79 [00:01<00:00, 42.73it/s] 76%|███████▌  | 60/79 [00:01<00:00, 53.53it/s] 89%|████████▊ | 70/79 [00:01<00:00, 63.27it/s]100%|██████████| 79/79 [00:02<00:00, 37.93it/s]
10000 images processed, 2.1037497520446777 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.95it/s] 14%|█▍        | 11/79 [00:00<00:02, 22.97it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.62it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.73it/s] 52%|█████▏    | 41/79 [00:00<00:00, 65.66it/s] 65%|██████▍   | 51/79 [00:01<00:00, 74.01it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.46it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.16it/s]100%|██████████| 79/79 [00:01<00:00, 59.82it/s]
10000 images processed, 1.3405563831329346 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:30,  2.30it/s] 13%|█▎        | 9/70 [00:00<00:02, 21.18it/s] 27%|██▋       | 19/70 [00:00<00:01, 40.46it/s] 40%|████      | 28/70 [00:00<00:00, 53.47it/s] 54%|█████▍    | 38/70 [00:00<00:00, 64.73it/s] 69%|██████▊   | 48/70 [00:00<00:00, 73.29it/s] 83%|████████▎ | 58/70 [00:01<00:00, 80.01it/s] 97%|█████████▋| 68/70 [00:01<00:00, 84.86it/s]100%|██████████| 70/70 [00:01<00:00, 58.40it/s]
8925 images processed, 1.2314376831054688 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.10it/s]  4%|▍         | 2/45 [00:01<00:19,  2.16it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.09it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.44it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.51it/s] 56%|█████▌    | 25/45 [00:01<00:01, 19.03it/s] 73%|███████▎  | 33/45 [00:01<00:00, 25.90it/s] 82%|████████▏ | 37/45 [00:02<00:00, 26.07it/s] 91%|█████████ | 41/45 [00:02<00:00, 24.11it/s]100%|██████████| 45/45 [00:02<00:00, 19.02it/s]
5640 images processed, 2.3927342891693115 seconds used

19.096898317337036
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.61  99.69  95.75
places365     48.47  91.30  73.38
LSUN           4.27  98.88  94.46
iSUN          39.31  93.21  81.97
dtd           22.57  96.17  91.32
AVG           23.25  95.85  87.37
[incremental] Overall: 0.8467 New: 0.8400 Old: 0.8500
3.453599452972412
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc3-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<02:49,  2.52it/s]  1%|          | 5/430 [00:00<00:47,  8.98it/s]  2%|▏         | 7/430 [00:01<01:34,  4.49it/s]  4%|▍         | 17/430 [00:01<00:28, 14.65it/s]  6%|▌         | 26/430 [00:01<00:16, 24.62it/s]  8%|▊         | 36/430 [00:01<00:10, 35.95it/s] 10%|█         | 45/430 [00:01<00:08, 45.76it/s] 12%|█▏        | 53/430 [00:01<00:07, 52.47it/s] 14%|█▍        | 62/430 [00:02<00:06, 60.19it/s] 17%|█▋        | 72/430 [00:02<00:05, 68.65it/s] 19%|█▉        | 82/430 [00:02<00:04, 74.69it/s] 21%|██▏       | 92/430 [00:02<00:04, 79.85it/s] 24%|██▎       | 102/430 [00:02<00:03, 84.39it/s] 26%|██▌       | 112/430 [00:02<00:03, 83.36it/s] 28%|██▊       | 122/430 [00:02<00:03, 86.34it/s] 31%|███       | 132/430 [00:02<00:03, 89.15it/s] 33%|███▎      | 142/430 [00:02<00:03, 91.21it/s] 35%|███▌      | 152/430 [00:03<00:02, 92.72it/s] 38%|███▊      | 162/430 [00:03<00:02, 93.80it/s] 40%|████      | 172/430 [00:03<00:02, 94.65it/s] 42%|████▏     | 182/430 [00:03<00:02, 95.17it/s] 45%|████▍     | 192/430 [00:03<00:02, 95.70it/s] 47%|████▋     | 202/430 [00:03<00:02, 96.04it/s] 49%|████▉     | 212/430 [00:03<00:02, 96.21it/s] 52%|█████▏    | 222/430 [00:03<00:02, 95.80it/s] 54%|█████▍    | 232/430 [00:03<00:02, 96.13it/s] 56%|█████▋    | 242/430 [00:03<00:01, 96.26it/s] 59%|█████▊    | 252/430 [00:04<00:01, 96.27it/s] 61%|██████    | 262/430 [00:04<00:01, 96.20it/s] 63%|██████▎   | 272/430 [00:04<00:01, 96.34it/s] 66%|██████▌   | 282/430 [00:04<00:01, 96.35it/s] 68%|██████▊   | 292/430 [00:04<00:01, 96.56it/s] 70%|███████   | 302/430 [00:04<00:01, 96.55it/s] 73%|███████▎  | 312/430 [00:04<00:01, 96.68it/s] 75%|███████▍  | 322/430 [00:04<00:01, 96.65it/s] 77%|███████▋  | 332/430 [00:04<00:01, 96.75it/s] 80%|███████▉  | 342/430 [00:05<00:00, 96.64it/s] 82%|████████▏ | 352/430 [00:05<00:00, 94.91it/s] 84%|████████▍ | 362/430 [00:05<00:00, 95.33it/s] 87%|████████▋ | 372/430 [00:05<00:00, 95.75it/s] 89%|████████▉ | 382/430 [00:05<00:00, 95.69it/s] 91%|█████████ | 392/430 [00:05<00:00, 95.78it/s] 93%|█████████▎| 402/430 [00:05<00:00, 95.42it/s] 96%|█████████▌| 412/430 [00:05<00:00, 96.21it/s] 98%|█████████▊| 422/430 [00:05<00:00, 96.74it/s]100%|██████████| 430/430 [00:05<00:00, 72.25it/s]
55000 images processed, 6.076604843139648 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:42,  1.98it/s] 12%|█▏        | 10/86 [00:00<00:03, 21.12it/s] 22%|██▏       | 19/86 [00:00<00:01, 37.29it/s] 34%|███▎      | 29/86 [00:00<00:01, 51.77it/s] 44%|████▍     | 38/86 [00:00<00:00, 61.30it/s] 56%|█████▌    | 48/86 [00:01<00:00, 70.14it/s] 67%|██████▋   | 58/86 [00:01<00:00, 76.26it/s] 79%|███████▉  | 68/86 [00:01<00:00, 81.47it/s] 91%|█████████ | 78/86 [00:01<00:00, 85.23it/s]100%|██████████| 86/86 [00:01<00:00, 59.52it/s]
11000 images processed, 1.469473123550415 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc3-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:47,  1.88it/s]  4%|▍         | 8/204 [00:00<00:12, 16.19it/s]  9%|▉         | 18/204 [00:00<00:05, 34.96it/s] 14%|█▎        | 28/204 [00:00<00:03, 49.66it/s] 19%|█▊        | 38/204 [00:00<00:02, 61.75it/s] 24%|██▎       | 48/204 [00:01<00:02, 70.96it/s] 28%|██▊       | 58/204 [00:01<00:01, 77.43it/s] 33%|███▎      | 68/204 [00:01<00:01, 82.54it/s] 38%|███▊      | 78/204 [00:01<00:01, 86.33it/s] 43%|████▎     | 88/204 [00:01<00:01, 88.88it/s] 48%|████▊     | 98/204 [00:01<00:01, 87.84it/s] 53%|█████▎    | 108/204 [00:01<00:01, 87.89it/s] 58%|█████▊    | 118/204 [00:01<00:00, 88.89it/s] 63%|██████▎   | 128/204 [00:01<00:00, 90.77it/s] 68%|██████▊   | 138/204 [00:02<00:00, 92.11it/s] 73%|███████▎  | 148/204 [00:02<00:00, 92.98it/s] 77%|███████▋  | 158/204 [00:02<00:00, 93.89it/s] 82%|████████▏ | 168/204 [00:02<00:00, 94.47it/s] 87%|████████▋ | 178/204 [00:02<00:00, 94.36it/s] 92%|█████████▏| 188/204 [00:02<00:00, 95.18it/s] 97%|█████████▋| 198/204 [00:02<00:00, 95.62it/s]100%|██████████| 204/204 [00:02<00:00, 74.86it/s]
26032 images processed, 2.766308069229126 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.72it/s] 10%|█         | 8/79 [00:00<00:04, 15.19it/s] 23%|██▎       | 18/79 [00:00<00:01, 33.15it/s] 35%|███▌      | 28/79 [00:00<00:01, 48.02it/s] 48%|████▊     | 38/79 [00:01<00:00, 59.97it/s] 61%|██████    | 48/79 [00:01<00:00, 68.91it/s] 73%|███████▎  | 58/79 [00:01<00:00, 76.28it/s] 86%|████████▌ | 68/79 [00:01<00:00, 82.02it/s] 99%|█████████▊| 78/79 [00:01<00:00, 86.31it/s]100%|██████████| 79/79 [00:01<00:00, 54.85it/s]
10000 images processed, 1.4744155406951904 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:34,  2.24it/s]  6%|▋         | 5/79 [00:00<00:06, 11.38it/s] 19%|█▉        | 15/79 [00:00<00:01, 33.36it/s] 32%|███▏      | 25/79 [00:00<00:01, 49.94it/s] 44%|████▍     | 35/79 [00:00<00:00, 62.15it/s] 57%|█████▋    | 45/79 [00:00<00:00, 71.22it/s] 70%|██████▉   | 55/79 [00:01<00:00, 77.94it/s] 82%|████████▏ | 65/79 [00:01<00:00, 83.39it/s] 95%|█████████▍| 75/79 [00:01<00:00, 87.45it/s]100%|██████████| 79/79 [00:01<00:00, 59.65it/s]
10000 images processed, 1.34633207321167 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.94it/s] 11%|█▏        | 8/70 [00:00<00:03, 16.53it/s] 26%|██▌       | 18/70 [00:00<00:01, 35.68it/s] 40%|████      | 28/70 [00:00<00:00, 50.78it/s] 54%|█████▍    | 38/70 [00:00<00:00, 62.49it/s] 69%|██████▊   | 48/70 [00:01<00:00, 71.67it/s] 83%|████████▎ | 58/70 [00:01<00:00, 78.81it/s] 97%|█████████▋| 68/70 [00:01<00:00, 84.04it/s]100%|██████████| 70/70 [00:01<00:00, 54.89it/s]
8925 images processed, 1.3055860996246338 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.07it/s] 11%|█         | 5/45 [00:01<00:06,  6.19it/s] 33%|███▎      | 15/45 [00:01<00:01, 20.83it/s] 47%|████▋     | 21/45 [00:01<00:01, 20.59it/s] 58%|█████▊    | 26/45 [00:01<00:00, 22.15it/s] 73%|███████▎  | 33/45 [00:01<00:00, 21.20it/s] 96%|█████████▌| 43/45 [00:02<00:00, 32.23it/s]100%|██████████| 45/45 [00:02<00:00, 21.24it/s]
5640 images processed, 2.1461234092712402 seconds used

18.275038719177246
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.65  99.38  98.33
places365     71.95  78.87  79.58
LSUN           8.40  97.98  98.09
iSUN          67.48  83.60  87.02
dtd           41.17  90.28  94.38
AVG           38.33  90.02  91.48
Retain-Acc: 0.7370
Forget-as-OOD (retain known vs forget novel):
  FPR: 69.40 AUROC: 85.57 AUIN: 99.21
8.300446033477783
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc3-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-inc3-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:30,  2.04it/s]  2%|▏         | 10/430 [00:00<00:19, 21.74it/s]  5%|▍         | 20/430 [00:00<00:10, 39.85it/s]  7%|▋         | 30/430 [00:00<00:07, 54.08it/s]  9%|▉         | 40/430 [00:00<00:06, 64.58it/s] 12%|█▏        | 50/430 [00:01<00:05, 72.63it/s] 14%|█▎        | 59/430 [00:01<00:04, 74.93it/s] 16%|█▌        | 68/430 [00:01<00:04, 73.85it/s] 18%|█▊        | 77/430 [00:01<00:04, 72.69it/s] 20%|██        | 86/430 [00:01<00:04, 77.14it/s] 22%|██▏       | 96/430 [00:01<00:04, 81.56it/s] 25%|██▍       | 106/430 [00:01<00:03, 84.93it/s] 27%|██▋       | 116/430 [00:01<00:03, 87.52it/s] 29%|██▉       | 126/430 [00:01<00:03, 90.18it/s] 32%|███▏      | 136/430 [00:02<00:03, 92.13it/s] 34%|███▍      | 146/430 [00:02<00:03, 93.58it/s] 36%|███▋      | 156/430 [00:02<00:02, 94.62it/s] 39%|███▊      | 166/430 [00:02<00:02, 95.41it/s] 41%|████      | 176/430 [00:02<00:02, 95.90it/s] 43%|████▎     | 186/430 [00:02<00:02, 95.71it/s] 46%|████▌     | 196/430 [00:02<00:02, 95.13it/s] 48%|████▊     | 206/430 [00:02<00:02, 95.37it/s] 50%|█████     | 216/430 [00:02<00:02, 95.72it/s] 53%|█████▎    | 226/430 [00:02<00:02, 95.85it/s] 55%|█████▍    | 236/430 [00:03<00:02, 96.14it/s] 57%|█████▋    | 246/430 [00:03<00:01, 95.42it/s] 60%|█████▉    | 256/430 [00:03<00:01, 95.72it/s] 62%|██████▏   | 266/430 [00:03<00:01, 95.93it/s] 64%|██████▍   | 276/430 [00:03<00:01, 96.00it/s] 67%|██████▋   | 286/430 [00:03<00:01, 95.28it/s] 69%|██████▉   | 296/430 [00:03<00:01, 95.57it/s] 71%|███████   | 306/430 [00:03<00:01, 95.55it/s] 73%|███████▎  | 316/430 [00:03<00:01, 95.45it/s] 76%|███████▌  | 326/430 [00:04<00:01, 95.75it/s] 78%|███████▊  | 336/430 [00:04<00:00, 95.83it/s] 80%|████████  | 346/430 [00:04<00:00, 95.89it/s] 83%|████████▎ | 356/430 [00:04<00:00, 94.99it/s] 85%|████████▌ | 366/430 [00:04<00:00, 94.19it/s] 87%|████████▋ | 376/430 [00:04<00:00, 94.89it/s] 90%|████████▉ | 386/430 [00:04<00:00, 95.32it/s] 92%|█████████▏| 396/430 [00:04<00:00, 95.75it/s] 94%|█████████▍| 406/430 [00:04<00:00, 94.35it/s] 97%|█████████▋| 416/430 [00:04<00:00, 95.43it/s] 99%|█████████▉| 426/430 [00:05<00:00, 96.15it/s]100%|██████████| 430/430 [00:05<00:00, 84.33it/s]
55000 images processed, 5.137076139450073 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:31,  2.67it/s] 13%|█▎        | 11/86 [00:00<00:02, 28.92it/s] 24%|██▍       | 21/86 [00:00<00:01, 48.16it/s] 36%|███▌      | 31/86 [00:00<00:00, 61.99it/s] 48%|████▊     | 41/86 [00:00<00:00, 71.96it/s] 59%|█████▉    | 51/86 [00:00<00:00, 78.32it/s] 71%|███████   | 61/86 [00:01<00:00, 83.35it/s] 83%|████████▎ | 71/86 [00:01<00:00, 87.46it/s] 94%|█████████▍| 81/86 [00:01<00:00, 90.13it/s]100%|██████████| 86/86 [00:01<00:00, 67.71it/s]
11000 images processed, 1.2850170135498047 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:30,  2.25it/s]  5%|▍         | 10/204 [00:00<00:08, 23.54it/s] 10%|▉         | 20/204 [00:00<00:04, 42.38it/s] 15%|█▍        | 30/204 [00:00<00:03, 56.75it/s] 20%|█▉        | 40/204 [00:00<00:02, 67.02it/s] 25%|██▍       | 50/204 [00:00<00:02, 74.77it/s] 29%|██▉       | 60/204 [00:01<00:01, 80.11it/s] 34%|███▍      | 70/204 [00:01<00:01, 84.17it/s] 39%|███▉      | 80/204 [00:01<00:01, 86.99it/s] 44%|████▍     | 90/204 [00:01<00:01, 87.73it/s] 49%|████▉     | 100/204 [00:01<00:01, 86.40it/s] 53%|█████▎    | 109/204 [00:01<00:01, 86.85it/s] 58%|█████▊    | 118/204 [00:01<00:00, 86.59it/s] 63%|██████▎   | 128/204 [00:01<00:00, 89.23it/s] 68%|██████▊   | 138/204 [00:01<00:00, 90.96it/s] 73%|███████▎  | 148/204 [00:02<00:00, 92.39it/s] 77%|███████▋  | 158/204 [00:02<00:00, 93.35it/s] 82%|████████▏ | 168/204 [00:02<00:00, 94.08it/s] 87%|████████▋ | 178/204 [00:02<00:00, 94.62it/s] 92%|█████████▏| 188/204 [00:02<00:00, 95.37it/s] 97%|█████████▋| 198/204 [00:02<00:00, 95.84it/s]100%|██████████| 204/204 [00:02<00:00, 77.52it/s]
26032 images processed, 2.6685564517974854 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.73it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.84it/s] 27%|██▋       | 21/79 [00:00<00:01, 37.32it/s] 39%|███▉      | 31/79 [00:00<00:00, 50.90it/s] 52%|█████▏    | 41/79 [00:01<00:00, 61.71it/s] 65%|██████▍   | 51/79 [00:01<00:00, 70.12it/s] 77%|███████▋  | 61/79 [00:01<00:00, 77.21it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.73it/s]100%|██████████| 79/79 [00:01<00:00, 40.43it/s]
10000 images processed, 1.9885952472686768 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:37,  2.08it/s] 13%|█▎        | 10/79 [00:00<00:03, 22.13it/s] 23%|██▎       | 18/79 [00:00<00:01, 35.90it/s] 34%|███▍      | 27/79 [00:00<00:01, 49.51it/s] 47%|████▋     | 37/79 [00:00<00:00, 61.51it/s] 59%|█████▉    | 47/79 [00:01<00:00, 71.00it/s] 72%|███████▏  | 57/79 [00:01<00:00, 78.25it/s] 85%|████████▍ | 67/79 [00:01<00:00, 83.69it/s] 97%|█████████▋| 77/79 [00:01<00:00, 87.60it/s]100%|██████████| 79/79 [00:01<00:00, 59.51it/s]
10000 images processed, 1.3473422527313232 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:32,  2.10it/s] 14%|█▍        | 10/70 [00:00<00:02, 22.19it/s] 29%|██▊       | 20/70 [00:00<00:01, 40.74it/s] 43%|████▎     | 30/70 [00:00<00:00, 55.11it/s] 57%|█████▋    | 40/70 [00:00<00:00, 65.93it/s] 71%|███████▏  | 50/70 [00:01<00:00, 74.43it/s] 86%|████████▌ | 60/70 [00:01<00:00, 80.86it/s]100%|██████████| 70/70 [00:01<00:00, 84.61it/s]100%|██████████| 70/70 [00:01<00:00, 57.71it/s]
8925 images processed, 1.243225336074829 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.10it/s] 11%|█         | 5/45 [00:01<00:06,  6.39it/s] 29%|██▉       | 13/45 [00:01<00:01, 18.13it/s] 40%|████      | 18/45 [00:01<00:01, 18.47it/s] 51%|█████     | 23/45 [00:01<00:01, 20.27it/s] 73%|███████▎  | 33/45 [00:01<00:00, 23.36it/s] 96%|█████████▌| 43/45 [00:02<00:00, 34.01it/s]100%|██████████| 45/45 [00:02<00:00, 21.66it/s]
5640 images processed, 2.09629225730896 seconds used

17.41261315345764
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.61  99.69  95.75
places365     48.47  91.30  73.38
LSUN           4.27  98.88  94.46
iSUN          39.31  93.21  81.97
dtd           22.57  96.17  91.32
AVG           23.25  95.85  87.37
[incremental] Overall: 0.8467 New: 0.8400 Old: 0.8500
[incremental] Final(Top-1): 0.8467  Average: 0.8846
2.2793660163879395
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-seen-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:10,  2.25it/s]  3%|▎         | 11/430 [00:00<00:16, 25.56it/s]  5%|▍         | 21/430 [00:00<00:09, 43.80it/s]  7%|▋         | 31/430 [00:00<00:06, 57.99it/s] 10%|▉         | 41/430 [00:00<00:05, 68.79it/s] 12%|█▏        | 51/430 [00:00<00:04, 76.74it/s] 14%|█▍        | 61/430 [00:01<00:04, 82.59it/s] 17%|█▋        | 71/430 [00:01<00:04, 86.69it/s] 19%|█▉        | 81/430 [00:01<00:03, 89.47it/s] 21%|██        | 91/430 [00:01<00:03, 91.49it/s] 23%|██▎       | 101/430 [00:01<00:03, 93.08it/s] 26%|██▌       | 111/430 [00:01<00:03, 93.86it/s] 28%|██▊       | 121/430 [00:01<00:03, 94.60it/s] 30%|███       | 131/430 [00:01<00:03, 95.15it/s] 33%|███▎      | 141/430 [00:01<00:03, 95.57it/s] 35%|███▌      | 151/430 [00:02<00:02, 95.86it/s] 37%|███▋      | 161/430 [00:02<00:02, 96.13it/s] 40%|███▉      | 171/430 [00:02<00:02, 96.33it/s] 42%|████▏     | 181/430 [00:02<00:02, 96.15it/s] 44%|████▍     | 191/430 [00:02<00:02, 96.24it/s] 47%|████▋     | 201/430 [00:02<00:02, 96.38it/s] 49%|████▉     | 211/430 [00:02<00:02, 96.51it/s] 51%|█████▏    | 221/430 [00:02<00:02, 96.40it/s] 54%|█████▎    | 231/430 [00:02<00:02, 96.45it/s] 56%|█████▌    | 241/430 [00:02<00:01, 96.45it/s] 58%|█████▊    | 251/430 [00:03<00:01, 96.49it/s] 61%|██████    | 261/430 [00:03<00:01, 96.22it/s] 63%|██████▎   | 271/430 [00:03<00:01, 96.20it/s] 65%|██████▌   | 281/430 [00:03<00:01, 96.24it/s] 68%|██████▊   | 291/430 [00:03<00:01, 96.30it/s] 70%|███████   | 301/430 [00:03<00:01, 96.15it/s] 72%|███████▏  | 311/430 [00:03<00:01, 96.32it/s] 75%|███████▍  | 321/430 [00:03<00:01, 96.41it/s] 77%|███████▋  | 331/430 [00:03<00:01, 96.32it/s] 79%|███████▉  | 341/430 [00:03<00:00, 96.40it/s] 82%|████████▏ | 351/430 [00:04<00:00, 96.43it/s] 84%|████████▍ | 361/430 [00:04<00:00, 96.44it/s] 86%|████████▋ | 371/430 [00:04<00:00, 96.52it/s] 89%|████████▊ | 381/430 [00:04<00:00, 96.20it/s] 91%|█████████ | 391/430 [00:04<00:00, 96.08it/s] 93%|█████████▎| 401/430 [00:04<00:00, 95.76it/s] 96%|█████████▌| 411/430 [00:04<00:00, 96.33it/s] 98%|█████████▊| 421/430 [00:04<00:00, 96.64it/s]100%|██████████| 430/430 [00:04<00:00, 87.61it/s]
55000 images processed, 4.993312835693359 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:38,  2.19it/s] 13%|█▎        | 11/86 [00:00<00:03, 24.86it/s] 24%|██▍       | 21/86 [00:00<00:01, 42.49it/s] 36%|███▌      | 31/86 [00:00<00:00, 55.80it/s] 48%|████▊     | 41/86 [00:00<00:00, 65.68it/s] 59%|█████▉    | 51/86 [00:01<00:00, 73.50it/s] 71%|███████   | 61/86 [00:01<00:00, 78.75it/s] 83%|████████▎ | 71/86 [00:01<00:00, 83.25it/s] 94%|█████████▍| 81/86 [00:01<00:00, 86.51it/s]100%|██████████| 86/86 [00:01<00:00, 62.13it/s]
11000 images processed, 1.406923770904541 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-seen-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:34,  2.16it/s]  5%|▌         | 11/204 [00:00<00:07, 24.67it/s] 10%|█         | 21/204 [00:00<00:04, 42.34it/s] 15%|█▌        | 31/204 [00:00<00:03, 56.29it/s] 20%|██        | 41/204 [00:00<00:02, 66.79it/s] 25%|██▌       | 51/204 [00:01<00:02, 74.35it/s] 30%|██▉       | 61/204 [00:01<00:01, 79.91it/s] 34%|███▍      | 70/204 [00:01<00:01, 81.80it/s] 39%|███▉      | 80/204 [00:01<00:01, 85.53it/s] 44%|████▍     | 90/204 [00:01<00:01, 87.89it/s] 49%|████▉     | 100/204 [00:01<00:01, 86.90it/s] 53%|█████▎    | 109/204 [00:01<00:01, 86.65it/s] 58%|█████▊    | 119/204 [00:01<00:00, 89.01it/s] 63%|██████▎   | 129/204 [00:01<00:00, 89.58it/s] 68%|██████▊   | 139/204 [00:01<00:00, 91.08it/s] 73%|███████▎  | 149/204 [00:02<00:00, 91.99it/s] 78%|███████▊  | 159/204 [00:02<00:00, 92.57it/s] 83%|████████▎ | 169/204 [00:02<00:00, 93.29it/s] 88%|████████▊ | 179/204 [00:02<00:00, 93.75it/s] 93%|█████████▎| 189/204 [00:02<00:00, 94.72it/s] 98%|█████████▊| 199/204 [00:02<00:00, 95.39it/s]100%|██████████| 204/204 [00:02<00:00, 76.88it/s]
26032 images processed, 2.6925084590911865 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.56it/s] 10%|█         | 8/79 [00:00<00:05, 13.89it/s] 23%|██▎       | 18/79 [00:00<00:01, 30.91it/s] 35%|███▌      | 28/79 [00:00<00:01, 45.27it/s] 47%|████▋     | 37/79 [00:01<00:00, 55.32it/s] 59%|█████▉    | 47/79 [00:01<00:00, 65.13it/s] 71%|███████   | 56/79 [00:01<00:00, 68.06it/s] 84%|████████▎ | 66/79 [00:01<00:00, 75.65it/s] 96%|█████████▌| 76/79 [00:01<00:00, 81.59it/s]100%|██████████| 79/79 [00:02<00:00, 29.96it/s]
10000 images processed, 2.6966474056243896 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.93it/s] 13%|█▎        | 10/79 [00:00<00:03, 20.96it/s] 25%|██▌       | 20/79 [00:00<00:01, 38.83it/s] 38%|███▊      | 30/79 [00:00<00:00, 53.42it/s] 51%|█████     | 40/79 [00:00<00:00, 64.37it/s] 62%|██████▏   | 49/79 [00:01<00:00, 71.22it/s] 75%|███████▍  | 59/79 [00:01<00:00, 78.52it/s] 87%|████████▋ | 69/79 [00:01<00:00, 83.88it/s]100%|██████████| 79/79 [00:01<00:00, 58.97it/s]
10000 images processed, 1.3586399555206299 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  2.00it/s] 14%|█▍        | 10/70 [00:00<00:02, 21.23it/s] 29%|██▊       | 20/70 [00:00<00:01, 39.40it/s] 43%|████▎     | 30/70 [00:00<00:00, 53.65it/s] 57%|█████▋    | 40/70 [00:00<00:00, 64.69it/s] 71%|███████▏  | 50/70 [00:01<00:00, 73.46it/s] 86%|████████▌ | 60/70 [00:01<00:00, 80.10it/s]100%|██████████| 70/70 [00:01<00:00, 84.15it/s]100%|██████████| 70/70 [00:01<00:00, 56.45it/s]
8925 images processed, 1.2711405754089355 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:38,  1.16it/s]  4%|▍         | 2/45 [00:00<00:18,  2.37it/s] 22%|██▏       | 10/45 [00:01<00:02, 15.15it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.79it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.68it/s] 56%|█████▌    | 25/45 [00:01<00:00, 23.22it/s] 73%|███████▎  | 33/45 [00:01<00:00, 24.18it/s] 91%|█████████ | 41/45 [00:02<00:00, 32.92it/s]100%|██████████| 45/45 [00:02<00:00, 21.60it/s]
5640 images processed, 2.1020431518554688 seconds used

18.240025281906128
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.68  99.37  98.14
places365     71.94  79.12  78.34
LSUN           7.24  98.29  98.27
iSUN          67.56  83.83  86.27
dtd           40.76  90.28  93.87
AVG           38.04  90.18  90.98
Retain-Acc: 0.7412
Forget-as-OOD (retain known vs forget novel):
  FPR: 53.40 AUROC: 88.38 AUIN: 97.90
8.134030103683472
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage3-seen-forget_rf.png
==== Stage 4: inc={105,106,107,108,109}; seen={0,8,11,40,51,66,67,88,94,57,100,101,102,103,104}; all(union)={0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4', adapter_load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage1,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage2,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3', forget_classes='0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='105,106,107,108,109', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,100,101,102,103,104', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:168: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:274: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [00:26<21:15, 26.04s/it]  4%|▍         | 2/50 [00:43<16:56, 21.17s/it]  6%|▌         | 3/50 [01:02<15:32, 19.83s/it]  8%|▊         | 4/50 [01:19<14:21, 18.74s/it] 10%|█         | 5/50 [01:36<13:44, 18.32s/it] 12%|█▏        | 6/50 [01:52<12:55, 17.62s/it][loss] ep 0 it 0 total=10.9471 mle=1.6917 pcon=5.2430 forget=1.3183 orth=2.6942 favg=0.0000 nr=107 nf=4 protos=540 fproto_sim=NA
[loss] ep 0 it 50 total=10.9325 mle=1.6652 pcon=5.2274 forget=1.3465 orth=2.6934 favg=0.0000 nr=104 nf=7 protos=540 fproto_sim=NA
[loss] ep 0 it 100 total=11.0524 mle=1.7676 pcon=5.2126 forget=1.3802 orth=2.6920 favg=0.0000 nr=98 nf=10 protos=540 fproto_sim=NA
[loss] ep 0 it 150 total=10.9503 mle=1.6807 pcon=5.1981 forget=1.3818 orth=2.6896 favg=0.0000 nr=102 nf=10 protos=540 fproto_sim=NA
[loss] ep 0 it 200 total=10.8640 mle=1.5468 pcon=5.1838 forget=1.4471 orth=2.6862 favg=0.0000 nr=107 nf=5 protos=540 fproto_sim=NA
[loss] ep 0 it 250 total=10.9475 mle=1.6340 pcon=5.1706 forget=1.4610 orth=2.6818 favg=0.0000 nr=100 nf=8 protos=540 fproto_sim=NA
[loss] ep 0 it 300 total=10.5779 mle=1.4289 pcon=5.1578 forget=1.3148 orth=2.6764 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 0 it 350 total=10.6770 mle=1.5803 pcon=5.1454 forget=1.2814 orth=2.6699 favg=0.0000 nr=101 nf=5 protos=540 fproto_sim=NA
[loss] ep 0 it 400 total=10.8678 mle=1.5707 pcon=5.1337 forget=1.5011 orth=2.6623 favg=0.0000 nr=101 nf=4 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 1 it 20 total=10.6582 mle=1.5920 pcon=5.1224 forget=1.2902 orth=2.6536 favg=0.0000 nr=110 nf=4 protos=540 fproto_sim=NA
[loss] ep 1 it 70 total=10.7410 mle=1.5698 pcon=5.1113 forget=1.4163 orth=2.6436 favg=0.0000 nr=94 nf=9 protos=540 fproto_sim=NA
[loss] ep 1 it 120 total=10.6226 mle=1.5231 pcon=5.1005 forget=1.3666 orth=2.6324 favg=0.0000 nr=107 nf=5 protos=540 fproto_sim=NA
[loss] ep 1 it 170 total=10.4878 mle=1.4836 pcon=5.0901 forget=1.2942 orth=2.6198 favg=0.0000 nr=101 nf=6 protos=540 fproto_sim=NA
[loss] ep 1 it 220 total=10.4961 mle=1.4902 pcon=5.0803 forget=1.3198 orth=2.6059 favg=0.0000 nr=110 nf=4 protos=540 fproto_sim=NA
[loss] ep 1 it 270 total=10.5883 mle=1.5621 pcon=5.0709 forget=1.3647 orth=2.5906 favg=0.0000 nr=105 nf=3 protos=540 fproto_sim=NA
[loss] ep 1 it 320 total=10.6168 mle=1.6849 pcon=5.0617 forget=1.2965 orth=2.5737 favg=0.0000 nr=104 nf=7 protos=540 fproto_sim=NA
[loss] ep 1 it 370 total=10.5940 mle=1.5812 pcon=5.0532 forget=1.4044 orth=2.5553 favg=0.0000 nr=104 nf=6 protos=540 fproto_sim=NA
[loss] ep 1 it 420 total=10.4436 mle=1.5303 pcon=5.0448 forget=1.3332 orth=2.5352 favg=0.0000 nr=103 nf=7 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 2 it 40 total=10.4880 mle=1.6040 pcon=5.0368 forget=1.3338 orth=2.5134 favg=0.0000 nr=108 nf=4 protos=540 fproto_sim=NA
[loss] ep 2 it 90 total=10.3269 mle=1.4724 pcon=5.0290 forget=1.3356 orth=2.4899 favg=0.0000 nr=97 nf=9 protos=540 fproto_sim=NA
[loss] ep 2 it 140 total=10.3670 mle=1.5784 pcon=5.0216 forget=1.3025 orth=2.4645 favg=0.0000 nr=103 nf=14 protos=540 fproto_sim=NA
[loss] ep 2 it 190 total=10.1939 mle=1.4552 pcon=5.0145 forget=1.2870 orth=2.4372 favg=0.0000 nr=113 nf=5 protos=540 fproto_sim=NA
[loss] ep 2 it 240 total=10.2707 mle=1.4565 pcon=5.0075 forget=1.3985 orth=2.4081 favg=0.0000 nr=107 nf=3 protos=540 fproto_sim=NA
[loss] ep 2 it 290 total=10.1697 mle=1.5068 pcon=5.0008 forget=1.2850 orth=2.3770 favg=0.0000 nr=112 nf=5 protos=540 fproto_sim=NA
[loss] ep 2 it 340 total=10.2275 mle=1.5574 pcon=4.9942 forget=1.3319 orth=2.3440 favg=0.0000 nr=100 nf=6 protos=540 fproto_sim=NA
[loss] ep 2 it 390 total=10.2402 mle=1.6388 pcon=4.9883 forget=1.3042 orth=2.3090 favg=0.0000 nr=97 nf=4 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 3 it 10 total=10.1339 mle=1.4850 pcon=4.9822 forget=1.3946 orth=2.2721 favg=0.0000 nr=107 nf=4 protos=540 fproto_sim=NA
[loss] ep 3 it 60 total=10.0924 mle=1.5738 pcon=4.9762 forget=1.3091 orth=2.2332 favg=0.0000 nr=104 nf=2 protos=540 fproto_sim=NA
[loss] ep 3 it 110 total=10.1675 mle=1.6894 pcon=4.9708 forget=1.3149 orth=2.1924 favg=0.0000 nr=107 nf=6 protos=540 fproto_sim=NA
[loss] ep 3 it 160 total=10.0231 mle=1.5994 pcon=4.9650 forget=1.3090 orth=2.1498 favg=0.0000 nr=101 nf=6 protos=540 fproto_sim=NA
[loss] ep 3 it 210 total=10.1723 mle=1.7548 pcon=4.9597 forget=1.3527 orth=2.1052 favg=0.0000 nr=104 nf=3 protos=540 fproto_sim=NA
[loss] ep 3 it 260 total=9.9336 mle=1.6056 pcon=4.9546 forget=1.3147 orth=2.0588 favg=0.0000 nr=108 nf=3 protos=540 fproto_sim=NA
[loss] ep 3 it 310 total=9.8817 mle=1.5729 pcon=4.9495 forget=1.3488 orth=2.0105 favg=0.0000 nr=113 nf=5 protos=540 fproto_sim=NA
[loss] ep 3 it 360 total=9.8858 mle=1.5155 pcon=4.9447 forget=1.4652 orth=1.9604 favg=0.0000 nr=105 nf=3 protos=540 fproto_sim=NA
[loss] ep 3 it 410 total=9.6257 mle=1.4584 pcon=4.9399 forget=1.3186 orth=1.9087 favg=0.0000 nr=102 nf=9 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 4 it 30 total=9.6491 mle=1.5210 pcon=4.9354 forget=1.3372 orth=1.8554 favg=0.0000 nr=108 nf=3 protos=540 fproto_sim=NA
[loss] ep 4 it 80 total=9.6681 mle=1.6293 pcon=4.9310 forget=1.3071 orth=1.8008 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 4 it 130 total=9.4687 mle=1.5242 pcon=4.9268 forget=1.2728 orth=1.7449 favg=0.0000 nr=99 nf=8 protos=540 fproto_sim=NA
[loss] ep 4 it 180 total=9.5604 mle=1.6065 pcon=4.9228 forget=1.3429 orth=1.6882 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 4 it 230 total=9.5357 mle=1.6067 pcon=4.9188 forget=1.3793 orth=1.6308 favg=0.0000 nr=107 nf=6 protos=540 fproto_sim=NA
[loss] ep 4 it 280 total=9.4386 mle=1.5326 pcon=4.9147 forget=1.4181 orth=1.5731 favg=0.0000 nr=106 nf=2 protos=540 fproto_sim=NA
[loss] ep 4 it 330 total=9.3164 mle=1.6126 pcon=4.9110 forget=1.2774 orth=1.5154 favg=0.0000 nr=103 nf=5 protos=540 fproto_sim=NA
[loss] ep 4 it 380 total=9.1728 mle=1.5118 pcon=4.9073 forget=1.2957 orth=1.4579 favg=0.0000 nr=100 nf=4 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 5 it 0 total=9.1089 mle=1.4658 pcon=4.9038 forget=1.3381 orth=1.4011 favg=0.0000 nr=106 nf=3 protos=540 fproto_sim=NA
[loss] ep 5 it 50 total=9.2341 mle=1.7009 pcon=4.9005 forget=1.2874 orth=1.3453 favg=0.0000 nr=105 nf=3 protos=540 fproto_sim=NA
[loss] ep 5 it 100 total=9.0977 mle=1.6209 pcon=4.8974 forget=1.2885 orth=1.2908 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 5 it 150 total=8.9929 mle=1.5708 pcon=4.8940 forget=1.2902 orth=1.2378 favg=0.0000 nr=103 nf=5 protos=540 fproto_sim=NA
[loss] ep 5 it 200 total=8.8722 mle=1.4733 pcon=4.8909 forget=1.3212 orth=1.1868 favg=0.0000 nr=107 nf=8 protos=540 fproto_sim=NA
[loss] ep 5 it 250 total=8.9615 mle=1.6161 pcon=4.8877 forget=1.3197 orth=1.1379 favg=0.0000 nr=102 nf=7 protos=540 fproto_sim=NA
[loss] ep 5 it 300 total=8.9188 mle=1.6104 pcon=4.8846 forget=1.3325 orth=1.0913 favg=0.0000 nr=99 nf=5 protos=540 fproto_sim=NA
[loss] ep 5 it 350 total=8.7659 mle=1.5389 pcon=4.8817 forget=1.2981 orth=1.0471 favg=0.0000 nr=115 nf=3 protos=540 fproto_sim=NA
[loss] ep 5 it 400 total=8.7587 mle=1.5421 pcon=4.8790 forget=1.3321 orth=1.0055 favg=0.0000 nr=101 nf=6 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
 14%|█▍        | 7/50 [02:09<12:24, 17.31s/it] 16%|█▌        | 8/50 [02:28<12:22, 17.68s/it] 18%|█▊        | 9/50 [02:45<12:06, 17.72s/it] 20%|██        | 10/50 [03:02<11:31, 17.28s/it] 22%|██▏       | 11/50 [03:17<10:46, 16.58s/it] 24%|██▍       | 12/50 [03:35<10:53, 17.20s/it][loss] ep 6 it 20 total=8.7883 mle=1.6636 pcon=4.8763 forget=1.2820 orth=0.9663 favg=0.0000 nr=109 nf=4 protos=540 fproto_sim=NA
[loss] ep 6 it 70 total=8.5953 mle=1.4932 pcon=4.8737 forget=1.2987 orth=0.9297 favg=0.0000 nr=104 nf=5 protos=540 fproto_sim=NA
[loss] ep 6 it 120 total=8.7197 mle=1.6351 pcon=4.8711 forget=1.3181 orth=0.8954 favg=0.0000 nr=107 nf=6 protos=540 fproto_sim=NA
[loss] ep 6 it 170 total=8.5089 mle=1.4878 pcon=4.8688 forget=1.2890 orth=0.8633 favg=0.0000 nr=107 nf=4 protos=540 fproto_sim=NA
[loss] ep 6 it 220 total=8.5753 mle=1.5930 pcon=4.8664 forget=1.2826 orth=0.8333 favg=0.0000 nr=100 nf=11 protos=540 fproto_sim=NA
[loss] ep 6 it 270 total=8.6599 mle=1.5993 pcon=4.8642 forget=1.3912 orth=0.8053 favg=0.0000 nr=98 nf=3 protos=540 fproto_sim=NA
[loss] ep 6 it 320 total=8.5566 mle=1.5979 pcon=4.8618 forget=1.3180 orth=0.7789 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[loss] ep 6 it 370 total=8.5142 mle=1.6387 pcon=4.8596 forget=1.2619 orth=0.7541 favg=0.0000 nr=109 nf=3 protos=540 fproto_sim=NA
[loss] ep 6 it 420 total=8.4300 mle=1.5492 pcon=4.8576 forget=1.2926 orth=0.7306 favg=0.0000 nr=104 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 7 it 40 total=8.4191 mle=1.5551 pcon=4.8557 forget=1.2999 orth=0.7085 favg=0.0000 nr=104 nf=6 protos=540 fproto_sim=NA
[loss] ep 7 it 90 total=8.4112 mle=1.5671 pcon=4.8537 forget=1.3031 orth=0.6873 favg=0.0000 nr=106 nf=3 protos=540 fproto_sim=NA
[loss] ep 7 it 140 total=8.4220 mle=1.6049 pcon=4.8517 forget=1.2982 orth=0.6672 favg=0.0000 nr=108 nf=5 protos=540 fproto_sim=NA
[loss] ep 7 it 190 total=8.3518 mle=1.5910 pcon=4.8499 forget=1.2630 orth=0.6479 favg=0.0000 nr=107 nf=3 protos=540 fproto_sim=NA
[loss] ep 7 it 240 total=8.3024 mle=1.5377 pcon=4.8482 forget=1.2870 orth=0.6295 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 7 it 290 total=8.3074 mle=1.5525 pcon=4.8464 forget=1.2967 orth=0.6117 favg=0.0000 nr=108 nf=6 protos=540 fproto_sim=NA
[loss] ep 7 it 340 total=8.4087 mle=1.6200 pcon=4.8445 forget=1.3495 orth=0.5947 favg=0.0000 nr=104 nf=6 protos=540 fproto_sim=NA
[loss] ep 7 it 390 total=8.2672 mle=1.5506 pcon=4.8429 forget=1.2952 orth=0.5785 favg=0.0000 nr=103 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 8 it 10 total=8.3479 mle=1.6453 pcon=4.8414 forget=1.2985 orth=0.5627 favg=0.0000 nr=108 nf=7 protos=540 fproto_sim=NA
[loss] ep 8 it 60 total=8.3089 mle=1.6129 pcon=4.8398 forget=1.3089 orth=0.5473 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 8 it 110 total=8.2826 mle=1.6312 pcon=4.8383 forget=1.2805 orth=0.5326 favg=0.0000 nr=99 nf=4 protos=540 fproto_sim=NA
[loss] ep 8 it 160 total=8.3519 mle=1.6691 pcon=4.8368 forget=1.3277 orth=0.5183 favg=0.0000 nr=110 nf=5 protos=540 fproto_sim=NA
[loss] ep 8 it 210 total=8.2053 mle=1.5882 pcon=4.8354 forget=1.2773 orth=0.5045 favg=0.0000 nr=102 nf=4 protos=540 fproto_sim=NA
[loss] ep 8 it 260 total=8.1478 mle=1.5482 pcon=4.8339 forget=1.2745 orth=0.4911 favg=0.0000 nr=101 nf=4 protos=540 fproto_sim=NA
[loss] ep 8 it 310 total=8.1846 mle=1.5860 pcon=4.8325 forget=1.2879 orth=0.4782 favg=0.0000 nr=99 nf=11 protos=540 fproto_sim=NA
[loss] ep 8 it 360 total=8.1796 mle=1.5410 pcon=4.8313 forget=1.3415 orth=0.4657 favg=0.0000 nr=100 nf=7 protos=540 fproto_sim=NA
[loss] ep 8 it 410 total=8.1485 mle=1.5556 pcon=4.8301 forget=1.3092 orth=0.4537 favg=0.0000 nr=108 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 9 it 30 total=8.1105 mle=1.5541 pcon=4.8289 forget=1.2853 orth=0.4421 favg=0.0000 nr=99 nf=6 protos=540 fproto_sim=NA
[loss] ep 9 it 80 total=8.1689 mle=1.6038 pcon=4.8279 forget=1.3063 orth=0.4310 favg=0.0000 nr=112 nf=5 protos=540 fproto_sim=NA
[loss] ep 9 it 130 total=8.2143 mle=1.6894 pcon=4.8267 forget=1.2780 orth=0.4202 favg=0.0000 nr=103 nf=6 protos=540 fproto_sim=NA
[loss] ep 9 it 180 total=8.2086 mle=1.5939 pcon=4.8258 forget=1.3791 orth=0.4098 favg=0.0000 nr=111 nf=6 protos=540 fproto_sim=NA
[loss] ep 9 it 230 total=8.1115 mle=1.6077 pcon=4.8247 forget=1.2793 orth=0.3998 favg=0.0000 nr=101 nf=6 protos=540 fproto_sim=NA
[loss] ep 9 it 280 total=8.0231 mle=1.4936 pcon=4.8238 forget=1.3156 orth=0.3902 favg=0.0000 nr=102 nf=9 protos=540 fproto_sim=NA
[loss] ep 9 it 330 total=8.1552 mle=1.6454 pcon=4.8228 forget=1.3060 orth=0.3810 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 9 it 380 total=8.3260 mle=1.6646 pcon=4.8219 forget=1.4674 orth=0.3722 favg=0.0000 nr=104 nf=3 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 10 it 0 total=8.0933 mle=1.6340 pcon=4.8209 forget=1.2746 orth=0.3638 favg=0.0000 nr=114 nf=4 protos=540 fproto_sim=NA
[loss] ep 10 it 50 total=7.9373 mle=1.4861 pcon=4.8201 forget=1.2754 orth=0.3558 favg=0.0000 nr=101 nf=5 protos=540 fproto_sim=NA
[loss] ep 10 it 100 total=8.1200 mle=1.6707 pcon=4.8192 forget=1.2819 orth=0.3482 favg=0.0000 nr=97 nf=12 protos=540 fproto_sim=NA
[loss] ep 10 it 150 total=8.2162 mle=1.7018 pcon=4.8183 forget=1.3551 orth=0.3410 favg=0.0000 nr=110 nf=4 protos=540 fproto_sim=NA
[loss] ep 10 it 200 total=8.1963 mle=1.7138 pcon=4.8175 forget=1.3308 orth=0.3341 favg=0.0000 nr=105 nf=4 protos=540 fproto_sim=NA
[loss] ep 10 it 250 total=8.0773 mle=1.6082 pcon=4.8168 forget=1.3247 orth=0.3276 favg=0.0000 nr=103 nf=6 protos=540 fproto_sim=NA
[loss] ep 10 it 300 total=8.1164 mle=1.7148 pcon=4.8157 forget=1.2645 orth=0.3215 favg=0.0000 nr=108 nf=3 protos=540 fproto_sim=NA
[loss] ep 10 it 350 total=8.0919 mle=1.7060 pcon=4.8149 forget=1.2554 orth=0.3156 favg=0.0000 nr=107 nf=4 protos=540 fproto_sim=NA
[loss] ep 10 it 400 total=8.0571 mle=1.6422 pcon=4.8143 forget=1.2905 orth=0.3100 favg=0.0000 nr=116 nf=1 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 11 it 20 total=8.0103 mle=1.6242 pcon=4.8137 forget=1.2677 orth=0.3047 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 11 it 70 total=8.0086 mle=1.5788 pcon=4.8129 forget=1.3173 orth=0.2996 favg=0.0000 nr=106 nf=9 protos=540 fproto_sim=NA
[loss] ep 11 it 120 total=8.0048 mle=1.6410 pcon=4.8124 forget=1.2566 orth=0.2948 favg=0.0000 nr=102 nf=7 protos=540 fproto_sim=NA
[loss] ep 11 it 170 total=8.0305 mle=1.6690 pcon=4.8118 forget=1.2596 orth=0.2902 favg=0.0000 nr=99 nf=4 protos=540 fproto_sim=NA
[loss] ep 11 it 220 total=8.0061 mle=1.6384 pcon=4.8112 forget=1.2707 orth=0.2857 favg=0.0000 nr=99 nf=4 protos=540 fproto_sim=NA
[loss] ep 11 it 270 total=7.9564 mle=1.5827 pcon=4.8107 forget=1.2815 orth=0.2815 favg=0.0000 nr=109 nf=3 protos=540 fproto_sim=NA
[loss] ep 11 it 320 total=7.9178 mle=1.5424 pcon=4.8101 forget=1.2879 orth=0.2774 favg=0.0000 nr=104 nf=8 protos=540 fproto_sim=NA
[loss] ep 11 it 370 total=7.9548 mle=1.5796 pcon=4.8096 forget=1.2921 orth=0.2735 favg=0.0000 nr=106 nf=8 protos=540 fproto_sim=NA
[loss] ep 11 it 420 total=7.9786 mle=1.5747 pcon=4.8093 forget=1.3249 orth=0.2697 favg=0.0000 nr=106 nf=3 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
 26%|██▌       | 13/50 [03:53<10:41, 17.33s/it] 28%|██▊       | 14/50 [04:12<10:40, 17.78s/it] 30%|███       | 15/50 [04:30<10:24, 17.85s/it] 32%|███▏      | 16/50 [04:48<10:07, 17.87s/it] 34%|███▍      | 17/50 [05:06<09:52, 17.96s/it] 36%|███▌      | 18/50 [05:24<09:36, 18.01s/it][loss] ep 12 it 40 total=7.9800 mle=1.6368 pcon=4.8089 forget=1.2682 orth=0.2660 favg=0.0000 nr=98 nf=10 protos=540 fproto_sim=NA
[loss] ep 12 it 90 total=7.9492 mle=1.5789 pcon=4.8083 forget=1.2995 orth=0.2626 favg=0.0000 nr=109 nf=3 protos=540 fproto_sim=NA
[loss] ep 12 it 140 total=7.9313 mle=1.5728 pcon=4.8079 forget=1.2914 orth=0.2592 favg=0.0000 nr=103 nf=4 protos=540 fproto_sim=NA
[loss] ep 12 it 190 total=7.9591 mle=1.6280 pcon=4.8074 forget=1.2679 orth=0.2559 favg=0.0000 nr=109 nf=6 protos=540 fproto_sim=NA
[loss] ep 12 it 240 total=7.9027 mle=1.5862 pcon=4.8069 forget=1.2568 orth=0.2528 favg=0.0000 nr=98 nf=6 protos=540 fproto_sim=NA
[loss] ep 12 it 290 total=7.9313 mle=1.6046 pcon=4.8067 forget=1.2703 orth=0.2497 favg=0.0000 nr=105 nf=6 protos=540 fproto_sim=NA
[loss] ep 12 it 340 total=7.9543 mle=1.6433 pcon=4.8066 forget=1.2576 orth=0.2468 favg=0.0000 nr=109 nf=9 protos=540 fproto_sim=NA
[loss] ep 12 it 390 total=7.9422 mle=1.5862 pcon=4.8063 forget=1.3058 orth=0.2439 favg=0.0000 nr=107 nf=7 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 13 it 10 total=7.9108 mle=1.6119 pcon=4.8060 forget=1.2518 orth=0.2411 favg=0.0000 nr=108 nf=3 protos=540 fproto_sim=NA
[loss] ep 13 it 60 total=7.9421 mle=1.6537 pcon=4.8056 forget=1.2444 orth=0.2384 favg=0.0000 nr=103 nf=6 protos=540 fproto_sim=NA
[loss] ep 13 it 110 total=8.0223 mle=1.6850 pcon=4.8052 forget=1.2964 orth=0.2357 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 13 it 160 total=7.9074 mle=1.6122 pcon=4.8050 forget=1.2571 orth=0.2332 favg=0.0000 nr=104 nf=10 protos=540 fproto_sim=NA
[loss] ep 13 it 210 total=7.8831 mle=1.5879 pcon=4.8048 forget=1.2598 orth=0.2306 favg=0.0000 nr=109 nf=4 protos=540 fproto_sim=NA
[loss] ep 13 it 260 total=7.8353 mle=1.5525 pcon=4.8045 forget=1.2502 orth=0.2282 favg=0.0000 nr=106 nf=7 protos=540 fproto_sim=NA
[loss] ep 13 it 310 total=7.9514 mle=1.6425 pcon=4.8043 forget=1.2788 orth=0.2258 favg=0.0000 nr=97 nf=6 protos=540 fproto_sim=NA
[loss] ep 13 it 360 total=7.8832 mle=1.6043 pcon=4.8040 forget=1.2515 orth=0.2234 favg=0.0000 nr=106 nf=8 protos=540 fproto_sim=NA
[loss] ep 13 it 410 total=7.9344 mle=1.6730 pcon=4.8037 forget=1.2366 orth=0.2211 favg=0.0000 nr=111 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 14 it 30 total=7.9769 mle=1.6375 pcon=4.8035 forget=1.3170 orth=0.2189 favg=0.0000 nr=104 nf=3 protos=540 fproto_sim=NA
[loss] ep 14 it 80 total=7.9186 mle=1.6597 pcon=4.8032 forget=1.2390 orth=0.2166 favg=0.0000 nr=101 nf=3 protos=540 fproto_sim=NA
[loss] ep 14 it 130 total=7.9514 mle=1.6419 pcon=4.8031 forget=1.2919 orth=0.2145 favg=0.0000 nr=110 nf=7 protos=540 fproto_sim=NA
[loss] ep 14 it 180 total=7.8036 mle=1.5514 pcon=4.8027 forget=1.2371 orth=0.2124 favg=0.0000 nr=99 nf=4 protos=540 fproto_sim=NA
[loss] ep 14 it 230 total=7.8550 mle=1.6075 pcon=4.8025 forget=1.2347 orth=0.2103 favg=0.0000 nr=108 nf=5 protos=540 fproto_sim=NA
[loss] ep 14 it 280 total=7.9497 mle=1.5973 pcon=4.8021 forget=1.3421 orth=0.2082 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 14 it 330 total=7.8274 mle=1.5881 pcon=4.8019 forget=1.2312 orth=0.2062 favg=0.0000 nr=110 nf=4 protos=540 fproto_sim=NA
[loss] ep 14 it 380 total=7.8464 mle=1.6161 pcon=4.8018 forget=1.2243 orth=0.2042 favg=0.0000 nr=105 nf=4 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 15 it 0 total=7.8651 mle=1.6170 pcon=4.8015 forget=1.2443 orth=0.2023 favg=0.0000 nr=103 nf=9 protos=540 fproto_sim=NA
[loss] ep 15 it 50 total=7.8221 mle=1.5980 pcon=4.8013 forget=1.2223 orth=0.2005 favg=0.0000 nr=93 nf=6 protos=540 fproto_sim=NA
[loss] ep 15 it 100 total=7.8766 mle=1.6090 pcon=4.8012 forget=1.2678 orth=0.1986 favg=0.0000 nr=104 nf=5 protos=540 fproto_sim=NA
[loss] ep 15 it 150 total=7.8334 mle=1.6013 pcon=4.8010 forget=1.2344 orth=0.1968 favg=0.0000 nr=106 nf=1 protos=540 fproto_sim=NA
[loss] ep 15 it 200 total=7.8779 mle=1.6762 pcon=4.8009 forget=1.2059 orth=0.1949 favg=0.0000 nr=107 nf=6 protos=540 fproto_sim=NA
[loss] ep 15 it 250 total=7.7765 mle=1.5484 pcon=4.8006 forget=1.2343 orth=0.1932 favg=0.0000 nr=103 nf=6 protos=540 fproto_sim=NA
[loss] ep 15 it 300 total=7.7901 mle=1.5927 pcon=4.8006 forget=1.2055 orth=0.1914 favg=0.0000 nr=106 nf=8 protos=540 fproto_sim=NA
[loss] ep 15 it 350 total=7.7535 mle=1.5241 pcon=4.8005 forget=1.2392 orth=0.1897 favg=0.0000 nr=97 nf=7 protos=540 fproto_sim=NA
[loss] ep 15 it 400 total=7.8836 mle=1.6513 pcon=4.8004 forget=1.2440 orth=0.1880 favg=0.0000 nr=100 nf=10 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 16 it 20 total=7.8867 mle=1.6957 pcon=4.8003 forget=1.2043 orth=0.1863 favg=0.0000 nr=108 nf=5 protos=540 fproto_sim=NA
[loss] ep 16 it 70 total=7.8437 mle=1.6294 pcon=4.8003 forget=1.2294 orth=0.1847 favg=0.0000 nr=112 nf=3 protos=540 fproto_sim=NA
[loss] ep 16 it 120 total=7.7712 mle=1.5962 pcon=4.8003 forget=1.1916 orth=0.1831 favg=0.0000 nr=111 nf=5 protos=540 fproto_sim=NA
[loss] ep 16 it 170 total=7.8991 mle=1.6911 pcon=4.8002 forget=1.2263 orth=0.1815 favg=0.0000 nr=110 nf=6 protos=540 fproto_sim=NA
[loss] ep 16 it 220 total=7.8561 mle=1.6685 pcon=4.7999 forget=1.2077 orth=0.1800 favg=0.0000 nr=95 nf=11 protos=540 fproto_sim=NA
[loss] ep 16 it 270 total=7.7805 mle=1.5619 pcon=4.7999 forget=1.2403 orth=0.1784 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 16 it 320 total=7.8792 mle=1.6352 pcon=4.7997 forget=1.2674 orth=0.1769 favg=0.0000 nr=102 nf=9 protos=540 fproto_sim=NA
[loss] ep 16 it 370 total=7.9141 mle=1.6917 pcon=4.7995 forget=1.2475 orth=0.1755 favg=0.0000 nr=109 nf=5 protos=540 fproto_sim=NA
[loss] ep 16 it 420 total=7.8071 mle=1.6193 pcon=4.7996 forget=1.2143 orth=0.1740 favg=0.0000 nr=106 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 17 it 40 total=7.8670 mle=1.7041 pcon=4.7996 forget=1.1907 orth=0.1726 favg=0.0000 nr=102 nf=9 protos=540 fproto_sim=NA
[loss] ep 17 it 90 total=7.8954 mle=1.6980 pcon=4.7997 forget=1.2265 orth=0.1712 favg=0.0000 nr=111 nf=4 protos=540 fproto_sim=NA
[loss] ep 17 it 140 total=7.7894 mle=1.6164 pcon=4.7995 forget=1.2038 orth=0.1698 favg=0.0000 nr=103 nf=9 protos=540 fproto_sim=NA
[loss] ep 17 it 190 total=7.8569 mle=1.6920 pcon=4.7993 forget=1.1972 orth=0.1684 favg=0.0000 nr=98 nf=7 protos=540 fproto_sim=NA
[loss] ep 17 it 240 total=7.7524 mle=1.5931 pcon=4.7991 forget=1.1931 orth=0.1672 favg=0.0000 nr=107 nf=7 protos=540 fproto_sim=NA
[loss] ep 17 it 290 total=7.8121 mle=1.6557 pcon=4.7991 forget=1.1915 orth=0.1659 favg=0.0000 nr=103 nf=3 protos=540 fproto_sim=NA
[loss] ep 17 it 340 total=7.7863 mle=1.6311 pcon=4.7989 forget=1.1917 orth=0.1646 favg=0.0000 nr=102 nf=5 protos=540 fproto_sim=NA
[loss] ep 17 it 390 total=7.7461 mle=1.5635 pcon=4.7989 forget=1.2204 orth=0.1633 favg=0.0000 nr=96 nf=9 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 18 it 10 total=7.7655 mle=1.5739 pcon=4.7989 forget=1.2307 orth=0.1621 favg=0.0000 nr=106 nf=3 protos=540 fproto_sim=NA
 38%|███▊      | 19/50 [05:44<09:36, 18.59s/it] 40%|████      | 20/50 [06:03<09:22, 18.75s/it] 42%|████▏     | 21/50 [06:23<09:13, 19.08s/it] 44%|████▍     | 22/50 [06:41<08:45, 18.76s/it] 46%|████▌     | 23/50 [07:00<08:30, 18.92s/it] 48%|████▊     | 24/50 [07:18<08:06, 18.70s/it] 50%|█████     | 25/50 [07:36<07:39, 18.38s/it][loss] ep 18 it 60 total=7.7450 mle=1.5835 pcon=4.7988 forget=1.2019 orth=0.1608 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 18 it 110 total=7.8094 mle=1.6183 pcon=4.7987 forget=1.2327 orth=0.1596 favg=0.0000 nr=109 nf=6 protos=540 fproto_sim=NA
[loss] ep 18 it 160 total=7.7688 mle=1.6209 pcon=4.7986 forget=1.1909 orth=0.1584 favg=0.0000 nr=110 nf=4 protos=540 fproto_sim=NA
[loss] ep 18 it 210 total=7.7444 mle=1.5793 pcon=4.7986 forget=1.2092 orth=0.1573 favg=0.0000 nr=109 nf=4 protos=540 fproto_sim=NA
[loss] ep 18 it 260 total=7.8936 mle=1.7266 pcon=4.7985 forget=1.2124 orth=0.1561 favg=0.0000 nr=103 nf=3 protos=540 fproto_sim=NA
[loss] ep 18 it 310 total=7.7492 mle=1.5953 pcon=4.7984 forget=1.2005 orth=0.1550 favg=0.0000 nr=107 nf=3 protos=540 fproto_sim=NA
[loss] ep 18 it 360 total=7.7617 mle=1.6112 pcon=4.7982 forget=1.1984 orth=0.1540 favg=0.0000 nr=108 nf=6 protos=540 fproto_sim=NA
[loss] ep 18 it 410 total=7.8215 mle=1.6733 pcon=4.7980 forget=1.1973 orth=0.1529 favg=0.0000 nr=97 nf=6 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 19 it 30 total=7.8316 mle=1.6604 pcon=4.7979 forget=1.2214 orth=0.1518 favg=0.0000 nr=102 nf=9 protos=540 fproto_sim=NA
[loss] ep 19 it 80 total=7.8770 mle=1.7162 pcon=4.7979 forget=1.2121 orth=0.1508 favg=0.0000 nr=106 nf=7 protos=540 fproto_sim=NA
[loss] ep 19 it 130 total=7.9022 mle=1.7412 pcon=4.7978 forget=1.2134 orth=0.1498 favg=0.0000 nr=101 nf=7 protos=540 fproto_sim=NA
[loss] ep 19 it 180 total=7.7469 mle=1.5971 pcon=4.7978 forget=1.2032 orth=0.1488 favg=0.0000 nr=110 nf=5 protos=540 fproto_sim=NA
[loss] ep 19 it 230 total=7.7362 mle=1.5831 pcon=4.7978 forget=1.2075 orth=0.1478 favg=0.0000 nr=108 nf=3 protos=540 fproto_sim=NA
[loss] ep 19 it 280 total=7.7351 mle=1.5845 pcon=4.7979 forget=1.2058 orth=0.1469 favg=0.0000 nr=105 nf=3 protos=540 fproto_sim=NA
[loss] ep 19 it 330 total=7.9068 mle=1.6937 pcon=4.7978 forget=1.2694 orth=0.1459 favg=0.0000 nr=99 nf=12 protos=540 fproto_sim=NA
[loss] ep 19 it 380 total=7.6901 mle=1.5291 pcon=4.7977 forget=1.2183 orth=0.1450 favg=0.0000 nr=101 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[loss] ep 20 it 0 total=7.6446 mle=1.4781 pcon=4.7977 forget=1.2247 orth=0.1441 favg=0.0000 nr=106 nf=2 protos=540 fproto_sim=NA
[loss] ep 20 it 50 total=7.8533 mle=1.6645 pcon=4.7977 forget=1.2479 orth=0.1431 favg=0.0000 nr=97 nf=7 protos=540 fproto_sim=NA
[loss] ep 20 it 100 total=7.7956 mle=1.6402 pcon=4.7976 forget=1.2155 orth=0.1423 favg=0.0000 nr=100 nf=3 protos=540 fproto_sim=NA
[loss] ep 20 it 150 total=7.8570 mle=1.6305 pcon=4.7976 forget=1.2876 orth=0.1414 favg=0.0000 nr=99 nf=4 protos=540 fproto_sim=NA
[loss] ep 20 it 200 total=7.8526 mle=1.6319 pcon=4.7976 forget=1.2826 orth=0.1405 favg=0.0000 nr=101 nf=8 protos=540 fproto_sim=NA
[loss] ep 20 it 250 total=7.8822 mle=1.7134 pcon=4.7975 forget=1.2316 orth=0.1397 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 20 it 300 total=7.7372 mle=1.5745 pcon=4.7975 forget=1.2264 orth=0.1389 favg=0.0000 nr=105 nf=4 protos=540 fproto_sim=NA
[loss] ep 20 it 350 total=7.9234 mle=1.6729 pcon=4.7974 forget=1.3150 orth=0.1380 favg=0.0000 nr=109 nf=4 protos=540 fproto_sim=NA
[loss] ep 20 it 400 total=7.8757 mle=1.7067 pcon=4.7974 forget=1.2344 orth=0.1372 favg=0.0000 nr=104 nf=7 protos=540 fproto_sim=NA
[loss] ep 21 it 20 total=7.8017 mle=1.6317 pcon=4.7973 forget=1.2363 orth=0.1364 favg=0.0000 nr=111 nf=6 protos=540 fproto_sim=NA
[loss] ep 21 it 70 total=7.8270 mle=1.6062 pcon=4.7973 forget=1.2878 orth=0.1357 favg=0.0000 nr=100 nf=2 protos=540 fproto_sim=NA
[loss] ep 21 it 120 total=7.8331 mle=1.6378 pcon=4.7974 forget=1.2631 orth=0.1349 favg=0.0000 nr=100 nf=8 protos=540 fproto_sim=NA
[loss] ep 21 it 170 total=7.8692 mle=1.6974 pcon=4.7975 forget=1.2401 orth=0.1341 favg=0.0000 nr=100 nf=6 protos=540 fproto_sim=NA
[loss] ep 21 it 220 total=7.8099 mle=1.6254 pcon=4.7975 forget=1.2536 orth=0.1334 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 21 it 270 total=7.8580 mle=1.6652 pcon=4.7977 forget=1.2624 orth=0.1327 favg=0.0000 nr=102 nf=9 protos=540 fproto_sim=NA
[loss] ep 21 it 320 total=7.8163 mle=1.5907 pcon=4.7978 forget=1.2959 orth=0.1319 favg=0.0000 nr=102 nf=5 protos=540 fproto_sim=NA
[loss] ep 21 it 370 total=7.8282 mle=1.6486 pcon=4.7977 forget=1.2506 orth=0.1312 favg=0.0000 nr=112 nf=6 protos=540 fproto_sim=NA
[loss] ep 21 it 420 total=7.7922 mle=1.6034 pcon=4.7977 forget=1.2605 orth=0.1306 favg=0.0000 nr=103 nf=4 protos=540 fproto_sim=NA
[loss] ep 22 it 40 total=7.7646 mle=1.5748 pcon=4.7977 forget=1.2622 orth=0.1299 favg=0.0000 nr=92 nf=12 protos=540 fproto_sim=NA
[loss] ep 22 it 90 total=7.9058 mle=1.7205 pcon=4.7977 forget=1.2584 orth=0.1292 favg=0.0000 nr=102 nf=3 protos=540 fproto_sim=NA
[loss] ep 22 it 140 total=7.7613 mle=1.5671 pcon=4.7977 forget=1.2680 orth=0.1285 favg=0.0000 nr=104 nf=6 protos=540 fproto_sim=NA
[loss] ep 22 it 190 total=7.7950 mle=1.5928 pcon=4.7979 forget=1.2765 orth=0.1279 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 22 it 240 total=7.7569 mle=1.5641 pcon=4.7978 forget=1.2678 orth=0.1272 favg=0.0000 nr=102 nf=10 protos=540 fproto_sim=NA
[loss] ep 22 it 290 total=7.8419 mle=1.5705 pcon=4.7978 forget=1.3470 orth=0.1266 favg=0.0000 nr=108 nf=5 protos=540 fproto_sim=NA
[loss] ep 22 it 340 total=7.8347 mle=1.6365 pcon=4.7980 forget=1.2742 orth=0.1260 favg=0.0000 nr=108 nf=4 protos=540 fproto_sim=NA
[loss] ep 22 it 390 total=7.8244 mle=1.6221 pcon=4.7981 forget=1.2788 orth=0.1254 favg=0.0000 nr=108 nf=7 protos=540 fproto_sim=NA
[loss] ep 23 it 10 total=7.8089 mle=1.5787 pcon=4.7980 forget=1.3074 orth=0.1247 favg=0.0000 nr=112 nf=4 protos=540 fproto_sim=NA
[loss] ep 23 it 60 total=7.7621 mle=1.5609 pcon=4.7980 forget=1.2791 orth=0.1241 favg=0.0000 nr=108 nf=4 protos=540 fproto_sim=NA
[loss] ep 23 it 110 total=7.8768 mle=1.6620 pcon=4.7980 forget=1.2933 orth=0.1236 favg=0.0000 nr=98 nf=8 protos=540 fproto_sim=NA
[loss] ep 23 it 160 total=7.7565 mle=1.5343 pcon=4.7980 forget=1.3013 orth=0.1230 favg=0.0000 nr=109 nf=8 protos=540 fproto_sim=NA
[loss] ep 23 it 210 total=8.0633 mle=1.6593 pcon=4.7982 forget=1.4834 orth=0.1224 favg=0.0000 nr=111 nf=3 protos=540 fproto_sim=NA
[loss] ep 23 it 260 total=7.8230 mle=1.6097 pcon=4.7984 forget=1.2930 orth=0.1219 favg=0.0000 nr=111 nf=4 protos=540 fproto_sim=NA
[loss] ep 23 it 310 total=7.9139 mle=1.6987 pcon=4.7985 forget=1.2954 orth=0.1213 favg=0.0000 nr=101 nf=9 protos=540 fproto_sim=NA
[loss] ep 23 it 360 total=7.9549 mle=1.7403 pcon=4.7985 forget=1.2953 orth=0.1208 favg=0.0000 nr=102 nf=5 protos=540 fproto_sim=NA
[loss] ep 23 it 410 total=7.8097 mle=1.5871 pcon=4.7984 forget=1.3039 orth=0.1202 favg=0.0000 nr=98 nf=4 protos=540 fproto_sim=NA
[loss] ep 24 it 30 total=7.8171 mle=1.5948 pcon=4.7985 forget=1.3041 orth=0.1197 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 24 it 80 total=7.8673 mle=1.6496 pcon=4.7984 forget=1.3002 orth=0.1192 favg=0.0000 nr=108 nf=5 protos=540 fproto_sim=NA
[loss] ep 24 it 130 total=7.9607 mle=1.6542 pcon=4.7984 forget=1.3893 orth=0.1187 favg=0.0000 nr=107 nf=5 protos=540 fproto_sim=NA
[loss] ep 24 it 180 total=7.8876 mle=1.6602 pcon=4.7985 forget=1.3107 orth=0.1182 favg=0.0000 nr=105 nf=4 protos=540 fproto_sim=NA
[loss] ep 24 it 230 total=7.8039 mle=1.5666 pcon=4.7986 forget=1.3210 orth=0.1177 favg=0.0000 nr=103 nf=7 protos=540 fproto_sim=NA
[loss] ep 24 it 280 total=7.7637 mle=1.5345 pcon=4.7988 forget=1.3132 orth=0.1172 favg=0.0000 nr=104 nf=8 protos=540 fproto_sim=NA
[loss] ep 24 it 330 total=7.9413 mle=1.7050 pcon=4.7988 forget=1.3208 orth=0.1167 favg=0.0000 nr=107 nf=7 protos=540 fproto_sim=NA
[loss] ep 24 it 380 total=7.8596 mle=1.5827 pcon=4.7991 forget=1.3616 orth=0.1162 favg=0.0000 nr=102 nf=7 protos=540 fproto_sim=NA
 52%|█████▏    | 26/50 [07:54<07:19, 18.31s/it] 54%|█████▍    | 27/50 [08:11<06:54, 18.01s/it] 56%|█████▌    | 28/50 [08:30<06:41, 18.25s/it] 58%|█████▊    | 29/50 [08:49<06:27, 18.44s/it] 60%|██████    | 30/50 [09:08<06:11, 18.55s/it] 62%|██████▏   | 31/50 [09:25<05:41, 17.97s/it] 64%|██████▍   | 32/50 [09:43<05:25, 18.08s/it][loss] ep 25 it 0 total=7.8906 mle=1.6540 pcon=4.7991 forget=1.3217 orth=0.1157 favg=0.0000 nr=111 nf=1 protos=540 fproto_sim=NA
[loss] ep 25 it 50 total=7.7949 mle=1.5606 pcon=4.7993 forget=1.3198 orth=0.1153 favg=0.0000 nr=101 nf=3 protos=540 fproto_sim=NA
[loss] ep 25 it 100 total=7.9672 mle=1.7278 pcon=4.7992 forget=1.3253 orth=0.1148 favg=0.0000 nr=112 nf=4 protos=540 fproto_sim=NA
[loss] ep 25 it 150 total=7.8164 mle=1.5758 pcon=4.7992 forget=1.3270 orth=0.1144 favg=0.0000 nr=103 nf=2 protos=540 fproto_sim=NA
[loss] ep 25 it 200 total=7.9168 mle=1.6395 pcon=4.7993 forget=1.3640 orth=0.1139 favg=0.0000 nr=103 nf=10 protos=540 fproto_sim=NA
[loss] ep 25 it 250 total=7.8837 mle=1.6472 pcon=4.7993 forget=1.3236 orth=0.1135 favg=0.0000 nr=108 nf=4 protos=540 fproto_sim=NA
[loss] ep 25 it 300 total=7.8475 mle=1.5762 pcon=4.7993 forget=1.3590 orth=0.1130 favg=0.0000 nr=97 nf=9 protos=540 fproto_sim=NA
[loss] ep 25 it 350 total=7.8473 mle=1.6052 pcon=4.7995 forget=1.3300 orth=0.1126 favg=0.0000 nr=109 nf=6 protos=540 fproto_sim=NA
[loss] ep 25 it 400 total=7.9658 mle=1.7235 pcon=4.7994 forget=1.3307 orth=0.1122 favg=0.0000 nr=100 nf=7 protos=540 fproto_sim=NA
[loss] ep 26 it 20 total=7.8932 mle=1.6471 pcon=4.7995 forget=1.3349 orth=0.1117 favg=0.0000 nr=106 nf=3 protos=540 fproto_sim=NA
[loss] ep 26 it 70 total=8.0718 mle=1.7894 pcon=4.7995 forget=1.3716 orth=0.1113 favg=0.0000 nr=103 nf=7 protos=540 fproto_sim=NA
[loss] ep 26 it 120 total=7.7990 mle=1.5436 pcon=4.7996 forget=1.3449 orth=0.1109 favg=0.0000 nr=102 nf=3 protos=540 fproto_sim=NA
[loss] ep 26 it 170 total=7.8442 mle=1.5743 pcon=4.7996 forget=1.3598 orth=0.1105 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 26 it 220 total=7.8916 mle=1.6427 pcon=4.7996 forget=1.3392 orth=0.1101 favg=0.0000 nr=108 nf=5 protos=540 fproto_sim=NA
[loss] ep 26 it 270 total=7.8683 mle=1.6009 pcon=4.7996 forget=1.3581 orth=0.1097 favg=0.0000 nr=107 nf=7 protos=540 fproto_sim=NA
[loss] ep 26 it 320 total=7.9505 mle=1.6775 pcon=4.7996 forget=1.3641 orth=0.1093 favg=0.0000 nr=106 nf=9 protos=540 fproto_sim=NA
[loss] ep 26 it 370 total=7.8766 mle=1.6226 pcon=4.7998 forget=1.3453 orth=0.1089 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 26 it 420 total=7.7924 mle=1.5355 pcon=4.7997 forget=1.3486 orth=0.1086 favg=0.0000 nr=108 nf=6 protos=540 fproto_sim=NA
[loss] ep 27 it 40 total=7.9131 mle=1.6559 pcon=4.7998 forget=1.3492 orth=0.1082 favg=0.0000 nr=111 nf=3 protos=540 fproto_sim=NA
[loss] ep 27 it 90 total=7.9424 mle=1.6832 pcon=4.7998 forget=1.3515 orth=0.1078 favg=0.0000 nr=104 nf=4 protos=540 fproto_sim=NA
[loss] ep 27 it 140 total=7.8747 mle=1.6077 pcon=4.7999 forget=1.3596 orth=0.1075 favg=0.0000 nr=105 nf=8 protos=540 fproto_sim=NA
[loss] ep 27 it 190 total=7.8820 mle=1.6202 pcon=4.8000 forget=1.3548 orth=0.1071 favg=0.0000 nr=97 nf=9 protos=540 fproto_sim=NA
[loss] ep 27 it 240 total=8.0045 mle=1.7155 pcon=4.7998 forget=1.3825 orth=0.1068 favg=0.0000 nr=100 nf=8 protos=540 fproto_sim=NA
[loss] ep 27 it 290 total=7.8170 mle=1.5618 pcon=4.7998 forget=1.3489 orth=0.1064 favg=0.0000 nr=104 nf=3 protos=540 fproto_sim=NA
[loss] ep 27 it 340 total=7.9451 mle=1.6862 pcon=4.7999 forget=1.3529 orth=0.1061 favg=0.0000 nr=102 nf=6 protos=540 fproto_sim=NA
[loss] ep 27 it 390 total=7.8142 mle=1.5549 pcon=4.8000 forget=1.3536 orth=0.1057 favg=0.0000 nr=112 nf=3 protos=540 fproto_sim=NA
[loss] ep 28 it 10 total=7.8621 mle=1.5992 pcon=4.8001 forget=1.3574 orth=0.1054 favg=0.0000 nr=111 nf=3 protos=540 fproto_sim=NA
[loss] ep 28 it 60 total=7.8418 mle=1.5771 pcon=4.8001 forget=1.3596 orth=0.1051 favg=0.0000 nr=110 nf=5 protos=540 fproto_sim=NA
[loss] ep 28 it 110 total=7.8959 mle=1.6321 pcon=4.8003 forget=1.3588 orth=0.1047 favg=0.0000 nr=98 nf=9 protos=540 fproto_sim=NA
[loss] ep 28 it 160 total=7.8694 mle=1.6069 pcon=4.8006 forget=1.3575 orth=0.1044 favg=0.0000 nr=109 nf=8 protos=540 fproto_sim=NA
[loss] ep 28 it 210 total=7.8813 mle=1.6245 pcon=4.8006 forget=1.3521 orth=0.1041 favg=0.0000 nr=111 nf=2 protos=540 fproto_sim=NA
[loss] ep 28 it 260 total=7.8060 mle=1.5381 pcon=4.8008 forget=1.3634 orth=0.1038 favg=0.0000 nr=100 nf=9 protos=540 fproto_sim=NA
[loss] ep 28 it 310 total=7.7831 mle=1.5029 pcon=4.8010 forget=1.3757 orth=0.1035 favg=0.0000 nr=109 nf=5 protos=540 fproto_sim=NA
[loss] ep 28 it 360 total=8.0127 mle=1.7281 pcon=4.8010 forget=1.3804 orth=0.1032 favg=0.0000 nr=100 nf=11 protos=540 fproto_sim=NA
[loss] ep 28 it 410 total=7.8605 mle=1.5900 pcon=4.8012 forget=1.3665 orth=0.1029 favg=0.0000 nr=109 nf=3 protos=540 fproto_sim=NA
[loss] ep 29 it 30 total=7.8395 mle=1.5840 pcon=4.8012 forget=1.3517 orth=0.1026 favg=0.0000 nr=116 nf=3 protos=540 fproto_sim=NA
[loss] ep 29 it 80 total=7.9675 mle=1.6910 pcon=4.8012 forget=1.3729 orth=0.1023 favg=0.0000 nr=103 nf=7 protos=540 fproto_sim=NA
[loss] ep 29 it 130 total=7.8103 mle=1.5447 pcon=4.8013 forget=1.3622 orth=0.1020 favg=0.0000 nr=106 nf=6 protos=540 fproto_sim=NA
[loss] ep 29 it 180 total=7.8831 mle=1.6182 pcon=4.8013 forget=1.3619 orth=0.1017 favg=0.0000 nr=106 nf=7 protos=540 fproto_sim=NA
[loss] ep 29 it 230 total=8.0164 mle=1.7373 pcon=4.8013 forget=1.3764 orth=0.1015 favg=0.0000 nr=102 nf=3 protos=540 fproto_sim=NA
[loss] ep 29 it 280 total=7.8611 mle=1.6070 pcon=4.8013 forget=1.3517 orth=0.1012 favg=0.0000 nr=105 nf=4 protos=540 fproto_sim=NA
[loss] ep 29 it 330 total=7.8966 mle=1.6179 pcon=4.8014 forget=1.3764 orth=0.1009 favg=0.0000 nr=110 nf=6 protos=540 fproto_sim=NA
[loss] ep 29 it 380 total=7.8723 mle=1.6073 pcon=4.8014 forget=1.3629 orth=0.1006 favg=0.0000 nr=105 nf=6 protos=540 fproto_sim=NA
[loss] ep 30 it 0 total=7.8993 mle=1.6251 pcon=4.8014 forget=1.3724 orth=0.1004 favg=0.0000 nr=103 nf=6 protos=540 fproto_sim=NA
[loss] ep 30 it 50 total=8.0040 mle=1.7122 pcon=4.8014 forget=1.3902 orth=0.1001 favg=0.0000 nr=97 nf=8 protos=540 fproto_sim=NA
[loss] ep 30 it 100 total=7.9959 mle=1.7281 pcon=4.8015 forget=1.3665 orth=0.0999 favg=0.0000 nr=108 nf=7 protos=540 fproto_sim=NA
[loss] ep 30 it 150 total=7.7601 mle=1.5077 pcon=4.8016 forget=1.3511 orth=0.0996 favg=0.0000 nr=101 nf=7 protos=540 fproto_sim=NA
[loss] ep 30 it 200 total=7.9563 mle=1.6789 pcon=4.8016 forget=1.3764 orth=0.0994 favg=0.0000 nr=106 nf=7 protos=540 fproto_sim=NA
[loss] ep 30 it 250 total=7.9635 mle=1.6879 pcon=4.8018 forget=1.3747 orth=0.0991 favg=0.0000 nr=103 nf=7 protos=540 fproto_sim=NA
[loss] ep 30 it 300 total=7.8690 mle=1.5984 pcon=4.8017 forget=1.3701 orth=0.0989 favg=0.0000 nr=106 nf=9 protos=540 fproto_sim=NA
[loss] ep 30 it 350 total=7.8486 mle=1.5777 pcon=4.8018 forget=1.3704 orth=0.0986 favg=0.0000 nr=104 nf=9 protos=540 fproto_sim=NA
[loss] ep 30 it 400 total=7.8551 mle=1.5909 pcon=4.8018 forget=1.3640 orth=0.0984 favg=0.0000 nr=97 nf=9 protos=540 fproto_sim=NA
[loss] ep 31 it 20 total=7.8254 mle=1.5526 pcon=4.8018 forget=1.3727 orth=0.0981 favg=0.0000 nr=103 nf=6 protos=540 fproto_sim=NA
[loss] ep 31 it 70 total=7.8321 mle=1.5758 pcon=4.8018 forget=1.3565 orth=0.0979 favg=0.0000 nr=102 nf=6 protos=540 fproto_sim=NA
[loss] ep 31 it 120 total=7.8532 mle=1.5731 pcon=4.8019 forget=1.3804 orth=0.0977 favg=0.0000 nr=105 nf=8 protos=540 fproto_sim=NA
[loss] ep 31 it 170 total=7.9538 mle=1.6967 pcon=4.8020 forget=1.3577 orth=0.0975 favg=0.0000 nr=107 nf=4 protos=540 fproto_sim=NA
[loss] ep 31 it 220 total=7.8855 mle=1.6214 pcon=4.8018 forget=1.3650 orth=0.0972 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 31 it 270 total=7.9704 mle=1.6936 pcon=4.8019 forget=1.3779 orth=0.0970 favg=0.0000 nr=103 nf=4 protos=540 fproto_sim=NA
[loss] ep 31 it 320 total=7.9499 mle=1.6513 pcon=4.8020 forget=1.3998 orth=0.0968 favg=0.0000 nr=106 nf=6 protos=540 fproto_sim=NA
[loss] ep 31 it 370 total=7.7540 mle=1.4916 pcon=4.8020 forget=1.3639 orth=0.0966 favg=0.0000 nr=103 nf=6 protos=540 fproto_sim=NA
[loss] ep 31 it 420 total=8.0027 mle=1.7073 pcon=4.8020 forget=1.3970 orth=0.0964 favg=0.0000 nr=101 nf=7 protos=540 fproto_sim=NA
[loss] ep 32 it 40 total=7.8749 mle=1.6140 pcon=4.8020 forget=1.3627 orth=0.0962 favg=0.0000 nr=105 nf=8 protos=540 fproto_sim=NA
 66%|██████▌   | 33/50 [10:00<05:03, 17.87s/it] 68%|██████▊   | 34/50 [10:19<04:49, 18.10s/it] 70%|███████   | 35/50 [10:38<04:37, 18.51s/it] 72%|███████▏  | 36/50 [10:55<04:13, 18.09s/it] 74%|███████▍  | 37/50 [11:12<03:50, 17.71s/it] 76%|███████▌  | 38/50 [11:30<03:30, 17.57s/it] 78%|███████▊  | 39/50 [11:47<03:13, 17.61s/it][loss] ep 32 it 90 total=7.9495 mle=1.6869 pcon=4.8020 forget=1.3646 orth=0.0960 favg=0.0000 nr=103 nf=7 protos=540 fproto_sim=NA
[loss] ep 32 it 140 total=7.8318 mle=1.5774 pcon=4.8020 forget=1.3567 orth=0.0958 favg=0.0000 nr=104 nf=7 protos=540 fproto_sim=NA
[loss] ep 32 it 190 total=7.9866 mle=1.7241 pcon=4.8019 forget=1.3650 orth=0.0956 favg=0.0000 nr=100 nf=9 protos=540 fproto_sim=NA
[loss] ep 32 it 240 total=7.9890 mle=1.7236 pcon=4.8018 forget=1.3682 orth=0.0954 favg=0.0000 nr=107 nf=5 protos=540 fproto_sim=NA
[loss] ep 32 it 290 total=8.0043 mle=1.7260 pcon=4.8019 forget=1.3811 orth=0.0952 favg=0.0000 nr=102 nf=5 protos=540 fproto_sim=NA
[loss] ep 32 it 340 total=7.8321 mle=1.5822 pcon=4.8019 forget=1.3529 orth=0.0951 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 32 it 390 total=7.9416 mle=1.6643 pcon=4.8020 forget=1.3804 orth=0.0949 favg=0.0000 nr=105 nf=4 protos=540 fproto_sim=NA
[loss] ep 33 it 10 total=7.8594 mle=1.6069 pcon=4.8020 forget=1.3558 orth=0.0947 favg=0.0000 nr=106 nf=7 protos=540 fproto_sim=NA
[loss] ep 33 it 60 total=7.8323 mle=1.5738 pcon=4.8020 forget=1.3620 orth=0.0945 favg=0.0000 nr=105 nf=3 protos=540 fproto_sim=NA
[loss] ep 33 it 110 total=7.8318 mle=1.5810 pcon=4.8021 forget=1.3544 orth=0.0943 favg=0.0000 nr=106 nf=3 protos=540 fproto_sim=NA
[loss] ep 33 it 160 total=7.7864 mle=1.5351 pcon=4.8020 forget=1.3551 orth=0.0942 favg=0.0000 nr=109 nf=2 protos=540 fproto_sim=NA
[loss] ep 33 it 210 total=7.8853 mle=1.6293 pcon=4.8019 forget=1.3600 orth=0.0940 favg=0.0000 nr=103 nf=4 protos=540 fproto_sim=NA
[loss] ep 33 it 260 total=7.9692 mle=1.7101 pcon=4.8020 forget=1.3632 orth=0.0939 favg=0.0000 nr=110 nf=3 protos=540 fproto_sim=NA
[loss] ep 33 it 310 total=7.8539 mle=1.5779 pcon=4.8020 forget=1.3803 orth=0.0937 favg=0.0000 nr=107 nf=9 protos=540 fproto_sim=NA
[loss] ep 33 it 360 total=7.7888 mle=1.5324 pcon=4.8020 forget=1.3609 orth=0.0935 favg=0.0000 nr=97 nf=9 protos=540 fproto_sim=NA
[loss] ep 33 it 410 total=7.9026 mle=1.6544 pcon=4.8020 forget=1.3529 orth=0.0934 favg=0.0000 nr=108 nf=3 protos=540 fproto_sim=NA
[loss] ep 34 it 30 total=7.7807 mle=1.5342 pcon=4.8021 forget=1.3511 orth=0.0932 favg=0.0000 nr=107 nf=6 protos=540 fproto_sim=NA
[loss] ep 34 it 80 total=7.8535 mle=1.5976 pcon=4.8021 forget=1.3607 orth=0.0931 favg=0.0000 nr=95 nf=5 protos=540 fproto_sim=NA
[loss] ep 34 it 130 total=7.8523 mle=1.5798 pcon=4.8022 forget=1.3774 orth=0.0929 favg=0.0000 nr=114 nf=2 protos=540 fproto_sim=NA
[loss] ep 34 it 180 total=7.8229 mle=1.5604 pcon=4.8024 forget=1.3673 orth=0.0928 favg=0.0000 nr=104 nf=6 protos=540 fproto_sim=NA
[loss] ep 34 it 230 total=7.7862 mle=1.5356 pcon=4.8025 forget=1.3555 orth=0.0926 favg=0.0000 nr=105 nf=2 protos=540 fproto_sim=NA
[loss] ep 34 it 280 total=7.8531 mle=1.6023 pcon=4.8026 forget=1.3557 orth=0.0925 favg=0.0000 nr=113 nf=2 protos=540 fproto_sim=NA
[loss] ep 34 it 330 total=7.8268 mle=1.5802 pcon=4.8026 forget=1.3517 orth=0.0923 favg=0.0000 nr=109 nf=6 protos=540 fproto_sim=NA
[loss] ep 34 it 380 total=7.8344 mle=1.5891 pcon=4.8026 forget=1.3505 orth=0.0922 favg=0.0000 nr=101 nf=11 protos=540 fproto_sim=NA
[loss] ep 35 it 0 total=7.8988 mle=1.6396 pcon=4.8025 forget=1.3646 orth=0.0920 favg=0.0000 nr=98 nf=10 protos=540 fproto_sim=NA
[loss] ep 35 it 50 total=8.0111 mle=1.7708 pcon=4.8025 forget=1.3460 orth=0.0919 favg=0.0000 nr=104 nf=5 protos=540 fproto_sim=NA
[loss] ep 35 it 100 total=7.8979 mle=1.6482 pcon=4.8025 forget=1.3555 orth=0.0918 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 35 it 150 total=7.9247 mle=1.6784 pcon=4.8024 forget=1.3522 orth=0.0916 favg=0.0000 nr=107 nf=6 protos=540 fproto_sim=NA
[loss] ep 35 it 200 total=7.9023 mle=1.6537 pcon=4.8022 forget=1.3549 orth=0.0915 favg=0.0000 nr=98 nf=9 protos=540 fproto_sim=NA
[loss] ep 35 it 250 total=7.8372 mle=1.5646 pcon=4.8022 forget=1.3790 orth=0.0914 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 35 it 300 total=7.8000 mle=1.5571 pcon=4.8022 forget=1.3495 orth=0.0912 favg=0.0000 nr=96 nf=8 protos=540 fproto_sim=NA
[loss] ep 35 it 350 total=7.8354 mle=1.5839 pcon=4.8024 forget=1.3580 orth=0.0911 favg=0.0000 nr=106 nf=1 protos=540 fproto_sim=NA
[loss] ep 35 it 400 total=7.8507 mle=1.6154 pcon=4.8024 forget=1.3419 orth=0.0910 favg=0.0000 nr=101 nf=8 protos=540 fproto_sim=NA
[loss] ep 36 it 20 total=7.9026 mle=1.6651 pcon=4.8026 forget=1.3441 orth=0.0909 favg=0.0000 nr=108 nf=6 protos=540 fproto_sim=NA
[loss] ep 36 it 70 total=7.8230 mle=1.5969 pcon=4.8025 forget=1.3328 orth=0.0907 favg=0.0000 nr=106 nf=2 protos=540 fproto_sim=NA
[loss] ep 36 it 120 total=7.7592 mle=1.5173 pcon=4.8025 forget=1.3488 orth=0.0906 favg=0.0000 nr=106 nf=6 protos=540 fproto_sim=NA
[loss] ep 36 it 170 total=7.9384 mle=1.7024 pcon=4.8027 forget=1.3428 orth=0.0905 favg=0.0000 nr=99 nf=7 protos=540 fproto_sim=NA
[loss] ep 36 it 220 total=7.8196 mle=1.5870 pcon=4.8027 forget=1.3394 orth=0.0904 favg=0.0000 nr=99 nf=10 protos=540 fproto_sim=NA
[loss] ep 36 it 270 total=7.9325 mle=1.7011 pcon=4.8027 forget=1.3384 orth=0.0903 favg=0.0000 nr=102 nf=6 protos=540 fproto_sim=NA
[loss] ep 36 it 320 total=7.8445 mle=1.5982 pcon=4.8028 forget=1.3533 orth=0.0902 favg=0.0000 nr=94 nf=5 protos=540 fproto_sim=NA
[loss] ep 36 it 370 total=7.8676 mle=1.6468 pcon=4.8028 forget=1.3279 orth=0.0901 favg=0.0000 nr=99 nf=7 protos=540 fproto_sim=NA
[loss] ep 36 it 420 total=7.8637 mle=1.6307 pcon=4.8027 forget=1.3404 orth=0.0900 favg=0.0000 nr=92 nf=9 protos=540 fproto_sim=NA
[loss] ep 37 it 40 total=7.8955 mle=1.6551 pcon=4.8027 forget=1.3479 orth=0.0899 favg=0.0000 nr=103 nf=7 protos=540 fproto_sim=NA
[loss] ep 37 it 90 total=7.8821 mle=1.6319 pcon=4.8027 forget=1.3577 orth=0.0898 favg=0.0000 nr=104 nf=4 protos=540 fproto_sim=NA
[loss] ep 37 it 140 total=7.7608 mle=1.5293 pcon=4.8026 forget=1.3392 orth=0.0897 favg=0.0000 nr=108 nf=9 protos=540 fproto_sim=NA
[loss] ep 37 it 190 total=7.9447 mle=1.6896 pcon=4.8027 forget=1.3629 orth=0.0896 favg=0.0000 nr=105 nf=4 protos=540 fproto_sim=NA
[loss] ep 37 it 240 total=7.8662 mle=1.6383 pcon=4.8026 forget=1.3358 orth=0.0895 favg=0.0000 nr=111 nf=5 protos=540 fproto_sim=NA
[loss] ep 37 it 290 total=8.0134 mle=1.6689 pcon=4.8025 forget=1.4526 orth=0.0894 favg=0.0000 nr=106 nf=4 protos=540 fproto_sim=NA
[loss] ep 37 it 340 total=7.9004 mle=1.6838 pcon=4.8025 forget=1.3248 orth=0.0893 favg=0.0000 nr=107 nf=3 protos=540 fproto_sim=NA
[loss] ep 37 it 390 total=7.8699 mle=1.6222 pcon=4.8024 forget=1.3561 orth=0.0892 favg=0.0000 nr=102 nf=9 protos=540 fproto_sim=NA
[loss] ep 38 it 10 total=7.8188 mle=1.6024 pcon=4.8024 forget=1.3250 orth=0.0891 favg=0.0000 nr=112 nf=6 protos=540 fproto_sim=NA
[loss] ep 38 it 60 total=7.8256 mle=1.5989 pcon=4.8023 forget=1.3354 orth=0.0890 favg=0.0000 nr=110 nf=7 protos=540 fproto_sim=NA
[loss] ep 38 it 110 total=7.8528 mle=1.6132 pcon=4.8021 forget=1.3485 orth=0.0889 favg=0.0000 nr=99 nf=9 protos=540 fproto_sim=NA
[loss] ep 38 it 160 total=7.8436 mle=1.6349 pcon=4.8022 forget=1.3178 orth=0.0888 favg=0.0000 nr=108 nf=3 protos=540 fproto_sim=NA
[loss] ep 38 it 210 total=7.7956 mle=1.5787 pcon=4.8021 forget=1.3261 orth=0.0887 favg=0.0000 nr=105 nf=3 protos=540 fproto_sim=NA
[loss] ep 38 it 260 total=7.8822 mle=1.6639 pcon=4.8020 forget=1.3276 orth=0.0886 favg=0.0000 nr=113 nf=4 protos=540 fproto_sim=NA
[loss] ep 38 it 310 total=7.7862 mle=1.5527 pcon=4.8020 forget=1.3429 orth=0.0886 favg=0.0000 nr=96 nf=11 protos=540 fproto_sim=NA
[loss] ep 38 it 360 total=7.7981 mle=1.5731 pcon=4.8019 forget=1.3347 orth=0.0885 favg=0.0000 nr=115 nf=3 protos=540 fproto_sim=NA
[loss] ep 38 it 410 total=7.8720 mle=1.6585 pcon=4.8020 forget=1.3230 orth=0.0884 favg=0.0000 nr=105 nf=6 protos=540 fproto_sim=NA
[loss] ep 39 it 30 total=7.8413 mle=1.6200 pcon=4.8021 forget=1.3309 orth=0.0883 favg=0.0000 nr=107 nf=10 protos=540 fproto_sim=NA
[loss] ep 39 it 80 total=7.7791 mle=1.5599 pcon=4.8021 forget=1.3289 orth=0.0882 favg=0.0000 nr=102 nf=10 protos=540 fproto_sim=NA
[loss] ep 39 it 130 total=7.8126 mle=1.5948 pcon=4.8022 forget=1.3274 orth=0.0882 favg=0.0000 nr=105 nf=7 protos=540 fproto_sim=NA
 80%|████████  | 40/50 [12:06<02:58, 17.86s/it] 82%|████████▏ | 41/50 [12:24<02:42, 18.06s/it] 84%|████████▍ | 42/50 [12:44<02:27, 18.48s/it] 86%|████████▌ | 43/50 [13:04<02:13, 19.02s/it] 88%|████████▊ | 44/50 [13:20<01:48, 18.06s/it] 90%|█████████ | 45/50 [13:33<01:23, 16.65s/it] 92%|█████████▏| 46/50 [13:47<01:02, 15.66s/it][loss] ep 39 it 180 total=7.9125 mle=1.6769 pcon=4.8022 forget=1.3454 orth=0.0881 favg=0.0000 nr=102 nf=6 protos=540 fproto_sim=NA
[loss] ep 39 it 230 total=7.8093 mle=1.6218 pcon=4.8021 forget=1.2973 orth=0.0880 favg=0.0000 nr=105 nf=3 protos=540 fproto_sim=NA
[loss] ep 39 it 280 total=7.7882 mle=1.5742 pcon=4.8022 forget=1.3238 orth=0.0879 favg=0.0000 nr=110 nf=6 protos=540 fproto_sim=NA
[loss] ep 39 it 330 total=7.8502 mle=1.6185 pcon=4.8022 forget=1.3416 orth=0.0879 favg=0.0000 nr=108 nf=5 protos=540 fproto_sim=NA
[loss] ep 39 it 380 total=7.9102 mle=1.7026 pcon=4.8022 forget=1.3176 orth=0.0878 favg=0.0000 nr=104 nf=9 protos=540 fproto_sim=NA
[loss] ep 40 it 0 total=7.9057 mle=1.7036 pcon=4.8021 forget=1.3122 orth=0.0877 favg=0.0000 nr=102 nf=3 protos=540 fproto_sim=NA
[loss] ep 40 it 50 total=7.9296 mle=1.6987 pcon=4.8021 forget=1.3411 orth=0.0877 favg=0.0000 nr=96 nf=9 protos=540 fproto_sim=NA
[loss] ep 40 it 100 total=7.8596 mle=1.6406 pcon=4.8020 forget=1.3294 orth=0.0876 favg=0.0000 nr=104 nf=2 protos=540 fproto_sim=NA
[loss] ep 40 it 150 total=7.8160 mle=1.5899 pcon=4.8022 forget=1.3363 orth=0.0876 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 40 it 200 total=7.7661 mle=1.5816 pcon=4.8022 forget=1.2949 orth=0.0875 favg=0.0000 nr=113 nf=4 protos=540 fproto_sim=NA
[loss] ep 40 it 250 total=7.8374 mle=1.6175 pcon=4.8021 forget=1.3304 orth=0.0874 favg=0.0000 nr=100 nf=7 protos=540 fproto_sim=NA
[loss] ep 40 it 300 total=7.8565 mle=1.6527 pcon=4.8021 forget=1.3142 orth=0.0874 favg=0.0000 nr=100 nf=11 protos=540 fproto_sim=NA
[loss] ep 40 it 350 total=7.9325 mle=1.7266 pcon=4.8022 forget=1.3165 orth=0.0873 favg=0.0000 nr=100 nf=6 protos=540 fproto_sim=NA
[loss] ep 40 it 400 total=7.9055 mle=1.6633 pcon=4.8023 forget=1.3527 orth=0.0873 favg=0.0000 nr=98 nf=10 protos=540 fproto_sim=NA
[loss] ep 41 it 20 total=7.9181 mle=1.6896 pcon=4.8021 forget=1.3391 orth=0.0872 favg=0.0000 nr=102 nf=4 protos=540 fproto_sim=NA
[loss] ep 41 it 70 total=7.9171 mle=1.6957 pcon=4.8021 forget=1.3321 orth=0.0872 favg=0.0000 nr=101 nf=5 protos=540 fproto_sim=NA
[loss] ep 41 it 120 total=7.7594 mle=1.5604 pcon=4.8021 forget=1.3098 orth=0.0871 favg=0.0000 nr=106 nf=6 protos=540 fproto_sim=NA
[loss] ep 41 it 170 total=7.8641 mle=1.6637 pcon=4.8019 forget=1.3114 orth=0.0871 favg=0.0000 nr=98 nf=7 protos=540 fproto_sim=NA
[loss] ep 41 it 220 total=7.8958 mle=1.6965 pcon=4.8019 forget=1.3104 orth=0.0870 favg=0.0000 nr=103 nf=9 protos=540 fproto_sim=NA
[loss] ep 41 it 270 total=7.7495 mle=1.5463 pcon=4.8019 forget=1.3143 orth=0.0870 favg=0.0000 nr=107 nf=3 protos=540 fproto_sim=NA
[loss] ep 41 it 320 total=7.8016 mle=1.6042 pcon=4.8019 forget=1.3085 orth=0.0869 favg=0.0000 nr=106 nf=2 protos=540 fproto_sim=NA
[loss] ep 41 it 370 total=7.7331 mle=1.5287 pcon=4.8019 forget=1.3155 orth=0.0869 favg=0.0000 nr=108 nf=8 protos=540 fproto_sim=NA
[loss] ep 41 it 420 total=7.9864 mle=1.7724 pcon=4.8020 forget=1.3253 orth=0.0868 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 42 it 40 total=7.7562 mle=1.5531 pcon=4.8020 forget=1.3143 orth=0.0868 favg=0.0000 nr=110 nf=9 protos=540 fproto_sim=NA
[loss] ep 42 it 90 total=7.8326 mle=1.6167 pcon=4.8019 forget=1.3272 orth=0.0868 favg=0.0000 nr=109 nf=4 protos=540 fproto_sim=NA
[loss] ep 42 it 140 total=7.8563 mle=1.6470 pcon=4.8020 forget=1.3207 orth=0.0867 favg=0.0000 nr=107 nf=3 protos=540 fproto_sim=NA
[loss] ep 42 it 190 total=7.8224 mle=1.6271 pcon=4.8021 forget=1.3066 orth=0.0867 favg=0.0000 nr=103 nf=5 protos=540 fproto_sim=NA
[loss] ep 42 it 240 total=7.7935 mle=1.5971 pcon=4.8020 forget=1.3077 orth=0.0866 favg=0.0000 nr=106 nf=5 protos=540 fproto_sim=NA
[loss] ep 42 it 290 total=7.8550 mle=1.6345 pcon=4.8020 forget=1.3319 orth=0.0866 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 42 it 340 total=7.8983 mle=1.6909 pcon=4.8020 forget=1.3188 orth=0.0866 favg=0.0000 nr=102 nf=4 protos=540 fproto_sim=NA
[loss] ep 42 it 390 total=7.8581 mle=1.6609 pcon=4.8020 forget=1.3087 orth=0.0865 favg=0.0000 nr=106 nf=2 protos=540 fproto_sim=NA
[loss] ep 43 it 10 total=7.9047 mle=1.7073 pcon=4.8019 forget=1.3090 orth=0.0865 favg=0.0000 nr=103 nf=4 protos=540 fproto_sim=NA
[loss] ep 43 it 60 total=7.8970 mle=1.6932 pcon=4.8019 forget=1.3154 orth=0.0865 favg=0.0000 nr=110 nf=5 protos=540 fproto_sim=NA
[loss] ep 43 it 110 total=7.9043 mle=1.6731 pcon=4.8019 forget=1.3429 orth=0.0864 favg=0.0000 nr=91 nf=8 protos=540 fproto_sim=NA
[loss] ep 43 it 160 total=7.8255 mle=1.6250 pcon=4.8019 forget=1.3122 orth=0.0864 favg=0.0000 nr=109 nf=8 protos=540 fproto_sim=NA
[loss] ep 43 it 210 total=7.8498 mle=1.6652 pcon=4.8019 forget=1.2963 orth=0.0864 favg=0.0000 nr=99 nf=2 protos=540 fproto_sim=NA
[loss] ep 43 it 260 total=7.8450 mle=1.6432 pcon=4.8019 forget=1.3136 orth=0.0863 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 43 it 310 total=7.9311 mle=1.7126 pcon=4.8018 forget=1.3303 orth=0.0863 favg=0.0000 nr=109 nf=8 protos=540 fproto_sim=NA
[loss] ep 43 it 360 total=7.8068 mle=1.6271 pcon=4.8018 forget=1.2916 orth=0.0863 favg=0.0000 nr=106 nf=7 protos=540 fproto_sim=NA
[loss] ep 43 it 410 total=7.9301 mle=1.7423 pcon=4.8017 forget=1.2999 orth=0.0863 favg=0.0000 nr=108 nf=4 protos=540 fproto_sim=NA
[loss] ep 44 it 30 total=7.9013 mle=1.6693 pcon=4.8015 forget=1.3442 orth=0.0862 favg=0.0000 nr=107 nf=4 protos=540 fproto_sim=NA
[loss] ep 44 it 80 total=6.5776 mle=1.6899 pcon=4.8014 forget=0.0000 orth=0.0862 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 130 total=7.8165 mle=1.6209 pcon=4.8014 forget=1.3080 orth=0.0862 favg=0.0000 nr=105 nf=7 protos=540 fproto_sim=NA
[loss] ep 44 it 180 total=7.8467 mle=1.6185 pcon=4.8015 forget=1.3405 orth=0.0862 favg=0.0000 nr=115 nf=5 protos=540 fproto_sim=NA
[loss] ep 44 it 230 total=7.8207 mle=1.5686 pcon=4.8014 forget=1.3646 orth=0.0862 favg=0.0000 nr=114 nf=3 protos=540 fproto_sim=NA
[loss] ep 44 it 280 total=7.8712 mle=1.6812 pcon=4.8015 forget=1.3023 orth=0.0861 favg=0.0000 nr=98 nf=6 protos=540 fproto_sim=NA
[loss] ep 44 it 330 total=7.9468 mle=1.7463 pcon=4.8014 forget=1.3129 orth=0.0861 favg=0.0000 nr=112 nf=6 protos=540 fproto_sim=NA
[loss] ep 44 it 380 total=7.8193 mle=1.5860 pcon=4.8014 forget=1.3458 orth=0.0861 favg=0.0000 nr=108 nf=7 protos=540 fproto_sim=NA
[loss] ep 45 it 0 total=7.9026 mle=1.6844 pcon=4.8014 forget=1.3309 orth=0.0861 favg=0.0000 nr=98 nf=10 protos=540 fproto_sim=NA
[loss] ep 45 it 50 total=7.7937 mle=1.5851 pcon=4.8013 forget=1.3212 orth=0.0861 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 45 it 100 total=7.8332 mle=1.6393 pcon=4.8014 forget=1.3065 orth=0.0860 favg=0.0000 nr=98 nf=7 protos=540 fproto_sim=NA
[loss] ep 45 it 150 total=7.7512 mle=1.5436 pcon=4.8015 forget=1.3201 orth=0.0860 favg=0.0000 nr=97 nf=8 protos=540 fproto_sim=NA
[loss] ep 45 it 200 total=7.7525 mle=1.5608 pcon=4.8015 forget=1.3042 orth=0.0860 favg=0.0000 nr=109 nf=7 protos=540 fproto_sim=NA
[loss] ep 45 it 250 total=7.8261 mle=1.6268 pcon=4.8014 forget=1.3119 orth=0.0860 favg=0.0000 nr=103 nf=4 protos=540 fproto_sim=NA
[loss] ep 45 it 300 total=7.8038 mle=1.6119 pcon=4.8014 forget=1.3045 orth=0.0860 favg=0.0000 nr=112 nf=4 protos=540 fproto_sim=NA
[loss] ep 45 it 350 total=7.8597 mle=1.6434 pcon=4.8014 forget=1.3289 orth=0.0860 favg=0.0000 nr=103 nf=3 protos=540 fproto_sim=NA
[loss] ep 45 it 400 total=7.7789 mle=1.5805 pcon=4.8014 forget=1.3111 orth=0.0860 favg=0.0000 nr=107 nf=5 protos=540 fproto_sim=NA
[loss] ep 46 it 20 total=7.7667 mle=1.5766 pcon=4.8015 forget=1.3027 orth=0.0860 favg=0.0000 nr=99 nf=7 protos=540 fproto_sim=NA
[loss] ep 46 it 70 total=7.9573 mle=1.7227 pcon=4.8016 forget=1.3470 orth=0.0859 favg=0.0000 nr=104 nf=4 protos=540 fproto_sim=NA
[loss] ep 46 it 120 total=7.8863 mle=1.6757 pcon=4.8017 forget=1.3230 orth=0.0859 favg=0.0000 nr=101 nf=7 protos=540 fproto_sim=NA
[loss] ep 46 it 170 total=7.8209 mle=1.6207 pcon=4.8018 forget=1.3125 orth=0.0859 favg=0.0000 nr=96 nf=12 protos=540 fproto_sim=NA
[loss] ep 46 it 220 total=7.7342 mle=1.5062 pcon=4.8017 forget=1.3404 orth=0.0859 favg=0.0000 nr=101 nf=4 protos=540 fproto_sim=NA
 94%|█████████▍| 47/50 [14:01<00:45, 15.33s/it] 96%|█████████▌| 48/50 [14:16<00:30, 15.15s/it] 98%|█████████▊| 49/50 [14:30<00:14, 14.84s/it]100%|██████████| 50/50 [14:46<00:00, 15.06s/it]100%|██████████| 50/50 [14:46<00:00, 17.72s/it]
[loss] ep 46 it 270 total=7.9242 mle=1.6829 pcon=4.8016 forget=1.3538 orth=0.0859 favg=0.0000 nr=103 nf=5 protos=540 fproto_sim=NA
[loss] ep 46 it 320 total=7.7833 mle=1.5894 pcon=4.8016 forget=1.3064 orth=0.0859 favg=0.0000 nr=98 nf=7 protos=540 fproto_sim=NA
[loss] ep 46 it 370 total=7.8106 mle=1.6181 pcon=4.8017 forget=1.3050 orth=0.0859 favg=0.0000 nr=105 nf=5 protos=540 fproto_sim=NA
[loss] ep 46 it 420 total=7.8180 mle=1.5906 pcon=4.8016 forget=1.3399 orth=0.0859 favg=0.0000 nr=106 nf=8 protos=540 fproto_sim=NA
[loss] ep 47 it 40 total=7.8381 mle=1.6351 pcon=4.8017 forget=1.3155 orth=0.0859 favg=0.0000 nr=110 nf=5 protos=540 fproto_sim=NA
[loss] ep 47 it 90 total=7.7810 mle=1.5491 pcon=4.8019 forget=1.3441 orth=0.0859 favg=0.0000 nr=98 nf=8 protos=540 fproto_sim=NA
[loss] ep 47 it 140 total=7.8344 mle=1.5764 pcon=4.8018 forget=1.3703 orth=0.0859 favg=0.0000 nr=102 nf=5 protos=540 fproto_sim=NA
[loss] ep 47 it 190 total=7.7760 mle=1.5975 pcon=4.8020 forget=1.2906 orth=0.0859 favg=0.0000 nr=100 nf=5 protos=540 fproto_sim=NA
[loss] ep 47 it 240 total=7.7413 mle=1.5307 pcon=4.8019 forget=1.3229 orth=0.0859 favg=0.0000 nr=111 nf=3 protos=540 fproto_sim=NA
[loss] ep 47 it 290 total=7.7373 mle=1.5376 pcon=4.8017 forget=1.3121 orth=0.0859 favg=0.0000 nr=99 nf=5 protos=540 fproto_sim=NA
[loss] ep 47 it 340 total=7.7872 mle=1.6042 pcon=4.8016 forget=1.2955 orth=0.0858 favg=0.0000 nr=110 nf=4 protos=540 fproto_sim=NA
[loss] ep 47 it 390 total=7.9175 mle=1.7178 pcon=4.8016 forget=1.3122 orth=0.0858 favg=0.0000 nr=101 nf=10 protos=540 fproto_sim=NA
[loss] ep 48 it 10 total=7.8670 mle=1.6677 pcon=4.8016 forget=1.3119 orth=0.0858 favg=0.0000 nr=102 nf=9 protos=540 fproto_sim=NA
[loss] ep 48 it 60 total=7.8694 mle=1.6728 pcon=4.8015 forget=1.3092 orth=0.0858 favg=0.0000 nr=97 nf=10 protos=540 fproto_sim=NA
[loss] ep 48 it 110 total=7.8518 mle=1.6658 pcon=4.8015 forget=1.2986 orth=0.0858 favg=0.0000 nr=111 nf=4 protos=540 fproto_sim=NA
[loss] ep 48 it 160 total=7.7978 mle=1.6209 pcon=4.8013 forget=1.2897 orth=0.0858 favg=0.0000 nr=103 nf=2 protos=540 fproto_sim=NA
[loss] ep 48 it 210 total=7.8855 mle=1.6680 pcon=4.8014 forget=1.3303 orth=0.0858 favg=0.0000 nr=100 nf=9 protos=540 fproto_sim=NA
[loss] ep 48 it 260 total=7.8135 mle=1.6416 pcon=4.8016 forget=1.2844 orth=0.0858 favg=0.0000 nr=109 nf=3 protos=540 fproto_sim=NA
[loss] ep 48 it 310 total=7.7777 mle=1.5892 pcon=4.8015 forget=1.3012 orth=0.0858 favg=0.0000 nr=101 nf=6 protos=540 fproto_sim=NA
[loss] ep 48 it 360 total=7.8709 mle=1.6754 pcon=4.8016 forget=1.3081 orth=0.0858 favg=0.0000 nr=98 nf=7 protos=540 fproto_sim=NA
[loss] ep 48 it 410 total=7.8759 mle=1.6724 pcon=4.8016 forget=1.3161 orth=0.0858 favg=0.0000 nr=108 nf=5 protos=540 fproto_sim=NA
[loss] ep 49 it 30 total=7.7813 mle=1.5660 pcon=4.8017 forget=1.3278 orth=0.0858 favg=0.0000 nr=98 nf=7 protos=540 fproto_sim=NA
[loss] ep 49 it 80 total=7.8130 mle=1.6088 pcon=4.8018 forget=1.3167 orth=0.0858 favg=0.0000 nr=107 nf=5 protos=540 fproto_sim=NA
[loss] ep 49 it 130 total=7.7069 mle=1.5096 pcon=4.8016 forget=1.3099 orth=0.0858 favg=0.0000 nr=103 nf=6 protos=540 fproto_sim=NA
[loss] ep 49 it 180 total=7.9828 mle=1.7561 pcon=4.8016 forget=1.3393 orth=0.0858 favg=0.0000 nr=101 nf=7 protos=540 fproto_sim=NA
[loss] ep 49 it 230 total=7.8874 mle=1.6649 pcon=4.8016 forget=1.3351 orth=0.0858 favg=0.0000 nr=101 nf=6 protos=540 fproto_sim=NA
[loss] ep 49 it 280 total=7.8259 mle=1.6448 pcon=4.8018 forget=1.2935 orth=0.0858 favg=0.0000 nr=100 nf=7 protos=540 fproto_sim=NA
[loss] ep 49 it 330 total=7.8400 mle=1.6243 pcon=4.8018 forget=1.3281 orth=0.0858 favg=0.0000 nr=102 nf=10 protos=540 fproto_sim=NA
[loss] ep 49 it 380 total=7.8773 mle=1.6898 pcon=4.8017 forget=1.3000 orth=0.0858 favg=0.0000 nr=107 nf=7 protos=540 fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc1-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:33,  2.01it/s]  2%|▏         | 8/430 [00:00<00:24, 17.05it/s]  4%|▍         | 17/430 [00:00<00:11, 34.51it/s]  6%|▌         | 26/430 [00:00<00:08, 48.60it/s]  8%|▊         | 36/430 [00:00<00:06, 61.03it/s] 11%|█         | 46/430 [00:01<00:05, 70.73it/s] 13%|█▎        | 56/430 [00:01<00:04, 78.02it/s] 15%|█▌        | 66/430 [00:01<00:04, 83.31it/s] 18%|█▊        | 76/430 [00:01<00:04, 87.24it/s] 20%|██        | 86/430 [00:01<00:03, 90.03it/s] 22%|██▏       | 96/430 [00:01<00:03, 91.87it/s] 25%|██▍       | 106/430 [00:01<00:03, 92.61it/s] 27%|██▋       | 116/430 [00:01<00:03, 93.80it/s] 29%|██▉       | 126/430 [00:01<00:03, 94.44it/s] 32%|███▏      | 136/430 [00:01<00:03, 92.39it/s] 34%|███▍      | 146/430 [00:02<00:03, 93.55it/s] 36%|███▋      | 156/430 [00:02<00:02, 94.36it/s] 39%|███▊      | 166/430 [00:02<00:02, 95.07it/s] 41%|████      | 176/430 [00:02<00:02, 95.45it/s] 43%|████▎     | 186/430 [00:02<00:02, 95.91it/s] 46%|████▌     | 196/430 [00:02<00:02, 95.82it/s] 48%|████▊     | 206/430 [00:02<00:02, 94.34it/s] 50%|█████     | 216/430 [00:02<00:02, 94.53it/s] 53%|█████▎    | 226/430 [00:02<00:02, 94.66it/s] 55%|█████▍    | 236/430 [00:03<00:02, 94.69it/s] 57%|█████▋    | 246/430 [00:03<00:01, 94.85it/s] 60%|█████▉    | 256/430 [00:03<00:01, 94.74it/s] 62%|██████▏   | 266/430 [00:03<00:01, 95.00it/s] 64%|██████▍   | 276/430 [00:03<00:01, 94.95it/s] 67%|██████▋   | 286/430 [00:03<00:01, 95.29it/s] 69%|██████▉   | 296/430 [00:03<00:01, 95.23it/s] 71%|███████   | 306/430 [00:03<00:01, 95.57it/s] 73%|███████▎  | 316/430 [00:03<00:01, 95.27it/s] 76%|███████▌  | 326/430 [00:03<00:01, 95.06it/s] 78%|███████▊  | 336/430 [00:04<00:00, 95.14it/s] 80%|████████  | 346/430 [00:04<00:00, 94.37it/s] 83%|████████▎ | 356/430 [00:04<00:00, 94.62it/s] 85%|████████▌ | 366/430 [00:04<00:00, 94.37it/s] 87%|████████▋ | 376/430 [00:04<00:00, 95.01it/s] 90%|████████▉ | 386/430 [00:04<00:00, 95.56it/s] 92%|█████████▏| 396/430 [00:04<00:00, 95.38it/s] 94%|█████████▍| 406/430 [00:04<00:00, 95.34it/s] 97%|█████████▋| 416/430 [00:04<00:00, 96.08it/s] 99%|█████████▉| 426/430 [00:05<00:00, 96.63it/s]100%|██████████| 430/430 [00:05<00:00, 85.12it/s]
55000 images processed, 5.13028883934021 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:37,  2.28it/s] 13%|█▎        | 11/86 [00:00<00:02, 25.64it/s] 23%|██▎       | 20/86 [00:00<00:01, 41.47it/s] 35%|███▍      | 30/86 [00:00<00:01, 55.87it/s] 47%|████▋     | 40/86 [00:00<00:00, 66.65it/s] 58%|█████▊    | 50/86 [00:00<00:00, 74.34it/s] 70%|██████▉   | 60/86 [00:01<00:00, 80.44it/s] 81%|████████▏ | 70/86 [00:01<00:00, 85.30it/s] 93%|█████████▎| 80/86 [00:01<00:00, 88.79it/s]100%|██████████| 86/86 [00:01<00:00, 63.64it/s]
11000 images processed, 1.3659374713897705 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:39,  2.03it/s]  5%|▌         | 11/204 [00:00<00:08, 23.61it/s] 10%|█         | 21/204 [00:00<00:04, 40.79it/s] 15%|█▌        | 31/204 [00:00<00:03, 54.54it/s] 20%|██        | 41/204 [00:00<00:02, 65.31it/s] 25%|██▍       | 50/204 [00:01<00:02, 71.85it/s] 29%|██▉       | 60/204 [00:01<00:01, 78.33it/s] 34%|███▍      | 69/204 [00:01<00:01, 81.45it/s] 39%|███▊      | 79/204 [00:01<00:01, 85.68it/s] 44%|████▎     | 89/204 [00:01<00:01, 88.56it/s] 49%|████▊     | 99/204 [00:01<00:01, 90.72it/s] 53%|█████▎    | 109/204 [00:01<00:01, 91.99it/s] 58%|█████▊    | 119/204 [00:01<00:00, 93.11it/s] 63%|██████▎   | 129/204 [00:01<00:00, 93.88it/s] 68%|██████▊   | 139/204 [00:01<00:00, 94.56it/s] 73%|███████▎  | 149/204 [00:02<00:00, 94.99it/s] 78%|███████▊  | 159/204 [00:02<00:00, 95.21it/s] 83%|████████▎ | 169/204 [00:02<00:00, 95.34it/s] 88%|████████▊ | 179/204 [00:02<00:00, 95.05it/s] 93%|█████████▎| 189/204 [00:02<00:00, 95.68it/s] 98%|█████████▊| 199/204 [00:02<00:00, 95.99it/s]100%|██████████| 204/204 [00:02<00:00, 77.11it/s]
26032 images processed, 2.6938514709472656 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.62it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.70it/s] 27%|██▋       | 21/79 [00:00<00:01, 35.70it/s] 39%|███▉      | 31/79 [00:00<00:00, 49.24it/s] 52%|█████▏    | 41/79 [00:01<00:00, 60.06it/s] 65%|██████▍   | 51/79 [00:01<00:00, 68.48it/s] 77%|███████▋  | 61/79 [00:01<00:00, 75.52it/s] 90%|████████▉ | 71/79 [00:01<00:00, 81.41it/s]100%|██████████| 79/79 [00:02<00:00, 32.71it/s]
10000 images processed, 2.4527957439422607 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.98it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.05it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.41it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.49it/s] 52%|█████▏    | 41/79 [00:00<00:00, 65.50it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.73it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.23it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.03it/s]100%|██████████| 79/79 [00:01<00:00, 59.83it/s]
10000 images processed, 1.3405780792236328 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  1.98it/s] 14%|█▍        | 10/70 [00:00<00:02, 21.34it/s] 29%|██▊       | 20/70 [00:00<00:01, 39.33it/s] 43%|████▎     | 30/70 [00:00<00:00, 53.63it/s] 57%|█████▋    | 40/70 [00:00<00:00, 64.58it/s] 71%|███████▏  | 50/70 [00:01<00:00, 73.47it/s] 86%|████████▌ | 60/70 [00:01<00:00, 80.12it/s]100%|██████████| 70/70 [00:01<00:00, 84.05it/s]100%|██████████| 70/70 [00:01<00:00, 56.37it/s]
8925 images processed, 1.2703981399536133 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.11it/s] 11%|█         | 5/45 [00:01<00:06,  6.35it/s] 33%|███▎      | 15/45 [00:01<00:01, 21.33it/s] 47%|████▋     | 21/45 [00:01<00:01, 20.19it/s] 58%|█████▊    | 26/45 [00:01<00:00, 23.16it/s] 73%|███████▎  | 33/45 [00:01<00:00, 21.49it/s] 93%|█████████▎| 42/45 [00:02<00:00, 31.31it/s]100%|██████████| 45/45 [00:02<00:00, 21.56it/s]
5640 images processed, 2.1083645820617676 seconds used

17.995277404785156
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.67  99.67  95.43
places365     45.96  91.79  74.16
LSUN           7.17  98.39  92.05
iSUN          42.14  93.06  81.37
dtd           27.89  95.59  90.39
AVG           24.97  95.70  86.68
[incremental] Overall: 0.8540 New: 0.8440 Old: 0.8540
2.2722692489624023
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc1-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:39,  1.95it/s]  2%|▏         | 9/430 [00:00<00:22, 18.51it/s]  4%|▎         | 16/430 [00:00<00:13, 30.45it/s]  6%|▌         | 25/430 [00:00<00:08, 45.23it/s]  8%|▊         | 33/430 [00:00<00:07, 52.96it/s] 10%|▉         | 41/430 [00:01<00:06, 59.03it/s] 12%|█▏        | 51/430 [00:01<00:05, 69.21it/s] 14%|█▍        | 61/430 [00:01<00:04, 76.51it/s] 17%|█▋        | 71/430 [00:01<00:04, 82.05it/s] 19%|█▉        | 81/430 [00:01<00:04, 86.26it/s] 21%|██        | 91/430 [00:01<00:03, 89.37it/s] 23%|██▎       | 101/430 [00:01<00:04, 79.88it/s] 26%|██▌       | 110/430 [00:01<00:04, 75.45it/s] 28%|██▊       | 120/430 [00:01<00:03, 80.48it/s] 30%|███       | 130/430 [00:02<00:03, 84.56it/s] 33%|███▎      | 140/430 [00:02<00:03, 87.72it/s] 35%|███▍      | 150/430 [00:02<00:03, 89.77it/s] 37%|███▋      | 160/430 [00:02<00:02, 91.02it/s] 40%|███▉      | 170/430 [00:02<00:02, 91.51it/s] 42%|████▏     | 180/430 [00:02<00:02, 92.88it/s] 44%|████▍     | 190/430 [00:02<00:02, 93.43it/s] 47%|████▋     | 200/430 [00:02<00:02, 94.30it/s] 49%|████▉     | 210/430 [00:02<00:02, 93.93it/s] 51%|█████     | 220/430 [00:03<00:02, 94.43it/s] 53%|█████▎    | 230/430 [00:03<00:02, 94.58it/s] 56%|█████▌    | 240/430 [00:03<00:02, 94.72it/s] 58%|█████▊    | 250/430 [00:03<00:01, 94.78it/s] 60%|██████    | 260/430 [00:03<00:01, 95.07it/s] 63%|██████▎   | 270/430 [00:03<00:01, 95.19it/s] 65%|██████▌   | 280/430 [00:03<00:01, 95.55it/s] 67%|██████▋   | 290/430 [00:03<00:01, 95.44it/s] 70%|██████▉   | 300/430 [00:03<00:01, 95.07it/s] 72%|███████▏  | 310/430 [00:03<00:01, 95.39it/s] 74%|███████▍  | 320/430 [00:04<00:01, 95.66it/s] 77%|███████▋  | 330/430 [00:04<00:01, 95.23it/s] 79%|███████▉  | 340/430 [00:04<00:00, 90.99it/s] 81%|████████▏ | 350/430 [00:04<00:00, 91.43it/s] 84%|████████▎ | 360/430 [00:04<00:00, 92.88it/s] 86%|████████▌ | 370/430 [00:04<00:00, 93.54it/s] 88%|████████▊ | 380/430 [00:04<00:00, 93.59it/s] 91%|█████████ | 390/430 [00:04<00:00, 94.19it/s] 93%|█████████▎| 400/430 [00:04<00:00, 92.83it/s] 95%|█████████▌| 410/430 [00:05<00:00, 94.01it/s] 98%|█████████▊| 420/430 [00:05<00:00, 95.02it/s]100%|██████████| 430/430 [00:05<00:00, 93.36it/s]100%|██████████| 430/430 [00:05<00:00, 81.93it/s]
55000 images processed, 5.377527952194214 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:40,  2.11it/s] 12%|█▏        | 10/86 [00:00<00:03, 22.04it/s] 22%|██▏       | 19/86 [00:00<00:01, 38.13it/s] 34%|███▎      | 29/86 [00:00<00:01, 52.69it/s] 45%|████▌     | 39/86 [00:00<00:00, 63.47it/s] 57%|█████▋    | 49/86 [00:01<00:00, 71.62it/s] 69%|██████▊   | 59/86 [00:01<00:00, 77.42it/s] 80%|████████  | 69/86 [00:01<00:00, 82.26it/s] 92%|█████████▏| 79/86 [00:01<00:00, 85.66it/s]100%|██████████| 86/86 [00:01<00:00, 60.71it/s]
11000 images processed, 1.441777229309082 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc1-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:37,  2.09it/s]  4%|▍         | 9/204 [00:00<00:09, 19.75it/s]  9%|▉         | 18/204 [00:00<00:05, 36.93it/s] 14%|█▎        | 28/204 [00:00<00:03, 51.84it/s] 18%|█▊        | 37/204 [00:00<00:02, 61.36it/s] 23%|██▎       | 46/204 [00:01<00:02, 68.56it/s] 27%|██▋       | 55/204 [00:01<00:02, 74.39it/s] 31%|███▏      | 64/204 [00:01<00:01, 78.27it/s] 36%|███▋      | 74/204 [00:01<00:01, 82.72it/s] 41%|████      | 84/204 [00:01<00:01, 86.34it/s] 46%|████▌     | 94/204 [00:01<00:01, 88.40it/s] 51%|█████     | 104/204 [00:01<00:01, 90.10it/s] 56%|█████▌    | 114/204 [00:01<00:00, 91.11it/s] 61%|██████    | 124/204 [00:01<00:00, 92.11it/s] 66%|██████▌   | 134/204 [00:01<00:00, 92.24it/s] 71%|███████   | 144/204 [00:02<00:00, 87.90it/s] 75%|███████▌  | 153/204 [00:02<00:00, 87.14it/s] 80%|███████▉  | 163/204 [00:02<00:00, 89.45it/s] 85%|████████▍ | 173/204 [00:02<00:00, 91.26it/s] 90%|████████▉ | 183/204 [00:02<00:00, 92.73it/s] 95%|█████████▍| 193/204 [00:02<00:00, 93.98it/s]100%|█████████▉| 203/204 [00:02<00:00, 94.77it/s]100%|██████████| 204/204 [00:02<00:00, 75.04it/s]
26032 images processed, 2.759636878967285 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.59it/s]  9%|▉         | 7/79 [00:00<00:05, 12.28it/s] 22%|██▏       | 17/79 [00:00<00:02, 30.14it/s] 34%|███▍      | 27/79 [00:00<00:01, 44.97it/s] 47%|████▋     | 37/79 [00:01<00:00, 57.12it/s] 59%|█████▉    | 47/79 [00:01<00:00, 66.98it/s] 72%|███████▏  | 57/79 [00:01<00:00, 74.34it/s] 85%|████████▍ | 67/79 [00:01<00:00, 80.40it/s] 97%|█████████▋| 77/79 [00:01<00:00, 85.04it/s]100%|██████████| 79/79 [00:02<00:00, 32.51it/s]
10000 images processed, 2.501321792602539 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:53,  1.47it/s] 13%|█▎        | 10/79 [00:00<00:04, 16.62it/s] 24%|██▍       | 19/79 [00:00<00:01, 30.40it/s] 35%|███▌      | 28/79 [00:01<00:01, 42.91it/s] 48%|████▊     | 38/79 [00:01<00:00, 55.33it/s] 59%|█████▉    | 47/79 [00:01<00:00, 54.85it/s] 70%|██████▉   | 55/79 [00:01<00:00, 59.81it/s] 82%|████████▏ | 65/79 [00:01<00:00, 69.06it/s] 95%|█████████▍| 75/79 [00:01<00:00, 76.38it/s]100%|██████████| 79/79 [00:01<00:00, 48.60it/s]
10000 images processed, 1.6478021144866943 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.88it/s]  7%|▋         | 5/70 [00:00<00:06,  9.75it/s] 17%|█▋        | 12/70 [00:00<00:02, 23.35it/s] 26%|██▌       | 18/70 [00:00<00:01, 31.97it/s] 40%|████      | 28/70 [00:00<00:00, 48.64it/s] 54%|█████▍    | 38/70 [00:01<00:00, 60.64it/s] 69%|██████▊   | 48/70 [00:01<00:00, 70.53it/s] 83%|████████▎ | 58/70 [00:01<00:00, 78.02it/s] 97%|█████████▋| 68/70 [00:01<00:00, 83.46it/s]100%|██████████| 70/70 [00:01<00:00, 49.98it/s]
8925 images processed, 1.4373548030853271 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.06it/s]  9%|▉         | 4/45 [00:01<00:08,  4.86it/s] 16%|█▌        | 7/45 [00:01<00:06,  5.91it/s] 36%|███▌      | 16/45 [00:01<00:01, 16.78it/s] 51%|█████     | 23/45 [00:02<00:01, 15.53it/s] 73%|███████▎  | 33/45 [00:02<00:00, 25.55it/s] 87%|████████▋ | 39/45 [00:02<00:00, 23.71it/s]100%|██████████| 45/45 [00:02<00:00, 17.69it/s]
5640 images processed, 2.5688364505767822 seconds used

19.488818883895874
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.85  99.32  98.14
places365     72.37  78.06  78.82
LSUN          11.59  97.35  97.41
iSUN          70.22  82.45  86.18
dtd           44.95  88.94  93.58
AVG           40.39  89.22  90.83
Retain-Acc: 0.7330
Forget-as-OOD (retain known vs forget novel):
  FPR: 43.00 AUROC: 88.70 AUIN: 99.29
8.30784273147583
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc2-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<04:03,  1.76it/s]  2%|▏         | 10/430 [00:00<00:21, 19.50it/s]  4%|▍         | 19/430 [00:00<00:11, 35.19it/s]  7%|▋         | 29/430 [00:00<00:08, 49.99it/s]  9%|▉         | 39/430 [00:00<00:06, 61.20it/s] 11%|█▏        | 49/430 [00:01<00:05, 70.59it/s] 14%|█▎        | 59/430 [00:01<00:04, 77.70it/s] 16%|█▌        | 69/430 [00:01<00:04, 82.89it/s] 18%|█▊        | 79/430 [00:01<00:04, 86.82it/s] 21%|██        | 89/430 [00:01<00:03, 89.44it/s] 23%|██▎       | 99/430 [00:01<00:03, 91.42it/s] 25%|██▌       | 109/430 [00:01<00:03, 92.95it/s] 28%|██▊       | 119/430 [00:01<00:03, 93.94it/s] 30%|███       | 129/430 [00:01<00:03, 94.79it/s] 32%|███▏      | 139/430 [00:02<00:03, 95.41it/s] 35%|███▍      | 149/430 [00:02<00:02, 95.79it/s] 37%|███▋      | 159/430 [00:02<00:02, 96.04it/s] 39%|███▉      | 169/430 [00:02<00:02, 96.25it/s] 42%|████▏     | 179/430 [00:02<00:02, 96.44it/s] 44%|████▍     | 189/430 [00:02<00:02, 96.39it/s] 46%|████▋     | 199/430 [00:02<00:02, 96.49it/s] 49%|████▊     | 209/430 [00:02<00:02, 96.55it/s] 51%|█████     | 219/430 [00:02<00:02, 95.89it/s] 53%|█████▎    | 229/430 [00:02<00:02, 95.90it/s] 56%|█████▌    | 239/430 [00:03<00:01, 96.07it/s] 58%|█████▊    | 249/430 [00:03<00:01, 95.79it/s] 60%|██████    | 259/430 [00:03<00:01, 96.07it/s] 63%|██████▎   | 269/430 [00:03<00:01, 96.02it/s] 65%|██████▍   | 279/430 [00:03<00:01, 95.83it/s] 67%|██████▋   | 289/430 [00:03<00:01, 95.94it/s] 70%|██████▉   | 299/430 [00:03<00:01, 96.05it/s] 72%|███████▏  | 309/430 [00:03<00:01, 96.32it/s] 74%|███████▍  | 319/430 [00:03<00:01, 96.06it/s] 77%|███████▋  | 329/430 [00:03<00:01, 96.12it/s] 79%|███████▉  | 339/430 [00:04<00:00, 96.18it/s] 81%|████████  | 349/430 [00:04<00:00, 95.73it/s] 83%|████████▎ | 359/430 [00:04<00:00, 95.36it/s] 86%|████████▌ | 369/430 [00:04<00:00, 95.50it/s] 88%|████████▊ | 379/430 [00:04<00:00, 95.63it/s] 90%|█████████ | 389/430 [00:04<00:00, 95.74it/s] 93%|█████████▎| 399/430 [00:04<00:00, 95.50it/s] 95%|█████████▌| 409/430 [00:04<00:00, 96.23it/s] 97%|█████████▋| 419/430 [00:04<00:00, 96.78it/s]100%|█████████▉| 429/430 [00:05<00:00, 97.12it/s]100%|██████████| 430/430 [00:05<00:00, 85.04it/s]
55000 images processed, 5.098919630050659 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:40,  2.11it/s] 12%|█▏        | 10/86 [00:00<00:03, 22.02it/s] 23%|██▎       | 20/86 [00:00<00:01, 40.51it/s] 35%|███▍      | 30/86 [00:00<00:01, 54.96it/s] 47%|████▋     | 40/86 [00:00<00:00, 65.28it/s] 58%|█████▊    | 50/86 [00:01<00:00, 73.56it/s] 69%|██████▊   | 59/86 [00:01<00:00, 75.32it/s] 80%|████████  | 69/86 [00:01<00:00, 81.50it/s] 92%|█████████▏| 79/86 [00:01<00:00, 86.05it/s]100%|██████████| 86/86 [00:01<00:00, 61.26it/s]
11000 images processed, 1.4206593036651611 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:42,  1.98it/s]  5%|▍         | 10/204 [00:00<00:09, 21.30it/s] 10%|▉         | 20/204 [00:00<00:04, 39.27it/s] 14%|█▍        | 29/204 [00:00<00:03, 51.39it/s] 19%|█▉        | 39/204 [00:00<00:02, 62.95it/s] 24%|██▍       | 49/204 [00:01<00:02, 71.87it/s] 29%|██▉       | 59/204 [00:01<00:01, 78.38it/s] 33%|███▎      | 68/204 [00:01<00:01, 77.63it/s] 38%|███▊      | 77/204 [00:01<00:01, 79.42it/s] 43%|████▎     | 87/204 [00:01<00:01, 83.40it/s] 48%|████▊     | 97/204 [00:01<00:01, 86.29it/s] 52%|█████▏    | 107/204 [00:01<00:01, 88.46it/s] 57%|█████▋    | 117/204 [00:01<00:00, 90.31it/s] 62%|██████▏   | 127/204 [00:01<00:00, 91.70it/s] 67%|██████▋   | 137/204 [00:02<00:00, 92.67it/s] 72%|███████▏  | 147/204 [00:02<00:00, 93.20it/s] 77%|███████▋  | 157/204 [00:02<00:00, 93.80it/s] 82%|████████▏ | 167/204 [00:02<00:00, 94.47it/s] 87%|████████▋ | 177/204 [00:02<00:00, 94.87it/s] 92%|█████████▏| 187/204 [00:02<00:00, 95.51it/s] 97%|█████████▋| 197/204 [00:02<00:00, 95.82it/s]100%|██████████| 204/204 [00:02<00:00, 75.47it/s]
26032 images processed, 2.749128580093384 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:52,  1.48it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.40it/s] 27%|██▋       | 21/79 [00:00<00:01, 33.84it/s] 39%|███▉      | 31/79 [00:01<00:01, 47.29it/s] 52%|█████▏    | 41/79 [00:01<00:00, 58.27it/s] 65%|██████▍   | 51/79 [00:01<00:00, 67.13it/s] 77%|███████▋  | 61/79 [00:01<00:00, 74.81it/s] 90%|████████▉ | 71/79 [00:01<00:00, 80.60it/s]100%|██████████| 79/79 [00:02<00:00, 29.91it/s]
10000 images processed, 2.6791770458221436 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:37,  2.06it/s] 10%|█         | 8/79 [00:00<00:04, 17.47it/s] 23%|██▎       | 18/79 [00:00<00:01, 36.92it/s] 35%|███▌      | 28/79 [00:00<00:00, 52.23it/s] 48%|████▊     | 38/79 [00:00<00:00, 63.48it/s] 61%|██████    | 48/79 [00:01<00:00, 71.93it/s] 73%|███████▎  | 58/79 [00:01<00:00, 78.70it/s] 86%|████████▌ | 68/79 [00:01<00:00, 83.91it/s] 99%|█████████▊| 78/79 [00:01<00:00, 87.68it/s]100%|██████████| 79/79 [00:01<00:00, 59.40it/s]
10000 images processed, 1.349740743637085 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:40,  1.71it/s] 16%|█▌        | 11/70 [00:00<00:02, 20.75it/s] 30%|███       | 21/70 [00:00<00:01, 37.44it/s] 44%|████▍     | 31/70 [00:00<00:00, 51.32it/s] 59%|█████▊    | 41/70 [00:01<00:00, 62.05it/s] 73%|███████▎  | 51/70 [00:01<00:00, 70.89it/s] 87%|████████▋ | 61/70 [00:01<00:00, 78.00it/s]100%|██████████| 70/70 [00:01<00:00, 53.11it/s]
8925 images processed, 1.3464632034301758 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.04it/s]  4%|▍         | 2/45 [00:01<00:20,  2.12it/s] 27%|██▋       | 12/45 [00:01<00:01, 16.69it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.75it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.02it/s] 56%|█████▌    | 25/45 [00:01<00:00, 24.35it/s] 73%|███████▎  | 33/45 [00:02<00:00, 23.84it/s] 82%|████████▏ | 37/45 [00:02<00:00, 25.12it/s]100%|██████████| 45/45 [00:02<00:00, 20.23it/s]
5640 images processed, 2.245767593383789 seconds used

18.531724452972412
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.67  99.67  95.43
places365     45.96  91.79  74.16
LSUN           7.17  98.39  92.05
iSUN          42.14  93.06  81.37
dtd           27.89  95.59  90.39
AVG           24.97  95.70  86.68
[incremental] Overall: 0.8540 New: 0.8700 Old: 0.8540
2.497943878173828
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc2-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<04:07,  1.74it/s]  2%|▏         | 10/430 [00:00<00:21, 19.27it/s]  5%|▍         | 20/430 [00:00<00:11, 36.51it/s]  7%|▋         | 30/430 [00:00<00:07, 50.94it/s]  9%|▉         | 40/430 [00:00<00:06, 62.58it/s] 12%|█▏        | 50/430 [00:01<00:05, 71.74it/s] 14%|█▍        | 60/430 [00:01<00:04, 78.53it/s] 16%|█▋        | 70/430 [00:01<00:04, 83.68it/s] 19%|█▊        | 80/430 [00:01<00:04, 87.39it/s] 21%|██        | 90/430 [00:01<00:03, 90.14it/s] 23%|██▎       | 100/430 [00:01<00:03, 92.17it/s] 26%|██▌       | 110/430 [00:01<00:03, 93.45it/s] 28%|██▊       | 120/430 [00:01<00:03, 94.23it/s] 30%|███       | 130/430 [00:01<00:03, 94.98it/s] 33%|███▎      | 140/430 [00:02<00:03, 95.43it/s] 35%|███▍      | 150/430 [00:02<00:02, 95.82it/s] 37%|███▋      | 160/430 [00:02<00:02, 95.87it/s] 40%|███▉      | 170/430 [00:02<00:02, 96.03it/s] 42%|████▏     | 180/430 [00:02<00:02, 96.13it/s] 44%|████▍     | 190/430 [00:02<00:02, 96.03it/s] 47%|████▋     | 200/430 [00:02<00:02, 96.36it/s] 49%|████▉     | 210/430 [00:02<00:02, 96.26it/s] 51%|█████     | 220/430 [00:02<00:02, 96.36it/s] 53%|█████▎    | 230/430 [00:02<00:02, 96.47it/s] 56%|█████▌    | 240/430 [00:03<00:01, 96.44it/s] 58%|█████▊    | 250/430 [00:03<00:01, 96.55it/s] 60%|██████    | 260/430 [00:03<00:01, 96.69it/s] 63%|██████▎   | 270/430 [00:03<00:01, 96.79it/s] 65%|██████▌   | 280/430 [00:03<00:01, 96.83it/s] 67%|██████▋   | 290/430 [00:03<00:01, 96.68it/s] 70%|██████▉   | 300/430 [00:03<00:01, 96.75it/s] 72%|███████▏  | 310/430 [00:03<00:01, 96.72it/s] 74%|███████▍  | 320/430 [00:03<00:01, 96.66it/s] 77%|███████▋  | 330/430 [00:03<00:01, 96.66it/s] 79%|███████▉  | 340/430 [00:04<00:00, 96.60it/s] 81%|████████▏ | 350/430 [00:04<00:00, 96.62it/s] 84%|████████▎ | 360/430 [00:04<00:00, 96.50it/s] 86%|████████▌ | 370/430 [00:04<00:00, 96.49it/s] 88%|████████▊ | 380/430 [00:04<00:00, 96.53it/s] 91%|█████████ | 390/430 [00:04<00:00, 96.67it/s] 93%|█████████▎| 400/430 [00:04<00:00, 95.98it/s] 95%|█████████▌| 410/430 [00:04<00:00, 96.57it/s] 98%|█████████▊| 420/430 [00:04<00:00, 97.02it/s]100%|██████████| 430/430 [00:05<00:00, 94.84it/s]100%|██████████| 430/430 [00:05<00:00, 85.35it/s]
55000 images processed, 5.158293962478638 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:47,  1.79it/s] 12%|█▏        | 10/86 [00:00<00:03, 19.49it/s] 22%|██▏       | 19/86 [00:00<00:01, 34.89it/s] 33%|███▎      | 28/86 [00:00<00:01, 47.68it/s] 43%|████▎     | 37/86 [00:00<00:00, 58.15it/s] 53%|█████▎    | 46/86 [00:01<00:00, 66.49it/s] 65%|██████▌   | 56/86 [00:01<00:00, 74.04it/s] 77%|███████▋  | 66/86 [00:01<00:00, 79.94it/s] 88%|████████▊ | 76/86 [00:01<00:00, 84.23it/s]100%|██████████| 86/86 [00:01<00:00, 86.34it/s]100%|██████████| 86/86 [00:01<00:00, 57.13it/s]
11000 images processed, 1.5312082767486572 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc2-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:46,  1.91it/s]  5%|▍         | 10/204 [00:00<00:09, 20.37it/s] 10%|▉         | 20/204 [00:00<00:04, 37.79it/s] 15%|█▍        | 30/204 [00:00<00:03, 51.89it/s] 20%|█▉        | 40/204 [00:00<00:02, 62.38it/s] 25%|██▍       | 50/204 [00:01<00:02, 70.61it/s] 29%|██▉       | 59/204 [00:01<00:01, 74.83it/s] 34%|███▍      | 69/204 [00:01<00:01, 79.52it/s] 39%|███▊      | 79/204 [00:01<00:01, 83.29it/s] 43%|████▎     | 88/204 [00:01<00:01, 81.17it/s] 48%|████▊     | 98/204 [00:01<00:01, 83.46it/s] 52%|█████▏    | 107/204 [00:01<00:01, 78.32it/s] 57%|█████▋    | 116/204 [00:01<00:01, 73.51it/s] 61%|██████    | 124/204 [00:02<00:01, 68.59it/s] 65%|██████▍   | 132/204 [00:02<00:01, 61.60it/s] 69%|██████▊   | 140/204 [00:02<00:00, 65.24it/s] 74%|███████▎  | 150/204 [00:02<00:00, 72.22it/s] 78%|███████▊  | 160/204 [00:02<00:00, 78.06it/s] 83%|████████▎ | 170/204 [00:02<00:00, 81.85it/s] 88%|████████▊ | 180/204 [00:02<00:00, 85.68it/s] 93%|█████████▎| 190/204 [00:02<00:00, 88.87it/s] 98%|█████████▊| 200/204 [00:02<00:00, 91.18it/s]100%|██████████| 204/204 [00:02<00:00, 68.31it/s]
26032 images processed, 3.0248911380767822 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:01<02:08,  1.65s/it] 11%|█▏        | 9/79 [00:01<00:10,  6.65it/s] 24%|██▍       | 19/79 [00:01<00:03, 15.70it/s] 32%|███▏      | 25/79 [00:02<00:02, 21.10it/s] 44%|████▍     | 35/79 [00:02<00:01, 32.33it/s] 54%|█████▍    | 43/79 [00:02<00:01, 34.59it/s] 67%|██████▋   | 53/79 [00:02<00:00, 45.34it/s] 77%|███████▋  | 61/79 [00:02<00:00, 46.57it/s] 86%|████████▌ | 68/79 [00:02<00:00, 51.19it/s] 99%|█████████▊| 78/79 [00:02<00:00, 61.56it/s]100%|██████████| 79/79 [00:02<00:00, 28.09it/s]
10000 images processed, 2.8587517738342285 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:42,  1.83it/s]  8%|▊         | 6/79 [00:00<00:06, 11.11it/s] 19%|█▉        | 15/79 [00:00<00:02, 28.25it/s] 32%|███▏      | 25/79 [00:00<00:01, 44.49it/s] 44%|████▍     | 35/79 [00:00<00:00, 57.16it/s] 57%|█████▋    | 45/79 [00:01<00:00, 67.13it/s] 70%|██████▉   | 55/79 [00:01<00:00, 75.18it/s] 82%|████████▏ | 65/79 [00:01<00:00, 81.30it/s] 95%|█████████▍| 75/79 [00:01<00:00, 85.79it/s]100%|██████████| 79/79 [00:01<00:00, 54.70it/s]
10000 images processed, 1.4668428897857666 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.93it/s] 11%|█▏        | 8/70 [00:00<00:03, 16.49it/s] 24%|██▍       | 17/70 [00:00<00:01, 33.58it/s] 39%|███▊      | 27/70 [00:00<00:00, 49.16it/s] 53%|█████▎    | 37/70 [00:00<00:00, 61.26it/s] 67%|██████▋   | 47/70 [00:01<00:00, 70.82it/s] 81%|████████▏ | 57/70 [00:01<00:00, 78.19it/s] 96%|█████████▌| 67/70 [00:01<00:00, 83.63it/s]100%|██████████| 70/70 [00:01<00:00, 54.53it/s]
8925 images processed, 1.3125004768371582 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:47,  1.08s/it]  4%|▍         | 2/45 [00:01<00:24,  1.78it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.38it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.72it/s] 49%|████▉     | 22/45 [00:01<00:01, 15.88it/s] 71%|███████   | 32/45 [00:02<00:00, 27.45it/s] 84%|████████▍ | 38/45 [00:03<00:00, 13.05it/s]100%|██████████| 45/45 [00:03<00:00, 14.39it/s]
5640 images processed, 3.1483359336853027 seconds used

20.19416618347168
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.83  99.32  98.16
places365     72.15  78.55  79.33
LSUN          10.04  97.75  97.87
iSUN          69.01  83.25  86.84
dtd           44.72  89.09  93.66
AVG           39.75  89.59  91.17
Retain-Acc: 0.7299
Forget-as-OOD (retain known vs forget novel):
  FPR: 52.60 AUROC: 89.76 AUIN: 99.44
8.278753757476807
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc2-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc2-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc3-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:34,  2.00it/s]  2%|▏         | 10/430 [00:00<00:19, 21.18it/s]  5%|▍         | 20/430 [00:00<00:10, 39.15it/s]  7%|▋         | 30/430 [00:00<00:07, 53.88it/s]  9%|▉         | 40/430 [00:00<00:06, 64.93it/s] 12%|█▏        | 50/430 [00:01<00:05, 73.56it/s] 14%|█▍        | 60/430 [00:01<00:04, 80.02it/s] 16%|█▋        | 70/430 [00:01<00:04, 84.18it/s] 19%|█▊        | 80/430 [00:01<00:04, 87.40it/s] 21%|██        | 90/430 [00:01<00:03, 89.97it/s] 23%|██▎       | 100/430 [00:01<00:03, 91.85it/s] 26%|██▌       | 110/430 [00:01<00:03, 91.86it/s] 28%|██▊       | 120/430 [00:01<00:03, 93.14it/s] 30%|███       | 130/430 [00:01<00:03, 94.18it/s] 33%|███▎      | 140/430 [00:01<00:03, 94.86it/s] 35%|███▍      | 150/430 [00:02<00:02, 94.73it/s] 37%|███▋      | 160/430 [00:02<00:02, 95.13it/s] 40%|███▉      | 170/430 [00:02<00:02, 95.08it/s] 42%|████▏     | 180/430 [00:02<00:02, 95.46it/s] 44%|████▍     | 190/430 [00:02<00:02, 95.66it/s] 47%|████▋     | 200/430 [00:02<00:02, 95.71it/s] 49%|████▉     | 210/430 [00:02<00:02, 95.99it/s] 51%|█████     | 220/430 [00:02<00:02, 96.03it/s] 53%|█████▎    | 230/430 [00:02<00:02, 95.88it/s] 56%|█████▌    | 240/430 [00:03<00:01, 96.16it/s] 58%|█████▊    | 250/430 [00:03<00:01, 95.98it/s] 60%|██████    | 260/430 [00:03<00:01, 96.24it/s] 63%|██████▎   | 270/430 [00:03<00:01, 96.27it/s] 65%|██████▌   | 280/430 [00:03<00:01, 95.98it/s] 67%|██████▋   | 290/430 [00:03<00:01, 96.09it/s] 70%|██████▉   | 300/430 [00:03<00:01, 95.88it/s] 72%|███████▏  | 310/430 [00:03<00:01, 95.59it/s] 74%|███████▍  | 320/430 [00:03<00:01, 95.66it/s] 77%|███████▋  | 330/430 [00:03<00:01, 95.61it/s] 79%|███████▉  | 340/430 [00:04<00:00, 95.50it/s] 81%|████████▏ | 350/430 [00:04<00:00, 95.07it/s] 84%|████████▎ | 360/430 [00:04<00:00, 94.97it/s] 86%|████████▌ | 370/430 [00:04<00:00, 95.40it/s] 88%|████████▊ | 380/430 [00:04<00:00, 95.68it/s] 91%|█████████ | 390/430 [00:04<00:00, 95.38it/s] 93%|█████████▎| 400/430 [00:04<00:00, 94.56it/s] 95%|█████████▌| 410/430 [00:04<00:00, 95.33it/s] 98%|█████████▊| 420/430 [00:04<00:00, 95.90it/s]100%|██████████| 430/430 [00:05<00:00, 94.01it/s]100%|██████████| 430/430 [00:05<00:00, 85.83it/s]
55000 images processed, 5.050190448760986 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:35,  2.39it/s]  7%|▋         | 6/86 [00:00<00:05, 13.67it/s] 16%|█▋        | 14/86 [00:00<00:02, 29.92it/s] 27%|██▋       | 23/86 [00:00<00:01, 45.54it/s] 38%|███▊      | 33/86 [00:00<00:00, 58.65it/s] 50%|█████     | 43/86 [00:00<00:00, 68.38it/s] 62%|██████▏   | 53/86 [00:01<00:00, 75.94it/s] 73%|███████▎  | 63/86 [00:01<00:00, 81.55it/s] 85%|████████▍ | 73/86 [00:01<00:00, 85.82it/s] 97%|█████████▋| 83/86 [00:01<00:00, 89.09it/s]100%|██████████| 86/86 [00:01<00:00, 60.37it/s]
11000 images processed, 1.4397106170654297 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:37,  2.08it/s]  5%|▌         | 11/204 [00:00<00:08, 23.98it/s] 10%|█         | 21/204 [00:00<00:04, 41.83it/s] 15%|█▌        | 31/204 [00:00<00:03, 55.77it/s] 20%|██        | 41/204 [00:00<00:02, 66.01it/s] 25%|██▌       | 51/204 [00:01<00:02, 72.70it/s] 30%|██▉       | 61/204 [00:01<00:01, 78.96it/s] 35%|███▍      | 71/204 [00:01<00:01, 83.59it/s] 40%|███▉      | 81/204 [00:01<00:01, 86.65it/s] 45%|████▍     | 91/204 [00:01<00:01, 88.81it/s] 50%|████▉     | 101/204 [00:01<00:01, 90.40it/s] 54%|█████▍    | 111/204 [00:01<00:01, 91.43it/s] 59%|█████▉    | 121/204 [00:01<00:00, 89.52it/s] 64%|██████▍   | 131/204 [00:01<00:00, 90.38it/s] 69%|██████▉   | 141/204 [00:01<00:00, 91.39it/s] 74%|███████▍  | 151/204 [00:02<00:00, 92.22it/s] 79%|███████▉  | 161/204 [00:02<00:00, 92.77it/s] 84%|████████▍ | 171/204 [00:02<00:00, 93.14it/s] 89%|████████▊ | 181/204 [00:02<00:00, 93.91it/s] 94%|█████████▎| 191/204 [00:02<00:00, 94.75it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.33it/s]100%|██████████| 204/204 [00:02<00:00, 76.84it/s]
26032 images processed, 2.694519281387329 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.66it/s] 11%|█▏        | 9/79 [00:00<00:04, 16.55it/s] 23%|██▎       | 18/79 [00:00<00:01, 32.17it/s] 35%|███▌      | 28/79 [00:00<00:01, 47.06it/s] 46%|████▌     | 36/79 [00:01<00:00, 45.38it/s] 58%|█████▊    | 46/79 [00:01<00:00, 56.28it/s] 71%|███████   | 56/79 [00:01<00:00, 65.15it/s] 82%|████████▏ | 65/79 [00:01<00:00, 70.48it/s] 95%|█████████▍| 75/79 [00:01<00:00, 77.44it/s]100%|██████████| 79/79 [00:02<00:00, 30.19it/s]
10000 images processed, 2.6592330932617188 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.95it/s] 14%|█▍        | 11/79 [00:00<00:02, 22.93it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.51it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.72it/s] 52%|█████▏    | 41/79 [00:00<00:00, 65.68it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.69it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.19it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.05it/s]100%|██████████| 79/79 [00:01<00:00, 59.75it/s]
10000 images processed, 1.342939853668213 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  1.99it/s] 10%|█         | 7/70 [00:00<00:04, 14.59it/s] 24%|██▍       | 17/70 [00:00<00:01, 34.24it/s] 39%|███▊      | 27/70 [00:00<00:00, 49.82it/s] 53%|█████▎    | 37/70 [00:00<00:00, 61.80it/s] 67%|██████▋   | 47/70 [00:01<00:00, 71.28it/s] 81%|████████▏ | 57/70 [00:01<00:00, 78.48it/s] 96%|█████████▌| 67/70 [00:01<00:00, 83.84it/s]100%|██████████| 70/70 [00:01<00:00, 54.85it/s]
8925 images processed, 1.3125157356262207 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.07it/s]  4%|▍         | 2/45 [00:01<00:19,  2.25it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.68it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.44it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.87it/s] 56%|█████▌    | 25/45 [00:01<00:00, 25.35it/s] 73%|███████▎  | 33/45 [00:01<00:00, 23.12it/s] 89%|████████▉ | 40/45 [00:02<00:00, 30.49it/s]100%|██████████| 45/45 [00:02<00:00, 21.03it/s]
5640 images processed, 2.1623106002807617 seconds used

18.298823595046997
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.67  99.67  95.43
places365     45.96  91.79  74.16
LSUN           7.17  98.39  92.05
iSUN          42.14  93.06  81.37
dtd           27.89  95.59  90.39
AVG           24.97  95.70  86.68
[incremental] Overall: 0.8540 New: 0.8480 Old: 0.8540
2.263576030731201
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc3-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<02:59,  2.39it/s]  2%|▏         | 7/430 [00:00<00:24, 16.95it/s]  4%|▍         | 17/430 [00:00<00:10, 38.03it/s]  6%|▌         | 26/430 [00:00<00:07, 51.70it/s]  8%|▊         | 36/430 [00:00<00:06, 63.43it/s] 11%|█         | 46/430 [00:00<00:05, 72.24it/s] 13%|█▎        | 56/430 [00:01<00:04, 78.32it/s] 15%|█▌        | 66/430 [00:01<00:04, 82.51it/s] 17%|█▋        | 75/430 [00:01<00:04, 84.22it/s] 20%|█▉        | 85/430 [00:01<00:03, 87.31it/s] 22%|██▏       | 95/430 [00:01<00:03, 89.70it/s] 24%|██▍       | 105/430 [00:01<00:03, 91.55it/s] 27%|██▋       | 115/430 [00:01<00:03, 92.88it/s] 29%|██▉       | 125/430 [00:01<00:03, 94.08it/s] 31%|███▏      | 135/430 [00:01<00:03, 94.95it/s] 34%|███▎      | 145/430 [00:01<00:02, 95.41it/s] 36%|███▌      | 155/430 [00:02<00:02, 95.53it/s] 38%|███▊      | 165/430 [00:02<00:02, 95.96it/s] 41%|████      | 175/430 [00:02<00:02, 96.13it/s] 43%|████▎     | 185/430 [00:02<00:02, 96.42it/s] 45%|████▌     | 195/430 [00:02<00:02, 96.57it/s] 48%|████▊     | 205/430 [00:02<00:04, 52.99it/s] 50%|█████     | 215/430 [00:03<00:03, 61.30it/s] 52%|█████▏    | 225/430 [00:03<00:02, 68.80it/s] 55%|█████▍    | 235/430 [00:03<00:02, 75.30it/s] 57%|█████▋    | 245/430 [00:03<00:02, 80.55it/s] 59%|█████▉    | 255/430 [00:03<00:02, 84.72it/s] 62%|██████▏   | 265/430 [00:03<00:01, 87.92it/s] 64%|██████▍   | 275/430 [00:03<00:01, 90.42it/s] 66%|██████▋   | 285/430 [00:03<00:01, 92.09it/s] 69%|██████▊   | 295/430 [00:03<00:01, 93.19it/s] 71%|███████   | 305/430 [00:03<00:01, 93.74it/s] 73%|███████▎  | 315/430 [00:04<00:01, 94.46it/s] 76%|███████▌  | 325/430 [00:04<00:01, 95.10it/s] 78%|███████▊  | 335/430 [00:04<00:00, 95.50it/s] 80%|████████  | 345/430 [00:04<00:00, 95.75it/s] 83%|████████▎ | 355/430 [00:04<00:00, 96.14it/s] 85%|████████▍ | 365/430 [00:04<00:00, 96.36it/s] 87%|████████▋ | 375/430 [00:04<00:00, 96.36it/s] 90%|████████▉ | 385/430 [00:04<00:00, 96.40it/s] 92%|█████████▏| 395/430 [00:04<00:00, 96.58it/s] 94%|█████████▍| 405/430 [00:04<00:00, 96.32it/s] 97%|█████████▋| 415/430 [00:05<00:00, 96.90it/s] 99%|█████████▉| 425/430 [00:05<00:00, 97.31it/s]100%|██████████| 430/430 [00:05<00:00, 82.07it/s]
55000 images processed, 5.333112478256226 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:36,  2.34it/s]  9%|▉         | 8/86 [00:00<00:04, 19.04it/s] 19%|█▊        | 16/86 [00:00<00:02, 34.84it/s] 29%|██▉       | 25/86 [00:00<00:01, 48.88it/s] 38%|███▊      | 33/86 [00:00<00:00, 55.81it/s] 49%|████▉     | 42/86 [00:00<00:00, 63.48it/s] 60%|██████    | 52/86 [00:01<00:00, 71.73it/s] 72%|███████▏  | 62/86 [00:01<00:00, 78.25it/s] 84%|████████▎ | 72/86 [00:01<00:00, 83.03it/s] 95%|█████████▌| 82/86 [00:01<00:00, 86.17it/s]100%|██████████| 86/86 [00:01<00:00, 59.87it/s]
11000 images processed, 1.4618825912475586 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc3-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:35,  2.13it/s]  5%|▌         | 11/204 [00:00<00:07, 24.51it/s] 10%|█         | 21/204 [00:00<00:04, 42.61it/s] 15%|█▌        | 31/204 [00:00<00:03, 56.62it/s] 20%|██        | 41/204 [00:00<00:02, 67.41it/s] 25%|██▌       | 51/204 [00:00<00:02, 74.87it/s] 30%|██▉       | 61/204 [00:01<00:01, 79.91it/s] 35%|███▍      | 71/204 [00:01<00:01, 84.34it/s] 40%|███▉      | 81/204 [00:01<00:01, 87.10it/s] 45%|████▍     | 91/204 [00:01<00:01, 89.31it/s] 50%|████▉     | 101/204 [00:01<00:01, 90.66it/s] 54%|█████▍    | 111/204 [00:01<00:01, 91.87it/s] 59%|█████▉    | 121/204 [00:01<00:00, 92.60it/s] 64%|██████▍   | 131/204 [00:01<00:00, 93.12it/s] 69%|██████▉   | 141/204 [00:01<00:00, 93.23it/s] 74%|███████▍  | 151/204 [00:02<00:00, 93.55it/s] 79%|███████▉  | 161/204 [00:02<00:00, 93.86it/s] 84%|████████▍ | 171/204 [00:02<00:00, 93.96it/s] 89%|████████▊ | 181/204 [00:02<00:00, 94.62it/s] 94%|█████████▎| 191/204 [00:02<00:00, 95.40it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.84it/s]100%|██████████| 204/204 [00:02<00:00, 77.92it/s]
26032 images processed, 2.65838623046875 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:52,  1.50it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.68it/s] 27%|██▋       | 21/79 [00:00<00:01, 34.59it/s] 38%|███▊      | 30/79 [00:00<00:01, 46.57it/s] 51%|█████     | 40/79 [00:01<00:00, 58.59it/s] 62%|██████▏   | 49/79 [00:01<00:00, 66.14it/s] 75%|███████▍  | 59/79 [00:01<00:00, 73.84it/s] 87%|████████▋ | 69/79 [00:01<00:00, 80.19it/s]100%|██████████| 79/79 [00:02<00:00, 22.49it/s]100%|██████████| 79/79 [00:02<00:00, 31.44it/s]
10000 images processed, 2.5820276737213135 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.74it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.92it/s] 25%|██▌       | 20/79 [00:00<00:01, 35.83it/s] 38%|███▊      | 30/79 [00:00<00:00, 49.92it/s] 51%|█████     | 40/79 [00:01<00:00, 61.21it/s] 63%|██████▎   | 50/79 [00:01<00:00, 69.64it/s] 76%|███████▌  | 60/79 [00:01<00:00, 77.03it/s] 89%|████████▊ | 70/79 [00:01<00:00, 82.62it/s]100%|██████████| 79/79 [00:01<00:00, 56.27it/s]
10000 images processed, 1.424856424331665 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.76it/s] 13%|█▎        | 9/70 [00:00<00:03, 17.43it/s] 27%|██▋       | 19/70 [00:00<00:01, 35.10it/s] 41%|████▏     | 29/70 [00:00<00:00, 49.76it/s] 56%|█████▌    | 39/70 [00:00<00:00, 61.30it/s] 70%|███████   | 49/70 [00:01<00:00, 70.83it/s] 84%|████████▍ | 59/70 [00:01<00:00, 78.08it/s] 99%|█████████▊| 69/70 [00:01<00:00, 83.45it/s]100%|██████████| 70/70 [00:01<00:00, 53.19it/s]
8925 images processed, 1.3471002578735352 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.10it/s]  4%|▍         | 2/45 [00:01<00:20,  2.13it/s] 27%|██▋       | 12/45 [00:01<00:01, 16.77it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.76it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.67it/s] 56%|█████▌    | 25/45 [00:01<00:00, 24.46it/s] 73%|███████▎  | 33/45 [00:01<00:00, 24.25it/s] 82%|████████▏ | 37/45 [00:02<00:00, 25.20it/s]100%|██████████| 45/45 [00:02<00:00, 20.61it/s]
5640 images processed, 2.20487642288208 seconds used

18.716979503631592
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.84  99.32  98.16
places365     71.78  78.68  79.54
LSUN          11.88  97.29  97.37
iSUN          69.92  82.65  86.42
dtd           45.39  88.95  93.63
AVG           40.36  89.38  91.02
Retain-Acc: 0.7395
Forget-as-OOD (retain known vs forget novel):
  FPR: 71.20 AUROC: 86.13 AUIN: 99.24
8.245045185089111
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc3-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc3-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc4-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:19,  2.15it/s]  2%|▏         | 10/430 [00:00<00:18, 22.57it/s]  4%|▍         | 19/430 [00:00<00:10, 39.08it/s]  7%|▋         | 29/430 [00:00<00:07, 53.94it/s]  9%|▉         | 39/430 [00:00<00:05, 65.19it/s] 11%|█▏        | 49/430 [00:00<00:05, 73.88it/s] 14%|█▎        | 59/430 [00:01<00:04, 79.98it/s] 16%|█▌        | 69/430 [00:01<00:04, 84.39it/s] 18%|█▊        | 79/430 [00:01<00:04, 87.70it/s] 21%|██        | 89/430 [00:01<00:03, 90.28it/s] 23%|██▎       | 99/430 [00:01<00:03, 91.72it/s] 25%|██▌       | 109/430 [00:01<00:03, 92.65it/s] 28%|██▊       | 119/430 [00:01<00:03, 93.51it/s] 30%|███       | 129/430 [00:01<00:03, 94.30it/s] 32%|███▏      | 139/430 [00:01<00:03, 94.65it/s] 35%|███▍      | 149/430 [00:02<00:02, 95.04it/s] 37%|███▋      | 159/430 [00:02<00:02, 95.44it/s] 39%|███▉      | 169/430 [00:02<00:02, 95.23it/s] 42%|████▏     | 179/430 [00:02<00:02, 95.52it/s] 44%|████▍     | 189/430 [00:02<00:02, 95.78it/s] 46%|████▋     | 199/430 [00:02<00:02, 95.64it/s] 49%|████▊     | 209/430 [00:02<00:02, 94.72it/s] 51%|█████     | 219/430 [00:02<00:02, 95.11it/s] 53%|█████▎    | 229/430 [00:02<00:02, 95.41it/s] 56%|█████▌    | 239/430 [00:02<00:02, 94.15it/s] 58%|█████▊    | 249/430 [00:03<00:01, 94.81it/s] 60%|██████    | 259/430 [00:03<00:01, 94.67it/s] 63%|██████▎   | 269/430 [00:03<00:01, 95.18it/s] 65%|██████▍   | 279/430 [00:03<00:01, 95.08it/s] 67%|██████▋   | 289/430 [00:03<00:01, 95.19it/s] 70%|██████▉   | 299/430 [00:03<00:01, 95.46it/s] 72%|███████▏  | 309/430 [00:03<00:01, 95.60it/s] 74%|███████▍  | 319/430 [00:03<00:01, 95.63it/s] 77%|███████▋  | 329/430 [00:03<00:01, 94.68it/s] 79%|███████▉  | 339/430 [00:04<00:00, 94.98it/s] 81%|████████  | 349/430 [00:04<00:00, 94.77it/s] 83%|████████▎ | 359/430 [00:04<00:00, 95.19it/s] 86%|████████▌ | 369/430 [00:04<00:00, 95.56it/s] 88%|████████▊ | 379/430 [00:04<00:00, 95.95it/s] 90%|█████████ | 389/430 [00:04<00:00, 95.87it/s] 93%|█████████▎| 399/430 [00:04<00:00, 95.43it/s] 95%|█████████▌| 409/430 [00:04<00:00, 96.26it/s] 97%|█████████▋| 419/430 [00:04<00:00, 96.84it/s]100%|█████████▉| 429/430 [00:04<00:00, 97.20it/s]100%|██████████| 430/430 [00:04<00:00, 86.24it/s]
55000 images processed, 5.0316784381866455 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:33,  2.57it/s]  7%|▋         | 6/86 [00:00<00:05, 15.15it/s] 17%|█▋        | 15/86 [00:00<00:01, 35.69it/s] 29%|██▉       | 25/86 [00:00<00:01, 52.67it/s] 41%|████      | 35/86 [00:00<00:00, 65.35it/s] 52%|█████▏    | 45/86 [00:00<00:00, 74.30it/s] 64%|██████▍   | 55/86 [00:01<00:00, 80.48it/s] 76%|███████▌  | 65/86 [00:01<00:00, 85.44it/s] 87%|████████▋ | 75/86 [00:01<00:00, 88.96it/s] 99%|█████████▉| 85/86 [00:01<00:00, 91.40it/s]100%|██████████| 86/86 [00:01<00:00, 64.31it/s]
11000 images processed, 1.3530144691467285 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:39,  2.04it/s]  5%|▍         | 10/204 [00:00<00:08, 21.82it/s]  9%|▉         | 19/204 [00:00<00:04, 38.28it/s] 14%|█▍        | 29/204 [00:00<00:03, 52.82it/s] 19%|█▉        | 39/204 [00:00<00:02, 64.03it/s] 24%|██▍       | 49/204 [00:01<00:02, 72.20it/s] 29%|██▉       | 59/204 [00:01<00:01, 77.82it/s] 34%|███▍      | 69/204 [00:01<00:01, 82.46it/s] 39%|███▊      | 79/204 [00:01<00:01, 85.97it/s] 44%|████▎     | 89/204 [00:01<00:01, 88.52it/s] 49%|████▊     | 99/204 [00:01<00:01, 89.32it/s] 53%|█████▎    | 109/204 [00:01<00:01, 89.07it/s] 58%|█████▊    | 119/204 [00:01<00:00, 90.85it/s] 63%|██████▎   | 129/204 [00:01<00:00, 92.12it/s] 68%|██████▊   | 139/204 [00:01<00:00, 92.78it/s] 73%|███████▎  | 149/204 [00:02<00:00, 93.69it/s] 78%|███████▊  | 159/204 [00:02<00:00, 92.51it/s] 83%|████████▎ | 169/204 [00:02<00:00, 89.69it/s] 88%|████████▊ | 179/204 [00:02<00:00, 89.55it/s] 93%|█████████▎| 189/204 [00:02<00:00, 91.77it/s] 98%|█████████▊| 199/204 [00:02<00:00, 93.19it/s]100%|██████████| 204/204 [00:02<00:00, 75.79it/s]
26032 images processed, 2.7307817935943604 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.59it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.51it/s] 27%|██▋       | 21/79 [00:00<00:01, 35.67it/s] 39%|███▉      | 31/79 [00:00<00:00, 49.45it/s] 52%|█████▏    | 41/79 [00:01<00:00, 60.73it/s] 65%|██████▍   | 51/79 [00:01<00:00, 69.70it/s] 77%|███████▋  | 61/79 [00:01<00:00, 76.85it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.24it/s]100%|██████████| 79/79 [00:01<00:00, 54.15it/s]
10000 images processed, 1.4924771785736084 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.98it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.36it/s] 25%|██▌       | 20/79 [00:00<00:01, 39.68it/s] 38%|███▊      | 30/79 [00:00<00:00, 54.00it/s] 51%|█████     | 40/79 [00:00<00:00, 64.50it/s] 63%|██████▎   | 50/79 [00:01<00:00, 72.89it/s] 76%|███████▌  | 60/79 [00:01<00:00, 79.68it/s] 89%|████████▊ | 70/79 [00:01<00:00, 84.69it/s]100%|██████████| 79/79 [00:01<00:00, 59.67it/s]
10000 images processed, 1.3444209098815918 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:37,  1.85it/s] 16%|█▌        | 11/70 [00:00<00:02, 22.05it/s] 30%|███       | 21/70 [00:00<00:01, 39.21it/s] 44%|████▍     | 31/70 [00:00<00:00, 53.21it/s] 59%|█████▊    | 41/70 [00:00<00:00, 64.22it/s] 73%|███████▎  | 51/70 [00:01<00:00, 73.02it/s] 87%|████████▋ | 61/70 [00:01<00:00, 79.80it/s]100%|██████████| 70/70 [00:01<00:00, 55.20it/s]
8925 images processed, 1.301927089691162 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.13it/s]  4%|▍         | 2/45 [00:01<00:19,  2.20it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.20it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.83it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.79it/s] 56%|█████▌    | 25/45 [00:01<00:00, 24.63it/s] 73%|███████▎  | 33/45 [00:01<00:00, 24.34it/s] 82%|████████▏ | 37/45 [00:02<00:00, 24.50it/s]100%|██████████| 45/45 [00:02<00:00, 20.66it/s]
5640 images processed, 2.1997950077056885 seconds used

17.1250216960907
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.36  99.73  96.80
places365     44.41  91.34  74.60
LSUN           5.66  98.65  94.17
iSUN          40.47  93.14  83.76
dtd           24.66  95.99  92.38
AVG           23.31  95.77  88.34
[incremental] Overall: 0.8365 New: 0.8360 Old: 0.8367
2.512725591659546
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc4-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:21,  2.13it/s]  2%|▏         | 10/430 [00:00<00:18, 22.35it/s]  4%|▍         | 19/430 [00:00<00:10, 38.74it/s]  6%|▋         | 27/430 [00:00<00:08, 49.41it/s]  8%|▊         | 35/430 [00:00<00:06, 57.33it/s] 10%|█         | 45/430 [00:00<00:05, 67.20it/s] 13%|█▎        | 55/430 [00:01<00:05, 74.97it/s] 15%|█▌        | 65/430 [00:01<00:04, 80.77it/s] 17%|█▋        | 75/430 [00:01<00:04, 85.38it/s] 20%|█▉        | 85/430 [00:01<00:03, 88.15it/s] 22%|██▏       | 95/430 [00:01<00:03, 90.44it/s] 24%|██▍       | 105/430 [00:01<00:03, 92.32it/s] 27%|██▋       | 115/430 [00:01<00:03, 93.62it/s] 29%|██▉       | 125/430 [00:01<00:03, 94.54it/s] 31%|███▏      | 135/430 [00:01<00:03, 95.25it/s] 34%|███▎      | 145/430 [00:02<00:02, 95.48it/s] 36%|███▌      | 155/430 [00:02<00:02, 95.95it/s] 38%|███▊      | 165/430 [00:02<00:02, 96.04it/s] 41%|████      | 175/430 [00:02<00:02, 96.24it/s] 43%|████▎     | 185/430 [00:02<00:02, 96.51it/s] 45%|████▌     | 195/430 [00:02<00:02, 96.64it/s] 48%|████▊     | 205/430 [00:02<00:02, 96.63it/s] 50%|█████     | 215/430 [00:02<00:02, 96.46it/s] 52%|█████▏    | 225/430 [00:02<00:02, 96.48it/s] 55%|█████▍    | 235/430 [00:02<00:02, 96.52it/s] 57%|█████▋    | 245/430 [00:03<00:01, 96.50it/s] 59%|█████▉    | 255/430 [00:03<00:01, 96.43it/s] 62%|██████▏   | 265/430 [00:03<00:01, 96.47it/s] 64%|██████▍   | 275/430 [00:03<00:01, 96.40it/s] 66%|██████▋   | 285/430 [00:03<00:01, 96.52it/s] 69%|██████▊   | 295/430 [00:03<00:01, 96.33it/s] 71%|███████   | 305/430 [00:03<00:01, 96.57it/s] 73%|███████▎  | 315/430 [00:03<00:01, 96.65it/s] 76%|███████▌  | 325/430 [00:03<00:01, 96.59it/s] 78%|███████▊  | 335/430 [00:04<00:00, 96.35it/s] 80%|████████  | 345/430 [00:04<00:00, 96.31it/s] 83%|████████▎ | 355/430 [00:04<00:00, 96.56it/s] 85%|████████▍ | 365/430 [00:04<00:00, 96.03it/s] 87%|████████▋ | 375/430 [00:04<00:00, 95.90it/s] 90%|████████▉ | 385/430 [00:04<00:00, 96.13it/s] 92%|█████████▏| 395/430 [00:04<00:00, 96.39it/s] 94%|█████████▍| 405/430 [00:04<00:00, 95.97it/s] 97%|█████████▋| 415/430 [00:04<00:00, 96.62it/s] 99%|█████████▉| 425/430 [00:04<00:00, 97.09it/s]100%|██████████| 430/430 [00:04<00:00, 86.09it/s]
55000 images processed, 5.103108882904053 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:35,  2.38it/s] 12%|█▏        | 10/86 [00:00<00:03, 24.02it/s] 22%|██▏       | 19/86 [00:00<00:01, 40.43it/s] 34%|███▎      | 29/86 [00:00<00:01, 55.11it/s] 44%|████▍     | 38/86 [00:00<00:00, 64.18it/s] 56%|█████▌    | 48/86 [00:00<00:00, 72.29it/s] 67%|██████▋   | 58/86 [00:01<00:00, 78.33it/s] 79%|███████▉  | 68/86 [00:01<00:00, 82.97it/s] 91%|█████████ | 78/86 [00:01<00:00, 86.26it/s]100%|██████████| 86/86 [00:01<00:00, 62.89it/s]
11000 images processed, 1.3929946422576904 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc4-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:38,  2.05it/s]  5%|▌         | 11/204 [00:00<00:08, 23.94it/s] 10%|█         | 21/204 [00:00<00:04, 41.75it/s] 15%|█▌        | 31/204 [00:00<00:03, 55.85it/s] 20%|██        | 41/204 [00:00<00:02, 65.98it/s] 25%|██▌       | 51/204 [00:01<00:02, 72.93it/s] 29%|██▉       | 60/204 [00:01<00:01, 77.40it/s] 34%|███▍      | 69/204 [00:01<00:01, 80.81it/s] 39%|███▊      | 79/204 [00:01<00:01, 84.76it/s] 44%|████▎     | 89/204 [00:01<00:01, 87.34it/s] 49%|████▊     | 99/204 [00:01<00:01, 89.13it/s] 53%|█████▎    | 109/204 [00:01<00:01, 90.72it/s] 58%|█████▊    | 119/204 [00:01<00:00, 91.75it/s] 63%|██████▎   | 129/204 [00:01<00:00, 92.88it/s] 68%|██████▊   | 139/204 [00:01<00:00, 93.75it/s] 73%|███████▎  | 149/204 [00:02<00:00, 94.43it/s] 78%|███████▊  | 159/204 [00:02<00:00, 94.93it/s] 83%|████████▎ | 169/204 [00:02<00:00, 95.23it/s] 88%|████████▊ | 179/204 [00:02<00:00, 95.62it/s] 93%|█████████▎| 189/204 [00:02<00:00, 96.09it/s] 98%|█████████▊| 199/204 [00:02<00:00, 96.37it/s]100%|██████████| 204/204 [00:02<00:00, 77.15it/s]
26032 images processed, 2.685343027114868 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.60it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.66it/s] 25%|██▌       | 20/79 [00:00<00:01, 33.82it/s] 38%|███▊      | 30/79 [00:00<00:01, 47.92it/s] 51%|█████     | 40/79 [00:01<00:00, 58.73it/s] 62%|██████▏   | 49/79 [00:01<00:00, 65.56it/s] 75%|███████▍  | 59/79 [00:01<00:00, 73.45it/s] 87%|████████▋ | 69/79 [00:01<00:00, 79.79it/s]100%|██████████| 79/79 [00:02<00:00, 22.63it/s]100%|██████████| 79/79 [00:02<00:00, 31.83it/s]
10000 images processed, 2.546220064163208 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.00it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.54it/s] 25%|██▌       | 20/79 [00:00<00:01, 39.93it/s] 38%|███▊      | 30/79 [00:00<00:00, 54.60it/s] 51%|█████     | 40/79 [00:00<00:00, 65.48it/s] 62%|██████▏   | 49/79 [00:01<00:00, 71.44it/s] 75%|███████▍  | 59/79 [00:01<00:00, 78.67it/s] 87%|████████▋ | 69/79 [00:01<00:00, 83.90it/s]100%|██████████| 79/79 [00:01<00:00, 59.73it/s]
10000 images processed, 1.3478612899780273 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:32,  2.10it/s] 14%|█▍        | 10/70 [00:00<00:02, 22.15it/s] 27%|██▋       | 19/70 [00:00<00:01, 37.94it/s] 41%|████▏     | 29/70 [00:00<00:00, 52.50it/s] 56%|█████▌    | 39/70 [00:00<00:00, 62.98it/s] 70%|███████   | 49/70 [00:01<00:00, 71.08it/s] 84%|████████▍ | 59/70 [00:01<00:00, 78.30it/s] 99%|█████████▊| 69/70 [00:01<00:00, 83.62it/s]100%|██████████| 70/70 [00:01<00:00, 56.39it/s]
8925 images processed, 1.2718627452850342 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.11it/s]  4%|▍         | 2/45 [00:01<00:18,  2.32it/s] 27%|██▋       | 12/45 [00:01<00:01, 18.11it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.56it/s] 51%|█████     | 23/45 [00:01<00:00, 22.42it/s] 71%|███████   | 32/45 [00:01<00:00, 34.19it/s] 84%|████████▍ | 38/45 [00:02<00:00, 25.29it/s]100%|██████████| 45/45 [00:02<00:00, 21.35it/s]
5640 images processed, 2.127882957458496 seconds used

18.090871810913086
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.91  99.30  98.11
places365     72.05  78.53  79.46
LSUN          11.98  97.24  97.33
iSUN          70.58  82.53  86.28
dtd           45.78  88.84  93.55
AVG           40.66  89.29  90.95
Retain-Acc: 0.7349
Forget-as-OOD (retain known vs forget novel):
  FPR: 66.20 AUROC: 87.63 AUIN: 99.32
8.196664094924927
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc4-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-inc4-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:11,  2.24it/s]  2%|▏         | 8/430 [00:00<00:23, 18.26it/s]  4%|▍         | 18/430 [00:00<00:10, 37.89it/s]  6%|▋         | 27/430 [00:00<00:07, 51.35it/s]  9%|▊         | 37/430 [00:00<00:06, 63.13it/s] 11%|█         | 47/430 [00:00<00:05, 72.25it/s] 13%|█▎        | 57/430 [00:01<00:04, 79.26it/s] 16%|█▌        | 67/430 [00:01<00:04, 84.22it/s] 18%|█▊        | 77/430 [00:01<00:04, 87.92it/s] 20%|██        | 87/430 [00:01<00:03, 90.35it/s] 23%|██▎       | 97/430 [00:01<00:03, 92.11it/s] 25%|██▍       | 107/430 [00:01<00:03, 93.43it/s] 27%|██▋       | 117/430 [00:01<00:03, 94.35it/s] 30%|██▉       | 127/430 [00:01<00:03, 94.98it/s] 32%|███▏      | 137/430 [00:01<00:03, 95.40it/s] 34%|███▍      | 147/430 [00:02<00:02, 95.71it/s] 37%|███▋      | 157/430 [00:02<00:02, 95.94it/s] 39%|███▉      | 167/430 [00:02<00:02, 96.23it/s] 41%|████      | 177/430 [00:02<00:02, 96.31it/s] 43%|████▎     | 187/430 [00:02<00:02, 96.41it/s] 46%|████▌     | 197/430 [00:02<00:02, 96.27it/s] 48%|████▊     | 207/430 [00:02<00:02, 96.38it/s] 50%|█████     | 217/430 [00:02<00:02, 96.43it/s] 53%|█████▎    | 227/430 [00:02<00:02, 96.54it/s] 55%|█████▌    | 237/430 [00:02<00:01, 96.50it/s] 57%|█████▋    | 247/430 [00:03<00:01, 96.48it/s] 60%|█████▉    | 257/430 [00:03<00:01, 96.49it/s] 62%|██████▏   | 267/430 [00:03<00:01, 96.59it/s] 64%|██████▍   | 277/430 [00:03<00:01, 96.62it/s] 67%|██████▋   | 287/430 [00:03<00:01, 96.59it/s] 69%|██████▉   | 297/430 [00:03<00:01, 96.44it/s] 71%|███████▏  | 307/430 [00:03<00:01, 96.51it/s] 74%|███████▎  | 317/430 [00:03<00:01, 96.47it/s] 76%|███████▌  | 327/430 [00:03<00:01, 96.49it/s] 78%|███████▊  | 337/430 [00:03<00:00, 96.30it/s] 81%|████████  | 347/430 [00:04<00:00, 96.39it/s] 83%|████████▎ | 357/430 [00:04<00:00, 96.38it/s] 85%|████████▌ | 367/430 [00:04<00:00, 96.23it/s] 88%|████████▊ | 377/430 [00:04<00:00, 96.41it/s] 90%|█████████ | 387/430 [00:04<00:00, 96.26it/s] 92%|█████████▏| 397/430 [00:04<00:00, 96.38it/s] 95%|█████████▍| 407/430 [00:04<00:00, 96.37it/s] 97%|█████████▋| 417/430 [00:04<00:00, 96.89it/s] 99%|█████████▉| 427/430 [00:04<00:00, 97.16it/s]100%|██████████| 430/430 [00:04<00:00, 86.76it/s]
55000 images processed, 5.002985954284668 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:38,  2.23it/s] 10%|█         | 9/86 [00:00<00:03, 20.91it/s] 21%|██        | 18/86 [00:00<00:02, 25.48it/s] 31%|███▏      | 27/86 [00:00<00:01, 37.92it/s] 43%|████▎     | 37/86 [00:01<00:00, 50.38it/s] 55%|█████▍    | 47/86 [00:01<00:00, 60.75it/s] 66%|██████▋   | 57/86 [00:01<00:00, 68.83it/s] 78%|███████▊  | 67/86 [00:01<00:00, 76.30it/s] 90%|████████▉ | 77/86 [00:01<00:00, 82.00it/s]100%|██████████| 86/86 [00:01<00:00, 54.39it/s]
11000 images processed, 1.5967738628387451 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:49,  1.86it/s]  4%|▍         | 9/204 [00:00<00:10, 18.23it/s]  9%|▉         | 18/204 [00:00<00:05, 34.27it/s] 14%|█▎        | 28/204 [00:00<00:03, 49.43it/s] 19%|█▊        | 38/204 [00:00<00:02, 61.61it/s] 24%|██▎       | 48/204 [00:01<00:02, 70.81it/s] 28%|██▊       | 58/204 [00:01<00:01, 77.78it/s] 33%|███▎      | 68/204 [00:01<00:01, 82.53it/s] 38%|███▊      | 78/204 [00:01<00:01, 86.28it/s] 43%|████▎     | 88/204 [00:01<00:01, 88.92it/s] 48%|████▊     | 98/204 [00:01<00:01, 90.50it/s] 53%|█████▎    | 108/204 [00:01<00:01, 88.34it/s] 58%|█████▊    | 118/204 [00:01<00:01, 83.58it/s] 63%|██████▎   | 128/204 [00:01<00:00, 86.35it/s] 67%|██████▋   | 137/204 [00:02<00:00, 86.69it/s] 72%|███████▏  | 147/204 [00:02<00:00, 89.31it/s] 77%|███████▋  | 157/204 [00:02<00:00, 88.72it/s] 81%|████████▏ | 166/204 [00:02<00:00, 87.95it/s] 86%|████████▌ | 175/204 [00:02<00:00, 86.90it/s] 91%|█████████ | 185/204 [00:02<00:00, 89.86it/s] 96%|█████████▌| 195/204 [00:02<00:00, 92.04it/s]100%|██████████| 204/204 [00:02<00:00, 73.26it/s]
26032 images processed, 2.8229000568389893 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.61it/s] 13%|█▎        | 10/79 [00:00<00:03, 17.83it/s] 25%|██▌       | 20/79 [00:00<00:01, 34.36it/s] 38%|███▊      | 30/79 [00:00<00:01, 48.52it/s] 51%|█████     | 40/79 [00:01<00:00, 60.14it/s] 63%|██████▎   | 50/79 [00:01<00:00, 69.39it/s] 76%|███████▌  | 60/79 [00:01<00:00, 76.68it/s] 89%|████████▊ | 70/79 [00:01<00:00, 82.38it/s]100%|██████████| 79/79 [00:02<00:00, 36.30it/s]
10000 images processed, 2.2466647624969482 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:41,  1.88it/s] 13%|█▎        | 10/79 [00:00<00:03, 20.54it/s] 24%|██▍       | 19/79 [00:00<00:01, 36.67it/s] 37%|███▋      | 29/79 [00:00<00:00, 51.12it/s] 49%|████▉     | 39/79 [00:00<00:00, 63.02it/s] 62%|██████▏   | 49/79 [00:01<00:00, 72.08it/s] 75%|███████▍  | 59/79 [00:01<00:00, 79.06it/s] 87%|████████▋ | 69/79 [00:01<00:00, 84.13it/s]100%|██████████| 79/79 [00:01<00:00, 58.39it/s]
10000 images processed, 1.372617244720459 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.95it/s] 13%|█▎        | 9/70 [00:00<00:03, 18.73it/s] 26%|██▌       | 18/70 [00:00<00:01, 35.06it/s] 39%|███▊      | 27/70 [00:00<00:00, 48.34it/s] 51%|█████▏    | 36/70 [00:00<00:00, 58.75it/s] 66%|██████▌   | 46/70 [00:01<00:00, 68.69it/s] 80%|████████  | 56/70 [00:01<00:00, 76.59it/s] 94%|█████████▍| 66/70 [00:01<00:00, 82.44it/s]100%|██████████| 70/70 [00:01<00:00, 54.32it/s]
8925 images processed, 1.319077968597412 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:40,  1.08it/s]  7%|▋         | 3/45 [00:01<00:11,  3.57it/s] 29%|██▉       | 13/45 [00:01<00:01, 18.66it/s] 40%|████      | 18/45 [00:01<00:01, 18.20it/s] 51%|█████     | 23/45 [00:01<00:01, 20.99it/s] 73%|███████▎  | 33/45 [00:01<00:00, 23.60it/s] 89%|████████▉ | 40/45 [00:02<00:00, 30.17it/s]100%|██████████| 45/45 [00:02<00:00, 21.16it/s]
5640 images processed, 2.149559259414673 seconds used

18.07557964324951
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.36  99.73  96.80
places365     44.41  91.34  74.60
LSUN           5.66  98.65  94.17
iSUN          40.47  93.14  83.76
dtd           24.66  95.99  92.38
AVG           23.31  95.77  88.34
[incremental] Overall: 0.8365 New: 0.8360 Old: 0.8367
[incremental] Final(Top-1): 0.8365  Average: 0.8725
2.505906820297241
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-seen-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<04:24,  1.62it/s]  2%|▏         | 10/430 [00:00<00:23, 18.23it/s]  5%|▍         | 20/430 [00:00<00:11, 34.96it/s]  7%|▋         | 30/430 [00:00<00:08, 48.83it/s]  9%|▉         | 39/430 [00:01<00:06, 58.56it/s] 11%|█▏        | 49/430 [00:01<00:05, 68.28it/s] 14%|█▎        | 59/430 [00:01<00:04, 75.48it/s] 16%|█▌        | 69/430 [00:01<00:04, 80.34it/s] 18%|█▊        | 79/430 [00:01<00:04, 84.58it/s] 21%|██        | 89/430 [00:01<00:03, 87.72it/s] 23%|██▎       | 99/430 [00:01<00:03, 89.76it/s] 25%|██▌       | 109/430 [00:01<00:03, 91.64it/s] 28%|██▊       | 119/430 [00:01<00:03, 92.93it/s] 30%|███       | 129/430 [00:01<00:03, 93.63it/s] 32%|███▏      | 139/430 [00:02<00:03, 94.55it/s] 35%|███▍      | 149/430 [00:02<00:02, 94.90it/s] 37%|███▋      | 159/430 [00:02<00:02, 95.25it/s] 39%|███▉      | 169/430 [00:02<00:02, 95.65it/s] 42%|████▏     | 179/430 [00:02<00:02, 95.64it/s] 44%|████▍     | 189/430 [00:02<00:02, 95.34it/s] 46%|████▋     | 199/430 [00:02<00:02, 95.29it/s] 49%|████▊     | 209/430 [00:02<00:02, 95.12it/s] 51%|█████     | 219/430 [00:02<00:02, 94.46it/s] 53%|█████▎    | 229/430 [00:03<00:02, 94.78it/s] 56%|█████▌    | 239/430 [00:03<00:02, 95.18it/s] 58%|█████▊    | 249/430 [00:03<00:01, 94.83it/s] 60%|██████    | 259/430 [00:03<00:01, 94.86it/s] 63%|██████▎   | 269/430 [00:03<00:01, 94.83it/s] 65%|██████▍   | 279/430 [00:03<00:01, 95.38it/s] 67%|██████▋   | 289/430 [00:03<00:01, 95.82it/s] 70%|██████▉   | 299/430 [00:03<00:01, 95.83it/s] 72%|███████▏  | 309/430 [00:03<00:01, 95.78it/s] 74%|███████▍  | 319/430 [00:03<00:01, 95.57it/s] 77%|███████▋  | 329/430 [00:04<00:01, 95.83it/s] 79%|███████▉  | 339/430 [00:04<00:00, 95.66it/s] 81%|████████  | 349/430 [00:04<00:00, 95.68it/s] 83%|████████▎ | 359/430 [00:04<00:00, 95.38it/s] 86%|████████▌ | 369/430 [00:04<00:00, 95.81it/s] 88%|████████▊ | 379/430 [00:04<00:00, 95.45it/s] 90%|█████████ | 389/430 [00:04<00:00, 95.42it/s] 93%|█████████▎| 399/430 [00:04<00:00, 94.87it/s] 95%|█████████▌| 409/430 [00:04<00:00, 95.60it/s] 97%|█████████▋| 419/430 [00:05<00:00, 96.28it/s]100%|█████████▉| 429/430 [00:05<00:00, 96.83it/s]100%|██████████| 430/430 [00:05<00:00, 83.65it/s]
55000 images processed, 5.226802825927734 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:41,  2.03it/s] 10%|█         | 9/86 [00:00<00:03, 19.33it/s] 20%|█▉        | 17/86 [00:00<00:02, 33.88it/s] 31%|███▏      | 27/86 [00:00<00:01, 49.41it/s] 42%|████▏     | 36/86 [00:00<00:00, 59.99it/s] 52%|█████▏    | 45/86 [00:01<00:00, 67.06it/s] 64%|██████▍   | 55/86 [00:01<00:00, 74.22it/s] 74%|███████▍  | 64/86 [00:01<00:00, 69.05it/s] 84%|████████▎ | 72/86 [00:01<00:00, 61.04it/s] 92%|█████████▏| 79/86 [00:01<00:00, 59.59it/s]100%|██████████| 86/86 [00:01<00:00, 45.36it/s]100%|██████████| 86/86 [00:01<00:00, 47.21it/s]
11000 images processed, 1.8957467079162598 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-seen-forget/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:48,  1.87it/s]  4%|▍         | 9/204 [00:00<00:10, 18.08it/s]  9%|▉         | 18/204 [00:00<00:05, 34.43it/s] 14%|█▎        | 28/204 [00:00<00:03, 49.35it/s] 19%|█▊        | 38/204 [00:00<00:02, 61.33it/s] 24%|██▎       | 48/204 [00:01<00:02, 69.28it/s] 28%|██▊       | 58/204 [00:01<00:01, 75.47it/s] 33%|███▎      | 68/204 [00:01<00:01, 80.91it/s] 38%|███▊      | 78/204 [00:01<00:01, 84.67it/s] 43%|████▎     | 88/204 [00:01<00:01, 87.67it/s] 48%|████▊     | 98/204 [00:01<00:01, 89.72it/s] 53%|█████▎    | 108/204 [00:01<00:01, 91.04it/s] 58%|█████▊    | 118/204 [00:01<00:00, 91.95it/s] 63%|██████▎   | 128/204 [00:01<00:00, 92.81it/s] 68%|██████▊   | 138/204 [00:02<00:00, 92.99it/s] 73%|███████▎  | 148/204 [00:02<00:00, 93.41it/s] 77%|███████▋  | 158/204 [00:02<00:00, 93.29it/s] 82%|████████▏ | 168/204 [00:02<00:00, 93.09it/s] 87%|████████▋ | 178/204 [00:02<00:00, 93.67it/s] 92%|█████████▏| 188/204 [00:02<00:00, 94.57it/s] 97%|█████████▋| 198/204 [00:02<00:00, 95.23it/s]100%|██████████| 204/204 [00:02<00:00, 74.78it/s]
26032 images processed, 2.76798415184021 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:52,  1.49it/s]  9%|▉         | 7/79 [00:00<00:06, 11.72it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.17it/s] 25%|██▌       | 20/79 [00:01<00:01, 31.37it/s] 33%|███▎      | 26/79 [00:01<00:01, 33.02it/s] 46%|████▌     | 36/79 [00:01<00:00, 46.81it/s] 58%|█████▊    | 46/79 [00:01<00:00, 58.13it/s] 71%|███████   | 56/79 [00:01<00:00, 67.13it/s] 81%|████████  | 64/79 [00:01<00:00, 58.06it/s] 92%|█████████▏| 73/79 [00:01<00:00, 64.91it/s]100%|██████████| 79/79 [00:01<00:00, 42.42it/s]
10000 images processed, 1.896667242050171 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.95it/s]  9%|▉         | 7/79 [00:00<00:04, 14.50it/s] 22%|██▏       | 17/79 [00:00<00:01, 34.13it/s] 34%|███▍      | 27/79 [00:00<00:01, 49.88it/s] 47%|████▋     | 37/79 [00:00<00:00, 62.17it/s] 59%|█████▉    | 47/79 [00:01<00:00, 71.11it/s] 72%|███████▏  | 57/79 [00:01<00:00, 78.01it/s] 85%|████████▍ | 67/79 [00:01<00:00, 83.40it/s] 97%|█████████▋| 77/79 [00:01<00:00, 87.36it/s]100%|██████████| 79/79 [00:01<00:00, 57.92it/s]
10000 images processed, 1.3848893642425537 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:37,  1.86it/s] 10%|█         | 7/70 [00:00<00:04, 13.50it/s] 23%|██▎       | 16/70 [00:00<00:01, 30.54it/s] 33%|███▎      | 23/70 [00:00<00:01, 39.61it/s] 47%|████▋     | 33/70 [00:00<00:00, 53.52it/s] 60%|██████    | 42/70 [00:01<00:00, 62.99it/s] 74%|███████▍  | 52/70 [00:01<00:00, 72.29it/s] 89%|████████▊ | 62/70 [00:01<00:00, 79.22it/s]100%|██████████| 70/70 [00:01<00:00, 51.00it/s]
8925 images processed, 1.408602237701416 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:43,  1.01it/s]  4%|▍         | 2/45 [00:01<00:22,  1.91it/s] 18%|█▊        | 8/45 [00:01<00:04,  9.00it/s] 38%|███▊      | 17/45 [00:01<00:01, 20.38it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.42it/s] 56%|█████▌    | 25/45 [00:02<00:01, 15.29it/s] 76%|███████▌  | 34/45 [00:02<00:00, 23.20it/s] 89%|████████▉ | 40/45 [00:02<00:00, 21.20it/s]100%|██████████| 45/45 [00:02<00:00, 16.93it/s]
5640 images processed, 2.683227300643921 seconds used

18.959201097488403
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.02  99.29  97.79
places365     72.83  79.19  78.03
LSUN          10.88  97.58  97.40
iSUN          71.64  82.69  85.02
dtd           46.54  88.70  92.61
AVG           40.98  89.49  90.17
Retain-Acc: 0.7487
Forget-as-OOD (retain known vs forget novel):
  FPR: 59.55 AUROC: 88.15 AUIN: 97.09
7.239195108413696
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-110-forget-from-CIFAR-110-to-c90-stage4-seen-forget_rf.png
runner-incremental-continual-forget.sh: line 278: 0,8,11,40,51,66,67,88,94,57,100,101,102,103,104,105,106,107,108,109,105,106,107,108,109: command not found
