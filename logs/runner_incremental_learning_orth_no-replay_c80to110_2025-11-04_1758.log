nohup: ignoring input MLE错误的实验
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='forget_only', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt

  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:165: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():

  2%|▏         | 1/50 [01:32<1:15:33, 92.51s/it]
  4%|▍         | 2/50 [02:33<59:24, 74.25s/it]  
  6%|▌         | 3/50 [03:37<54:14, 69.25s/it]
  8%|▊         | 4/50 [04:40<51:20, 66.97s/it]
 10%|█         | 5/50 [05:45<49:42, 66.28s/it]
 12%|█▏        | 6/50 [06:53<48:51, 66.62s/it][loss] ep 0 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1
[loss] ep 1 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1
[loss] ep 2 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 2 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 180 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 5 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 5 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA

 14%|█▍        | 7/50 [08:04<48:56, 68.30s/it]
 16%|█▌        | 8/50 [09:12<47:36, 68.00s/it]
 18%|█▊        | 9/50 [10:18<46:04, 67.42s/it]
 20%|██        | 10/50 [11:26<44:59, 67.50s/it]
 22%|██▏       | 11/50 [12:37<44:43, 68.82s/it]
 24%|██▍       | 12/50 [14:03<46:46, 73.85s/it]
 26%|██▌       | 13/50 [15:23<46:48, 75.89s/it]
 28%|██▊       | 14/50 [16:43<46:10, 76.96s/it][loss] ep 6 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 7 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 180 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 11 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 11 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=13 protos=None fproto_sim=NA
[loss] ep 11 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 11 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA

 30%|███       | 15/50 [17:55<44:05, 75.59s/it]
 32%|███▏      | 16/50 [19:05<41:54, 73.94s/it]
 34%|███▍      | 17/50 [20:15<39:57, 72.66s/it]
 36%|███▌      | 18/50 [21:22<37:49, 70.93s/it]
 38%|███▊      | 19/50 [22:30<36:12, 70.08s/it]
 40%|████      | 20/50 [23:42<35:20, 70.67s/it]
 42%|████▏     | 21/50 [25:01<35:23, 73.24s/it][loss] ep 14 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 180 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 14 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 15 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 16 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 16 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 17 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 18 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 180 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 20 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 20 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 21 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA

 44%|████▍     | 22/50 [26:25<35:37, 76.35s/it]
 46%|████▌     | 23/50 [27:45<34:50, 77.42s/it]
 48%|████▊     | 24/50 [29:08<34:15, 79.04s/it]
 50%|█████     | 25/50 [30:27<32:58, 79.14s/it]
 52%|█████▏    | 26/50 [31:52<32:24, 81.03s/it]
 54%|█████▍    | 27/50 [33:18<31:35, 82.39s/it]
 56%|█████▌    | 28/50 [34:40<30:12, 82.38s/it][loss] ep 21 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 22 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 22 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 22 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 23 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 23 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 180 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 25 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 26 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 27 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 27 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA

 58%|█████▊    | 29/50 [36:01<28:39, 81.89s/it]
 60%|██████    | 30/50 [37:21<27:03, 81.18s/it]
 62%|██████▏   | 31/50 [38:40<25:35, 80.80s/it]
 64%|██████▍   | 32/50 [40:11<25:06, 83.70s/it]
 66%|██████▌   | 33/50 [41:43<24:23, 86.08s/it]
 68%|██████▊   | 34/50 [43:20<23:52, 89.52s/it]
 70%|███████   | 35/50 [44:30<20:54, 83.64s/it][loss] ep 28 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 180 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 29 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 29 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 30 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 30 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 30 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 31 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 31 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 32 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 33 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 33 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 33 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 180 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 34 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA

 72%|███████▏  | 36/50 [45:37<18:18, 78.48s/it]
 74%|███████▍  | 37/50 [45:56<13:11, 60.87s/it]
 76%|███████▌  | 38/50 [46:16<09:41, 48.44s/it]
 78%|███████▊  | 39/50 [46:36<07:19, 39.93s/it]
 80%|████████  | 40/50 [46:57<05:42, 34.23s/it]
 82%|████████▏ | 41/50 [47:15<04:25, 29.52s/it]
 84%|████████▍ | 42/50 [47:35<03:31, 26.46s/it][loss] ep 35 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 35 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 36 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 36 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 36 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 36 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=14 protos=None fproto_sim=NA
[loss] ep 36 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 37 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 37 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 37 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 38 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 38 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 38 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 38 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 39 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 39 it 180 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 39 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 40 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 40 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 40 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 40 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 40 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 40 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 41 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 41 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 42 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 42 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA

 86%|████████▌ | 43/50 [47:54<02:50, 24.37s/it]
 88%|████████▊ | 44/50 [48:12<02:13, 22.32s/it]
 90%|█████████ | 45/50 [48:29<01:44, 20.88s/it]
 92%|█████████▏| 46/50 [48:52<01:26, 21.52s/it]
 94%|█████████▍| 47/50 [49:15<01:05, 21.87s/it]
 96%|█████████▌| 48/50 [49:36<00:43, 21.58s/it]
 98%|█████████▊| 49/50 [49:58<00:21, 21.74s/it]
100%|██████████| 50/50 [50:32<00:00, 25.52s/it]
100%|██████████| 50/50 [50:32<00:00, 60.65s/it]
[loss] ep 42 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 43 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 43 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 43 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 43 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 44 it 180 total=9.0354 mle=3.4117 pcon=5.6237 forget=0.0000 orth=0.0000 favg=0.0000 nr=128 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 44 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 44 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 45 it 0 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 45 it 50 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 45 it 100 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=14 protos=None fproto_sim=NA
[loss] ep 45 it 150 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 45 it 200 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 45 it 250 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 45 it 300 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 350 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 400 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 46 it 20 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 70 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 120 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 46 it 170 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 220 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 270 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 320 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=16 protos=None fproto_sim=NA
[loss] ep 46 it 370 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 46 it 420 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 47 it 40 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 47 it 90 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 47 it 140 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 47 it 190 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 47 it 240 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 47 it 290 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 47 it 340 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 47 it 390 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 10 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 60 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 48 it 110 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 160 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 48 it 210 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 260 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 48 it 310 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 48 it 360 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 410 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 49 it 30 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 49 it 80 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 49 it 130 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 49 it 180 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 49 it 230 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 49 it 280 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 49 it 330 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 49 it 380 total=-0.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0000 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images

  0%|          | 0/430 [00:00<?, ?it/s]
  0%|          | 1/430 [00:02<17:54,  2.50s/it]
  1%|▏         | 6/430 [00:02<02:19,  3.05it/s]
  3%|▎         | 11/430 [00:02<01:06,  6.34it/s]
  4%|▎         | 16/430 [00:02<00:40, 10.29it/s]
  5%|▍         | 21/430 [00:02<00:27, 14.71it/s]
  6%|▌         | 26/430 [00:03<00:21, 19.23it/s]
  7%|▋         | 31/430 [00:03<00:16, 23.76it/s]
  8%|▊         | 36/430 [00:03<00:14, 27.81it/s]
 10%|▉         | 41/430 [00:03<00:12, 30.55it/s]
 11%|█         | 46/430 [00:03<00:11, 34.17it/s]
 12%|█▏        | 52/430 [00:03<00:09, 39.63it/s]
 13%|█▎        | 57/430 [00:03<00:09, 41.37it/s]
 14%|█▍        | 62/430 [00:03<00:08, 42.45it/s]
 16%|█▌        | 67/430 [00:03<00:08, 42.16it/s]
 17%|█▋        | 72/430 [00:04<00:08, 42.26it/s]
 18%|█▊        | 78/430 [00:04<00:07, 46.83it/s]
 19%|█▉        | 83/430 [00:04<00:07, 46.69it/s]
 20%|██        | 88/430 [00:04<00:07, 46.54it/s]
 22%|██▏       | 93/430 [00:04<00:07, 43.68it/s]
 23%|██▎       | 98/430 [00:04<00:07, 44.88it/s]
 24%|██▍       | 104/430 [00:04<00:06, 47.11it/s]
 25%|██▌       | 109/430 [00:04<00:06, 46.89it/s]
 27%|██▋       | 114/430 [00:04<00:06, 46.92it/s]
 28%|██▊       | 119/430 [00:05<00:06, 45.43it/s]
 29%|██▉       | 124/430 [00:05<00:07, 43.11it/s]
 30%|███       | 129/430 [00:05<00:07, 42.61it/s]
 31%|███       | 134/430 [00:05<00:06, 43.68it/s]
 32%|███▏      | 139/430 [00:05<00:06, 43.94it/s]
 33%|███▎      | 144/430 [00:05<00:06, 43.24it/s]
 35%|███▍      | 149/430 [00:05<00:06, 43.18it/s]
 36%|███▌      | 154/430 [00:05<00:06, 44.11it/s]
 37%|███▋      | 159/430 [00:06<00:06, 44.95it/s]
 38%|███▊      | 164/430 [00:06<00:05, 45.35it/s]
 39%|███▉      | 169/430 [00:06<00:05, 45.37it/s]
 41%|████      | 175/430 [00:06<00:05, 49.00it/s]
 42%|████▏     | 180/430 [00:06<00:05, 48.12it/s]
 43%|████▎     | 185/430 [00:06<00:05, 45.07it/s]
 44%|████▍     | 190/430 [00:06<00:05, 45.44it/s]
 45%|████▌     | 195/430 [00:06<00:05, 45.20it/s]
 47%|████▋     | 201/430 [00:06<00:04, 48.45it/s]
 48%|████▊     | 206/430 [00:07<00:04, 47.02it/s]
 49%|████▉     | 211/430 [00:07<00:04, 47.02it/s]
 50%|█████     | 216/430 [00:07<00:04, 46.79it/s]
 51%|█████▏    | 221/430 [00:07<00:04, 46.53it/s]
 53%|█████▎    | 227/430 [00:07<00:04, 50.12it/s]
 54%|█████▍    | 233/430 [00:07<00:04, 48.50it/s]
 55%|█████▌    | 238/430 [00:07<00:03, 48.05it/s]
 57%|█████▋    | 243/430 [00:07<00:03, 47.02it/s]
 58%|█████▊    | 248/430 [00:07<00:03, 46.81it/s]
 59%|█████▉    | 254/430 [00:07<00:03, 49.65it/s]
 60%|██████    | 259/430 [00:08<00:03, 48.65it/s]
 61%|██████▏   | 264/430 [00:08<00:03, 48.15it/s]
 63%|██████▎   | 269/430 [00:08<00:03, 47.59it/s]
 64%|██████▎   | 274/430 [00:08<00:03, 47.20it/s]
 65%|██████▌   | 280/430 [00:08<00:03, 49.92it/s]
 66%|██████▋   | 285/430 [00:08<00:02, 48.83it/s]
 67%|██████▋   | 290/430 [00:08<00:02, 48.09it/s]
 69%|██████▊   | 295/430 [00:08<00:02, 46.83it/s]
 70%|██████▉   | 300/430 [00:08<00:02, 46.41it/s]
 71%|███████   | 306/430 [00:09<00:02, 49.06it/s]
 72%|███████▏  | 311/430 [00:09<00:02, 47.66it/s]
 73%|███████▎  | 316/430 [00:09<00:02, 46.96it/s]
 75%|███████▍  | 321/430 [00:09<00:02, 43.16it/s]
 76%|███████▌  | 326/430 [00:09<00:02, 43.98it/s]
 77%|███████▋  | 332/430 [00:09<00:02, 46.57it/s]
 78%|███████▊  | 337/430 [00:09<00:01, 46.53it/s]
 80%|███████▉  | 342/430 [00:09<00:01, 46.65it/s]
 81%|████████  | 347/430 [00:09<00:01, 46.55it/s]
 82%|████████▏ | 352/430 [00:10<00:01, 44.37it/s]
 83%|████████▎ | 358/430 [00:10<00:01, 47.51it/s]
 84%|████████▍ | 363/430 [00:10<00:01, 46.72it/s]
 86%|████████▌ | 368/430 [00:10<00:01, 46.52it/s]
 87%|████████▋ | 373/430 [00:10<00:01, 45.93it/s]
 88%|████████▊ | 378/430 [00:10<00:01, 46.02it/s]
 89%|████████▉ | 384/430 [00:10<00:00, 49.08it/s]
 90%|█████████ | 389/430 [00:10<00:00, 47.43it/s]
 92%|█████████▏| 394/430 [00:11<00:00, 45.61it/s]
 93%|█████████▎| 399/430 [00:11<00:00, 45.64it/s]
 94%|█████████▍| 404/430 [00:11<00:00, 46.28it/s]
 95%|█████████▌| 410/430 [00:11<00:00, 49.50it/s]
 97%|█████████▋| 415/430 [00:11<00:00, 48.66it/s]
 98%|█████████▊| 420/430 [00:11<00:00, 48.17it/s]
 99%|█████████▉| 425/430 [00:11<00:00, 47.61it/s]
100%|██████████| 430/430 [00:11<00:00, 46.63it/s]
100%|██████████| 430/430 [00:11<00:00, 36.58it/s]
55000 images processed, 11.842002868652344 seconds used

Processing in-distribution CIFAR-110 images

  0%|          | 0/86 [00:00<?, ?it/s]
  1%|          | 1/86 [00:00<00:53,  1.59it/s]
  5%|▍         | 4/86 [00:00<00:12,  6.81it/s]
 10%|█         | 9/86 [00:00<00:04, 15.54it/s]
 17%|█▋        | 15/86 [00:00<00:02, 25.12it/s]
 23%|██▎       | 20/86 [00:01<00:02, 28.56it/s]
 29%|██▉       | 25/86 [00:01<00:01, 31.98it/s]
 34%|███▎      | 29/86 [00:01<00:01, 33.54it/s]
 42%|████▏     | 36/86 [00:01<00:01, 41.58it/s]
 48%|████▊     | 41/86 [00:01<00:01, 42.90it/s]
 53%|█████▎    | 46/86 [00:01<00:00, 43.88it/s]
 59%|█████▉    | 51/86 [00:01<00:00, 43.69it/s]
 65%|██████▌   | 56/86 [00:01<00:00, 41.63it/s]
 73%|███████▎  | 63/86 [00:02<00:00, 47.09it/s]
 79%|███████▉  | 68/86 [00:02<00:00, 46.62it/s]
 85%|████████▍ | 73/86 [00:02<00:00, 46.73it/s]
 91%|█████████ | 78/86 [00:02<00:00, 46.60it/s]
 97%|█████████▋| 83/86 [00:02<00:00, 46.53it/s]
100%|██████████| 86/86 [00:02<00:00, 34.42it/s]
11000 images processed, 2.513916492462158 seconds used

Processing out-of-distribution SVHN images

  0%|          | 0/204 [00:00<?, ?it/s]
  0%|          | 1/204 [00:00<02:48,  1.20it/s]
  3%|▎         | 6/204 [00:00<00:24,  8.15it/s]
  5%|▍         | 10/204 [00:01<00:14, 13.49it/s]
  7%|▋         | 15/204 [00:01<00:09, 19.78it/s]
 10%|▉         | 20/204 [00:01<00:07, 25.12it/s]
 13%|█▎        | 26/204 [00:01<00:05, 31.29it/s]
 15%|█▌        | 31/204 [00:01<00:05, 34.11it/s]
 18%|█▊        | 36/204 [00:01<00:04, 35.09it/s]
 20%|██        | 41/204 [00:01<00:04, 36.17it/s]
 23%|██▎       | 47/204 [00:01<00:03, 40.00it/s]
 25%|██▌       | 52/204 [00:02<00:03, 40.35it/s]
 28%|██▊       | 57/204 [00:02<00:04, 36.15it/s]
 30%|██▉       | 61/204 [00:02<00:04, 34.78it/s]
 32%|███▏      | 65/204 [00:02<00:04, 34.61it/s]
 34%|███▍      | 70/204 [00:02<00:03, 37.10it/s]
 37%|███▋      | 75/204 [00:02<00:03, 38.27it/s]
 39%|███▉      | 80/204 [00:02<00:03, 40.46it/s]
 42%|████▏     | 85/204 [00:02<00:03, 39.17it/s]
 44%|████▎     | 89/204 [00:03<00:02, 38.96it/s]
 46%|████▌     | 94/204 [00:03<00:02, 39.84it/s]
 49%|████▊     | 99/204 [00:03<00:02, 40.66it/s]
 51%|█████▏    | 105/204 [00:03<00:02, 43.98it/s]
 54%|█████▍    | 110/204 [00:03<00:02, 43.36it/s]
 56%|█████▋    | 115/204 [00:03<00:02, 43.72it/s]
 59%|█████▉    | 120/204 [00:03<00:01, 43.15it/s]
 62%|██████▏   | 126/204 [00:03<00:01, 46.33it/s]
 64%|██████▍   | 131/204 [00:03<00:01, 43.59it/s]
 67%|██████▋   | 136/204 [00:04<00:01, 44.07it/s]
 69%|██████▉   | 141/204 [00:04<00:01, 43.44it/s]
 72%|███████▏  | 146/204 [00:04<00:01, 43.61it/s]
 75%|███████▍  | 152/204 [00:04<00:01, 45.86it/s]
 77%|███████▋  | 157/204 [00:04<00:01, 44.45it/s]
 79%|███████▉  | 162/204 [00:04<00:00, 43.68it/s]
 82%|████████▏ | 167/204 [00:04<00:00, 43.18it/s]
 85%|████████▍ | 173/204 [00:04<00:00, 46.05it/s]
 87%|████████▋ | 178/204 [00:05<00:00, 44.78it/s]
 90%|████████▉ | 183/204 [00:05<00:00, 44.14it/s]
 92%|█████████▏| 188/204 [00:05<00:00, 43.46it/s]
 95%|█████████▍| 193/204 [00:05<00:00, 44.50it/s]
 97%|█████████▋| 198/204 [00:05<00:00, 45.37it/s]
100%|█████████▉| 203/204 [00:05<00:00, 44.29it/s]
100%|██████████| 204/204 [00:05<00:00, 36.27it/s]
26032 images processed, 5.6821699142456055 seconds used

Processing out-of-distribution places365 images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:01<01:56,  1.50s/it]
  6%|▋         | 5/79 [00:01<00:18,  4.07it/s]
 11%|█▏        | 9/79 [00:01<00:08,  7.89it/s]
 16%|█▋        | 13/79 [00:01<00:05, 11.88it/s]
 24%|██▍       | 19/79 [00:01<00:03, 19.20it/s]
 29%|██▉       | 23/79 [00:02<00:02, 22.89it/s]
 35%|███▌      | 28/79 [00:02<00:01, 27.24it/s]
 42%|████▏     | 33/79 [00:02<00:01, 30.95it/s]
 48%|████▊     | 38/79 [00:02<00:01, 34.36it/s]
 54%|█████▍    | 43/79 [00:02<00:00, 37.91it/s]
 61%|██████    | 48/79 [00:02<00:00, 38.71it/s]
 67%|██████▋   | 53/79 [00:02<00:00, 39.04it/s]
 73%|███████▎  | 58/79 [00:02<00:00, 39.87it/s]
 81%|████████  | 64/79 [00:03<00:00, 41.85it/s]
 87%|████████▋ | 69/79 [00:03<00:00, 41.04it/s]
 94%|█████████▎| 74/79 [00:03<00:00, 41.29it/s]
100%|██████████| 79/79 [00:03<00:00, 40.98it/s]
100%|██████████| 79/79 [00:03<00:00, 23.41it/s]
10000 images processed, 3.4089319705963135 seconds used

Processing out-of-distribution LSUN images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:00<01:07,  1.16it/s]
  8%|▊         | 6/79 [00:00<00:09,  7.82it/s]
 14%|█▍        | 11/79 [00:01<00:04, 14.27it/s]
 20%|██        | 16/79 [00:01<00:03, 20.04it/s]
 27%|██▋       | 21/79 [00:01<00:02, 25.01it/s]
 34%|███▍      | 27/79 [00:01<00:01, 32.15it/s]
 41%|████      | 32/79 [00:01<00:01, 34.10it/s]
 47%|████▋     | 37/79 [00:01<00:01, 35.85it/s]
 53%|█████▎    | 42/79 [00:01<00:00, 37.54it/s]
 61%|██████    | 48/79 [00:01<00:00, 42.13it/s]
 67%|██████▋   | 53/79 [00:02<00:00, 38.71it/s]
 73%|███████▎  | 58/79 [00:02<00:00, 36.99it/s]
 80%|███████▉  | 63/79 [00:02<00:00, 39.37it/s]
 87%|████████▋ | 69/79 [00:02<00:00, 42.15it/s]
 94%|█████████▎| 74/79 [00:02<00:00, 42.08it/s]
100%|██████████| 79/79 [00:02<00:00, 29.36it/s]
10000 images processed, 2.7103376388549805 seconds used

Processing out-of-distribution iSUN images

  0%|          | 0/70 [00:00<?, ?it/s]
  1%|▏         | 1/70 [00:00<00:48,  1.43it/s]
  9%|▊         | 6/70 [00:00<00:06,  9.37it/s]
 17%|█▋        | 12/70 [00:00<00:03, 18.46it/s]
 24%|██▍       | 17/70 [00:01<00:02, 23.96it/s]
 31%|███▏      | 22/70 [00:01<00:01, 28.63it/s]
 39%|███▊      | 27/70 [00:01<00:01, 30.28it/s]
 44%|████▍     | 31/70 [00:01<00:01, 32.10it/s]
 51%|█████▏    | 36/70 [00:01<00:00, 34.67it/s]
 57%|█████▋    | 40/70 [00:01<00:00, 35.87it/s]
 63%|██████▎   | 44/70 [00:01<00:00, 36.03it/s]
 69%|██████▊   | 48/70 [00:01<00:00, 36.01it/s]
 76%|███████▌  | 53/70 [00:01<00:00, 37.93it/s]
 83%|████████▎ | 58/70 [00:02<00:00, 39.33it/s]
 90%|█████████ | 63/70 [00:02<00:00, 40.16it/s]
 97%|█████████▋| 68/70 [00:02<00:00, 40.82it/s]
100%|██████████| 70/70 [00:02<00:00, 29.48it/s]
8925 images processed, 2.4118566513061523 seconds used

Processing out-of-distribution dtd images

  0%|          | 0/45 [00:00<?, ?it/s]
  2%|▏         | 1/45 [00:01<01:01,  1.40s/it]
  7%|▋         | 3/45 [00:01<00:17,  2.47it/s]
 16%|█▌        | 7/45 [00:01<00:05,  6.79it/s]
 27%|██▋       | 12/45 [00:01<00:02, 12.56it/s]
 38%|███▊      | 17/45 [00:01<00:01, 16.07it/s]
 47%|████▋     | 21/45 [00:02<00:01, 14.09it/s]
 58%|█████▊    | 26/45 [00:02<00:01, 18.73it/s]
 69%|██████▉   | 31/45 [00:02<00:00, 23.13it/s]
 78%|███████▊  | 35/45 [00:02<00:00, 16.78it/s]
 87%|████████▋ | 39/45 [00:03<00:00, 20.06it/s]
 96%|█████████▌| 43/45 [00:03<00:00, 23.28it/s]
100%|██████████| 45/45 [00:03<00:00, 14.11it/s]
5640 images processed, 3.251936674118042 seconds used

33.739346504211426
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.55  99.04
places365     49.40  89.47
LSUN          25.67  95.16
iSUN          25.79  95.00
dtd           24.45  94.42
AVG           25.77  94.62
[incremental] Overall: 0.8500 New: 0.8500 Old: nan
[incremental] Final(Top-1): 0.8500  Average: 0.8500
28.439847946166992
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='forget_only', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt

  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:165: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:239: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

  2%|▏         | 1/50 [01:31<1:14:32, 91.27s/it]
  4%|▍         | 2/50 [02:18<52:29, 65.61s/it]  
  6%|▌         | 3/50 [03:04<44:13, 56.46s/it]
  8%|▊         | 4/50 [03:47<39:06, 51.01s/it]
 10%|█         | 5/50 [04:28<35:39, 47.54s/it]
 12%|█▏        | 6/50 [05:19<35:46, 48.79s/it][loss] ep 0 it 0 total=1.0056 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0056 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=1.0056 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0056 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=1.0056 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0056 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=1.0056 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0056 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=1.0056 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0056 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=1.0055 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0055 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=1.0055 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0055 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=1.0055 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0055 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 400 total=1.0054 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0054 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 1 it 20 total=1.0054 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0054 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 70 total=1.0053 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0053 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 120 total=1.0053 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0053 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 170 total=1.0052 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0052 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 220 total=1.0051 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0051 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 270 total=1.0050 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0050 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 320 total=1.0049 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0049 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 370 total=1.0048 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0048 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 420 total=1.0047 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0047 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 2 it 40 total=1.0046 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0046 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 90 total=1.0045 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0045 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 2 it 140 total=1.0044 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0044 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 190 total=1.0043 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0043 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 240 total=1.0041 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0041 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 290 total=1.0040 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0040 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 340 total=1.0039 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0039 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 390 total=1.0037 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0037 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 10 total=1.0036 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0036 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 60 total=1.0034 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0034 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 110 total=1.0032 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0032 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 160 total=1.0031 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0031 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 210 total=1.0029 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0029 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 260 total=1.0027 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0027 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 310 total=1.0025 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0025 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 3 it 360 total=1.0023 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0023 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 410 total=1.0021 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0021 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 4 it 30 total=1.0019 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0019 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 80 total=1.0017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0017 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 130 total=1.0014 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0014 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 180 total=1.0012 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0012 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 230 total=1.0010 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0010 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 280 total=1.0007 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0007 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 330 total=1.0005 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0005 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 380 total=1.0002 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0002 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 5 it 0 total=1.0000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0000 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 50 total=0.9997 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9997 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 100 total=0.9994 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9994 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 150 total=0.9992 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9992 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 200 total=0.9989 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9989 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 250 total=0.9986 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9986 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 300 total=0.9983 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9983 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 350 total=0.9980 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9980 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 5 it 400 total=0.9977 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9977 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 6 it 20 total=0.9974 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9974 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 70 total=0.9971 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9971 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 120 total=0.9968 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9968 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA

 14%|█▍        | 7/50 [06:05<34:20, 47.91s/it]
 16%|█▌        | 8/50 [06:53<33:29, 47.85s/it]
 18%|█▊        | 9/50 [07:39<32:14, 47.19s/it]
 20%|██        | 10/50 [08:19<30:01, 45.04s/it]
 22%|██▏       | 11/50 [09:00<28:30, 43.86s/it]
 24%|██▍       | 12/50 [09:43<27:35, 43.56s/it][loss] ep 6 it 170 total=0.9964 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9964 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 220 total=0.9961 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9961 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 270 total=0.9958 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9958 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 320 total=0.9954 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9954 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 6 it 370 total=0.9951 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9951 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 420 total=0.9947 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9947 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 7 it 40 total=0.9944 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9944 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 90 total=0.9940 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9940 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 140 total=0.9937 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9937 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 190 total=0.9933 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9933 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 240 total=0.9929 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9929 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 290 total=0.9925 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9925 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 340 total=0.9921 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9921 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 390 total=0.9918 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9918 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 8 it 10 total=0.9914 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9914 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 60 total=0.9910 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9910 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 110 total=0.9906 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9906 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 160 total=0.9902 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9902 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 210 total=0.9898 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9898 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 260 total=0.9893 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9893 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 310 total=0.9889 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9889 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 360 total=0.9885 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9885 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 410 total=0.9881 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9881 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 9 it 30 total=0.9877 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9877 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 80 total=0.9872 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9872 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 130 total=0.9868 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9868 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 180 total=0.9864 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9864 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 230 total=0.9860 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9860 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 280 total=0.9855 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9855 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 330 total=0.9851 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9851 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 380 total=0.9846 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9846 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 10 it 0 total=0.9842 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9842 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 50 total=0.9838 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9838 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 100 total=0.9833 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9833 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 150 total=0.9829 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9829 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 200 total=0.9825 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9825 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 250 total=0.9820 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9820 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 300 total=0.9816 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9816 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 350 total=0.9812 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9812 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 400 total=0.9808 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9808 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 11 it 20 total=0.9803 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9803 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 70 total=0.9799 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9799 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 120 total=0.9795 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9795 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 170 total=0.9791 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9791 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 11 it 220 total=0.9787 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9787 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 11 it 270 total=0.9783 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9783 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 320 total=0.9779 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9779 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 11 it 370 total=0.9776 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9776 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 420 total=0.9772 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9772 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 40 total=0.9768 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9768 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 12 it 90 total=0.9764 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9764 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 140 total=0.9760 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9760 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 190 total=0.9757 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9757 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 240 total=0.9753 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9753 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA

 26%|██▌       | 13/50 [10:26<26:47, 43.45s/it]
 28%|██▊       | 14/50 [11:06<25:21, 42.25s/it]
 30%|███       | 15/50 [11:46<24:18, 41.66s/it]
 32%|███▏      | 16/50 [12:27<23:27, 41.41s/it]
 34%|███▍      | 17/50 [13:11<23:11, 42.17s/it]
 36%|███▌      | 18/50 [13:52<22:20, 41.89s/it]
 38%|███▊      | 19/50 [14:37<22:03, 42.71s/it][loss] ep 12 it 290 total=0.9749 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9749 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 340 total=0.9746 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9746 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 390 total=0.9742 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9742 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 10 total=0.9739 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9739 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 60 total=0.9735 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9735 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 110 total=0.9732 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9732 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 160 total=0.9728 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9728 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 210 total=0.9725 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9725 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 260 total=0.9722 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9722 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 310 total=0.9718 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9718 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 360 total=0.9715 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9715 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 410 total=0.9712 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9712 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 14 it 30 total=0.9708 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9708 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 80 total=0.9705 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9705 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 14 it 130 total=0.9702 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9702 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 180 total=0.9699 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9699 favg=0.0000 nr=0 nf=17 protos=None fproto_sim=NA
[loss] ep 14 it 230 total=0.9696 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9696 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 280 total=0.9693 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9693 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 330 total=0.9690 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9690 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 380 total=0.9687 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9687 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 0 total=0.9684 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9684 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 50 total=0.9681 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9681 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 15 it 100 total=0.9678 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9678 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 150 total=0.9675 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9675 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 200 total=0.9672 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9672 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 15 it 250 total=0.9669 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9669 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 300 total=0.9666 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9666 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 350 total=0.9663 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9663 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 400 total=0.9661 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9661 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 16 it 20 total=0.9658 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9658 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 70 total=0.9655 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9655 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 120 total=0.9653 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9653 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 16 it 170 total=13.3479 mle=3.4055 pcon=8.9774 forget=0.0000 orth=0.9650 favg=0.0000 nr=123 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 220 total=0.9647 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9647 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 270 total=0.9645 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9645 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 320 total=0.9642 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9642 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 370 total=0.9640 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9640 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 420 total=0.9637 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9637 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 40 total=0.9634 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9634 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 90 total=0.9632 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9632 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 140 total=0.9630 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9630 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 190 total=0.9627 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9627 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 240 total=0.9625 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9625 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 290 total=0.9622 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9622 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 340 total=0.9620 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9620 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 390 total=0.9618 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9618 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 18 it 10 total=0.9615 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9615 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 60 total=0.9613 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9613 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 110 total=0.9611 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9611 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 160 total=0.9608 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9608 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 210 total=0.9606 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9606 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 260 total=0.9604 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9604 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 18 it 310 total=0.9602 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9602 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 360 total=0.9600 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9600 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 410 total=0.9597 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9597 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 19 it 30 total=0.9595 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9595 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 19 it 80 total=0.9593 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9593 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 130 total=0.9591 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9591 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA

 40%|████      | 20/50 [15:20<21:28, 42.93s/it]
 42%|████▏     | 21/50 [16:06<21:14, 43.94s/it]
 44%|████▍     | 22/50 [16:45<19:43, 42.26s/it]
 46%|████▌     | 23/50 [17:29<19:16, 42.83s/it]
 48%|████▊     | 24/50 [18:10<18:21, 42.36s/it]
 50%|█████     | 25/50 [18:50<17:21, 41.66s/it]
 52%|█████▏    | 26/50 [19:30<16:24, 41.01s/it][loss] ep 19 it 180 total=0.9589 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9589 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 230 total=0.9587 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9587 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 280 total=0.9585 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9585 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 330 total=0.9583 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9583 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 380 total=0.9581 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9581 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 0 total=0.9579 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9579 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 50 total=0.9577 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9577 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 100 total=0.9575 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9575 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 150 total=0.9573 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9573 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 200 total=0.9571 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9571 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 250 total=0.9569 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9569 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 300 total=0.9567 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9567 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 350 total=0.9565 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9565 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 400 total=0.9564 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9564 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 20 total=0.9562 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9562 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 70 total=0.9560 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9560 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 21 it 120 total=0.9558 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9558 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 170 total=0.9556 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9556 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 220 total=0.9555 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9555 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 21 it 270 total=0.9553 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9553 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 320 total=0.9551 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9551 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 370 total=0.9549 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9549 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 420 total=0.9548 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9548 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 40 total=0.9546 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9546 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 22 it 90 total=0.9544 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9544 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 140 total=0.9543 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9543 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 22 it 190 total=0.9541 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9541 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 240 total=0.9539 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9539 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 290 total=0.9538 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9538 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 340 total=0.9536 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9536 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 390 total=0.9535 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9535 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 10 total=0.9533 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9533 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 23 it 60 total=0.9532 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9532 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 110 total=0.9530 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9530 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 160 total=0.9528 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9528 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 210 total=0.9527 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9527 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 260 total=0.9525 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9525 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 23 it 310 total=0.9524 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9524 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 360 total=0.9523 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9523 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 410 total=0.9521 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9521 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 30 total=0.9520 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9520 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 80 total=0.9518 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9518 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 130 total=0.9517 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9517 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 180 total=0.9515 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9515 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 230 total=0.9514 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9514 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 280 total=0.9513 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9513 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 330 total=0.9511 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9511 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 380 total=0.9510 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9510 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 0 total=0.9509 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9509 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 25 it 50 total=0.9507 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9507 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 25 it 100 total=0.9506 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9506 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 25 it 150 total=0.9505 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9505 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 200 total=0.9504 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9504 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 250 total=0.9502 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9502 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 25 it 300 total=0.9501 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9501 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 350 total=0.9500 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9500 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 400 total=0.9499 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9499 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 26 it 20 total=0.9497 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9497 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 26 it 70 total=0.9496 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9496 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 120 total=0.9495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9495 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 170 total=0.9494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9494 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA

 54%|█████▍    | 27/50 [20:06<15:09, 39.54s/it]
 56%|█████▌    | 28/50 [20:42<14:09, 38.60s/it]
 58%|█████▊    | 29/50 [21:17<13:07, 37.48s/it]
 60%|██████    | 30/50 [21:59<12:57, 38.90s/it]
 62%|██████▏   | 31/50 [22:36<12:08, 38.34s/it]
 64%|██████▍   | 32/50 [23:11<11:12, 37.35s/it][loss] ep 26 it 220 total=0.9493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9493 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 270 total=0.9491 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9491 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 26 it 320 total=0.9490 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9490 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 370 total=0.9489 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9489 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 420 total=0.9488 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9488 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 27 it 40 total=0.9487 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9487 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 90 total=0.9486 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9486 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 27 it 140 total=0.9485 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9485 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 190 total=0.9483 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9483 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 27 it 240 total=0.9482 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9482 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 290 total=0.9481 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9481 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 340 total=0.9480 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9480 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 390 total=0.9479 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9479 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 28 it 10 total=0.9478 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9478 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 60 total=0.9477 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9477 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 110 total=0.9476 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9476 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 160 total=0.9475 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9475 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 210 total=0.9474 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9474 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 260 total=0.9473 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9473 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 310 total=0.9472 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9472 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 360 total=0.9471 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9471 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 410 total=0.9470 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9470 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 29 it 30 total=0.9469 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9469 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 80 total=0.9468 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9468 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 130 total=0.9467 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9467 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 180 total=0.9466 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9466 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 230 total=0.9465 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9465 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 280 total=0.9464 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9464 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 330 total=0.9463 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9463 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 380 total=0.9462 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9462 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 30 it 0 total=0.9461 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9461 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 30 it 50 total=0.9461 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9461 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 100 total=0.9460 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9460 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 150 total=0.9459 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9459 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 30 it 200 total=0.9458 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9458 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 30 it 250 total=0.9457 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9457 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 300 total=0.9456 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9456 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 30 it 350 total=0.9455 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9455 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 400 total=0.9454 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9454 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 20 total=0.9453 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9453 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 70 total=0.9453 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9453 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 120 total=0.9452 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9452 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 170 total=0.9451 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9451 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 220 total=0.9450 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9450 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 270 total=0.9449 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9449 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 320 total=0.9448 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9448 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 31 it 370 total=0.9447 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9447 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 31 it 420 total=0.9447 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9447 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 32 it 40 total=0.9446 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9446 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 90 total=0.9445 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9445 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 140 total=0.9444 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9444 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 190 total=0.9443 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9443 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 240 total=0.9443 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9443 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 32 it 290 total=0.9442 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9442 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA

 66%|██████▌   | 33/50 [23:47<10:26, 36.85s/it]
 68%|██████▊   | 34/50 [24:28<10:09, 38.12s/it]
 70%|███████   | 35/50 [25:06<09:29, 37.99s/it]
 72%|███████▏  | 36/50 [25:43<08:47, 37.67s/it]
 74%|███████▍  | 37/50 [26:21<08:12, 37.91s/it]
 76%|███████▌  | 38/50 [27:01<07:42, 38.54s/it]
 78%|███████▊  | 39/50 [27:39<07:01, 38.31s/it][loss] ep 32 it 340 total=0.9441 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9441 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 390 total=0.9440 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9440 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 10 total=0.9439 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9439 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 60 total=0.9438 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9438 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 110 total=0.9438 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9438 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 33 it 160 total=0.9437 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9437 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 210 total=0.9436 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9436 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 260 total=0.9435 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9435 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 310 total=0.9434 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9434 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 360 total=0.9434 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9434 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 410 total=0.9433 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9433 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 30 total=0.9432 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9432 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 34 it 80 total=0.9431 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9431 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 130 total=0.9431 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9431 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 180 total=0.9430 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9430 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 230 total=0.9429 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9429 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 280 total=0.9428 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9428 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 330 total=0.9428 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9428 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 380 total=0.9427 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9427 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 35 it 0 total=0.9426 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9426 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 50 total=0.9425 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9425 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 35 it 100 total=0.9425 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9425 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 150 total=0.9424 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9424 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 200 total=0.9423 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9423 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 250 total=0.9422 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9422 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 300 total=0.9422 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9422 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 350 total=0.9421 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9421 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 35 it 400 total=0.9420 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9420 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 36 it 20 total=0.9419 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9419 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 70 total=0.9419 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9419 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 36 it 120 total=0.9418 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9418 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 36 it 170 total=0.9417 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9417 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 220 total=0.9417 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9417 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 270 total=0.9416 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9416 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 320 total=0.9415 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9415 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 36 it 370 total=0.9414 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9414 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 420 total=0.9414 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9414 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 40 total=0.9413 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9413 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 90 total=0.9412 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9412 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 140 total=0.9412 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9412 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 190 total=0.9411 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9411 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 37 it 240 total=0.9410 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9410 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 290 total=0.9410 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9410 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 340 total=0.9409 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9409 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 390 total=0.9408 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9408 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 10 total=0.9408 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9408 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 38 it 60 total=0.9407 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9407 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 38 it 110 total=0.9406 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9406 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 160 total=0.9406 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9406 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 210 total=0.9405 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9405 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 260 total=0.9405 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9405 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 38 it 310 total=0.9404 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9404 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 360 total=0.9403 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9403 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 38 it 410 total=0.9403 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9403 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 30 total=0.9402 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9402 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 39 it 80 total=0.9402 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9402 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 130 total=0.9401 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9401 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 180 total=0.9400 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9400 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 230 total=0.9400 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9400 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA

 80%|████████  | 40/50 [28:18<06:24, 38.42s/it]
 82%|████████▏ | 41/50 [28:53<05:37, 37.48s/it]
 84%|████████▍ | 42/50 [29:35<05:10, 38.85s/it]
 86%|████████▌ | 43/50 [30:13<04:29, 38.51s/it]
 88%|████████▊ | 44/50 [30:52<03:51, 38.63s/it]
 90%|█████████ | 45/50 [31:34<03:18, 39.65s/it]
 92%|█████████▏| 46/50 [32:17<02:42, 40.69s/it][loss] ep 39 it 280 total=0.9399 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9399 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 39 it 330 total=0.9399 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9399 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 380 total=0.9398 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9398 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 40 it 0 total=0.9398 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9398 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 50 total=0.9397 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9397 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 40 it 100 total=0.9397 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9397 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 40 it 150 total=0.9396 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9396 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 40 it 200 total=0.9396 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9396 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 40 it 250 total=0.9395 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9395 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 300 total=0.9395 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9395 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 350 total=0.9394 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9394 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 400 total=0.9394 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9394 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 41 it 20 total=0.9393 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9393 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 70 total=0.9393 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9393 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 120 total=0.9392 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9392 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 170 total=0.9392 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9392 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 220 total=0.9392 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9392 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 41 it 270 total=0.9391 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9391 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 320 total=0.9391 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9391 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 370 total=0.9390 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9390 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 420 total=0.9390 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9390 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 40 total=0.9390 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9390 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 90 total=0.9389 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9389 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 140 total=0.9389 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9389 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 42 it 190 total=0.9388 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9388 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 240 total=0.9388 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9388 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 290 total=0.9388 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9388 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 340 total=0.9387 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9387 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 390 total=0.9387 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9387 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 43 it 10 total=0.9387 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9387 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 60 total=0.9386 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9386 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 43 it 110 total=0.9386 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9386 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 43 it 160 total=0.9386 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9386 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 43 it 210 total=0.9386 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9386 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 43 it 260 total=0.9385 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9385 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 310 total=0.9385 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9385 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 360 total=0.9385 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9385 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 43 it 410 total=0.9385 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9385 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 44 it 30 total=0.9384 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9384 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 80 total=0.9384 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9384 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 130 total=0.9384 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9384 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 180 total=0.9384 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9384 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 44 it 230 total=0.9383 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9383 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 44 it 280 total=0.9383 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9383 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 330 total=0.9383 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9383 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 44 it 380 total=0.9383 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9383 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 45 it 0 total=0.9383 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9383 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 45 it 50 total=0.9383 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9383 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 45 it 100 total=0.9382 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9382 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 45 it 150 total=0.9382 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9382 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 45 it 200 total=0.9382 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9382 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 250 total=0.9382 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9382 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 45 it 300 total=0.9382 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9382 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 45 it 350 total=0.9382 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9382 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 45 it 400 total=0.9382 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9382 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 46 it 20 total=0.9382 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9382 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 46 it 70 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 46 it 120 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 46 it 170 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 220 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 46 it 270 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA

 94%|█████████▍| 47/50 [32:49<01:54, 38.23s/it]
 96%|█████████▌| 48/50 [33:23<01:13, 36.84s/it]
 98%|█████████▊| 49/50 [33:58<00:36, 36.42s/it]
100%|██████████| 50/50 [34:36<00:00, 36.85s/it]
100%|██████████| 50/50 [34:36<00:00, 41.53s/it]
[loss] ep 46 it 320 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 46 it 370 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 420 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 47 it 40 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 47 it 90 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 140 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 47 it 190 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 47 it 240 total=0.9381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9381 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 47 it 290 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 47 it 340 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 390 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[loss] ep 48 it 10 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 48 it 60 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 48 it 110 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 48 it 160 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 48 it 210 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 48 it 260 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 310 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 360 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 48 it 410 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 49 it 30 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=13 protos=None fproto_sim=NA
[loss] ep 49 it 80 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 49 it 130 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 49 it 180 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 49 it 230 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=13 protos=None fproto_sim=NA
[loss] ep 49 it 280 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 49 it 330 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 49 it 380 total=0.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9380 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images

  0%|          | 0/430 [00:00<?, ?it/s]
  0%|          | 1/430 [00:00<04:49,  1.48it/s]
  2%|▏         | 7/430 [00:00<00:36, 11.45it/s]
  3%|▎         | 12/430 [00:00<00:22, 18.80it/s]
  4%|▍         | 17/430 [00:00<00:16, 25.31it/s]
  5%|▌         | 23/430 [00:01<00:12, 32.07it/s]
  7%|▋         | 30/430 [00:01<00:10, 39.35it/s]
  8%|▊         | 36/430 [00:01<00:09, 42.24it/s]
 10%|▉         | 42/430 [00:01<00:08, 45.53it/s]
 11%|█         | 48/430 [00:01<00:08, 47.44it/s]
 13%|█▎        | 54/430 [00:01<00:07, 47.82it/s]
 14%|█▍        | 60/430 [00:01<00:07, 48.02it/s]
 15%|█▌        | 66/430 [00:01<00:07, 48.80it/s]
 17%|█▋        | 72/430 [00:02<00:07, 49.32it/s]
 18%|█▊        | 78/430 [00:02<00:07, 49.83it/s]
 20%|█▉        | 84/430 [00:02<00:06, 49.99it/s]
 21%|██        | 90/430 [00:02<00:06, 52.44it/s]
 22%|██▏       | 96/430 [00:02<00:06, 54.41it/s]
 24%|██▎       | 102/430 [00:02<00:05, 54.90it/s]
 25%|██▌       | 108/430 [00:02<00:05, 54.67it/s]
 27%|██▋       | 114/430 [00:02<00:06, 50.46it/s]
 28%|██▊       | 120/430 [00:02<00:05, 51.77it/s]
 29%|██▉       | 126/430 [00:03<00:05, 52.27it/s]
 31%|███       | 132/430 [00:03<00:05, 52.09it/s]
 32%|███▏      | 138/430 [00:03<00:05, 52.11it/s]
 33%|███▎      | 144/430 [00:03<00:05, 53.33it/s]
 35%|███▍      | 150/430 [00:03<00:05, 52.94it/s]
 36%|███▋      | 156/430 [00:03<00:05, 54.75it/s]
 38%|███▊      | 163/430 [00:03<00:04, 55.92it/s]
 39%|███▉      | 169/430 [00:03<00:05, 51.61it/s]
 41%|████      | 175/430 [00:04<00:05, 49.73it/s]
 42%|████▏     | 181/430 [00:04<00:05, 48.74it/s]
 43%|████▎     | 187/430 [00:04<00:04, 50.29it/s]
 45%|████▍     | 193/430 [00:04<00:04, 48.99it/s]
 46%|████▌     | 198/430 [00:04<00:04, 48.51it/s]
 47%|████▋     | 203/430 [00:04<00:04, 46.30it/s]
 49%|████▊     | 209/430 [00:04<00:04, 49.14it/s]
 50%|████▉     | 214/430 [00:04<00:04, 48.31it/s]
 51%|█████     | 219/430 [00:04<00:04, 44.91it/s]
 52%|█████▏    | 224/430 [00:05<00:04, 45.01it/s]
 53%|█████▎    | 230/430 [00:05<00:04, 47.94it/s]
 55%|█████▍    | 235/430 [00:05<00:04, 46.45it/s]
 56%|█████▌    | 240/430 [00:05<00:04, 40.99it/s]
 57%|█████▋    | 247/430 [00:05<00:03, 45.91it/s]
 59%|█████▊    | 252/430 [00:05<00:03, 45.98it/s]
 60%|█████▉    | 257/430 [00:05<00:04, 40.68it/s]
 61%|██████    | 262/430 [00:05<00:04, 40.91it/s]
 62%|██████▏   | 267/430 [00:06<00:03, 41.69it/s]
 63%|██████▎   | 272/430 [00:06<00:03, 41.61it/s]
 64%|██████▍   | 277/430 [00:06<00:03, 41.02it/s]
 66%|██████▌   | 282/430 [00:06<00:03, 40.19it/s]
 67%|██████▋   | 287/430 [00:06<00:03, 39.77it/s]
 68%|██████▊   | 291/430 [00:06<00:03, 39.65it/s]
 69%|██████▉   | 296/430 [00:06<00:03, 40.17it/s]
 70%|███████   | 302/430 [00:06<00:02, 44.52it/s]
 71%|███████▏  | 307/430 [00:07<00:02, 44.82it/s]
 73%|███████▎  | 312/430 [00:07<00:02, 45.41it/s]
 74%|███████▎  | 317/430 [00:07<00:02, 45.58it/s]
 75%|███████▌  | 323/430 [00:07<00:02, 48.68it/s]
 76%|███████▋  | 328/430 [00:07<00:02, 47.69it/s]
 77%|███████▋  | 333/430 [00:07<00:02, 47.30it/s]
 79%|███████▊  | 338/430 [00:07<00:01, 46.98it/s]
 80%|███████▉  | 343/430 [00:07<00:01, 46.73it/s]
 81%|████████  | 348/430 [00:07<00:01, 47.26it/s]
 82%|████████▏ | 353/430 [00:08<00:01, 46.94it/s]
 83%|████████▎ | 358/430 [00:08<00:01, 46.29it/s]
 84%|████████▍ | 363/430 [00:08<00:01, 46.27it/s]
 86%|████████▌ | 369/430 [00:08<00:01, 49.71it/s]
 87%|████████▋ | 374/430 [00:08<00:01, 47.69it/s]
 88%|████████▊ | 379/430 [00:08<00:01, 47.25it/s]
 89%|████████▉ | 384/430 [00:08<00:00, 47.89it/s]
 90%|█████████ | 389/430 [00:08<00:00, 47.42it/s]
 92%|█████████▏| 394/430 [00:08<00:00, 46.96it/s]
 93%|█████████▎| 399/430 [00:08<00:00, 44.28it/s]
 94%|█████████▍| 404/430 [00:09<00:00, 45.01it/s]
 95%|█████████▌| 409/430 [00:09<00:00, 45.33it/s]
 97%|█████████▋| 415/430 [00:09<00:00, 48.76it/s]
 98%|█████████▊| 420/430 [00:09<00:00, 42.80it/s]
 99%|█████████▉| 425/430 [00:09<00:00, 43.77it/s]
100%|██████████| 430/430 [00:09<00:00, 44.58it/s]
100%|██████████| 430/430 [00:09<00:00, 44.42it/s]
55000 images processed, 9.784014463424683 seconds used

Processing in-distribution CIFAR-110 images

  0%|          | 0/86 [00:00<?, ?it/s]
  1%|          | 1/86 [00:00<00:57,  1.47it/s]
  7%|▋         | 6/86 [00:00<00:08,  9.70it/s]
 13%|█▎        | 11/86 [00:00<00:04, 17.37it/s]
 19%|█▊        | 16/86 [00:01<00:02, 24.00it/s]
 26%|██▌       | 22/86 [00:01<00:02, 31.70it/s]
 31%|███▏      | 27/86 [00:01<00:01, 34.60it/s]
 37%|███▋      | 32/86 [00:01<00:01, 37.76it/s]
 43%|████▎     | 37/86 [00:01<00:01, 40.09it/s]
 49%|████▉     | 42/86 [00:01<00:01, 42.15it/s]
 57%|█████▋    | 49/86 [00:01<00:00, 47.26it/s]
 63%|██████▎   | 54/86 [00:01<00:00, 46.93it/s]
 69%|██████▊   | 59/86 [00:01<00:00, 46.81it/s]
 74%|███████▍  | 64/86 [00:01<00:00, 46.65it/s]
 81%|████████▏ | 70/86 [00:02<00:00, 48.79it/s]
 87%|████████▋ | 75/86 [00:02<00:00, 46.14it/s]
 93%|█████████▎| 80/86 [00:02<00:00, 46.27it/s]
 99%|█████████▉| 85/86 [00:02<00:00, 46.29it/s]
100%|██████████| 86/86 [00:02<00:00, 34.77it/s]
11000 images processed, 2.491149663925171 seconds used

Processing out-of-distribution SVHN images

  0%|          | 0/204 [00:00<?, ?it/s]
  0%|          | 1/204 [00:00<02:24,  1.41it/s]
  3%|▎         | 6/204 [00:00<00:21,  9.34it/s]
  5%|▌         | 11/204 [00:00<00:11, 16.40it/s]
  8%|▊         | 16/204 [00:01<00:08, 22.44it/s]
 10%|█         | 21/204 [00:01<00:06, 28.29it/s]
 13%|█▎        | 26/204 [00:01<00:05, 32.00it/s]
 15%|█▌        | 31/204 [00:01<00:04, 34.79it/s]
 18%|█▊        | 36/204 [00:01<00:04, 36.81it/s]
 21%|██        | 42/204 [00:01<00:04, 40.27it/s]
 23%|██▎       | 47/204 [00:01<00:04, 36.24it/s]
 25%|██▌       | 51/204 [00:01<00:04, 37.09it/s]
 28%|██▊       | 57/204 [00:02<00:03, 41.46it/s]
 30%|███       | 62/204 [00:02<00:03, 41.57it/s]
 33%|███▎      | 67/204 [00:02<00:03, 41.70it/s]
 35%|███▌      | 72/204 [00:02<00:03, 38.74it/s]
 38%|███▊      | 77/204 [00:02<00:03, 41.44it/s]
 40%|████      | 82/204 [00:02<00:02, 40.96it/s]
 43%|████▎     | 87/204 [00:02<00:02, 41.22it/s]
 45%|████▌     | 92/204 [00:02<00:02, 42.74it/s]
 48%|████▊     | 97/204 [00:02<00:02, 44.59it/s]
 50%|█████     | 102/204 [00:03<00:02, 43.07it/s]
 52%|█████▏    | 107/204 [00:03<00:02, 42.71it/s]
 55%|█████▍    | 112/204 [00:03<00:02, 43.92it/s]
 57%|█████▋    | 117/204 [00:03<00:01, 44.72it/s]
 60%|█████▉    | 122/204 [00:03<00:01, 43.88it/s]
 62%|██████▏   | 127/204 [00:03<00:01, 42.78it/s]
 65%|██████▍   | 132/204 [00:03<00:01, 44.18it/s]
 67%|██████▋   | 137/204 [00:03<00:01, 44.11it/s]
 70%|██████▉   | 142/204 [00:04<00:01, 43.49it/s]
 72%|███████▏  | 147/204 [00:04<00:01, 42.97it/s]
 75%|███████▍  | 152/204 [00:04<00:01, 44.82it/s]
 77%|███████▋  | 157/204 [00:04<00:01, 44.56it/s]
 79%|███████▉  | 162/204 [00:04<00:00, 43.53it/s]
 82%|████████▏ | 167/204 [00:04<00:00, 42.76it/s]
 85%|████████▍ | 173/204 [00:04<00:00, 46.50it/s]
 87%|████████▋ | 178/204 [00:04<00:00, 46.30it/s]
 90%|████████▉ | 183/204 [00:04<00:00, 44.96it/s]
 92%|█████████▏| 188/204 [00:05<00:00, 44.01it/s]
 95%|█████████▍| 193/204 [00:05<00:00, 45.17it/s]
 97%|█████████▋| 198/204 [00:05<00:00, 44.82it/s]
100%|█████████▉| 203/204 [00:05<00:00, 43.95it/s]
100%|██████████| 204/204 [00:05<00:00, 37.76it/s]
26032 images processed, 5.676491737365723 seconds used

Processing out-of-distribution places365 images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:00<01:15,  1.03it/s]
  8%|▊         | 6/79 [00:01<00:10,  7.14it/s]
 14%|█▍        | 11/79 [00:01<00:05, 13.43it/s]
 20%|██        | 16/79 [00:01<00:03, 19.13it/s]
 28%|██▊       | 22/79 [00:01<00:02, 26.45it/s]
 34%|███▍      | 27/79 [00:01<00:01, 29.95it/s]
 41%|████      | 32/79 [00:01<00:01, 33.11it/s]
 47%|████▋     | 37/79 [00:01<00:01, 35.45it/s]
 54%|█████▍    | 43/79 [00:01<00:00, 39.41it/s]
 61%|██████    | 48/79 [00:02<00:00, 40.07it/s]
 67%|██████▋   | 53/79 [00:02<00:00, 40.17it/s]
 73%|███████▎  | 58/79 [00:02<00:00, 41.80it/s]
 80%|███████▉  | 63/79 [00:02<00:00, 43.60it/s]
 86%|████████▌ | 68/79 [00:02<00:00, 43.10it/s]
 92%|█████████▏| 73/79 [00:02<00:00, 44.81it/s]
 99%|█████████▊| 78/79 [00:02<00:00, 43.86it/s]
100%|██████████| 79/79 [00:03<00:00, 21.29it/s]
10000 images processed, 3.7429416179656982 seconds used

Processing out-of-distribution LSUN images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:00<00:54,  1.42it/s]
  9%|▉         | 7/79 [00:00<00:06, 10.99it/s]
 14%|█▍        | 11/79 [00:00<00:04, 16.33it/s]
 20%|██        | 16/79 [00:01<00:02, 23.19it/s]
 27%|██▋       | 21/79 [00:01<00:02, 28.14it/s]
 33%|███▎      | 26/79 [00:01<00:01, 32.66it/s]
 39%|███▉      | 31/79 [00:01<00:01, 35.37it/s]
 46%|████▌     | 36/79 [00:01<00:01, 37.57it/s]
 53%|█████▎    | 42/79 [00:01<00:00, 41.16it/s]
 59%|█████▉    | 47/79 [00:01<00:00, 41.41it/s]
 67%|██████▋   | 53/79 [00:01<00:00, 43.59it/s]
 73%|███████▎  | 58/79 [00:01<00:00, 42.09it/s]
 81%|████████  | 64/79 [00:02<00:00, 44.31it/s]
 87%|████████▋ | 69/79 [00:02<00:00, 43.75it/s]
 94%|█████████▎| 74/79 [00:02<00:00, 44.67it/s]
100%|██████████| 79/79 [00:02<00:00, 46.04it/s]
100%|██████████| 79/79 [00:02<00:00, 32.49it/s]
10000 images processed, 2.453749895095825 seconds used

Processing out-of-distribution iSUN images

  0%|          | 0/70 [00:00<?, ?it/s]
  1%|▏         | 1/70 [00:00<00:51,  1.34it/s]
  6%|▌         | 4/70 [00:00<00:11,  5.91it/s]
 13%|█▎        | 9/70 [00:00<00:04, 14.07it/s]
 20%|██        | 14/70 [00:01<00:02, 20.65it/s]
 27%|██▋       | 19/70 [00:01<00:01, 27.07it/s]
 34%|███▍      | 24/70 [00:01<00:01, 31.26it/s]
 41%|████▏     | 29/70 [00:01<00:01, 35.43it/s]
 49%|████▊     | 34/70 [00:01<00:00, 37.69it/s]
 56%|█████▌    | 39/70 [00:01<00:00, 38.80it/s]
 63%|██████▎   | 44/70 [00:01<00:00, 41.13it/s]
 70%|███████   | 49/70 [00:01<00:00, 41.73it/s]
 77%|███████▋  | 54/70 [00:01<00:00, 43.54it/s]
 84%|████████▍ | 59/70 [00:02<00:00, 43.21it/s]
 93%|█████████▎| 65/70 [00:02<00:00, 44.97it/s]
100%|██████████| 70/70 [00:02<00:00, 44.10it/s]
100%|██████████| 70/70 [00:02<00:00, 30.18it/s]
8925 images processed, 2.36100172996521 seconds used

Processing out-of-distribution dtd images

  0%|          | 0/45 [00:00<?, ?it/s]
  2%|▏         | 1/45 [00:01<00:52,  1.20s/it]
  4%|▍         | 2/45 [00:01<00:25,  1.69it/s]
 16%|█▌        | 7/45 [00:01<00:05,  7.55it/s]
 27%|██▋       | 12/45 [00:01<00:02, 13.76it/s]
 38%|███▊      | 17/45 [00:01<00:02, 13.78it/s]
 49%|████▉     | 22/45 [00:02<00:01, 18.58it/s]
 62%|██████▏   | 28/45 [00:02<00:00, 24.69it/s]
 73%|███████▎  | 33/45 [00:02<00:00, 17.45it/s]
 82%|████████▏ | 37/45 [00:02<00:00, 20.17it/s]
 91%|█████████ | 41/45 [00:02<00:00, 21.60it/s]
100%|██████████| 45/45 [00:03<00:00, 14.95it/s]
5640 images processed, 3.0332448482513428 seconds used

31.373398542404175
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.78  98.86
places365     52.75  85.08
LSUN          44.68  89.26
iSUN          35.83  91.28
dtd           32.80  92.10
AVG           33.97  91.32
[incremental] Overall: 0.7410 New: 0.7220 Old: 0.7600
[incremental] Final(Top-1): 0.7410  Average: 0.7955
21.476380586624146
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='forget_only', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt

  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:165: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:239: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

  2%|▏         | 1/50 [01:27<1:11:34, 87.65s/it]
  4%|▍         | 2/50 [02:16<51:50, 64.79s/it]  
  6%|▌         | 3/50 [02:58<42:37, 54.41s/it]
  8%|▊         | 4/50 [03:45<39:34, 51.62s/it]
 10%|█         | 5/50 [04:29<36:34, 48.78s/it]
 12%|█▏        | 6/50 [05:13<34:31, 47.08s/it][loss] ep 0 it 0 total=1.8664 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8664 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=1.8658 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8658 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=1.8648 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8648 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=1.8630 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8630 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=1.8605 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8605 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=1.8573 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8573 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=1.8533 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8533 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=1.8486 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8486 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 400 total=1.8431 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8431 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 1 it 20 total=1.8369 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8369 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 70 total=1.8298 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8298 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 120 total=1.8220 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8220 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 170 total=1.8132 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8132 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 220 total=1.8037 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8037 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 270 total=1.7932 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.7932 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 320 total=1.7819 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.7819 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 370 total=1.7696 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.7696 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 420 total=1.7564 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.7564 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 40 total=1.7421 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.7421 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 90 total=1.7269 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.7269 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 140 total=1.7106 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.7106 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 190 total=1.6932 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.6932 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 240 total=1.6748 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.6748 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 290 total=1.6552 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.6552 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 340 total=1.6346 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.6346 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 390 total=1.6128 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.6128 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 3 it 10 total=1.5898 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.5898 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 60 total=1.5658 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.5658 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 110 total=1.5406 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.5406 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 160 total=1.5143 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.5143 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 210 total=1.4870 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.4870 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 260 total=1.4587 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.4587 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 310 total=1.4295 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.4295 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 360 total=1.3993 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.3993 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 410 total=1.3684 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.3684 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 4 it 30 total=1.3368 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.3368 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 4 it 80 total=1.3047 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.3047 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 130 total=1.2720 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.2720 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 180 total=1.2391 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.2391 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 230 total=1.2059 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.2059 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 280 total=1.1726 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.1726 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 330 total=1.1394 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.1394 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 380 total=1.1064 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.1064 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 0 total=1.0737 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0737 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 50 total=1.0414 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0414 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 100 total=1.0097 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0097 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 150 total=0.9787 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9787 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 200 total=0.9484 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9484 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 250 total=0.9190 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9190 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 5 it 300 total=0.8905 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.8905 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 350 total=0.8629 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.8629 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 400 total=0.8363 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.8363 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 6 it 20 total=0.8108 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.8108 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 70 total=0.7862 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.7862 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 120 total=0.7627 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.7627 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 170 total=0.7403 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.7403 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA

 14%|█▍        | 7/50 [05:48<30:58, 43.21s/it]
 16%|█▌        | 8/50 [06:38<31:48, 45.43s/it]
 18%|█▊        | 9/50 [07:16<29:18, 42.90s/it]
 20%|██        | 10/50 [07:50<26:50, 40.25s/it]
 22%|██▏       | 11/50 [08:31<26:16, 40.43s/it]
 24%|██▍       | 12/50 [09:04<24:09, 38.15s/it]
 26%|██▌       | 13/50 [09:37<22:34, 36.60s/it][loss] ep 6 it 220 total=0.7189 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.7189 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 270 total=0.6984 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6984 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 320 total=0.6790 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6790 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 370 total=0.6605 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6605 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 420 total=0.6429 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6429 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 7 it 40 total=0.6263 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6263 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 90 total=0.6105 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6105 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 140 total=0.5955 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5955 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 190 total=0.5813 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5813 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 240 total=0.5679 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5679 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 290 total=0.5553 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5553 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 340 total=0.5433 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5433 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 390 total=0.5320 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5320 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 10 total=0.5213 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5213 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 60 total=0.5112 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5112 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 110 total=0.5016 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5016 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 160 total=0.4925 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4925 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 210 total=0.4840 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4840 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 260 total=0.4758 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4758 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 310 total=0.4681 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4681 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 360 total=0.4608 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4608 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 410 total=0.4538 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4538 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 30 total=0.4472 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4472 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 80 total=0.4408 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4408 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 130 total=0.4347 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4347 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 180 total=0.4289 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4289 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 230 total=0.4234 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4234 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 280 total=0.4180 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4180 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 330 total=0.4129 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4129 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 380 total=0.4079 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4079 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 0 total=0.4031 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4031 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 50 total=0.3986 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3986 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 100 total=0.3942 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3942 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 150 total=0.3899 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3899 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 200 total=0.3859 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3859 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 250 total=0.3820 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3820 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 300 total=0.3782 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3782 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 350 total=0.3746 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3746 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 400 total=0.3711 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3711 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 11 it 20 total=0.3677 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3677 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 70 total=0.3645 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3645 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 120 total=0.3613 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3613 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 170 total=0.3582 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3582 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 220 total=0.3552 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3552 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 270 total=0.3523 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3523 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 320 total=0.3495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3495 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 11 it 370 total=0.3467 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3467 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 420 total=0.3441 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3441 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 40 total=0.3414 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3414 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 12 it 90 total=0.3389 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3389 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 140 total=0.3364 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3364 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 190 total=0.3340 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3340 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 240 total=0.3316 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3316 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 290 total=0.3293 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3293 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 340 total=0.3270 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3270 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 390 total=0.3248 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3248 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 10 total=0.3227 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3227 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 60 total=0.3206 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3206 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 13 it 110 total=0.3185 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3185 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 160 total=0.3165 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3165 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
 28%|██▊       | 14/50 [10:21<23:23, 38.98s/it]
 30%|███       | 15/50 [11:03<23:13, 39.81s/it]
 32%|███▏      | 16/50 [11:55<24:38, 43.49s/it]
 34%|███▍      | 17/50 [12:41<24:22, 44.33s/it]
 36%|███▌      | 18/50 [13:21<22:53, 42.93s/it]
 38%|███▊      | 19/50 [14:03<22:03, 42.71s/it]
 40%|████      | 20/50 [14:59<23:16, 46.55s/it]
[loss] ep 13 it 210 total=0.3145 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3145 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 260 total=0.3125 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3125 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 310 total=0.3106 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3106 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 360 total=0.3088 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3088 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 410 total=0.3070 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3070 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 14 it 30 total=0.3052 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3052 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 80 total=0.3034 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3034 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 130 total=0.3017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3017 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 180 total=0.3000 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3000 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 230 total=0.2983 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2983 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 280 total=0.2967 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2967 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 330 total=0.2951 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2951 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 380 total=0.2936 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2936 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 15 it 0 total=0.2920 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2920 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 50 total=0.2905 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2905 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 100 total=0.2890 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2890 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 15 it 150 total=0.2876 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2876 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 200 total=0.2862 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2862 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 250 total=0.2848 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2848 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 300 total=0.2834 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2834 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 350 total=0.2820 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2820 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 15 it 400 total=0.2807 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2807 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 20 total=0.2794 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2794 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 70 total=0.2781 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2781 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 120 total=0.2769 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2769 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 170 total=0.2757 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2757 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 220 total=0.2744 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2744 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 270 total=0.2733 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2733 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 320 total=0.2721 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2721 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 370 total=0.2709 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2709 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 420 total=0.2698 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2698 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 17 it 40 total=0.2687 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2687 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 90 total=0.2676 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2676 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 140 total=0.2665 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2665 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 190 total=0.2655 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2655 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 240 total=0.2645 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2645 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 290 total=0.2634 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2634 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 340 total=0.2624 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2624 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 17 it 390 total=0.2615 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2615 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 10 total=0.2605 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2605 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 60 total=0.2595 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2595 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 110 total=0.2586 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2586 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 160 total=0.2577 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2577 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 210 total=0.2568 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2568 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 260 total=0.2559 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2559 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 310 total=0.2550 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2550 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 360 total=0.2542 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2542 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 410 total=0.2534 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2534 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 30 total=0.2525 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2525 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 80 total=0.2517 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2517 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 130 total=0.2509 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2509 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 19 it 180 total=0.2501 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2501 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 230 total=0.2494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2494 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 19 it 280 total=0.2486 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2486 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 330 total=0.2479 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2479 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 380 total=0.2471 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2471 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 0 total=0.2464 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2464 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 20 it 50 total=0.2457 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2457 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA

 42%|████▏     | 21/50 [15:45<22:26, 46.45s/it]
 44%|████▍     | 22/50 [16:44<23:26, 50.22s/it]
 46%|████▌     | 23/50 [17:51<24:50, 55.19s/it]
 48%|████▊     | 24/50 [18:51<24:35, 56.76s/it]
 50%|█████     | 25/50 [19:50<23:54, 57.39s/it]
 52%|█████▏    | 26/50 [20:36<21:37, 54.06s/it]
 54%|█████▍    | 27/50 [21:17<19:12, 50.10s/it][loss] ep 20 it 100 total=0.2450 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2450 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 150 total=0.2443 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2443 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 20 it 200 total=0.2436 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2436 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 20 it 250 total=0.2430 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2430 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 300 total=0.2423 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2423 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 350 total=0.2417 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2417 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 400 total=0.2411 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2411 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 20 total=0.2404 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2404 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 70 total=0.2398 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2398 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 120 total=0.2392 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2392 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 21 it 170 total=0.2386 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2386 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 220 total=0.2381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2381 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 270 total=0.2375 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2375 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 320 total=0.2369 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2369 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 21 it 370 total=0.2364 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2364 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 420 total=0.2358 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2358 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 40 total=0.2353 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2353 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 90 total=0.2348 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2348 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 140 total=0.2342 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2342 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 190 total=0.2337 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2337 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 22 it 240 total=0.2332 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2332 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 290 total=0.2327 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2327 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 22 it 340 total=0.2322 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2322 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 390 total=0.2317 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2317 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 10 total=0.2313 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2313 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 60 total=0.2308 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2308 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 110 total=0.2303 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2303 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 160 total=0.2299 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2299 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 210 total=0.2294 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2294 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 260 total=0.2290 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2290 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 23 it 310 total=0.2286 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2286 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 23 it 360 total=0.2282 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2282 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 410 total=0.2277 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2277 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 30 total=0.2273 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2273 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 24 it 80 total=0.2269 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2269 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 130 total=0.2265 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2265 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 180 total=0.2261 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2261 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 230 total=0.2257 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2257 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 280 total=0.2253 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2253 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 330 total=0.2250 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2250 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 380 total=0.2246 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2246 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 25 it 0 total=0.2242 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2242 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 50 total=0.2239 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2239 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 100 total=0.2235 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2235 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 25 it 150 total=0.2231 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2231 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 25 it 200 total=0.2228 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2228 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 250 total=0.2225 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2225 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 300 total=0.2221 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2221 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 350 total=0.2218 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2218 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 400 total=0.2215 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2215 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 26 it 20 total=0.2211 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2211 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 70 total=0.2208 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2208 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 120 total=0.2205 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2205 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 170 total=0.2202 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2202 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 220 total=0.2199 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2199 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 26 it 270 total=0.2196 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2196 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 320 total=0.2193 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2193 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 370 total=0.2190 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2190 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 420 total=0.2187 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2187 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3

 56%|█████▌    | 28/50 [21:56<17:11, 46.89s/it]
 58%|█████▊    | 29/50 [22:36<15:38, 44.69s/it]
 60%|██████    | 30/50 [23:15<14:18, 42.93s/it]
 62%|██████▏   | 31/50 [23:55<13:20, 42.15s/it]
 64%|██████▍   | 32/50 [24:33<12:17, 40.97s/it]
 66%|██████▌   | 33/50 [25:12<11:22, 40.13s/it]
 68%|██████▊   | 34/50 [25:51<10:39, 39.94s/it][loss] ep 27 it 40 total=0.2184 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2184 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 27 it 90 total=0.2181 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2181 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 140 total=0.2179 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2179 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 190 total=0.2176 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2176 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 240 total=0.2173 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2173 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 290 total=0.2171 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2171 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 340 total=0.2168 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2168 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 390 total=0.2165 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2165 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 10 total=0.2163 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2163 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 60 total=0.2160 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2160 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 110 total=0.2158 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2158 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 160 total=0.2155 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2155 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 210 total=0.2153 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2153 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 260 total=0.2151 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2151 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 310 total=0.2148 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2148 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 360 total=0.2146 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2146 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 410 total=0.2144 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2144 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 30 total=0.2141 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2141 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 80 total=0.2139 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2139 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 130 total=0.2137 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2137 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 29 it 180 total=0.2135 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2135 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 230 total=0.2133 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2133 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 280 total=0.2131 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2131 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 330 total=0.2129 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2129 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 380 total=0.2127 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2127 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 0 total=0.2125 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2125 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 50 total=0.2123 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2123 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 30 it 100 total=0.2121 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2121 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 30 it 150 total=0.2119 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2119 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 30 it 200 total=0.2117 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2117 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 250 total=0.2115 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2115 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 30 it 300 total=0.2113 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2113 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 350 total=0.2111 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2111 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 400 total=0.2110 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2110 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 20 total=0.2108 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2108 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 70 total=0.2106 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2106 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 120 total=0.2104 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2104 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 170 total=0.2103 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2103 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 220 total=0.2101 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2101 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 270 total=0.2099 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2099 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 320 total=0.2098 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2098 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 370 total=0.2096 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2096 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 420 total=0.2095 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2095 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 40 total=0.2093 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2093 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 90 total=0.2092 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2092 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 140 total=0.2090 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2090 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 190 total=0.2089 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2089 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 32 it 240 total=0.2087 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2087 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 290 total=0.2086 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2086 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 340 total=0.2084 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2084 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 390 total=0.2083 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2083 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 33 it 10 total=0.2081 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2081 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 60 total=0.2080 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2080 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 110 total=0.2079 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2079 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 160 total=0.2077 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2077 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 210 total=0.2076 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2076 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 260 total=0.2075 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2075 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 310 total=0.2074 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2074 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 360 total=0.2072 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2072 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 410 total=0.2071 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2071 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 30 total=0.2070 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2070 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA

 70%|███████   | 35/50 [26:27<09:39, 38.63s/it]
 72%|███████▏  | 36/50 [27:08<09:12, 39.46s/it]
 74%|███████▍  | 37/50 [27:47<08:32, 39.42s/it]
 76%|███████▌  | 38/50 [28:26<07:49, 39.13s/it]
 78%|███████▊  | 39/50 [29:03<07:04, 38.62s/it]
 80%|████████  | 40/50 [29:30<05:50, 35.10s/it][loss] ep 34 it 80 total=0.2069 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2069 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 130 total=0.2068 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2068 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 34 it 180 total=0.2066 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2066 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 230 total=0.2065 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2065 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 280 total=0.2064 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2064 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 330 total=0.2063 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2063 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 380 total=0.2062 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2062 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 35 it 0 total=0.2061 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2061 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 50 total=0.2060 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2060 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 100 total=0.2059 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2059 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 150 total=0.2058 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2058 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 35 it 200 total=0.2057 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2057 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 35 it 250 total=0.2056 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2056 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 300 total=0.2055 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2055 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 350 total=0.2054 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2054 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 400 total=0.2053 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2053 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 20 total=0.2052 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2052 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 70 total=0.2051 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2051 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 120 total=0.2051 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2051 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 170 total=0.2050 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2050 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 220 total=0.2049 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2049 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 270 total=0.2048 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2048 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 320 total=0.2047 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2047 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 370 total=0.2046 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2046 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 420 total=0.2046 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2046 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 37 it 40 total=0.2045 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2045 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 37 it 90 total=0.2044 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2044 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 37 it 140 total=0.2043 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2043 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 190 total=0.2043 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2043 favg=0.0000 nr=0 nf=13 protos=None fproto_sim=NA
[loss] ep 37 it 240 total=0.2042 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2042 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 290 total=0.2041 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2041 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 340 total=0.2040 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2040 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 37 it 390 total=0.2040 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2040 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 10 total=0.2039 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2039 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 38 it 60 total=0.2039 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2039 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 110 total=0.2038 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2038 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 38 it 160 total=0.2037 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2037 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 38 it 210 total=0.2037 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2037 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 260 total=0.2036 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2036 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 310 total=0.2035 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2035 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 360 total=0.2035 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2035 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 410 total=0.2034 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2034 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 39 it 30 total=0.2034 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2034 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 80 total=0.2033 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2033 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 130 total=0.2033 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2033 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 180 total=0.2032 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2032 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 230 total=0.2032 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2032 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 280 total=0.2031 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2031 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 330 total=0.2031 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2031 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 39 it 380 total=0.2030 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2030 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 40 it 0 total=0.2030 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2030 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 50 total=0.2029 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2029 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 100 total=0.2029 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2029 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 150 total=0.2028 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2028 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 200 total=0.2028 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2028 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 250 total=0.2028 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2028 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 300 total=0.2027 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2027 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 350 total=0.2027 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2027 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 400 total=0.2026 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2026 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA

 82%|████████▏ | 41/50 [29:58<04:55, 32.79s/it]
 84%|████████▍ | 42/50 [30:25<04:10, 31.26s/it]
 86%|████████▌ | 43/50 [30:52<03:29, 29.88s/it]
 88%|████████▊ | 44/50 [31:20<02:56, 29.41s/it]
 90%|█████████ | 45/50 [31:48<02:24, 28.97s/it]
 92%|█████████▏| 46/50 [32:15<01:53, 28.34s/it]
 94%|█████████▍| 47/50 [32:42<01:24, 28.02s/it][peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 41 it 20 total=0.2026 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2026 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 70 total=0.2026 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2026 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 120 total=0.2025 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2025 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 170 total=0.2025 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2025 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 220 total=0.2025 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2025 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 41 it 270 total=0.2024 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2024 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 320 total=0.2024 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2024 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 370 total=0.2024 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2024 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 420 total=0.2023 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2023 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 42 it 40 total=0.2023 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2023 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 90 total=0.2023 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2023 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 140 total=0.2023 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2023 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 42 it 190 total=0.2022 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2022 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 42 it 240 total=0.2022 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2022 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 290 total=0.2022 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2022 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 42 it 340 total=0.2022 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2022 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 42 it 390 total=0.2021 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2021 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 43 it 10 total=0.2021 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2021 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 43 it 60 total=0.2021 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2021 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 110 total=0.2021 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2021 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 160 total=0.2020 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2020 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 210 total=0.2020 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2020 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 260 total=0.2020 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2020 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 310 total=0.2020 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2020 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 360 total=0.2020 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2020 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 410 total=0.2020 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2020 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 44 it 30 total=0.2019 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2019 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 44 it 80 total=0.2019 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2019 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 130 total=0.2019 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2019 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 180 total=0.2019 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2019 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 230 total=0.2019 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2019 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 44 it 280 total=0.2019 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2019 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 330 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 380 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 0 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 45 it 50 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 45 it 100 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 45 it 150 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 45 it 200 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 45 it 250 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 300 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 350 total=0.2018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2018 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 45 it 400 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 46 it 20 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 46 it 70 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 120 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 46 it 170 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 220 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 46 it 270 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 46 it 320 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 46 it 370 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 46 it 420 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[loss] ep 47 it 40 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 47 it 90 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA

 96%|█████████▌| 48/50 [33:10<00:55, 27.93s/it]
 98%|█████████▊| 49/50 [33:35<00:27, 27.19s/it]
100%|██████████| 50/50 [34:02<00:00, 27.08s/it]
100%|██████████| 50/50 [34:02<00:00, 40.86s/it]
[loss] ep 47 it 140 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 47 it 190 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 240 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=14 protos=None fproto_sim=NA
[loss] ep 47 it 290 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 47 it 340 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 390 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 10 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 48 it 60 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 110 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 48 it 160 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 48 it 210 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 48 it 260 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=13 protos=None fproto_sim=NA
[loss] ep 48 it 310 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 48 it 360 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 48 it 410 total=0.2017 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2017 favg=0.0000 nr=0 nf=13 protos=None fproto_sim=NA
[loss] ep 49 it 30 total=0.2016 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2016 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 49 it 80 total=0.2016 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2016 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 49 it 130 total=0.2016 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2016 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 49 it 180 total=0.2016 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2016 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 49 it 230 total=0.2016 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2016 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 49 it 280 total=0.2016 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2016 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 49 it 330 total=0.2016 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2016 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 49 it 380 total=0.2016 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2016 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images

  0%|          | 0/430 [00:00<?, ?it/s]
  0%|          | 1/430 [00:00<05:02,  1.42it/s]
  3%|▎         | 11/430 [00:00<00:23, 17.85it/s]
  5%|▍         | 20/430 [00:00<00:13, 31.51it/s]
  7%|▋         | 30/430 [00:01<00:08, 45.50it/s]
  9%|▉         | 39/430 [00:01<00:07, 55.40it/s]
 11%|█▏        | 49/430 [00:01<00:05, 65.77it/s]
 13%|█▎        | 58/430 [00:01<00:05, 71.77it/s]
 16%|█▌        | 67/430 [00:01<00:04, 73.88it/s]
 18%|█▊        | 76/430 [00:01<00:04, 76.13it/s]
 20%|█▉        | 85/430 [00:01<00:04, 78.78it/s]
 22%|██▏       | 95/430 [00:01<00:04, 83.16it/s]
 24%|██▍       | 105/430 [00:01<00:03, 85.80it/s]
 27%|██▋       | 115/430 [00:01<00:03, 86.69it/s]
 29%|██▉       | 124/430 [00:02<00:03, 84.89it/s]
 31%|███       | 134/430 [00:02<00:03, 86.91it/s]
 33%|███▎      | 144/430 [00:02<00:03, 88.62it/s]
 36%|███▌      | 153/430 [00:02<00:03, 88.93it/s]
 38%|███▊      | 163/430 [00:02<00:02, 89.59it/s]
 40%|████      | 173/430 [00:02<00:02, 90.03it/s]
 43%|████▎     | 183/430 [00:02<00:02, 88.55it/s]
 45%|████▍     | 193/430 [00:02<00:02, 87.61it/s]
 47%|████▋     | 203/430 [00:02<00:02, 89.93it/s]
 50%|████▉     | 213/430 [00:03<00:02, 90.77it/s]
 52%|█████▏    | 223/430 [00:03<00:02, 90.43it/s]
 54%|█████▍    | 233/430 [00:03<00:02, 90.64it/s]
 57%|█████▋    | 243/430 [00:03<00:02, 90.21it/s]
 59%|█████▉    | 253/430 [00:03<00:01, 90.84it/s]
 61%|██████    | 263/430 [00:03<00:01, 88.96it/s]
 63%|██████▎   | 272/430 [00:03<00:01, 87.75it/s]
 65%|██████▌   | 281/430 [00:03<00:01, 87.77it/s]
 68%|██████▊   | 291/430 [00:03<00:01, 88.72it/s]
 70%|██████▉   | 300/430 [00:04<00:01, 84.50it/s]
 72%|███████▏  | 309/430 [00:04<00:01, 85.11it/s]
 74%|███████▍  | 318/430 [00:04<00:01, 85.99it/s]
 76%|███████▋  | 328/430 [00:04<00:01, 88.88it/s]
 79%|███████▊  | 338/430 [00:04<00:01, 88.71it/s]
 81%|████████  | 348/430 [00:04<00:00, 90.60it/s]
 83%|████████▎ | 358/430 [00:04<00:00, 91.37it/s]
 86%|████████▌ | 368/430 [00:04<00:00, 88.51it/s]
 88%|████████▊ | 378/430 [00:04<00:00, 89.39it/s]
 90%|█████████ | 387/430 [00:05<00:00, 88.09it/s]
 92%|█████████▏| 396/430 [00:05<00:00, 87.76it/s]
 94%|█████████▍| 406/430 [00:05<00:00, 89.62it/s]
 97%|█████████▋| 416/430 [00:05<00:00, 91.69it/s]
 99%|█████████▉| 426/430 [00:05<00:00, 93.27it/s]
100%|██████████| 430/430 [00:05<00:00, 77.86it/s]
55000 images processed, 5.575958251953125 seconds used

Processing in-distribution CIFAR-110 images

  0%|          | 0/86 [00:00<?, ?it/s]
  1%|          | 1/86 [00:00<00:57,  1.48it/s]
 10%|█         | 9/86 [00:00<00:05, 14.81it/s]
 21%|██        | 18/86 [00:00<00:02, 29.36it/s]
 31%|███▏      | 27/86 [00:00<00:01, 42.00it/s]
 41%|████      | 35/86 [00:01<00:01, 50.90it/s]
 50%|█████     | 43/86 [00:01<00:00, 57.58it/s]
 59%|█████▉    | 51/86 [00:01<00:00, 59.16it/s]
 71%|███████   | 61/86 [00:01<00:00, 68.47it/s]
 83%|████████▎ | 71/86 [00:01<00:00, 76.20it/s]
 94%|█████████▍| 81/86 [00:01<00:00, 81.64it/s]
100%|██████████| 86/86 [00:01<00:00, 50.34it/s]
11000 images processed, 1.7295069694519043 seconds used

Processing out-of-distribution SVHN images

  0%|          | 0/204 [00:00<?, ?it/s]
  0%|          | 1/204 [00:00<02:30,  1.35it/s]
  4%|▍         | 9/204 [00:00<00:13, 13.95it/s]
  9%|▉         | 18/204 [00:00<00:06, 27.96it/s]
 13%|█▎        | 26/204 [00:01<00:04, 38.38it/s]
 17%|█▋        | 34/204 [00:01<00:03, 47.61it/s]
 21%|██        | 43/204 [00:01<00:02, 57.06it/s]
 25%|██▌       | 52/204 [00:01<00:02, 64.03it/s]
 30%|██▉       | 61/204 [00:01<00:02, 69.44it/s]
 35%|███▍      | 71/204 [00:01<00:01, 76.45it/s]
 40%|███▉      | 81/204 [00:01<00:01, 81.60it/s]
 44%|████▍     | 90/204 [00:01<00:01, 83.42it/s]
 49%|████▊     | 99/204 [00:01<00:01, 84.28it/s]
 53%|█████▎    | 109/204 [00:02<00:01, 87.24it/s]
 58%|█████▊    | 118/204 [00:02<00:01, 83.49it/s]
 63%|██████▎   | 128/204 [00:02<00:00, 86.56it/s]
 67%|██████▋   | 137/204 [00:02<00:00, 83.79it/s]
 72%|███████▏  | 147/204 [00:02<00:00, 85.80it/s]
 76%|███████▋  | 156/204 [00:02<00:00, 81.64it/s]
 81%|████████  | 165/204 [00:02<00:00, 78.92it/s]
 86%|████████▌ | 175/204 [00:02<00:00, 82.30it/s]
 91%|█████████ | 185/204 [00:02<00:00, 86.34it/s]
 96%|█████████▌| 195/204 [00:03<00:00, 89.21it/s]
100%|██████████| 204/204 [00:03<00:00, 65.39it/s]
26032 images processed, 3.1671390533447266 seconds used

Processing out-of-distribution places365 images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:00<01:05,  1.20it/s]
  8%|▊         | 6/79 [00:00<00:08,  8.21it/s]
 20%|██        | 16/79 [00:01<00:02, 23.46it/s]
 33%|███▎      | 26/79 [00:01<00:01, 37.57it/s]
 43%|████▎     | 34/79 [00:01<00:01, 42.71it/s]
 56%|█████▌    | 44/79 [00:01<00:00, 52.88it/s]
 68%|██████▊   | 54/79 [00:01<00:00, 62.90it/s]
 78%|███████▊  | 62/79 [00:01<00:00, 57.26it/s]
 90%|████████▉ | 71/79 [00:01<00:00, 63.63it/s]
100%|██████████| 79/79 [00:01<00:00, 41.38it/s]
10000 images processed, 1.9342126846313477 seconds used

Processing out-of-distribution LSUN images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:01<01:39,  1.28s/it]
 10%|█         | 8/79 [00:01<00:09,  7.66it/s]
 15%|█▌        | 12/79 [00:01<00:05, 11.67it/s]
 28%|██▊       | 22/79 [00:01<00:02, 24.66it/s]
 35%|███▌      | 28/79 [00:01<00:01, 27.40it/s]
 47%|████▋     | 37/79 [00:01<00:01, 38.31it/s]
 57%|█████▋    | 45/79 [00:01<00:00, 45.86it/s]
 70%|██████▉   | 55/79 [00:02<00:00, 57.29it/s]
 82%|████████▏ | 65/79 [00:02<00:00, 66.65it/s]
 95%|█████████▍| 75/79 [00:02<00:00, 74.35it/s]
100%|██████████| 79/79 [00:02<00:00, 33.82it/s]
10000 images processed, 2.3602023124694824 seconds used

Processing out-of-distribution iSUN images

  0%|          | 0/70 [00:00<?, ?it/s]
  1%|▏         | 1/70 [00:00<00:48,  1.43it/s]
  9%|▊         | 6/70 [00:00<00:06,  9.58it/s]
 20%|██        | 14/70 [00:00<00:02, 22.98it/s]
 34%|███▍      | 24/70 [00:01<00:01, 38.71it/s]
 46%|████▌     | 32/70 [00:01<00:00, 47.92it/s]
 59%|█████▊    | 41/70 [00:01<00:00, 57.38it/s]
 73%|███████▎  | 51/70 [00:01<00:00, 67.68it/s]
 87%|████████▋ | 61/70 [00:01<00:00, 74.91it/s]
100%|██████████| 70/70 [00:01<00:00, 78.48it/s]
100%|██████████| 70/70 [00:01<00:00, 45.37it/s]
8925 images processed, 1.595695972442627 seconds used

Processing out-of-distribution dtd images

  0%|          | 0/45 [00:00<?, ?it/s]
  2%|▏         | 1/45 [00:01<00:50,  1.14s/it]
  4%|▍         | 2/45 [00:01<00:27,  1.56it/s]
 22%|██▏       | 10/45 [00:01<00:03, 10.56it/s]
 38%|███▊      | 17/45 [00:01<00:02, 13.45it/s]
 44%|████▍     | 20/45 [00:02<00:01, 14.06it/s]
 51%|█████     | 23/45 [00:02<00:01, 13.92it/s]
 71%|███████   | 32/45 [00:02<00:00, 24.92it/s]
 82%|████████▏ | 37/45 [00:03<00:00, 12.67it/s]
100%|██████████| 45/45 [00:03<00:00, 13.27it/s]
5640 images processed, 3.410365343093872 seconds used

21.743160247802734
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.89  98.75
places365     61.05  83.04
LSUN          45.98  89.12
iSUN          40.82  90.51
dtd           35.60  90.86
AVG           37.47  90.46
[incremental] Overall: 0.6980 New: 0.7040 Old: 0.6950
[incremental] Final(Top-1): 0.6980  Average: 0.7630
25.39134931564331
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='forget_only', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt

  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:165: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:239: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

  2%|▏         | 1/50 [00:57<46:34, 57.03s/it]
  4%|▍         | 2/50 [01:25<31:59, 39.98s/it]
  6%|▌         | 3/50 [01:52<27:00, 34.47s/it]
  8%|▊         | 4/50 [02:19<24:03, 31.38s/it]
 10%|█         | 5/50 [02:45<21:59, 29.32s/it]
 12%|█▏        | 6/50 [03:12<21:05, 28.76s/it][loss] ep 0 it 0 total=4.3803 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3803 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=4.3786 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3786 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=4.3755 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3755 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=4.3703 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3703 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=4.3628 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3628 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=4.3531 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3531 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=4.3411 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3411 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=4.3268 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3268 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 400 total=4.3099 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3099 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 1 it 20 total=4.2904 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.2904 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 70 total=4.2682 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.2682 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 120 total=4.2430 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.2430 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 170 total=4.2147 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.2147 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 220 total=4.1832 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.1832 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 270 total=4.1481 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.1481 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 320 total=4.1093 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.1093 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 1 it 370 total=4.0664 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.0664 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 420 total=4.0192 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.0192 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 40 total=3.9673 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.9673 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 90 total=3.9106 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.9106 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 140 total=3.8486 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.8486 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 190 total=3.7811 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.7811 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 240 total=3.7079 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.7079 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 290 total=3.6288 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.6288 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 340 total=3.5436 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.5436 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 390 total=3.4523 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.4523 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 3 it 10 total=3.3552 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.3552 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 60 total=3.2526 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.2526 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 3 it 110 total=3.1449 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.1449 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 160 total=3.0329 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.0329 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 210 total=2.9175 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.9175 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 260 total=2.7998 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.7998 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 310 total=2.6810 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.6810 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 360 total=2.5623 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.5623 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 410 total=2.4449 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.4449 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 4 it 30 total=2.3299 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.3299 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 80 total=2.2182 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.2182 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 130 total=2.1108 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.1108 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 180 total=2.0082 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.0082 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 230 total=1.9111 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.9111 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 280 total=1.8198 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8198 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 330 total=1.7345 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.7345 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 380 total=1.6554 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.6554 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 5 it 0 total=1.5824 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.5824 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 50 total=1.5150 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.5150 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 100 total=1.4529 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.4529 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 150 total=1.3954 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.3954 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 200 total=1.3422 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.3422 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 250 total=1.2927 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.2927 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 300 total=1.2464 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.2464 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 350 total=1.2031 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.2031 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 5 it 400 total=1.1622 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.1622 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 20 total=1.1235 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.1235 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 70 total=1.0865 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0865 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 120 total=1.0509 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0509 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 170 total=1.0166 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.0166 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA

 14%|█▍        | 7/50 [03:42<20:47, 29.01s/it]
 16%|█▌        | 8/50 [04:11<20:22, 29.11s/it]
 18%|█▊        | 9/50 [04:39<19:29, 28.53s/it]
 20%|██        | 10/50 [05:05<18:32, 27.82s/it]
 22%|██▏       | 11/50 [05:32<17:56, 27.61s/it]
 24%|██▍       | 12/50 [05:58<17:16, 27.28s/it]
 26%|██▌       | 13/50 [06:25<16:45, 27.16s/it][loss] ep 6 it 220 total=0.9833 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9833 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 270 total=0.9510 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9510 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 320 total=0.9197 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.9197 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 370 total=0.8895 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.8895 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 420 total=0.8604 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.8604 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 7 it 40 total=0.8326 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.8326 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 90 total=0.8059 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.8059 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 140 total=0.7805 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.7805 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 190 total=0.7561 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.7561 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 240 total=0.7328 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.7328 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 290 total=0.7105 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.7105 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 340 total=0.6890 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6890 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 390 total=0.6683 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6683 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 8 it 10 total=0.6484 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6484 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 60 total=0.6291 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6291 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 110 total=0.6106 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.6106 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 160 total=0.5927 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5927 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 210 total=0.5754 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5754 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 8 it 260 total=0.5587 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5587 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 310 total=0.5426 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5426 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 360 total=0.5270 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5270 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 410 total=0.5118 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.5118 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 9 it 30 total=0.4972 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4972 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 80 total=0.4830 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4830 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 130 total=0.4692 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4692 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 180 total=0.4559 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4559 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 230 total=0.4430 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4430 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 280 total=0.4307 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4307 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 330 total=0.4189 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4189 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 380 total=0.4075 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.4075 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 0 total=0.3966 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3966 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 50 total=0.3863 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3863 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 100 total=0.3765 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3765 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 150 total=0.3671 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3671 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 200 total=0.3581 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3581 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 250 total=0.3495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3495 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 300 total=0.3412 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3412 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 350 total=0.3331 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3331 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 400 total=0.3252 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3252 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 11 it 20 total=0.3176 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3176 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 11 it 70 total=0.3101 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3101 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 120 total=0.3027 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.3027 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 170 total=0.2955 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2955 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 220 total=0.2885 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2885 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 270 total=0.2816 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2816 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 320 total=0.2749 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2749 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 370 total=0.2684 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2684 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 420 total=0.2619 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2619 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 40 total=0.2557 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2557 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 90 total=0.2496 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2496 favg=0.0000 nr=0 nf=13 protos=None fproto_sim=NA
[loss] ep 12 it 140 total=0.2436 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2436 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 190 total=0.2378 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2378 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 12 it 240 total=0.2321 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2321 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 290 total=0.2267 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2267 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 340 total=0.2213 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2213 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 390 total=0.2161 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2161 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA

 28%|██▊       | 14/50 [06:51<16:04, 26.78s/it]
 30%|███       | 15/50 [07:24<16:38, 28.52s/it]
 32%|███▏      | 16/50 [08:08<18:54, 33.36s/it]
 34%|███▍      | 17/50 [08:52<19:59, 36.34s/it]
 36%|███▌      | 18/50 [09:37<20:45, 38.91s/it]
 38%|███▊      | 19/50 [10:26<21:41, 41.98s/it][loss] ep 13 it 10 total=0.2111 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2111 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 60 total=0.2062 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2062 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 110 total=0.2014 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.2014 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 160 total=0.1968 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1968 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 210 total=0.1924 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1924 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 260 total=0.1881 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1881 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 310 total=0.1840 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1840 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 360 total=0.1800 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1800 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 13 it 410 total=0.1762 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1762 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 14 it 30 total=0.1725 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1725 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 80 total=0.1690 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1690 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 130 total=0.1656 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1656 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 180 total=0.1624 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1624 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 230 total=0.1593 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1593 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 280 total=0.1563 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1563 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 330 total=0.1534 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1534 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 380 total=0.1507 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1507 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 0 total=0.1481 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1481 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 50 total=0.1456 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1456 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 100 total=0.1431 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1431 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 150 total=0.1408 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1408 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 200 total=0.1386 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1386 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 250 total=0.1365 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1365 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 300 total=0.1344 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1344 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 350 total=0.1324 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1324 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 400 total=0.1305 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1305 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 16 it 20 total=0.1286 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1286 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 16 it 70 total=0.1268 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1268 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 120 total=0.1251 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1251 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 170 total=0.1234 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1234 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 220 total=0.1217 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1217 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 270 total=0.1201 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1201 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 320 total=0.1186 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1186 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 370 total=0.1171 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1171 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 420 total=0.1156 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1156 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 40 total=0.1142 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1142 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 90 total=0.1128 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1128 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 17 it 140 total=0.1114 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1114 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 190 total=0.1101 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1101 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 240 total=0.1088 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1088 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 290 total=0.1075 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1075 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 340 total=0.1063 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1063 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 390 total=0.1051 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1051 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 18 it 10 total=0.1040 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1040 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 60 total=0.1029 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1029 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 110 total=0.1018 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1018 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 160 total=0.1007 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.1007 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 210 total=0.0997 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0997 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 260 total=0.0987 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0987 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 310 total=0.0978 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0978 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 360 total=0.0968 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0968 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 410 total=0.0959 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0959 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 19 it 30 total=0.0951 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0951 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 80 total=0.0942 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0942 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 130 total=0.0934 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0934 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 180 total=0.0927 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0927 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA

 40%|████      | 20/50 [11:38<25:30, 51.00s/it]
 42%|████▏     | 21/50 [12:17<22:59, 47.56s/it]
 44%|████▍     | 22/50 [12:57<21:06, 45.24s/it]
 46%|████▌     | 23/50 [13:36<19:26, 43.22s/it]
 48%|████▊     | 24/50 [14:13<17:56, 41.41s/it]
 50%|█████     | 25/50 [14:53<17:04, 40.99s/it]
 52%|█████▏    | 26/50 [15:31<16:03, 40.15s/it][loss] ep 19 it 230 total=0.0919 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0919 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 280 total=0.0911 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0911 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 19 it 330 total=0.0904 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0904 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 380 total=0.0897 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0897 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 0 total=0.0890 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0890 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 50 total=0.0884 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0884 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 100 total=0.0877 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0877 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 150 total=0.0871 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0871 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 20 it 200 total=0.0865 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0865 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 250 total=0.0859 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0859 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 300 total=0.0853 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0853 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 350 total=0.0847 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0847 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 400 total=0.0842 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0842 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 21 it 20 total=0.0836 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0836 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 70 total=0.0831 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0831 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 120 total=0.0825 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0825 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 170 total=0.0820 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0820 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 220 total=0.0815 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0815 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 270 total=0.0810 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0810 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 320 total=0.0805 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0805 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 370 total=0.0800 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0800 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 420 total=0.0796 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0796 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 40 total=0.0791 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0791 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 90 total=0.0786 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0786 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 140 total=0.0782 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0782 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 190 total=0.0777 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0777 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 240 total=0.0773 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0773 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 22 it 290 total=0.0769 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0769 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 22 it 340 total=0.0764 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0764 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 390 total=0.0760 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0760 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 23 it 10 total=0.0756 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0756 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 60 total=0.0752 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0752 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 110 total=0.0748 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0748 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 160 total=0.0744 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0744 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 23 it 210 total=0.0740 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0740 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 260 total=0.0736 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0736 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 310 total=0.0732 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0732 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 360 total=0.0728 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0728 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 410 total=0.0724 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0724 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 24 it 30 total=0.0721 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0721 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 80 total=0.0717 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0717 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 130 total=0.0714 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0714 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 180 total=0.0710 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0710 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 230 total=0.0707 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0707 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 280 total=0.0703 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0703 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 330 total=0.0700 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0700 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 380 total=0.0696 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0696 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 25 it 0 total=0.0693 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0693 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 50 total=0.0690 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0690 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 100 total=0.0686 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0686 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 150 total=0.0683 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0683 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 200 total=0.0680 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0680 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 250 total=0.0677 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0677 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 300 total=0.0674 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0674 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 350 total=0.0671 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0671 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 400 total=0.0668 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0668 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 20 total=0.0665 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0665 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 70 total=0.0662 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0662 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 120 total=0.0659 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0659 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA

 54%|█████▍    | 27/50 [16:09<15:06, 39.40s/it]
 56%|█████▌    | 28/50 [17:03<16:02, 43.73s/it]
 58%|█████▊    | 29/50 [17:53<16:03, 45.90s/it]
 60%|██████    | 30/50 [18:50<16:23, 49.18s/it]
 62%|██████▏   | 31/50 [19:31<14:46, 46.67s/it]
 64%|██████▍   | 32/50 [20:10<13:19, 44.43s/it]
 66%|██████▌   | 33/50 [20:51<12:17, 43.38s/it][loss] ep 26 it 170 total=0.0656 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0656 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 220 total=0.0654 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0654 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 270 total=0.0651 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0651 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 320 total=0.0648 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0648 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 26 it 370 total=0.0645 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0645 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 420 total=0.0643 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0643 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 40 total=0.0640 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0640 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 90 total=0.0638 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0638 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 140 total=0.0635 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0635 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 190 total=0.0633 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0633 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 240 total=0.0630 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0630 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 27 it 290 total=0.0628 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0628 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 340 total=0.0625 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0625 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 390 total=0.0623 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0623 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 10 total=0.0621 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0621 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 60 total=0.0618 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0618 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 110 total=0.0616 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0616 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 160 total=0.0614 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0614 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 210 total=0.0612 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0612 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 260 total=0.0610 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0610 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 310 total=0.0607 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0607 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 360 total=0.0605 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0605 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[loss] ep 28 it 410 total=0.0603 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0603 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 30 total=0.0601 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0601 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA
[loss] ep 29 it 80 total=0.0599 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0599 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 29 it 130 total=0.0597 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0597 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 29 it 180 total=0.0595 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0595 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 230 total=0.0593 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0593 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 280 total=0.0592 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0592 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 330 total=0.0590 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0590 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 29 it 380 total=0.0588 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0588 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 0 total=0.0586 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0586 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 30 it 50 total=0.0584 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0584 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 100 total=0.0583 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0583 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 150 total=0.0581 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0581 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 200 total=0.0579 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0579 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 250 total=0.0578 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0578 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 300 total=0.0576 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0576 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 30 it 350 total=0.0574 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0574 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 30 it 400 total=0.0573 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0573 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 31 it 20 total=0.0571 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0571 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 70 total=0.0570 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0570 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 120 total=0.0568 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0568 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 31 it 170 total=0.0567 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0567 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 220 total=0.0565 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0565 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 270 total=0.0564 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0564 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 320 total=0.0562 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0562 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 370 total=0.0561 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0561 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 420 total=0.0559 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0559 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 40 total=0.0558 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0558 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 90 total=0.0557 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0557 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 140 total=0.0555 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0555 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 32 it 190 total=0.0554 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0554 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 32 it 240 total=0.0553 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0553 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 290 total=0.0552 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0552 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 340 total=0.0550 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0550 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 32 it 390 total=0.0549 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0549 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 10 total=0.0548 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0548 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 60 total=0.0547 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0547 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 110 total=0.0546 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0546 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 160 total=0.0544 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0544 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA

 68%|██████▊   | 34/50 [21:31<11:15, 42.21s/it]
 70%|███████   | 35/50 [22:24<11:21, 45.41s/it]
 72%|███████▏  | 36/50 [23:17<11:07, 47.69s/it]
 74%|███████▍  | 37/50 [24:12<10:49, 49.95s/it]
 76%|███████▌  | 38/50 [25:07<10:17, 51.43s/it]
 78%|███████▊  | 39/50 [26:02<09:37, 52.50s/it]
 80%|████████  | 40/50 [26:57<08:53, 53.30s/it][loss] ep 33 it 210 total=0.0543 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0543 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 260 total=0.0542 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0542 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 310 total=0.0541 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0541 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 360 total=0.0540 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0540 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 410 total=0.0539 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0539 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 30 total=0.0538 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0538 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 80 total=0.0537 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0537 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 130 total=0.0536 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0536 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 180 total=0.0535 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0535 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 230 total=0.0534 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0534 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 34 it 280 total=0.0533 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0533 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 330 total=0.0532 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0532 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 380 total=0.0531 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0531 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 35 it 0 total=0.0530 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0530 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 50 total=0.0529 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0529 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 100 total=0.0529 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0529 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 35 it 150 total=0.0528 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0528 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 200 total=0.0527 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0527 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 250 total=0.0526 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0526 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 300 total=0.0525 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0525 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 350 total=0.0524 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0524 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 400 total=0.0524 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0524 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 36 it 20 total=0.0523 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0523 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 36 it 70 total=0.0522 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0522 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 120 total=0.0521 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0521 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 36 it 170 total=0.0521 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0521 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 36 it 220 total=0.0520 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0520 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 270 total=0.0519 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0519 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 320 total=0.0519 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0519 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 370 total=0.0518 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0518 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 420 total=0.0517 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0517 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 37 it 40 total=0.0517 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0517 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 37 it 90 total=0.0516 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0516 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 37 it 140 total=0.0515 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0515 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 190 total=0.0515 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0515 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 240 total=0.0514 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0514 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 290 total=0.0513 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0513 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 37 it 340 total=0.0513 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0513 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 390 total=0.0512 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0512 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 38 it 10 total=0.0512 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0512 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 60 total=0.0511 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0511 favg=0.0000 nr=0 nf=13 protos=None fproto_sim=NA
[loss] ep 38 it 110 total=0.0511 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0511 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 38 it 160 total=0.0510 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0510 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 38 it 210 total=0.0510 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0510 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 38 it 260 total=0.0509 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0509 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 38 it 310 total=0.0509 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0509 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 38 it 360 total=0.0508 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0508 favg=0.0000 nr=0 nf=12 protos=None fproto_sim=NA
[loss] ep 38 it 410 total=0.0508 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0508 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 39 it 30 total=0.0507 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0507 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 80 total=0.0507 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0507 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 130 total=0.0506 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0506 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 180 total=0.0506 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0506 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 230 total=0.0505 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0505 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 280 total=0.0505 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0505 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 330 total=0.0505 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0505 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 380 total=0.0504 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0504 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA

 82%|████████▏ | 41/50 [28:01<08:28, 56.51s/it]
 84%|████████▍ | 42/50 [28:57<07:30, 56.37s/it]
 86%|████████▌ | 43/50 [29:53<06:33, 56.18s/it]
 88%|████████▊ | 44/50 [30:48<05:35, 55.97s/it]
 90%|█████████ | 45/50 [31:44<04:40, 56.04s/it]
 92%|█████████▏| 46/50 [32:40<03:43, 55.98s/it][loss] ep 40 it 0 total=0.0504 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0504 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 50 total=0.0504 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0504 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 40 it 100 total=0.0503 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0503 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 150 total=0.0503 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0503 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 40 it 200 total=0.0502 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0502 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 250 total=0.0502 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0502 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 40 it 300 total=0.0502 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0502 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 350 total=0.0501 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0501 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 400 total=0.0501 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0501 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 41 it 20 total=0.0501 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0501 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 70 total=0.0500 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0500 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 41 it 120 total=0.0500 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0500 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 41 it 170 total=0.0500 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0500 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 220 total=0.0500 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0500 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 270 total=0.0499 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0499 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 320 total=0.0499 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0499 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 370 total=0.0499 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0499 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 41 it 420 total=0.0499 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0499 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 42 it 40 total=0.0498 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0498 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 90 total=0.0498 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0498 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 42 it 140 total=0.0498 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0498 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 42 it 190 total=0.0498 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0498 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 240 total=0.0497 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0497 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 290 total=0.0497 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0497 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 340 total=0.0497 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0497 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 390 total=0.0497 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0497 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 10 total=0.0497 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0497 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 43 it 60 total=0.0496 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0496 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 43 it 110 total=0.0496 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0496 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 43 it 160 total=0.0496 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0496 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 210 total=12.6153 mle=2.4761 pcon=10.0896 forget=0.0000 orth=0.0496 favg=0.0000 nr=102 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 260 total=0.0496 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0496 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 310 total=0.0496 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0496 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 360 total=0.0495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0495 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 410 total=0.0495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0495 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 44 it 30 total=0.0495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0495 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 80 total=0.0495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0495 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 44 it 130 total=0.0495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0495 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 180 total=0.0495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0495 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 230 total=0.0495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0495 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 280 total=0.0495 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0495 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 330 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 380 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 45 it 0 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 45 it 50 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 100 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 45 it 150 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 45 it 200 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=3 protos=None fproto_sim=NA
[loss] ep 45 it 250 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 45 it 300 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 45 it 350 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 400 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 46 it 20 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 46 it 70 total=0.0494 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0494 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 46 it 120 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 46 it 170 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 46 it 220 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 46 it 270 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 320 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 370 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 46 it 420 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=11 protos=None fproto_sim=NA

 94%|█████████▍| 47/50 [33:40<02:51, 57.16s/it]
 96%|█████████▌| 48/50 [34:33<01:51, 55.85s/it]
 98%|█████████▊| 49/50 [35:23<00:54, 54.11s/it]
100%|██████████| 50/50 [36:15<00:00, 53.38s/it]
100%|██████████| 50/50 [36:15<00:00, 43.50s/it]
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 47 it 40 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 90 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 47 it 140 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 190 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=2 protos=None fproto_sim=NA
[loss] ep 47 it 240 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 290 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 340 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 390 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 48 it 10 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 48 it 60 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 48 it 110 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 48 it 160 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 48 it 210 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 260 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 310 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 360 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=4 protos=None fproto_sim=NA
[loss] ep 48 it 410 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=1 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[loss] ep 49 it 30 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=6 protos=None fproto_sim=NA
[loss] ep 49 it 80 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=7 protos=None fproto_sim=NA
[loss] ep 49 it 130 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 49 it 180 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=9 protos=None fproto_sim=NA
[loss] ep 49 it 230 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 49 it 280 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=5 protos=None fproto_sim=NA
[loss] ep 49 it 330 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=10 protos=None fproto_sim=NA
[loss] ep 49 it 380 total=0.0493 mle=0.0000 pcon=0.0000 forget=0.0000 orth=0.0493 favg=0.0000 nr=0 nf=8 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images

  0%|          | 0/430 [00:00<?, ?it/s]
  0%|          | 1/430 [00:00<06:01,  1.19it/s]
  1%|          | 5/430 [00:00<01:04,  6.62it/s]
  2%|▏         | 9/430 [00:01<00:36, 11.67it/s]
  3%|▎         | 13/430 [00:01<00:25, 16.49it/s]
  4%|▍         | 17/430 [00:01<00:19, 20.74it/s]
  5%|▍         | 21/430 [00:01<00:16, 24.07it/s]
  6%|▌         | 25/430 [00:01<00:15, 26.10it/s]
  7%|▋         | 29/430 [00:01<00:14, 28.27it/s]
  8%|▊         | 33/430 [00:01<00:13, 30.33it/s]
  9%|▊         | 37/430 [00:01<00:12, 31.36it/s]
 10%|▉         | 41/430 [00:02<00:12, 32.17it/s]
 10%|█         | 45/430 [00:02<00:11, 32.53it/s]
 11%|█▏        | 49/430 [00:02<00:11, 33.20it/s]
 12%|█▏        | 53/430 [00:02<00:11, 33.60it/s]
 13%|█▎        | 57/430 [00:02<00:11, 33.20it/s]
 14%|█▍        | 61/430 [00:02<00:11, 33.26it/s]
 15%|█▌        | 65/430 [00:02<00:10, 33.91it/s]
 16%|█▌        | 69/430 [00:02<00:10, 33.93it/s]
 17%|█▋        | 73/430 [00:02<00:10, 33.82it/s]
 18%|█▊        | 77/430 [00:03<00:10, 33.87it/s]
 19%|█▉        | 81/430 [00:03<00:10, 34.14it/s]
 20%|██        | 86/430 [00:03<00:09, 37.24it/s]
 21%|██        | 91/430 [00:03<00:08, 39.67it/s]
 22%|██▏       | 95/430 [00:03<00:08, 38.32it/s]
 23%|██▎       | 99/430 [00:03<00:09, 36.76it/s]
 24%|██▍       | 103/430 [00:03<00:09, 35.81it/s]
 25%|██▍       | 107/430 [00:03<00:09, 35.29it/s]
 26%|██▌       | 111/430 [00:04<00:09, 35.24it/s]
 27%|██▋       | 115/430 [00:04<00:09, 34.65it/s]
 28%|██▊       | 119/430 [00:04<00:09, 33.98it/s]
 29%|██▊       | 123/430 [00:04<00:08, 34.16it/s]
 30%|██▉       | 127/430 [00:04<00:08, 34.02it/s]
 30%|███       | 131/430 [00:04<00:08, 33.82it/s]
 31%|███▏      | 135/430 [00:04<00:08, 32.86it/s]
 32%|███▏      | 139/430 [00:04<00:08, 33.18it/s]
 33%|███▎      | 143/430 [00:04<00:08, 33.31it/s]
 34%|███▍      | 147/430 [00:05<00:08, 32.69it/s]
 35%|███▌      | 151/430 [00:05<00:08, 32.96it/s]
 36%|███▌      | 155/430 [00:05<00:08, 33.23it/s]
 37%|███▋      | 159/430 [00:05<00:08, 32.66it/s]
 38%|███▊      | 163/430 [00:05<00:08, 32.93it/s]
 39%|███▉      | 167/430 [00:05<00:08, 32.70it/s]
 40%|███▉      | 171/430 [00:05<00:07, 32.80it/s]
 41%|████      | 175/430 [00:05<00:07, 33.01it/s]
 42%|████▏     | 179/430 [00:06<00:07, 32.04it/s]
 43%|████▎     | 183/430 [00:06<00:07, 32.52it/s]
 43%|████▎     | 187/430 [00:06<00:07, 32.83it/s]
 44%|████▍     | 191/430 [00:06<00:07, 32.22it/s]
 45%|████▌     | 195/430 [00:06<00:07, 32.78it/s]
 47%|████▋     | 200/430 [00:06<00:06, 35.25it/s]
 48%|████▊     | 205/430 [00:06<00:05, 37.74it/s]
 49%|████▊     | 209/430 [00:06<00:06, 35.56it/s]
 50%|████▉     | 213/430 [00:07<00:06, 35.11it/s]
 50%|█████     | 217/430 [00:07<00:06, 34.22it/s]
 51%|█████▏    | 221/430 [00:07<00:06, 34.11it/s]
 52%|█████▏    | 225/430 [00:07<00:06, 34.04it/s]
 53%|█████▎    | 229/430 [00:07<00:06, 33.08it/s]
 54%|█████▍    | 233/430 [00:07<00:05, 33.22it/s]
 55%|█████▌    | 237/430 [00:07<00:05, 33.41it/s]
 56%|█████▌    | 241/430 [00:07<00:05, 32.24it/s]
 57%|█████▋    | 245/430 [00:08<00:05, 32.80it/s]
 58%|█████▊    | 249/430 [00:08<00:05, 32.91it/s]
 59%|█████▉    | 253/430 [00:08<00:05, 32.45it/s]
 60%|█████▉    | 257/430 [00:08<00:05, 32.79it/s]
 61%|██████    | 261/430 [00:08<00:05, 32.71it/s]
 62%|██████▏   | 265/430 [00:08<00:05, 32.62it/s]
 63%|██████▎   | 269/430 [00:08<00:04, 32.89it/s]
 63%|██████▎   | 273/430 [00:08<00:04, 32.19it/s]
 64%|██████▍   | 277/430 [00:09<00:04, 32.44it/s]
 65%|██████▌   | 281/430 [00:09<00:04, 32.74it/s]
 66%|██████▋   | 285/430 [00:09<00:04, 32.18it/s]
 67%|██████▋   | 289/430 [00:09<00:04, 32.78it/s]
 68%|██████▊   | 293/430 [00:09<00:04, 33.48it/s]
 69%|██████▉   | 297/430 [00:09<00:04, 32.64it/s]
 70%|███████   | 301/430 [00:09<00:03, 32.91it/s]
 71%|███████   | 305/430 [00:09<00:03, 32.86it/s]
 72%|███████▏  | 309/430 [00:09<00:03, 32.56it/s]
 73%|███████▎  | 313/430 [00:10<00:03, 34.29it/s]
 74%|███████▍  | 318/430 [00:10<00:02, 38.24it/s]
 75%|███████▍  | 322/430 [00:10<00:02, 36.29it/s]
 76%|███████▌  | 326/430 [00:10<00:02, 35.46it/s]
 77%|███████▋  | 330/430 [00:10<00:02, 34.62it/s]
 78%|███████▊  | 334/430 [00:10<00:02, 33.96it/s]
 79%|███████▊  | 338/430 [00:10<00:02, 33.81it/s]
 80%|███████▉  | 342/430 [00:10<00:02, 32.96it/s]
 80%|████████  | 346/430 [00:11<00:02, 33.17it/s]
 81%|████████▏ | 350/430 [00:11<00:02, 33.29it/s]
 82%|████████▏ | 354/430 [00:11<00:02, 32.51it/s]
 83%|████████▎ | 358/430 [00:11<00:02, 32.91it/s]
 84%|████████▍ | 362/430 [00:11<00:02, 33.37it/s]
 85%|████████▌ | 366/430 [00:11<00:01, 32.73it/s]
 86%|████████▌ | 370/430 [00:11<00:01, 33.97it/s]
 87%|████████▋ | 374/430 [00:11<00:01, 33.10it/s]
 88%|████████▊ | 378/430 [00:12<00:01, 33.23it/s]
 89%|████████▉ | 382/430 [00:12<00:01, 33.42it/s]
 90%|████████▉ | 386/430 [00:12<00:01, 32.61it/s]
 91%|█████████ | 390/430 [00:12<00:01, 32.86it/s]
 92%|█████████▏| 394/430 [00:12<00:01, 33.01it/s]
 93%|█████████▎| 398/430 [00:12<00:00, 32.54it/s]
 93%|█████████▎| 402/430 [00:12<00:00, 32.79it/s]
 94%|█████████▍| 406/430 [00:12<00:00, 32.65it/s]
 95%|█████████▌| 410/430 [00:12<00:00, 32.60it/s]
 96%|█████████▋| 414/430 [00:13<00:00, 32.87it/s]
 97%|█████████▋| 418/430 [00:13<00:00, 32.36it/s]
 98%|█████████▊| 422/430 [00:13<00:00, 32.71it/s]
 99%|█████████▉| 426/430 [00:13<00:00, 32.96it/s]
100%|██████████| 430/430 [00:13<00:00, 31.69it/s]
55000 images processed, 13.655277490615845 seconds used

Processing in-distribution CIFAR-110 images

  0%|          | 0/86 [00:00<?, ?it/s]
  1%|          | 1/86 [00:00<01:14,  1.15it/s]
  6%|▌         | 5/86 [00:00<00:12,  6.45it/s]
 10%|█         | 9/86 [00:01<00:06, 11.42it/s]
 15%|█▌        | 13/86 [00:01<00:04, 16.08it/s]
 20%|█▉        | 17/86 [00:01<00:03, 20.01it/s]
 24%|██▍       | 21/86 [00:01<00:02, 23.25it/s]
 29%|██▉       | 25/86 [00:01<00:02, 25.70it/s]
 34%|███▎      | 29/86 [00:01<00:02, 27.22it/s]
 38%|███▊      | 33/86 [00:01<00:01, 28.97it/s]
 43%|████▎     | 37/86 [00:01<00:01, 30.25it/s]
 48%|████▊     | 41/86 [00:02<00:01, 30.41it/s]
 52%|█████▏    | 45/86 [00:02<00:01, 31.44it/s]
 57%|█████▋    | 49/86 [00:02<00:01, 32.00it/s]
 62%|██████▏   | 53/86 [00:02<00:01, 31.69it/s]
 66%|██████▋   | 57/86 [00:02<00:00, 32.75it/s]
 71%|███████   | 61/86 [00:02<00:00, 33.33it/s]
 78%|███████▊  | 67/86 [00:02<00:00, 38.27it/s]
 83%|████████▎ | 71/86 [00:02<00:00, 37.65it/s]
 87%|████████▋ | 75/86 [00:03<00:00, 36.41it/s]
 92%|█████████▏| 79/86 [00:03<00:00, 34.63it/s]
 97%|█████████▋| 83/86 [00:03<00:00, 34.51it/s]
100%|██████████| 86/86 [00:03<00:00, 25.37it/s]
11000 images processed, 3.4111592769622803 seconds used

Processing out-of-distribution SVHN images

  0%|          | 0/204 [00:00<?, ?it/s]
  0%|          | 1/204 [00:00<02:50,  1.19it/s]
  2%|▏         | 5/204 [00:00<00:30,  6.51it/s]
  4%|▍         | 9/204 [00:01<00:16, 11.50it/s]
  6%|▋         | 13/204 [00:01<00:12, 15.87it/s]
  9%|▉         | 18/204 [00:01<00:08, 22.01it/s]
 11%|█         | 22/204 [00:01<00:07, 25.66it/s]
 13%|█▎        | 26/204 [00:01<00:06, 26.87it/s]
 15%|█▍        | 30/204 [00:01<00:06, 27.72it/s]
 17%|█▋        | 34/204 [00:01<00:05, 28.70it/s]
 19%|█▊        | 38/204 [00:01<00:05, 29.43it/s]
 21%|██        | 42/204 [00:02<00:05, 30.55it/s]
 23%|██▎       | 46/204 [00:02<00:05, 31.09it/s]
 25%|██▍       | 50/204 [00:02<00:04, 31.15it/s]
 26%|██▋       | 54/204 [00:02<00:04, 30.67it/s]
 28%|██▊       | 58/204 [00:02<00:04, 30.34it/s]
 30%|███       | 62/204 [00:02<00:04, 31.03it/s]
 32%|███▏      | 66/204 [00:02<00:04, 31.28it/s]
 34%|███▍      | 70/204 [00:02<00:04, 31.58it/s]
 36%|███▋      | 74/204 [00:03<00:04, 31.80it/s]
 38%|███▊      | 78/204 [00:03<00:04, 30.52it/s]
 40%|████      | 82/204 [00:03<00:04, 29.95it/s]
 42%|████▏     | 86/204 [00:03<00:03, 30.34it/s]
 44%|████▍     | 90/204 [00:03<00:03, 30.12it/s]
 46%|████▌     | 94/204 [00:03<00:03, 29.97it/s]
 48%|████▊     | 98/204 [00:03<00:03, 30.33it/s]
 50%|█████     | 102/204 [00:04<00:03, 30.15it/s]
 52%|█████▏    | 106/204 [00:04<00:03, 30.06it/s]
 54%|█████▍    | 110/204 [00:04<00:02, 32.08it/s]
 56%|█████▋    | 115/204 [00:04<00:02, 35.70it/s]
 58%|█████▊    | 119/204 [00:04<00:02, 34.38it/s]
 60%|██████    | 123/204 [00:04<00:02, 33.23it/s]
 62%|██████▏   | 127/204 [00:04<00:02, 32.15it/s]
 64%|██████▍   | 131/204 [00:04<00:02, 31.56it/s]
 66%|██████▌   | 135/204 [00:05<00:02, 31.77it/s]
 68%|██████▊   | 139/204 [00:05<00:02, 31.16it/s]
 70%|███████   | 143/204 [00:05<00:01, 30.88it/s]
 72%|███████▏  | 147/204 [00:05<00:01, 30.84it/s]
 74%|███████▍  | 151/204 [00:05<00:01, 31.17it/s]
 76%|███████▌  | 155/204 [00:05<00:01, 31.37it/s]
 78%|███████▊  | 159/204 [00:05<00:01, 31.05it/s]
 80%|███████▉  | 163/204 [00:05<00:01, 30.76it/s]
 82%|████████▏ | 167/204 [00:06<00:01, 30.87it/s]
 84%|████████▍ | 171/204 [00:06<00:01, 31.16it/s]
 86%|████████▌ | 175/204 [00:06<00:00, 31.66it/s]
 88%|████████▊ | 179/204 [00:06<00:00, 31.85it/s]
 90%|████████▉ | 183/204 [00:06<00:00, 31.54it/s]
 92%|█████████▏| 187/204 [00:06<00:00, 30.95it/s]
 94%|█████████▎| 191/204 [00:06<00:00, 30.57it/s]
 96%|█████████▌| 195/204 [00:06<00:00, 31.07it/s]
 98%|█████████▊| 199/204 [00:07<00:00, 30.52it/s]
100%|█████████▉| 203/204 [00:07<00:00, 30.31it/s]
100%|██████████| 204/204 [00:07<00:00, 28.03it/s]
26032 images processed, 7.324009895324707 seconds used

Processing out-of-distribution places365 images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:01<01:19,  1.02s/it]
  4%|▍         | 3/79 [00:01<00:23,  3.30it/s]
  9%|▉         | 7/79 [00:01<00:08,  8.35it/s]
 14%|█▍        | 11/79 [00:01<00:05, 12.93it/s]
 19%|█▉        | 15/79 [00:01<00:03, 17.03it/s]
 24%|██▍       | 19/79 [00:01<00:02, 20.59it/s]
 29%|██▉       | 23/79 [00:01<00:02, 22.96it/s]
 34%|███▍      | 27/79 [00:01<00:02, 25.13it/s]
 39%|███▉      | 31/79 [00:02<00:01, 26.46it/s]
 44%|████▍     | 35/79 [00:02<00:01, 28.05it/s]
 49%|████▉     | 39/79 [00:02<00:01, 28.42it/s]
 54%|█████▍    | 43/79 [00:02<00:01, 28.82it/s]
 59%|█████▉    | 47/79 [00:02<00:01, 29.61it/s]
 65%|██████▍   | 51/79 [00:02<00:00, 29.74it/s]
 70%|██████▉   | 55/79 [00:02<00:00, 30.33it/s]
 75%|███████▍  | 59/79 [00:02<00:00, 30.63it/s]
 80%|███████▉  | 63/79 [00:03<00:00, 30.47it/s]
 85%|████████▍ | 67/79 [00:03<00:00, 31.03it/s]
 90%|████████▉ | 71/79 [00:03<00:00, 30.79it/s]
 95%|█████████▍| 75/79 [00:03<00:00, 30.45it/s]
100%|██████████| 79/79 [00:03<00:00, 29.41it/s]
100%|██████████| 79/79 [00:03<00:00, 21.80it/s]
10000 images processed, 3.6603386402130127 seconds used

Processing out-of-distribution LSUN images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:00<01:04,  1.20it/s]
  5%|▌         | 4/79 [00:00<00:13,  5.37it/s]
  9%|▉         | 7/79 [00:01<00:07,  9.55it/s]
 13%|█▎        | 10/79 [00:01<00:05, 13.45it/s]
 16%|█▋        | 13/79 [00:01<00:03, 17.03it/s]
 20%|██        | 16/79 [00:01<00:03, 19.88it/s]
 24%|██▍       | 19/79 [00:01<00:02, 22.01it/s]
 29%|██▉       | 23/79 [00:01<00:02, 24.42it/s]
 33%|███▎      | 26/79 [00:01<00:02, 25.79it/s]
 38%|███▊      | 30/79 [00:01<00:01, 27.62it/s]
 43%|████▎     | 34/79 [00:01<00:01, 28.02it/s]
 47%|████▋     | 37/79 [00:02<00:01, 28.29it/s]
 51%|█████     | 40/79 [00:02<00:01, 28.72it/s]
 54%|█████▍    | 43/79 [00:02<00:01, 29.02it/s]
 59%|█████▉    | 47/79 [00:02<00:01, 30.00it/s]
 65%|██████▍   | 51/79 [00:02<00:00, 29.87it/s]
 70%|██████▉   | 55/79 [00:02<00:00, 32.03it/s]
 76%|███████▌  | 60/79 [00:02<00:00, 36.83it/s]
 81%|████████  | 64/79 [00:02<00:00, 34.64it/s]
 86%|████████▌ | 68/79 [00:02<00:00, 33.60it/s]
 91%|█████████ | 72/79 [00:03<00:00, 32.44it/s]
 96%|█████████▌| 76/79 [00:03<00:00, 31.57it/s]
100%|██████████| 79/79 [00:03<00:00, 23.80it/s]
10000 images processed, 3.340554714202881 seconds used

Processing out-of-distribution iSUN images

  0%|          | 0/70 [00:00<?, ?it/s]
  1%|▏         | 1/70 [00:00<01:08,  1.00it/s]
  7%|▋         | 5/70 [00:01<00:11,  5.67it/s]
 11%|█▏        | 8/70 [00:01<00:06,  9.25it/s]
 17%|█▋        | 12/70 [00:01<00:04, 14.05it/s]
 23%|██▎       | 16/70 [00:01<00:02, 18.00it/s]
 31%|███▏      | 22/70 [00:01<00:01, 25.45it/s]
 37%|███▋      | 26/70 [00:01<00:01, 27.69it/s]
 43%|████▎     | 30/70 [00:01<00:01, 28.23it/s]
 49%|████▊     | 34/70 [00:01<00:01, 29.63it/s]
 54%|█████▍    | 38/70 [00:02<00:01, 29.39it/s]
 60%|██████    | 42/70 [00:02<00:00, 29.80it/s]
 66%|██████▌   | 46/70 [00:02<00:00, 30.06it/s]
 71%|███████▏  | 50/70 [00:02<00:00, 30.00it/s]
 77%|███████▋  | 54/70 [00:02<00:00, 29.93it/s]
 83%|████████▎ | 58/70 [00:02<00:00, 30.15it/s]
 89%|████████▊ | 62/70 [00:02<00:00, 30.34it/s]
 94%|█████████▍| 66/70 [00:03<00:00, 30.60it/s]
100%|██████████| 70/70 [00:03<00:00, 31.04it/s]
100%|██████████| 70/70 [00:03<00:00, 22.18it/s]
8925 images processed, 3.2005975246429443 seconds used

Processing out-of-distribution dtd images

  0%|          | 0/45 [00:00<?, ?it/s]
  2%|▏         | 1/45 [00:01<01:03,  1.45s/it]
  9%|▉         | 4/45 [00:01<00:12,  3.26it/s]
 18%|█▊        | 8/45 [00:01<00:05,  7.08it/s]
 27%|██▋       | 12/45 [00:01<00:03, 10.97it/s]
 33%|███▎      | 15/45 [00:01<00:02, 13.69it/s]
 40%|████      | 18/45 [00:02<00:01, 13.99it/s]
 49%|████▉     | 22/45 [00:02<00:01, 17.81it/s]
 56%|█████▌    | 25/45 [00:02<00:01, 19.84it/s]
 64%|██████▍   | 29/45 [00:02<00:00, 22.63it/s]
 71%|███████   | 32/45 [00:02<00:00, 23.74it/s]
 78%|███████▊  | 35/45 [00:02<00:00, 18.85it/s]
 84%|████████▍ | 38/45 [00:02<00:00, 20.63it/s]
 93%|█████████▎| 42/45 [00:03<00:00, 23.07it/s]
100%|██████████| 45/45 [00:03<00:00, 14.00it/s]
5640 images processed, 3.2355377674102783 seconds used

39.72738337516785
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.18  98.70
places365     73.27  79.68
LSUN          49.17  88.47
iSUN          50.78  88.26
dtd           41.05  90.05
AVG           43.69  89.03
[incremental] Overall: 0.6220 New: 0.6220 Old: 0.6220
[incremental] Final(Top-1): 0.6220  Average: 0.7277
16.68028974533081
==== Stage 5: inc={100,101,102,103,104}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10,64,22,42,9,90}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5', adapter_load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='100,101,102,103,104', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10,64,22,42,9,90', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='forget_only', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt

  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:241: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

  2%|▏         | 1/50 [00:14<12:13, 14.97s/it]
  4%|▍         | 2/50 [00:17<06:03,  7.57s/it]
  6%|▌         | 3/50 [00:19<04:04,  5.21s/it]
  8%|▊         | 4/50 [00:22<03:08,  4.11s/it]
 10%|█         | 5/50 [00:24<02:36,  3.48s/it]
 12%|█▏        | 6/50 [00:26<02:17,  3.12s/it]
 14%|█▍        | 7/50 [00:29<02:06,  2.94s/it]
 16%|█▌        | 8/50 [00:31<01:56,  2.77s/it]
 18%|█▊        | 9/50 [00:34<01:48,  2.64s/it]
 20%|██        | 10/50 [00:36<01:41,  2.53s/it]
 22%|██▏       | 11/50 [00:38<01:36,  2.47s/it]
 24%|██▍       | 12/50 [00:41<01:30,  2.39s/it]
 26%|██▌       | 13/50 [00:43<01:27,  2.35s/it]
 28%|██▊       | 14/50 [00:45<01:24,  2.35s/it]
 30%|███       | 15/50 [00:48<01:22,  2.35s/it]
 32%|███▏      | 16/50 [00:50<01:19,  2.34s/it]
 34%|███▍      | 17/50 [00:52<01:16,  2.32s/it]
 36%|███▌      | 18/50 [00:54<01:13,  2.31s/it]
 38%|███▊      | 19/50 [00:57<01:11,  2.31s/it]
 40%|████      | 20/50 [00:59<01:09,  2.31s/it]
 42%|████▏     | 21/50 [01:01<01:06,  2.30s/it]
 44%|████▍     | 22/50 [01:04<01:04,  2.31s/it]
 46%|████▌     | 23/50 [01:06<01:03,  2.35s/it]
 48%|████▊     | 24/50 [01:09<01:01,  2.38s/it]
 50%|█████     | 25/50 [01:11<00:59,  2.39s/it]
 52%|█████▏    | 26/50 [01:13<00:57,  2.38s/it]
 54%|█████▍    | 27/50 [01:16<00:54,  2.37s/it]
 56%|█████▌    | 28/50 [01:18<00:52,  2.37s/it]
 58%|█████▊    | 29/50 [01:20<00:49,  2.35s/it]
 60%|██████    | 30/50 [01:23<00:46,  2.35s/it][loss] ep 0 it 0 total=5.0085 mle=0.0000 pcon=0.0000 forget=0.0000 orth=5.0085 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 2 it 10 total=4.9902 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.9902 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 5 it 0 total=4.9289 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.9289 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 7 it 10 total=4.8160 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.8160 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 10 it 0 total=4.6368 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.6368 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 12 it 10 total=4.4013 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.4013 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 15 it 0 total=4.1391 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.1391 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 17 it 10 total=3.8600 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.8600 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 20 it 0 total=3.5799 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.5799 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 22 it 10 total=3.3164 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.3164 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 25 it 0 total=3.0825 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.0825 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 27 it 10 total=2.8848 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.8848 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5

 62%|██████▏   | 31/50 [01:25<00:44,  2.35s/it]
 64%|██████▍   | 32/50 [01:28<00:42,  2.39s/it]
 66%|██████▌   | 33/50 [01:30<00:40,  2.40s/it]
 68%|██████▊   | 34/50 [01:32<00:38,  2.42s/it]
 70%|███████   | 35/50 [01:35<00:36,  2.46s/it]
 72%|███████▏  | 36/50 [01:38<00:35,  2.51s/it]
 74%|███████▍  | 37/50 [01:40<00:32,  2.47s/it]
 76%|███████▌  | 38/50 [01:42<00:29,  2.43s/it]
 78%|███████▊  | 39/50 [01:45<00:26,  2.40s/it]
 80%|████████  | 40/50 [01:47<00:23,  2.38s/it]
 82%|████████▏ | 41/50 [01:49<00:21,  2.38s/it]
 84%|████████▍ | 42/50 [01:52<00:18,  2.37s/it]
 86%|████████▌ | 43/50 [01:54<00:16,  2.35s/it]
 88%|████████▊ | 44/50 [01:56<00:14,  2.34s/it]
 90%|█████████ | 45/50 [01:59<00:11,  2.39s/it]
 92%|█████████▏| 46/50 [02:01<00:09,  2.40s/it]
 94%|█████████▍| 47/50 [02:04<00:07,  2.39s/it]
 96%|█████████▌| 48/50 [02:06<00:04,  2.39s/it]
 98%|█████████▊| 49/50 [02:08<00:02,  2.38s/it]
100%|██████████| 50/50 [02:11<00:00,  2.35s/it]
100%|██████████| 50/50 [02:11<00:00,  2.62s/it]
[loss] ep 30 it 0 total=2.7245 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.7245 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 32 it 10 total=2.5993 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.5993 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 35 it 0 total=2.5054 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.5054 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 37 it 10 total=2.4380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.4380 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 40 it 0 total=2.3926 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.3926 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 42 it 10 total=2.3648 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.3648 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 45 it 0 total=2.3503 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.3503 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[loss] ep 47 it 10 total=2.3446 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.3446 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stage5-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images

  0%|          | 0/430 [00:00<?, ?it/s]
  0%|          | 1/430 [00:00<04:58,  1.44it/s]
  1%|          | 4/430 [00:00<01:08,  6.23it/s]
  2%|▏         | 8/430 [00:00<00:34, 12.06it/s]
  3%|▎         | 12/430 [00:01<00:24, 16.79it/s]
  4%|▎         | 16/430 [00:01<00:19, 20.97it/s]
  5%|▍         | 20/430 [00:01<00:17, 23.71it/s]
  6%|▌         | 24/430 [00:01<00:15, 25.68it/s]
  7%|▋         | 28/430 [00:01<00:14, 27.90it/s]
  7%|▋         | 32/430 [00:01<00:13, 28.85it/s]
  8%|▊         | 36/430 [00:01<00:13, 29.37it/s]
  9%|▉         | 40/430 [00:01<00:12, 30.81it/s]
 10%|█         | 44/430 [00:02<00:12, 30.84it/s]
 11%|█         | 48/430 [00:02<00:12, 30.76it/s]
 12%|█▏        | 52/430 [00:02<00:11, 32.15it/s]
 13%|█▎        | 56/430 [00:02<00:11, 32.04it/s]
 14%|█▍        | 60/430 [00:02<00:11, 31.60it/s]
 15%|█▍        | 64/430 [00:02<00:11, 31.77it/s]
 16%|█▌        | 68/430 [00:02<00:11, 31.75it/s]
 17%|█▋        | 72/430 [00:02<00:11, 31.40it/s]
 18%|█▊        | 76/430 [00:03<00:11, 31.91it/s]
 19%|█▊        | 80/430 [00:03<00:11, 31.49it/s]
 20%|█▉        | 84/430 [00:03<00:10, 32.74it/s]
 21%|██        | 89/430 [00:03<00:09, 36.83it/s]
 22%|██▏       | 93/430 [00:03<00:09, 34.92it/s]
 23%|██▎       | 97/430 [00:03<00:09, 34.46it/s]
 23%|██▎       | 101/430 [00:03<00:09, 33.24it/s]
 24%|██▍       | 105/430 [00:03<00:09, 32.51it/s]
 25%|██▌       | 109/430 [00:04<00:09, 32.95it/s]
 26%|██▋       | 113/430 [00:04<00:09, 32.22it/s]
 27%|██▋       | 117/430 [00:04<00:09, 31.78it/s]
 28%|██▊       | 121/430 [00:04<00:09, 32.59it/s]
 29%|██▉       | 125/430 [00:04<00:09, 31.96it/s]
 30%|███       | 129/430 [00:04<00:09, 31.75it/s]
 31%|███       | 133/430 [00:04<00:09, 32.56it/s]
 32%|███▏      | 137/430 [00:04<00:09, 31.96it/s]
 33%|███▎      | 141/430 [00:05<00:09, 31.76it/s]
 34%|███▎      | 145/430 [00:05<00:08, 32.25it/s]
 35%|███▍      | 149/430 [00:05<00:08, 31.74it/s]
 36%|███▌      | 153/430 [00:05<00:08, 31.46it/s]
 37%|███▋      | 157/430 [00:05<00:08, 32.35it/s]
 37%|███▋      | 161/430 [00:05<00:08, 31.39it/s]
 38%|███▊      | 165/430 [00:05<00:08, 30.56it/s]
 39%|███▉      | 169/430 [00:05<00:08, 30.66it/s]
 40%|████      | 173/430 [00:06<00:08, 30.65it/s]
 41%|████      | 177/430 [00:06<00:08, 31.45it/s]
 42%|████▏     | 181/430 [00:06<00:07, 31.65it/s]
 43%|████▎     | 185/430 [00:06<00:07, 31.33it/s]
 44%|████▍     | 189/430 [00:06<00:07, 31.37it/s]
 45%|████▍     | 193/430 [00:06<00:07, 31.15it/s]
 46%|████▌     | 197/430 [00:06<00:07, 32.30it/s]
 47%|████▋     | 202/430 [00:06<00:06, 36.80it/s]
 48%|████▊     | 206/430 [00:07<00:06, 34.78it/s]
 49%|████▉     | 210/430 [00:07<00:06, 33.10it/s]
 50%|████▉     | 214/430 [00:07<00:06, 32.32it/s]
 51%|█████     | 218/430 [00:07<00:06, 31.79it/s]
 52%|█████▏    | 222/430 [00:07<00:06, 32.43it/s]
 53%|█████▎    | 226/430 [00:07<00:06, 31.85it/s]
 53%|█████▎    | 230/430 [00:07<00:06, 31.45it/s]
 54%|█████▍    | 234/430 [00:07<00:06, 31.44it/s]
 55%|█████▌    | 238/430 [00:08<00:06, 31.18it/s]
 56%|█████▋    | 242/430 [00:08<00:06, 30.67it/s]
 57%|█████▋    | 246/430 [00:08<00:05, 32.28it/s]
 58%|█████▊    | 250/430 [00:08<00:05, 31.77it/s]
 59%|█████▉    | 254/430 [00:08<00:05, 31.39it/s]
 60%|██████    | 258/430 [00:08<00:05, 31.33it/s]
 61%|██████    | 262/430 [00:08<00:05, 33.30it/s]
 62%|██████▏   | 268/430 [00:08<00:04, 37.79it/s]
 63%|██████▎   | 272/430 [00:09<00:04, 35.51it/s]
 64%|██████▍   | 276/430 [00:09<00:04, 33.96it/s]
 65%|██████▌   | 280/430 [00:09<00:04, 33.08it/s]
 66%|██████▌   | 284/430 [00:09<00:04, 32.31it/s]
 67%|██████▋   | 288/430 [00:09<00:04, 31.64it/s]
 68%|██████▊   | 292/430 [00:09<00:04, 32.44it/s]
 69%|██████▉   | 296/430 [00:09<00:04, 31.87it/s]
 70%|██████▉   | 300/430 [00:09<00:04, 31.50it/s]
 71%|███████   | 304/430 [00:10<00:04, 31.22it/s]
 72%|███████▏  | 308/430 [00:10<00:03, 31.02it/s]
 73%|███████▎  | 312/430 [00:10<00:03, 31.69it/s]
 73%|███████▎  | 316/430 [00:10<00:03, 31.33it/s]
 74%|███████▍  | 320/430 [00:10<00:03, 31.13it/s]
 75%|███████▌  | 324/430 [00:10<00:03, 31.35it/s]
 76%|███████▋  | 328/430 [00:10<00:03, 31.09it/s]
 77%|███████▋  | 332/430 [00:11<00:03, 30.94it/s]
 78%|███████▊  | 336/430 [00:11<00:02, 32.01it/s]
 79%|███████▉  | 340/430 [00:11<00:02, 31.58it/s]
 80%|████████  | 344/430 [00:11<00:02, 31.25it/s]
 81%|████████  | 348/430 [00:11<00:02, 31.19it/s]
 82%|████████▏ | 352/430 [00:11<00:02, 30.69it/s]
 83%|████████▎ | 356/430 [00:11<00:02, 31.80it/s]
 84%|████████▎ | 360/430 [00:11<00:02, 31.42it/s]
 85%|████████▍ | 364/430 [00:12<00:02, 31.21it/s]
 86%|████████▌ | 368/430 [00:12<00:01, 31.04it/s]
 87%|████████▋ | 372/430 [00:12<00:01, 30.27it/s]
 87%|████████▋ | 376/430 [00:12<00:01, 32.46it/s]
 89%|████████▉ | 382/430 [00:12<00:01, 38.80it/s]
 90%|████████▉ | 386/430 [00:12<00:01, 36.17it/s]
 91%|█████████ | 390/430 [00:12<00:01, 34.45it/s]
 92%|█████████▏| 394/430 [00:12<00:01, 32.88it/s]
 93%|█████████▎| 398/430 [00:13<00:00, 32.22it/s]
 93%|█████████▎| 402/430 [00:13<00:00, 33.03it/s]
 94%|█████████▍| 406/430 [00:13<00:00, 32.31it/s]
 95%|█████████▌| 410/430 [00:13<00:00, 31.80it/s]
 96%|█████████▋| 414/430 [00:13<00:00, 31.57it/s]
 97%|█████████▋| 418/430 [00:13<00:00, 31.26it/s]
 98%|█████████▊| 422/430 [00:13<00:00, 31.32it/s]
 99%|█████████▉| 426/430 [00:13<00:00, 30.69it/s]
100%|██████████| 430/430 [00:14<00:00, 30.96it/s]
100%|██████████| 430/430 [00:14<00:00, 30.58it/s]
55000 images processed, 14.1856107711792 seconds used

Processing in-distribution CIFAR-110 images

  0%|          | 0/86 [00:00<?, ?it/s]
  1%|          | 1/86 [00:00<01:09,  1.22it/s]
  6%|▌         | 5/86 [00:00<00:12,  6.66it/s]
 10%|█         | 9/86 [00:01<00:06, 11.66it/s]
 15%|█▌        | 13/86 [00:01<00:04, 16.02it/s]
 20%|█▉        | 17/86 [00:01<00:03, 20.67it/s]
 26%|██▌       | 22/86 [00:01<00:02, 26.59it/s]
 31%|███▏      | 27/86 [00:01<00:01, 30.25it/s]
 36%|███▌      | 31/86 [00:01<00:01, 30.35it/s]
 41%|████      | 35/86 [00:01<00:01, 30.40it/s]
 45%|████▌     | 39/86 [00:01<00:01, 31.43it/s]
 50%|█████     | 43/86 [00:02<00:01, 31.17it/s]
 55%|█████▍    | 47/86 [00:02<00:01, 30.83it/s]
 59%|█████▉    | 51/86 [00:02<00:01, 31.05it/s]
 64%|██████▍   | 55/86 [00:02<00:01, 30.90it/s]
 69%|██████▊   | 59/86 [00:02<00:00, 31.79it/s]
 73%|███████▎  | 63/86 [00:02<00:00, 32.08it/s]
 78%|███████▊  | 67/86 [00:02<00:00, 31.60it/s]
 83%|████████▎ | 71/86 [00:02<00:00, 31.30it/s]
 87%|████████▋ | 75/86 [00:03<00:00, 31.09it/s]
 92%|█████████▏| 79/86 [00:03<00:00, 30.92it/s]
 97%|█████████▋| 83/86 [00:03<00:00, 31.92it/s]
100%|██████████| 86/86 [00:03<00:00, 25.06it/s]
11000 images processed, 3.451742172241211 seconds used

Processing out-of-distribution SVHN images

  0%|          | 0/204 [00:00<?, ?it/s]
  0%|          | 1/204 [00:00<03:10,  1.07it/s]
  2%|▏         | 4/204 [00:01<00:41,  4.81it/s]
  3%|▎         | 7/204 [00:01<00:22,  8.61it/s]
  5%|▍         | 10/204 [00:01<00:15, 12.36it/s]
  6%|▋         | 13/204 [00:01<00:12, 15.91it/s]
  8%|▊         | 16/204 [00:01<00:10, 18.59it/s]
  9%|▉         | 19/204 [00:01<00:08, 20.74it/s]
 11%|█         | 22/204 [00:01<00:08, 22.41it/s]
 12%|█▏        | 25/204 [00:01<00:07, 23.64it/s]
 14%|█▎        | 28/204 [00:01<00:07, 24.60it/s]
 16%|█▌        | 32/204 [00:02<00:06, 26.63it/s]
 17%|█▋        | 35/204 [00:02<00:06, 26.72it/s]
 19%|█▊        | 38/204 [00:02<00:06, 26.76it/s]
 20%|██        | 41/204 [00:02<00:06, 26.94it/s]
 22%|██▏       | 44/204 [00:02<00:05, 26.91it/s]
 23%|██▎       | 47/204 [00:02<00:05, 27.11it/s]
 25%|██▌       | 51/204 [00:02<00:05, 27.90it/s]
 26%|██▋       | 54/204 [00:02<00:05, 27.61it/s]
 28%|██▊       | 57/204 [00:02<00:05, 27.54it/s]
 29%|██▉       | 60/204 [00:03<00:05, 27.33it/s]
 31%|███       | 63/204 [00:03<00:05, 27.20it/s]
 32%|███▏      | 66/204 [00:03<00:04, 27.81it/s]
 34%|███▍      | 70/204 [00:03<00:04, 28.37it/s]
 36%|███▌      | 73/204 [00:03<00:04, 27.90it/s]
 37%|███▋      | 76/204 [00:03<00:04, 26.90it/s]
 39%|███▊      | 79/204 [00:03<00:04, 26.61it/s]
 41%|████      | 83/204 [00:03<00:04, 28.13it/s]
 42%|████▏     | 86/204 [00:04<00:04, 27.75it/s]
 44%|████▎     | 89/204 [00:04<00:04, 27.51it/s]
 45%|████▌     | 92/204 [00:04<00:04, 27.00it/s]
 47%|████▋     | 95/204 [00:04<00:04, 26.95it/s]
 48%|████▊     | 98/204 [00:04<00:03, 26.93it/s]
 50%|█████     | 102/204 [00:04<00:03, 28.29it/s]
 51%|█████▏    | 105/204 [00:04<00:03, 27.87it/s]
 53%|█████▎    | 108/204 [00:04<00:03, 27.57it/s]
 54%|█████▍    | 111/204 [00:04<00:03, 26.59it/s]
 56%|█████▌    | 114/204 [00:05<00:03, 26.67it/s]
 57%|█████▋    | 117/204 [00:05<00:03, 26.72it/s]
 59%|█████▉    | 121/204 [00:05<00:02, 27.96it/s]
 61%|██████    | 124/204 [00:05<00:02, 27.77it/s]
 62%|██████▏   | 127/204 [00:05<00:02, 27.53it/s]
 64%|██████▎   | 130/204 [00:05<00:02, 27.33it/s]
 65%|██████▌   | 133/204 [00:05<00:02, 27.21it/s]
 67%|██████▋   | 136/204 [00:05<00:02, 27.11it/s]
 69%|██████▊   | 140/204 [00:05<00:02, 28.57it/s]
 70%|███████   | 143/204 [00:06<00:02, 28.07it/s]
 72%|███████▏  | 146/204 [00:06<00:02, 27.72it/s]
 73%|███████▎  | 149/204 [00:06<00:02, 27.46it/s]
 75%|███████▍  | 152/204 [00:06<00:01, 27.29it/s]
 76%|███████▌  | 155/204 [00:06<00:01, 27.17it/s]
 78%|███████▊  | 159/204 [00:06<00:01, 27.81it/s]
 79%|███████▉  | 162/204 [00:06<00:01, 27.53it/s]
 81%|████████  | 165/204 [00:06<00:01, 27.48it/s]
 83%|████████▎ | 169/204 [00:07<00:01, 29.24it/s]
 85%|████████▌ | 174/204 [00:07<00:00, 33.36it/s]
 87%|████████▋ | 178/204 [00:07<00:00, 33.28it/s]
 89%|████████▉ | 182/204 [00:07<00:00, 31.01it/s]
 91%|█████████ | 186/204 [00:07<00:00, 29.78it/s]
 93%|█████████▎| 190/204 [00:07<00:00, 28.83it/s]
 95%|█████████▍| 193/204 [00:07<00:00, 28.65it/s]
 96%|█████████▌| 196/204 [00:07<00:00, 28.74it/s]
 98%|█████████▊| 199/204 [00:08<00:00, 28.23it/s]
 99%|█████████▉| 202/204 [00:08<00:00, 27.84it/s]
100%|██████████| 204/204 [00:08<00:00, 24.91it/s]
26032 images processed, 8.247721672058105 seconds used

Processing out-of-distribution places365 images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:00<00:55,  1.41it/s]
  5%|▌         | 4/79 [00:00<00:12,  6.20it/s]
  9%|▉         | 7/79 [00:00<00:06, 10.55it/s]
 13%|█▎        | 10/79 [00:01<00:04, 14.33it/s]
 16%|█▋        | 13/79 [00:01<00:03, 17.53it/s]
 20%|██        | 16/79 [00:01<00:03, 19.98it/s]
 24%|██▍       | 19/79 [00:01<00:02, 21.85it/s]
 28%|██▊       | 22/79 [00:01<00:02, 23.80it/s]
 32%|███▏      | 25/79 [00:01<00:02, 24.97it/s]
 35%|███▌      | 28/79 [00:01<00:01, 25.54it/s]
 39%|███▉      | 31/79 [00:01<00:01, 26.06it/s]
 43%|████▎     | 34/79 [00:01<00:01, 26.42it/s]
 47%|████▋     | 37/79 [00:02<00:01, 26.58it/s]
 51%|█████     | 40/79 [00:02<00:01, 26.89it/s]
 54%|█████▍    | 43/79 [00:02<00:01, 27.36it/s]
 58%|█████▊    | 46/79 [00:02<00:01, 27.20it/s]
 62%|██████▏   | 49/79 [00:02<00:01, 27.27it/s]
 66%|██████▌   | 52/79 [00:02<00:00, 27.31it/s]
 70%|██████▉   | 55/79 [00:02<00:00, 27.16it/s]
 73%|███████▎  | 58/79 [00:02<00:00, 27.08it/s]
 78%|███████▊  | 62/79 [00:02<00:00, 28.12it/s]
 82%|████████▏ | 65/79 [00:03<00:00, 27.76it/s]
 86%|████████▌ | 68/79 [00:03<00:00, 27.37it/s]
 90%|████████▉ | 71/79 [00:03<00:00, 27.17it/s]
 94%|█████████▎| 74/79 [00:03<00:00, 27.09it/s]
 97%|█████████▋| 77/79 [00:03<00:00, 27.52it/s]
100%|██████████| 79/79 [00:03<00:00, 22.35it/s]
10000 images processed, 3.576718330383301 seconds used

Processing out-of-distribution LSUN images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:00<01:10,  1.11it/s]
  5%|▌         | 4/79 [00:01<00:15,  5.00it/s]
  9%|▉         | 7/79 [00:01<00:08,  8.87it/s]
 13%|█▎        | 10/79 [00:01<00:05, 12.61it/s]
 16%|█▋        | 13/79 [00:01<00:04, 16.10it/s]
 20%|██        | 16/79 [00:01<00:03, 18.76it/s]
 24%|██▍       | 19/79 [00:01<00:02, 20.99it/s]
 28%|██▊       | 22/79 [00:01<00:02, 22.72it/s]
 32%|███▏      | 25/79 [00:01<00:02, 23.87it/s]
 35%|███▌      | 28/79 [00:01<00:02, 24.77it/s]
 41%|████      | 32/79 [00:02<00:01, 26.47it/s]
 44%|████▍     | 35/79 [00:02<00:01, 26.58it/s]
 48%|████▊     | 38/79 [00:02<00:01, 26.65it/s]
 52%|█████▏    | 41/79 [00:02<00:01, 26.68it/s]
 56%|█████▌    | 44/79 [00:02<00:01, 26.75it/s]
 59%|█████▉    | 47/79 [00:02<00:01, 27.44it/s]
 65%|██████▍   | 51/79 [00:02<00:00, 28.17it/s]
 68%|██████▊   | 54/79 [00:02<00:00, 27.79it/s]
 72%|███████▏  | 57/79 [00:02<00:00, 27.51it/s]
 76%|███████▌  | 60/79 [00:03<00:00, 27.32it/s]
 80%|███████▉  | 63/79 [00:03<00:00, 27.20it/s]
 87%|████████▋ | 69/79 [00:03<00:00, 34.04it/s]
 92%|█████████▏| 73/79 [00:03<00:00, 31.87it/s]
 97%|█████████▋| 77/79 [00:03<00:00, 30.36it/s]
100%|██████████| 79/79 [00:03<00:00, 21.87it/s]
10000 images processed, 3.638310432434082 seconds used

Processing out-of-distribution iSUN images

  0%|          | 0/70 [00:00<?, ?it/s]
  1%|▏         | 1/70 [00:00<01:03,  1.08it/s]
  7%|▋         | 5/70 [00:01<00:10,  6.09it/s]
 11%|█▏        | 8/70 [00:01<00:06,  9.65it/s]
 16%|█▌        | 11/70 [00:01<00:04, 13.03it/s]
 20%|██        | 14/70 [00:01<00:03, 16.06it/s]
 24%|██▍       | 17/70 [00:01<00:02, 18.67it/s]
 29%|██▊       | 20/70 [00:01<00:02, 20.75it/s]
 34%|███▍      | 24/70 [00:01<00:01, 23.07it/s]
 39%|███▊      | 27/70 [00:01<00:01, 23.23it/s]
 43%|████▎     | 30/70 [00:01<00:01, 24.32it/s]
 47%|████▋     | 33/70 [00:02<00:01, 25.03it/s]
 51%|█████▏    | 36/70 [00:02<00:01, 25.56it/s]
 57%|█████▋    | 40/70 [00:02<00:01, 29.16it/s]
 63%|██████▎   | 44/70 [00:02<00:00, 30.92it/s]
 69%|██████▊   | 48/70 [00:02<00:00, 29.52it/s]
 74%|███████▍  | 52/70 [00:02<00:00, 28.87it/s]
 79%|███████▊  | 55/70 [00:02<00:00, 28.32it/s]
 84%|████████▍ | 59/70 [00:02<00:00, 28.88it/s]
 89%|████████▊ | 62/70 [00:03<00:00, 28.32it/s]
 93%|█████████▎| 65/70 [00:03<00:00, 27.92it/s]
 97%|█████████▋| 68/70 [00:03<00:00, 27.78it/s]
100%|██████████| 70/70 [00:03<00:00, 20.78it/s]
8925 images processed, 3.405693531036377 seconds used

Processing out-of-distribution dtd images

  0%|          | 0/45 [00:00<?, ?it/s]
  2%|▏         | 1/45 [00:01<00:58,  1.33s/it]
  9%|▉         | 4/45 [00:01<00:11,  3.48it/s]
 16%|█▌        | 7/45 [00:01<00:05,  6.53it/s]
 22%|██▏       | 10/45 [00:01<00:03,  9.73it/s]
 29%|██▉       | 13/45 [00:01<00:02, 12.86it/s]
 36%|███▌      | 16/45 [00:01<00:01, 15.78it/s]
 42%|████▏     | 19/45 [00:02<00:01, 16.39it/s]
 49%|████▉     | 22/45 [00:02<00:01, 18.76it/s]
 56%|█████▌    | 25/45 [00:02<00:00, 20.15it/s]
 62%|██████▏   | 28/45 [00:02<00:00, 21.85it/s]
 69%|██████▉   | 31/45 [00:02<00:00, 23.17it/s]
 76%|███████▌  | 34/45 [00:02<00:00, 20.27it/s]
 82%|████████▏ | 37/45 [00:02<00:00, 21.90it/s]
 89%|████████▉ | 40/45 [00:02<00:00, 23.21it/s]
 96%|█████████▌| 43/45 [00:03<00:00, 24.32it/s]
100%|██████████| 45/45 [00:03<00:00, 14.41it/s]
5640 images processed, 3.1440515518188477 seconds used

41.47641205787659
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.29  98.70
places365     77.43  78.95
LSUN          49.55  88.75
iSUN          53.37  88.12
dtd           41.22  90.30
AVG           45.17  88.96
[incremental] Overall: 0.5576 New: 0.4640 Old: 0.5810
[incremental] Final(Top-1): 0.5576  Average: 0.6937
19.626134395599365
==== Stage 6: inc={105,106,107,108,109}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10,64,22,42,9,90,100,101,102,103,104}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6', adapter_load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage1,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage2,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage3,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage4,checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='105,106,107,108,109', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10,64,22,42,9,90,100,101,102,103,104', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='forget_only', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage5
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt

  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:241: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

  2%|▏         | 1/50 [00:16<13:38, 16.70s/it]
  4%|▍         | 2/50 [00:19<06:38,  8.31s/it]
  6%|▌         | 3/50 [00:21<04:23,  5.61s/it]
  8%|▊         | 4/50 [00:23<03:20,  4.37s/it]
 10%|█         | 5/50 [00:26<02:45,  3.67s/it]
 12%|█▏        | 6/50 [00:28<02:22,  3.23s/it]
 14%|█▍        | 7/50 [00:31<02:06,  2.95s/it]
 16%|█▌        | 8/50 [00:33<01:56,  2.76s/it]
 18%|█▊        | 9/50 [00:35<01:47,  2.62s/it]
 20%|██        | 10/50 [00:38<01:39,  2.49s/it]
 22%|██▏       | 11/50 [00:40<01:34,  2.42s/it]
 24%|██▍       | 12/50 [00:42<01:29,  2.35s/it]
 26%|██▌       | 13/50 [00:44<01:24,  2.29s/it]
 28%|██▊       | 14/50 [00:46<01:22,  2.29s/it]
 30%|███       | 15/50 [00:49<01:20,  2.29s/it]
 32%|███▏      | 16/50 [00:51<01:16,  2.26s/it]
 34%|███▍      | 17/50 [00:53<01:13,  2.22s/it]
 36%|███▌      | 18/50 [00:55<01:10,  2.22s/it]
 38%|███▊      | 19/50 [00:58<01:09,  2.23s/it]
 40%|████      | 20/50 [01:00<01:06,  2.22s/it]
 42%|████▏     | 21/50 [01:02<01:04,  2.23s/it]
 44%|████▍     | 22/50 [01:04<01:03,  2.25s/it]
 46%|████▌     | 23/50 [01:06<01:00,  2.24s/it]
 48%|████▊     | 24/50 [01:09<00:59,  2.29s/it]
 50%|█████     | 25/50 [01:11<00:58,  2.34s/it]
 52%|█████▏    | 26/50 [01:14<00:56,  2.33s/it]
 54%|█████▍    | 27/50 [01:16<00:53,  2.35s/it]
 56%|█████▌    | 28/50 [01:19<00:52,  2.39s/it]
 58%|█████▊    | 29/50 [01:21<00:49,  2.35s/it]
 60%|██████    | 30/50 [01:23<00:46,  2.32s/it][loss] ep 0 it 0 total=4.5545 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.5545 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 2 it 10 total=4.5346 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.5346 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 5 it 0 total=4.4673 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.4673 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 7 it 10 total=4.3409 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.3409 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 10 it 0 total=4.1346 mle=0.0000 pcon=0.0000 forget=0.0000 orth=4.1346 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 12 it 10 total=3.8579 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.8579 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 15 it 0 total=3.5521 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.5521 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 17 it 10 total=3.2381 mle=0.0000 pcon=0.0000 forget=0.0000 orth=3.2381 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 20 it 0 total=2.9380 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.9380 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 22 it 10 total=2.6694 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.6694 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 25 it 0 total=2.4423 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.4423 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 27 it 10 total=2.2592 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.2592 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6

 62%|██████▏   | 31/50 [01:25<00:43,  2.28s/it]
 64%|██████▍   | 32/50 [01:28<00:41,  2.32s/it]
 66%|██████▌   | 33/50 [01:30<00:39,  2.33s/it]
 68%|██████▊   | 34/50 [01:32<00:37,  2.36s/it]
 70%|███████   | 35/50 [01:35<00:34,  2.33s/it]
 72%|███████▏  | 36/50 [01:37<00:32,  2.29s/it]
 74%|███████▍  | 37/50 [01:39<00:29,  2.28s/it]
 76%|███████▌  | 38/50 [01:41<00:27,  2.28s/it]
 78%|███████▊  | 39/50 [01:44<00:24,  2.27s/it]
 80%|████████  | 40/50 [01:46<00:22,  2.21s/it]
 82%|████████▏ | 41/50 [01:48<00:20,  2.26s/it]
 84%|████████▍ | 42/50 [01:51<00:18,  2.34s/it]
 86%|████████▌ | 43/50 [01:53<00:16,  2.35s/it]
 88%|████████▊ | 44/50 [01:55<00:14,  2.36s/it]
 90%|█████████ | 45/50 [01:58<00:11,  2.36s/it]
 92%|█████████▏| 46/50 [02:00<00:09,  2.34s/it]
 94%|█████████▍| 47/50 [02:02<00:07,  2.34s/it]
 96%|█████████▌| 48/50 [02:05<00:04,  2.29s/it]
 98%|█████████▊| 49/50 [02:07<00:02,  2.30s/it]
100%|██████████| 50/50 [02:09<00:00,  2.31s/it]
100%|██████████| 50/50 [02:09<00:00,  2.59s/it]
[loss] ep 30 it 0 total=2.1172 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.1172 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 32 it 10 total=2.0105 mle=0.0000 pcon=0.0000 forget=0.0000 orth=2.0105 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 35 it 0 total=1.9330 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.9330 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 37 it 10 total=1.8787 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8787 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 40 it 0 total=1.8428 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8428 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 42 it 10 total=1.8211 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8211 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 45 it 0 total=1.8098 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8098 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[loss] ep 47 it 10 total=1.8054 mle=0.0000 pcon=0.0000 forget=0.0000 orth=1.8054 favg=0.0000 nr=0 nf=128 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack/stage6
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stage6-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images

  0%|          | 0/430 [00:00<?, ?it/s]
  0%|          | 1/430 [00:00<03:59,  1.79it/s]
  2%|▏         | 7/430 [00:00<00:32, 12.84it/s]
  3%|▎         | 11/430 [00:00<00:23, 17.52it/s]
  3%|▎         | 15/430 [00:00<00:19, 21.09it/s]
  4%|▍         | 19/430 [00:01<00:17, 23.76it/s]
  5%|▌         | 23/430 [00:01<00:15, 26.14it/s]
  6%|▋         | 27/430 [00:01<00:14, 27.95it/s]
  7%|▋         | 31/430 [00:01<00:13, 28.73it/s]
  8%|▊         | 35/430 [00:01<00:13, 29.31it/s]
  9%|▉         | 39/430 [00:01<00:13, 29.68it/s]
 10%|█         | 43/430 [00:01<00:12, 30.13it/s]
 11%|█         | 47/430 [00:01<00:12, 31.37it/s]
 12%|█▏        | 51/430 [00:02<00:12, 31.11it/s]
 13%|█▎        | 55/430 [00:02<00:12, 30.93it/s]
 14%|█▎        | 59/430 [00:02<00:12, 30.82it/s]
 15%|█▍        | 64/430 [00:02<00:10, 35.52it/s]
 16%|█▋        | 70/430 [00:02<00:09, 39.64it/s]
 17%|█▋        | 75/430 [00:02<00:09, 36.34it/s]
 18%|█▊        | 79/430 [00:02<00:10, 34.63it/s]
 19%|█▉        | 83/430 [00:03<00:10, 33.41it/s]
 20%|██        | 87/430 [00:03<00:10, 33.60it/s]
 21%|██        | 91/430 [00:03<00:10, 32.68it/s]
 22%|██▏       | 95/430 [00:03<00:10, 32.02it/s]
 23%|██▎       | 99/430 [00:03<00:10, 31.59it/s]
 24%|██▍       | 103/430 [00:03<00:10, 31.28it/s]
 25%|██▍       | 107/430 [00:03<00:09, 32.44it/s]
 26%|██▌       | 111/430 [00:03<00:10, 31.85it/s]
 27%|██▋       | 115/430 [00:04<00:10, 31.46it/s]
 28%|██▊       | 119/430 [00:04<00:09, 31.19it/s]
 29%|██▊       | 123/430 [00:04<00:09, 31.00it/s]
 30%|███       | 129/430 [00:04<00:08, 36.31it/s]
 31%|███       | 133/430 [00:04<00:08, 35.48it/s]
 32%|███▏      | 137/430 [00:04<00:08, 34.00it/s]
 33%|███▎      | 141/430 [00:04<00:08, 32.92it/s]
 34%|███▎      | 145/430 [00:04<00:08, 32.20it/s]
 35%|███▍      | 149/430 [00:05<00:08, 32.76it/s]
 36%|███▌      | 153/430 [00:05<00:08, 32.07it/s]
 37%|███▋      | 157/430 [00:05<00:08, 31.61it/s]
 37%|███▋      | 161/430 [00:05<00:08, 31.28it/s]
 38%|███▊      | 165/430 [00:05<00:08, 31.07it/s]
 39%|███▉      | 169/430 [00:05<00:08, 32.00it/s]
 40%|████      | 173/430 [00:05<00:08, 31.66it/s]
 41%|████      | 177/430 [00:05<00:08, 31.61it/s]
 42%|████▏     | 181/430 [00:06<00:07, 31.30it/s]
 43%|████▎     | 185/430 [00:06<00:07, 31.68it/s]
 44%|████▍     | 191/430 [00:06<00:06, 37.98it/s]
 45%|████▌     | 195/430 [00:06<00:06, 37.65it/s]
 46%|████▋     | 199/430 [00:06<00:06, 35.59it/s]
 47%|████▋     | 203/430 [00:06<00:06, 33.98it/s]
 48%|████▊     | 207/430 [00:06<00:06, 32.93it/s]
 49%|████▉     | 211/430 [00:06<00:06, 33.47it/s]
 50%|█████     | 215/430 [00:07<00:06, 32.55it/s]
 51%|█████     | 219/430 [00:07<00:06, 31.96it/s]
 52%|█████▏    | 223/430 [00:07<00:06, 31.52it/s]
 53%|█████▎    | 227/430 [00:07<00:06, 31.23it/s]
 54%|█████▎    | 231/430 [00:07<00:06, 32.02it/s]
 55%|█████▍    | 235/430 [00:07<00:06, 31.58it/s]
 56%|█████▌    | 239/430 [00:07<00:06, 31.28it/s]
 57%|█████▋    | 243/430 [00:07<00:06, 31.06it/s]
 57%|█████▋    | 247/430 [00:08<00:05, 31.07it/s]
 59%|█████▉    | 253/430 [00:08<00:04, 35.79it/s]
 60%|█████▉    | 257/430 [00:08<00:05, 34.21it/s]
 61%|██████    | 261/430 [00:08<00:05, 33.13it/s]
 62%|██████▏   | 265/430 [00:08<00:05, 32.37it/s]
 63%|██████▎   | 269/430 [00:08<00:04, 32.38it/s]
 63%|██████▎   | 273/430 [00:08<00:04, 32.29it/s]
 64%|██████▍   | 277/430 [00:08<00:04, 31.76it/s]
 65%|██████▌   | 281/430 [00:09<00:04, 31.39it/s]
 66%|██████▋   | 285/430 [00:09<00:04, 31.16it/s]
 67%|██████▋   | 289/430 [00:09<00:04, 31.14it/s]
 68%|██████▊   | 293/430 [00:09<00:04, 31.47it/s]
 69%|██████▉   | 297/430 [00:09<00:04, 31.20it/s]
 70%|███████   | 301/430 [00:09<00:04, 31.03it/s]
 71%|███████   | 305/430 [00:09<00:04, 30.88it/s]
 72%|███████▏  | 310/430 [00:09<00:03, 35.24it/s]
 73%|███████▎  | 315/430 [00:10<00:02, 38.45it/s]
 74%|███████▍  | 319/430 [00:10<00:03, 36.92it/s]
 75%|███████▌  | 323/430 [00:10<00:03, 34.86it/s]
 76%|███████▌  | 327/430 [00:10<00:03, 33.52it/s]
 77%|███████▋  | 331/430 [00:10<00:02, 33.70it/s]
 78%|███████▊  | 335/430 [00:10<00:02, 32.73it/s]
 79%|███████▉  | 339/430 [00:10<00:02, 32.05it/s]
 80%|███████▉  | 343/430 [00:10<00:02, 31.76it/s]
 81%|████████  | 347/430 [00:11<00:02, 31.06it/s]
 82%|████████▏ | 351/430 [00:11<00:02, 31.94it/s]
 83%|████████▎ | 355/430 [00:11<00:02, 31.51it/s]
 83%|████████▎ | 359/430 [00:11<00:02, 31.23it/s]
 84%|████████▍ | 363/430 [00:11<00:02, 31.21it/s]
 85%|████████▌ | 367/430 [00:11<00:02, 30.99it/s]
 86%|████████▋ | 371/430 [00:11<00:01, 33.02it/s]
 87%|████████▋ | 376/430 [00:11<00:01, 34.96it/s]
 88%|████████▊ | 380/430 [00:12<00:01, 33.59it/s]
 89%|████████▉ | 384/430 [00:12<00:01, 32.66it/s]
 90%|█████████ | 388/430 [00:12<00:01, 32.03it/s]
 91%|█████████ | 392/430 [00:12<00:01, 32.81it/s]
 92%|█████████▏| 396/430 [00:12<00:01, 32.09it/s]
 93%|█████████▎| 400/430 [00:12<00:00, 31.63it/s]
 94%|█████████▍| 404/430 [00:12<00:00, 31.32it/s]
 95%|█████████▍| 408/430 [00:13<00:00, 31.07it/s]
 96%|█████████▌| 412/430 [00:13<00:00, 31.93it/s]
 97%|█████████▋| 416/430 [00:13<00:00, 31.84it/s]
 98%|█████████▊| 420/430 [00:13<00:00, 31.44it/s]
 99%|█████████▊| 424/430 [00:13<00:00, 31.16it/s]
100%|█████████▉| 428/430 [00:13<00:00, 30.99it/s]
100%|██████████| 430/430 [00:13<00:00, 31.38it/s]
55000 images processed, 13.792361736297607 seconds used

Processing in-distribution CIFAR-110 images

  0%|          | 0/86 [00:00<?, ?it/s]
  1%|          | 1/86 [00:00<00:52,  1.61it/s]
  6%|▌         | 5/86 [00:00<00:09,  8.31it/s]
 10%|█         | 9/86 [00:00<00:05, 13.83it/s]
 15%|█▌        | 13/86 [00:00<00:03, 18.81it/s]
 19%|█▊        | 16/86 [00:01<00:03, 21.24it/s]
 23%|██▎       | 20/86 [00:01<00:02, 24.57it/s]
 29%|██▉       | 25/86 [00:01<00:02, 29.47it/s]
 34%|███▎      | 29/86 [00:01<00:01, 31.93it/s]
 38%|███▊      | 33/86 [00:01<00:01, 32.64it/s]
 43%|████▎     | 37/86 [00:01<00:01, 31.98it/s]
 48%|████▊     | 41/86 [00:01<00:01, 31.54it/s]
 52%|█████▏    | 45/86 [00:01<00:01, 31.26it/s]
 57%|█████▋    | 49/86 [00:02<00:01, 31.04it/s]
 62%|██████▏   | 53/86 [00:02<00:01, 32.94it/s]
 66%|██████▋   | 57/86 [00:02<00:00, 32.19it/s]
 71%|███████   | 61/86 [00:02<00:00, 31.68it/s]
 76%|███████▌  | 65/86 [00:02<00:00, 31.35it/s]
 80%|████████  | 69/86 [00:02<00:00, 31.11it/s]
 85%|████████▍ | 73/86 [00:02<00:00, 31.94it/s]
 90%|████████▉ | 77/86 [00:02<00:00, 31.51it/s]
 94%|█████████▍| 81/86 [00:03<00:00, 31.24it/s]
 99%|█████████▉| 85/86 [00:03<00:00, 31.20it/s]
100%|██████████| 86/86 [00:03<00:00, 26.45it/s]
11000 images processed, 3.2743701934814453 seconds used

Processing out-of-distribution SVHN images

  0%|          | 0/204 [00:00<?, ?it/s]
  0%|          | 1/204 [00:00<02:33,  1.32it/s]
  2%|▏         | 4/204 [00:00<00:34,  5.78it/s]
  3%|▎         | 7/204 [00:00<00:19, 10.07it/s]
  5%|▍         | 10/204 [00:01<00:13, 14.06it/s]
  6%|▋         | 13/204 [00:01<00:11, 17.21it/s]
  8%|▊         | 16/204 [00:01<00:09, 19.73it/s]
  9%|▉         | 19/204 [00:01<00:08, 21.65it/s]
 11%|█         | 22/204 [00:01<00:07, 23.11it/s]
 13%|█▎        | 26/204 [00:01<00:07, 25.37it/s]
 14%|█▍        | 29/204 [00:01<00:06, 25.78it/s]
 16%|█▌        | 32/204 [00:01<00:06, 26.10it/s]
 17%|█▋        | 35/204 [00:01<00:06, 26.33it/s]
 19%|█▊        | 38/204 [00:02<00:06, 26.61it/s]
 20%|██        | 41/204 [00:02<00:05, 27.23it/s]
 22%|██▏       | 44/204 [00:02<00:05, 27.91it/s]
 23%|██▎       | 47/204 [00:02<00:05, 27.60it/s]
 25%|██▍       | 50/204 [00:02<00:05, 27.39it/s]
 26%|██▌       | 53/204 [00:02<00:05, 27.22it/s]
 27%|██▋       | 56/204 [00:02<00:05, 27.09it/s]
 29%|██▉       | 60/204 [00:02<00:05, 28.11it/s]
 31%|███       | 63/204 [00:02<00:05, 27.75it/s]
 32%|███▏      | 66/204 [00:03<00:05, 27.49it/s]
 34%|███▍      | 69/204 [00:03<00:04, 27.47it/s]
 35%|███▌      | 72/204 [00:03<00:04, 27.31it/s]
 37%|███▋      | 75/204 [00:03<00:04, 27.41it/s]
 39%|███▊      | 79/204 [00:03<00:04, 28.41it/s]
 41%|████      | 83/204 [00:03<00:04, 30.19it/s]
 43%|████▎     | 88/204 [00:03<00:03, 33.97it/s]
 45%|████▌     | 92/204 [00:03<00:03, 31.82it/s]
 47%|████▋     | 96/204 [00:04<00:03, 31.49it/s]
 49%|████▉     | 100/204 [00:04<00:03, 29.95it/s]
 51%|█████     | 104/204 [00:04<00:03, 28.96it/s]
 52%|█████▏    | 107/204 [00:04<00:03, 28.40it/s]
 54%|█████▍    | 110/204 [00:04<00:03, 28.24it/s]
 55%|█████▌    | 113/204 [00:04<00:03, 28.15it/s]
 57%|█████▋    | 116/204 [00:04<00:03, 27.77it/s]
 58%|█████▊    | 119/204 [00:04<00:03, 27.66it/s]
 60%|█████▉    | 122/204 [00:05<00:02, 27.43it/s]
 61%|██████▏   | 125/204 [00:05<00:02, 27.25it/s]
 63%|██████▎   | 129/204 [00:05<00:02, 28.23it/s]
 65%|██████▍   | 132/204 [00:05<00:02, 27.84it/s]
 66%|██████▌   | 135/204 [00:05<00:02, 27.57it/s]
 68%|██████▊   | 138/204 [00:05<00:02, 27.37it/s]
 69%|██████▉   | 141/204 [00:05<00:02, 26.90it/s]
 71%|███████   | 144/204 [00:05<00:02, 27.42it/s]
 73%|███████▎  | 148/204 [00:05<00:01, 28.25it/s]
 74%|███████▍  | 151/204 [00:06<00:01, 27.84it/s]
 75%|███████▌  | 154/204 [00:06<00:01, 27.72it/s]
 77%|███████▋  | 157/204 [00:06<00:01, 27.46it/s]
 78%|███████▊  | 160/204 [00:06<00:01, 27.28it/s]
 80%|████████  | 164/204 [00:06<00:01, 28.25it/s]
 82%|████████▏ | 167/204 [00:06<00:01, 27.87it/s]
 83%|████████▎ | 170/204 [00:06<00:01, 27.56it/s]
 85%|████████▍ | 173/204 [00:06<00:01, 27.53it/s]
 86%|████████▋ | 176/204 [00:06<00:01, 27.35it/s]
 88%|████████▊ | 180/204 [00:07<00:00, 30.66it/s]
 91%|█████████ | 185/204 [00:07<00:00, 33.25it/s]
 93%|█████████▎| 189/204 [00:07<00:00, 31.42it/s]
 95%|█████████▍| 193/204 [00:07<00:00, 29.86it/s]
 97%|█████████▋| 197/204 [00:07<00:00, 30.10it/s]
 99%|█████████▊| 201/204 [00:07<00:00, 29.03it/s]
100%|██████████| 204/204 [00:07<00:00, 25.85it/s]
26032 images processed, 7.945929050445557 seconds used

Processing out-of-distribution places365 images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:00<01:10,  1.10it/s]
  4%|▍         | 3/79 [00:01<00:21,  3.60it/s]
 10%|█         | 8/79 [00:01<00:06, 10.80it/s]
 14%|█▍        | 11/79 [00:01<00:04, 14.04it/s]
 18%|█▊        | 14/79 [00:01<00:03, 16.89it/s]
 22%|██▏       | 17/79 [00:01<00:03, 19.31it/s]
 25%|██▌       | 20/79 [00:01<00:02, 21.24it/s]
 29%|██▉       | 23/79 [00:01<00:02, 22.74it/s]
 33%|███▎      | 26/79 [00:01<00:02, 24.57it/s]
 37%|███▋      | 29/79 [00:01<00:01, 25.24it/s]
 41%|████      | 32/79 [00:02<00:01, 25.69it/s]
 44%|████▍     | 35/79 [00:02<00:01, 26.07it/s]
 48%|████▊     | 38/79 [00:02<00:01, 26.31it/s]
 52%|█████▏    | 41/79 [00:02<00:01, 26.69it/s]
 57%|█████▋    | 45/79 [00:02<00:01, 27.79it/s]
 61%|██████    | 48/79 [00:02<00:01, 27.21it/s]
 65%|██████▍   | 51/79 [00:02<00:01, 27.11it/s]
 68%|██████▊   | 54/79 [00:02<00:00, 27.09it/s]
 72%|███████▏  | 57/79 [00:02<00:00, 27.01it/s]
 77%|███████▋  | 61/79 [00:03<00:00, 28.05it/s]
 81%|████████  | 64/79 [00:03<00:00, 27.73it/s]
 85%|████████▍ | 67/79 [00:03<00:00, 27.48it/s]
 89%|████████▊ | 70/79 [00:03<00:00, 27.29it/s]
 92%|█████████▏| 73/79 [00:03<00:00, 27.18it/s]
 97%|█████████▋| 77/79 [00:03<00:00, 28.18it/s]
100%|██████████| 79/79 [00:04<00:00, 17.79it/s]
10000 images processed, 4.480875253677368 seconds used

Processing out-of-distribution LSUN images

  0%|          | 0/79 [00:00<?, ?it/s]
  1%|▏         | 1/79 [00:00<01:01,  1.26it/s]
  5%|▌         | 4/79 [00:00<00:13,  5.54it/s]
  9%|▉         | 7/79 [00:01<00:07,  9.65it/s]
 13%|█▎        | 10/79 [00:01<00:05, 13.38it/s]
 18%|█▊        | 14/79 [00:01<00:03, 17.87it/s]
 22%|██▏       | 17/79 [00:01<00:03, 20.06it/s]
 25%|██▌       | 20/79 [00:01<00:02, 21.83it/s]
 29%|██▉       | 23/79 [00:01<00:02, 23.18it/s]
 33%|███▎      | 26/79 [00:01<00:02, 24.20it/s]
 38%|███▊      | 30/79 [00:01<00:01, 26.13it/s]
 42%|████▏     | 33/79 [00:01<00:01, 26.33it/s]
 46%|████▌     | 36/79 [00:02<00:01, 26.46it/s]
 49%|████▉     | 39/79 [00:02<00:01, 26.59it/s]
 53%|█████▎    | 42/79 [00:02<00:01, 26.37it/s]
 59%|█████▉    | 47/79 [00:02<00:00, 32.50it/s]
 65%|██████▍   | 51/79 [00:02<00:00, 32.48it/s]
 70%|██████▉   | 55/79 [00:02<00:00, 29.90it/s]
 75%|███████▍  | 59/79 [00:02<00:00, 28.88it/s]
 80%|███████▉  | 63/79 [00:02<00:00, 28.97it/s]
 85%|████████▍ | 67/79 [00:03<00:00, 29.53it/s]
 89%|████████▊ | 70/79 [00:03<00:00, 29.51it/s]
 94%|█████████▎| 74/79 [00:03<00:00, 30.56it/s]
 99%|█████████▊| 78/79 [00:03<00:00, 31.79it/s]
100%|██████████| 79/79 [00:03<00:00, 22.97it/s]
10000 images processed, 3.4648683071136475 seconds used

Processing out-of-distribution iSUN images

  0%|          | 0/70 [00:00<?, ?it/s]
  1%|▏         | 1/70 [00:00<00:42,  1.62it/s]
  7%|▋         | 5/70 [00:00<00:07,  8.28it/s]
 13%|█▎        | 9/70 [00:00<00:04, 13.67it/s]
 19%|█▊        | 13/70 [00:01<00:03, 17.92it/s]
 23%|██▎       | 16/70 [00:01<00:02, 20.56it/s]
 27%|██▋       | 19/70 [00:01<00:02, 22.80it/s]
 31%|███▏      | 22/70 [00:01<00:01, 24.15it/s]
 37%|███▋      | 26/70 [00:01<00:01, 26.56it/s]
 44%|████▍     | 31/70 [00:01<00:01, 32.35it/s]
 50%|█████     | 35/70 [00:01<00:01, 33.21it/s]
 56%|█████▌    | 39/70 [00:01<00:00, 32.14it/s]
 61%|██████▏   | 43/70 [00:01<00:00, 31.09it/s]
 67%|██████▋   | 47/70 [00:02<00:00, 29.99it/s]
 73%|███████▎  | 51/70 [00:02<00:00, 29.78it/s]
 79%|███████▊  | 55/70 [00:02<00:00, 28.88it/s]
 84%|████████▍ | 59/70 [00:02<00:00, 29.00it/s]
 89%|████████▊ | 62/70 [00:02<00:00, 28.49it/s]
 94%|█████████▍| 66/70 [00:02<00:00, 28.76it/s]
 99%|█████████▊| 69/70 [00:02<00:00, 28.28it/s]
100%|██████████| 70/70 [00:02<00:00, 24.09it/s]
8925 images processed, 2.9412028789520264 seconds used

Processing out-of-distribution dtd images

  0%|          | 0/45 [00:00<?, ?it/s]
  2%|▏         | 1/45 [00:01<00:56,  1.28s/it]
  4%|▍         | 2/45 [00:01<00:26,  1.65it/s]
 11%|█         | 5/45 [00:01<00:07,  5.02it/s]
 18%|█▊        | 8/45 [00:01<00:04,  8.66it/s]
 27%|██▋       | 12/45 [00:01<00:02, 13.37it/s]
 36%|███▌      | 16/45 [00:01<00:01, 17.51it/s]
 42%|████▏     | 19/45 [00:01<00:01, 20.03it/s]
 51%|█████     | 23/45 [00:02<00:00, 23.28it/s]
 60%|██████    | 27/45 [00:02<00:00, 25.27it/s]
 69%|██████▉   | 31/45 [00:02<00:00, 26.96it/s]
 76%|███████▌  | 34/45 [00:02<00:00, 17.83it/s]
 82%|████████▏ | 37/45 [00:02<00:00, 19.79it/s]
 91%|█████████ | 41/45 [00:02<00:00, 22.36it/s]
100%|██████████| 45/45 [00:03<00:00, 24.99it/s]
100%|██████████| 45/45 [00:03<00:00, 14.67it/s]
5640 images processed, 3.096614360809326 seconds used

40.848012924194336
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.18  98.77
places365     78.81  78.26
LSUN          47.79  89.42
iSUN          53.62  87.92
dtd           39.33  90.83
AVG           44.75  89.04
[incremental] Overall: 0.5097 New: 0.4880 Old: 0.5140
[incremental] Final(Top-1): 0.5097  Average: 0.6630
17.20985174179077
[done] continual incremental run finished. Adapters at: checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmforget_only-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-110-pcon_split-stack
