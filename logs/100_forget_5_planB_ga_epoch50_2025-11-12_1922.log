nohup: ignoring input
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget5.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=0.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=False, lora_impl='native', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='head', adapter_save_path=None, adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51', forget_list_path=None, forget_classes_inc=None, forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=1.0, forget_margin=100.0, forget_strategy='ga', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
[debug] trainable_count = 112
[debug] trainable: encoder.conv1.weight
[debug] trainable: encoder.bn1.weight
[debug] trainable: encoder.bn1.bias
[debug] trainable: encoder.layer1.0.conv1.weight
[debug] trainable: encoder.layer1.0.bn1.weight
[debug] trainable: encoder.layer1.0.bn1.bias
[debug] trainable: encoder.layer1.0.conv2.weight
[debug] trainable: encoder.layer1.0.bn2.weight
[debug] trainable: encoder.layer1.0.bn2.bias
[debug] trainable: encoder.layer1.1.conv1.weight
[debug] trainable: encoder.layer1.1.bn1.weight
[debug] trainable: encoder.layer1.1.bn1.bias
[debug] trainable: encoder.layer1.1.conv2.weight
[debug] trainable: encoder.layer1.1.bn2.weight
[debug] trainable: encoder.layer1.1.bn2.bias
[debug] trainable: encoder.layer1.2.conv1.weight
[debug] trainable: encoder.layer1.2.bn1.weight
[debug] trainable: encoder.layer1.2.bn1.bias
[debug] trainable: encoder.layer1.2.conv2.weight
[debug] trainable: encoder.layer1.2.bn2.weight
[debug] trainable: encoder.layer1.2.bn2.bias
[debug] trainable: encoder.layer2.0.conv1.weight
[debug] trainable: encoder.layer2.0.bn1.weight
[debug] trainable: encoder.layer2.0.bn1.bias
[debug] trainable: encoder.layer2.0.conv2.weight
[debug] trainable: encoder.layer2.0.bn2.weight
[debug] trainable: encoder.layer2.0.bn2.bias
[debug] trainable: encoder.layer2.0.shortcut.0.weight
[debug] trainable: encoder.layer2.0.shortcut.1.weight
[debug] trainable: encoder.layer2.0.shortcut.1.bias
[debug] trainable: encoder.layer2.1.conv1.weight
[debug] trainable: encoder.layer2.1.bn1.weight
[debug] trainable: encoder.layer2.1.bn1.bias
[debug] trainable: encoder.layer2.1.conv2.weight
[debug] trainable: encoder.layer2.1.bn2.weight
[debug] trainable: encoder.layer2.1.bn2.bias
[debug] trainable: encoder.layer2.2.conv1.weight
[debug] trainable: encoder.layer2.2.bn1.weight
[debug] trainable: encoder.layer2.2.bn1.bias
[debug] trainable: encoder.layer2.2.conv2.weight
[debug] trainable: encoder.layer2.2.bn2.weight
[debug] trainable: encoder.layer2.2.bn2.bias
[debug] trainable: encoder.layer2.3.conv1.weight
[debug] trainable: encoder.layer2.3.bn1.weight
[debug] trainable: encoder.layer2.3.bn1.bias
[debug] trainable: encoder.layer2.3.conv2.weight
[debug] trainable: encoder.layer2.3.bn2.weight
[debug] trainable: encoder.layer2.3.bn2.bias
[debug] trainable: encoder.layer3.0.conv1.weight
[debug] trainable: encoder.layer3.0.bn1.weight
[debug][warn] non-LoRA trainables detected: ['encoder.conv1.weight', 'encoder.bn1.weight', 'encoder.bn1.bias', 'encoder.layer1.0.conv1.weight', 'encoder.layer1.0.bn1.weight', 'encoder.layer1.0.bn1.bias', 'encoder.layer1.0.conv2.weight', 'encoder.layer1.0.bn2.weight', 'encoder.layer1.0.bn2.bias', 'encoder.layer1.1.conv1.weight']
[trainable] param_count=21605312 tensors=112
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:550: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=bool(scaler is not None)):
/home/shaokun/PALM/trainer.py:638: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/torch/csrc/autograd/generated/python_variable_methods.cpp:835.)
  print(f"[loss-{args.forget_strategy}] ep {epoch} it {it} total={loss.item():.4f} ce_r={float(loss_retain):.4f} ce_f={float(loss_forget):.4f}")
  2%|▏         | 1/50 [00:27<22:17, 27.29s/it]  4%|▍         | 2/50 [00:42<16:19, 20.40s/it]  6%|▌         | 3/50 [00:58<14:24, 18.39s/it]  8%|▊         | 4/50 [01:14<13:06, 17.11s/it] 10%|█         | 5/50 [01:29<12:15, 16.35s/it] 12%|█▏        | 6/50 [01:44<11:43, 15.98s/it] 14%|█▍        | 7/50 [01:59<11:16, 15.72s/it] 16%|█▌        | 8/50 [02:14<10:51, 15.51s/it] 18%|█▊        | 9/50 [02:29<10:29, 15.34s/it] 20%|██        | 10/50 [02:45<10:16, 15.42s/it] 22%|██▏       | 11/50 [02:59<09:53, 15.22s/it] 24%|██▍       | 12/50 [03:15<09:42, 15.33s/it] 26%|██▌       | 13/50 [03:30<09:25, 15.30s/it] 28%|██▊       | 14/50 [03:45<09:10, 15.28s/it] 30%|███       | 15/50 [04:01<08:55, 15.29s/it] 32%|███▏      | 16/50 [04:15<08:32, 15.08s/it] 34%|███▍      | 17/50 [04:30<08:18, 15.11s/it][loss-ga] ep 0 it 0 total=-0.0751 ce_r=0.0867 ce_f=0.1618
[loss-ga] ep 0 it 50 total=-0.0977 ce_r=0.1108 ce_f=0.2085
[loss-ga] ep 0 it 100 total=-0.3159 ce_r=0.3272 ce_f=0.6431
[loss-ga] ep 0 it 150 total=-0.5316 ce_r=0.5596 ce_f=1.0913
[loss-ga] ep 0 it 200 total=-1.9968 ce_r=2.0624 ce_f=4.0592
[loss-ga] ep 0 it 250 total=-3.9877 ce_r=4.0338 ce_f=8.0215
[loss-ga] ep 0 it 300 total=-5.5631 ce_r=5.7241 ce_f=11.2872
[loss-ga] ep 0 it 350 total=-6.2653 ce_r=6.4686 ce_f=12.7339
[loss-ga] ep 1 it 10 total=-6.5917 ce_r=6.8875 ce_f=13.4792
[loss-ga] ep 1 it 60 total=-6.9887 ce_r=7.2842 ce_f=14.2729
[loss-ga] ep 1 it 110 total=-6.9422 ce_r=7.0167 ce_f=13.9589
[loss-ga] ep 1 it 160 total=-7.4611 ce_r=7.5343 ce_f=14.9954
[loss-ga] ep 1 it 210 total=-7.5643 ce_r=7.5994 ce_f=15.1637
[loss-ga] ep 1 it 260 total=-7.4544 ce_r=7.6515 ce_f=15.1060
[loss-ga] ep 1 it 310 total=-7.6775 ce_r=7.8189 ce_f=15.4964
[loss-ga] ep 1 it 360 total=-7.9554 ce_r=8.1195 ce_f=16.0749
[loss-ga] ep 2 it 20 total=-7.7240 ce_r=7.8986 ce_f=15.6226
[loss-ga] ep 2 it 70 total=-7.6257 ce_r=7.9877 ce_f=15.6134
[loss-ga] ep 2 it 120 total=-7.9836 ce_r=8.0031 ce_f=15.9866
[loss-ga] ep 2 it 170 total=-8.2757 ce_r=8.4060 ce_f=16.6817
[loss-ga] ep 2 it 220 total=-8.0720 ce_r=8.1516 ce_f=16.2236
[loss-ga] ep 2 it 270 total=-7.9736 ce_r=8.2562 ce_f=16.2298
[loss-ga] ep 2 it 320 total=-7.9868 ce_r=8.2771 ce_f=16.2638
[loss-ga] ep 2 it 370 total=-8.0532 ce_r=8.2054 ce_f=16.2587
[loss-ga] ep 3 it 30 total=-8.1297 ce_r=8.1673 ce_f=16.2970
[loss-ga] ep 3 it 80 total=-7.9724 ce_r=8.1375 ce_f=16.1099
[loss-ga] ep 3 it 130 total=-7.9629 ce_r=8.1029 ce_f=16.0658
[loss-ga] ep 3 it 180 total=-7.9877 ce_r=8.1539 ce_f=16.1416
[loss-ga] ep 3 it 230 total=-8.1893 ce_r=8.3972 ce_f=16.5865
[loss-ga] ep 3 it 280 total=-8.1978 ce_r=8.2556 ce_f=16.4534
[loss-ga] ep 3 it 330 total=-8.1039 ce_r=8.1587 ce_f=16.2625
[loss-ga] ep 3 it 380 total=-8.0914 ce_r=8.2106 ce_f=16.3020
[loss-ga] ep 4 it 40 total=-8.1710 ce_r=8.3229 ce_f=16.4939
[loss-ga] ep 4 it 90 total=-8.2210 ce_r=8.3679 ce_f=16.5889
[loss-ga] ep 4 it 140 total=-8.0779 ce_r=8.3533 ce_f=16.4312
[loss-ga] ep 4 it 190 total=-8.3491 ce_r=8.4421 ce_f=16.7912
[loss-ga] ep 4 it 240 total=-8.2173 ce_r=8.3764 ce_f=16.5937
[loss-ga] ep 4 it 290 total=-8.2929 ce_r=8.4773 ce_f=16.7702
[loss-ga] ep 4 it 340 total=-8.2113 ce_r=8.2427 ce_f=16.4540
[loss-ga] ep 5 it 0 total=-8.2462 ce_r=8.3500 ce_f=16.5962
[loss-ga] ep 5 it 50 total=-8.1711 ce_r=8.3707 ce_f=16.5418
[loss-ga] ep 5 it 100 total=-8.2347 ce_r=8.4123 ce_f=16.6471
[loss-ga] ep 5 it 150 total=-7.9519 ce_r=8.3253 ce_f=16.2772
[loss-ga] ep 5 it 200 total=-7.9508 ce_r=8.2310 ce_f=16.1819
[loss-ga] ep 5 it 250 total=-7.8000 ce_r=8.0856 ce_f=15.8856
[loss-ga] ep 5 it 300 total=-8.3354 ce_r=8.5168 ce_f=16.8522
[loss-ga] ep 5 it 350 total=-8.2394 ce_r=8.3625 ce_f=16.6018
[loss-ga] ep 6 it 10 total=-8.3422 ce_r=8.4793 ce_f=16.8215
[loss-ga] ep 6 it 60 total=-8.3111 ce_r=8.3835 ce_f=16.6947
[loss-ga] ep 6 it 110 total=-8.2982 ce_r=8.4137 ce_f=16.7119
[loss-ga] ep 6 it 160 total=-8.2344 ce_r=8.2905 ce_f=16.5249
[loss-ga] ep 6 it 210 total=-8.2263 ce_r=8.3099 ce_f=16.5363
[loss-ga] ep 6 it 260 total=-8.2962 ce_r=8.3522 ce_f=16.6484
[loss-ga] ep 6 it 310 total=-8.4544 ce_r=8.5124 ce_f=16.9668
[loss-ga] ep 6 it 360 total=-8.4502 ce_r=8.4642 ce_f=16.9144
[loss-ga] ep 7 it 20 total=-8.2554 ce_r=8.2756 ce_f=16.5310
[loss-ga] ep 7 it 70 total=-8.2110 ce_r=8.3060 ce_f=16.5170
[loss-ga] ep 7 it 120 total=-8.3025 ce_r=8.3926 ce_f=16.6951
[loss-ga] ep 7 it 170 total=-8.0708 ce_r=8.3049 ce_f=16.3757
[loss-ga] ep 7 it 220 total=-8.3407 ce_r=8.3481 ce_f=16.6889
[loss-ga] ep 7 it 270 total=-8.2864 ce_r=8.3031 ce_f=16.5895
[loss-ga] ep 7 it 320 total=-8.2014 ce_r=8.4867 ce_f=16.6881
[loss-ga] ep 7 it 370 total=-8.3651 ce_r=8.4322 ce_f=16.7974
[loss-ga] ep 8 it 30 total=-8.2809 ce_r=8.3615 ce_f=16.6425
[loss-ga] ep 8 it 80 total=-8.2153 ce_r=8.3887 ce_f=16.6041
[loss-ga] ep 8 it 130 total=-8.2688 ce_r=8.2880 ce_f=16.5568
[loss-ga] ep 8 it 180 total=-8.4093 ce_r=8.5177 ce_f=16.9271
[loss-ga] ep 8 it 230 total=-8.4373 ce_r=8.4671 ce_f=16.9044
[loss-ga] ep 8 it 280 total=-8.4185 ce_r=8.4295 ce_f=16.8480
[loss-ga] ep 8 it 330 total=-8.4515 ce_r=8.5680 ce_f=17.0195
[loss-ga] ep 8 it 380 total=-8.2712 ce_r=8.3709 ce_f=16.6421
[loss-ga] ep 9 it 40 total=-8.3314 ce_r=8.4799 ce_f=16.8114
[loss-ga] ep 9 it 90 total=-8.1757 ce_r=8.3443 ce_f=16.5200
[loss-ga] ep 9 it 140 total=-8.3774 ce_r=8.4170 ce_f=16.7944
[loss-ga] ep 9 it 190 total=-8.5708 ce_r=8.5905 ce_f=17.1613
[loss-ga] ep 9 it 240 total=-8.3316 ce_r=8.4520 ce_f=16.7836
[loss-ga] ep 9 it 290 total=-8.3479 ce_r=8.3923 ce_f=16.7403
[loss-ga] ep 9 it 340 total=-8.1203 ce_r=8.2695 ce_f=16.3897
[loss-ga] ep 10 it 0 total=-8.5279 ce_r=8.5638 ce_f=17.0917
[loss-ga] ep 10 it 50 total=-8.2857 ce_r=8.4137 ce_f=16.6994
[loss-ga] ep 10 it 100 total=-8.3216 ce_r=8.3832 ce_f=16.7048
[loss-ga] ep 10 it 150 total=-8.2686 ce_r=8.2833 ce_f=16.5519
[loss-ga] ep 10 it 200 total=-8.4168 ce_r=8.4674 ce_f=16.8842
[loss-ga] ep 10 it 250 total=-8.4630 ce_r=8.4950 ce_f=16.9580
[loss-ga] ep 10 it 300 total=-8.2584 ce_r=8.3637 ce_f=16.6222
[loss-ga] ep 10 it 350 total=-8.5365 ce_r=8.5569 ce_f=17.0934
[loss-ga] ep 11 it 10 total=-8.2890 ce_r=8.3537 ce_f=16.6427
[loss-ga] ep 11 it 60 total=-8.2890 ce_r=8.3004 ce_f=16.5894
[loss-ga] ep 11 it 110 total=-8.3474 ce_r=8.4632 ce_f=16.8106
[loss-ga] ep 11 it 160 total=-8.4879 ce_r=8.5085 ce_f=16.9964
[loss-ga] ep 11 it 210 total=-8.3415 ce_r=8.3947 ce_f=16.7362
[loss-ga] ep 11 it 260 total=-8.4055 ce_r=8.5130 ce_f=16.9185
[loss-ga] ep 11 it 310 total=-8.2420 ce_r=8.2911 ce_f=16.5331
[loss-ga] ep 11 it 360 total=-8.3907 ce_r=8.4609 ce_f=16.8515
[loss-ga] ep 12 it 20 total=-8.3722 ce_r=8.4328 ce_f=16.8050
[loss-ga] ep 12 it 70 total=-8.2868 ce_r=8.3632 ce_f=16.6500
[loss-ga] ep 12 it 120 total=-8.4303 ce_r=8.5332 ce_f=16.9635
[loss-ga] ep 12 it 170 total=-8.4688 ce_r=8.5261 ce_f=16.9948
[loss-ga] ep 12 it 220 total=-8.1425 ce_r=8.3287 ce_f=16.4712
[loss-ga] ep 12 it 270 total=-8.3217 ce_r=8.3481 ce_f=16.6699
[loss-ga] ep 12 it 320 total=-8.4747 ce_r=8.6218 ce_f=17.0965
[loss-ga] ep 12 it 370 total=-8.2548 ce_r=8.3693 ce_f=16.6241
[loss-ga] ep 13 it 30 total=-8.3790 ce_r=8.5183 ce_f=16.8973
[loss-ga] ep 13 it 80 total=-8.3330 ce_r=8.4036 ce_f=16.7366
[loss-ga] ep 13 it 130 total=-8.4270 ce_r=8.4798 ce_f=16.9068
[loss-ga] ep 13 it 180 total=-8.5183 ce_r=8.5457 ce_f=17.0640
[loss-ga] ep 13 it 230 total=-8.3990 ce_r=8.4210 ce_f=16.8200
[loss-ga] ep 13 it 280 total=-8.4201 ce_r=8.5117 ce_f=16.9318
[loss-ga] ep 13 it 330 total=-8.1251 ce_r=8.2689 ce_f=16.3940
[loss-ga] ep 13 it 380 total=-8.0444 ce_r=8.1697 ce_f=16.2141
[loss-ga] ep 14 it 40 total=-8.3604 ce_r=8.4075 ce_f=16.7679
[loss-ga] ep 14 it 90 total=-8.2512 ce_r=8.3538 ce_f=16.6050
[loss-ga] ep 14 it 140 total=-8.4078 ce_r=8.4514 ce_f=16.8592
[loss-ga] ep 14 it 190 total=-8.4019 ce_r=8.4422 ce_f=16.8441
[loss-ga] ep 14 it 240 total=-8.2490 ce_r=8.3148 ce_f=16.5638
[loss-ga] ep 14 it 290 total=-8.3086 ce_r=8.3672 ce_f=16.6757
[loss-ga] ep 14 it 340 total=-8.5948 ce_r=8.7332 ce_f=17.3280
[loss-ga] ep 15 it 0 total=-8.2223 ce_r=8.4094 ce_f=16.6317
[loss-ga] ep 15 it 50 total=-8.5101 ce_r=8.5278 ce_f=17.0378
[loss-ga] ep 15 it 100 total=-8.2599 ce_r=8.2831 ce_f=16.5430
[loss-ga] ep 15 it 150 total=-8.4152 ce_r=8.4900 ce_f=16.9052
[loss-ga] ep 15 it 200 total=-8.3807 ce_r=8.4278 ce_f=16.8086
[loss-ga] ep 15 it 250 total=-8.4723 ce_r=8.5988 ce_f=17.0711
[loss-ga] ep 15 it 300 total=-8.4699 ce_r=8.5588 ce_f=17.0287
[loss-ga] ep 15 it 350 total=-8.3140 ce_r=8.3345 ce_f=16.6485
[loss-ga] ep 16 it 10 total=-8.5120 ce_r=8.5690 ce_f=17.0810
[loss-ga] ep 16 it 60 total=-8.1745 ce_r=8.4011 ce_f=16.5756
[loss-ga] ep 16 it 110 total=-8.3563 ce_r=8.4975 ce_f=16.8537
[loss-ga] ep 16 it 160 total=-8.2452 ce_r=8.3179 ce_f=16.5631
[loss-ga] ep 16 it 210 total=-8.4496 ce_r=8.5682 ce_f=17.0178
[loss-ga] ep 16 it 260 total=-8.4721 ce_r=8.5137 ce_f=16.9858
[loss-ga] ep 16 it 310 total=-8.4933 ce_r=8.5434 ce_f=17.0367
[loss-ga] ep 16 it 360 total=-8.2107 ce_r=8.2519 ce_f=16.4626
[loss-ga] ep 17 it 20 total=-8.2542 ce_r=8.4045 ce_f=16.6587
 36%|███▌      | 18/50 [04:45<07:59, 14.97s/it] 38%|███▊      | 19/50 [05:00<07:44, 14.98s/it] 40%|████      | 20/50 [05:15<07:26, 14.88s/it] 42%|████▏     | 21/50 [05:29<07:09, 14.81s/it] 44%|████▍     | 22/50 [05:44<06:55, 14.83s/it] 46%|████▌     | 23/50 [05:59<06:41, 14.89s/it] 48%|████▊     | 24/50 [06:14<06:29, 14.97s/it] 50%|█████     | 25/50 [06:30<06:16, 15.05s/it] 52%|█████▏    | 26/50 [06:44<05:59, 14.96s/it] 54%|█████▍    | 27/50 [06:59<05:44, 14.98s/it] 56%|█████▌    | 28/50 [07:14<05:27, 14.89s/it] 58%|█████▊    | 29/50 [07:29<05:13, 14.91s/it] 60%|██████    | 30/50 [07:44<04:56, 14.84s/it] 62%|██████▏   | 31/50 [07:59<04:43, 14.91s/it] 64%|██████▍   | 32/50 [08:14<04:29, 15.00s/it] 66%|██████▌   | 33/50 [08:29<04:15, 15.06s/it] 68%|██████▊   | 34/50 [08:44<03:59, 14.98s/it][loss-ga] ep 17 it 70 total=-8.2870 ce_r=8.3235 ce_f=16.6105
[loss-ga] ep 17 it 120 total=-8.1959 ce_r=8.3085 ce_f=16.5044
[loss-ga] ep 17 it 170 total=-8.1227 ce_r=8.2962 ce_f=16.4189
[loss-ga] ep 17 it 220 total=-8.2340 ce_r=8.3266 ce_f=16.5606
[loss-ga] ep 17 it 270 total=-8.2953 ce_r=8.3606 ce_f=16.6560
[loss-ga] ep 17 it 320 total=-8.4575 ce_r=8.5415 ce_f=16.9990
[loss-ga] ep 17 it 370 total=-8.4587 ce_r=8.4835 ce_f=16.9422
[loss-ga] ep 18 it 30 total=-8.3598 ce_r=8.4438 ce_f=16.8036
[loss-ga] ep 18 it 80 total=-8.2980 ce_r=8.3126 ce_f=16.6105
[loss-ga] ep 18 it 130 total=-8.3574 ce_r=8.3728 ce_f=16.7302
[loss-ga] ep 18 it 180 total=-8.4164 ce_r=8.4291 ce_f=16.8455
[loss-ga] ep 18 it 230 total=-8.3711 ce_r=8.4089 ce_f=16.7799
[loss-ga] ep 18 it 280 total=-8.3253 ce_r=8.4629 ce_f=16.7882
[loss-ga] ep 18 it 330 total=-8.3545 ce_r=8.4934 ce_f=16.8479
[loss-ga] ep 18 it 380 total=-8.3091 ce_r=8.3951 ce_f=16.7042
[loss-ga] ep 19 it 40 total=-8.5054 ce_r=8.5267 ce_f=17.0321
[loss-ga] ep 19 it 90 total=-8.2718 ce_r=8.2966 ce_f=16.5685
[loss-ga] ep 19 it 140 total=-8.3109 ce_r=8.3388 ce_f=16.6497
[loss-ga] ep 19 it 190 total=-8.2152 ce_r=8.4446 ce_f=16.6597
[loss-ga] ep 19 it 240 total=-8.2585 ce_r=8.3961 ce_f=16.6546
[loss-ga] ep 19 it 290 total=-8.5425 ce_r=8.5742 ce_f=17.1167
[loss-ga] ep 19 it 340 total=-8.2866 ce_r=8.3950 ce_f=16.6815
[loss-ga] ep 20 it 0 total=-8.4373 ce_r=8.4630 ce_f=16.9003
[loss-ga] ep 20 it 50 total=-8.3793 ce_r=8.4528 ce_f=16.8321
[loss-ga] ep 20 it 100 total=-8.3971 ce_r=8.4733 ce_f=16.8704
[loss-ga] ep 20 it 150 total=-8.3839 ce_r=8.4102 ce_f=16.7942
[loss-ga] ep 20 it 200 total=-8.3988 ce_r=8.4358 ce_f=16.8346
[loss-ga] ep 20 it 250 total=-8.4120 ce_r=8.4292 ce_f=16.8412
[loss-ga] ep 20 it 300 total=-8.1863 ce_r=8.2892 ce_f=16.4755
[loss-ga] ep 20 it 350 total=-8.4310 ce_r=8.5477 ce_f=16.9787
[loss-ga] ep 21 it 10 total=-8.4506 ce_r=8.4759 ce_f=16.9265
[loss-ga] ep 21 it 60 total=-8.5225 ce_r=8.5437 ce_f=17.0662
[loss-ga] ep 21 it 110 total=-8.4021 ce_r=8.4439 ce_f=16.8459
[loss-ga] ep 21 it 160 total=-8.3560 ce_r=8.4024 ce_f=16.7584
[loss-ga] ep 21 it 210 total=-8.5847 ce_r=8.6173 ce_f=17.2020
[loss-ga] ep 21 it 260 total=-8.3639 ce_r=8.4812 ce_f=16.8451
[loss-ga] ep 21 it 310 total=-8.1552 ce_r=8.3117 ce_f=16.4670
[loss-ga] ep 21 it 360 total=-8.4208 ce_r=8.5428 ce_f=16.9636
[loss-ga] ep 22 it 20 total=-8.5203 ce_r=8.5830 ce_f=17.1032
[loss-ga] ep 22 it 70 total=-8.2617 ce_r=8.2772 ce_f=16.5389
[loss-ga] ep 22 it 120 total=-8.2808 ce_r=8.3156 ce_f=16.5964
[loss-ga] ep 22 it 170 total=-8.4452 ce_r=8.4697 ce_f=16.9150
[loss-ga] ep 22 it 220 total=-8.2438 ce_r=8.5458 ce_f=16.7895
[loss-ga] ep 22 it 270 total=-8.4003 ce_r=8.5540 ce_f=16.9543
[loss-ga] ep 22 it 320 total=-8.0742 ce_r=8.1055 ce_f=16.1796
[loss-ga] ep 22 it 370 total=-8.2982 ce_r=8.4100 ce_f=16.7082
[loss-ga] ep 23 it 30 total=-8.3861 ce_r=8.4517 ce_f=16.8378
[loss-ga] ep 23 it 80 total=-8.3880 ce_r=8.4483 ce_f=16.8363
[loss-ga] ep 23 it 130 total=-8.4361 ce_r=8.4631 ce_f=16.8992
[loss-ga] ep 23 it 180 total=-8.4446 ce_r=8.4771 ce_f=16.9218
[loss-ga] ep 23 it 230 total=-8.3341 ce_r=8.4475 ce_f=16.7816
[loss-ga] ep 23 it 280 total=-8.1437 ce_r=8.2242 ce_f=16.3679
[loss-ga] ep 23 it 330 total=-8.4221 ce_r=8.4718 ce_f=16.8939
[loss-ga] ep 23 it 380 total=-8.3667 ce_r=8.4534 ce_f=16.8201
[loss-ga] ep 24 it 40 total=-8.3525 ce_r=8.3848 ce_f=16.7373
[loss-ga] ep 24 it 90 total=-8.5538 ce_r=8.5910 ce_f=17.1447
[loss-ga] ep 24 it 140 total=-8.3788 ce_r=8.3996 ce_f=16.7784
[loss-ga] ep 24 it 190 total=-8.3951 ce_r=8.4358 ce_f=16.8308
[loss-ga] ep 24 it 240 total=-8.4853 ce_r=8.5011 ce_f=16.9864
[loss-ga] ep 24 it 290 total=-8.5676 ce_r=8.5811 ce_f=17.1487
[loss-ga] ep 24 it 340 total=-8.4069 ce_r=8.4225 ce_f=16.8294
[loss-ga] ep 25 it 0 total=-8.2397 ce_r=8.2774 ce_f=16.5171
[loss-ga] ep 25 it 50 total=-8.2715 ce_r=8.4009 ce_f=16.6724
[loss-ga] ep 25 it 100 total=-8.2372 ce_r=8.3650 ce_f=16.6022
[loss-ga] ep 25 it 150 total=-8.4088 ce_r=8.4967 ce_f=16.9055
[loss-ga] ep 25 it 200 total=-8.4593 ce_r=8.4799 ce_f=16.9392
[loss-ga] ep 25 it 250 total=-8.4840 ce_r=8.4965 ce_f=16.9805
[loss-ga] ep 25 it 300 total=-8.3474 ce_r=8.5023 ce_f=16.8498
[loss-ga] ep 25 it 350 total=-8.1386 ce_r=8.1709 ce_f=16.3095
[loss-ga] ep 26 it 10 total=-8.4799 ce_r=8.5502 ce_f=17.0301
[loss-ga] ep 26 it 60 total=-8.2037 ce_r=8.4077 ce_f=16.6114
[loss-ga] ep 26 it 110 total=-8.3300 ce_r=8.4055 ce_f=16.7355
[loss-ga] ep 26 it 160 total=-8.5000 ce_r=8.5380 ce_f=17.0380
[loss-ga] ep 26 it 210 total=-8.4738 ce_r=8.5190 ce_f=16.9929
[loss-ga] ep 26 it 260 total=-8.4338 ce_r=8.5110 ce_f=16.9448
[loss-ga] ep 26 it 310 total=-8.4309 ce_r=8.4756 ce_f=16.9065
[loss-ga] ep 26 it 360 total=-8.2304 ce_r=8.2673 ce_f=16.4977
[loss-ga] ep 27 it 20 total=-8.2603 ce_r=8.3921 ce_f=16.6525
[loss-ga] ep 27 it 70 total=-8.5458 ce_r=8.5579 ce_f=17.1037
[loss-ga] ep 27 it 120 total=-8.5000 ce_r=8.5992 ce_f=17.0993
[loss-ga] ep 27 it 170 total=-8.4952 ce_r=8.5201 ce_f=17.0153
[loss-ga] ep 27 it 220 total=-8.5263 ce_r=8.6396 ce_f=17.1659
[loss-ga] ep 27 it 270 total=-8.3773 ce_r=8.4183 ce_f=16.7956
[loss-ga] ep 27 it 320 total=-8.2948 ce_r=8.3121 ce_f=16.6070
[loss-ga] ep 27 it 370 total=-8.4261 ce_r=8.4762 ce_f=16.9023
[loss-ga] ep 28 it 30 total=-8.3775 ce_r=8.4087 ce_f=16.7862
[loss-ga] ep 28 it 80 total=-8.3750 ce_r=8.4036 ce_f=16.7786
[loss-ga] ep 28 it 130 total=-8.2642 ce_r=8.3621 ce_f=16.6263
[loss-ga] ep 28 it 180 total=-8.3447 ce_r=8.5082 ce_f=16.8529
[loss-ga] ep 28 it 230 total=-8.2608 ce_r=8.3046 ce_f=16.5654
[loss-ga] ep 28 it 280 total=-8.4217 ce_r=8.4608 ce_f=16.8825
[loss-ga] ep 28 it 330 total=-8.3852 ce_r=8.4360 ce_f=16.8213
[loss-ga] ep 28 it 380 total=-8.2785 ce_r=8.3094 ce_f=16.5879
[loss-ga] ep 29 it 40 total=-8.2354 ce_r=8.3358 ce_f=16.5711
[loss-ga] ep 29 it 90 total=-8.3714 ce_r=8.4002 ce_f=16.7717
[loss-ga] ep 29 it 140 total=-8.4118 ce_r=8.4403 ce_f=16.8521
[loss-ga] ep 29 it 190 total=-8.4542 ce_r=8.4884 ce_f=16.9425
[loss-ga] ep 29 it 240 total=-8.5220 ce_r=8.5376 ce_f=17.0596
[loss-ga] ep 29 it 290 total=-8.3778 ce_r=8.4204 ce_f=16.7983
[loss-ga] ep 29 it 340 total=-8.5495 ce_r=8.5757 ce_f=17.1252
[loss-ga] ep 30 it 0 total=-8.6083 ce_r=8.7199 ce_f=17.3282
[loss-ga] ep 30 it 50 total=-8.3718 ce_r=8.4983 ce_f=16.8701
[loss-ga] ep 30 it 100 total=-8.3301 ce_r=8.4506 ce_f=16.7807
[loss-ga] ep 30 it 150 total=-8.5052 ce_r=8.5383 ce_f=17.0435
[loss-ga] ep 30 it 200 total=-8.6086 ce_r=8.6223 ce_f=17.2308
[loss-ga] ep 30 it 250 total=-8.3914 ce_r=8.4304 ce_f=16.8218
[loss-ga] ep 30 it 300 total=-8.2187 ce_r=8.3928 ce_f=16.6115
[loss-ga] ep 30 it 350 total=-8.4544 ce_r=8.6688 ce_f=17.1232
[loss-ga] ep 31 it 10 total=-8.2404 ce_r=8.2933 ce_f=16.5337
[loss-ga] ep 31 it 60 total=-8.3949 ce_r=8.4492 ce_f=16.8441
[loss-ga] ep 31 it 110 total=-8.4083 ce_r=8.5092 ce_f=16.9175
[loss-ga] ep 31 it 160 total=-8.4560 ce_r=8.4806 ce_f=16.9366
[loss-ga] ep 31 it 210 total=-8.5344 ce_r=8.5502 ce_f=17.0846
[loss-ga] ep 31 it 260 total=-8.5928 ce_r=8.6128 ce_f=17.2056
[loss-ga] ep 31 it 310 total=-8.3669 ce_r=8.5829 ce_f=16.9498
[loss-ga] ep 31 it 360 total=-8.4242 ce_r=8.4815 ce_f=16.9057
[loss-ga] ep 32 it 20 total=-8.3397 ce_r=8.3647 ce_f=16.7044
[loss-ga] ep 32 it 70 total=-8.3891 ce_r=8.5071 ce_f=16.8962
[loss-ga] ep 32 it 120 total=-8.1852 ce_r=8.4295 ce_f=16.6147
[loss-ga] ep 32 it 170 total=-8.1995 ce_r=8.4249 ce_f=16.6244
[loss-ga] ep 32 it 220 total=-8.3963 ce_r=8.4196 ce_f=16.8158
[loss-ga] ep 32 it 270 total=-8.6498 ce_r=8.6930 ce_f=17.3427
[loss-ga] ep 32 it 320 total=-8.4591 ce_r=8.6414 ce_f=17.1006
[loss-ga] ep 32 it 370 total=-8.4090 ce_r=8.5519 ce_f=16.9609
[loss-ga] ep 33 it 30 total=-8.4097 ce_r=8.4375 ce_f=16.8472
[loss-ga] ep 33 it 80 total=-8.2491 ce_r=8.3706 ce_f=16.6197
[loss-ga] ep 33 it 130 total=-8.4753 ce_r=8.5016 ce_f=16.9769
[loss-ga] ep 33 it 180 total=-8.4323 ce_r=8.4484 ce_f=16.8807
[loss-ga] ep 33 it 230 total=-8.3174 ce_r=8.3687 ce_f=16.6861
[loss-ga] ep 33 it 280 total=-8.4233 ce_r=8.4459 ce_f=16.8691
[loss-ga] ep 33 it 330 total=-8.3695 ce_r=8.4963 ce_f=16.8657
[loss-ga] ep 33 it 380 total=-8.2669 ce_r=8.3782 ce_f=16.6452
 70%|███████   | 35/50 [08:59<03:45, 15.02s/it] 72%|███████▏  | 36/50 [09:14<03:28, 14.92s/it] 74%|███████▍  | 37/50 [09:29<03:14, 14.94s/it] 76%|███████▌  | 38/50 [09:44<02:58, 14.86s/it] 78%|███████▊  | 39/50 [09:58<02:42, 14.75s/it] 80%|████████  | 40/50 [10:13<02:27, 14.72s/it] 82%|████████▏ | 41/50 [10:27<02:12, 14.74s/it] 84%|████████▍ | 42/50 [10:42<01:57, 14.73s/it] 86%|████████▌ | 43/50 [10:57<01:43, 14.84s/it] 88%|████████▊ | 44/50 [11:12<01:29, 14.86s/it] 90%|█████████ | 45/50 [11:27<01:14, 14.81s/it] 92%|█████████▏| 46/50 [11:41<00:59, 14.75s/it] 94%|█████████▍| 47/50 [11:56<00:44, 14.74s/it] 96%|█████████▌| 48/50 [12:11<00:29, 14.90s/it] 98%|█████████▊| 49/50 [12:26<00:14, 14.90s/it]100%|██████████| 50/50 [12:41<00:00, 14.81s/it]100%|██████████| 50/50 [12:41<00:00, 15.23s/it]
[loss-ga] ep 34 it 40 total=-8.1805 ce_r=8.1995 ce_f=16.3800
[loss-ga] ep 34 it 90 total=-8.4952 ce_r=8.5189 ce_f=17.0141
[loss-ga] ep 34 it 140 total=-8.3689 ce_r=8.5499 ce_f=16.9188
[loss-ga] ep 34 it 190 total=-8.4421 ce_r=8.4786 ce_f=16.9207
[loss-ga] ep 34 it 240 total=-8.5165 ce_r=8.5504 ce_f=17.0669
[loss-ga] ep 34 it 290 total=-8.3566 ce_r=8.3733 ce_f=16.7300
[loss-ga] ep 34 it 340 total=-8.2714 ce_r=8.4786 ce_f=16.7500
[loss-ga] ep 35 it 0 total=-8.3648 ce_r=8.5453 ce_f=16.9101
[loss-ga] ep 35 it 50 total=-8.2506 ce_r=8.2819 ce_f=16.5325
[loss-ga] ep 35 it 100 total=-8.3776 ce_r=8.4079 ce_f=16.7855
[loss-ga] ep 35 it 150 total=-8.3942 ce_r=8.6459 ce_f=17.0401
[loss-ga] ep 35 it 200 total=-8.4800 ce_r=8.4904 ce_f=16.9704
[loss-ga] ep 35 it 250 total=-8.4094 ce_r=8.4698 ce_f=16.8792
[loss-ga] ep 35 it 300 total=-8.3796 ce_r=8.4132 ce_f=16.7928
[loss-ga] ep 35 it 350 total=-8.5322 ce_r=8.5745 ce_f=17.1066
[loss-ga] ep 36 it 10 total=-8.2879 ce_r=8.4272 ce_f=16.7151
[loss-ga] ep 36 it 60 total=-8.4143 ce_r=8.4774 ce_f=16.8917
[loss-ga] ep 36 it 110 total=-8.1974 ce_r=8.3818 ce_f=16.5791
[loss-ga] ep 36 it 160 total=-8.4290 ce_r=8.4810 ce_f=16.9101
[loss-ga] ep 36 it 210 total=-8.3647 ce_r=8.4692 ce_f=16.8339
[loss-ga] ep 36 it 260 total=-8.5066 ce_r=8.5683 ce_f=17.0749
[loss-ga] ep 36 it 310 total=-8.4650 ce_r=8.5230 ce_f=16.9880
[loss-ga] ep 36 it 360 total=-8.3597 ce_r=8.3848 ce_f=16.7445
[loss-ga] ep 37 it 20 total=-8.5363 ce_r=8.5691 ce_f=17.1053
[loss-ga] ep 37 it 70 total=-8.4619 ce_r=8.4989 ce_f=16.9608
[loss-ga] ep 37 it 120 total=-8.3771 ce_r=8.4105 ce_f=16.7875
[loss-ga] ep 37 it 170 total=-8.4327 ce_r=8.4426 ce_f=16.8753
[loss-ga] ep 37 it 220 total=-8.4042 ce_r=8.4087 ce_f=16.8129
[loss-ga] ep 37 it 270 total=-8.1989 ce_r=8.2261 ce_f=16.4250
[loss-ga] ep 37 it 320 total=-8.2204 ce_r=8.2361 ce_f=16.4564
[loss-ga] ep 37 it 370 total=-8.5147 ce_r=8.5973 ce_f=17.1119
[loss-ga] ep 38 it 30 total=-8.2943 ce_r=8.3229 ce_f=16.6172
[loss-ga] ep 38 it 80 total=-8.3732 ce_r=8.3970 ce_f=16.7701
[loss-ga] ep 38 it 130 total=-8.4044 ce_r=8.4634 ce_f=16.8678
[loss-ga] ep 38 it 180 total=-8.3825 ce_r=8.5520 ce_f=16.9346
[loss-ga] ep 38 it 230 total=-8.3772 ce_r=8.3835 ce_f=16.7607
[loss-ga] ep 38 it 280 total=-8.4736 ce_r=8.5745 ce_f=17.0481
[loss-ga] ep 38 it 330 total=-8.4493 ce_r=8.4589 ce_f=16.9081
[loss-ga] ep 38 it 380 total=-8.3610 ce_r=8.3976 ce_f=16.7586
[loss-ga] ep 39 it 40 total=-8.3114 ce_r=8.3586 ce_f=16.6700
[loss-ga] ep 39 it 90 total=-8.2153 ce_r=8.2543 ce_f=16.4696
[loss-ga] ep 39 it 140 total=-8.6290 ce_r=8.6736 ce_f=17.3026
[loss-ga] ep 39 it 190 total=-8.4418 ce_r=8.5699 ce_f=17.0117
[loss-ga] ep 39 it 240 total=-8.2242 ce_r=8.2875 ce_f=16.5117
[loss-ga] ep 39 it 290 total=-8.5141 ce_r=8.5861 ce_f=17.1001
[loss-ga] ep 39 it 340 total=-8.4169 ce_r=8.5166 ce_f=16.9335
[loss-ga] ep 40 it 0 total=-8.2241 ce_r=8.2670 ce_f=16.4911
[loss-ga] ep 40 it 50 total=-8.3449 ce_r=8.3635 ce_f=16.7084
[loss-ga] ep 40 it 100 total=-8.5279 ce_r=8.5604 ce_f=17.0883
[loss-ga] ep 40 it 150 total=-8.6120 ce_r=8.6374 ce_f=17.2494
[loss-ga] ep 40 it 200 total=-8.7463 ce_r=8.8263 ce_f=17.5726
[loss-ga] ep 40 it 250 total=-8.4402 ce_r=8.4756 ce_f=16.9158
[loss-ga] ep 40 it 300 total=-8.5908 ce_r=8.6246 ce_f=17.2154
[loss-ga] ep 40 it 350 total=-8.3574 ce_r=8.4676 ce_f=16.8249
[loss-ga] ep 41 it 10 total=-8.4021 ce_r=8.5087 ce_f=16.9109
[loss-ga] ep 41 it 60 total=-8.4097 ce_r=8.4875 ce_f=16.8972
[loss-ga] ep 41 it 110 total=-8.4202 ce_r=8.4492 ce_f=16.8694
[loss-ga] ep 41 it 160 total=-8.2923 ce_r=8.3259 ce_f=16.6182
[loss-ga] ep 41 it 210 total=-8.3859 ce_r=8.4693 ce_f=16.8552
[loss-ga] ep 41 it 260 total=-8.4344 ce_r=8.4810 ce_f=16.9155
[loss-ga] ep 41 it 310 total=-8.4215 ce_r=8.4636 ce_f=16.8851
[loss-ga] ep 41 it 360 total=-8.3728 ce_r=8.3859 ce_f=16.7587
[loss-ga] ep 42 it 20 total=-8.4123 ce_r=8.4705 ce_f=16.8828
[loss-ga] ep 42 it 70 total=-8.3315 ce_r=8.3508 ce_f=16.6822
[loss-ga] ep 42 it 120 total=-8.4593 ce_r=8.5666 ce_f=17.0259
[loss-ga] ep 42 it 170 total=-8.4699 ce_r=8.5344 ce_f=17.0043
[loss-ga] ep 42 it 220 total=-8.6175 ce_r=8.6319 ce_f=17.2494
[loss-ga] ep 42 it 270 total=-8.4457 ce_r=8.4895 ce_f=16.9352
[loss-ga] ep 42 it 320 total=-8.4088 ce_r=8.5012 ce_f=16.9100
[loss-ga] ep 42 it 370 total=-8.5030 ce_r=8.5279 ce_f=17.0309
[loss-ga] ep 43 it 30 total=-8.5129 ce_r=8.5319 ce_f=17.0448
[loss-ga] ep 43 it 80 total=-8.2475 ce_r=8.2589 ce_f=16.5063
[loss-ga] ep 43 it 130 total=-8.5785 ce_r=8.6082 ce_f=17.1867
[loss-ga] ep 43 it 180 total=-8.4594 ce_r=8.4669 ce_f=16.9263
[loss-ga] ep 43 it 230 total=-8.2824 ce_r=8.3005 ce_f=16.5829
[loss-ga] ep 43 it 280 total=-8.2196 ce_r=8.3527 ce_f=16.5723
[loss-ga] ep 43 it 330 total=-8.2844 ce_r=8.3063 ce_f=16.5907
[loss-ga] ep 43 it 380 total=-8.2982 ce_r=8.3098 ce_f=16.6080
[loss-ga] ep 44 it 40 total=-8.4686 ce_r=8.4843 ce_f=16.9530
[loss-ga] ep 44 it 90 total=-8.3673 ce_r=8.4153 ce_f=16.7826
[loss-ga] ep 44 it 140 total=-8.6073 ce_r=8.6561 ce_f=17.2634
[loss-ga] ep 44 it 190 total=-8.5114 ce_r=8.5406 ce_f=17.0519
[loss-ga] ep 44 it 240 total=-8.4821 ce_r=8.4958 ce_f=16.9779
[loss-ga] ep 44 it 290 total=-8.6143 ce_r=8.6623 ce_f=17.2766
[loss-ga] ep 44 it 340 total=-8.4609 ce_r=8.5348 ce_f=16.9957
[loss-ga] ep 45 it 0 total=-8.4362 ce_r=8.4746 ce_f=16.9108
[loss-ga] ep 45 it 50 total=-8.2746 ce_r=8.2968 ce_f=16.5714
[loss-ga] ep 45 it 100 total=-8.4953 ce_r=8.5506 ce_f=17.0459
[loss-ga] ep 45 it 150 total=-8.4402 ce_r=8.5269 ce_f=16.9671
[loss-ga] ep 45 it 200 total=-8.2795 ce_r=8.3024 ce_f=16.5820
[loss-ga] ep 45 it 250 total=-8.5527 ce_r=8.6857 ce_f=17.2384
[loss-ga] ep 45 it 300 total=-8.3687 ce_r=8.4042 ce_f=16.7729
[loss-ga] ep 45 it 350 total=-8.5626 ce_r=8.5948 ce_f=17.1574
[loss-ga] ep 46 it 10 total=-8.4338 ce_r=8.5488 ce_f=16.9826
[loss-ga] ep 46 it 60 total=-8.4281 ce_r=8.4519 ce_f=16.8800
[loss-ga] ep 46 it 110 total=-8.3420 ce_r=8.4827 ce_f=16.8248
[loss-ga] ep 46 it 160 total=-8.3364 ce_r=8.3511 ce_f=16.6875
[loss-ga] ep 46 it 210 total=-8.4832 ce_r=8.5179 ce_f=17.0011
[loss-ga] ep 46 it 260 total=-8.4373 ce_r=8.4551 ce_f=16.8924
[loss-ga] ep 46 it 310 total=-8.5076 ce_r=8.6414 ce_f=17.1490
[loss-ga] ep 46 it 360 total=-8.4644 ce_r=8.4717 ce_f=16.9361
[loss-ga] ep 47 it 20 total=-8.2794 ce_r=8.3169 ce_f=16.5962
[loss-ga] ep 47 it 70 total=-8.2785 ce_r=8.4628 ce_f=16.7413
[loss-ga] ep 47 it 120 total=-8.5737 ce_r=8.5938 ce_f=17.1674
[loss-ga] ep 47 it 170 total=-8.4982 ce_r=8.5059 ce_f=17.0041
[loss-ga] ep 47 it 220 total=-8.3986 ce_r=8.4152 ce_f=16.8139
[loss-ga] ep 47 it 270 total=-8.5528 ce_r=8.6126 ce_f=17.1654
[loss-ga] ep 47 it 320 total=-8.5251 ce_r=8.5728 ce_f=17.0978
[loss-ga] ep 47 it 370 total=-8.4484 ce_r=8.4688 ce_f=16.9171
[loss-ga] ep 48 it 30 total=-8.5463 ce_r=8.6506 ce_f=17.1968
[loss-ga] ep 48 it 80 total=-8.2830 ce_r=8.2884 ce_f=16.5714
[loss-ga] ep 48 it 130 total=-8.3127 ce_r=8.3429 ce_f=16.6555
[loss-ga] ep 48 it 180 total=-8.4582 ce_r=8.4707 ce_f=16.9289
[loss-ga] ep 48 it 230 total=-8.4186 ce_r=8.5351 ce_f=16.9537
[loss-ga] ep 48 it 280 total=-8.3021 ce_r=8.3320 ce_f=16.6341
[loss-ga] ep 48 it 330 total=-8.3111 ce_r=8.3860 ce_f=16.6972
[loss-ga] ep 48 it 380 total=-8.2510 ce_r=8.4226 ce_f=16.6736
[loss-ga] ep 49 it 40 total=-8.4060 ce_r=8.4280 ce_f=16.8340
[loss-ga] ep 49 it 90 total=-8.4620 ce_r=8.5030 ce_f=16.9649
[loss-ga] ep 49 it 140 total=-8.5169 ce_r=8.5556 ce_f=17.0725
[loss-ga] ep 49 it 190 total=-8.4981 ce_r=8.5074 ce_f=17.0055
[loss-ga] ep 49 it 240 total=-8.3173 ce_r=8.4064 ce_f=16.7237
[loss-ga] ep 49 it 290 total=-8.4348 ce_r=8.4500 ce_f=16.8848
[loss-ga] ep 49 it 340 total=-8.5631 ce_r=8.6408 ce_f=17.2039
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget5.pt
resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget5: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:02,  2.13it/s]  3%|▎         | 11/391 [00:00<00:15, 24.51it/s]  5%|▌         | 21/391 [00:00<00:08, 43.08it/s]  8%|▊         | 32/391 [00:00<00:06, 59.10it/s] 10%|█         | 41/391 [00:00<00:05, 65.48it/s] 13%|█▎        | 50/391 [00:01<00:04, 69.55it/s] 15%|█▌        | 59/391 [00:01<00:04, 70.03it/s] 17%|█▋        | 67/391 [00:01<00:04, 71.06it/s] 19%|█▉        | 76/391 [00:01<00:04, 74.63it/s] 22%|██▏       | 86/391 [00:01<00:03, 81.55it/s] 25%|██▍       | 97/391 [00:01<00:03, 87.32it/s] 27%|██▋       | 107/391 [00:01<00:03, 90.27it/s] 30%|███       | 118/391 [00:01<00:02, 93.11it/s] 33%|███▎      | 129/391 [00:01<00:02, 95.34it/s] 36%|███▌      | 139/391 [00:01<00:02, 96.35it/s] 38%|███▊      | 150/391 [00:02<00:02, 97.90it/s] 41%|████      | 160/391 [00:02<00:02, 89.97it/s] 43%|████▎     | 170/391 [00:02<00:02, 80.86it/s] 46%|████▌     | 179/391 [00:02<00:02, 81.42it/s] 48%|████▊     | 188/391 [00:02<00:02, 79.27it/s] 50%|█████     | 197/391 [00:02<00:02, 73.91it/s] 53%|█████▎    | 207/391 [00:02<00:02, 80.05it/s] 55%|█████▌    | 217/391 [00:02<00:02, 84.91it/s] 58%|█████▊    | 228/391 [00:03<00:01, 89.42it/s] 61%|██████    | 239/391 [00:03<00:01, 92.58it/s] 64%|██████▎   | 249/391 [00:03<00:01, 94.35it/s] 66%|██████▌   | 259/391 [00:03<00:01, 95.74it/s] 69%|██████▉   | 269/391 [00:03<00:01, 96.92it/s] 71%|███████▏  | 279/391 [00:03<00:01, 97.65it/s] 74%|███████▍  | 290/391 [00:03<00:01, 98.55it/s] 77%|███████▋  | 300/391 [00:03<00:00, 98.94it/s] 79%|███████▉  | 310/391 [00:03<00:00, 98.70it/s] 82%|████████▏ | 320/391 [00:03<00:00, 98.70it/s] 85%|████████▍ | 331/391 [00:04<00:00, 99.43it/s] 87%|████████▋ | 341/391 [00:04<00:00, 99.55it/s] 90%|████████▉ | 351/391 [00:04<00:00, 99.62it/s] 92%|█████████▏| 361/391 [00:04<00:00, 98.73it/s] 95%|█████████▌| 372/391 [00:04<00:00, 99.78it/s] 98%|█████████▊| 383/391 [00:04<00:00, 100.67it/s]100%|██████████| 391/391 [00:04<00:00, 83.10it/s] 
50000 images processed, 4.811911344528198 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.32it/s] 11%|█▏        | 9/79 [00:00<00:03, 21.63it/s] 24%|██▍       | 19/79 [00:00<00:01, 40.95it/s] 34%|███▍      | 27/79 [00:00<00:01, 50.01it/s] 46%|████▌     | 36/79 [00:00<00:00, 59.34it/s] 57%|█████▋    | 45/79 [00:00<00:00, 67.35it/s] 67%|██████▋   | 53/79 [00:01<00:00, 67.97it/s] 77%|███████▋  | 61/79 [00:01<00:00, 68.30it/s] 90%|████████▉ | 71/79 [00:01<00:00, 75.45it/s]100%|██████████| 79/79 [00:02<00:00, 17.32it/s]100%|██████████| 79/79 [00:02<00:00, 29.95it/s]
10000 images processed, 2.6830625534057617 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget5/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:03,  1.65it/s]  5%|▍         | 10/204 [00:00<00:10, 18.39it/s] 10%|▉         | 20/204 [00:00<00:05, 35.24it/s] 15%|█▍        | 30/204 [00:00<00:03, 49.53it/s] 20%|█▉        | 40/204 [00:01<00:02, 61.54it/s] 25%|██▍       | 50/204 [00:01<00:02, 71.38it/s] 29%|██▉       | 60/204 [00:01<00:01, 78.86it/s] 34%|███▍      | 70/204 [00:01<00:01, 84.60it/s] 39%|███▉      | 80/204 [00:01<00:01, 88.73it/s] 44%|████▍     | 90/204 [00:01<00:01, 91.28it/s] 49%|████▉     | 100/204 [00:01<00:01, 93.68it/s] 54%|█████▍    | 110/204 [00:01<00:00, 95.27it/s] 59%|█████▉    | 120/204 [00:01<00:00, 93.83it/s] 64%|██████▎   | 130/204 [00:01<00:00, 93.48it/s] 69%|██████▊   | 140/204 [00:02<00:00, 94.26it/s] 74%|███████▎  | 150/204 [00:02<00:00, 94.99it/s] 78%|███████▊  | 160/204 [00:02<00:00, 95.68it/s] 83%|████████▎ | 170/204 [00:02<00:00, 96.11it/s] 88%|████████▊ | 180/204 [00:02<00:00, 96.98it/s] 94%|█████████▎| 191/204 [00:02<00:00, 98.41it/s] 99%|█████████▉| 202/204 [00:02<00:00, 99.36it/s]100%|██████████| 204/204 [00:02<00:00, 75.51it/s]
26032 images processed, 2.7423553466796875 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.58it/s] 11%|█▏        | 9/79 [00:00<00:04, 15.85it/s] 22%|██▏       | 17/79 [00:00<00:02, 28.83it/s] 32%|███▏      | 25/79 [00:00<00:01, 40.40it/s] 42%|████▏     | 33/79 [00:01<00:00, 46.62it/s] 53%|█████▎    | 42/79 [00:01<00:00, 56.40it/s] 66%|██████▌   | 52/79 [00:01<00:00, 66.75it/s] 78%|███████▊  | 62/79 [00:01<00:00, 75.49it/s] 92%|█████████▏| 73/79 [00:01<00:00, 81.27it/s]100%|██████████| 79/79 [00:01<00:00, 50.04it/s]
10000 images processed, 1.659581184387207 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.57it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.51it/s] 28%|██▊       | 22/79 [00:00<00:01, 37.45it/s] 41%|████      | 32/79 [00:00<00:00, 51.15it/s] 54%|█████▍    | 43/79 [00:01<00:00, 63.79it/s] 67%|██████▋   | 53/79 [00:01<00:00, 72.91it/s] 81%|████████  | 64/79 [00:01<00:00, 80.98it/s] 95%|█████████▍| 75/79 [00:01<00:00, 86.88it/s]100%|██████████| 79/79 [00:01<00:00, 55.96it/s]
10000 images processed, 1.4345691204071045 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:30,  2.29it/s]  9%|▊         | 6/70 [00:00<00:04, 14.02it/s] 23%|██▎       | 16/70 [00:00<00:01, 36.32it/s] 37%|███▋      | 26/70 [00:00<00:00, 52.76it/s] 51%|█████▏    | 36/70 [00:00<00:00, 65.70it/s] 67%|██████▋   | 47/70 [00:00<00:00, 76.22it/s] 83%|████████▎ | 58/70 [00:01<00:00, 83.80it/s] 99%|█████████▊| 69/70 [00:01<00:00, 89.08it/s]100%|██████████| 70/70 [00:01<00:00, 59.22it/s]
8925 images processed, 1.212157964706421 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.03it/s] 11%|█         | 5/45 [00:01<00:06,  6.01it/s] 18%|█▊        | 8/45 [00:01<00:05,  6.68it/s] 42%|████▏     | 19/45 [00:01<00:01, 20.05it/s] 53%|█████▎    | 24/45 [00:02<00:01, 15.72it/s] 76%|███████▌  | 34/45 [00:02<00:00, 26.09it/s] 89%|████████▉ | 40/45 [00:02<00:00, 22.82it/s]100%|██████████| 45/45 [00:02<00:00, 17.37it/s]
5640 images processed, 2.644951105117798 seconds used

18.88361406326294
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           7.72  98.23  95.57
places365     72.25  78.90  76.96
LSUN          31.62  93.74  94.06
iSUN          73.97  80.63  83.98
dtd           44.47  89.22  93.11
AVG           46.01  88.15  88.74
Retain-Acc: 0.7302
Forget-as-OOD (retain known vs forget novel):
  FPR: 71.20 AUROC: 75.72 AUIN: 98.29
8.506148099899292
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget5_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget5_rf.png
