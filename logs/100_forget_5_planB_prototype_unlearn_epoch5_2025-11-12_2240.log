nohup: ignoring input
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=5, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08-planB_adapter', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51', forget_list_path=None, forget_classes_inc=None, forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
[DEBUG] forget=2500, retain=47500, half_f=64, half_r=64
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
  0%|          | 0/5 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 0 it 0 total=9.2464 mle=1.5918 pcon=5.2950 forget=2.3595 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 0 it 50 total=9.2172 mle=1.5427 pcon=5.2893 forget=2.3852 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 0 it 100 total=9.1527 mle=1.4806 pcon=5.2835 forget=2.3886 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 0 it 150 total=9.1410 mle=1.5236 pcon=5.2780 forget=2.3395 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
 20%|██        | 1/5 [00:14<00:56, 14.22s/it][BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 0 it 200 total=9.1267 mle=1.5435 pcon=5.2723 forget=2.3109 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 0 it 250 total=9.2535 mle=1.5948 pcon=5.2669 forget=2.3918 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 0 it 300 total=9.1124 mle=1.4608 pcon=5.2616 forget=2.3901 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 0 it 350 total=9.0805 mle=1.4113 pcon=5.2563 forget=2.4128 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08-planB_adapter
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 1 it 10 total=9.1706 mle=1.5100 pcon=5.2514 forget=2.4093 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 1 it 60 total=9.0501 mle=1.3923 pcon=5.2463 forget=2.4116 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 1 it 110 total=9.1730 mle=1.5419 pcon=5.2413 forget=2.3897 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 1 it 160 total=9.0243 mle=1.3752 pcon=5.2365 forget=2.4125 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
 40%|████      | 2/5 [00:24<00:36, 12.01s/it][BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 1 it 210 total=9.1647 mle=1.5296 pcon=5.2316 forget=2.4034 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 1 it 260 total=9.1579 mle=1.5846 pcon=5.2272 forget=2.3461 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 1 it 310 total=9.1619 mle=1.5567 pcon=5.2231 forget=2.3821 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 1 it 360 total=9.0179 mle=1.4151 pcon=5.2187 forget=2.3841 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08-planB_adapter
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 2 it 20 total=8.9865 mle=1.4033 pcon=5.2143 forget=2.3689 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 2 it 70 total=9.0149 mle=1.3855 pcon=5.2098 forget=2.4196 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 2 it 120 total=9.0634 mle=1.4538 pcon=5.2054 forget=2.4042 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 2 it 170 total=8.9453 mle=1.3731 pcon=5.2014 forget=2.3708 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
 60%|██████    | 3/5 [00:34<00:22, 11.10s/it][BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 2 it 220 total=9.0904 mle=1.5264 pcon=5.1973 forget=2.3668 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 2 it 270 total=9.0292 mle=1.4580 pcon=5.1933 forget=2.3779 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 2 it 320 total=9.0758 mle=1.4984 pcon=5.1895 forget=2.3880 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 2 it 370 total=8.9672 mle=1.3829 pcon=5.1856 forget=2.3986 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08-planB_adapter
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 3 it 30 total=9.0742 mle=1.4669 pcon=5.1820 forget=2.4253 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 3 it 80 total=9.0810 mle=1.4757 pcon=5.1779 forget=2.4274 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 3 it 130 total=8.9774 mle=1.3960 pcon=5.1743 forget=2.4070 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 3 it 180 total=8.9708 mle=1.3942 pcon=5.1704 forget=2.4062 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
 80%|████████  | 4/5 [00:45<00:11, 11.01s/it][loss] ep 3 it 230 total=8.9438 mle=1.3597 pcon=5.1669 forget=2.4172 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 3 it 280 total=9.0451 mle=1.4909 pcon=5.1636 forget=2.3906 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 3 it 330 total=8.9638 mle=1.4167 pcon=5.1608 forget=2.3864 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 3 it 380 total=8.9647 mle=1.4198 pcon=5.1574 forget=2.3875 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08-planB_adapter
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 4 it 40 total=8.8704 mle=1.3394 pcon=5.1543 forget=2.3768 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 4 it 90 total=8.9022 mle=1.3715 pcon=5.1513 forget=2.3794 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 4 it 140 total=8.9064 mle=1.3423 pcon=5.1482 forget=2.4159 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 4 it 190 total=9.0597 mle=1.5136 pcon=5.1451 forget=2.4009 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 4 it 240 total=9.1052 mle=1.5811 pcon=5.1420 forget=2.3821 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
100%|██████████| 5/5 [00:54<00:00, 10.41s/it]100%|██████████| 5/5 [00:54<00:00, 10.99s/it]
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 4 it 290 total=9.0222 mle=1.4749 pcon=5.1391 forget=2.4082 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[loss] ep 4 it 340 total=8.8532 mle=1.3718 pcon=5.1361 forget=2.3453 orth=0.0000 favg=0.0000 nr=128 nf=64 protos=600 fproto_sim=NA
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[BATCH] f_take=64, r_take=64, need=0
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08-planB_adapter
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08-planB_adapter
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:24,  1.91it/s]  2%|▏         | 8/391 [00:00<00:23, 16.36it/s]  4%|▍         | 16/391 [00:00<00:12, 30.49it/s]  7%|▋         | 26/391 [00:00<00:07, 47.07it/s]  9%|▉         | 36/391 [00:00<00:05, 59.85it/s] 12%|█▏        | 46/391 [00:01<00:04, 69.84it/s] 14%|█▍        | 56/391 [00:01<00:04, 77.15it/s] 17%|█▋        | 65/391 [00:01<00:04, 78.39it/s] 19%|█▉        | 75/391 [00:01<00:03, 83.26it/s] 22%|██▏       | 85/391 [00:01<00:03, 87.16it/s] 24%|██▍       | 95/391 [00:01<00:03, 89.50it/s] 27%|██▋       | 105/391 [00:01<00:03, 91.33it/s] 29%|██▉       | 115/391 [00:01<00:02, 92.99it/s] 32%|███▏      | 125/391 [00:01<00:02, 89.20it/s] 35%|███▍      | 135/391 [00:02<00:03, 81.51it/s] 37%|███▋      | 144/391 [00:02<00:03, 77.06it/s] 39%|███▉      | 152/391 [00:02<00:03, 75.42it/s] 41%|████      | 160/391 [00:02<00:03, 75.80it/s] 43%|████▎     | 168/391 [00:02<00:03, 69.34it/s] 45%|████▌     | 176/391 [00:02<00:03, 67.63it/s] 48%|████▊     | 186/391 [00:02<00:02, 73.73it/s] 50%|████▉     | 194/391 [00:02<00:02, 68.13it/s] 51%|█████▏    | 201/391 [00:03<00:02, 67.88it/s] 54%|█████▎    | 210/391 [00:03<00:02, 72.33it/s] 56%|█████▌    | 219/391 [00:03<00:02, 76.04it/s] 58%|█████▊    | 227/391 [00:03<00:02, 69.80it/s] 60%|██████    | 235/391 [00:03<00:02, 69.44it/s] 62%|██████▏   | 243/391 [00:03<00:02, 66.71it/s] 64%|██████▍   | 250/391 [00:03<00:02, 66.67it/s] 66%|██████▌   | 257/391 [00:03<00:02, 66.74it/s] 68%|██████▊   | 265/391 [00:03<00:01, 69.07it/s] 70%|██████▉   | 272/391 [00:04<00:01, 68.81it/s] 72%|███████▏  | 280/391 [00:04<00:01, 70.98it/s] 74%|███████▍  | 289/391 [00:04<00:01, 74.60it/s] 76%|███████▌  | 297/391 [00:04<00:01, 75.25it/s] 79%|███████▊  | 307/391 [00:04<00:01, 80.92it/s] 81%|████████  | 317/391 [00:04<00:00, 85.08it/s] 84%|████████▎ | 327/391 [00:04<00:00, 87.58it/s] 86%|████████▌ | 337/391 [00:04<00:00, 90.22it/s] 89%|████████▊ | 347/391 [00:04<00:00, 91.62it/s] 91%|█████████▏| 357/391 [00:05<00:00, 91.94it/s] 94%|█████████▍| 367/391 [00:05<00:00, 93.24it/s] 96%|█████████▋| 377/391 [00:05<00:00, 94.71it/s] 99%|█████████▉| 387/391 [00:05<00:00, 95.66it/s]100%|██████████| 391/391 [00:05<00:00, 72.98it/s]
50000 images processed, 5.440647840499878 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:32,  2.42it/s]  8%|▊         | 6/79 [00:00<00:05, 14.52it/s] 19%|█▉        | 15/79 [00:00<00:01, 34.32it/s] 30%|███       | 24/79 [00:00<00:01, 49.00it/s] 43%|████▎     | 34/79 [00:00<00:00, 60.75it/s] 54%|█████▍    | 43/79 [00:00<00:00, 67.98it/s] 67%|██████▋   | 53/79 [00:01<00:00, 75.05it/s] 80%|███████▉  | 63/79 [00:01<00:00, 80.63it/s] 92%|█████████▏| 73/79 [00:01<00:00, 84.51it/s]100%|██████████| 79/79 [00:01<00:00, 58.83it/s]
10000 images processed, 1.3669829368591309 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:43,  1.96it/s]  5%|▍         | 10/204 [00:00<00:09, 21.19it/s] 10%|▉         | 20/204 [00:00<00:04, 39.44it/s] 15%|█▍        | 30/204 [00:00<00:03, 53.79it/s] 20%|█▉        | 40/204 [00:00<00:02, 65.04it/s] 25%|██▍       | 50/204 [00:01<00:02, 73.21it/s] 29%|██▉       | 60/204 [00:01<00:01, 79.40it/s] 34%|███▍      | 70/204 [00:01<00:01, 83.86it/s] 39%|███▉      | 80/204 [00:01<00:01, 87.05it/s] 44%|████▍     | 90/204 [00:01<00:01, 88.43it/s] 49%|████▉     | 100/204 [00:01<00:01, 89.38it/s] 54%|█████▍    | 110/204 [00:01<00:01, 90.86it/s] 59%|█████▉    | 120/204 [00:01<00:00, 92.19it/s] 64%|██████▎   | 130/204 [00:01<00:00, 93.11it/s] 69%|██████▊   | 140/204 [00:01<00:00, 93.45it/s] 74%|███████▎  | 150/204 [00:02<00:00, 93.67it/s] 78%|███████▊  | 160/204 [00:02<00:00, 91.00it/s] 83%|████████▎ | 170/204 [00:02<00:00, 91.27it/s] 88%|████████▊ | 180/204 [00:02<00:00, 92.44it/s] 93%|█████████▎| 190/204 [00:02<00:00, 93.86it/s] 98%|█████████▊| 200/204 [00:02<00:00, 94.79it/s]100%|██████████| 204/204 [00:02<00:00, 76.18it/s]
26032 images processed, 2.7177574634552 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:57,  1.35it/s] 10%|█         | 8/79 [00:00<00:05, 12.34it/s] 22%|██▏       | 17/79 [00:00<00:02, 26.37it/s] 34%|███▍      | 27/79 [00:01<00:01, 40.79it/s] 47%|████▋     | 37/79 [00:01<00:00, 53.26it/s] 58%|█████▊    | 46/79 [00:01<00:00, 61.79it/s] 70%|██████▉   | 55/79 [00:01<00:00, 63.46it/s] 82%|████████▏ | 65/79 [00:01<00:00, 71.09it/s] 95%|█████████▍| 75/79 [00:01<00:00, 77.96it/s]100%|██████████| 79/79 [00:01<00:00, 47.75it/s]
10000 images processed, 1.6921536922454834 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.98it/s]  9%|▉         | 7/79 [00:00<00:04, 14.59it/s] 22%|██▏       | 17/79 [00:00<00:01, 34.12it/s] 33%|███▎      | 26/79 [00:00<00:01, 47.84it/s] 46%|████▌     | 36/79 [00:00<00:00, 59.83it/s] 58%|█████▊    | 46/79 [00:01<00:00, 68.89it/s] 71%|███████   | 56/79 [00:01<00:00, 76.20it/s] 84%|████████▎ | 66/79 [00:01<00:00, 81.82it/s] 96%|█████████▌| 76/79 [00:01<00:00, 86.18it/s]100%|██████████| 79/79 [00:01<00:00, 57.34it/s]
10000 images processed, 1.4037280082702637 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.90it/s] 13%|█▎        | 9/70 [00:00<00:03, 18.25it/s] 27%|██▋       | 19/70 [00:00<00:01, 36.36it/s] 41%|████▏     | 29/70 [00:00<00:00, 50.83it/s] 56%|█████▌    | 39/70 [00:00<00:00, 62.14it/s] 70%|███████   | 49/70 [00:01<00:00, 71.47it/s] 84%|████████▍ | 59/70 [00:01<00:00, 78.53it/s] 99%|█████████▊| 69/70 [00:01<00:00, 83.80it/s]100%|██████████| 70/70 [00:01<00:00, 54.54it/s]
8925 images processed, 1.3159630298614502 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:47,  1.09s/it]  7%|▋         | 3/45 [00:01<00:13,  3.09it/s] 27%|██▋       | 12/45 [00:01<00:02, 15.27it/s] 38%|███▊      | 17/45 [00:01<00:02, 13.75it/s] 60%|██████    | 27/45 [00:01<00:00, 22.70it/s] 73%|███████▎  | 33/45 [00:02<00:00, 19.66it/s] 96%|█████████▌| 43/45 [00:02<00:00, 21.52it/s]100%|██████████| 45/45 [00:02<00:00, 16.34it/s]
5640 images processed, 2.786763906478882 seconds used

18.29406714439392
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.53  99.36  98.11
places365     68.31  80.53  78.96
LSUN          21.69  95.04  95.10
iSUN          72.35  81.48  84.57
dtd           38.32  91.26  94.50
AVG           40.64  89.54  90.25
Retain-Acc: 0.7486
Forget-as-OOD (retain known vs forget novel):
  FPR: 55.40 AUROC: 88.43 AUIN: 99.25
7.7040417194366455
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget5-temp0.08_rf.png
