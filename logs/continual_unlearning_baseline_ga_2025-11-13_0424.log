nohup: ignoring input
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,11,40,51,57,66,67,88,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=0.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=False, lora_impl='native', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='head', adapter_save_path=None, adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,57,66,67,88,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='ga', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
[debug] trainable_count = 112
[debug] trainable: encoder.conv1.weight
[debug] trainable: encoder.bn1.weight
[debug] trainable: encoder.bn1.bias
[debug] trainable: encoder.layer1.0.conv1.weight
[debug] trainable: encoder.layer1.0.bn1.weight
[debug] trainable: encoder.layer1.0.bn1.bias
[debug] trainable: encoder.layer1.0.conv2.weight
[debug] trainable: encoder.layer1.0.bn2.weight
[debug] trainable: encoder.layer1.0.bn2.bias
[debug] trainable: encoder.layer1.1.conv1.weight
[debug] trainable: encoder.layer1.1.bn1.weight
[debug] trainable: encoder.layer1.1.bn1.bias
[debug] trainable: encoder.layer1.1.conv2.weight
[debug] trainable: encoder.layer1.1.bn2.weight
[debug] trainable: encoder.layer1.1.bn2.bias
[debug] trainable: encoder.layer1.2.conv1.weight
[debug] trainable: encoder.layer1.2.bn1.weight
[debug] trainable: encoder.layer1.2.bn1.bias
[debug] trainable: encoder.layer1.2.conv2.weight
[debug] trainable: encoder.layer1.2.bn2.weight
[debug] trainable: encoder.layer1.2.bn2.bias
[debug] trainable: encoder.layer2.0.conv1.weight
[debug] trainable: encoder.layer2.0.bn1.weight
[debug] trainable: encoder.layer2.0.bn1.bias
[debug] trainable: encoder.layer2.0.conv2.weight
[debug] trainable: encoder.layer2.0.bn2.weight
[debug] trainable: encoder.layer2.0.bn2.bias
[debug] trainable: encoder.layer2.0.shortcut.0.weight
[debug] trainable: encoder.layer2.0.shortcut.1.weight
[debug] trainable: encoder.layer2.0.shortcut.1.bias
[debug] trainable: encoder.layer2.1.conv1.weight
[debug] trainable: encoder.layer2.1.bn1.weight
[debug] trainable: encoder.layer2.1.bn1.bias
[debug] trainable: encoder.layer2.1.conv2.weight
[debug] trainable: encoder.layer2.1.bn2.weight
[debug] trainable: encoder.layer2.1.bn2.bias
[debug] trainable: encoder.layer2.2.conv1.weight
[debug] trainable: encoder.layer2.2.bn1.weight
[debug] trainable: encoder.layer2.2.bn1.bias
[debug] trainable: encoder.layer2.2.conv2.weight
[debug] trainable: encoder.layer2.2.bn2.weight
[debug] trainable: encoder.layer2.2.bn2.bias
[debug] trainable: encoder.layer2.3.conv1.weight
[debug] trainable: encoder.layer2.3.bn1.weight
[debug] trainable: encoder.layer2.3.bn1.bias
[debug] trainable: encoder.layer2.3.conv2.weight
[debug] trainable: encoder.layer2.3.bn2.weight
[debug] trainable: encoder.layer2.3.bn2.bias
[debug] trainable: encoder.layer3.0.conv1.weight
[debug] trainable: encoder.layer3.0.bn1.weight
[debug][warn] non-LoRA trainables detected: ['encoder.conv1.weight', 'encoder.bn1.weight', 'encoder.bn1.bias', 'encoder.layer1.0.conv1.weight', 'encoder.layer1.0.bn1.weight', 'encoder.layer1.0.bn1.bias', 'encoder.layer1.0.conv2.weight', 'encoder.layer1.0.bn2.weight', 'encoder.layer1.0.bn2.bias', 'encoder.layer1.1.conv1.weight']
[trainable] param_count=21605312 tensors=112
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:553: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=bool(scaler is not None)):
/home/shaokun/PALM/trainer.py:641: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/torch/csrc/autograd/generated/python_variable_methods.cpp:835.)
  print(f"[loss-{args.forget_strategy}] ep {epoch} it {it} total={loss.item():.4f} ce_r={float(loss_retain):.4f} ce_f={float(loss_forget):.4f}")
  2%|▏         | 1/50 [00:39<32:24, 39.68s/it]  4%|▍         | 2/50 [00:55<20:17, 25.37s/it]  6%|▌         | 3/50 [01:12<17:04, 21.79s/it]  8%|▊         | 4/50 [01:29<15:07, 19.74s/it] 10%|█         | 5/50 [01:44<13:42, 18.28s/it] 12%|█▏        | 6/50 [02:00<12:43, 17.36s/it] 14%|█▍        | 7/50 [02:16<12:05, 16.87s/it] 16%|█▌        | 8/50 [02:31<11:31, 16.45s/it] 18%|█▊        | 9/50 [02:47<10:58, 16.06s/it] 20%|██        | 10/50 [03:03<10:49, 16.23s/it] 22%|██▏       | 11/50 [03:19<10:25, 16.03s/it] 24%|██▍       | 12/50 [03:35<10:07, 15.98s/it] 26%|██▌       | 13/50 [03:50<09:46, 15.84s/it] 28%|██▊       | 14/50 [04:06<09:35, 15.98s/it] 30%|███       | 15/50 [04:22<09:17, 15.93s/it] 32%|███▏      | 16/50 [04:37<08:53, 15.70s/it] 34%|███▍      | 17/50 [04:53<08:38, 15.71s/it][loss-ga] ep 0 it 0 total=0.0053 ce_r=0.0092 ce_f=0.0193
[loss-ga] ep 0 it 50 total=0.0139 ce_r=0.0163 ce_f=0.0120
[loss-ga] ep 0 it 100 total=0.0434 ce_r=0.0499 ce_f=0.0325
[loss-ga] ep 0 it 150 total=0.0177 ce_r=0.0202 ce_f=0.0124
[loss-ga] ep 0 it 200 total=0.0059 ce_r=0.0182 ce_f=0.0615
[loss-ga] ep 0 it 250 total=0.0157 ce_r=0.0162 ce_f=0.0025
[loss-ga] ep 0 it 300 total=0.0349 ce_r=0.0358 ce_f=0.0045
[loss-ga] ep 0 it 350 total=0.0158 ce_r=0.0180 ce_f=0.0109
[loss-ga] ep 1 it 9 total=0.0352 ce_r=0.0394 ce_f=0.0210
[loss-ga] ep 1 it 59 total=0.0012 ce_r=0.0106 ce_f=0.0469
[loss-ga] ep 1 it 109 total=-0.0210 ce_r=0.0118 ce_f=0.1637
[loss-ga] ep 1 it 159 total=0.0486 ce_r=0.0493 ce_f=0.0037
[loss-ga] ep 1 it 209 total=0.0151 ce_r=0.0200 ce_f=0.0247
[loss-ga] ep 1 it 259 total=0.0061 ce_r=0.0078 ce_f=0.0088
[loss-ga] ep 1 it 309 total=0.0083 ce_r=0.0138 ce_f=0.0274
[loss-ga] ep 1 it 359 total=0.0121 ce_r=0.0127 ce_f=0.0030
[loss-ga] ep 2 it 18 total=0.0202 ce_r=0.0215 ce_f=0.0065
[loss-ga] ep 2 it 68 total=0.0093 ce_r=0.0100 ce_f=0.0035
[loss-ga] ep 2 it 118 total=0.0565 ce_r=0.0576 ce_f=0.0054
[loss-ga] ep 2 it 168 total=0.0050 ce_r=0.0056 ce_f=0.0030
[loss-ga] ep 2 it 218 total=-0.1503 ce_r=0.0398 ce_f=0.9504
[loss-ga] ep 2 it 268 total=-0.1648 ce_r=0.0426 ce_f=1.0367
[loss-ga] ep 2 it 318 total=-0.0654 ce_r=0.0593 ce_f=0.6239
[loss-ga] ep 2 it 368 total=-0.1777 ce_r=0.0350 ce_f=1.0637
[loss-ga] ep 3 it 27 total=-0.5542 ce_r=0.0288 ce_f=2.9147
[loss-ga] ep 3 it 77 total=-0.2371 ce_r=0.0139 ce_f=1.2552
[loss-ga] ep 3 it 127 total=-0.9923 ce_r=0.0552 ce_f=5.2371
[loss-ga] ep 3 it 177 total=-2.0229 ce_r=0.0107 ce_f=10.1680
[loss-ga] ep 3 it 227 total=-0.2816 ce_r=0.0413 ce_f=1.6143
[loss-ga] ep 3 it 277 total=-1.4947 ce_r=0.0578 ce_f=7.7627
[loss-ga] ep 3 it 327 total=-0.7049 ce_r=0.0559 ce_f=3.8036
[loss-ga] ep 3 it 377 total=-0.5250 ce_r=0.0546 ce_f=2.8980
[loss-ga] ep 4 it 36 total=-0.7213 ce_r=0.0440 ce_f=3.8266
[loss-ga] ep 4 it 86 total=-1.7792 ce_r=0.0295 ce_f=9.0435
[loss-ga] ep 4 it 136 total=-1.4047 ce_r=0.0180 ce_f=7.1133
[loss-ga] ep 4 it 186 total=-0.3565 ce_r=0.0688 ce_f=2.1264
[loss-ga] ep 4 it 236 total=-2.4956 ce_r=0.0598 ce_f=12.7770
[loss-ga] ep 4 it 286 total=-1.1523 ce_r=0.0583 ce_f=6.0530
[loss-ga] ep 4 it 336 total=-0.5711 ce_r=0.0568 ce_f=3.1399
[loss-ga] ep 4 it 386 total=-1.2200 ce_r=0.1111 ce_f=6.6557
[loss-ga] ep 5 it 45 total=-0.3972 ce_r=0.0799 ce_f=2.3855
[loss-ga] ep 5 it 95 total=-2.1544 ce_r=0.0406 ce_f=10.9752
[loss-ga] ep 5 it 145 total=-2.3005 ce_r=0.0148 ce_f=11.5768
[loss-ga] ep 5 it 195 total=0.0214 ce_r=0.0230 ce_f=0.0078
[loss-ga] ep 5 it 245 total=0.1054 ce_r=0.1109 ce_f=0.0274
[loss-ga] ep 5 it 295 total=-2.5925 ce_r=0.0915 ce_f=13.4200
[loss-ga] ep 5 it 345 total=-1.5039 ce_r=0.0124 ce_f=7.5814
[loss-ga] ep 6 it 4 total=-1.2727 ce_r=0.0233 ce_f=6.4798
[loss-ga] ep 6 it 54 total=-0.9845 ce_r=0.0405 ce_f=5.1248
[loss-ga] ep 6 it 104 total=-1.8169 ce_r=0.0597 ce_f=9.3830
[loss-ga] ep 6 it 154 total=-1.5392 ce_r=0.0295 ce_f=7.8437
[loss-ga] ep 6 it 204 total=-2.8889 ce_r=0.0446 ce_f=14.6672
[loss-ga] ep 6 it 254 total=-1.8267 ce_r=0.0575 ce_f=9.4210
[loss-ga] ep 6 it 304 total=-1.7649 ce_r=0.1113 ce_f=9.3808
[loss-ga] ep 6 it 354 total=-2.2883 ce_r=0.0101 ce_f=11.4924
[loss-ga] ep 7 it 13 total=-1.4019 ce_r=0.0239 ce_f=7.1292
[loss-ga] ep 7 it 63 total=-1.4534 ce_r=0.0178 ce_f=7.3560
[loss-ga] ep 7 it 113 total=-1.9132 ce_r=0.0190 ce_f=9.6609
[loss-ga] ep 7 it 163 total=-1.4324 ce_r=0.0459 ce_f=7.3917
[loss-ga] ep 7 it 213 total=-2.3072 ce_r=0.0975 ce_f=12.0232
[loss-ga] ep 7 it 263 total=-2.4507 ce_r=0.0595 ce_f=12.5508
[loss-ga] ep 7 it 313 total=-1.2259 ce_r=0.0788 ce_f=6.5234
[loss-ga] ep 7 it 363 total=-1.9039 ce_r=0.0570 ce_f=9.8045
[loss-ga] ep 8 it 22 total=-2.2462 ce_r=0.0262 ce_f=11.3619
[loss-ga] ep 8 it 72 total=-2.8850 ce_r=0.0840 ce_f=14.8448
[loss-ga] ep 8 it 122 total=-2.0338 ce_r=0.0559 ce_f=10.4489
[loss-ga] ep 8 it 172 total=-1.3360 ce_r=0.0254 ce_f=6.8071
[loss-ga] ep 8 it 222 total=-2.5885 ce_r=0.0210 ce_f=13.0477
[loss-ga] ep 8 it 272 total=-2.2226 ce_r=0.0316 ce_f=11.2709
[loss-ga] ep 8 it 322 total=-3.3144 ce_r=0.0365 ce_f=16.7545
[loss-ga] ep 8 it 372 total=-2.4319 ce_r=0.0564 ce_f=12.4417
[loss-ga] ep 9 it 31 total=-1.7866 ce_r=0.0184 ce_f=9.0246
[loss-ga] ep 9 it 81 total=-0.7403 ce_r=0.0386 ce_f=3.8948
[loss-ga] ep 9 it 131 total=-1.9736 ce_r=0.0369 ce_f=10.0521
[loss-ga] ep 9 it 181 total=-1.9512 ce_r=0.0569 ce_f=10.0407
[loss-ga] ep 9 it 231 total=-3.2479 ce_r=0.0597 ce_f=16.5378
[loss-ga] ep 9 it 281 total=-1.6429 ce_r=0.0414 ce_f=8.4217
[loss-ga] ep 9 it 331 total=-2.3067 ce_r=0.0560 ce_f=11.8136
[loss-ga] ep 9 it 381 total=-2.6644 ce_r=0.0150 ce_f=13.3970
[loss-ga] ep 10 it 40 total=-3.2749 ce_r=0.0578 ce_f=16.6634
[loss-ga] ep 10 it 90 total=-2.7042 ce_r=0.0331 ce_f=13.6867
[loss-ga] ep 10 it 140 total=-2.8426 ce_r=0.0362 ce_f=14.3945
[loss-ga] ep 10 it 190 total=-2.7997 ce_r=0.0238 ce_f=14.1176
[loss-ga] ep 10 it 240 total=-2.6925 ce_r=0.0507 ce_f=13.7163
[loss-ga] ep 10 it 290 total=-3.2912 ce_r=0.0427 ce_f=16.6693
[loss-ga] ep 10 it 340 total=-2.9428 ce_r=0.0793 ce_f=15.1107
[loss-ga] ep 10 it 390 total=-2.6715 ce_r=0.1166 ce_f=13.9408
[loss-ga] ep 11 it 49 total=-3.1744 ce_r=0.0468 ce_f=16.1060
[loss-ga] ep 11 it 99 total=-3.2155 ce_r=0.0349 ce_f=16.2521
[loss-ga] ep 11 it 149 total=-3.1391 ce_r=0.0522 ce_f=15.9565
[loss-ga] ep 11 it 199 total=-2.8440 ce_r=0.0669 ce_f=14.5546
[loss-ga] ep 11 it 249 total=-2.6089 ce_r=0.0903 ce_f=13.4960
[loss-ga] ep 11 it 299 total=-3.4155 ce_r=0.0326 ce_f=17.2407
[loss-ga] ep 11 it 349 total=-2.8293 ce_r=0.0444 ce_f=14.3681
[loss-ga] ep 12 it 8 total=-2.9345 ce_r=0.0485 ce_f=14.9150
[loss-ga] ep 12 it 58 total=-3.1610 ce_r=0.0486 ce_f=16.0479
[loss-ga] ep 12 it 108 total=-3.3332 ce_r=0.0425 ce_f=16.8786
[loss-ga] ep 12 it 158 total=-2.9488 ce_r=0.1085 ce_f=15.2866
[loss-ga] ep 12 it 208 total=-3.1560 ce_r=0.0567 ce_f=16.0635
[loss-ga] ep 12 it 258 total=-3.3075 ce_r=0.0155 ce_f=16.6151
[loss-ga] ep 12 it 308 total=-3.1452 ce_r=0.0176 ce_f=15.8141
[loss-ga] ep 12 it 358 total=-3.1332 ce_r=0.0643 ce_f=15.9872
[loss-ga] ep 13 it 17 total=-3.2124 ce_r=0.0285 ce_f=16.2043
[loss-ga] ep 13 it 67 total=-3.1255 ce_r=0.0459 ce_f=15.8572
[loss-ga] ep 13 it 117 total=-3.2900 ce_r=0.0202 ce_f=16.5512
[loss-ga] ep 13 it 167 total=-3.2509 ce_r=0.0674 ce_f=16.5917
[loss-ga] ep 13 it 217 total=-3.3129 ce_r=0.0308 ce_f=16.7182
[loss-ga] ep 13 it 267 total=-3.1269 ce_r=0.0404 ce_f=15.8365
[loss-ga] ep 13 it 317 total=-3.3040 ce_r=0.0132 ce_f=16.5859
[loss-ga] ep 13 it 367 total=-3.1420 ce_r=0.0871 ce_f=16.1457
[loss-ga] ep 14 it 26 total=-3.0831 ce_r=0.0276 ce_f=15.5537
[loss-ga] ep 14 it 76 total=-3.3034 ce_r=0.0654 ce_f=16.8437
[loss-ga] ep 14 it 126 total=-3.4213 ce_r=0.0161 ce_f=17.1870
[loss-ga] ep 14 it 176 total=-3.3787 ce_r=0.0313 ce_f=17.0497
[loss-ga] ep 14 it 226 total=-3.2358 ce_r=0.0265 ce_f=16.3118
[loss-ga] ep 14 it 276 total=-3.3172 ce_r=0.0281 ce_f=16.7265
[loss-ga] ep 14 it 326 total=-3.2343 ce_r=0.0885 ce_f=16.6144
[loss-ga] ep 14 it 376 total=-3.2922 ce_r=0.0535 ce_f=16.7286
[loss-ga] ep 15 it 35 total=-2.6426 ce_r=0.0527 ce_f=13.4765
[loss-ga] ep 15 it 85 total=-3.2324 ce_r=0.0252 ce_f=16.2877
[loss-ga] ep 15 it 135 total=-3.3680 ce_r=0.0340 ce_f=17.0098
[loss-ga] ep 15 it 185 total=-3.4317 ce_r=0.0229 ce_f=17.2730
[loss-ga] ep 15 it 235 total=-3.2432 ce_r=0.0371 ce_f=16.4015
[loss-ga] ep 15 it 285 total=-3.3536 ce_r=0.1453 ce_f=17.4947
[loss-ga] ep 15 it 335 total=-3.3956 ce_r=0.0134 ce_f=17.0452
[loss-ga] ep 15 it 385 total=-3.3367 ce_r=0.0402 ce_f=16.8848
[loss-ga] ep 16 it 44 total=-3.6428 ce_r=0.0629 ce_f=18.5286
[loss-ga] ep 16 it 94 total=-3.1057 ce_r=0.0544 ce_f=15.8006
[loss-ga] ep 16 it 144 total=-3.1188 ce_r=0.0408 ce_f=15.7983
[loss-ga] ep 16 it 194 total=-3.3200 ce_r=0.0391 ce_f=16.7957
[loss-ga] ep 16 it 244 total=-3.2765 ce_r=0.0500 ce_f=16.6326
[loss-ga] ep 16 it 294 total=-3.6450 ce_r=0.0179 ce_f=18.3142
[loss-ga] ep 16 it 344 total=-3.3005 ce_r=0.0235 ce_f=16.6198
[loss-ga] ep 17 it 3 total=-3.3445 ce_r=0.0558 ce_f=17.0016
[loss-ga] ep 17 it 53 total=-3.0798 ce_r=0.0747 ce_f=15.7724
 36%|███▌      | 18/50 [05:08<08:18, 15.58s/it] 38%|███▊      | 19/50 [05:25<08:09, 15.79s/it] 40%|████      | 20/50 [05:43<08:12, 16.42s/it] 42%|████▏     | 21/50 [05:57<07:42, 15.94s/it] 44%|████▍     | 22/50 [06:14<07:28, 16.00s/it] 46%|████▌     | 23/50 [06:30<07:15, 16.14s/it] 48%|████▊     | 24/50 [06:46<06:56, 16.04s/it] 50%|█████     | 25/50 [07:02<06:43, 16.14s/it] 52%|█████▏    | 26/50 [07:17<06:21, 15.88s/it] 54%|█████▍    | 27/50 [07:33<06:00, 15.67s/it] 56%|█████▌    | 28/50 [07:48<05:44, 15.64s/it] 58%|█████▊    | 29/50 [08:04<05:28, 15.62s/it] 60%|██████    | 30/50 [08:22<05:26, 16.31s/it] 62%|██████▏   | 31/50 [08:38<05:08, 16.23s/it] 64%|██████▍   | 32/50 [08:53<04:44, 15.83s/it] 66%|██████▌   | 33/50 [09:08<04:24, 15.55s/it] 68%|██████▊   | 34/50 [09:22<04:04, 15.28s/it][loss-ga] ep 17 it 103 total=-3.3859 ce_r=0.0368 ce_f=17.1133
[loss-ga] ep 17 it 153 total=-3.3141 ce_r=0.0322 ce_f=16.7319
[loss-ga] ep 17 it 203 total=-3.2390 ce_r=0.0812 ce_f=16.6010
[loss-ga] ep 17 it 253 total=-3.4295 ce_r=0.0185 ce_f=17.2400
[loss-ga] ep 17 it 303 total=-3.3034 ce_r=0.0152 ce_f=16.5934
[loss-ga] ep 17 it 353 total=-3.3738 ce_r=0.0233 ce_f=16.9853
[loss-ga] ep 18 it 12 total=-3.4586 ce_r=0.0388 ce_f=17.4869
[loss-ga] ep 18 it 62 total=-3.2593 ce_r=0.0187 ce_f=16.3897
[loss-ga] ep 18 it 112 total=-3.2492 ce_r=0.0291 ce_f=16.3916
[loss-ga] ep 18 it 162 total=-3.0202 ce_r=0.0340 ce_f=15.2708
[loss-ga] ep 18 it 212 total=-3.0961 ce_r=0.0398 ce_f=15.6795
[loss-ga] ep 18 it 262 total=-3.1596 ce_r=0.0585 ce_f=16.0907
[loss-ga] ep 18 it 312 total=-3.2361 ce_r=0.0757 ce_f=16.5592
[loss-ga] ep 18 it 362 total=-3.1652 ce_r=0.0364 ce_f=16.0081
[loss-ga] ep 19 it 21 total=-3.5814 ce_r=0.0237 ce_f=18.0255
[loss-ga] ep 19 it 71 total=-3.3127 ce_r=0.0315 ce_f=16.7209
[loss-ga] ep 19 it 121 total=-3.3711 ce_r=0.0311 ce_f=17.0106
[loss-ga] ep 19 it 171 total=-3.3551 ce_r=0.0209 ce_f=16.8798
[loss-ga] ep 19 it 221 total=-3.2335 ce_r=0.0313 ce_f=16.3240
[loss-ga] ep 19 it 271 total=-3.1904 ce_r=0.0712 ce_f=16.3080
[loss-ga] ep 19 it 321 total=-3.1134 ce_r=0.1149 ce_f=16.1413
[loss-ga] ep 19 it 371 total=-3.2574 ce_r=0.0576 ce_f=16.5747
[loss-ga] ep 20 it 30 total=-3.3650 ce_r=0.0084 ce_f=16.8674
[loss-ga] ep 20 it 80 total=-3.2169 ce_r=0.0208 ce_f=16.1881
[loss-ga] ep 20 it 130 total=-3.2946 ce_r=0.0256 ce_f=16.6011
[loss-ga] ep 20 it 180 total=-3.5096 ce_r=0.0205 ce_f=17.6505
[loss-ga] ep 20 it 230 total=-3.2845 ce_r=0.0420 ce_f=16.6323
[loss-ga] ep 20 it 280 total=-3.3076 ce_r=0.0382 ce_f=16.7292
[loss-ga] ep 20 it 330 total=-3.3019 ce_r=0.0191 ce_f=16.6051
[loss-ga] ep 20 it 380 total=-3.1824 ce_r=0.0549 ce_f=16.1862
[loss-ga] ep 21 it 39 total=-3.2683 ce_r=0.0158 ce_f=16.4203
[loss-ga] ep 21 it 89 total=-3.1869 ce_r=0.1048 ce_f=16.4585
[loss-ga] ep 21 it 139 total=-3.4364 ce_r=0.0361 ce_f=17.3628
[loss-ga] ep 21 it 189 total=-3.2889 ce_r=0.0667 ce_f=16.7780
[loss-ga] ep 21 it 239 total=-3.3402 ce_r=0.0235 ce_f=16.8184
[loss-ga] ep 21 it 289 total=-3.5396 ce_r=0.0544 ce_f=17.9701
[loss-ga] ep 21 it 339 total=-3.2920 ce_r=0.0162 ce_f=16.5410
[loss-ga] ep 21 it 389 total=-3.3846 ce_r=0.0147 ce_f=16.9963
[loss-ga] ep 22 it 48 total=-3.2306 ce_r=0.0405 ce_f=16.3556
[loss-ga] ep 22 it 98 total=-3.3259 ce_r=0.0337 ce_f=16.7981
[loss-ga] ep 22 it 148 total=-3.3179 ce_r=0.0464 ce_f=16.8214
[loss-ga] ep 22 it 198 total=-3.1274 ce_r=0.0607 ce_f=15.9407
[loss-ga] ep 22 it 248 total=-3.1457 ce_r=0.0235 ce_f=15.8458
[loss-ga] ep 22 it 298 total=-3.1342 ce_r=0.0290 ce_f=15.8159
[loss-ga] ep 22 it 348 total=-3.3773 ce_r=0.0261 ce_f=17.0169
[loss-ga] ep 23 it 7 total=-3.4368 ce_r=0.0252 ce_f=17.3098
[loss-ga] ep 23 it 57 total=-3.2994 ce_r=0.0206 ce_f=16.5998
[loss-ga] ep 23 it 107 total=-3.4576 ce_r=0.0478 ce_f=17.5273
[loss-ga] ep 23 it 157 total=-3.0189 ce_r=0.0603 ce_f=15.3961
[loss-ga] ep 23 it 207 total=-3.3725 ce_r=0.0115 ce_f=16.9200
[loss-ga] ep 23 it 257 total=-3.2856 ce_r=0.0316 ce_f=16.5861
[loss-ga] ep 23 it 307 total=-3.2811 ce_r=0.0286 ce_f=16.5488
[loss-ga] ep 23 it 357 total=-3.2114 ce_r=0.1166 ce_f=16.6401
[loss-ga] ep 24 it 16 total=-3.0863 ce_r=0.0356 ce_f=15.6096
[loss-ga] ep 24 it 66 total=-3.2380 ce_r=0.1556 ce_f=16.9680
[loss-ga] ep 24 it 116 total=-3.2614 ce_r=0.0154 ce_f=16.3843
[loss-ga] ep 24 it 166 total=-3.3971 ce_r=0.0169 ce_f=17.0700
[loss-ga] ep 24 it 216 total=-3.4464 ce_r=0.0631 ce_f=17.5479
[loss-ga] ep 24 it 266 total=-3.3415 ce_r=0.0373 ce_f=16.8941
[loss-ga] ep 24 it 316 total=-3.3296 ce_r=0.0217 ce_f=16.7564
[loss-ga] ep 24 it 366 total=-3.3246 ce_r=0.0331 ce_f=16.7883
[loss-ga] ep 25 it 25 total=-3.1872 ce_r=0.0308 ce_f=16.0900
[loss-ga] ep 25 it 75 total=-3.4408 ce_r=0.0160 ce_f=17.2838
[loss-ga] ep 25 it 125 total=-3.1537 ce_r=0.1026 ce_f=16.2815
[loss-ga] ep 25 it 175 total=-3.4129 ce_r=0.0149 ce_f=17.1395
[loss-ga] ep 25 it 225 total=-3.2994 ce_r=0.0365 ce_f=16.6795
[loss-ga] ep 25 it 275 total=-3.3463 ce_r=0.0319 ce_f=16.8908
[loss-ga] ep 25 it 325 total=-3.2078 ce_r=0.0189 ce_f=16.1333
[loss-ga] ep 25 it 375 total=-3.6749 ce_r=0.0152 ce_f=18.4506
[loss-ga] ep 26 it 34 total=-3.4277 ce_r=0.0478 ce_f=17.3772
[loss-ga] ep 26 it 84 total=-3.3962 ce_r=0.0159 ce_f=17.0604
[loss-ga] ep 26 it 134 total=-3.2896 ce_r=0.0166 ce_f=16.5309
[loss-ga] ep 26 it 184 total=-3.2119 ce_r=0.0172 ce_f=16.1458
[loss-ga] ep 26 it 234 total=-3.4669 ce_r=0.0420 ce_f=17.5446
[loss-ga] ep 26 it 284 total=-3.3203 ce_r=0.0176 ce_f=16.6895
[loss-ga] ep 26 it 334 total=-3.3106 ce_r=0.0693 ce_f=16.8994
[loss-ga] ep 26 it 384 total=-3.2766 ce_r=0.0058 ce_f=16.4119
[loss-ga] ep 27 it 43 total=-3.3904 ce_r=0.0212 ce_f=17.0580
[loss-ga] ep 27 it 93 total=-3.2703 ce_r=0.0168 ce_f=16.4355
[loss-ga] ep 27 it 143 total=-3.7036 ce_r=0.0235 ce_f=18.6354
[loss-ga] ep 27 it 193 total=-3.3994 ce_r=0.0120 ce_f=17.0571
[loss-ga] ep 27 it 243 total=-3.4634 ce_r=0.0228 ce_f=17.4311
[loss-ga] ep 27 it 293 total=-3.1015 ce_r=0.0511 ce_f=15.7629
[loss-ga] ep 27 it 343 total=-3.3688 ce_r=0.0272 ce_f=16.9799
[loss-ga] ep 28 it 2 total=-3.2908 ce_r=0.0202 ce_f=16.5548
[loss-ga] ep 28 it 52 total=-3.1232 ce_r=0.0700 ce_f=15.9663
[loss-ga] ep 28 it 102 total=-3.4317 ce_r=0.0293 ce_f=17.3052
[loss-ga] ep 28 it 152 total=-3.1926 ce_r=0.0354 ce_f=16.1396
[loss-ga] ep 28 it 202 total=-3.5044 ce_r=0.0700 ce_f=17.8719
[loss-ga] ep 28 it 252 total=-3.5332 ce_r=0.0443 ce_f=17.8874
[loss-ga] ep 28 it 302 total=-3.3794 ce_r=0.0250 ce_f=17.0218
[loss-ga] ep 28 it 352 total=-3.1695 ce_r=0.0176 ce_f=15.9353
[loss-ga] ep 29 it 11 total=-3.3888 ce_r=0.0092 ce_f=16.9899
[loss-ga] ep 29 it 61 total=-3.0880 ce_r=0.0174 ce_f=15.5272
[loss-ga] ep 29 it 111 total=-3.3820 ce_r=0.0440 ce_f=17.1301
[loss-ga] ep 29 it 161 total=-3.2945 ce_r=0.0115 ce_f=16.5302
[loss-ga] ep 29 it 211 total=-3.1058 ce_r=0.0631 ce_f=15.8445
[loss-ga] ep 29 it 261 total=-3.2384 ce_r=0.0479 ce_f=16.4315
[loss-ga] ep 29 it 311 total=-3.3647 ce_r=0.0179 ce_f=16.9128
[loss-ga] ep 29 it 361 total=-3.2543 ce_r=0.0159 ce_f=16.3511
[loss-ga] ep 30 it 20 total=-3.2185 ce_r=0.0457 ce_f=16.3207
[loss-ga] ep 30 it 70 total=-3.4276 ce_r=0.0232 ce_f=17.2541
[loss-ga] ep 30 it 120 total=-3.4236 ce_r=0.0589 ce_f=17.4125
[loss-ga] ep 30 it 170 total=-3.2826 ce_r=0.0095 ce_f=16.4607
[loss-ga] ep 30 it 220 total=-3.6174 ce_r=0.0206 ce_f=18.1901
[loss-ga] ep 30 it 270 total=-3.4667 ce_r=0.0178 ce_f=17.4223
[loss-ga] ep 30 it 320 total=-3.3574 ce_r=0.0379 ce_f=16.9765
[loss-ga] ep 30 it 370 total=-3.2521 ce_r=0.0168 ce_f=16.3442
[loss-ga] ep 31 it 29 total=-3.4079 ce_r=0.0171 ce_f=17.1250
[loss-ga] ep 31 it 79 total=-3.3879 ce_r=0.0658 ce_f=17.2682
[loss-ga] ep 31 it 129 total=-3.2614 ce_r=0.0180 ce_f=16.3974
[loss-ga] ep 31 it 179 total=-3.3154 ce_r=0.0112 ce_f=16.6330
[loss-ga] ep 31 it 229 total=-3.3472 ce_r=0.0124 ce_f=16.7979
[loss-ga] ep 31 it 279 total=-3.3708 ce_r=0.0652 ce_f=17.1800
[loss-ga] ep 31 it 329 total=-3.2591 ce_r=0.0546 ce_f=16.5682
[loss-ga] ep 31 it 379 total=-3.6000 ce_r=0.0290 ce_f=18.1447
[loss-ga] ep 32 it 38 total=-3.3312 ce_r=0.0127 ce_f=16.7194
[loss-ga] ep 32 it 88 total=-3.1596 ce_r=0.0393 ce_f=15.9948
[loss-ga] ep 32 it 138 total=-3.4794 ce_r=0.0407 ce_f=17.6005
[loss-ga] ep 32 it 188 total=-3.2173 ce_r=0.0090 ce_f=16.1319
[loss-ga] ep 32 it 238 total=-3.3673 ce_r=0.0199 ce_f=16.9359
[loss-ga] ep 32 it 288 total=-3.3868 ce_r=0.0095 ce_f=16.9813
[loss-ga] ep 32 it 338 total=-3.4812 ce_r=0.0804 ce_f=17.8081
[loss-ga] ep 32 it 388 total=-3.3584 ce_r=0.0256 ce_f=16.9198
[loss-ga] ep 33 it 47 total=-3.4794 ce_r=0.0373 ce_f=17.5832
[loss-ga] ep 33 it 97 total=-3.3443 ce_r=0.0151 ce_f=16.7971
[loss-ga] ep 33 it 147 total=-3.3782 ce_r=0.0175 ce_f=16.9785
[loss-ga] ep 33 it 197 total=-3.2928 ce_r=0.0656 ce_f=16.7919
[loss-ga] ep 33 it 247 total=-3.2927 ce_r=0.0634 ce_f=16.7807
[loss-ga] ep 33 it 297 total=-3.2240 ce_r=0.0208 ce_f=16.2237
[loss-ga] ep 33 it 347 total=-3.0457 ce_r=0.0763 ce_f=15.6100
[loss-ga] ep 34 it 6 total=-3.3430 ce_r=0.0198 ce_f=16.8139
 70%|███████   | 35/50 [09:37<03:46, 15.07s/it] 72%|███████▏  | 36/50 [09:52<03:31, 15.13s/it] 74%|███████▍  | 37/50 [10:08<03:18, 15.31s/it] 76%|███████▌  | 38/50 [10:24<03:08, 15.70s/it] 78%|███████▊  | 39/50 [10:42<02:57, 16.18s/it] 80%|████████  | 40/50 [10:57<02:40, 16.03s/it] 82%|████████▏ | 41/50 [11:13<02:23, 15.93s/it] 84%|████████▍ | 42/50 [11:28<02:05, 15.64s/it] 86%|████████▌ | 43/50 [11:45<01:51, 15.90s/it] 88%|████████▊ | 44/50 [12:00<01:34, 15.82s/it] 90%|█████████ | 45/50 [12:17<01:20, 16.09s/it] 92%|█████████▏| 46/50 [12:33<01:03, 15.96s/it] 94%|█████████▍| 47/50 [12:48<00:47, 15.91s/it] 96%|█████████▌| 48/50 [13:04<00:31, 15.92s/it] 98%|█████████▊| 49/50 [13:20<00:15, 15.80s/it]100%|██████████| 50/50 [13:36<00:00, 15.93s/it]100%|██████████| 50/50 [13:36<00:00, 16.33s/it]
[loss-ga] ep 34 it 56 total=-3.3603 ce_r=0.0498 ce_f=17.0508
[loss-ga] ep 34 it 106 total=-3.3752 ce_r=0.0130 ce_f=16.9408
[loss-ga] ep 34 it 156 total=-3.0905 ce_r=0.0131 ce_f=15.5185
[loss-ga] ep 34 it 206 total=-3.2785 ce_r=0.0096 ce_f=16.4407
[loss-ga] ep 34 it 256 total=-3.1213 ce_r=0.0204 ce_f=15.7087
[loss-ga] ep 34 it 306 total=-3.2004 ce_r=0.0177 ce_f=16.0908
[loss-ga] ep 34 it 356 total=-3.3673 ce_r=0.0181 ce_f=16.9273
[loss-ga] ep 35 it 15 total=-3.5135 ce_r=0.0203 ce_f=17.6691
[loss-ga] ep 35 it 65 total=-3.3713 ce_r=0.0192 ce_f=16.9527
[loss-ga] ep 35 it 115 total=-3.3386 ce_r=0.0296 ce_f=16.8409
[loss-ga] ep 35 it 165 total=-3.0779 ce_r=0.0182 ce_f=15.4807
[loss-ga] ep 35 it 215 total=-3.3795 ce_r=0.0174 ce_f=16.9843
[loss-ga] ep 35 it 265 total=-3.2278 ce_r=0.1041 ce_f=16.6596
[loss-ga] ep 35 it 315 total=-3.4185 ce_r=0.0304 ce_f=17.2446
[loss-ga] ep 35 it 365 total=-3.5775 ce_r=0.0169 ce_f=17.9722
[loss-ga] ep 36 it 24 total=-3.4192 ce_r=0.0153 ce_f=17.1724
[loss-ga] ep 36 it 74 total=-3.4309 ce_r=0.0645 ce_f=17.4771
[loss-ga] ep 36 it 124 total=-3.1742 ce_r=0.0334 ce_f=16.0382
[loss-ga] ep 36 it 174 total=-3.4597 ce_r=0.0214 ce_f=17.4055
[loss-ga] ep 36 it 224 total=-3.4608 ce_r=0.0213 ce_f=17.4105
[loss-ga] ep 36 it 274 total=-3.2910 ce_r=0.0130 ce_f=16.5201
[loss-ga] ep 36 it 324 total=-3.3050 ce_r=0.0127 ce_f=16.5882
[loss-ga] ep 36 it 374 total=-3.3146 ce_r=0.0537 ce_f=16.8418
[loss-ga] ep 37 it 33 total=-3.1502 ce_r=0.0155 ce_f=15.8289
[loss-ga] ep 37 it 83 total=-3.1586 ce_r=0.0183 ce_f=15.8846
[loss-ga] ep 37 it 133 total=-3.4211 ce_r=0.0481 ce_f=17.3459
[loss-ga] ep 37 it 183 total=-3.5508 ce_r=0.0413 ce_f=17.9603
[loss-ga] ep 37 it 233 total=-3.3475 ce_r=0.0270 ce_f=16.8727
[loss-ga] ep 37 it 283 total=-3.5953 ce_r=0.0308 ce_f=18.1306
[loss-ga] ep 37 it 333 total=-3.1190 ce_r=0.0662 ce_f=15.9261
[loss-ga] ep 37 it 383 total=-3.3656 ce_r=0.0572 ce_f=17.1140
[loss-ga] ep 38 it 42 total=-3.5189 ce_r=0.0558 ce_f=17.8737
[loss-ga] ep 38 it 92 total=-3.2248 ce_r=0.0190 ce_f=16.2190
[loss-ga] ep 38 it 142 total=-2.9328 ce_r=0.0521 ce_f=14.9248
[loss-ga] ep 38 it 192 total=-3.2567 ce_r=0.0238 ce_f=16.4028
[loss-ga] ep 38 it 242 total=-3.4603 ce_r=0.0261 ce_f=17.4323
[loss-ga] ep 38 it 292 total=-3.2376 ce_r=0.0260 ce_f=16.3177
[loss-ga] ep 38 it 342 total=-3.2745 ce_r=0.0300 ce_f=16.5222
[loss-ga] ep 39 it 1 total=-3.4758 ce_r=0.0850 ce_f=17.8038
[loss-ga] ep 39 it 51 total=-3.2511 ce_r=0.0161 ce_f=16.3358
[loss-ga] ep 39 it 101 total=-3.2169 ce_r=0.0797 ce_f=16.4831
[loss-ga] ep 39 it 151 total=-3.4188 ce_r=0.0992 ce_f=17.5899
[loss-ga] ep 39 it 201 total=-3.4227 ce_r=0.0453 ce_f=17.3403
[loss-ga] ep 39 it 251 total=-3.2764 ce_r=0.0149 ce_f=16.4566
[loss-ga] ep 39 it 301 total=-3.3911 ce_r=0.0485 ce_f=17.1977
[loss-ga] ep 39 it 351 total=-3.2940 ce_r=0.0094 ce_f=16.5172
[loss-ga] ep 40 it 10 total=-3.5459 ce_r=0.0271 ce_f=17.8649
[loss-ga] ep 40 it 60 total=-3.1621 ce_r=0.1035 ce_f=16.3283
[loss-ga] ep 40 it 110 total=-3.1271 ce_r=0.0126 ce_f=15.6987
[loss-ga] ep 40 it 160 total=-3.6991 ce_r=0.0384 ce_f=18.6875
[loss-ga] ep 40 it 210 total=-3.2881 ce_r=0.0633 ce_f=16.7570
[loss-ga] ep 40 it 260 total=-3.4278 ce_r=0.0321 ce_f=17.2994
[loss-ga] ep 40 it 310 total=-3.3897 ce_r=0.0210 ce_f=17.0532
[loss-ga] ep 40 it 360 total=-3.4724 ce_r=0.0174 ce_f=17.4490
[loss-ga] ep 41 it 19 total=-3.4015 ce_r=0.0519 ce_f=17.2672
[loss-ga] ep 41 it 69 total=-3.5175 ce_r=0.0380 ce_f=17.7773
[loss-ga] ep 41 it 119 total=-3.3458 ce_r=0.0199 ce_f=16.8287
[loss-ga] ep 41 it 169 total=-3.2869 ce_r=0.0581 ce_f=16.7253
[loss-ga] ep 41 it 219 total=-3.2359 ce_r=0.0161 ce_f=16.2599
[loss-ga] ep 41 it 269 total=-3.4424 ce_r=0.0644 ce_f=17.5337
[loss-ga] ep 41 it 319 total=-3.5927 ce_r=0.0098 ce_f=18.0128
[loss-ga] ep 41 it 369 total=-3.2104 ce_r=0.0210 ce_f=16.1567
[loss-ga] ep 42 it 28 total=-3.3634 ce_r=0.0092 ce_f=16.8633
[loss-ga] ep 42 it 78 total=-3.4460 ce_r=0.0176 ce_f=17.3182
[loss-ga] ep 42 it 128 total=-3.4453 ce_r=0.0486 ce_f=17.4699
[loss-ga] ep 42 it 178 total=-3.5211 ce_r=0.0150 ce_f=17.6803
[loss-ga] ep 42 it 228 total=-3.2790 ce_r=0.0681 ce_f=16.7353
[loss-ga] ep 42 it 278 total=-3.0851 ce_r=0.0556 ce_f=15.7036
[loss-ga] ep 42 it 328 total=-3.3619 ce_r=0.1533 ce_f=17.5760
[loss-ga] ep 42 it 378 total=-3.4131 ce_r=0.0201 ce_f=17.1661
[loss-ga] ep 43 it 37 total=-3.6035 ce_r=0.0684 ce_f=18.3596
[loss-ga] ep 43 it 87 total=-3.3316 ce_r=0.0421 ce_f=16.8683
[loss-ga] ep 43 it 137 total=-3.2585 ce_r=0.0454 ce_f=16.5197
[loss-ga] ep 43 it 187 total=-3.3707 ce_r=0.0482 ce_f=17.0943
[loss-ga] ep 43 it 237 total=-3.4522 ce_r=0.0195 ce_f=17.3586
[loss-ga] ep 43 it 287 total=-3.2783 ce_r=0.0715 ce_f=16.7492
[loss-ga] ep 43 it 337 total=-3.5252 ce_r=0.0151 ce_f=17.7014
[loss-ga] ep 43 it 387 total=-3.2329 ce_r=0.0141 ce_f=16.2350
[loss-ga] ep 44 it 46 total=-2.9989 ce_r=0.0428 ce_f=15.2084
[loss-ga] ep 44 it 96 total=-3.3776 ce_r=0.0523 ce_f=17.1495
[loss-ga] ep 44 it 146 total=-3.3789 ce_r=0.0100 ce_f=16.9445
[loss-ga] ep 44 it 196 total=-3.5261 ce_r=0.0156 ce_f=17.7083
[loss-ga] ep 44 it 246 total=-3.3350 ce_r=0.0535 ce_f=16.9423
[loss-ga] ep 44 it 296 total=-3.4635 ce_r=0.0536 ce_f=17.5855
[loss-ga] ep 44 it 346 total=-3.2503 ce_r=0.0123 ce_f=16.3130
[loss-ga] ep 45 it 5 total=-3.4231 ce_r=0.0261 ce_f=17.2458
[loss-ga] ep 45 it 55 total=-3.3275 ce_r=0.0794 ce_f=17.0348
[loss-ga] ep 45 it 105 total=-3.6120 ce_r=0.0113 ce_f=18.1165
[loss-ga] ep 45 it 155 total=-3.2557 ce_r=0.0055 ce_f=16.3062
[loss-ga] ep 45 it 205 total=-3.1536 ce_r=0.0442 ce_f=15.9891
[loss-ga] ep 45 it 255 total=-3.2674 ce_r=0.0739 ce_f=16.7067
[loss-ga] ep 45 it 305 total=-3.2889 ce_r=0.0599 ce_f=16.7439
[loss-ga] ep 45 it 355 total=-3.8608 ce_r=0.0866 ce_f=19.7369
[loss-ga] ep 46 it 14 total=-3.2819 ce_r=0.0427 ce_f=16.6228
[loss-ga] ep 46 it 64 total=-3.2039 ce_r=0.0537 ce_f=16.2880
[loss-ga] ep 46 it 114 total=-3.5527 ce_r=0.0075 ce_f=17.8010
[loss-ga] ep 46 it 164 total=-3.4235 ce_r=0.0428 ce_f=17.3316
[loss-ga] ep 46 it 214 total=-3.2981 ce_r=0.1739 ce_f=17.3604
[loss-ga] ep 46 it 264 total=-3.1965 ce_r=0.0185 ce_f=16.0747
[loss-ga] ep 46 it 314 total=-3.4301 ce_r=0.0072 ce_f=17.1864
[loss-ga] ep 46 it 364 total=-3.4207 ce_r=0.0217 ce_f=17.2122
[loss-ga] ep 47 it 23 total=-3.4823 ce_r=0.0209 ce_f=17.5158
[loss-ga] ep 47 it 73 total=-3.3283 ce_r=0.0066 ce_f=16.6747
[loss-ga] ep 47 it 123 total=-3.1932 ce_r=0.0741 ce_f=16.3362
[loss-ga] ep 47 it 173 total=-3.2387 ce_r=0.0152 ce_f=16.2694
[loss-ga] ep 47 it 223 total=-3.3131 ce_r=0.0272 ce_f=16.7014
[loss-ga] ep 47 it 273 total=0.0427 ce_r=0.0427 ce_f=0.0000
[loss-ga] ep 47 it 323 total=-3.3333 ce_r=0.0054 ce_f=16.6934
[loss-ga] ep 47 it 373 total=-3.1837 ce_r=0.0185 ce_f=16.0112
[loss-ga] ep 48 it 32 total=-3.3461 ce_r=0.0247 ce_f=16.8541
[loss-ga] ep 48 it 82 total=-3.2674 ce_r=0.0563 ce_f=16.6187
[loss-ga] ep 48 it 132 total=-3.3756 ce_r=0.0260 ce_f=17.0083
[loss-ga] ep 48 it 182 total=-3.3577 ce_r=0.0097 ce_f=16.8368
[loss-ga] ep 48 it 232 total=-3.2575 ce_r=0.0192 ce_f=16.3832
[loss-ga] ep 48 it 282 total=-3.3414 ce_r=0.0070 ce_f=16.7417
[loss-ga] ep 48 it 332 total=-3.5010 ce_r=0.0223 ce_f=17.6165
[loss-ga] ep 48 it 382 total=-3.3687 ce_r=0.0173 ce_f=16.9298
[loss-ga] ep 49 it 41 total=-3.4110 ce_r=0.0168 ce_f=17.1390
[loss-ga] ep 49 it 91 total=-3.1832 ce_r=0.0344 ce_f=16.0877
[loss-ga] ep 49 it 141 total=-3.4383 ce_r=0.0093 ce_f=17.2379
[loss-ga] ep 49 it 191 total=-3.5455 ce_r=0.0109 ce_f=17.7823
[loss-ga] ep 49 it 241 total=-3.4306 ce_r=0.0112 ce_f=17.2091
[loss-ga] ep 49 it 291 total=-3.3579 ce_r=0.0289 ce_f=16.9339
[loss-ga] ep 49 it 341 total=-3.2409 ce_r=0.0073 ce_f=16.2410
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1.pt
resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-inc1-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:10,  2.99it/s]  2%|▏         | 8/391 [00:00<00:17, 22.45it/s]  5%|▍         | 18/391 [00:00<00:08, 44.62it/s]  7%|▋         | 28/391 [00:00<00:06, 60.47it/s] 10%|▉         | 38/391 [00:00<00:04, 71.77it/s] 12%|█▏        | 48/391 [00:00<00:04, 79.08it/s] 15%|█▍        | 58/391 [00:00<00:03, 84.82it/s] 17%|█▋        | 68/391 [00:01<00:03, 88.83it/s] 20%|██        | 79/391 [00:01<00:03, 92.71it/s] 23%|██▎       | 90/391 [00:01<00:03, 95.31it/s] 26%|██▌       | 101/391 [00:01<00:02, 97.11it/s] 29%|██▊       | 112/391 [00:01<00:02, 98.49it/s] 31%|███▏      | 123/391 [00:01<00:02, 99.28it/s] 34%|███▍      | 134/391 [00:01<00:02, 99.94it/s] 37%|███▋      | 145/391 [00:01<00:02, 100.48it/s] 40%|███▉      | 156/391 [00:01<00:02, 100.68it/s] 43%|████▎     | 167/391 [00:02<00:02, 100.87it/s] 46%|████▌     | 178/391 [00:02<00:02, 100.78it/s] 48%|████▊     | 189/391 [00:02<00:02, 100.83it/s] 51%|█████     | 200/391 [00:02<00:01, 100.83it/s] 54%|█████▍    | 211/391 [00:02<00:01, 100.85it/s] 57%|█████▋    | 222/391 [00:02<00:01, 100.91it/s] 60%|█████▉    | 233/391 [00:02<00:01, 100.89it/s] 62%|██████▏   | 244/391 [00:02<00:01, 100.99it/s] 65%|██████▌   | 255/391 [00:02<00:01, 101.00it/s] 68%|██████▊   | 266/391 [00:03<00:01, 100.89it/s] 71%|███████   | 277/391 [00:03<00:01, 100.98it/s] 74%|███████▎  | 288/391 [00:03<00:01, 100.99it/s] 76%|███████▋  | 299/391 [00:03<00:00, 100.88it/s] 79%|███████▉  | 310/391 [00:03<00:00, 101.05it/s] 82%|████████▏ | 321/391 [00:03<00:00, 100.96it/s] 85%|████████▍ | 332/391 [00:03<00:00, 101.03it/s] 88%|████████▊ | 343/391 [00:03<00:00, 100.97it/s] 91%|█████████ | 354/391 [00:03<00:00, 101.09it/s] 93%|█████████▎| 365/391 [00:03<00:00, 100.91it/s] 96%|█████████▌| 376/391 [00:04<00:00, 101.41it/s] 99%|█████████▉| 387/391 [00:04<00:00, 101.74it/s]100%|██████████| 391/391 [00:04<00:00, 91.82it/s] 
50000 images processed, 4.339041233062744 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:28,  2.73it/s] 13%|█▎        | 10/79 [00:00<00:02, 27.12it/s] 25%|██▌       | 20/79 [00:00<00:01, 47.40it/s] 38%|███▊      | 30/79 [00:00<00:00, 61.82it/s] 51%|█████     | 40/79 [00:00<00:00, 72.09it/s] 63%|██████▎   | 50/79 [00:00<00:00, 78.74it/s] 76%|███████▌  | 60/79 [00:00<00:00, 83.29it/s] 89%|████████▊ | 70/79 [00:01<00:00, 87.82it/s]100%|██████████| 79/79 [00:01<00:00, 39.84it/s]
10000 images processed, 2.0252089500427246 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-inc1-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:21,  2.50it/s]  5%|▌         | 11/204 [00:00<00:06, 28.09it/s] 10%|█         | 21/204 [00:00<00:03, 47.34it/s] 16%|█▌        | 32/204 [00:00<00:02, 63.08it/s] 21%|██        | 42/204 [00:00<00:02, 72.68it/s] 25%|██▌       | 52/204 [00:00<00:01, 80.32it/s] 31%|███       | 63/204 [00:01<00:01, 86.43it/s] 36%|███▌      | 73/204 [00:01<00:01, 87.53it/s] 41%|████      | 83/204 [00:01<00:01, 89.53it/s] 46%|████▌     | 94/204 [00:01<00:01, 92.69it/s] 51%|█████     | 104/204 [00:01<00:01, 94.29it/s] 56%|█████▋    | 115/204 [00:01<00:00, 96.10it/s] 61%|██████▏   | 125/204 [00:01<00:00, 97.17it/s] 67%|██████▋   | 136/204 [00:01<00:00, 98.09it/s] 72%|███████▏  | 146/204 [00:01<00:00, 98.43it/s] 76%|███████▋  | 156/204 [00:01<00:00, 98.52it/s] 81%|████████▏ | 166/204 [00:02<00:00, 97.38it/s] 86%|████████▋ | 176/204 [00:02<00:00, 96.38it/s] 92%|█████████▏| 187/204 [00:02<00:00, 97.97it/s] 97%|█████████▋| 198/204 [00:02<00:00, 99.01it/s]100%|██████████| 204/204 [00:02<00:00, 82.68it/s]
26032 images processed, 2.5042340755462646 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.03it/s] 11%|█▏        | 9/79 [00:00<00:03, 19.25it/s] 23%|██▎       | 18/79 [00:00<00:01, 36.17it/s] 35%|███▌      | 28/79 [00:00<00:00, 51.63it/s] 49%|████▉     | 39/79 [00:00<00:00, 65.38it/s] 62%|██████▏   | 49/79 [00:01<00:00, 73.74it/s] 76%|███████▌  | 60/79 [00:01<00:00, 81.57it/s] 90%|████████▉ | 71/79 [00:01<00:00, 87.43it/s]100%|██████████| 79/79 [00:01<00:00, 60.27it/s]
10000 images processed, 1.3408401012420654 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.31it/s] 10%|█         | 8/79 [00:00<00:03, 19.04it/s] 23%|██▎       | 18/79 [00:00<00:01, 39.50it/s] 35%|███▌      | 28/79 [00:00<00:00, 55.33it/s] 48%|████▊     | 38/79 [00:00<00:00, 67.13it/s] 61%|██████    | 48/79 [00:00<00:00, 73.83it/s] 73%|███████▎  | 58/79 [00:01<00:00, 80.01it/s] 87%|████████▋ | 69/79 [00:01<00:00, 86.48it/s]100%|██████████| 79/79 [00:01<00:00, 62.52it/s]
10000 images processed, 1.286454439163208 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:29,  2.36it/s] 16%|█▌        | 11/70 [00:00<00:02, 26.53it/s] 30%|███       | 21/70 [00:00<00:01, 44.90it/s] 44%|████▍     | 31/70 [00:00<00:00, 58.98it/s] 59%|█████▊    | 41/70 [00:00<00:00, 69.42it/s] 74%|███████▍  | 52/70 [00:00<00:00, 78.75it/s] 90%|█████████ | 63/70 [00:01<00:00, 85.56it/s]100%|██████████| 70/70 [00:01<00:00, 61.70it/s]
8925 images processed, 1.1623964309692383 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:36,  1.19it/s] 11%|█         | 5/45 [00:00<00:05,  6.83it/s] 29%|██▉       | 13/45 [00:01<00:01, 19.37it/s] 40%|████      | 18/45 [00:01<00:01, 18.95it/s] 51%|█████     | 23/45 [00:01<00:01, 20.94it/s] 73%|███████▎  | 33/45 [00:01<00:00, 23.52it/s] 96%|█████████▌| 43/45 [00:01<00:00, 34.40it/s]100%|██████████| 45/45 [00:02<00:00, 22.42it/s]
5640 images processed, 2.0266425609588623 seconds used

16.32079815864563
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.85  98.75  96.54
places365     72.23  79.15  77.31
LSUN          33.17  92.77  92.81
iSUN          72.29  81.31  84.40
dtd           46.45  89.26  93.25
AVG           46.00  88.25  88.86
Retain-Acc: 0.7397
Forget-as-OOD (retain known vs forget novel):
  FPR: 82.20 AUROC: 74.35 AUIN: 98.06
7.6047258377075195
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1.pt
resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-seen-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:17,  2.84it/s]  2%|▏         | 8/391 [00:00<00:17, 21.73it/s]  5%|▍         | 18/391 [00:00<00:08, 43.34it/s]  7%|▋         | 28/391 [00:00<00:06, 58.42it/s] 10%|▉         | 38/391 [00:00<00:05, 69.27it/s] 12%|█▏        | 48/391 [00:00<00:04, 77.73it/s] 15%|█▌        | 59/391 [00:00<00:03, 84.70it/s] 18%|█▊        | 70/391 [00:01<00:03, 89.54it/s] 21%|██        | 81/391 [00:01<00:03, 92.78it/s] 24%|██▎       | 92/391 [00:01<00:03, 95.19it/s] 26%|██▋       | 103/391 [00:01<00:02, 96.84it/s] 29%|██▉       | 114/391 [00:01<00:02, 98.20it/s] 32%|███▏      | 125/391 [00:01<00:02, 99.00it/s] 35%|███▍      | 136/391 [00:01<00:02, 97.94it/s] 38%|███▊      | 147/391 [00:01<00:02, 98.73it/s] 40%|████      | 158/391 [00:01<00:02, 99.41it/s] 43%|████▎     | 169/391 [00:02<00:02, 99.85it/s] 46%|████▌     | 180/391 [00:02<00:02, 99.93it/s] 49%|████▉     | 191/391 [00:02<00:01, 100.18it/s] 52%|█████▏    | 202/391 [00:02<00:01, 100.38it/s] 54%|█████▍    | 213/391 [00:02<00:01, 100.36it/s] 57%|█████▋    | 224/391 [00:02<00:01, 100.55it/s] 60%|██████    | 235/391 [00:02<00:01, 100.48it/s] 63%|██████▎   | 246/391 [00:02<00:01, 100.67it/s] 66%|██████▌   | 257/391 [00:02<00:01, 100.66it/s] 69%|██████▊   | 268/391 [00:03<00:01, 100.40it/s] 71%|███████▏  | 279/391 [00:03<00:01, 100.47it/s] 74%|███████▍  | 290/391 [00:03<00:01, 100.55it/s] 77%|███████▋  | 301/391 [00:03<00:00, 100.70it/s] 80%|███████▉  | 312/391 [00:03<00:00, 100.68it/s] 83%|████████▎ | 323/391 [00:03<00:00, 99.94it/s]  85%|████████▌ | 333/391 [00:03<00:00, 90.72it/s] 88%|████████▊ | 343/391 [00:03<00:00, 83.58it/s] 90%|█████████ | 352/391 [00:04<00:00, 80.41it/s] 93%|█████████▎| 362/391 [00:04<00:00, 83.55it/s] 95%|█████████▌| 373/391 [00:04<00:00, 88.84it/s] 98%|█████████▊| 384/391 [00:04<00:00, 92.72it/s]100%|██████████| 391/391 [00:04<00:00, 88.43it/s]
50000 images processed, 4.5313146114349365 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:30,  2.54it/s] 13%|█▎        | 10/79 [00:00<00:02, 25.21it/s] 22%|██▏       | 17/79 [00:00<00:02, 29.10it/s] 32%|███▏      | 25/79 [00:00<00:01, 40.15it/s] 42%|████▏     | 33/79 [00:00<00:00, 48.74it/s] 52%|█████▏    | 41/79 [00:01<00:00, 55.97it/s] 65%|██████▍   | 51/79 [00:01<00:00, 67.01it/s] 77%|███████▋  | 61/79 [00:01<00:00, 75.28it/s] 89%|████████▊ | 70/79 [00:01<00:00, 75.90it/s]100%|██████████| 79/79 [00:01<00:00, 37.85it/s]100%|██████████| 79/79 [00:01<00:00, 42.55it/s]
10000 images processed, 1.898271083831787 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-seen-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:17,  2.62it/s]  5%|▍         | 10/204 [00:00<00:07, 25.99it/s] 10%|▉         | 20/204 [00:00<00:03, 46.01it/s] 14%|█▍        | 29/204 [00:00<00:03, 58.31it/s] 19%|█▉        | 39/204 [00:00<00:02, 68.75it/s] 24%|██▍       | 49/204 [00:00<00:02, 75.97it/s] 29%|██▉       | 59/204 [00:01<00:01, 80.43it/s] 34%|███▍      | 69/204 [00:01<00:01, 85.28it/s] 39%|███▊      | 79/204 [00:01<00:01, 88.16it/s] 44%|████▎     | 89/204 [00:01<00:01, 89.52it/s] 49%|████▊     | 99/204 [00:01<00:01, 90.77it/s] 53%|█████▎    | 109/204 [00:01<00:01, 90.55it/s] 58%|█████▊    | 119/204 [00:01<00:00, 92.26it/s] 63%|██████▎   | 129/204 [00:01<00:00, 93.38it/s] 68%|██████▊   | 139/204 [00:01<00:00, 94.71it/s] 73%|███████▎  | 149/204 [00:01<00:00, 96.04it/s] 78%|███████▊  | 159/204 [00:02<00:00, 97.12it/s] 83%|████████▎ | 170/204 [00:02<00:00, 98.05it/s] 89%|████████▊ | 181/204 [00:02<00:00, 98.73it/s] 94%|█████████▍| 192/204 [00:02<00:00, 99.62it/s]100%|█████████▉| 203/204 [00:02<00:00, 100.08it/s]100%|██████████| 204/204 [00:02<00:00, 81.28it/s] 
26032 images processed, 2.5494637489318848 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.80it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.67it/s] 27%|██▋       | 21/79 [00:00<00:01, 38.84it/s] 39%|███▉      | 31/79 [00:00<00:00, 52.87it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.29it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.55it/s] 78%|███████▊  | 62/79 [00:01<00:00, 81.66it/s] 92%|█████████▏| 73/79 [00:01<00:00, 87.49it/s]100%|██████████| 79/79 [00:01<00:00, 58.80it/s]
10000 images processed, 1.3784794807434082 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.36it/s] 14%|█▍        | 11/79 [00:00<00:02, 26.36it/s] 27%|██▋       | 21/79 [00:00<00:01, 44.62it/s] 39%|███▉      | 31/79 [00:00<00:00, 58.87it/s] 52%|█████▏    | 41/79 [00:00<00:00, 69.13it/s] 65%|██████▍   | 51/79 [00:00<00:00, 76.46it/s] 78%|███████▊  | 62/79 [00:01<00:00, 83.85it/s] 92%|█████████▏| 73/79 [00:01<00:00, 89.11it/s]100%|██████████| 79/79 [00:01<00:00, 64.48it/s]
10000 images processed, 1.2434489727020264 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:29,  2.30it/s] 16%|█▌        | 11/70 [00:00<00:02, 26.38it/s] 31%|███▏      | 22/70 [00:00<00:01, 47.01it/s] 47%|████▋     | 33/70 [00:00<00:00, 62.25it/s] 63%|██████▎   | 44/70 [00:00<00:00, 73.42it/s] 79%|███████▊  | 55/70 [00:00<00:00, 81.62it/s] 94%|█████████▍| 66/70 [00:01<00:00, 87.51it/s]100%|██████████| 70/70 [00:01<00:00, 62.43it/s]
8925 images processed, 1.1521484851837158 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:36,  1.21it/s]  4%|▍         | 2/45 [00:00<00:17,  2.42it/s] 27%|██▋       | 12/45 [00:01<00:01, 18.89it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.75it/s] 47%|████▋     | 21/45 [00:01<00:01, 23.37it/s] 56%|█████▌    | 25/45 [00:01<00:00, 25.40it/s] 73%|███████▎  | 33/45 [00:01<00:00, 23.76it/s] 84%|████████▍ | 38/45 [00:01<00:00, 27.84it/s]100%|██████████| 45/45 [00:02<00:00, 27.21it/s]100%|██████████| 45/45 [00:02<00:00, 20.01it/s]
5640 images processed, 2.27915358543396 seconds used

16.65387201309204
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.85  98.75  96.54
places365     72.23  79.15  77.31
LSUN          33.17  92.77  92.81
iSUN          72.29  81.31  84.40
dtd           46.45  89.26  93.25
AVG           46.00  88.25  88.86
Retain-Acc: 0.7397
Forget-as-OOD (retain known vs forget novel):
  FPR: 82.20 AUROC: 74.35 AUIN: 98.06
7.9734132289886475
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-seen-forget_rf.png
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,11,40,51,57,66,67,88,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=0.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=False, lora_impl='native', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='head', adapter_save_path=None, adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,57,66,67,88,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='ga', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
[debug] trainable_count = 112
[debug] trainable: encoder.conv1.weight
[debug] trainable: encoder.bn1.weight
[debug] trainable: encoder.bn1.bias
[debug] trainable: encoder.layer1.0.conv1.weight
[debug] trainable: encoder.layer1.0.bn1.weight
[debug] trainable: encoder.layer1.0.bn1.bias
[debug] trainable: encoder.layer1.0.conv2.weight
[debug] trainable: encoder.layer1.0.bn2.weight
[debug] trainable: encoder.layer1.0.bn2.bias
[debug] trainable: encoder.layer1.1.conv1.weight
[debug] trainable: encoder.layer1.1.bn1.weight
[debug] trainable: encoder.layer1.1.bn1.bias
[debug] trainable: encoder.layer1.1.conv2.weight
[debug] trainable: encoder.layer1.1.bn2.weight
[debug] trainable: encoder.layer1.1.bn2.bias
[debug] trainable: encoder.layer1.2.conv1.weight
[debug] trainable: encoder.layer1.2.bn1.weight
[debug] trainable: encoder.layer1.2.bn1.bias
[debug] trainable: encoder.layer1.2.conv2.weight
[debug] trainable: encoder.layer1.2.bn2.weight
[debug] trainable: encoder.layer1.2.bn2.bias
[debug] trainable: encoder.layer2.0.conv1.weight
[debug] trainable: encoder.layer2.0.bn1.weight
[debug] trainable: encoder.layer2.0.bn1.bias
[debug] trainable: encoder.layer2.0.conv2.weight
[debug] trainable: encoder.layer2.0.bn2.weight
[debug] trainable: encoder.layer2.0.bn2.bias
[debug] trainable: encoder.layer2.0.shortcut.0.weight
[debug] trainable: encoder.layer2.0.shortcut.1.weight
[debug] trainable: encoder.layer2.0.shortcut.1.bias
[debug] trainable: encoder.layer2.1.conv1.weight
[debug] trainable: encoder.layer2.1.bn1.weight
[debug] trainable: encoder.layer2.1.bn1.bias
[debug] trainable: encoder.layer2.1.conv2.weight
[debug] trainable: encoder.layer2.1.bn2.weight
[debug] trainable: encoder.layer2.1.bn2.bias
[debug] trainable: encoder.layer2.2.conv1.weight
[debug] trainable: encoder.layer2.2.bn1.weight
[debug] trainable: encoder.layer2.2.bn1.bias
[debug] trainable: encoder.layer2.2.conv2.weight
[debug] trainable: encoder.layer2.2.bn2.weight
[debug] trainable: encoder.layer2.2.bn2.bias
[debug] trainable: encoder.layer2.3.conv1.weight
[debug] trainable: encoder.layer2.3.bn1.weight
[debug] trainable: encoder.layer2.3.bn1.bias
[debug] trainable: encoder.layer2.3.conv2.weight
[debug] trainable: encoder.layer2.3.bn2.weight
[debug] trainable: encoder.layer2.3.bn2.bias
[debug] trainable: encoder.layer3.0.conv1.weight
[debug] trainable: encoder.layer3.0.bn1.weight
[debug][warn] non-LoRA trainables detected: ['encoder.conv1.weight', 'encoder.bn1.weight', 'encoder.bn1.bias', 'encoder.layer1.0.conv1.weight', 'encoder.layer1.0.bn1.weight', 'encoder.layer1.0.bn1.bias', 'encoder.layer1.0.conv2.weight', 'encoder.layer1.0.bn2.weight', 'encoder.layer1.0.bn2.bias', 'encoder.layer1.1.conv1.weight']
[trainable] param_count=21605312 tensors=112
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:553: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=bool(scaler is not None)):
/home/shaokun/PALM/trainer.py:641: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/torch/csrc/autograd/generated/python_variable_methods.cpp:835.)
  print(f"[loss-{args.forget_strategy}] ep {epoch} it {it} total={loss.item():.4f} ce_r={float(loss_retain):.4f} ce_f={float(loss_forget):.4f}")
  2%|▏         | 1/50 [00:39<32:27, 39.75s/it]  4%|▍         | 2/50 [00:54<20:14, 25.31s/it]  6%|▌         | 3/50 [01:09<16:07, 20.58s/it]  8%|▊         | 4/50 [01:24<14:03, 18.34s/it] 10%|█         | 5/50 [01:40<12:55, 17.23s/it] 12%|█▏        | 6/50 [01:54<12:02, 16.41s/it] 14%|█▍        | 7/50 [02:09<11:23, 15.90s/it] 16%|█▌        | 8/50 [02:25<11:03, 15.79s/it] 18%|█▊        | 9/50 [02:40<10:39, 15.61s/it] 20%|██        | 10/50 [02:55<10:18, 15.45s/it] 22%|██▏       | 11/50 [03:10<09:55, 15.27s/it] 24%|██▍       | 12/50 [03:25<09:38, 15.22s/it] 26%|██▌       | 13/50 [03:40<09:20, 15.16s/it] 28%|██▊       | 14/50 [03:56<09:08, 15.24s/it] 30%|███       | 15/50 [04:11<08:54, 15.27s/it] 32%|███▏      | 16/50 [04:26<08:36, 15.18s/it] 34%|███▍      | 17/50 [04:41<08:19, 15.13s/it][loss-ga] ep 0 it 0 total=0.0088 ce_r=0.0094 ce_f=0.0031
[loss-ga] ep 0 it 50 total=0.0163 ce_r=0.0171 ce_f=0.0043
[loss-ga] ep 0 it 100 total=0.0510 ce_r=0.0514 ce_f=0.0021
[loss-ga] ep 0 it 150 total=0.0160 ce_r=0.0201 ce_f=0.0204
[loss-ga] ep 0 it 200 total=0.0187 ce_r=0.0194 ce_f=0.0036
[loss-ga] ep 0 it 250 total=0.0155 ce_r=0.0170 ce_f=0.0076
[loss-ga] ep 0 it 300 total=0.0376 ce_r=0.0381 ce_f=0.0023
[loss-ga] ep 0 it 350 total=0.0194 ce_r=0.0199 ce_f=0.0026
[loss-ga] ep 1 it 9 total=0.0328 ce_r=0.0401 ce_f=0.0366
[loss-ga] ep 1 it 59 total=0.0093 ce_r=0.0110 ce_f=0.0082
[loss-ga] ep 1 it 109 total=0.0109 ce_r=0.0122 ce_f=0.0066
[loss-ga] ep 1 it 159 total=0.0530 ce_r=0.0535 ce_f=0.0023
[loss-ga] ep 1 it 209 total=0.0187 ce_r=0.0192 ce_f=0.0027
[loss-ga] ep 1 it 259 total=0.0076 ce_r=0.0080 ce_f=0.0021
[loss-ga] ep 1 it 309 total=0.0141 ce_r=0.0148 ce_f=0.0033
[loss-ga] ep 1 it 359 total=0.0125 ce_r=0.0134 ce_f=0.0047
[loss-ga] ep 2 it 18 total=0.0166 ce_r=0.0211 ce_f=0.0222
[loss-ga] ep 2 it 68 total=-0.0121 ce_r=0.0071 ce_f=0.0959
[loss-ga] ep 2 it 118 total=0.0433 ce_r=0.0592 ce_f=0.0799
[loss-ga] ep 2 it 168 total=0.0053 ce_r=0.0058 ce_f=0.0025
[loss-ga] ep 2 it 218 total=0.0217 ce_r=0.0231 ce_f=0.0068
[loss-ga] ep 2 it 268 total=0.0491 ce_r=0.0500 ce_f=0.0047
[loss-ga] ep 2 it 318 total=0.0602 ce_r=0.0608 ce_f=0.0032
[loss-ga] ep 2 it 368 total=0.0435 ce_r=0.0439 ce_f=0.0022
[loss-ga] ep 3 it 27 total=0.0193 ce_r=0.0197 ce_f=0.0020
[loss-ga] ep 3 it 77 total=0.0136 ce_r=0.0146 ce_f=0.0051
[loss-ga] ep 3 it 127 total=-0.0132 ce_r=0.0150 ce_f=0.1410
[loss-ga] ep 3 it 177 total=-0.0102 ce_r=0.0053 ce_f=0.0778
[loss-ga] ep 3 it 227 total=0.0240 ce_r=0.0251 ce_f=0.0053
[loss-ga] ep 3 it 277 total=0.0137 ce_r=0.0141 ce_f=0.0024
[loss-ga] ep 3 it 327 total=0.0223 ce_r=0.0272 ce_f=0.0242
[loss-ga] ep 3 it 377 total=0.0356 ce_r=0.0365 ce_f=0.0049
[loss-ga] ep 4 it 36 total=-0.0229 ce_r=0.0162 ce_f=0.1952
[loss-ga] ep 4 it 86 total=0.0130 ce_r=0.0266 ce_f=0.0681
[loss-ga] ep 4 it 136 total=0.0104 ce_r=0.0109 ce_f=0.0026
[loss-ga] ep 4 it 186 total=0.0192 ce_r=0.0215 ce_f=0.0116
[loss-ga] ep 4 it 236 total=0.0311 ce_r=0.0552 ce_f=0.1205
[loss-ga] ep 4 it 286 total=-0.8810 ce_r=0.0105 ce_f=4.4572
[loss-ga] ep 4 it 336 total=0.0041 ce_r=0.0098 ce_f=0.0287
[loss-ga] ep 4 it 386 total=-0.1485 ce_r=0.0222 ce_f=0.8534
[loss-ga] ep 5 it 45 total=-0.4907 ce_r=0.0107 ce_f=2.5071
[loss-ga] ep 5 it 95 total=-0.0248 ce_r=0.0181 ce_f=0.2143
[loss-ga] ep 5 it 145 total=-0.7882 ce_r=0.0461 ce_f=4.1716
[loss-ga] ep 5 it 195 total=-0.2596 ce_r=0.0223 ce_f=1.4092
[loss-ga] ep 5 it 245 total=-1.4889 ce_r=0.0928 ce_f=7.9088
[loss-ga] ep 5 it 295 total=-0.5766 ce_r=0.0880 ce_f=3.3229
[loss-ga] ep 5 it 345 total=-0.5446 ce_r=0.0133 ce_f=2.7893
[loss-ga] ep 6 it 4 total=-1.0130 ce_r=0.0189 ce_f=5.1593
[loss-ga] ep 6 it 54 total=-1.4144 ce_r=0.0167 ce_f=7.1556
[loss-ga] ep 6 it 104 total=-1.4349 ce_r=0.0096 ce_f=7.2230
[loss-ga] ep 6 it 154 total=-1.0022 ce_r=0.0333 ce_f=5.1773
[loss-ga] ep 6 it 204 total=-1.3560 ce_r=0.0268 ce_f=6.9141
[loss-ga] ep 6 it 254 total=-1.7499 ce_r=0.0580 ce_f=9.0397
[loss-ga] ep 6 it 304 total=-1.0761 ce_r=0.1362 ce_f=6.0612
[loss-ga] ep 6 it 354 total=-2.2382 ce_r=0.0238 ce_f=11.3099
[loss-ga] ep 7 it 13 total=-1.4982 ce_r=0.0141 ce_f=7.5614
[loss-ga] ep 7 it 63 total=-2.2249 ce_r=0.0212 ce_f=11.2308
[loss-ga] ep 7 it 113 total=-2.5391 ce_r=0.0595 ce_f=12.9934
[loss-ga] ep 7 it 163 total=-2.8956 ce_r=0.0381 ce_f=14.6688
[loss-ga] ep 7 it 213 total=-2.5110 ce_r=0.0255 ce_f=12.6824
[loss-ga] ep 7 it 263 total=-1.6466 ce_r=0.0424 ce_f=8.4449
[loss-ga] ep 7 it 313 total=-1.6244 ce_r=0.0971 ce_f=8.6074
[loss-ga] ep 7 it 363 total=-2.1959 ce_r=0.1114 ce_f=11.5362
[loss-ga] ep 8 it 22 total=-3.0476 ce_r=0.0236 ce_f=15.3562
[loss-ga] ep 8 it 72 total=-2.8249 ce_r=0.1061 ce_f=14.6552
[loss-ga] ep 8 it 122 total=-2.6731 ce_r=0.0776 ce_f=13.7538
[loss-ga] ep 8 it 172 total=-2.6141 ce_r=0.1597 ce_f=13.8689
[loss-ga] ep 8 it 222 total=-2.6682 ce_r=0.0165 ce_f=13.4232
[loss-ga] ep 8 it 272 total=-2.7572 ce_r=0.1280 ce_f=14.4258
[loss-ga] ep 8 it 322 total=-2.8342 ce_r=0.0821 ce_f=14.5812
[loss-ga] ep 8 it 372 total=-2.9063 ce_r=0.0619 ce_f=14.8407
[loss-ga] ep 9 it 31 total=-2.8613 ce_r=0.0272 ce_f=14.4423
[loss-ga] ep 9 it 81 total=-2.9332 ce_r=0.0355 ce_f=14.8436
[loss-ga] ep 9 it 131 total=-2.8804 ce_r=0.0220 ce_f=14.5122
[loss-ga] ep 9 it 181 total=-2.7619 ce_r=0.0793 ce_f=14.2059
[loss-ga] ep 9 it 231 total=-2.9571 ce_r=0.0352 ce_f=14.9616
[loss-ga] ep 9 it 281 total=-3.0315 ce_r=0.0717 ce_f=15.5157
[loss-ga] ep 9 it 331 total=-2.9145 ce_r=0.0631 ce_f=14.8878
[loss-ga] ep 9 it 381 total=-2.9778 ce_r=0.0196 ce_f=14.9869
[loss-ga] ep 10 it 40 total=-2.9464 ce_r=0.0618 ce_f=15.0413
[loss-ga] ep 10 it 90 total=-3.2141 ce_r=0.0161 ce_f=16.1510
[loss-ga] ep 10 it 140 total=-2.9426 ce_r=0.0466 ce_f=14.9459
[loss-ga] ep 10 it 190 total=-2.8469 ce_r=0.0257 ce_f=14.3627
[loss-ga] ep 10 it 240 total=-2.8425 ce_r=0.0320 ce_f=14.3726
[loss-ga] ep 10 it 290 total=-3.0607 ce_r=0.0963 ce_f=15.7852
[loss-ga] ep 10 it 340 total=-3.2023 ce_r=0.0836 ce_f=16.4293
[loss-ga] ep 10 it 390 total=-3.0475 ce_r=0.0248 ce_f=15.3616
[loss-ga] ep 11 it 49 total=-3.1991 ce_r=0.0394 ce_f=16.1923
[loss-ga] ep 11 it 99 total=-3.0998 ce_r=0.0395 ce_f=15.6967
[loss-ga] ep 11 it 149 total=-2.8774 ce_r=0.0638 ce_f=14.7056
[loss-ga] ep 11 it 199 total=-3.1240 ce_r=0.0164 ce_f=15.7017
[loss-ga] ep 11 it 249 total=-3.3200 ce_r=0.0882 ce_f=17.0409
[loss-ga] ep 11 it 299 total=-3.0539 ce_r=0.0219 ce_f=15.3791
[loss-ga] ep 11 it 349 total=-3.2195 ce_r=0.0272 ce_f=16.2332
[loss-ga] ep 12 it 8 total=-3.0645 ce_r=0.0502 ce_f=15.5732
[loss-ga] ep 12 it 58 total=-3.1119 ce_r=0.0153 ce_f=15.6356
[loss-ga] ep 12 it 108 total=-3.1450 ce_r=0.0598 ce_f=16.0239
[loss-ga] ep 12 it 158 total=-3.1434 ce_r=0.0664 ce_f=16.0493
[loss-ga] ep 12 it 208 total=-3.2468 ce_r=0.0598 ce_f=16.5331
[loss-ga] ep 12 it 258 total=-3.1181 ce_r=0.0146 ce_f=15.6635
[loss-ga] ep 12 it 308 total=-3.1985 ce_r=0.0202 ce_f=16.0937
[loss-ga] ep 12 it 358 total=-3.1732 ce_r=0.0322 ce_f=16.0270
[loss-ga] ep 13 it 17 total=-3.2357 ce_r=0.0446 ce_f=16.4013
[loss-ga] ep 13 it 67 total=-2.8865 ce_r=0.0867 ce_f=14.8664
[loss-ga] ep 13 it 117 total=-3.1220 ce_r=0.0101 ce_f=15.6605
[loss-ga] ep 13 it 167 total=-3.1905 ce_r=0.0687 ce_f=16.2960
[loss-ga] ep 13 it 217 total=-3.2469 ce_r=0.0308 ce_f=16.3885
[loss-ga] ep 13 it 267 total=-3.2356 ce_r=0.0376 ce_f=16.3661
[loss-ga] ep 13 it 317 total=-3.1639 ce_r=0.0286 ce_f=15.9625
[loss-ga] ep 13 it 367 total=-3.0956 ce_r=0.0865 ce_f=15.9104
[loss-ga] ep 14 it 26 total=-3.1173 ce_r=0.0493 ce_f=15.8331
[loss-ga] ep 14 it 76 total=-3.1392 ce_r=0.0278 ce_f=15.8347
[loss-ga] ep 14 it 126 total=-3.3401 ce_r=0.0583 ce_f=16.9920
[loss-ga] ep 14 it 176 total=-3.1335 ce_r=0.0610 ce_f=15.9722
[loss-ga] ep 14 it 226 total=-3.2029 ce_r=0.0276 ce_f=16.1523
[loss-ga] ep 14 it 276 total=-3.3943 ce_r=0.0215 ce_f=17.0788
[loss-ga] ep 14 it 326 total=-3.1635 ce_r=0.0344 ce_f=15.9893
[loss-ga] ep 14 it 376 total=-3.2887 ce_r=0.0301 ce_f=16.5939
[loss-ga] ep 15 it 35 total=-3.0928 ce_r=0.0569 ce_f=15.7486
[loss-ga] ep 15 it 85 total=-3.1314 ce_r=0.0724 ce_f=16.0190
[loss-ga] ep 15 it 135 total=-3.1837 ce_r=0.0330 ce_f=16.0835
[loss-ga] ep 15 it 185 total=-3.1423 ce_r=0.0429 ce_f=15.9258
[loss-ga] ep 15 it 235 total=-3.1690 ce_r=0.0744 ce_f=16.2168
[loss-ga] ep 15 it 285 total=-3.0283 ce_r=0.0314 ce_f=15.2984
[loss-ga] ep 15 it 335 total=-3.2484 ce_r=0.0556 ce_f=16.5198
[loss-ga] ep 15 it 385 total=-3.5228 ce_r=0.0987 ce_f=18.1077
[loss-ga] ep 16 it 44 total=-3.0553 ce_r=0.0771 ce_f=15.6620
[loss-ga] ep 16 it 94 total=-3.3700 ce_r=0.0665 ce_f=17.1823
[loss-ga] ep 16 it 144 total=-3.3649 ce_r=0.0224 ce_f=16.9364
[loss-ga] ep 16 it 194 total=-3.3205 ce_r=0.0346 ce_f=16.7752
[loss-ga] ep 16 it 244 total=-3.1596 ce_r=0.0455 ce_f=16.0256
[loss-ga] ep 16 it 294 total=-3.2359 ce_r=0.0679 ce_f=16.5190
[loss-ga] ep 16 it 344 total=-3.2198 ce_r=0.0346 ce_f=16.2716
[loss-ga] ep 17 it 3 total=-3.3183 ce_r=0.0273 ce_f=16.7278
[loss-ga] ep 17 it 53 total=-3.0916 ce_r=0.0828 ce_f=15.8722
 36%|███▌      | 18/50 [04:56<08:00, 15.01s/it] 38%|███▊      | 19/50 [05:10<07:43, 14.95s/it] 40%|████      | 20/50 [05:25<07:28, 14.96s/it] 42%|████▏     | 21/50 [05:41<07:17, 15.07s/it] 44%|████▍     | 22/50 [05:56<07:01, 15.04s/it] 46%|████▌     | 23/50 [06:11<06:46, 15.06s/it] 48%|████▊     | 24/50 [06:26<06:34, 15.16s/it] 50%|█████     | 25/50 [06:41<06:19, 15.17s/it] 52%|█████▏    | 26/50 [06:56<06:03, 15.16s/it] 54%|█████▍    | 27/50 [07:11<05:47, 15.10s/it] 56%|█████▌    | 28/50 [07:26<05:29, 14.97s/it] 58%|█████▊    | 29/50 [07:41<05:13, 14.93s/it] 60%|██████    | 30/50 [07:56<04:58, 14.93s/it] 62%|██████▏   | 31/50 [08:11<04:46, 15.07s/it] 64%|██████▍   | 32/50 [08:26<04:31, 15.06s/it] 66%|██████▌   | 33/50 [08:41<04:14, 14.99s/it] 68%|██████▊   | 34/50 [08:57<04:04, 15.31s/it][loss-ga] ep 17 it 103 total=-3.3420 ce_r=0.0228 ce_f=16.8239
[loss-ga] ep 17 it 153 total=-3.1295 ce_r=0.0593 ce_f=15.9441
[loss-ga] ep 17 it 203 total=-3.3544 ce_r=0.0810 ce_f=17.1774
[loss-ga] ep 17 it 253 total=-3.0869 ce_r=0.0159 ce_f=15.5139
[loss-ga] ep 17 it 303 total=-3.3142 ce_r=0.0179 ce_f=16.6603
[loss-ga] ep 17 it 353 total=-2.9904 ce_r=0.0167 ce_f=15.0355
[loss-ga] ep 18 it 12 total=-3.0660 ce_r=0.0261 ce_f=15.4602
[loss-ga] ep 18 it 62 total=-3.1747 ce_r=0.0075 ce_f=15.9110
[loss-ga] ep 18 it 112 total=-3.1484 ce_r=0.0847 ce_f=16.1653
[loss-ga] ep 18 it 162 total=-3.2674 ce_r=0.0182 ce_f=16.4279
[loss-ga] ep 18 it 212 total=-3.1106 ce_r=0.0395 ce_f=15.7502
[loss-ga] ep 18 it 262 total=-3.0852 ce_r=0.0606 ce_f=15.7288
[loss-ga] ep 18 it 312 total=-3.2859 ce_r=0.0886 ce_f=16.8726
[loss-ga] ep 18 it 362 total=-3.1019 ce_r=0.0480 ce_f=15.7492
[loss-ga] ep 19 it 21 total=-3.0737 ce_r=0.0302 ce_f=15.5195
[loss-ga] ep 19 it 71 total=-3.3368 ce_r=0.0560 ce_f=16.9636
[loss-ga] ep 19 it 121 total=-3.3344 ce_r=0.0136 ce_f=16.7402
[loss-ga] ep 19 it 171 total=-3.2980 ce_r=0.0718 ce_f=16.8490
[loss-ga] ep 19 it 221 total=-3.2824 ce_r=0.0318 ce_f=16.5706
[loss-ga] ep 19 it 271 total=-3.1257 ce_r=0.0156 ce_f=15.7068
[loss-ga] ep 19 it 321 total=-3.2891 ce_r=0.0671 ce_f=16.7809
[loss-ga] ep 19 it 371 total=-3.1056 ce_r=0.0768 ce_f=15.9119
[loss-ga] ep 20 it 30 total=-3.2969 ce_r=0.0115 ce_f=16.5419
[loss-ga] ep 20 it 80 total=-2.7108 ce_r=0.0179 ce_f=13.6436
[loss-ga] ep 20 it 130 total=-3.3368 ce_r=0.0347 ce_f=16.8575
[loss-ga] ep 20 it 180 total=-3.1665 ce_r=0.0197 ce_f=15.9312
[loss-ga] ep 20 it 230 total=-3.3277 ce_r=0.0303 ce_f=16.7899
[loss-ga] ep 20 it 280 total=-3.3193 ce_r=0.0268 ce_f=16.7306
[loss-ga] ep 20 it 330 total=-3.2294 ce_r=0.0277 ce_f=16.2853
[loss-ga] ep 20 it 380 total=-3.1969 ce_r=0.0505 ce_f=16.2366
[loss-ga] ep 21 it 39 total=-3.2843 ce_r=0.0244 ce_f=16.5432
[loss-ga] ep 21 it 89 total=-3.0071 ce_r=0.0568 ce_f=15.3197
[loss-ga] ep 21 it 139 total=-3.3224 ce_r=0.0269 ce_f=16.7466
[loss-ga] ep 21 it 189 total=-3.1962 ce_r=0.0547 ce_f=16.2544
[loss-ga] ep 21 it 239 total=-3.0866 ce_r=0.0101 ce_f=15.4832
[loss-ga] ep 21 it 289 total=-3.4086 ce_r=0.0615 ce_f=17.3505
[loss-ga] ep 21 it 339 total=-3.3454 ce_r=0.0407 ce_f=16.9305
[loss-ga] ep 21 it 389 total=-3.1524 ce_r=0.0240 ce_f=15.8825
[loss-ga] ep 22 it 48 total=-3.2891 ce_r=0.0129 ce_f=16.5101
[loss-ga] ep 22 it 98 total=-3.2289 ce_r=0.0249 ce_f=16.2689
[loss-ga] ep 22 it 148 total=-3.3781 ce_r=0.0869 ce_f=17.3250
[loss-ga] ep 22 it 198 total=-3.2583 ce_r=0.0241 ce_f=16.4124
[loss-ga] ep 22 it 248 total=-3.0975 ce_r=0.0753 ce_f=15.8638
[loss-ga] ep 22 it 298 total=-3.1881 ce_r=0.0317 ce_f=16.0991
[loss-ga] ep 22 it 348 total=-3.1693 ce_r=0.0147 ce_f=15.9198
[loss-ga] ep 23 it 7 total=-3.2705 ce_r=0.0242 ce_f=16.4735
[loss-ga] ep 23 it 57 total=-3.1775 ce_r=0.0454 ce_f=16.1147
[loss-ga] ep 23 it 107 total=-3.3516 ce_r=0.0134 ce_f=16.8250
[loss-ga] ep 23 it 157 total=-3.4266 ce_r=0.0181 ce_f=17.2231
[loss-ga] ep 23 it 207 total=-3.3710 ce_r=0.0175 ce_f=16.9425
[loss-ga] ep 23 it 257 total=-3.1775 ce_r=0.0181 ce_f=15.9779
[loss-ga] ep 23 it 307 total=-3.2537 ce_r=0.0580 ce_f=16.5584
[loss-ga] ep 23 it 357 total=-3.2995 ce_r=0.1046 ce_f=17.0203
[loss-ga] ep 24 it 16 total=-3.3239 ce_r=0.0261 ce_f=16.7499
[loss-ga] ep 24 it 66 total=-3.1899 ce_r=0.1077 ce_f=16.4879
[loss-ga] ep 24 it 116 total=-3.2968 ce_r=0.0131 ce_f=16.5494
[loss-ga] ep 24 it 166 total=-3.3559 ce_r=0.0163 ce_f=16.8606
[loss-ga] ep 24 it 216 total=-3.2620 ce_r=0.0664 ce_f=16.6421
[loss-ga] ep 24 it 266 total=-3.2235 ce_r=0.0562 ce_f=16.3988
[loss-ga] ep 24 it 316 total=-3.1967 ce_r=0.0331 ce_f=16.1489
[loss-ga] ep 24 it 366 total=-3.4580 ce_r=0.0273 ce_f=17.4264
[loss-ga] ep 25 it 25 total=-3.2475 ce_r=0.0450 ce_f=16.4625
[loss-ga] ep 25 it 75 total=-3.2855 ce_r=0.1003 ce_f=16.9291
[loss-ga] ep 25 it 125 total=-3.2514 ce_r=0.1249 ce_f=16.8817
[loss-ga] ep 25 it 175 total=-3.3862 ce_r=0.0120 ce_f=16.9908
[loss-ga] ep 25 it 225 total=-3.1718 ce_r=0.0932 ce_f=16.3250
[loss-ga] ep 25 it 275 total=-3.2574 ce_r=0.0260 ce_f=16.4168
[loss-ga] ep 25 it 325 total=-3.3272 ce_r=0.0485 ce_f=16.8784
[loss-ga] ep 25 it 375 total=-3.4476 ce_r=0.0328 ce_f=17.4018
[loss-ga] ep 26 it 34 total=-3.3433 ce_r=0.0336 ce_f=16.8845
[loss-ga] ep 26 it 84 total=-3.1882 ce_r=0.0200 ce_f=16.0411
[loss-ga] ep 26 it 134 total=-3.3255 ce_r=0.0403 ce_f=16.8293
[loss-ga] ep 26 it 184 total=-3.0581 ce_r=0.0148 ce_f=15.3641
[loss-ga] ep 26 it 234 total=-3.1431 ce_r=0.0480 ce_f=15.9555
[loss-ga] ep 26 it 284 total=-3.2053 ce_r=0.0110 ce_f=16.0815
[loss-ga] ep 26 it 334 total=-3.2008 ce_r=0.1367 ce_f=16.6873
[loss-ga] ep 26 it 384 total=-3.2106 ce_r=0.0063 ce_f=16.0842
[loss-ga] ep 27 it 43 total=-3.2856 ce_r=0.0675 ce_f=16.7656
[loss-ga] ep 27 it 93 total=-3.3212 ce_r=0.0110 ce_f=16.6609
[loss-ga] ep 27 it 143 total=-3.1684 ce_r=0.0174 ce_f=15.9290
[loss-ga] ep 27 it 193 total=-3.2923 ce_r=0.0077 ce_f=16.4996
[loss-ga] ep 27 it 243 total=-3.2937 ce_r=0.0192 ce_f=16.5642
[loss-ga] ep 27 it 293 total=-3.1629 ce_r=0.0333 ce_f=15.9808
[loss-ga] ep 27 it 343 total=-3.1680 ce_r=0.0302 ce_f=15.9912
[loss-ga] ep 28 it 2 total=-3.2835 ce_r=0.0222 ce_f=16.5286
[loss-ga] ep 28 it 52 total=-3.0478 ce_r=0.0535 ce_f=15.5064
[loss-ga] ep 28 it 102 total=-2.8624 ce_r=0.0563 ce_f=14.5937
[loss-ga] ep 28 it 152 total=-3.1586 ce_r=0.0193 ce_f=15.8899
[loss-ga] ep 28 it 202 total=-3.1283 ce_r=0.1046 ce_f=16.1646
[loss-ga] ep 28 it 252 total=-3.4356 ce_r=0.0118 ce_f=17.2369
[loss-ga] ep 28 it 302 total=-3.2923 ce_r=0.0224 ce_f=16.5736
[loss-ga] ep 28 it 352 total=-3.1023 ce_r=0.0211 ce_f=15.6173
[loss-ga] ep 29 it 11 total=-3.3256 ce_r=0.0075 ce_f=16.6658
[loss-ga] ep 29 it 61 total=-3.2774 ce_r=0.0215 ce_f=16.4949
[loss-ga] ep 29 it 111 total=-3.2341 ce_r=0.0479 ce_f=16.4098
[loss-ga] ep 29 it 161 total=-3.3362 ce_r=0.0152 ce_f=16.7571
[loss-ga] ep 29 it 211 total=-3.3279 ce_r=0.0099 ce_f=16.6890
[loss-ga] ep 29 it 261 total=-3.3188 ce_r=0.0490 ce_f=16.8389
[loss-ga] ep 29 it 311 total=-3.1339 ce_r=0.0211 ce_f=15.7752
[loss-ga] ep 29 it 361 total=0.0311 ce_r=0.0311 ce_f=0.0000
[loss-ga] ep 30 it 20 total=-3.1801 ce_r=0.0129 ce_f=15.9648
[loss-ga] ep 30 it 70 total=-3.2444 ce_r=0.0356 ce_f=16.3998
[loss-ga] ep 30 it 120 total=-3.0119 ce_r=0.0344 ce_f=15.2315
[loss-ga] ep 30 it 170 total=-3.3013 ce_r=0.0159 ce_f=16.5859
[loss-ga] ep 30 it 220 total=-3.2453 ce_r=0.0198 ce_f=16.3254
[loss-ga] ep 30 it 270 total=-3.2598 ce_r=0.0220 ce_f=16.4093
[loss-ga] ep 30 it 320 total=-3.2315 ce_r=0.0443 ce_f=16.3794
[loss-ga] ep 30 it 370 total=-3.3527 ce_r=0.0212 ce_f=16.8695
[loss-ga] ep 31 it 29 total=-3.1604 ce_r=0.0163 ce_f=15.8838
[loss-ga] ep 31 it 79 total=-3.1838 ce_r=0.0676 ce_f=16.2573
[loss-ga] ep 31 it 129 total=-3.0841 ce_r=0.0205 ce_f=15.5230
[loss-ga] ep 31 it 179 total=-3.3439 ce_r=0.0123 ce_f=16.7812
[loss-ga] ep 31 it 229 total=-3.2041 ce_r=0.0326 ce_f=16.1836
[loss-ga] ep 31 it 279 total=-3.0167 ce_r=0.1150 ce_f=15.6587
[loss-ga] ep 31 it 329 total=-3.0556 ce_r=0.1052 ce_f=15.8042
[loss-ga] ep 31 it 379 total=-3.0034 ce_r=0.0546 ce_f=15.2898
[loss-ga] ep 32 it 38 total=-3.3651 ce_r=0.0178 ce_f=16.9145
[loss-ga] ep 32 it 88 total=-3.2626 ce_r=0.0113 ce_f=16.3695
[loss-ga] ep 32 it 138 total=-3.0508 ce_r=0.0738 ce_f=15.6231
[loss-ga] ep 32 it 188 total=-3.2589 ce_r=0.0057 ce_f=16.3233
[loss-ga] ep 32 it 238 total=-3.0662 ce_r=0.0323 ce_f=15.4926
[loss-ga] ep 32 it 288 total=-3.3083 ce_r=0.0097 ce_f=16.5901
[loss-ga] ep 32 it 338 total=-3.0748 ce_r=0.0842 ce_f=15.7948
[loss-ga] ep 32 it 388 total=-3.2744 ce_r=0.0132 ce_f=16.4378
[loss-ga] ep 33 it 47 total=-3.2134 ce_r=0.0474 ce_f=16.3041
[loss-ga] ep 33 it 97 total=-3.1768 ce_r=0.0146 ce_f=15.9568
[loss-ga] ep 33 it 147 total=-3.2873 ce_r=0.0100 ce_f=16.4866
[loss-ga] ep 33 it 197 total=-3.2855 ce_r=0.0122 ce_f=16.4885
[loss-ga] ep 33 it 247 total=-3.3419 ce_r=0.1302 ce_f=17.3604
[loss-ga] ep 33 it 297 total=-3.4705 ce_r=0.0411 ce_f=17.5581
[loss-ga] ep 33 it 347 total=-3.0884 ce_r=0.0367 ce_f=15.6256
[loss-ga] ep 34 it 6 total=-3.1870 ce_r=0.0180 ce_f=16.0251
 70%|███████   | 35/50 [09:12<03:48, 15.24s/it] 72%|███████▏  | 36/50 [09:27<03:30, 15.02s/it] 74%|███████▍  | 37/50 [09:41<03:13, 14.91s/it] 76%|███████▌  | 38/50 [09:56<02:58, 14.89s/it] 78%|███████▊  | 39/50 [10:11<02:43, 14.83s/it] 80%|████████  | 40/50 [10:25<02:27, 14.74s/it] 82%|████████▏ | 41/50 [10:41<02:13, 14.86s/it] 84%|████████▍ | 42/50 [10:56<01:59, 14.96s/it] 86%|████████▌ | 43/50 [11:10<01:43, 14.84s/it] 88%|████████▊ | 44/50 [11:25<01:28, 14.82s/it] 90%|█████████ | 45/50 [11:41<01:15, 15.02s/it] 92%|█████████▏| 46/50 [11:56<01:00, 15.18s/it] 94%|█████████▍| 47/50 [12:11<00:45, 15.08s/it] 96%|█████████▌| 48/50 [12:26<00:30, 15.05s/it] 98%|█████████▊| 49/50 [12:41<00:14, 14.91s/it]100%|██████████| 50/50 [12:56<00:00, 14.97s/it]100%|██████████| 50/50 [12:56<00:00, 15.52s/it]
[loss-ga] ep 34 it 56 total=-3.1611 ce_r=0.0199 ce_f=15.9052
[loss-ga] ep 34 it 106 total=-3.1318 ce_r=0.0209 ce_f=15.7636
[loss-ga] ep 34 it 156 total=-3.2229 ce_r=0.0083 ce_f=16.1562
[loss-ga] ep 34 it 206 total=-3.2030 ce_r=0.0132 ce_f=16.0810
[loss-ga] ep 34 it 256 total=-3.0975 ce_r=0.0176 ce_f=15.5757
[loss-ga] ep 34 it 306 total=-3.1891 ce_r=0.0291 ce_f=16.0910
[loss-ga] ep 34 it 356 total=-3.3297 ce_r=0.0275 ce_f=16.7861
[loss-ga] ep 35 it 15 total=-3.1805 ce_r=0.0217 ce_f=16.0107
[loss-ga] ep 35 it 65 total=-3.2504 ce_r=0.0217 ce_f=16.3605
[loss-ga] ep 35 it 115 total=-3.3587 ce_r=0.0226 ce_f=16.9064
[loss-ga] ep 35 it 165 total=-2.8246 ce_r=0.0474 ce_f=14.3602
[loss-ga] ep 35 it 215 total=-3.1734 ce_r=0.0232 ce_f=15.9834
[loss-ga] ep 35 it 265 total=-3.0089 ce_r=0.0654 ce_f=15.3718
[loss-ga] ep 35 it 315 total=-3.3133 ce_r=0.0490 ce_f=16.8118
[loss-ga] ep 35 it 365 total=-3.3477 ce_r=0.0229 ce_f=16.8531
[loss-ga] ep 36 it 24 total=-3.2966 ce_r=0.0170 ce_f=16.5684
[loss-ga] ep 36 it 74 total=-3.3374 ce_r=0.0379 ce_f=16.8765
[loss-ga] ep 36 it 124 total=-3.0796 ce_r=0.0742 ce_f=15.7691
[loss-ga] ep 36 it 174 total=-3.0361 ce_r=0.0256 ce_f=15.3087
[loss-ga] ep 36 it 224 total=-3.1040 ce_r=0.0163 ce_f=15.6013
[loss-ga] ep 36 it 274 total=-3.2033 ce_r=0.0143 ce_f=16.0884
[loss-ga] ep 36 it 324 total=-3.3003 ce_r=0.0179 ce_f=16.5911
[loss-ga] ep 36 it 374 total=-3.2308 ce_r=0.0879 ce_f=16.5939
[loss-ga] ep 37 it 33 total=-3.2084 ce_r=0.0177 ce_f=16.1305
[loss-ga] ep 37 it 83 total=-2.9748 ce_r=0.0497 ce_f=15.1224
[loss-ga] ep 37 it 133 total=-3.0331 ce_r=0.0120 ce_f=15.2256
[loss-ga] ep 37 it 183 total=-3.2241 ce_r=0.0095 ce_f=16.1682
[loss-ga] ep 37 it 233 total=-3.1660 ce_r=0.0334 ce_f=15.9969
[loss-ga] ep 37 it 283 total=-3.3640 ce_r=0.0395 ce_f=17.0177
[loss-ga] ep 37 it 333 total=-3.2529 ce_r=0.1075 ce_f=16.8022
[loss-ga] ep 37 it 383 total=-3.1866 ce_r=0.0269 ce_f=16.0676
[loss-ga] ep 38 it 42 total=-3.2830 ce_r=0.0647 ce_f=16.7385
[loss-ga] ep 38 it 92 total=-3.2915 ce_r=0.0210 ce_f=16.5625
[loss-ga] ep 38 it 142 total=-3.3297 ce_r=0.0177 ce_f=16.7370
[loss-ga] ep 38 it 192 total=-3.2538 ce_r=0.0228 ce_f=16.3831
[loss-ga] ep 38 it 242 total=-3.0734 ce_r=0.0345 ce_f=15.5392
[loss-ga] ep 38 it 292 total=-3.3458 ce_r=0.0168 ce_f=16.8128
[loss-ga] ep 38 it 342 total=-3.3917 ce_r=0.0293 ce_f=17.1048
[loss-ga] ep 39 it 1 total=-3.0699 ce_r=0.0873 ce_f=15.7859
[loss-ga] ep 39 it 51 total=-3.2928 ce_r=0.0178 ce_f=16.5526
[loss-ga] ep 39 it 101 total=-2.7799 ce_r=0.0940 ce_f=14.3696
[loss-ga] ep 39 it 151 total=-3.0203 ce_r=0.0994 ce_f=15.5986
[loss-ga] ep 39 it 201 total=-3.0878 ce_r=0.0308 ce_f=15.5930
[loss-ga] ep 39 it 251 total=-3.3744 ce_r=0.0154 ce_f=16.9486
[loss-ga] ep 39 it 301 total=-3.1401 ce_r=0.0383 ce_f=15.8922
[loss-ga] ep 39 it 351 total=-3.2347 ce_r=0.0085 ce_f=16.2156
[loss-ga] ep 40 it 10 total=-3.3677 ce_r=0.0454 ce_f=17.0653
[loss-ga] ep 40 it 60 total=-3.2741 ce_r=0.0463 ce_f=16.6017
[loss-ga] ep 40 it 110 total=-3.2030 ce_r=0.0220 ce_f=16.1248
[loss-ga] ep 40 it 160 total=-3.2043 ce_r=0.0679 ce_f=16.3611
[loss-ga] ep 40 it 210 total=-3.2433 ce_r=0.0628 ce_f=16.5303
[loss-ga] ep 40 it 260 total=-3.2775 ce_r=0.0178 ce_f=16.4766
[loss-ga] ep 40 it 310 total=-3.3500 ce_r=0.0154 ce_f=16.8269
[loss-ga] ep 40 it 360 total=-3.1450 ce_r=0.0354 ce_f=15.9023
[loss-ga] ep 41 it 19 total=-3.1448 ce_r=0.0866 ce_f=16.1571
[loss-ga] ep 41 it 69 total=-3.2712 ce_r=0.0269 ce_f=16.4906
[loss-ga] ep 41 it 119 total=-3.2239 ce_r=0.0170 ce_f=16.2046
[loss-ga] ep 41 it 169 total=-3.1469 ce_r=0.0370 ce_f=15.9195
[loss-ga] ep 41 it 219 total=-3.0281 ce_r=0.0139 ce_f=15.2097
[loss-ga] ep 41 it 269 total=-3.0958 ce_r=0.0123 ce_f=15.5406
[loss-ga] ep 41 it 319 total=-3.4081 ce_r=0.0144 ce_f=17.1124
[loss-ga] ep 41 it 369 total=-3.1841 ce_r=0.0185 ce_f=16.0130
[loss-ga] ep 42 it 28 total=-3.2919 ce_r=0.0158 ce_f=16.5385
[loss-ga] ep 42 it 78 total=-3.0485 ce_r=0.0249 ce_f=15.3670
[loss-ga] ep 42 it 128 total=-3.4167 ce_r=0.0246 ce_f=17.2061
[loss-ga] ep 42 it 178 total=-3.3262 ce_r=0.0143 ce_f=16.7028
[loss-ga] ep 42 it 228 total=-3.3683 ce_r=0.0406 ce_f=17.0444
[loss-ga] ep 42 it 278 total=-3.2120 ce_r=0.0441 ce_f=16.2808
[loss-ga] ep 42 it 328 total=-3.2073 ce_r=0.0443 ce_f=16.2578
[loss-ga] ep 42 it 378 total=-3.1139 ce_r=0.0117 ce_f=15.6282
[loss-ga] ep 43 it 37 total=-3.1080 ce_r=0.0825 ce_f=15.9525
[loss-ga] ep 43 it 87 total=-3.2455 ce_r=0.0156 ce_f=16.3053
[loss-ga] ep 43 it 137 total=-3.3096 ce_r=0.0095 ce_f=16.5952
[loss-ga] ep 43 it 187 total=-3.2992 ce_r=0.0230 ce_f=16.6110
[loss-ga] ep 43 it 237 total=-3.2319 ce_r=0.0268 ce_f=16.2938
[loss-ga] ep 43 it 287 total=-3.2127 ce_r=0.0274 ce_f=16.2002
[loss-ga] ep 43 it 337 total=-3.3679 ce_r=0.0213 ce_f=16.9459
[loss-ga] ep 43 it 387 total=-3.1935 ce_r=0.0451 ce_f=16.1929
[loss-ga] ep 44 it 46 total=-3.2959 ce_r=0.0215 ce_f=16.5870
[loss-ga] ep 44 it 96 total=-3.2379 ce_r=0.0163 ce_f=16.2713
[loss-ga] ep 44 it 146 total=-3.2774 ce_r=0.0113 ce_f=16.4439
[loss-ga] ep 44 it 196 total=-3.2446 ce_r=0.0050 ce_f=16.2479
[loss-ga] ep 44 it 246 total=-3.3641 ce_r=0.0172 ce_f=16.9067
[loss-ga] ep 44 it 296 total=-3.0827 ce_r=0.0211 ce_f=15.5191
[loss-ga] ep 44 it 346 total=-3.2139 ce_r=0.0186 ce_f=16.1625
[loss-ga] ep 45 it 5 total=-3.3264 ce_r=0.0265 ce_f=16.7646
[loss-ga] ep 45 it 55 total=-3.2051 ce_r=0.0208 ce_f=16.1294
[loss-ga] ep 45 it 105 total=-2.9598 ce_r=0.0310 ce_f=14.9541
[loss-ga] ep 45 it 155 total=-3.0705 ce_r=0.0055 ce_f=15.3800
[loss-ga] ep 45 it 205 total=-3.3426 ce_r=0.0293 ce_f=16.8597
[loss-ga] ep 45 it 255 total=-3.1735 ce_r=0.0678 ce_f=16.2062
[loss-ga] ep 45 it 305 total=-3.0287 ce_r=0.1240 ce_f=15.7635
[loss-ga] ep 45 it 355 total=-3.2199 ce_r=0.0844 ce_f=16.5214
[loss-ga] ep 46 it 14 total=-3.2189 ce_r=0.0344 ce_f=16.2667
[loss-ga] ep 46 it 64 total=-3.2284 ce_r=0.0299 ce_f=16.2916
[loss-ga] ep 46 it 114 total=-3.2002 ce_r=0.0089 ce_f=16.0454
[loss-ga] ep 46 it 164 total=-3.2994 ce_r=0.0947 ce_f=16.9701
[loss-ga] ep 46 it 214 total=-3.2116 ce_r=0.0770 ce_f=16.4434
[loss-ga] ep 46 it 264 total=-3.1395 ce_r=0.0289 ce_f=15.8420
[loss-ga] ep 46 it 314 total=-3.1786 ce_r=0.0324 ce_f=16.0551
[loss-ga] ep 46 it 364 total=-3.4311 ce_r=0.0183 ce_f=17.2473
[loss-ga] ep 47 it 23 total=-3.4015 ce_r=0.0170 ce_f=17.0924
[loss-ga] ep 47 it 73 total=-3.2142 ce_r=0.0047 ce_f=16.0946
[loss-ga] ep 47 it 123 total=-3.3510 ce_r=0.0535 ce_f=17.0229
[loss-ga] ep 47 it 173 total=-3.3379 ce_r=0.0285 ce_f=16.8319
[loss-ga] ep 47 it 223 total=-3.3554 ce_r=0.0407 ce_f=16.9807
[loss-ga] ep 47 it 273 total=-3.2029 ce_r=0.0419 ce_f=16.2241
[loss-ga] ep 47 it 323 total=-3.2107 ce_r=0.0058 ce_f=16.0825
[loss-ga] ep 47 it 373 total=-3.4227 ce_r=0.0133 ce_f=17.1803
[loss-ga] ep 48 it 32 total=-3.1994 ce_r=0.0146 ce_f=16.0700
[loss-ga] ep 48 it 82 total=-3.3642 ce_r=0.0287 ce_f=16.9641
[loss-ga] ep 48 it 132 total=-3.2338 ce_r=0.0183 ce_f=16.2605
[loss-ga] ep 48 it 182 total=-3.2730 ce_r=0.0210 ce_f=16.4699
[loss-ga] ep 48 it 232 total=-3.2310 ce_r=0.0173 ce_f=16.2416
[loss-ga] ep 48 it 282 total=-3.2887 ce_r=0.0056 ce_f=16.4717
[loss-ga] ep 48 it 332 total=-3.4199 ce_r=0.0274 ce_f=17.2365
[loss-ga] ep 48 it 382 total=-3.3037 ce_r=0.0276 ce_f=16.6567
[loss-ga] ep 49 it 41 total=-3.3067 ce_r=0.0150 ce_f=16.6084
[loss-ga] ep 49 it 91 total=-3.1553 ce_r=0.0242 ce_f=15.8978
[loss-ga] ep 49 it 141 total=-3.3159 ce_r=0.0054 ce_f=16.6061
[loss-ga] ep 49 it 191 total=-3.2492 ce_r=0.0044 ce_f=16.2677
[loss-ga] ep 49 it 241 total=-3.0887 ce_r=0.0117 ce_f=15.5020
[loss-ga] ep 49 it 291 total=-3.0698 ce_r=0.0275 ce_f=15.4864
[loss-ga] ep 49 it 341 total=-3.3024 ce_r=0.0163 ce_f=16.5934
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2.pt
resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc1-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:04,  2.11it/s]  3%|▎         | 11/391 [00:00<00:15, 24.68it/s]  5%|▌         | 21/391 [00:00<00:08, 42.74it/s]  8%|▊         | 31/391 [00:00<00:06, 57.36it/s] 11%|█         | 42/391 [00:00<00:05, 69.77it/s] 14%|█▎        | 53/391 [00:01<00:04, 78.61it/s] 16%|█▌        | 63/391 [00:01<00:03, 84.22it/s] 19%|█▊        | 73/391 [00:01<00:03, 88.26it/s] 21%|██▏       | 84/391 [00:01<00:03, 92.18it/s] 24%|██▍       | 95/391 [00:01<00:03, 94.45it/s] 27%|██▋       | 106/391 [00:01<00:02, 96.19it/s] 30%|██▉       | 117/391 [00:01<00:02, 97.66it/s] 32%|███▏      | 127/391 [00:01<00:02, 97.70it/s] 35%|███▌      | 138/391 [00:01<00:02, 98.55it/s] 38%|███▊      | 149/391 [00:01<00:02, 98.88it/s] 41%|████      | 159/391 [00:02<00:02, 98.94it/s] 43%|████▎     | 169/391 [00:02<00:02, 99.23it/s] 46%|████▌     | 179/391 [00:02<00:02, 99.19it/s] 49%|████▊     | 190/391 [00:02<00:02, 99.68it/s] 51%|█████     | 200/391 [00:02<00:01, 99.67it/s] 54%|█████▎    | 210/391 [00:02<00:01, 99.36it/s] 57%|█████▋    | 221/391 [00:02<00:01, 99.48it/s] 59%|█████▉    | 231/391 [00:02<00:01, 99.57it/s] 62%|██████▏   | 241/391 [00:02<00:01, 99.67it/s] 64%|██████▍   | 252/391 [00:02<00:01, 99.77it/s] 67%|██████▋   | 263/391 [00:03<00:01, 99.96it/s] 70%|███████   | 274/391 [00:03<00:01, 100.40it/s] 73%|███████▎  | 285/391 [00:03<00:01, 100.49it/s] 76%|███████▌  | 296/391 [00:03<00:00, 100.61it/s] 79%|███████▊  | 307/391 [00:03<00:00, 100.78it/s] 81%|████████▏ | 318/391 [00:03<00:00, 100.81it/s] 84%|████████▍ | 329/391 [00:03<00:00, 100.26it/s] 87%|████████▋ | 340/391 [00:03<00:00, 100.61it/s] 90%|████████▉ | 351/391 [00:03<00:00, 100.13it/s] 93%|█████████▎| 362/391 [00:04<00:00, 99.85it/s]  95%|█████████▌| 373/391 [00:04<00:00, 100.65it/s] 98%|█████████▊| 384/391 [00:04<00:00, 101.14it/s]100%|██████████| 391/391 [00:04<00:00, 89.20it/s] 
50000 images processed, 4.475779294967651 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.17it/s] 14%|█▍        | 11/79 [00:00<00:02, 24.94it/s] 27%|██▋       | 21/79 [00:00<00:01, 43.25it/s] 39%|███▉      | 31/79 [00:00<00:00, 56.25it/s] 51%|█████     | 40/79 [00:00<00:00, 55.10it/s] 61%|██████    | 48/79 [00:01<00:00, 58.99it/s] 73%|███████▎  | 58/79 [00:01<00:00, 68.73it/s] 86%|████████▌ | 68/79 [00:01<00:00, 76.43it/s] 99%|█████████▊| 78/79 [00:01<00:00, 82.55it/s]100%|██████████| 79/79 [00:01<00:00, 41.02it/s]
10000 images processed, 1.9650921821594238 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc1-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:35,  2.12it/s]  4%|▍         | 9/204 [00:00<00:09, 20.01it/s]  9%|▉         | 19/204 [00:00<00:04, 39.27it/s] 15%|█▍        | 30/204 [00:00<00:03, 56.12it/s] 20%|█▉        | 40/204 [00:00<00:02, 67.28it/s] 25%|██▍       | 50/204 [00:00<00:02, 76.12it/s] 30%|██▉       | 61/204 [00:01<00:01, 83.39it/s] 35%|███▍      | 71/204 [00:01<00:01, 84.11it/s] 40%|███▉      | 81/204 [00:01<00:01, 85.14it/s] 45%|████▍     | 91/204 [00:01<00:01, 88.35it/s] 50%|████▉     | 101/204 [00:01<00:01, 91.53it/s] 54%|█████▍    | 111/204 [00:01<00:00, 93.92it/s] 59%|█████▉    | 121/204 [00:01<00:00, 94.52it/s] 64%|██████▍   | 131/204 [00:01<00:00, 92.61it/s] 69%|██████▉   | 141/204 [00:01<00:00, 92.60it/s] 75%|███████▍  | 152/204 [00:02<00:00, 94.81it/s] 79%|███████▉  | 162/204 [00:02<00:00, 96.24it/s] 85%|████████▍ | 173/204 [00:02<00:00, 97.54it/s] 90%|█████████ | 184/204 [00:02<00:00, 98.83it/s] 95%|█████████▌| 194/204 [00:02<00:00, 94.60it/s]100%|██████████| 204/204 [00:02<00:00, 95.37it/s]100%|██████████| 204/204 [00:02<00:00, 78.10it/s]
26032 images processed, 2.6519930362701416 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.60it/s]  9%|▉         | 7/79 [00:00<00:06, 11.17it/s] 22%|██▏       | 17/79 [00:00<00:02, 27.69it/s] 34%|███▍      | 27/79 [00:01<00:01, 42.30it/s] 46%|████▌     | 36/79 [00:01<00:00, 52.91it/s] 58%|█████▊    | 46/79 [00:01<00:00, 63.74it/s] 71%|███████   | 56/79 [00:01<00:00, 72.88it/s] 85%|████████▍ | 67/79 [00:01<00:00, 80.92it/s] 99%|█████████▊| 78/79 [00:01<00:00, 86.82it/s]100%|██████████| 79/79 [00:01<00:00, 51.47it/s]
10000 images processed, 1.5657639503479004 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.13it/s] 13%|█▎        | 10/79 [00:00<00:03, 22.26it/s] 23%|██▎       | 18/79 [00:00<00:01, 35.99it/s] 35%|███▌      | 28/79 [00:00<00:00, 51.60it/s] 48%|████▊     | 38/79 [00:00<00:00, 63.85it/s] 61%|██████    | 48/79 [00:00<00:00, 72.85it/s] 73%|███████▎  | 58/79 [00:01<00:00, 80.34it/s] 87%|████████▋ | 69/79 [00:01<00:00, 86.64it/s]100%|██████████| 79/79 [00:01<00:00, 60.88it/s]
10000 images processed, 1.317293405532837 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.95it/s] 14%|█▍        | 10/70 [00:00<00:02, 21.03it/s] 29%|██▊       | 20/70 [00:00<00:01, 39.17it/s] 43%|████▎     | 30/70 [00:00<00:00, 54.36it/s] 57%|█████▋    | 40/70 [00:00<00:00, 66.34it/s] 73%|███████▎  | 51/70 [00:01<00:00, 76.49it/s] 89%|████████▊ | 62/70 [00:01<00:00, 83.79it/s]100%|██████████| 70/70 [00:01<00:00, 57.43it/s]
8925 images processed, 1.2479171752929688 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:40,  1.09it/s]  4%|▍         | 2/45 [00:01<00:19,  2.23it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.60it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.86it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.13it/s] 60%|██████    | 27/45 [00:01<00:00, 29.45it/s] 71%|███████   | 32/45 [00:02<00:00, 18.86it/s] 93%|█████████▎| 42/45 [00:02<00:00, 30.72it/s]100%|██████████| 45/45 [00:02<00:00, 20.57it/s]
5640 images processed, 2.209444522857666 seconds used

17.12811255455017
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           6.27  98.64  96.28
places365     70.82  79.85  78.33
LSUN          47.04  89.18  89.69
iSUN          67.00  84.28  86.93
dtd           52.82  87.82  92.44
AVG           48.79  87.95  88.74
Retain-Acc: 0.7411
Forget-as-OOD (retain known vs forget novel):
  FPR: 62.20 AUROC: 87.62 AUIN: 99.20
7.46192193031311
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2.pt
resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc2-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:51,  2.27it/s]  3%|▎         | 11/391 [00:00<00:14, 25.84it/s]  5%|▌         | 21/391 [00:00<00:08, 44.16it/s]  8%|▊         | 32/391 [00:00<00:05, 60.23it/s] 11%|█         | 43/391 [00:00<00:04, 71.79it/s] 14%|█▍        | 54/391 [00:00<00:04, 80.25it/s] 17%|█▋        | 65/391 [00:01<00:03, 86.29it/s] 19%|█▉        | 76/391 [00:01<00:03, 90.77it/s] 22%|██▏       | 87/391 [00:01<00:03, 93.87it/s] 25%|██▌       | 98/391 [00:01<00:03, 95.92it/s] 28%|██▊       | 109/391 [00:01<00:02, 97.33it/s] 31%|███       | 120/391 [00:01<00:02, 98.57it/s] 34%|███▎      | 131/391 [00:01<00:02, 99.18it/s] 36%|███▋      | 142/391 [00:01<00:02, 99.42it/s] 39%|███▉      | 153/391 [00:01<00:02, 99.94it/s] 42%|████▏     | 164/391 [00:02<00:02, 100.32it/s] 45%|████▍     | 175/391 [00:02<00:02, 100.36it/s] 48%|████▊     | 186/391 [00:02<00:02, 100.52it/s] 50%|█████     | 197/391 [00:02<00:01, 100.36it/s] 53%|█████▎    | 208/391 [00:02<00:01, 100.48it/s] 56%|█████▌    | 219/391 [00:02<00:01, 100.58it/s] 59%|█████▉    | 230/391 [00:02<00:01, 100.45it/s] 62%|██████▏   | 241/391 [00:02<00:01, 100.42it/s] 64%|██████▍   | 252/391 [00:02<00:01, 100.56it/s] 67%|██████▋   | 263/391 [00:03<00:01, 100.64it/s] 70%|███████   | 274/391 [00:03<00:01, 100.73it/s] 73%|███████▎  | 285/391 [00:03<00:01, 100.73it/s] 76%|███████▌  | 296/391 [00:03<00:00, 100.55it/s] 79%|███████▊  | 307/391 [00:03<00:00, 99.84it/s]  81%|████████▏ | 318/391 [00:03<00:00, 99.96it/s] 84%|████████▍ | 329/391 [00:03<00:00, 100.29it/s] 87%|████████▋ | 340/391 [00:03<00:00, 100.15it/s] 90%|████████▉ | 351/391 [00:03<00:00, 99.84it/s]  92%|█████████▏| 361/391 [00:04<00:00, 99.62it/s] 95%|█████████▌| 372/391 [00:04<00:00, 100.50it/s] 98%|█████████▊| 383/391 [00:04<00:00, 101.11it/s]100%|██████████| 391/391 [00:04<00:00, 90.24it/s] 
50000 images processed, 4.41462254524231 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:32,  2.39it/s] 14%|█▍        | 11/79 [00:00<00:02, 26.81it/s] 27%|██▋       | 21/79 [00:00<00:01, 45.48it/s] 39%|███▉      | 31/79 [00:00<00:00, 59.63it/s] 52%|█████▏    | 41/79 [00:00<00:00, 69.01it/s] 65%|██████▍   | 51/79 [00:00<00:00, 76.56it/s] 77%|███████▋  | 61/79 [00:01<00:00, 82.17it/s] 90%|████████▉ | 71/79 [00:01<00:00, 86.92it/s]100%|██████████| 79/79 [00:02<00:00, 37.47it/s]
10000 images processed, 2.168330192565918 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc2-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:36,  2.09it/s]  5%|▍         | 10/204 [00:00<00:08, 21.96it/s] 10%|▉         | 20/204 [00:00<00:04, 40.33it/s] 15%|█▍        | 30/204 [00:00<00:03, 54.83it/s] 20%|█▉        | 40/204 [00:00<00:02, 66.13it/s] 25%|██▍       | 50/204 [00:01<00:02, 75.04it/s] 30%|██▉       | 61/204 [00:01<00:01, 82.50it/s] 35%|███▍      | 71/204 [00:01<00:01, 87.24it/s] 40%|███▉      | 81/204 [00:01<00:01, 90.37it/s] 45%|████▌     | 92/204 [00:01<00:01, 93.49it/s] 50%|█████     | 103/204 [00:01<00:01, 95.61it/s] 55%|█████▌    | 113/204 [00:01<00:00, 96.85it/s] 61%|██████    | 124/204 [00:01<00:00, 98.10it/s] 66%|██████▌   | 135/204 [00:01<00:00, 98.76it/s] 71%|███████   | 145/204 [00:01<00:00, 99.02it/s] 76%|███████▋  | 156/204 [00:02<00:00, 99.46it/s] 81%|████████▏ | 166/204 [00:02<00:00, 99.59it/s] 86%|████████▋ | 176/204 [00:02<00:00, 99.64it/s] 92%|█████████▏| 187/204 [00:02<00:00, 100.08it/s] 97%|█████████▋| 198/204 [00:02<00:00, 100.34it/s]100%|██████████| 204/204 [00:02<00:00, 80.29it/s] 
26032 images processed, 2.5782830715179443 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:47,  1.63it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.93it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.23it/s] 39%|███▉      | 31/79 [00:00<00:00, 50.23it/s] 52%|█████▏    | 41/79 [00:01<00:00, 61.86it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.12it/s] 78%|███████▊  | 62/79 [00:01<00:00, 79.58it/s] 92%|█████████▏| 73/79 [00:01<00:00, 85.80it/s]100%|██████████| 79/79 [00:01<00:00, 56.04it/s]
10000 images processed, 1.4432601928710938 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.30it/s] 10%|█         | 8/79 [00:00<00:03, 18.60it/s] 23%|██▎       | 18/79 [00:00<00:01, 38.89it/s] 35%|███▌      | 28/79 [00:00<00:00, 54.66it/s] 48%|████▊     | 38/79 [00:00<00:00, 66.91it/s] 62%|██████▏   | 49/79 [00:00<00:00, 76.91it/s] 75%|███████▍  | 59/79 [00:01<00:00, 83.19it/s] 89%|████████▊ | 70/79 [00:01<00:00, 88.70it/s]100%|██████████| 79/79 [00:01<00:00, 62.96it/s]
10000 images processed, 1.2734851837158203 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  2.00it/s] 14%|█▍        | 10/70 [00:00<00:02, 21.09it/s] 27%|██▋       | 19/70 [00:00<00:01, 37.23it/s] 41%|████▏     | 29/70 [00:00<00:00, 52.51it/s] 56%|█████▌    | 39/70 [00:00<00:00, 64.21it/s] 70%|███████   | 49/70 [00:01<00:00, 72.82it/s] 86%|████████▌ | 60/70 [00:01<00:00, 80.94it/s]100%|██████████| 70/70 [00:01<00:00, 86.10it/s]100%|██████████| 70/70 [00:01<00:00, 56.62it/s]
8925 images processed, 1.2687339782714844 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:38,  1.15it/s]  4%|▍         | 2/45 [00:01<00:19,  2.24it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.67it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.77it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.78it/s] 56%|█████▌    | 25/45 [00:01<00:00, 24.28it/s] 73%|███████▎  | 33/45 [00:01<00:00, 24.39it/s] 82%|████████▏ | 37/45 [00:02<00:00, 25.88it/s]100%|██████████| 45/45 [00:02<00:00, 35.76it/s]100%|██████████| 45/45 [00:02<00:00, 20.94it/s]
5640 images processed, 2.187509059906006 seconds used

16.878203630447388
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.30  98.84  96.76
places365     70.73  80.07  78.67
LSUN          43.80  90.20  90.63
iSUN          66.96  84.62  87.26
dtd           51.67  88.37  92.76
AVG           47.69  88.42  89.22
Retain-Acc: 0.7381
Forget-as-OOD (retain known vs forget novel):
  FPR: 86.40 AUROC: 78.52 AUIN: 98.58
7.467827558517456
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc2-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc2-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2.pt
resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-seen-forget: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:01<08:42,  1.34s/it]  2%|▏         | 9/391 [00:01<00:45,  8.33it/s]  5%|▍         | 19/391 [00:01<00:19, 19.23it/s]  7%|▋         | 29/391 [00:01<00:11, 30.92it/s] 10%|▉         | 39/391 [00:01<00:08, 42.69it/s] 13%|█▎        | 49/391 [00:01<00:06, 53.84it/s] 15%|█▌        | 60/391 [00:01<00:05, 64.81it/s] 18%|█▊        | 71/391 [00:02<00:04, 73.91it/s] 21%|██        | 82/391 [00:02<00:03, 81.19it/s] 24%|██▍       | 93/391 [00:02<00:03, 86.69it/s] 26%|██▋       | 103/391 [00:02<00:03, 90.14it/s] 29%|██▉       | 114/391 [00:02<00:02, 93.28it/s] 32%|███▏      | 125/391 [00:02<00:02, 95.20it/s] 35%|███▍      | 136/391 [00:02<00:02, 96.78it/s] 38%|███▊      | 147/391 [00:02<00:02, 98.05it/s] 40%|████      | 158/391 [00:02<00:02, 98.65it/s] 43%|████▎     | 169/391 [00:03<00:02, 99.29it/s] 46%|████▌     | 180/391 [00:03<00:02, 98.95it/s] 49%|████▉     | 191/391 [00:03<00:02, 99.47it/s] 52%|█████▏    | 202/391 [00:03<00:01, 99.75it/s] 54%|█████▍    | 213/391 [00:03<00:01, 100.06it/s] 57%|█████▋    | 224/391 [00:03<00:01, 100.02it/s] 60%|██████    | 235/391 [00:03<00:01, 100.40it/s] 63%|██████▎   | 246/391 [00:03<00:01, 100.53it/s] 66%|██████▌   | 257/391 [00:03<00:01, 100.51it/s] 69%|██████▊   | 268/391 [00:04<00:01, 100.86it/s] 71%|███████▏  | 279/391 [00:04<00:01, 100.89it/s] 74%|███████▍  | 290/391 [00:04<00:01, 100.51it/s] 77%|███████▋  | 301/391 [00:04<00:00, 99.85it/s]  80%|███████▉  | 312/391 [00:04<00:00, 100.21it/s] 83%|████████▎ | 323/391 [00:04<00:00, 100.50it/s] 85%|████████▌ | 334/391 [00:04<00:00, 100.77it/s] 88%|████████▊ | 345/391 [00:04<00:00, 100.89it/s] 91%|█████████ | 356/391 [00:04<00:00, 100.69it/s] 94%|█████████▍| 367/391 [00:05<00:00, 100.38it/s] 97%|█████████▋| 378/391 [00:05<00:00, 101.05it/s] 99%|█████████▉| 389/391 [00:05<00:00, 101.54it/s]100%|██████████| 391/391 [00:05<00:00, 74.34it/s] 
50000 images processed, 5.3581414222717285 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:25,  3.10it/s] 13%|█▎        | 10/79 [00:00<00:02, 29.34it/s] 25%|██▌       | 20/79 [00:00<00:01, 49.66it/s] 38%|███▊      | 30/79 [00:00<00:00, 63.91it/s] 49%|████▉     | 39/79 [00:00<00:00, 71.16it/s] 62%|██████▏   | 49/79 [00:00<00:00, 78.78it/s] 75%|███████▍  | 59/79 [00:00<00:00, 84.68it/s] 87%|████████▋ | 69/79 [00:01<00:00, 88.85it/s]100%|██████████| 79/79 [00:01<00:00, 90.32it/s]100%|██████████| 79/79 [00:01<00:00, 68.48it/s]
10000 images processed, 1.1891570091247559 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-seen-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:23,  2.44it/s]  5%|▌         | 11/204 [00:00<00:07, 27.08it/s] 10%|█         | 21/204 [00:00<00:04, 45.47it/s] 15%|█▌        | 31/204 [00:00<00:02, 59.35it/s] 20%|█▉        | 40/204 [00:00<00:02, 56.14it/s] 25%|██▍       | 50/204 [00:01<00:02, 65.29it/s] 29%|██▉       | 60/204 [00:01<00:01, 73.38it/s] 34%|███▍      | 70/204 [00:01<00:01, 78.71it/s] 39%|███▉      | 80/204 [00:01<00:01, 84.42it/s] 45%|████▍     | 91/204 [00:01<00:01, 89.17it/s] 50%|████▉     | 101/204 [00:01<00:01, 91.34it/s] 54%|█████▍    | 111/204 [00:01<00:00, 93.48it/s] 59%|█████▉    | 121/204 [00:01<00:00, 94.92it/s] 64%|██████▍   | 131/204 [00:01<00:00, 96.33it/s] 69%|██████▉   | 141/204 [00:01<00:00, 97.00it/s] 74%|███████▍  | 151/204 [00:02<00:00, 95.86it/s] 79%|███████▉  | 161/204 [00:02<00:00, 97.05it/s] 84%|████████▍ | 171/204 [00:02<00:00, 95.28it/s] 89%|████████▊ | 181/204 [00:02<00:00, 96.25it/s] 94%|█████████▍| 192/204 [00:02<00:00, 98.02it/s]100%|█████████▉| 203/204 [00:02<00:00, 99.20it/s]100%|██████████| 204/204 [00:02<00:00, 78.71it/s]
26032 images processed, 2.628856897354126 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.70it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.66it/s] 27%|██▋       | 21/79 [00:00<00:01, 37.49it/s] 39%|███▉      | 31/79 [00:00<00:00, 51.87it/s] 51%|█████     | 40/79 [00:01<00:00, 61.35it/s] 63%|██████▎   | 50/79 [00:01<00:00, 69.27it/s] 75%|███████▍  | 59/79 [00:01<00:00, 73.79it/s] 87%|████████▋ | 69/79 [00:01<00:00, 80.52it/s]100%|██████████| 79/79 [00:01<00:00, 55.98it/s]
10000 images processed, 1.4391756057739258 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.05it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.70it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.71it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.29it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.75it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.51it/s] 78%|███████▊  | 62/79 [00:01<00:00, 81.65it/s] 92%|█████████▏| 73/79 [00:01<00:00, 87.46it/s]100%|██████████| 79/79 [00:01<00:00, 60.74it/s]
10000 images processed, 1.3193018436431885 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:26,  2.59it/s]  9%|▊         | 6/70 [00:00<00:04, 15.08it/s] 23%|██▎       | 16/70 [00:00<00:01, 37.63it/s] 37%|███▋      | 26/70 [00:00<00:00, 54.14it/s] 51%|█████▏    | 36/70 [00:00<00:00, 66.05it/s] 66%|██████▌   | 46/70 [00:00<00:00, 75.51it/s] 81%|████████▏ | 57/70 [00:01<00:00, 83.44it/s] 96%|█████████▌| 67/70 [00:01<00:00, 88.03it/s]100%|██████████| 70/70 [00:01<00:00, 60.70it/s]
8925 images processed, 1.1833992004394531 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:36,  1.19it/s]  4%|▍         | 2/45 [00:00<00:18,  2.31it/s] 27%|██▋       | 12/45 [00:01<00:01, 18.14it/s] 38%|███▊      | 17/45 [00:01<00:01, 20.15it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.55it/s] 56%|█████▌    | 25/45 [00:01<00:00, 25.58it/s] 73%|███████▎  | 33/45 [00:01<00:00, 24.14it/s] 82%|████████▏ | 37/45 [00:02<00:00, 25.94it/s]100%|██████████| 45/45 [00:02<00:00, 21.56it/s]
5640 images processed, 2.108792781829834 seconds used

16.80872082710266
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.36  98.81  96.53
places365     70.97  79.91  77.61
LSUN          44.62  89.88  89.94
iSUN          66.68  84.52  86.64
dtd           51.90  88.29  92.38
AVG           47.90  88.28  88.62
Retain-Acc: 0.7416
Forget-as-OOD (retain known vs forget novel):
  FPR: 68.70 AUROC: 84.34 AUIN: 97.91
7.283705711364746
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-seen-forget_rf.png
[done] continual incremental run finished. Adapters at: checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-ga-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack
