nohup: ignoring input
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] failed to load adapter: Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are forbidden, '-' and '.' cannot start or end the name, max length is 96: 'checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget20-temp0.08-planB_adapter'.
resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget20-temp0.08: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:33,  1.82it/s]  3%|▎         | 11/391 [00:00<00:17, 21.71it/s]  5%|▌         | 20/391 [00:00<00:10, 36.64it/s]  8%|▊         | 30/391 [00:00<00:07, 51.23it/s] 10%|█         | 40/391 [00:00<00:05, 62.95it/s] 13%|█▎        | 50/391 [00:01<00:04, 71.87it/s] 15%|█▌        | 60/391 [00:01<00:04, 78.28it/s] 18%|█▊        | 70/391 [00:01<00:03, 83.52it/s] 20%|██        | 80/391 [00:01<00:03, 85.23it/s] 23%|██▎       | 90/391 [00:01<00:03, 88.35it/s] 26%|██▌       | 100/391 [00:01<00:03, 90.81it/s] 28%|██▊       | 110/391 [00:01<00:03, 92.53it/s] 31%|███       | 120/391 [00:01<00:02, 93.74it/s] 33%|███▎      | 130/391 [00:01<00:02, 94.64it/s] 36%|███▌      | 140/391 [00:02<00:02, 95.35it/s] 38%|███▊      | 150/391 [00:02<00:02, 95.83it/s] 41%|████      | 160/391 [00:02<00:02, 96.07it/s] 43%|████▎     | 170/391 [00:02<00:02, 96.26it/s] 46%|████▌     | 180/391 [00:02<00:02, 96.51it/s] 49%|████▊     | 190/391 [00:02<00:02, 96.58it/s] 51%|█████     | 200/391 [00:02<00:01, 96.52it/s] 54%|█████▎    | 210/391 [00:02<00:01, 96.21it/s] 56%|█████▋    | 220/391 [00:02<00:01, 96.14it/s] 59%|█████▉    | 230/391 [00:02<00:01, 95.72it/s] 61%|██████▏   | 240/391 [00:03<00:01, 95.98it/s] 64%|██████▍   | 250/391 [00:03<00:01, 96.28it/s] 66%|██████▋   | 260/391 [00:03<00:01, 95.84it/s] 69%|██████▉   | 270/391 [00:03<00:01, 95.62it/s] 72%|███████▏  | 280/391 [00:03<00:01, 95.70it/s] 74%|███████▍  | 290/391 [00:03<00:01, 95.81it/s] 77%|███████▋  | 300/391 [00:03<00:00, 96.00it/s] 79%|███████▉  | 310/391 [00:03<00:00, 95.23it/s] 82%|████████▏ | 320/391 [00:03<00:00, 95.53it/s] 84%|████████▍ | 330/391 [00:03<00:00, 95.78it/s] 87%|████████▋ | 340/391 [00:04<00:00, 95.97it/s] 90%|████████▉ | 350/391 [00:04<00:00, 95.85it/s] 92%|█████████▏| 360/391 [00:04<00:00, 95.57it/s] 95%|█████████▍| 370/391 [00:04<00:00, 96.14it/s] 97%|█████████▋| 380/391 [00:04<00:00, 96.81it/s]100%|█████████▉| 390/391 [00:04<00:00, 97.26it/s]100%|██████████| 391/391 [00:04<00:00, 84.36it/s]
50000 images processed, 4.717029571533203 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.05it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.85it/s] 24%|██▍       | 19/79 [00:00<00:01, 38.37it/s] 37%|███▋      | 29/79 [00:00<00:00, 52.66it/s] 49%|████▉     | 39/79 [00:00<00:00, 63.35it/s] 62%|██████▏   | 49/79 [00:01<00:00, 71.46it/s] 75%|███████▍  | 59/79 [00:01<00:00, 77.82it/s] 87%|████████▋ | 69/79 [00:01<00:00, 82.61it/s]100%|██████████| 79/79 [00:02<00:00, 23.29it/s]100%|██████████| 79/79 [00:02<00:00, 34.05it/s]
10000 images processed, 2.360443592071533 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget20-temp0.08/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:31,  2.23it/s]  5%|▍         | 10/204 [00:00<00:08, 22.97it/s]  9%|▉         | 19/204 [00:00<00:04, 39.82it/s] 14%|█▎        | 28/204 [00:00<00:03, 52.87it/s] 19%|█▊        | 38/204 [00:00<00:02, 64.75it/s] 24%|██▎       | 48/204 [00:00<00:02, 72.99it/s] 28%|██▊       | 58/204 [00:01<00:01, 78.60it/s] 33%|███▎      | 68/204 [00:01<00:01, 83.32it/s] 38%|███▊      | 78/204 [00:01<00:01, 86.35it/s] 43%|████▎     | 88/204 [00:01<00:01, 88.39it/s] 48%|████▊     | 98/204 [00:01<00:01, 89.26it/s] 53%|█████▎    | 108/204 [00:01<00:01, 90.73it/s] 58%|█████▊    | 118/204 [00:01<00:00, 91.57it/s] 63%|██████▎   | 128/204 [00:01<00:00, 89.02it/s] 68%|██████▊   | 138/204 [00:01<00:00, 90.27it/s] 73%|███████▎  | 148/204 [00:02<00:00, 91.58it/s] 77%|███████▋  | 158/204 [00:02<00:00, 92.33it/s] 82%|████████▏ | 168/204 [00:02<00:00, 93.01it/s] 87%|████████▋ | 178/204 [00:02<00:00, 93.82it/s] 92%|█████████▏| 188/204 [00:02<00:00, 94.98it/s] 97%|█████████▋| 198/204 [00:02<00:00, 95.71it/s]100%|██████████| 204/204 [00:02<00:00, 77.19it/s]
26032 images processed, 2.683320999145508 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.57it/s] 11%|█▏        | 9/79 [00:00<00:04, 15.70it/s] 24%|██▍       | 19/79 [00:00<00:01, 32.59it/s] 33%|███▎      | 26/79 [00:01<00:01, 34.57it/s] 46%|████▌     | 36/79 [00:01<00:00, 47.60it/s] 58%|█████▊    | 46/79 [00:01<00:00, 58.42it/s] 71%|███████   | 56/79 [00:01<00:00, 67.13it/s] 84%|████████▎ | 66/79 [00:01<00:00, 74.73it/s] 96%|█████████▌| 76/79 [00:01<00:00, 80.79it/s]100%|██████████| 79/79 [00:01<00:00, 49.64it/s]
10000 images processed, 1.6195437908172607 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:37,  2.07it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.69it/s] 25%|██▌       | 20/79 [00:00<00:01, 40.24it/s] 38%|███▊      | 30/79 [00:00<00:00, 54.89it/s] 51%|█████     | 40/79 [00:00<00:00, 66.04it/s] 63%|██████▎   | 50/79 [00:01<00:00, 74.44it/s] 76%|███████▌  | 60/79 [00:01<00:00, 80.75it/s] 89%|████████▊ | 70/79 [00:01<00:00, 85.40it/s]100%|██████████| 79/79 [00:01<00:00, 60.66it/s]
10000 images processed, 1.3275303840637207 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:32,  2.14it/s] 10%|█         | 7/70 [00:00<00:04, 15.65it/s] 24%|██▍       | 17/70 [00:00<00:01, 36.10it/s] 39%|███▊      | 27/70 [00:00<00:00, 51.55it/s] 53%|█████▎    | 37/70 [00:00<00:00, 63.27it/s] 67%|██████▋   | 47/70 [00:00<00:00, 72.44it/s] 81%|████████▏ | 57/70 [00:01<00:00, 79.42it/s] 96%|█████████▌| 67/70 [00:01<00:00, 84.55it/s]100%|██████████| 70/70 [00:01<00:00, 56.61it/s]
8925 images processed, 1.2683072090148926 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.05it/s]  4%|▍         | 2/45 [00:01<00:19,  2.17it/s] 24%|██▍       | 11/45 [00:01<00:02, 15.49it/s] 36%|███▌      | 16/45 [00:01<00:01, 18.94it/s] 44%|████▍     | 20/45 [00:01<00:01, 20.72it/s] 53%|█████▎    | 24/45 [00:02<00:01, 13.13it/s] 71%|███████   | 32/45 [00:02<00:00, 21.68it/s] 82%|████████▏ | 37/45 [00:02<00:00, 20.65it/s]100%|██████████| 45/45 [00:02<00:00, 17.86it/s]
5640 images processed, 2.5497100353240967 seconds used

18.13918423652649
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.47  99.38  97.85
places365     67.29  81.69  77.73
LSUN          18.22  95.96  95.58
iSUN          62.33  86.76  87.44
dtd           38.69  91.31  93.69
AVG           37.80  91.02  90.46
Retain-Acc: 0.7609
Forget-as-OOD (retain known vs forget novel):
  FPR: 57.90 AUROC: 88.28 AUIN: 96.79
6.721447229385376
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget20-temp0.08_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-CIFAR-100forget20-temp0.08_rf.png
runner.sh: line 144: _cifar.py，避免在: command not found
