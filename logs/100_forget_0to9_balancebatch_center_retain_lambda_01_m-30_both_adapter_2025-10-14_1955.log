nohup: ignoring input
Files already downloaded and verified
ckpt loaded from /home/shaokun/PALM/checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
Saved centers -> cache/resnet34-top5-palm-cache6-ema0.999/CIFAR-100/class_centers.pt
Saved precision -> cache/resnet34-top5-palm-cache6-ema0.999/CIFAR-100/precision.pt
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=512, lr=0.5, weight_decay=1e-06, print_every=50, fine_tune=False, temp=0.1, cosine=True, warm=True, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='/home/shaokun/PALM/checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, incremental=False, use_lora=True, lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-balanced-retain-0.1-0to9-both_adapter.pt', adapter_load_path=None, forget_classes='0,1,2,3,4,5,6,7,8,9', forget_list_path=None, forget_center_set='retain', forget_lambda=0.1, forget_margin=30.0, centers_path='cache/resnet34-top5-palm-cache6-ema0.999/CIFAR-100/class_centers.pt', precision_path='cache/resnet34-top5-palm-cache6-ema0.999/CIFAR-100/precision.pt', batch_forget_mode='balanced', argument=True, warmup_from=0.01, warm_epochs=10, warmup_to=0.4523019943451431)
Files already downloaded and verified
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21657536
[debug] trainable_count = 14
[debug] trainable: encoder.layer4.0.conv1.A.weight
[debug] trainable: encoder.layer4.0.conv1.B.weight
[debug] trainable: encoder.layer4.0.conv2.A.weight
[debug] trainable: encoder.layer4.0.conv2.B.weight
[debug] trainable: encoder.layer4.1.conv1.A.weight
[debug] trainable: encoder.layer4.1.conv1.B.weight
[debug] trainable: encoder.layer4.1.conv2.A.weight
[debug] trainable: encoder.layer4.1.conv2.B.weight
[debug] trainable: encoder.layer4.2.conv1.A.weight
[debug] trainable: encoder.layer4.2.conv1.B.weight
[debug] trainable: encoder.layer4.2.conv2.A.weight
[debug] trainable: encoder.layer4.2.conv2.B.weight
[debug] trainable: head.2.A
[debug] trainable: head.2.B
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:17<13:59, 17.14s/it]  4%|▍         | 2/50 [00:31<12:30, 15.64s/it]  6%|▌         | 3/50 [00:46<11:50, 15.12s/it]  8%|▊         | 4/50 [01:00<11:23, 14.87s/it] 10%|█         | 5/50 [01:15<11:05, 14.79s/it] 12%|█▏        | 6/50 [01:29<10:48, 14.74s/it] 14%|█▍        | 7/50 [01:44<10:34, 14.75s/it] 16%|█▌        | 8/50 [01:59<10:16, 14.67s/it] 18%|█▊        | 9/50 [02:13<09:59, 14.63s/it] 20%|██        | 10/50 [02:28<09:40, 14.52s/it] 22%|██▏       | 11/50 [02:41<09:15, 14.25s/it] 24%|██▍       | 12/50 [02:55<08:51, 13.98s/it] 26%|██▌       | 13/50 [03:08<08:28, 13.74s/it] 28%|██▊       | 14/50 [03:21<08:10, 13.64s/it] 30%|███       | 15/50 [03:34<07:53, 13.52s/it] 32%|███▏      | 16/50 [03:48<07:37, 13.44s/it] 34%|███▍      | 17/50 [04:01<07:22, 13.41s/it] 36%|███▌      | 18/50 [04:14<07:07, 13.35s/it] 38%|███▊      | 19/50 [04:27<06:51, 13.29s/it] 40%|████      | 20/50 [04:41<06:37, 13.26s/it] 42%|████▏     | 21/50 [04:54<06:24, 13.24s/it] 44%|████▍     | 22/50 [05:07<06:11, 13.28s/it] 46%|████▌     | 23/50 [05:20<05:57, 13.24s/it] 48%|████▊     | 24/50 [05:34<05:44, 13.26s/it] 50%|█████     | 25/50 [05:47<05:31, 13.27s/it] 52%|█████▏    | 26/50 [06:00<05:18, 13.27s/it] 54%|█████▍    | 27/50 [06:13<05:03, 13.21s/it] 56%|█████▌    | 28/50 [06:26<04:50, 13.21s/it] 58%|█████▊    | 29/50 [06:40<04:38, 13.26s/it] 60%|██████    | 30/50 [06:53<04:25, 13.29s/it][loss] ep 0 it 0 total=14.8973 mle=6.4260 pcon=6.3976 forget=2.0737 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=9.262535095214844
[loss] ep 0 it 50 total=12.5805 mle=6.1831 pcon=6.3973 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=56.81352996826172
[loss] ep 1 it 3 total=12.4113 mle=6.0139 pcon=6.3974 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=51.25214767456055
[loss] ep 1 it 53 total=12.2916 mle=5.8939 pcon=6.3977 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=51.20267105102539
[loss] ep 2 it 6 total=12.1803 mle=5.7821 pcon=6.3982 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=38.08837890625
[loss] ep 2 it 56 total=12.1172 mle=5.7183 pcon=6.3989 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=77.20277404785156
[loss] ep 3 it 9 total=12.0439 mle=5.6441 pcon=6.3998 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=50.30697250366211
[loss] ep 3 it 59 total=12.0003 mle=5.5997 pcon=6.4006 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=50.08042907714844
[loss] ep 4 it 12 total=11.9651 mle=5.5635 pcon=6.4016 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=62.6081657409668
[loss] ep 4 it 62 total=11.9173 mle=5.5147 pcon=6.4026 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=31.760841369628906
[loss] ep 5 it 15 total=11.8570 mle=5.4533 pcon=6.4037 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=37.83061981201172
[loss] ep 5 it 65 total=11.7962 mle=5.3915 pcon=6.4048 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=53.48141098022461
[loss] ep 6 it 18 total=11.7725 mle=5.3668 pcon=6.4057 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=63.14508819580078
[loss] ep 6 it 68 total=11.7496 mle=5.3426 pcon=6.4070 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=47.59309387207031
[loss] ep 7 it 21 total=11.7142 mle=5.3055 pcon=6.4087 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=53.76496887207031
[loss] ep 7 it 71 total=11.6699 mle=5.2596 pcon=6.4103 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=39.62101745605469
[loss] ep 8 it 24 total=11.6244 mle=5.2125 pcon=6.4119 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=49.04146957397461
[loss] ep 8 it 74 total=11.6012 mle=5.1879 pcon=6.4133 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=39.56624984741211
[loss] ep 9 it 27 total=11.6423 mle=5.2276 pcon=6.4147 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=40.95496368408203
[loss] ep 9 it 77 total=11.5537 mle=5.1377 pcon=6.4160 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=36.32852554321289
[loss] ep 10 it 30 total=11.6274 mle=5.2102 pcon=6.4172 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=58.47367858886719
[loss] ep 10 it 80 total=11.5615 mle=5.1435 pcon=6.4181 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.279293060302734
[loss] ep 11 it 33 total=11.6160 mle=5.1955 pcon=6.4205 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=65.8712387084961
[loss] ep 11 it 83 total=11.5374 mle=5.1144 pcon=6.4230 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=55.20991134643555
[loss] ep 12 it 36 total=11.5620 mle=5.1372 pcon=6.4249 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.751380920410156
[loss] ep 12 it 86 total=11.5564 mle=5.1302 pcon=6.4262 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=40.96291732788086
[loss] ep 13 it 39 total=11.4623 mle=5.0346 pcon=6.4278 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=34.53768539428711
[loss] ep 13 it 89 total=11.5428 mle=5.1140 pcon=6.4288 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=43.12479782104492
[loss] ep 14 it 42 total=11.4721 mle=5.0423 pcon=6.4297 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.98786926269531
[loss] ep 14 it 92 total=11.4825 mle=5.0517 pcon=6.4308 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.334503173828125
[loss] ep 15 it 45 total=11.4667 mle=5.0353 pcon=6.4313 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=35.62818908691406
[loss] ep 15 it 95 total=11.5616 mle=5.1294 pcon=6.4322 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=62.44219970703125
[loss] ep 16 it 48 total=11.5806 mle=5.1477 pcon=6.4329 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=56.05192565917969
[loss] ep 17 it 1 total=11.4721 mle=5.0385 pcon=6.4337 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=60.39097213745117
[loss] ep 17 it 51 total=11.4295 mle=4.9954 pcon=6.4341 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=56.53247833251953
[loss] ep 18 it 4 total=11.4037 mle=4.9695 pcon=6.4342 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=59.580780029296875
[loss] ep 18 it 54 total=11.5109 mle=5.0765 pcon=6.4344 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=43.761253356933594
[loss] ep 19 it 7 total=11.3824 mle=4.9481 pcon=6.4344 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=41.904693603515625
[loss] ep 19 it 57 total=11.4904 mle=5.0560 pcon=6.4344 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=37.595497131347656
[loss] ep 20 it 10 total=11.4122 mle=4.9778 pcon=6.4345 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=33.88106918334961
[loss] ep 20 it 60 total=11.4312 mle=4.9967 pcon=6.4345 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=42.496131896972656
[loss] ep 21 it 13 total=11.3959 mle=4.9619 pcon=6.4340 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=46.330474853515625
[loss] ep 21 it 63 total=11.4316 mle=4.9983 pcon=6.4333 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=57.619781494140625
[loss] ep 22 it 16 total=11.4347 mle=5.0017 pcon=6.4330 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=50.94345474243164
[loss] ep 22 it 66 total=11.4263 mle=4.9941 pcon=6.4323 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=42.74744415283203
[loss] ep 23 it 19 total=11.3303 mle=4.8987 pcon=6.4316 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.85280227661133
[loss] ep 23 it 69 total=11.3833 mle=4.9522 pcon=6.4311 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=41.61656188964844
[loss] ep 24 it 22 total=11.3719 mle=4.9414 pcon=6.4305 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=39.68488693237305
[loss] ep 24 it 72 total=11.3492 mle=4.9189 pcon=6.4302 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=48.796260833740234
[loss] ep 25 it 25 total=11.3798 mle=4.9503 pcon=6.4295 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=59.65657424926758
[loss] ep 25 it 75 total=11.4155 mle=4.9864 pcon=6.4290 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=43.39897155761719
[loss] ep 26 it 28 total=11.3389 mle=4.9101 pcon=6.4288 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=46.50053405761719
[loss] ep 26 it 78 total=11.3201 mle=4.8921 pcon=6.4280 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=47.4444580078125
[loss] ep 27 it 31 total=11.4145 mle=4.9876 pcon=6.4269 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=47.279048919677734
[loss] ep 27 it 81 total=11.3137 mle=4.8877 pcon=6.4259 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=54.49333190917969
[loss] ep 28 it 34 total=11.3778 mle=4.9527 pcon=6.4251 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=41.15678405761719
[loss] ep 28 it 84 total=11.3196 mle=4.8957 pcon=6.4240 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=39.587623596191406
[loss] ep 29 it 37 total=11.3415 mle=4.9182 pcon=6.4234 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=39.67607498168945
[loss] ep 29 it 87 total=11.4111 mle=4.9883 pcon=6.4229 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=47.26241683959961
 62%|██████▏   | 31/50 [07:07<04:14, 13.37s/it] 64%|██████▍   | 32/50 [07:20<04:00, 13.35s/it] 66%|██████▌   | 33/50 [07:33<03:47, 13.36s/it] 68%|██████▊   | 34/50 [07:47<03:33, 13.35s/it] 70%|███████   | 35/50 [08:00<03:19, 13.33s/it] 72%|███████▏  | 36/50 [08:13<03:05, 13.27s/it] 74%|███████▍  | 37/50 [08:27<02:52, 13.30s/it] 76%|███████▌  | 38/50 [08:40<02:41, 13.44s/it] 78%|███████▊  | 39/50 [08:54<02:27, 13.41s/it] 80%|████████  | 40/50 [09:07<02:13, 13.34s/it] 82%|████████▏ | 41/50 [09:20<02:00, 13.34s/it] 84%|████████▍ | 42/50 [09:33<01:46, 13.30s/it] 86%|████████▌ | 43/50 [09:47<01:32, 13.27s/it] 88%|████████▊ | 44/50 [10:00<01:19, 13.27s/it] 90%|█████████ | 45/50 [10:13<01:06, 13.28s/it] 92%|█████████▏| 46/50 [10:27<00:53, 13.33s/it] 94%|█████████▍| 47/50 [10:40<00:40, 13.35s/it] 96%|█████████▌| 48/50 [10:53<00:26, 13.33s/it] 98%|█████████▊| 49/50 [11:07<00:13, 13.34s/it]100%|██████████| 50/50 [11:20<00:00, 13.35s/it]100%|██████████| 50/50 [11:20<00:00, 13.61s/it]
[loss] ep 30 it 40 total=11.3221 mle=4.9001 pcon=6.4220 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=44.011695861816406
[loss] ep 30 it 90 total=11.2850 mle=4.8639 pcon=6.4212 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=48.755043029785156
[loss] ep 31 it 43 total=11.3499 mle=4.9293 pcon=6.4206 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=46.01637268066406
[loss] ep 31 it 93 total=11.2572 mle=4.8372 pcon=6.4200 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.910770416259766
[loss] ep 32 it 46 total=11.3551 mle=4.9354 pcon=6.4197 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=34.95750427246094
[loss] ep 32 it 96 total=11.3241 mle=4.9054 pcon=6.4187 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=53.0141487121582
[loss] ep 33 it 49 total=11.2815 mle=4.8634 pcon=6.4181 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=52.05686950683594
[loss] ep 34 it 2 total=11.3457 mle=4.9285 pcon=6.4172 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=47.29298400878906
[loss] ep 34 it 52 total=11.2728 mle=4.8566 pcon=6.4162 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=53.573387145996094
[loss] ep 35 it 5 total=11.2648 mle=4.8492 pcon=6.4156 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=52.048912048339844
[loss] ep 35 it 55 total=11.3025 mle=4.8871 pcon=6.4154 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=55.76128387451172
[loss] ep 36 it 8 total=11.3121 mle=4.8968 pcon=6.4153 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.94757843017578
[loss] ep 36 it 58 total=11.3419 mle=4.9271 pcon=6.4148 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=49.79457473754883
[loss] ep 37 it 11 total=11.3338 mle=4.9189 pcon=6.4149 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=51.35987091064453
[loss] ep 37 it 61 total=11.3339 mle=4.9193 pcon=6.4145 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.490623474121094
[loss] ep 38 it 14 total=11.3380 mle=4.9242 pcon=6.4139 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=50.53025817871094
[loss] ep 38 it 64 total=11.2685 mle=4.8549 pcon=6.4136 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=46.10456848144531
[loss] ep 39 it 17 total=11.3267 mle=4.9133 pcon=6.4133 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=51.53609848022461
[loss] ep 39 it 67 total=11.2872 mle=4.8743 pcon=6.4130 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=41.541839599609375
[loss] ep 40 it 20 total=11.3086 mle=4.8958 pcon=6.4128 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=54.10796356201172
[loss] ep 40 it 70 total=11.2750 mle=4.8626 pcon=6.4124 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=48.148040771484375
[loss] ep 41 it 23 total=11.3760 mle=4.9638 pcon=6.4123 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=56.71131134033203
[loss] ep 41 it 73 total=11.1792 mle=4.7678 pcon=6.4114 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=49.133663177490234
[loss] ep 42 it 26 total=11.2580 mle=4.8469 pcon=6.4111 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=42.304771423339844
[loss] ep 42 it 76 total=11.3050 mle=4.8942 pcon=6.4109 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=48.02301788330078
[loss] ep 43 it 29 total=11.2917 mle=4.8808 pcon=6.4108 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=48.17802810668945
[loss] ep 43 it 79 total=11.2884 mle=4.8780 pcon=6.4104 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.6373291015625
[loss] ep 44 it 32 total=11.3652 mle=4.9552 pcon=6.4100 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=42.620262145996094
[loss] ep 44 it 82 total=11.3214 mle=4.9114 pcon=6.4100 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=44.35353088378906
[loss] ep 45 it 35 total=11.2377 mle=4.8278 pcon=6.4099 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=46.16522979736328
[loss] ep 45 it 85 total=11.2640 mle=4.8540 pcon=6.4100 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=63.67688751220703
[loss] ep 46 it 38 total=11.2975 mle=4.8876 pcon=6.4098 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=54.94488525390625
[loss] ep 46 it 88 total=11.2677 mle=4.8582 pcon=6.4095 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=54.08417510986328
[loss] ep 47 it 41 total=11.2950 mle=4.8857 pcon=6.4093 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=48.32676696777344
[loss] ep 47 it 91 total=11.3051 mle=4.8958 pcon=6.4093 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.88603210449219
[loss] ep 48 it 44 total=11.2614 mle=4.8522 pcon=6.4092 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=41.88372039794922
[loss] ep 48 it 94 total=11.2544 mle=4.8459 pcon=6.4086 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=47.84465789794922
[loss] ep 49 it 47 total=11.2453 mle=4.8369 pcon=6.4083 forget=0.0000 nr=256 nf=256 centers=90x512 P=512x512 dmin_norm=45.306800842285156
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from /home/shaokun/PALM/checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[lora] loaded 14 LoRA tensors from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-balanced-retain-0.1-0to9-both_adapter.pt
resnet34-top5-palm-cache6-ema0.999-ltboth-bfmbalanced-fcsretain-fl0.1-lora_r8a32d0.05: Number of model parameters: 21657536
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:27,  2.64it/s]  3%|▎         | 13/391 [00:00<00:11, 34.00it/s]  6%|▌         | 24/391 [00:00<00:06, 54.92it/s]  9%|▉         | 36/391 [00:00<00:04, 72.06it/s] 12%|█▏        | 48/391 [00:00<00:04, 84.23it/s] 15%|█▌        | 60/391 [00:00<00:03, 92.72it/s] 18%|█▊        | 72/391 [00:01<00:03, 98.22it/s] 21%|██▏       | 84/391 [00:01<00:03, 101.91it/s] 25%|██▍       | 96/391 [00:01<00:02, 104.64it/s] 28%|██▊       | 108/391 [00:01<00:02, 106.60it/s] 31%|███       | 120/391 [00:01<00:02, 107.80it/s] 34%|███▍      | 132/391 [00:01<00:02, 107.59it/s] 37%|███▋      | 144/391 [00:01<00:02, 108.51it/s] 40%|███▉      | 156/391 [00:01<00:02, 109.34it/s] 43%|████▎     | 168/391 [00:01<00:02, 110.09it/s] 46%|████▌     | 180/391 [00:01<00:01, 110.56it/s] 49%|████▉     | 192/391 [00:02<00:01, 110.76it/s] 52%|█████▏    | 204/391 [00:02<00:01, 107.79it/s] 55%|█████▌    | 216/391 [00:02<00:01, 108.85it/s] 58%|█████▊    | 227/391 [00:02<00:01, 107.08it/s] 61%|██████    | 238/391 [00:02<00:01, 106.43it/s] 64%|██████▎   | 249/391 [00:02<00:01, 107.41it/s] 66%|██████▋   | 260/391 [00:02<00:01, 106.12it/s] 69%|██████▉   | 271/391 [00:02<00:01, 105.54it/s] 72%|███████▏  | 282/391 [00:02<00:01, 105.96it/s] 75%|███████▌  | 294/391 [00:03<00:00, 107.54it/s] 78%|███████▊  | 305/391 [00:03<00:00, 105.20it/s] 81%|████████  | 316/391 [00:03<00:00, 106.14it/s] 84%|████████▍ | 328/391 [00:03<00:00, 107.33it/s] 87%|████████▋ | 340/391 [00:03<00:00, 108.26it/s] 90%|████████▉ | 351/391 [00:03<00:00, 108.43it/s] 93%|█████████▎| 363/391 [00:03<00:00, 109.13it/s] 96%|█████████▌| 375/391 [00:03<00:00, 108.87it/s] 99%|█████████▉| 387/391 [00:03<00:00, 110.04it/s]100%|██████████| 391/391 [00:03<00:00, 98.31it/s] 
50000 images processed, 4.0479490756988525 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:16,  4.59it/s] 15%|█▌        | 12/79 [00:00<00:01, 45.94it/s] 29%|██▉       | 23/79 [00:00<00:00, 68.34it/s] 44%|████▍     | 35/79 [00:00<00:00, 83.30it/s] 59%|█████▉    | 47/79 [00:00<00:00, 92.34it/s] 75%|███████▍  | 59/79 [00:00<00:00, 98.12it/s] 90%|████████▉ | 71/79 [00:00<00:00, 102.26it/s]100%|██████████| 79/79 [00:00<00:00, 82.00it/s] 
10000 images processed, 0.9958572387695312 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:05,  3.09it/s]  6%|▌         | 12/204 [00:00<00:05, 35.71it/s] 11%|█▏        | 23/204 [00:00<00:03, 58.01it/s] 17%|█▋        | 34/204 [00:00<00:02, 73.02it/s] 22%|██▏       | 45/204 [00:00<00:01, 82.66it/s] 27%|██▋       | 56/204 [00:00<00:01, 90.43it/s] 33%|███▎      | 67/204 [00:00<00:01, 95.95it/s] 38%|███▊      | 78/204 [00:01<00:01, 99.92it/s] 44%|████▎     | 89/204 [00:01<00:01, 102.70it/s] 49%|████▉     | 100/204 [00:01<00:00, 104.21it/s] 54%|█████▍    | 111/204 [00:01<00:00, 103.75it/s] 60%|█████▉    | 122/204 [00:01<00:00, 105.33it/s] 65%|██████▌   | 133/204 [00:01<00:00, 104.82it/s] 71%|███████   | 144/204 [00:01<00:00, 106.21it/s] 76%|███████▌  | 155/204 [00:01<00:00, 107.03it/s] 81%|████████▏ | 166/204 [00:01<00:00, 107.36it/s] 87%|████████▋ | 177/204 [00:01<00:00, 107.88it/s] 92%|█████████▏| 188/204 [00:02<00:00, 108.13it/s] 98%|█████████▊| 200/204 [00:02<00:00, 109.01it/s]100%|██████████| 204/204 [00:02<00:00, 91.08it/s] 
26032 images processed, 2.283250331878662 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:27,  2.86it/s] 11%|█▏        | 9/79 [00:00<00:03, 23.05it/s] 22%|██▏       | 17/79 [00:00<00:01, 35.43it/s] 28%|██▊       | 22/79 [00:00<00:01, 36.23it/s] 35%|███▌      | 28/79 [00:00<00:01, 36.48it/s] 46%|████▌     | 36/79 [00:01<00:01, 40.68it/s] 54%|█████▍    | 43/79 [00:01<00:00, 46.50it/s] 62%|██████▏   | 49/79 [00:01<00:00, 49.06it/s] 70%|██████▉   | 55/79 [00:01<00:00, 45.51it/s] 76%|███████▌  | 60/79 [00:01<00:00, 39.60it/s] 85%|████████▍ | 67/79 [00:01<00:00, 38.47it/s] 95%|█████████▍| 75/79 [00:02<00:00, 38.78it/s]100%|██████████| 79/79 [00:02<00:00, 38.67it/s]
10000 images processed, 2.0815749168395996 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:19,  4.09it/s] 15%|█▌        | 12/79 [00:00<00:01, 41.72it/s] 29%|██▉       | 23/79 [00:00<00:00, 62.41it/s] 43%|████▎     | 34/79 [00:00<00:00, 76.41it/s] 57%|█████▋    | 45/79 [00:00<00:00, 85.86it/s] 71%|███████   | 56/79 [00:00<00:00, 92.22it/s] 85%|████████▍ | 67/79 [00:00<00:00, 97.26it/s]100%|██████████| 79/79 [00:00<00:00, 103.61it/s]100%|██████████| 79/79 [00:00<00:00, 80.67it/s] 
10000 images processed, 0.9989831447601318 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:17,  3.85it/s] 17%|█▋        | 12/70 [00:00<00:01, 40.85it/s] 33%|███▎      | 23/70 [00:00<00:00, 63.05it/s] 49%|████▊     | 34/70 [00:00<00:00, 77.78it/s] 64%|██████▍   | 45/70 [00:00<00:00, 87.25it/s] 80%|████████  | 56/70 [00:00<00:00, 92.12it/s] 97%|█████████▋| 68/70 [00:00<00:00, 98.24it/s]100%|██████████| 70/70 [00:00<00:00, 74.53it/s]
8925 images processed, 0.9698255062103271 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:34,  1.27it/s]  4%|▍         | 2/45 [00:00<00:16,  2.57it/s] 20%|██        | 9/45 [00:01<00:03, 11.17it/s] 24%|██▍       | 11/45 [00:01<00:03, 11.10it/s] 36%|███▌      | 16/45 [00:01<00:01, 17.57it/s] 42%|████▏     | 19/45 [00:01<00:01, 14.09it/s] 49%|████▉     | 22/45 [00:01<00:01, 13.87it/s] 56%|█████▌    | 25/45 [00:02<00:01, 16.25it/s] 62%|██████▏   | 28/45 [00:02<00:01, 13.73it/s] 67%|██████▋   | 30/45 [00:02<00:01, 13.79it/s] 73%|███████▎  | 33/45 [00:02<00:00, 14.38it/s] 78%|███████▊  | 35/45 [00:02<00:00, 14.66it/s] 82%|████████▏ | 37/45 [00:02<00:00, 15.33it/s] 89%|████████▉ | 40/45 [00:03<00:00, 16.58it/s] 93%|█████████▎| 42/45 [00:03<00:00, 10.73it/s]100%|██████████| 45/45 [00:03<00:00, 12.58it/s]
5640 images processed, 3.5976057052612305 seconds used

16.619362354278564
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
Evaluating forget
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN          96.35  51.50
places365     94.43  50.28
LSUN          93.88  57.42
iSUN          95.96  47.16
dtd           84.91  60.26
forget        95.60  48.34
AVG           93.52  52.49
Forget-Acc: 0.0110 | Retain-Acc: 0.0331
Forget-as-OOD (retain known vs forget novel):
  FPR: 95.60 AUROC: 48.34 AUIN: 89.47
24.93384885787964
