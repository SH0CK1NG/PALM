nohup: ignoring input
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from /home/shaokun/PALM/checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999-eval-retainforget: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<01:47,  3.63it/s]  3%|▎         | 11/391 [00:00<00:10, 36.34it/s]  4%|▍         | 17/391 [00:00<00:08, 43.95it/s]  6%|▌         | 23/391 [00:00<00:08, 45.99it/s]  7%|▋         | 29/391 [00:00<00:07, 47.95it/s]  9%|▉         | 35/391 [00:00<00:07, 50.40it/s] 10%|█         | 41/391 [00:00<00:06, 50.66it/s] 12%|█▏        | 47/391 [00:01<00:06, 51.69it/s] 14%|█▎        | 53/391 [00:01<00:06, 50.68it/s] 15%|█▌        | 60/391 [00:01<00:06, 53.27it/s] 17%|█▋        | 66/391 [00:01<00:06, 52.10it/s] 18%|█▊        | 72/391 [00:01<00:06, 51.80it/s] 20%|█▉        | 78/391 [00:01<00:05, 52.66it/s] 21%|██▏       | 84/391 [00:01<00:05, 52.51it/s] 23%|██▎       | 90/391 [00:01<00:05, 53.19it/s] 25%|██▍       | 96/391 [00:01<00:05, 53.05it/s] 26%|██▌       | 102/391 [00:02<00:05, 53.34it/s] 28%|██▊       | 108/391 [00:02<00:05, 52.14it/s] 29%|██▉       | 114/391 [00:02<00:05, 52.12it/s] 31%|███       | 120/391 [00:02<00:05, 53.18it/s] 32%|███▏      | 126/391 [00:02<00:05, 52.52it/s] 34%|███▍      | 132/391 [00:02<00:04, 53.22it/s] 35%|███▌      | 138/391 [00:02<00:04, 53.05it/s] 37%|███▋      | 144/391 [00:02<00:04, 53.35it/s] 38%|███▊      | 150/391 [00:03<00:04, 52.21it/s] 40%|███▉      | 156/391 [00:03<00:04, 52.14it/s] 41%|████▏     | 162/391 [00:03<00:04, 52.75it/s] 43%|████▎     | 168/391 [00:03<00:04, 51.42it/s] 45%|████▍     | 174/391 [00:03<00:04, 52.17it/s] 47%|████▋     | 184/391 [00:03<00:03, 63.84it/s] 50%|████▉     | 195/391 [00:03<00:02, 74.87it/s] 53%|█████▎    | 206/391 [00:03<00:02, 82.71it/s] 55%|█████▌    | 217/391 [00:03<00:01, 88.30it/s] 58%|█████▊    | 228/391 [00:04<00:01, 92.33it/s] 61%|██████    | 239/391 [00:04<00:01, 95.14it/s] 64%|██████▎   | 249/391 [00:04<00:01, 84.73it/s] 66%|██████▌   | 258/391 [00:04<00:01, 72.33it/s] 68%|██████▊   | 266/391 [00:04<00:01, 68.37it/s] 70%|███████   | 274/391 [00:04<00:01, 69.52it/s] 72%|███████▏  | 282/391 [00:04<00:01, 62.73it/s] 74%|███████▍  | 289/391 [00:04<00:01, 59.34it/s] 76%|███████▌  | 298/391 [00:05<00:01, 66.53it/s] 78%|███████▊  | 305/391 [00:05<00:01, 63.93it/s] 80%|███████▉  | 312/391 [00:05<00:01, 59.19it/s] 82%|████████▏ | 319/391 [00:05<00:01, 57.06it/s] 84%|████████▍ | 329/391 [00:05<00:00, 64.87it/s] 86%|████████▌ | 336/391 [00:05<00:00, 60.92it/s] 88%|████████▊ | 343/391 [00:05<00:00, 59.00it/s] 89%|████████▉ | 349/391 [00:05<00:00, 58.24it/s] 92%|█████████▏| 358/391 [00:06<00:00, 63.92it/s] 93%|█████████▎| 365/391 [00:06<00:00, 60.13it/s] 95%|█████████▌| 372/391 [00:06<00:00, 58.41it/s] 97%|█████████▋| 379/391 [00:06<00:00, 60.25it/s] 99%|█████████▉| 387/391 [00:06<00:00, 63.92it/s]100%|██████████| 391/391 [00:06<00:00, 58.96it/s]
50000 images processed, 6.9969093799591064 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:16,  4.78it/s] 14%|█▍        | 11/79 [00:00<00:01, 41.71it/s] 27%|██▋       | 21/79 [00:00<00:00, 62.23it/s] 37%|███▋      | 29/79 [00:00<00:00, 57.63it/s] 46%|████▌     | 36/79 [00:00<00:00, 56.62it/s] 54%|█████▍    | 43/79 [00:00<00:00, 56.24it/s] 66%|██████▌   | 52/79 [00:00<00:00, 62.98it/s] 75%|███████▍  | 59/79 [00:01<00:00, 58.82it/s] 84%|████████▎ | 66/79 [00:01<00:00, 57.68it/s] 92%|█████████▏| 73/79 [00:01<00:00, 59.67it/s]100%|██████████| 79/79 [00:01<00:00, 57.19it/s]
10000 images processed, 1.4659199714660645 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<00:41,  4.93it/s]  5%|▌         | 11/204 [00:00<00:04, 44.05it/s] 10%|▉         | 20/204 [00:00<00:03, 58.25it/s] 13%|█▎        | 27/204 [00:00<00:03, 54.59it/s] 17%|█▋        | 34/204 [00:00<00:03, 51.46it/s] 21%|██        | 43/204 [00:00<00:02, 61.19it/s] 25%|██▍       | 50/204 [00:00<00:02, 61.71it/s] 28%|██▊       | 57/204 [00:01<00:02, 55.99it/s] 31%|███       | 63/204 [00:01<00:02, 53.41it/s] 36%|███▌      | 73/204 [00:01<00:02, 65.07it/s] 39%|███▉      | 80/204 [00:01<00:02, 60.30it/s] 43%|████▎     | 87/204 [00:01<00:02, 57.18it/s] 46%|████▌     | 93/204 [00:01<00:01, 55.89it/s] 50%|█████     | 102/204 [00:01<00:01, 64.57it/s] 53%|█████▎    | 109/204 [00:01<00:01, 57.86it/s] 57%|█████▋    | 116/204 [00:02<00:01, 59.06it/s] 60%|██████    | 123/204 [00:02<00:01, 58.26it/s] 64%|██████▍   | 131/204 [00:02<00:01, 62.36it/s] 68%|██████▊   | 138/204 [00:02<00:01, 58.89it/s] 72%|███████▏  | 146/204 [00:02<00:00, 61.58it/s] 75%|███████▌  | 153/204 [00:02<00:00, 59.74it/s] 78%|███████▊  | 160/204 [00:02<00:00, 62.24it/s] 82%|████████▏ | 167/204 [00:02<00:00, 58.95it/s] 85%|████████▌ | 174/204 [00:03<00:00, 60.22it/s] 89%|████████▊ | 181/204 [00:03<00:00, 59.01it/s] 92%|█████████▏| 188/204 [00:03<00:00, 61.60it/s] 96%|█████████▌| 195/204 [00:03<00:00, 58.53it/s]100%|█████████▉| 203/204 [00:03<00:00, 62.50it/s]100%|██████████| 204/204 [00:03<00:00, 58.29it/s]
26032 images processed, 3.6901044845581055 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:29,  2.65it/s] 11%|█▏        | 9/79 [00:00<00:03, 21.12it/s] 18%|█▊        | 14/79 [00:00<00:02, 28.17it/s] 28%|██▊       | 22/79 [00:00<00:01, 40.65it/s] 35%|███▌      | 28/79 [00:00<00:01, 42.30it/s] 47%|████▋     | 37/79 [00:00<00:00, 52.49it/s] 54%|█████▍    | 43/79 [00:01<00:00, 49.84it/s] 63%|██████▎   | 50/79 [00:01<00:00, 54.44it/s] 71%|███████   | 56/79 [00:01<00:00, 52.53it/s] 81%|████████  | 64/79 [00:01<00:00, 50.86it/s] 91%|█████████ | 72/79 [00:01<00:00, 50.65it/s] 99%|█████████▊| 78/79 [00:01<00:00, 49.57it/s]100%|██████████| 79/79 [00:01<00:00, 43.61it/s]
10000 images processed, 1.896716833114624 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:20,  3.87it/s] 11%|█▏        | 9/79 [00:00<00:02, 29.91it/s] 18%|█▊        | 14/79 [00:00<00:01, 36.40it/s] 27%|██▋       | 21/79 [00:00<00:01, 46.08it/s] 34%|███▍      | 27/79 [00:00<00:01, 46.27it/s] 47%|████▋     | 37/79 [00:00<00:00, 60.11it/s] 56%|█████▌    | 44/79 [00:00<00:00, 55.66it/s] 63%|██████▎   | 50/79 [00:01<00:00, 56.63it/s] 71%|███████   | 56/79 [00:01<00:00, 53.97it/s] 84%|████████▎ | 66/79 [00:01<00:00, 66.28it/s] 92%|█████████▏| 73/79 [00:01<00:00, 59.41it/s]100%|██████████| 79/79 [00:01<00:00, 51.50it/s]
10000 images processed, 1.6086649894714355 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:19,  3.59it/s]  9%|▊         | 6/70 [00:00<00:03, 19.10it/s] 21%|██▏       | 15/70 [00:00<00:01, 41.95it/s] 31%|███▏      | 22/70 [00:00<00:01, 47.60it/s] 40%|████      | 28/70 [00:00<00:00, 50.92it/s] 49%|████▊     | 34/70 [00:00<00:00, 49.93it/s] 57%|█████▋    | 40/70 [00:00<00:00, 49.97it/s] 66%|██████▌   | 46/70 [00:01<00:00, 49.43it/s] 81%|████████▏ | 57/70 [00:01<00:00, 63.79it/s] 91%|█████████▏| 64/70 [00:01<00:00, 57.93it/s]100%|██████████| 70/70 [00:01<00:00, 48.28it/s]
8925 images processed, 1.5234036445617676 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:30,  1.45it/s]  4%|▍         | 2/45 [00:00<00:15,  2.77it/s] 20%|██        | 9/45 [00:01<00:02, 12.21it/s] 24%|██▍       | 11/45 [00:01<00:03, 11.10it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.17it/s] 42%|████▏     | 19/45 [00:01<00:01, 14.46it/s] 56%|█████▌    | 25/45 [00:02<00:01, 16.85it/s] 60%|██████    | 27/45 [00:02<00:01, 15.61it/s] 67%|██████▋   | 30/45 [00:02<00:00, 17.19it/s] 73%|███████▎  | 33/45 [00:02<00:00, 14.13it/s] 78%|███████▊  | 35/45 [00:02<00:00, 13.21it/s] 91%|█████████ | 41/45 [00:03<00:00, 17.34it/s] 96%|█████████▌| 43/45 [00:03<00:00, 11.26it/s]100%|██████████| 45/45 [00:03<00:00, 12.78it/s]
5640 images processed, 3.5735225677490234 seconds used

22.213595628738403
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
Evaluating forget
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.62  99.34
places365     68.66  80.90
LSUN          21.98  95.05
iSUN          72.91  81.45
dtd           38.99  91.15
forget        83.50  86.18
AVG           48.11  89.01
Forget-Acc: 0.7530 | Retain-Acc: 0.7433
Forget-as-OOD (retain known vs forget novel):
  FPR: 83.50 AUROC: 86.18 AUIN: 98.32
14.375449657440186
