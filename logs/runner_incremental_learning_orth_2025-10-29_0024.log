nohup: ignoring input
==== Stage 1: inc={100,101,102,103,104}; seen={}; all(union)={100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='100,101,102,103,104', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:163: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [00:43<35:35, 43.59s/it]  4%|▍         | 2/50 [01:20<31:55, 39.90s/it]  6%|▌         | 3/50 [01:57<30:07, 38.46s/it]  8%|▊         | 4/50 [02:35<29:24, 38.36s/it] 10%|█         | 5/50 [03:13<28:32, 38.04s/it] 12%|█▏        | 6/50 [03:51<27:49, 37.95s/it][loss] ep 0 it 0 total=9.6581 mle=2.3316 pcon=5.2736 forget=2.0529 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 0 it 50 total=9.7605 mle=2.5728 pcon=5.2739 forget=1.9137 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 0 it 100 total=9.2445 mle=1.9904 pcon=5.2741 forget=1.9800 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 0 it 150 total=9.0979 mle=1.8192 pcon=5.2743 forget=2.0045 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 0 it 200 total=9.2396 mle=1.9657 pcon=5.2745 forget=1.9994 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 0 it 250 total=9.8013 mle=2.5549 pcon=5.2747 forget=1.9717 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 0 it 300 total=9.3637 mle=2.0762 pcon=5.2749 forget=2.0126 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 0 it 350 total=9.7394 mle=2.4148 pcon=5.2750 forget=2.0495 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 0 it 400 total=9.6157 mle=2.3408 pcon=5.2752 forget=1.9997 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 1 it 21 total=9.2814 mle=2.0095 pcon=5.2753 forget=1.9965 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 1 it 71 total=9.4014 mle=2.1355 pcon=5.2755 forget=1.9904 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 1 it 121 total=9.6374 mle=2.3412 pcon=5.2756 forget=2.0207 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 1 it 171 total=9.5240 mle=2.2210 pcon=5.2757 forget=2.0273 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 1 it 221 total=9.5965 mle=2.3960 pcon=5.2758 forget=1.9247 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 1 it 271 total=9.4409 mle=2.2061 pcon=5.2758 forget=1.9589 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 1 it 321 total=9.2347 mle=1.9375 pcon=5.2759 forget=2.0213 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 1 it 371 total=9.2101 mle=1.9402 pcon=5.2759 forget=1.9940 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 1 it 421 total=9.2303 mle=2.0189 pcon=5.2760 forget=1.9354 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 2 it 42 total=9.6474 mle=2.3479 pcon=5.2760 forget=2.0234 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 2 it 92 total=9.9812 mle=2.7493 pcon=5.2761 forget=1.9559 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 2 it 142 total=9.5517 mle=2.3008 pcon=5.2760 forget=1.9749 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 2 it 192 total=9.1537 mle=1.8463 pcon=5.2760 forget=2.0313 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 2 it 242 total=9.2652 mle=2.0159 pcon=5.2760 forget=1.9732 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 2 it 292 total=9.7574 mle=2.5291 pcon=5.2760 forget=1.9522 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 2 it 342 total=9.5292 mle=2.3206 pcon=5.2760 forget=1.9326 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 2 it 392 total=9.5074 mle=2.2941 pcon=5.2760 forget=1.9373 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 3 it 13 total=9.0011 mle=1.7834 pcon=5.2760 forget=1.9417 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 3 it 63 total=9.4942 mle=2.2701 pcon=5.2759 forget=1.9481 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 3 it 113 total=9.4548 mle=2.2669 pcon=5.2759 forget=1.9120 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 3 it 163 total=9.0918 mle=1.8711 pcon=5.2758 forget=1.9449 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 3 it 213 total=9.1415 mle=1.9037 pcon=5.2757 forget=1.9620 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 3 it 263 total=9.4255 mle=2.2089 pcon=5.2757 forget=1.9409 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 3 it 313 total=9.1206 mle=1.8412 pcon=5.2757 forget=2.0037 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 3 it 363 total=9.4559 mle=2.2374 pcon=5.2757 forget=1.9428 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 3 it 413 total=9.2594 mle=2.0363 pcon=5.2757 forget=1.9474 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 4 it 34 total=9.2740 mle=2.0202 pcon=5.2758 forget=1.9779 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 4 it 84 total=9.1089 mle=1.9045 pcon=5.2758 forget=1.9287 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 4 it 134 total=9.5050 mle=2.2300 pcon=5.2758 forget=1.9992 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 4 it 184 total=9.2779 mle=2.0411 pcon=5.2759 forget=1.9609 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 4 it 234 total=9.1855 mle=1.9683 pcon=5.2761 forget=1.9411 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 4 it 284 total=9.1816 mle=1.9172 pcon=5.2763 forget=1.9880 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 4 it 334 total=9.3556 mle=2.1467 pcon=5.2765 forget=1.9324 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 4 it 384 total=9.3583 mle=2.2109 pcon=5.2768 forget=1.8706 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 5 it 5 total=9.2102 mle=2.0217 pcon=5.2771 forget=1.9114 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 5 it 55 total=8.8684 mle=1.7211 pcon=5.2773 forget=1.8700 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 5 it 105 total=8.9403 mle=1.7309 pcon=5.2775 forget=1.9319 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 5 it 155 total=9.1961 mle=2.0384 pcon=5.2777 forget=1.8801 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 5 it 205 total=8.8151 mle=1.7113 pcon=5.2777 forget=1.8260 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 5 it 255 total=9.3376 mle=2.2409 pcon=5.2778 forget=1.8189 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 5 it 305 total=9.2598 mle=2.1567 pcon=5.2777 forget=1.8253 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 5 it 355 total=9.0772 mle=2.0179 pcon=5.2775 forget=1.7818 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 5 it 405 total=9.0054 mle=1.8922 pcon=5.2770 forget=1.8362 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 6 it 26 total=8.9312 mle=1.9104 pcon=5.2764 forget=1.7444 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 6 it 76 total=9.3455 mle=2.3150 pcon=5.2758 forget=1.7548 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
 14%|█▍        | 7/50 [04:28<27:02, 37.74s/it] 16%|█▌        | 8/50 [05:05<26:15, 37.51s/it] 18%|█▊        | 9/50 [05:44<25:52, 37.88s/it] 20%|██        | 10/50 [06:21<25:08, 37.72s/it] 22%|██▏       | 11/50 [06:59<24:31, 37.72s/it] 24%|██▍       | 12/50 [07:36<23:50, 37.64s/it][loss] ep 6 it 126 total=8.8069 mle=1.8286 pcon=5.2748 forget=1.7035 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 6 it 176 total=8.7908 mle=1.8076 pcon=5.2736 forget=1.7096 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 6 it 226 total=9.2840 mle=2.2290 pcon=5.2723 forget=1.7827 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 6 it 276 total=8.9544 mle=1.9822 pcon=5.2707 forget=1.7015 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 6 it 326 total=9.1679 mle=2.0958 pcon=5.2689 forget=1.8031 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 6 it 376 total=8.7914 mle=1.7839 pcon=5.2668 forget=1.7407 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 6 it 426 total=9.0320 mle=2.0071 pcon=5.2647 forget=1.7602 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 7 it 47 total=8.9393 mle=1.9121 pcon=5.2623 forget=1.7649 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 7 it 97 total=9.0407 mle=1.9955 pcon=5.2597 forget=1.7854 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 7 it 147 total=8.8937 mle=1.8522 pcon=5.2571 forget=1.7844 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 7 it 197 total=9.1650 mle=2.1209 pcon=5.2544 forget=1.7897 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 7 it 247 total=9.0579 mle=1.9884 pcon=5.2516 forget=1.8180 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 7 it 297 total=8.8542 mle=1.7843 pcon=5.2486 forget=1.8212 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 7 it 347 total=8.7133 mle=1.6376 pcon=5.2454 forget=1.8302 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 7 it 397 total=8.9454 mle=1.8809 pcon=5.2420 forget=1.8224 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 8 it 18 total=8.8631 mle=1.7693 pcon=5.2386 forget=1.8553 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 8 it 68 total=9.1439 mle=2.0174 pcon=5.2351 forget=1.8913 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 8 it 118 total=9.1365 mle=2.0154 pcon=5.2316 forget=1.8896 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 8 it 168 total=9.0362 mle=1.8869 pcon=5.2280 forget=1.9213 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 8 it 218 total=8.8712 mle=1.7299 pcon=5.2243 forget=1.9169 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 8 it 268 total=8.9467 mle=1.8315 pcon=5.2207 forget=1.8944 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 8 it 318 total=9.1284 mle=1.9912 pcon=5.2171 forget=1.9201 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 8 it 368 total=9.2054 mle=2.0770 pcon=5.2133 forget=1.9151 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 8 it 418 total=8.8166 mle=1.6907 pcon=5.2097 forget=1.9161 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 9 it 39 total=8.8851 mle=1.7547 pcon=5.2061 forget=1.9243 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 9 it 89 total=9.0030 mle=1.8828 pcon=5.2024 forget=1.9178 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 9 it 139 total=9.3150 mle=2.2104 pcon=5.1985 forget=1.9062 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 9 it 189 total=9.0321 mle=1.9313 pcon=5.1947 forget=1.9061 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 9 it 239 total=9.0696 mle=1.9718 pcon=5.1910 forget=1.9068 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 9 it 289 total=9.1273 mle=2.0540 pcon=5.1874 forget=1.8859 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 9 it 339 total=8.7394 mle=1.6889 pcon=5.1841 forget=1.8664 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 9 it 389 total=9.4660 mle=2.4204 pcon=5.1813 forget=1.8643 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 10 it 10 total=8.7945 mle=1.7702 pcon=5.1788 forget=1.8454 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 10 it 60 total=8.9478 mle=1.9608 pcon=5.1766 forget=1.8104 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 10 it 110 total=8.7909 mle=1.8391 pcon=5.1747 forget=1.7770 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 10 it 160 total=8.7368 mle=1.8136 pcon=5.1733 forget=1.7499 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 10 it 210 total=8.8457 mle=1.9490 pcon=5.1721 forget=1.7246 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 10 it 260 total=8.5350 mle=1.6702 pcon=5.1715 forget=1.6933 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 10 it 310 total=8.9425 mle=2.1512 pcon=5.1714 forget=1.6199 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 10 it 360 total=8.9703 mle=2.1993 pcon=5.1718 forget=1.5992 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 10 it 410 total=8.6191 mle=1.9133 pcon=5.1726 forget=1.5332 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 11 it 31 total=8.6744 mle=2.0032 pcon=5.1739 forget=1.4973 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 11 it 81 total=8.8218 mle=2.1783 pcon=5.1755 forget=1.4680 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 11 it 131 total=8.5211 mle=1.9052 pcon=5.1774 forget=1.4385 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 11 it 181 total=8.6493 mle=2.0655 pcon=5.1795 forget=1.4044 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 11 it 231 total=8.6425 mle=2.1234 pcon=5.1818 forget=1.3373 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 11 it 281 total=8.4823 mle=1.9563 pcon=5.1842 forget=1.3418 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 11 it 331 total=8.5713 mle=2.0727 pcon=5.1867 forget=1.3118 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 11 it 381 total=8.3929 mle=1.9370 pcon=5.1893 forget=1.2665 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 12 it 2 total=8.4200 mle=2.0034 pcon=5.1917 forget=1.2250 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 12 it 52 total=8.4208 mle=1.9839 pcon=5.1939 forget=1.2429 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 12 it 102 total=8.5982 mle=2.2070 pcon=5.1962 forget=1.1950 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 12 it 152 total=8.5298 mle=2.1612 pcon=5.1983 forget=1.1703 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 12 it 202 total=8.6792 mle=2.2408 pcon=5.2004 forget=1.2380 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 12 it 252 total=8.4082 mle=2.0383 pcon=5.2024 forget=1.1675 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 12 it 302 total=8.2504 mle=1.8851 pcon=5.2042 forget=1.1611 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 12 it 352 total=8.3620 mle=1.9673 pcon=5.2059 forget=1.1888 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 12 it 402 total=8.1903 mle=1.7773 pcon=5.2077 forget=1.2054 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
 26%|██▌       | 13/50 [08:13<23:09, 37.54s/it] 28%|██▊       | 14/50 [08:51<22:35, 37.67s/it] 30%|███       | 15/50 [09:29<21:58, 37.69s/it] 32%|███▏      | 16/50 [10:07<21:25, 37.80s/it] 34%|███▍      | 17/50 [10:44<20:38, 37.52s/it] 36%|███▌      | 18/50 [11:22<20:05, 37.66s/it] 38%|███▊      | 19/50 [11:59<19:23, 37.52s/it][peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 13 it 23 total=8.1893 mle=1.8182 pcon=5.2093 forget=1.1617 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 13 it 73 total=8.2772 mle=1.8871 pcon=5.2110 forget=1.1791 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 13 it 123 total=8.7309 mle=2.3394 pcon=5.2126 forget=1.1788 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 13 it 173 total=8.4299 mle=1.9985 pcon=5.2144 forget=1.2169 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 13 it 223 total=8.0776 mle=1.6321 pcon=5.2161 forget=1.2294 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 13 it 273 total=8.8647 mle=2.3527 pcon=5.2178 forget=1.2942 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 13 it 323 total=8.4711 mle=1.9615 pcon=5.2196 forget=1.2900 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 13 it 373 total=8.6952 mle=2.1912 pcon=5.2212 forget=1.2828 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 13 it 423 total=8.4865 mle=1.9204 pcon=5.2228 forget=1.3433 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 14 it 44 total=8.3507 mle=1.7899 pcon=5.2245 forget=1.3363 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 14 it 94 total=8.5093 mle=1.9263 pcon=5.2262 forget=1.3568 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 14 it 144 total=8.6163 mle=1.9902 pcon=5.2278 forget=1.3983 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 14 it 194 total=8.6214 mle=2.0216 pcon=5.2293 forget=1.3705 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 14 it 244 total=8.5814 mle=1.9280 pcon=5.2307 forget=1.4227 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 14 it 294 total=8.7335 mle=2.0725 pcon=5.2321 forget=1.4290 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 14 it 344 total=8.3966 mle=1.7119 pcon=5.2333 forget=1.4515 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 14 it 394 total=8.4539 mle=1.7600 pcon=5.2344 forget=1.4594 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 15 it 15 total=8.8385 mle=2.1136 pcon=5.2354 forget=1.4895 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 15 it 65 total=8.8060 mle=2.0607 pcon=5.2364 forget=1.5089 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 15 it 115 total=8.8067 mle=2.0415 pcon=5.2370 forget=1.5282 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 15 it 165 total=8.6817 mle=1.8965 pcon=5.2375 forget=1.5477 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 15 it 215 total=8.5398 mle=1.7236 pcon=5.2379 forget=1.5783 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 15 it 265 total=8.6767 mle=1.8579 pcon=5.2380 forget=1.5808 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 15 it 315 total=8.9805 mle=2.1436 pcon=5.2380 forget=1.5990 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 15 it 365 total=8.9308 mle=2.0811 pcon=5.2378 forget=1.6119 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 15 it 415 total=8.5413 mle=1.6874 pcon=5.2374 forget=1.6165 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 16 it 36 total=8.9444 mle=2.0800 pcon=5.2367 forget=1.6277 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 16 it 86 total=8.7138 mle=1.8231 pcon=5.2357 forget=1.6550 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 16 it 136 total=8.8174 mle=1.9331 pcon=5.2344 forget=1.6499 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 16 it 186 total=8.9127 mle=2.0586 pcon=5.2329 forget=1.6212 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 16 it 236 total=8.6674 mle=1.8145 pcon=5.2312 forget=1.6217 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 16 it 286 total=8.6927 mle=1.8528 pcon=5.2290 forget=1.6110 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 16 it 336 total=8.7317 mle=1.8937 pcon=5.2265 forget=1.6114 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 16 it 386 total=8.9267 mle=2.1552 pcon=5.2238 forget=1.5476 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 17 it 7 total=8.5710 mle=1.7739 pcon=5.2207 forget=1.5764 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 17 it 57 total=8.6448 mle=1.9305 pcon=5.2174 forget=1.4969 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 17 it 107 total=8.7011 mle=1.9287 pcon=5.2140 forget=1.5584 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 17 it 157 total=8.6743 mle=1.9941 pcon=5.2104 forget=1.4698 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 17 it 207 total=8.6319 mle=1.9787 pcon=5.2065 forget=1.4467 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 17 it 257 total=8.3575 mle=1.7088 pcon=5.2027 forget=1.4460 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 17 it 307 total=8.5655 mle=2.0233 pcon=5.1989 forget=1.3434 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 17 it 357 total=8.5757 mle=2.0729 pcon=5.1949 forget=1.3078 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 17 it 407 total=8.7384 mle=2.2971 pcon=5.1910 forget=1.2502 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 18 it 28 total=8.3050 mle=1.8422 pcon=5.1871 forget=1.2757 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 18 it 78 total=8.4387 mle=2.0217 pcon=5.1834 forget=1.2337 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 18 it 128 total=8.5148 mle=2.1568 pcon=5.1800 forget=1.1781 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 18 it 178 total=8.2663 mle=1.8750 pcon=5.1767 forget=1.2145 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 18 it 228 total=8.5244 mle=2.1370 pcon=5.1737 forget=1.2137 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 18 it 278 total=8.2130 mle=1.7911 pcon=5.1707 forget=1.2512 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 18 it 328 total=8.3366 mle=1.9215 pcon=5.1680 forget=1.2471 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 18 it 378 total=8.5219 mle=2.1173 pcon=5.1654 forget=1.2392 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 18 it 428 total=8.4506 mle=2.0062 pcon=5.1630 forget=1.2814 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[loss] ep 19 it 49 total=8.2532 mle=1.8138 pcon=5.1607 forget=1.2786 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 19 it 99 total=8.1863 mle=1.7666 pcon=5.1586 forget=1.2611 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 19 it 149 total=8.4164 mle=1.9906 pcon=5.1567 forget=1.2691 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 19 it 199 total=8.6119 mle=2.1558 pcon=5.1548 forget=1.3013 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 19 it 249 total=8.3610 mle=1.8847 pcon=5.1531 forget=1.3231 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 19 it 299 total=8.4793 mle=1.9871 pcon=5.1516 forget=1.3406 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 19 it 349 total=8.6444 mle=2.1513 pcon=5.1501 forget=1.3430 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
 40%|████      | 20/50 [12:37<18:50, 37.69s/it] 42%|████▏     | 21/50 [13:16<18:23, 38.05s/it] 44%|████▍     | 22/50 [13:53<17:38, 37.79s/it] 46%|████▌     | 23/50 [14:31<16:57, 37.67s/it] 48%|████▊     | 24/50 [15:07<16:09, 37.30s/it] 50%|█████     | 25/50 [15:45<15:39, 37.57s/it] 52%|█████▏    | 26/50 [16:23<15:03, 37.63s/it] 54%|█████▍    | 27/50 [17:01<14:25, 37.61s/it][loss] ep 19 it 399 total=8.3583 mle=1.8695 pcon=5.1488 forget=1.3399 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 20 it 20 total=8.4262 mle=1.9285 pcon=5.1476 forget=1.3501 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 20 it 70 total=8.3402 mle=1.8345 pcon=5.1465 forget=1.3592 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 20 it 120 total=8.3900 mle=1.8670 pcon=5.1457 forget=1.3773 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 20 it 170 total=8.3196 mle=1.7780 pcon=5.1448 forget=1.3968 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 20 it 220 total=8.6654 mle=2.1340 pcon=5.1440 forget=1.3875 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 20 it 270 total=8.5967 mle=2.0128 pcon=5.1434 forget=1.4405 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 20 it 320 total=8.5461 mle=1.9862 pcon=5.1428 forget=1.4171 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 20 it 370 total=8.4795 mle=1.8967 pcon=5.1423 forget=1.4405 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 20 it 420 total=8.4953 mle=1.9194 pcon=5.1419 forget=1.4341 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 21 it 41 total=8.4409 mle=1.8584 pcon=5.1416 forget=1.4410 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 21 it 91 total=8.2951 mle=1.6979 pcon=5.1414 forget=1.4559 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 21 it 141 total=8.8026 mle=2.1951 pcon=5.1413 forget=1.4662 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 21 it 191 total=8.6490 mle=2.0078 pcon=5.1412 forget=1.4999 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 21 it 241 total=8.7264 mle=2.1066 pcon=5.1413 forget=1.4785 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 21 it 291 total=8.6628 mle=2.0657 pcon=5.1415 forget=1.4556 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 21 it 341 total=8.3642 mle=1.7045 pcon=5.1417 forget=1.5180 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 21 it 391 total=8.6704 mle=2.0212 pcon=5.1419 forget=1.5074 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 22 it 12 total=8.6276 mle=1.9747 pcon=5.1422 forget=1.5108 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 22 it 62 total=8.8087 mle=2.1404 pcon=5.1424 forget=1.5259 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 22 it 112 total=8.6725 mle=2.0245 pcon=5.1427 forget=1.5053 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 22 it 162 total=8.7667 mle=2.1388 pcon=5.1430 forget=1.4848 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 22 it 212 total=8.8404 mle=2.1478 pcon=5.1434 forget=1.5493 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 22 it 262 total=8.4846 mle=1.8374 pcon=5.1436 forget=1.5035 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 22 it 312 total=8.7145 mle=2.0715 pcon=5.1438 forget=1.4991 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 22 it 362 total=8.6073 mle=1.9481 pcon=5.1441 forget=1.5152 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 22 it 412 total=8.8089 mle=2.1573 pcon=5.1443 forget=1.5073 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 23 it 33 total=8.4325 mle=1.7862 pcon=5.1445 forget=1.5018 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 23 it 83 total=8.7510 mle=2.0498 pcon=5.1446 forget=1.5565 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 23 it 133 total=8.8474 mle=2.1393 pcon=5.1447 forget=1.5633 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 23 it 183 total=8.4743 mle=1.8271 pcon=5.1446 forget=1.5025 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 23 it 233 total=8.5637 mle=1.9242 pcon=5.1446 forget=1.4949 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 23 it 283 total=8.7385 mle=2.0247 pcon=5.1445 forget=1.5693 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 23 it 333 total=8.8335 mle=2.1340 pcon=5.1442 forget=1.5552 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 23 it 383 total=8.6606 mle=1.9726 pcon=5.1439 forget=1.5441 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 24 it 4 total=8.7251 mle=2.0445 pcon=5.1435 forget=1.5371 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 24 it 54 total=8.4421 mle=1.7668 pcon=5.1432 forget=1.5322 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 24 it 104 total=8.7004 mle=1.9376 pcon=5.1428 forget=1.6200 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 24 it 154 total=8.7396 mle=2.0105 pcon=5.1423 forget=1.5867 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 24 it 204 total=8.5282 mle=1.8255 pcon=5.1417 forget=1.5610 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 24 it 254 total=8.5329 mle=1.8425 pcon=5.1410 forget=1.5494 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 24 it 304 total=8.8559 mle=2.1671 pcon=5.1403 forget=1.5484 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 24 it 354 total=8.5868 mle=1.8600 pcon=5.1395 forget=1.5873 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 24 it 404 total=8.8507 mle=2.1009 pcon=5.1386 forget=1.6112 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 25 it 25 total=8.5675 mle=1.8553 pcon=5.1377 forget=1.5745 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 25 it 75 total=8.8487 mle=2.1305 pcon=5.1366 forget=1.5816 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 25 it 125 total=8.7930 mle=2.0793 pcon=5.1355 forget=1.5783 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 25 it 175 total=8.7889 mle=2.0808 pcon=5.1343 forget=1.5739 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 25 it 225 total=8.5794 mle=1.8426 pcon=5.1331 forget=1.6038 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 25 it 275 total=8.7087 mle=1.9516 pcon=5.1318 forget=1.6253 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 25 it 325 total=8.7147 mle=1.9634 pcon=5.1303 forget=1.6210 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 25 it 375 total=8.5982 mle=1.8433 pcon=5.1290 forget=1.6259 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 25 it 425 total=8.5830 mle=1.8470 pcon=5.1275 forget=1.6085 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 26 it 46 total=8.5424 mle=1.7987 pcon=5.1261 forget=1.6176 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 26 it 96 total=8.7150 mle=1.9592 pcon=5.1245 forget=1.6313 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 26 it 146 total=8.5638 mle=1.8302 pcon=5.1229 forget=1.6107 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 26 it 196 total=8.6322 mle=1.8793 pcon=5.1213 forget=1.6316 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 26 it 246 total=8.8876 mle=2.1073 pcon=5.1196 forget=1.6607 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 26 it 296 total=8.5919 mle=1.8144 pcon=5.1179 forget=1.6596 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 26 it 346 total=8.6554 mle=1.8970 pcon=5.1163 forget=1.6422 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 26 it 396 total=8.7647 mle=2.0254 pcon=5.1145 forget=1.6248 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 27 it 17 total=8.5229 mle=1.7883 pcon=5.1128 forget=1.6218 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
 56%|█████▌    | 28/50 [17:39<13:51, 37.80s/it] 58%|█████▊    | 29/50 [18:16<13:11, 37.68s/it] 60%|██████    | 30/50 [18:55<12:36, 37.84s/it] 62%|██████▏   | 31/50 [19:32<11:57, 37.75s/it] 64%|██████▍   | 32/50 [20:11<11:23, 37.98s/it] 66%|██████▌   | 33/50 [20:50<10:50, 38.25s/it] 68%|██████▊   | 34/50 [21:28<10:12, 38.28s/it][loss] ep 27 it 67 total=8.7679 mle=2.0099 pcon=5.1111 forget=1.6469 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 27 it 117 total=8.8759 mle=2.1291 pcon=5.1095 forget=1.6373 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 27 it 167 total=8.7320 mle=1.9733 pcon=5.1079 forget=1.6507 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 27 it 217 total=8.4840 mle=1.7321 pcon=5.1063 forget=1.6456 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 27 it 267 total=8.5454 mle=1.8136 pcon=5.1049 forget=1.6268 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 27 it 317 total=8.4373 mle=1.6883 pcon=5.1034 forget=1.6456 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 27 it 367 total=8.4642 mle=1.7091 pcon=5.1020 forget=1.6530 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 27 it 417 total=8.8013 mle=2.0653 pcon=5.1008 forget=1.6352 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 28 it 38 total=8.5481 mle=1.8157 pcon=5.0995 forget=1.6329 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 28 it 88 total=8.7500 mle=1.9881 pcon=5.0983 forget=1.6635 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 28 it 138 total=8.7675 mle=2.0094 pcon=5.0972 forget=1.6609 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 28 it 188 total=8.6420 mle=1.8835 pcon=5.0961 forget=1.6624 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 28 it 238 total=8.7982 mle=2.0343 pcon=5.0951 forget=1.6687 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 28 it 288 total=8.6099 mle=1.8462 pcon=5.0942 forget=1.6695 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 28 it 338 total=8.6598 mle=1.9049 pcon=5.0935 forget=1.6614 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 28 it 388 total=8.6354 mle=1.8711 pcon=5.0927 forget=1.6716 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 29 it 9 total=8.5165 mle=1.7638 pcon=5.0921 forget=1.6606 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 29 it 59 total=8.6612 mle=1.9112 pcon=5.0914 forget=1.6586 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 29 it 109 total=8.5891 mle=1.8492 pcon=5.0910 forget=1.6489 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 29 it 159 total=8.7076 mle=1.9330 pcon=5.0904 forget=1.6842 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 29 it 209 total=8.6359 mle=1.8943 pcon=5.0901 forget=1.6515 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 29 it 259 total=8.5074 mle=1.7513 pcon=5.0898 forget=1.6662 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 29 it 309 total=8.5815 mle=1.8228 pcon=5.0897 forget=1.6689 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 29 it 359 total=8.7338 mle=2.0072 pcon=5.0897 forget=1.6369 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 29 it 409 total=8.8606 mle=2.1010 pcon=5.0897 forget=1.6700 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 30 it 30 total=8.7442 mle=1.9904 pcon=5.0898 forget=1.6640 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 30 it 80 total=8.7926 mle=2.0521 pcon=5.0900 forget=1.6505 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 30 it 130 total=8.7003 mle=1.9383 pcon=5.0903 forget=1.6717 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 30 it 180 total=8.5554 mle=1.7714 pcon=5.0907 forget=1.6933 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 30 it 230 total=8.6067 mle=1.8474 pcon=5.0912 forget=1.6681 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 30 it 280 total=8.6492 mle=1.9013 pcon=5.0917 forget=1.6562 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 30 it 330 total=8.7439 mle=1.9914 pcon=5.0922 forget=1.6603 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 30 it 380 total=8.4934 mle=1.7625 pcon=5.0929 forget=1.6380 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 31 it 1 total=8.5858 mle=1.8240 pcon=5.0936 forget=1.6683 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 31 it 51 total=8.8163 mle=2.0587 pcon=5.0944 forget=1.6633 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 31 it 101 total=8.7930 mle=2.0346 pcon=5.0951 forget=1.6632 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 31 it 151 total=8.6666 mle=1.9141 pcon=5.0959 forget=1.6566 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 31 it 201 total=8.5449 mle=1.8061 pcon=5.0968 forget=1.6420 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 31 it 251 total=8.7825 mle=2.0213 pcon=5.0977 forget=1.6636 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 31 it 301 total=8.5335 mle=1.7930 pcon=5.0987 forget=1.6419 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 31 it 351 total=8.6782 mle=1.9200 pcon=5.0996 forget=1.6586 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 31 it 401 total=8.6417 mle=1.8832 pcon=5.1005 forget=1.6580 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 32 it 22 total=8.7303 mle=1.9646 pcon=5.1015 forget=1.6643 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 32 it 72 total=8.4602 mle=1.6928 pcon=5.1025 forget=1.6650 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 32 it 122 total=8.5981 mle=1.8471 pcon=5.1035 forget=1.6476 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 32 it 172 total=8.8857 mle=2.1316 pcon=5.1045 forget=1.6496 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 32 it 222 total=8.4225 mle=1.6754 pcon=5.1055 forget=1.6417 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 32 it 272 total=8.7365 mle=1.9588 pcon=5.1066 forget=1.6711 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 32 it 322 total=8.6404 mle=1.8862 pcon=5.1076 forget=1.6466 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 32 it 372 total=8.8241 mle=2.0480 pcon=5.1087 forget=1.6674 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 32 it 422 total=8.7314 mle=1.9970 pcon=5.1097 forget=1.6247 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 33 it 43 total=8.5913 mle=1.8294 pcon=5.1106 forget=1.6512 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 33 it 93 total=8.5730 mle=1.8363 pcon=5.1116 forget=1.6251 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 33 it 143 total=8.5451 mle=1.7899 pcon=5.1125 forget=1.6427 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 33 it 193 total=8.6702 mle=1.9129 pcon=5.1134 forget=1.6438 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 33 it 243 total=8.6347 mle=1.8894 pcon=5.1144 forget=1.6308 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 33 it 293 total=8.7247 mle=1.9796 pcon=5.1154 forget=1.6297 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 33 it 343 total=8.5923 mle=1.8405 pcon=5.1165 forget=1.6353 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 33 it 393 total=8.6357 mle=1.8863 pcon=5.1175 forget=1.6319 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 34 it 14 total=8.6036 mle=1.8700 pcon=5.1184 forget=1.6151 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 34 it 64 total=8.7539 mle=2.0303 pcon=5.1194 forget=1.6043 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 34 it 114 total=8.5856 mle=1.8533 pcon=5.1204 forget=1.6120 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
 70%|███████   | 35/50 [22:08<09:41, 38.75s/it] 72%|███████▏  | 36/50 [22:46<08:59, 38.55s/it] 74%|███████▍  | 37/50 [23:26<08:25, 38.91s/it] 76%|███████▌  | 38/50 [24:06<07:52, 39.37s/it] 78%|███████▊  | 39/50 [24:48<07:22, 40.21s/it] 80%|████████  | 40/50 [25:30<06:47, 40.77s/it] 82%|████████▏ | 41/50 [26:13<06:10, 41.21s/it][loss] ep 34 it 164 total=8.4715 mle=1.7284 pcon=5.1213 forget=1.6217 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 34 it 214 total=8.8222 mle=2.0879 pcon=5.1223 forget=1.6120 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 34 it 264 total=8.7485 mle=2.0054 pcon=5.1232 forget=1.6199 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 34 it 314 total=8.4613 mle=1.7420 pcon=5.1242 forget=1.5951 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 34 it 364 total=8.5912 mle=1.8617 pcon=5.1252 forget=1.6043 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 34 it 414 total=8.6876 mle=1.9640 pcon=5.1261 forget=1.5975 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 35 it 35 total=8.5564 mle=1.8795 pcon=5.1270 forget=1.5499 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 35 it 85 total=8.4980 mle=1.8338 pcon=5.1280 forget=1.5363 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 35 it 135 total=8.6317 mle=1.9410 pcon=5.1289 forget=1.5618 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 35 it 185 total=8.6378 mle=1.9622 pcon=5.1298 forget=1.5458 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 35 it 235 total=8.4343 mle=1.7650 pcon=5.1306 forget=1.5387 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 35 it 285 total=8.4731 mle=1.8105 pcon=5.1315 forget=1.5311 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 35 it 335 total=8.5240 mle=1.8645 pcon=5.1324 forget=1.5271 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 35 it 385 total=8.6053 mle=1.9380 pcon=5.1333 forget=1.5339 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 36 it 6 total=8.2923 mle=1.6482 pcon=5.1342 forget=1.5099 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 36 it 56 total=8.7340 mle=2.0322 pcon=5.1350 forget=1.5667 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 36 it 106 total=8.5335 mle=1.9087 pcon=5.1358 forget=1.4889 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 36 it 156 total=8.5634 mle=1.9428 pcon=5.1366 forget=1.4840 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 36 it 206 total=8.4692 mle=1.8585 pcon=5.1374 forget=1.4733 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 36 it 256 total=8.6127 mle=1.9807 pcon=5.1382 forget=1.4938 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 36 it 306 total=8.5308 mle=1.9346 pcon=5.1389 forget=1.4573 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 36 it 356 total=8.4831 mle=1.8525 pcon=5.1397 forget=1.4909 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 36 it 406 total=8.4623 mle=1.8554 pcon=5.1403 forget=1.4666 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 37 it 27 total=8.5052 mle=1.9083 pcon=5.1409 forget=1.4559 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 37 it 77 total=8.7170 mle=2.1032 pcon=5.1416 forget=1.4723 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 37 it 127 total=8.5758 mle=1.9880 pcon=5.1421 forget=1.4457 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 37 it 177 total=8.2712 mle=1.7351 pcon=5.1426 forget=1.3935 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 37 it 227 total=8.5026 mle=1.9279 pcon=5.1431 forget=1.4316 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 37 it 277 total=8.5956 mle=2.0354 pcon=5.1435 forget=1.4167 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 37 it 327 total=8.2331 mle=1.6899 pcon=5.1440 forget=1.3991 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 37 it 377 total=8.4755 mle=1.8904 pcon=5.1444 forget=1.4407 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 37 it 427 total=8.4568 mle=1.8778 pcon=5.1447 forget=1.4343 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 38 it 48 total=8.6778 mle=2.0766 pcon=5.1449 forget=1.4562 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 38 it 98 total=8.7971 mle=2.2185 pcon=5.1451 forget=1.4335 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 38 it 148 total=8.3820 mle=1.8027 pcon=5.1453 forget=1.4339 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 38 it 198 total=8.5050 mle=1.9611 pcon=5.1455 forget=1.3985 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 38 it 248 total=8.6062 mle=2.0224 pcon=5.1456 forget=1.4382 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 38 it 298 total=8.4296 mle=1.8600 pcon=5.1457 forget=1.4239 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 38 it 348 total=8.7342 mle=2.1319 pcon=5.1456 forget=1.4567 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 38 it 398 total=8.4373 mle=1.7878 pcon=5.1456 forget=1.5039 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 39 it 19 total=8.6373 mle=2.0720 pcon=5.1455 forget=1.4197 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 39 it 69 total=8.5106 mle=1.9412 pcon=5.1454 forget=1.4240 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 39 it 119 total=8.3282 mle=1.7738 pcon=5.1453 forget=1.4091 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 39 it 169 total=8.6155 mle=2.0261 pcon=5.1451 forget=1.4443 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 39 it 219 total=8.4177 mle=1.8525 pcon=5.1449 forget=1.4203 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 39 it 269 total=8.4619 mle=1.8732 pcon=5.1447 forget=1.4440 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 39 it 319 total=8.4556 mle=1.8864 pcon=5.1444 forget=1.4248 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 39 it 369 total=8.3844 mle=1.7870 pcon=5.1441 forget=1.4533 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 39 it 419 total=8.3548 mle=1.7932 pcon=5.1437 forget=1.4178 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 40 it 40 total=8.5603 mle=1.9494 pcon=5.1433 forget=1.4676 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 40 it 90 total=8.4899 mle=1.9348 pcon=5.1429 forget=1.4122 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 40 it 140 total=8.2142 mle=1.6537 pcon=5.1424 forget=1.4181 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 40 it 190 total=8.2121 mle=1.6798 pcon=5.1418 forget=1.3905 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 40 it 240 total=8.4465 mle=1.8061 pcon=5.1413 forget=1.4991 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 40 it 290 total=8.2327 mle=1.6510 pcon=5.1407 forget=1.4410 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 40 it 340 total=8.5608 mle=1.9613 pcon=5.1401 forget=1.4594 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 40 it 390 total=8.2080 mle=1.6403 pcon=5.1395 forget=1.4282 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 41 it 11 total=8.5887 mle=2.0265 pcon=5.1389 forget=1.4233 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 41 it 61 total=8.6319 mle=2.0463 pcon=5.1382 forget=1.4473 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 41 it 111 total=8.5055 mle=1.9054 pcon=5.1376 forget=1.4625 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 41 it 161 total=8.4514 mle=1.8509 pcon=5.1369 forget=1.4636 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 41 it 211 total=8.4001 mle=1.8453 pcon=5.1362 forget=1.4186 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
 84%|████████▍ | 42/50 [26:53<05:28, 41.07s/it] 86%|████████▌ | 43/50 [27:37<04:52, 41.78s/it] 88%|████████▊ | 44/50 [28:19<04:11, 41.88s/it] 90%|█████████ | 45/50 [29:01<03:30, 42.06s/it] 92%|█████████▏| 46/50 [29:43<02:47, 41.83s/it] 94%|█████████▍| 47/50 [30:23<02:04, 41.48s/it] 96%|█████████▌| 48/50 [31:05<01:22, 41.42s/it][loss] ep 41 it 261 total=8.6762 mle=2.0920 pcon=5.1355 forget=1.4488 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 41 it 311 total=8.5207 mle=1.9757 pcon=5.1348 forget=1.4102 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 41 it 361 total=8.2995 mle=1.7344 pcon=5.1341 forget=1.4310 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 41 it 411 total=8.4607 mle=1.8933 pcon=5.1333 forget=1.4340 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 42 it 32 total=8.5599 mle=1.9996 pcon=5.1325 forget=1.4277 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 42 it 82 total=8.6141 mle=2.0102 pcon=5.1317 forget=1.4722 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 42 it 132 total=8.7281 mle=2.1711 pcon=5.1309 forget=1.4261 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 42 it 182 total=8.7586 mle=2.1647 pcon=5.1300 forget=1.4638 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 42 it 232 total=8.3562 mle=1.7442 pcon=5.1292 forget=1.4828 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 42 it 282 total=8.7497 mle=2.1013 pcon=5.1283 forget=1.5201 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 42 it 332 total=8.8334 mle=2.1964 pcon=5.1275 forget=1.5096 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 42 it 382 total=8.4604 mle=1.8451 pcon=5.1266 forget=1.4887 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 43 it 3 total=8.8207 mle=2.1743 pcon=5.1257 forget=1.5208 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 43 it 53 total=8.4295 mle=1.8079 pcon=5.1249 forget=1.4967 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 43 it 103 total=8.5803 mle=1.9513 pcon=5.1240 forget=1.5050 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 43 it 153 total=8.6940 mle=2.0454 pcon=5.1231 forget=1.5255 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 43 it 203 total=8.4935 mle=1.8234 pcon=5.1221 forget=1.5479 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 43 it 253 total=8.5346 mle=1.9119 pcon=5.1212 forget=1.5016 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 43 it 303 total=8.7332 mle=2.0508 pcon=5.1203 forget=1.5621 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 43 it 353 total=8.5395 mle=1.8559 pcon=5.1194 forget=1.5642 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 43 it 403 total=8.5519 mle=1.8990 pcon=5.1185 forget=1.5345 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 44 it 24 total=8.4059 mle=1.7294 pcon=5.1175 forget=1.5590 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 44 it 74 total=8.6048 mle=1.9204 pcon=5.1166 forget=1.5678 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 44 it 124 total=8.6633 mle=1.9607 pcon=5.1157 forget=1.5869 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 44 it 174 total=8.6335 mle=1.9118 pcon=5.1148 forget=1.6069 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 44 it 224 total=8.7945 mle=2.0411 pcon=5.1139 forget=1.6395 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 44 it 274 total=8.7039 mle=1.9787 pcon=5.1130 forget=1.6121 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 44 it 324 total=8.6809 mle=1.8968 pcon=5.1121 forget=1.6720 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 44 it 374 total=8.6211 mle=1.8900 pcon=5.1112 forget=1.6199 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 44 it 424 total=8.5240 mle=1.7525 pcon=5.1103 forget=1.6612 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 45 it 45 total=8.6972 mle=1.9477 pcon=5.1095 forget=1.6401 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 45 it 95 total=8.4629 mle=1.6857 pcon=5.1086 forget=1.6686 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 45 it 145 total=8.6306 mle=1.8482 pcon=5.1077 forget=1.6747 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 45 it 195 total=8.8480 mle=2.0548 pcon=5.1068 forget=1.6864 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 45 it 245 total=8.9226 mle=2.0905 pcon=5.1059 forget=1.7262 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 45 it 295 total=8.7571 mle=1.8774 pcon=5.1050 forget=1.7748 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 45 it 345 total=8.7944 mle=1.9606 pcon=5.1041 forget=1.7297 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 45 it 395 total=9.0108 mle=2.1318 pcon=5.1032 forget=1.7757 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 46 it 16 total=8.4954 mle=1.6331 pcon=5.1023 forget=1.7601 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 46 it 66 total=8.8870 mle=1.9903 pcon=5.1015 forget=1.7952 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 46 it 116 total=9.1254 mle=2.2083 pcon=5.1005 forget=1.8165 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 46 it 166 total=8.6161 mle=1.6811 pcon=5.0997 forget=1.8354 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 46 it 216 total=8.6779 mle=1.7475 pcon=5.0988 forget=1.8316 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 46 it 266 total=8.7131 mle=1.7770 pcon=5.0979 forget=1.8382 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 46 it 316 total=8.8268 mle=1.8560 pcon=5.0971 forget=1.8738 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 46 it 366 total=8.9276 mle=1.9437 pcon=5.0963 forget=1.8876 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 46 it 416 total=8.7491 mle=1.7581 pcon=5.0955 forget=1.8956 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 47 it 37 total=8.8271 mle=1.8283 pcon=5.0947 forget=1.9042 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 47 it 87 total=8.9721 mle=1.9524 pcon=5.0939 forget=1.9258 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 47 it 137 total=8.8998 mle=1.8524 pcon=5.0931 forget=1.9542 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 47 it 187 total=8.7563 mle=1.7023 pcon=5.0924 forget=1.9617 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 47 it 237 total=9.1073 mle=2.0415 pcon=5.0916 forget=1.9743 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 47 it 287 total=9.0853 mle=2.0029 pcon=5.0908 forget=1.9916 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 47 it 337 total=9.1171 mle=2.0216 pcon=5.0901 forget=2.0054 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 47 it 387 total=8.8294 mle=1.7268 pcon=5.0893 forget=2.0132 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 48 it 8 total=9.0981 mle=1.9520 pcon=5.0885 forget=2.0577 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 48 it 58 total=8.9445 mle=1.8136 pcon=5.0877 forget=2.0432 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 48 it 108 total=8.9941 mle=1.8622 pcon=5.0870 forget=2.0448 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 48 it 158 total=8.9871 mle=1.8301 pcon=5.0864 forget=2.0706 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 48 it 208 total=9.0953 mle=1.8912 pcon=5.0857 forget=2.1185 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 48 it 258 total=9.1519 mle=1.9374 pcon=5.0849 forget=2.1295 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 48 it 308 total=9.1805 mle=1.9745 pcon=5.0842 forget=2.1218 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
 98%|█████████▊| 49/50 [31:46<00:41, 41.55s/it]100%|██████████| 50/50 [32:29<00:00, 41.76s/it]100%|██████████| 50/50 [32:29<00:00, 38.98s/it]
[loss] ep 48 it 358 total=9.3451 mle=2.0911 pcon=5.0835 forget=2.1704 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 48 it 408 total=9.4498 mle=2.2065 pcon=5.0828 forget=2.1605 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 49 it 29 total=9.0485 mle=1.8248 pcon=5.0821 forget=2.1416 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 49 it 79 total=9.3253 mle=2.0829 pcon=5.0815 forget=2.1609 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 49 it 129 total=9.4818 mle=2.1733 pcon=5.0809 forget=2.2276 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 49 it 179 total=9.2095 mle=1.9291 pcon=5.0802 forget=2.2002 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 49 it 229 total=9.3561 mle=2.0437 pcon=5.0796 forget=2.2327 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 49 it 279 total=9.2067 mle=1.8819 pcon=5.0790 forget=2.2457 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 49 it 329 total=9.4823 mle=2.1689 pcon=5.0785 forget=2.2349 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
[loss] ep 49 it 379 total=9.3039 mle=1.9518 pcon=5.0779 forget=2.2742 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=630 fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage1-inc1: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<04:21,  1.64it/s]  1%|▏         | 6/430 [00:00<00:39, 10.66it/s]  3%|▎         | 11/430 [00:00<00:22, 18.53it/s]  4%|▎         | 16/430 [00:00<00:16, 25.32it/s]  5%|▍         | 21/430 [00:01<00:13, 31.03it/s]  6%|▌         | 26/430 [00:01<00:11, 35.61it/s]  7%|▋         | 31/430 [00:01<00:10, 39.28it/s]  9%|▊         | 37/430 [00:01<00:09, 43.66it/s] 10%|▉         | 42/430 [00:01<00:08, 44.52it/s] 11%|█         | 47/430 [00:01<00:08, 45.67it/s] 12%|█▏        | 52/430 [00:01<00:08, 46.31it/s] 13%|█▎        | 57/430 [00:01<00:08, 45.20it/s] 14%|█▍        | 62/430 [00:01<00:08, 45.42it/s] 16%|█▌        | 67/430 [00:01<00:07, 46.27it/s] 17%|█▋        | 72/430 [00:02<00:07, 46.64it/s] 18%|█▊        | 77/430 [00:02<00:07, 47.34it/s] 19%|█▉        | 82/430 [00:02<00:07, 46.57it/s] 20%|██        | 87/430 [00:02<00:07, 47.24it/s] 21%|██▏       | 92/430 [00:02<00:07, 47.67it/s] 23%|██▎       | 97/430 [00:02<00:07, 47.45it/s] 24%|██▎       | 102/430 [00:02<00:06, 47.36it/s] 25%|██▍       | 107/430 [00:02<00:06, 48.01it/s] 26%|██▌       | 112/430 [00:02<00:06, 48.19it/s] 27%|██▋       | 117/430 [00:03<00:06, 48.38it/s] 28%|██▊       | 122/430 [00:03<00:06, 48.56it/s] 30%|██▉       | 127/430 [00:03<00:06, 46.09it/s] 31%|███       | 132/430 [00:03<00:06, 46.64it/s] 32%|███▏      | 137/430 [00:03<00:06, 47.05it/s] 33%|███▎      | 143/430 [00:03<00:05, 47.91it/s] 34%|███▍      | 148/430 [00:03<00:05, 48.11it/s] 36%|███▌      | 153/430 [00:03<00:05, 48.03it/s] 37%|███▋      | 158/430 [00:03<00:05, 47.52it/s] 38%|███▊      | 163/430 [00:04<00:05, 47.92it/s] 39%|███▉      | 168/430 [00:04<00:05, 47.69it/s] 40%|████      | 173/430 [00:04<00:05, 47.49it/s] 42%|████▏     | 179/430 [00:04<00:05, 49.14it/s] 43%|████▎     | 184/430 [00:04<00:05, 48.37it/s] 44%|████▍     | 189/430 [00:04<00:04, 48.21it/s] 45%|████▌     | 194/430 [00:04<00:04, 48.24it/s] 46%|████▋     | 199/430 [00:04<00:04, 48.15it/s] 47%|████▋     | 204/430 [00:04<00:04, 47.77it/s] 49%|████▊     | 209/430 [00:04<00:04, 47.61it/s] 50%|█████     | 215/430 [00:05<00:04, 48.67it/s] 51%|█████     | 220/430 [00:05<00:04, 48.05it/s] 52%|█████▏    | 225/430 [00:05<00:04, 48.07it/s] 53%|█████▎    | 230/430 [00:05<00:04, 47.13it/s] 55%|█████▍    | 235/430 [00:05<00:04, 47.55it/s] 56%|█████▌    | 240/430 [00:05<00:03, 48.06it/s] 57%|█████▋    | 245/430 [00:05<00:03, 48.30it/s] 58%|█████▊    | 250/430 [00:05<00:03, 47.60it/s] 59%|█████▉    | 255/430 [00:05<00:03, 48.21it/s] 61%|██████    | 261/430 [00:06<00:03, 50.20it/s] 62%|██████▏   | 267/430 [00:06<00:03, 49.53it/s] 63%|██████▎   | 272/430 [00:06<00:03, 47.48it/s] 64%|██████▍   | 277/430 [00:06<00:03, 47.28it/s] 66%|██████▌   | 282/430 [00:06<00:03, 47.33it/s] 67%|██████▋   | 287/430 [00:06<00:03, 46.99it/s] 68%|██████▊   | 292/430 [00:06<00:02, 47.59it/s] 69%|██████▉   | 297/430 [00:06<00:02, 46.90it/s] 70%|███████   | 302/430 [00:06<00:02, 46.87it/s] 71%|███████▏  | 307/430 [00:07<00:02, 46.51it/s] 73%|███████▎  | 313/430 [00:07<00:02, 47.68it/s] 74%|███████▍  | 319/430 [00:07<00:02, 49.72it/s] 76%|███████▌  | 326/430 [00:07<00:01, 54.98it/s] 78%|███████▊  | 335/430 [00:07<00:01, 63.72it/s] 80%|████████  | 344/430 [00:07<00:01, 70.12it/s] 82%|████████▏ | 352/430 [00:07<00:01, 71.11it/s] 84%|████████▎ | 360/430 [00:07<00:01, 62.42it/s] 85%|████████▌ | 367/430 [00:07<00:01, 58.23it/s] 87%|████████▋ | 374/430 [00:08<00:01, 54.68it/s] 88%|████████▊ | 380/430 [00:08<00:00, 53.13it/s] 90%|████████▉ | 386/430 [00:08<00:00, 51.69it/s] 91%|█████████ | 392/430 [00:08<00:00, 50.63it/s] 93%|█████████▎| 398/430 [00:08<00:00, 48.54it/s] 94%|█████████▍| 404/430 [00:08<00:00, 48.25it/s] 95%|█████████▌| 410/430 [00:08<00:00, 49.21it/s] 97%|█████████▋| 416/430 [00:08<00:00, 50.01it/s] 98%|█████████▊| 422/430 [00:09<00:00, 51.34it/s]100%|█████████▉| 428/430 [00:09<00:00, 52.78it/s]100%|██████████| 430/430 [00:09<00:00, 46.51it/s]
55000 images processed, 9.39505124092102 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<01:05,  1.29it/s]  7%|▋         | 6/86 [00:00<00:09,  8.84it/s] 13%|█▎        | 11/86 [00:00<00:04, 16.09it/s] 19%|█▊        | 16/86 [00:01<00:03, 22.75it/s] 24%|██▍       | 21/86 [00:01<00:02, 27.91it/s] 30%|███       | 26/86 [00:01<00:01, 32.88it/s] 36%|███▌      | 31/86 [00:01<00:01, 36.20it/s] 42%|████▏     | 36/86 [00:01<00:01, 39.36it/s] 48%|████▊     | 41/86 [00:01<00:01, 41.86it/s] 53%|█████▎    | 46/86 [00:01<00:00, 43.25it/s] 59%|█████▉    | 51/86 [00:01<00:00, 44.12it/s] 65%|██████▌   | 56/86 [00:01<00:00, 45.16it/s] 71%|███████   | 61/86 [00:02<00:00, 46.14it/s] 77%|███████▋  | 66/86 [00:02<00:00, 46.46it/s] 83%|████████▎ | 71/86 [00:02<00:00, 47.19it/s] 88%|████████▊ | 76/86 [00:02<00:00, 46.94it/s] 94%|█████████▍| 81/86 [00:02<00:00, 47.74it/s]100%|██████████| 86/86 [00:02<00:00, 33.52it/s]
11000 images processed, 2.603261947631836 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage1-inc1/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:50,  1.19it/s]  2%|▏         | 5/204 [00:00<00:29,  6.80it/s]  5%|▍         | 10/204 [00:01<00:14, 13.75it/s]  7%|▋         | 15/204 [00:01<00:09, 20.14it/s] 10%|▉         | 20/204 [00:01<00:07, 25.29it/s] 12%|█▏        | 25/204 [00:01<00:05, 30.14it/s] 15%|█▍        | 30/204 [00:01<00:05, 33.28it/s] 17%|█▋        | 35/204 [00:01<00:04, 35.76it/s] 20%|█▉        | 40/204 [00:01<00:04, 37.22it/s] 22%|██▏       | 45/204 [00:01<00:04, 39.19it/s] 25%|██▍       | 50/204 [00:02<00:03, 39.83it/s] 27%|██▋       | 55/204 [00:02<00:03, 41.51it/s] 29%|██▉       | 60/204 [00:02<00:03, 41.76it/s] 32%|███▏      | 65/204 [00:02<00:03, 43.34it/s] 34%|███▍      | 70/204 [00:02<00:03, 42.89it/s] 37%|███▋      | 75/204 [00:02<00:02, 43.28it/s] 39%|███▉      | 80/204 [00:02<00:02, 42.81it/s] 42%|████▏     | 85/204 [00:02<00:02, 43.96it/s] 44%|████▍     | 90/204 [00:02<00:02, 43.71it/s] 47%|████▋     | 95/204 [00:03<00:02, 42.73it/s] 49%|████▉     | 100/204 [00:03<00:02, 43.60it/s] 51%|█████▏    | 105/204 [00:03<00:02, 42.80it/s] 54%|█████▍    | 110/204 [00:03<00:02, 43.65it/s] 56%|█████▋    | 115/204 [00:03<00:02, 43.70it/s] 59%|█████▉    | 120/204 [00:03<00:01, 43.44it/s] 61%|██████▏   | 125/204 [00:03<00:01, 43.77it/s] 64%|██████▎   | 130/204 [00:03<00:01, 44.77it/s] 66%|██████▌   | 135/204 [00:03<00:01, 45.14it/s] 69%|██████▊   | 140/204 [00:04<00:01, 44.15it/s] 71%|███████   | 145/204 [00:04<00:01, 45.16it/s] 74%|███████▎  | 150/204 [00:04<00:01, 44.44it/s] 76%|███████▌  | 155/204 [00:04<00:01, 45.25it/s] 78%|███████▊  | 160/204 [00:04<00:00, 44.70it/s] 81%|████████  | 165/204 [00:04<00:00, 44.27it/s] 83%|████████▎ | 170/204 [00:04<00:00, 43.73it/s] 86%|████████▌ | 175/204 [00:04<00:00, 43.48it/s] 88%|████████▊ | 180/204 [00:04<00:00, 44.19it/s] 91%|█████████ | 185/204 [00:05<00:00, 42.31it/s] 93%|█████████▎| 190/204 [00:05<00:00, 41.93it/s] 96%|█████████▌| 195/204 [00:05<00:00, 43.28it/s] 98%|█████████▊| 200/204 [00:05<00:00, 43.00it/s]100%|██████████| 204/204 [00:05<00:00, 37.03it/s]
26032 images processed, 5.559965133666992 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:07,  1.15it/s]  8%|▊         | 6/79 [00:00<00:09,  7.90it/s] 14%|█▍        | 11/79 [00:01<00:04, 14.61it/s] 20%|██        | 16/79 [00:01<00:03, 20.72it/s] 25%|██▌       | 20/79 [00:01<00:02, 24.48it/s] 32%|███▏      | 25/79 [00:01<00:01, 29.94it/s] 38%|███▊      | 30/79 [00:01<00:01, 33.20it/s] 44%|████▍     | 35/79 [00:01<00:01, 35.53it/s] 51%|█████     | 40/79 [00:01<00:01, 38.65it/s] 57%|█████▋    | 45/79 [00:01<00:00, 39.48it/s] 63%|██████▎   | 50/79 [00:01<00:00, 40.97it/s] 70%|██████▉   | 55/79 [00:02<00:00, 41.93it/s] 76%|███████▌  | 60/79 [00:02<00:00, 42.85it/s] 82%|████████▏ | 65/79 [00:02<00:00, 42.56it/s] 89%|████████▊ | 70/79 [00:02<00:00, 44.28it/s] 95%|█████████▍| 75/79 [00:02<00:00, 43.65it/s]100%|██████████| 79/79 [00:02<00:00, 29.45it/s]
10000 images processed, 2.728450298309326 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.62it/s]  8%|▊         | 6/79 [00:00<00:06, 10.45it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.08it/s] 20%|██        | 16/79 [00:00<00:02, 24.18it/s] 27%|██▋       | 21/79 [00:01<00:02, 28.93it/s] 33%|███▎      | 26/79 [00:01<00:01, 32.87it/s] 39%|███▉      | 31/79 [00:01<00:01, 35.38it/s] 46%|████▌     | 36/79 [00:01<00:01, 38.46it/s] 52%|█████▏    | 41/79 [00:01<00:00, 39.55it/s] 58%|█████▊    | 46/79 [00:01<00:00, 41.20it/s] 65%|██████▍   | 51/79 [00:01<00:00, 41.49it/s] 71%|███████   | 56/79 [00:01<00:00, 42.71it/s] 77%|███████▋  | 61/79 [00:01<00:00, 42.78it/s] 84%|████████▎ | 66/79 [00:02<00:00, 43.78it/s] 90%|████████▉ | 71/79 [00:02<00:00, 43.73it/s] 96%|█████████▌| 76/79 [00:02<00:00, 45.30it/s]100%|██████████| 79/79 [00:02<00:00, 33.24it/s]
10000 images processed, 2.403748035430908 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:42,  1.62it/s]  6%|▌         | 4/70 [00:00<00:09,  6.90it/s] 13%|█▎        | 9/70 [00:00<00:03, 15.36it/s] 20%|██        | 14/70 [00:00<00:02, 22.42it/s] 27%|██▋       | 19/70 [00:01<00:01, 27.81it/s] 34%|███▍      | 24/70 [00:01<00:01, 31.62it/s] 41%|████▏     | 29/70 [00:01<00:01, 35.12it/s] 49%|████▊     | 34/70 [00:01<00:00, 37.40it/s] 56%|█████▌    | 39/70 [00:01<00:00, 39.30it/s] 63%|██████▎   | 44/70 [00:01<00:00, 40.78it/s] 70%|███████   | 49/70 [00:01<00:00, 42.18it/s] 77%|███████▋  | 54/70 [00:01<00:00, 42.93it/s] 84%|████████▍ | 59/70 [00:01<00:00, 43.80it/s] 91%|█████████▏| 64/70 [00:02<00:00, 43.21it/s] 99%|█████████▊| 69/70 [00:02<00:00, 43.74it/s]100%|██████████| 70/70 [00:02<00:00, 31.37it/s]
8925 images processed, 2.2654266357421875 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:58,  1.33s/it]  9%|▉         | 4/45 [00:01<00:11,  3.56it/s] 20%|██        | 9/45 [00:01<00:03,  9.00it/s] 31%|███       | 14/45 [00:01<00:02, 14.67it/s] 40%|████      | 18/45 [00:01<00:01, 16.00it/s] 51%|█████     | 23/45 [00:02<00:01, 19.95it/s] 62%|██████▏   | 28/45 [00:02<00:00, 24.75it/s] 73%|███████▎  | 33/45 [00:02<00:00, 19.39it/s] 84%|████████▍ | 38/45 [00:02<00:00, 23.51it/s] 96%|█████████▌| 43/45 [00:02<00:00, 27.78it/s]100%|██████████| 45/45 [00:02<00:00, 16.15it/s]
5640 images processed, 2.809826135635376 seconds used

29.590753078460693
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.55  99.28
places365     71.49  79.13
LSUN          18.79  95.63
iSUN          73.22  81.45
dtd           35.11  91.44
AVG           40.23  89.39
Retain-Acc: 0.7063
Forget-as-OOD (retain known vs forget novel):
  FPR: 90.00 AUROC: 71.12 AUIN: 98.00
21.245988368988037
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage1-inc1_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage1-inc1_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage1-seen: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<04:31,  1.58it/s]  2%|▏         | 10/430 [00:00<00:23, 17.65it/s]  4%|▍         | 19/430 [00:00<00:12, 32.26it/s]  7%|▋         | 28/430 [00:00<00:08, 44.97it/s]  8%|▊         | 36/430 [00:01<00:08, 46.03it/s] 10%|█         | 43/430 [00:01<00:08, 46.21it/s] 11%|█▏        | 49/430 [00:01<00:08, 46.19it/s] 13%|█▎        | 55/430 [00:01<00:07, 46.98it/s] 14%|█▍        | 61/430 [00:01<00:07, 47.07it/s] 16%|█▌        | 67/430 [00:01<00:07, 47.38it/s] 17%|█▋        | 73/430 [00:01<00:07, 47.12it/s] 18%|█▊        | 78/430 [00:02<00:07, 47.39it/s] 19%|█▉        | 83/430 [00:02<00:07, 47.32it/s] 20%|██        | 88/430 [00:02<00:07, 46.92it/s] 22%|██▏       | 93/430 [00:02<00:07, 47.43it/s] 23%|██▎       | 98/430 [00:02<00:07, 47.21it/s] 24%|██▍       | 103/430 [00:02<00:06, 47.09it/s] 25%|██▌       | 109/430 [00:02<00:06, 48.14it/s] 27%|██▋       | 114/430 [00:02<00:06, 48.19it/s] 28%|██▊       | 119/430 [00:02<00:06, 48.14it/s] 29%|██▉       | 124/430 [00:02<00:06, 48.48it/s] 30%|███       | 129/430 [00:03<00:06, 47.57it/s] 31%|███       | 134/430 [00:03<00:06, 47.06it/s] 32%|███▏      | 139/430 [00:03<00:06, 47.37it/s] 33%|███▎      | 144/430 [00:03<00:06, 47.08it/s] 35%|███▍      | 149/430 [00:03<00:05, 46.97it/s] 36%|███▌      | 155/430 [00:03<00:05, 47.69it/s] 37%|███▋      | 160/430 [00:03<00:05, 47.02it/s] 38%|███▊      | 165/430 [00:03<00:05, 47.39it/s] 40%|███▉      | 170/430 [00:03<00:05, 47.08it/s] 41%|████      | 175/430 [00:04<00:05, 46.98it/s] 42%|████▏     | 180/430 [00:04<00:05, 46.79it/s] 43%|████▎     | 185/430 [00:04<00:05, 46.45it/s] 44%|████▍     | 190/430 [00:04<00:05, 47.10it/s] 45%|████▌     | 195/430 [00:04<00:05, 46.53it/s] 47%|████▋     | 200/430 [00:04<00:04, 46.26it/s] 48%|████▊     | 206/430 [00:04<00:04, 47.38it/s] 49%|████▉     | 211/430 [00:04<00:04, 47.44it/s] 50%|█████     | 216/430 [00:04<00:04, 46.93it/s] 51%|█████▏    | 221/430 [00:05<00:04, 46.88it/s] 53%|█████▎    | 226/430 [00:05<00:04, 46.85it/s] 54%|█████▎    | 231/430 [00:05<00:04, 46.92it/s] 55%|█████▍    | 236/430 [00:05<00:04, 47.00it/s] 56%|█████▌    | 241/430 [00:05<00:04, 46.93it/s] 57%|█████▋    | 246/430 [00:05<00:03, 47.05it/s] 58%|█████▊    | 251/430 [00:05<00:03, 47.72it/s] 60%|█████▉    | 256/430 [00:05<00:03, 47.38it/s] 61%|██████    | 261/430 [00:05<00:03, 47.16it/s] 62%|██████▏   | 266/430 [00:05<00:03, 47.86it/s] 63%|██████▎   | 271/430 [00:06<00:03, 47.39it/s] 64%|██████▍   | 276/430 [00:06<00:03, 47.19it/s] 65%|██████▌   | 281/430 [00:06<00:03, 47.18it/s] 67%|██████▋   | 286/430 [00:06<00:03, 46.64it/s] 68%|██████▊   | 291/430 [00:06<00:02, 47.50it/s] 69%|██████▉   | 297/430 [00:06<00:02, 49.25it/s] 70%|███████   | 303/430 [00:06<00:02, 49.35it/s] 72%|███████▏  | 309/430 [00:06<00:02, 50.50it/s] 73%|███████▎  | 315/430 [00:06<00:02, 49.87it/s] 75%|███████▍  | 321/430 [00:07<00:02, 50.89it/s] 76%|███████▌  | 327/430 [00:07<00:02, 50.51it/s] 77%|███████▋  | 333/430 [00:07<00:01, 50.05it/s] 79%|███████▉  | 339/430 [00:07<00:01, 50.25it/s] 80%|████████  | 345/430 [00:07<00:01, 48.67it/s] 82%|████████▏ | 351/430 [00:07<00:01, 49.69it/s] 83%|████████▎ | 356/430 [00:07<00:01, 49.51it/s] 84%|████████▍ | 362/430 [00:07<00:01, 49.60it/s] 85%|████████▌ | 367/430 [00:08<00:01, 49.46it/s] 87%|████████▋ | 372/430 [00:08<00:01, 49.52it/s] 88%|████████▊ | 378/430 [00:08<00:01, 50.34it/s] 89%|████████▉ | 384/430 [00:08<00:00, 49.77it/s] 90%|█████████ | 389/430 [00:08<00:00, 49.56it/s] 92%|█████████▏| 394/430 [00:08<00:00, 48.59it/s] 93%|█████████▎| 400/430 [00:08<00:00, 49.09it/s] 94%|█████████▍| 405/430 [00:08<00:00, 48.70it/s] 96%|█████████▌| 411/430 [00:08<00:00, 49.47it/s] 97%|█████████▋| 416/430 [00:09<00:00, 49.32it/s] 98%|█████████▊| 422/430 [00:09<00:00, 49.80it/s] 99%|█████████▉| 427/430 [00:09<00:00, 49.62it/s]100%|██████████| 430/430 [00:09<00:00, 46.23it/s]
55000 images processed, 9.435423374176025 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:55,  1.53it/s]  7%|▋         | 6/86 [00:00<00:07, 10.07it/s] 13%|█▎        | 11/86 [00:00<00:04, 18.01it/s] 19%|█▊        | 16/86 [00:00<00:02, 25.01it/s] 24%|██▍       | 21/86 [00:01<00:02, 30.99it/s] 30%|███       | 26/86 [00:01<00:01, 35.81it/s] 37%|███▋      | 32/86 [00:01<00:01, 40.01it/s] 44%|████▍     | 38/86 [00:01<00:01, 43.80it/s] 51%|█████     | 44/86 [00:01<00:00, 45.57it/s] 58%|█████▊    | 50/86 [00:01<00:00, 47.75it/s] 65%|██████▌   | 56/86 [00:01<00:00, 48.36it/s] 72%|███████▏  | 62/86 [00:01<00:00, 49.72it/s] 79%|███████▉  | 68/86 [00:01<00:00, 49.66it/s] 86%|████████▌ | 74/86 [00:02<00:00, 50.36it/s] 93%|█████████▎| 80/86 [00:02<00:00, 50.04it/s]100%|██████████| 86/86 [00:02<00:00, 49.62it/s]100%|██████████| 86/86 [00:02<00:00, 36.57it/s]
11000 images processed, 2.3868443965911865 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage1-seen/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:11,  1.54it/s]  5%|▌         | 11/204 [00:00<00:10, 19.10it/s]  9%|▉         | 19/204 [00:00<00:06, 30.39it/s] 13%|█▎        | 26/204 [00:01<00:05, 35.32it/s] 16%|█▌        | 32/204 [00:01<00:04, 38.66it/s] 19%|█▊        | 38/204 [00:01<00:04, 40.85it/s] 22%|██▏       | 44/204 [00:01<00:03, 42.19it/s] 24%|██▍       | 49/204 [00:01<00:03, 42.90it/s] 26%|██▋       | 54/204 [00:01<00:03, 44.15it/s] 29%|██▉       | 59/204 [00:01<00:03, 44.41it/s] 31%|███▏      | 64/204 [00:01<00:03, 44.66it/s] 34%|███▍      | 69/204 [00:01<00:02, 45.44it/s] 36%|███▋      | 74/204 [00:02<00:02, 45.09it/s] 39%|███▊      | 79/204 [00:02<00:02, 44.16it/s] 41%|████      | 84/204 [00:02<00:02, 44.62it/s] 44%|████▎     | 89/204 [00:02<00:02, 45.22it/s] 46%|████▌     | 94/204 [00:02<00:02, 45.63it/s] 49%|████▊     | 99/204 [00:02<00:02, 45.69it/s] 51%|█████     | 104/204 [00:02<00:02, 46.29it/s] 53%|█████▎    | 109/204 [00:02<00:02, 45.79it/s] 56%|█████▌    | 114/204 [00:02<00:01, 46.69it/s] 58%|█████▊    | 119/204 [00:03<00:01, 46.42it/s] 61%|██████    | 124/204 [00:03<00:01, 46.83it/s] 63%|██████▎   | 129/204 [00:03<00:01, 46.21it/s] 66%|██████▌   | 134/204 [00:03<00:01, 46.91it/s] 68%|██████▊   | 139/204 [00:03<00:01, 46.58it/s] 71%|███████   | 144/204 [00:03<00:01, 46.99it/s] 73%|███████▎  | 149/204 [00:03<00:01, 45.94it/s] 75%|███████▌  | 154/204 [00:03<00:01, 46.67it/s] 78%|███████▊  | 159/204 [00:03<00:00, 45.90it/s] 80%|████████  | 164/204 [00:04<00:00, 46.66it/s] 83%|████████▎ | 169/204 [00:04<00:00, 46.22it/s] 85%|████████▌ | 174/204 [00:04<00:00, 46.83it/s] 88%|████████▊ | 179/204 [00:04<00:00, 46.34it/s] 90%|█████████ | 184/204 [00:04<00:00, 46.99it/s] 93%|█████████▎| 189/204 [00:04<00:00, 46.43it/s] 95%|█████████▌| 194/204 [00:04<00:00, 47.37it/s] 98%|█████████▊| 199/204 [00:04<00:00, 46.64it/s]100%|██████████| 204/204 [00:04<00:00, 46.44it/s]100%|██████████| 204/204 [00:04<00:00, 41.92it/s]
26032 images processed, 4.92513370513916 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:56,  1.39it/s]  8%|▊         | 6/79 [00:00<00:07,  9.17it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.76it/s] 20%|██        | 16/79 [00:01<00:02, 23.17it/s] 27%|██▋       | 21/79 [00:01<00:02, 28.85it/s] 33%|███▎      | 26/79 [00:01<00:01, 32.65it/s] 39%|███▉      | 31/79 [00:01<00:01, 36.08it/s] 46%|████▌     | 36/79 [00:01<00:01, 38.45it/s] 52%|█████▏    | 41/79 [00:01<00:00, 41.00it/s] 58%|█████▊    | 46/79 [00:01<00:00, 42.34it/s] 65%|██████▍   | 51/79 [00:01<00:00, 43.55it/s] 71%|███████   | 56/79 [00:01<00:00, 44.49it/s] 77%|███████▋  | 61/79 [00:02<00:00, 44.29it/s] 84%|████████▎ | 66/79 [00:02<00:00, 45.50it/s] 90%|████████▉ | 71/79 [00:02<00:00, 45.40it/s] 96%|█████████▌| 76/79 [00:02<00:00, 46.09it/s]100%|██████████| 79/79 [00:03<00:00, 20.69it/s]
10000 images processed, 3.8620026111602783 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.73it/s]  8%|▊         | 6/79 [00:00<00:06, 10.90it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.65it/s] 20%|██        | 16/79 [00:00<00:02, 25.14it/s] 27%|██▋       | 21/79 [00:01<00:01, 30.32it/s] 33%|███▎      | 26/79 [00:01<00:01, 35.03it/s] 39%|███▉      | 31/79 [00:01<00:01, 37.86it/s] 46%|████▌     | 36/79 [00:01<00:01, 39.46it/s] 52%|█████▏    | 41/79 [00:01<00:00, 41.00it/s] 58%|█████▊    | 46/79 [00:01<00:00, 42.15it/s] 65%|██████▍   | 51/79 [00:01<00:00, 43.18it/s] 71%|███████   | 56/79 [00:01<00:00, 44.58it/s] 77%|███████▋  | 61/79 [00:01<00:00, 44.65it/s] 84%|████████▎ | 66/79 [00:02<00:00, 45.57it/s] 90%|████████▉ | 71/79 [00:02<00:00, 45.16it/s] 96%|█████████▌| 76/79 [00:02<00:00, 46.15it/s]100%|██████████| 79/79 [00:02<00:00, 34.54it/s]
10000 images processed, 2.3138840198516846 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:43,  1.60it/s]  9%|▊         | 6/70 [00:00<00:06, 10.48it/s] 16%|█▌        | 11/70 [00:00<00:03, 18.37it/s] 23%|██▎       | 16/70 [00:00<00:02, 24.73it/s] 30%|███       | 21/70 [00:01<00:01, 30.38it/s] 37%|███▋      | 26/70 [00:01<00:01, 34.21it/s] 44%|████▍     | 31/70 [00:01<00:01, 37.72it/s] 51%|█████▏    | 36/70 [00:01<00:00, 39.59it/s] 59%|█████▊    | 41/70 [00:01<00:00, 41.59it/s] 66%|██████▌   | 46/70 [00:01<00:00, 42.82it/s] 73%|███████▎  | 51/70 [00:01<00:00, 43.51it/s] 80%|████████  | 56/70 [00:01<00:00, 44.45it/s] 87%|████████▋ | 61/70 [00:01<00:00, 44.40it/s] 94%|█████████▍| 66/70 [00:02<00:00, 45.61it/s]100%|██████████| 70/70 [00:02<00:00, 32.87it/s]
8925 images processed, 2.1599409580230713 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:56,  1.28s/it]  4%|▍         | 2/45 [00:01<00:27,  1.55it/s] 16%|█▌        | 7/45 [00:01<00:05,  7.04it/s] 27%|██▋       | 12/45 [00:01<00:02, 12.96it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.79it/s] 47%|████▋     | 21/45 [00:02<00:01, 17.75it/s] 53%|█████▎    | 24/45 [00:02<00:01, 18.60it/s] 64%|██████▍   | 29/45 [00:02<00:00, 23.98it/s] 73%|███████▎  | 33/45 [00:02<00:00, 23.37it/s] 80%|████████  | 36/45 [00:02<00:00, 17.77it/s] 91%|█████████ | 41/45 [00:02<00:00, 22.97it/s]100%|██████████| 45/45 [00:02<00:00, 15.13it/s]
5640 images processed, 3.0069446563720703 seconds used

29.682111978530884
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           2.55  99.28
places365     71.49  79.13
LSUN          18.79  95.63
iSUN          73.22  81.45
dtd           35.11  91.44
AVG           40.23  89.39
Retain-Acc: 0.7063
Forget-as-OOD (retain known vs forget novel):
  FPR: 90.00 AUROC: 71.12 AUIN: 98.00
8.763931274414062
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage1-seen_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage1-seen_rf.png
==== Stage 2: inc={105,106,107,108,109}; seen={100,101,102,103,104}; all(union)={100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-110', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2', adapter_load_path='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1', forget_classes='100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='105,106,107,108,109', forget_classes_seen='100,101,102,103,104', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:163: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:237: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [01:21<1:06:40, 81.65s/it]  4%|▍         | 2/50 [02:04<47:04, 58.85s/it]    6%|▌         | 3/50 [02:47<40:22, 51.55s/it]  8%|▊         | 4/50 [03:40<39:56, 52.11s/it] 10%|█         | 5/50 [04:22<36:24, 48.55s/it] 12%|█▏        | 6/50 [05:04<33:51, 46.17s/it][loss] ep 0 it 0 total=13.2632 mle=2.0033 pcon=8.6285 forget=1.4279 orth=1.2035 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 0 it 50 total=13.1113 mle=1.8419 pcon=8.6262 forget=1.4398 orth=1.2033 favg=0.0000 nr=57 nf=57 protos=600 fproto_sim=NA
[loss] ep 0 it 100 total=13.1298 mle=1.8695 pcon=8.6240 forget=1.4332 orth=1.2030 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 0 it 150 total=12.9956 mle=1.6777 pcon=8.6217 forget=1.4935 orth=1.2026 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 0 it 200 total=13.1576 mle=1.8546 pcon=8.6196 forget=1.4814 orth=1.2019 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 0 it 250 total=13.2941 mle=1.9547 pcon=8.6175 forget=1.5208 orth=1.2011 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 0 it 300 total=13.1971 mle=1.8960 pcon=8.6153 forget=1.4856 orth=1.2002 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 0 it 350 total=13.1900 mle=1.8283 pcon=8.6132 forget=1.5494 orth=1.1991 favg=0.0000 nr=57 nf=57 protos=600 fproto_sim=NA
[loss] ep 0 it 400 total=13.2723 mle=1.8747 pcon=8.6112 forget=1.5887 orth=1.1977 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 1 it 21 total=13.3137 mle=1.8654 pcon=8.6092 forget=1.6429 orth=1.1962 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 1 it 71 total=13.1565 mle=1.7609 pcon=8.6072 forget=1.5938 orth=1.1945 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 1 it 121 total=13.1773 mle=1.7892 pcon=8.6053 forget=1.5902 orth=1.1927 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 1 it 171 total=13.1567 mle=1.7478 pcon=8.6034 forget=1.6148 orth=1.1907 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 1 it 221 total=13.1699 mle=1.7621 pcon=8.6014 forget=1.6178 orth=1.1885 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 1 it 271 total=13.3991 mle=1.9130 pcon=8.5995 forget=1.7004 orth=1.1862 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 1 it 321 total=13.1789 mle=1.7136 pcon=8.5976 forget=1.6838 orth=1.1838 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 1 it 371 total=13.2499 mle=1.7648 pcon=8.5958 forget=1.7082 orth=1.1811 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 1 it 421 total=13.2927 mle=1.7992 pcon=8.5940 forget=1.7212 orth=1.1782 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 2 it 42 total=13.2276 mle=1.7500 pcon=8.5922 forget=1.7101 orth=1.1754 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 2 it 92 total=13.2915 mle=1.7695 pcon=8.5904 forget=1.7593 orth=1.1723 favg=0.0000 nr=57 nf=57 protos=600 fproto_sim=NA
[loss] ep 2 it 142 total=13.3819 mle=1.8445 pcon=8.5887 forget=1.7797 orth=1.1691 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 2 it 192 total=13.1768 mle=1.6455 pcon=8.5870 forget=1.7786 orth=1.1656 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 2 it 242 total=13.3453 mle=1.7670 pcon=8.5852 forget=1.8310 orth=1.1621 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 2 it 292 total=13.4035 mle=1.8678 pcon=8.5836 forget=1.7937 orth=1.1584 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 2 it 342 total=13.3782 mle=1.8078 pcon=8.5820 forget=1.8338 orth=1.1546 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 2 it 392 total=13.3275 mle=1.7546 pcon=8.5804 forget=1.8419 orth=1.1507 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 3 it 13 total=13.1840 mle=1.5762 pcon=8.5789 forget=1.8824 orth=1.1465 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 3 it 63 total=13.5054 mle=1.9088 pcon=8.5774 forget=1.8769 orth=1.1424 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 3 it 113 total=13.6608 mle=2.0394 pcon=8.5759 forget=1.9074 orth=1.1381 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 3 it 163 total=13.3670 mle=1.7774 pcon=8.5745 forget=1.8815 orth=1.1336 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 3 it 213 total=13.2160 mle=1.6101 pcon=8.5731 forget=1.9039 orth=1.1289 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 3 it 263 total=13.4668 mle=1.8101 pcon=8.5718 forget=1.9606 orth=1.1242 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 3 it 313 total=13.2384 mle=1.6262 pcon=8.5705 forget=1.9223 orth=1.1194 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 3 it 363 total=13.5326 mle=1.9076 pcon=8.5693 forget=1.9411 orth=1.1145 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 3 it 413 total=13.3784 mle=1.7738 pcon=8.5681 forget=1.9270 orth=1.1095 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 4 it 34 total=13.3439 mle=1.7151 pcon=8.5671 forget=1.9573 orth=1.1044 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 4 it 84 total=13.2460 mle=1.6399 pcon=8.5661 forget=1.9408 orth=1.0993 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 4 it 134 total=13.4138 mle=1.8404 pcon=8.5652 forget=1.9141 orth=1.0940 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 4 it 184 total=13.4169 mle=1.8318 pcon=8.5643 forget=1.9319 orth=1.0889 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 4 it 234 total=13.2859 mle=1.6790 pcon=8.5636 forget=1.9595 orth=1.0838 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 4 it 284 total=13.4508 mle=1.8914 pcon=8.5629 forget=1.9182 orth=1.0782 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 4 it 334 total=13.4775 mle=1.9261 pcon=8.5625 forget=1.9161 orth=1.0728 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 4 it 384 total=13.4006 mle=1.8391 pcon=8.5621 forget=1.9324 orth=1.0670 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 5 it 5 total=13.2327 mle=1.6697 pcon=8.5620 forget=1.9401 orth=1.0609 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 5 it 55 total=13.2130 mle=1.6961 pcon=8.5619 forget=1.9002 orth=1.0547 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 5 it 105 total=13.2335 mle=1.7385 pcon=8.5621 forget=1.8845 orth=1.0484 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 5 it 155 total=13.3041 mle=1.8332 pcon=8.5626 forget=1.8669 orth=1.0416 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 5 it 205 total=13.0990 mle=1.6793 pcon=8.5631 forget=1.8223 orth=1.0343 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 5 it 255 total=13.4326 mle=1.9995 pcon=8.5640 forget=1.8420 orth=1.0271 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 5 it 305 total=13.2780 mle=1.9604 pcon=8.5650 forget=1.7337 orth=1.0190 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 5 it 355 total=13.2418 mle=1.9730 pcon=8.5663 forget=1.6920 orth=1.0106 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 5 it 405 total=12.8700 mle=1.7569 pcon=8.5678 forget=1.5434 orth=1.0019 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 6 it 26 total=12.8571 mle=1.8552 pcon=8.5693 forget=1.4392 orth=0.9933 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 6 it 76 total=13.1038 mle=2.0757 pcon=8.5710 forget=1.4716 orth=0.9856 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 6 it 126 total=12.7503 mle=1.7865 pcon=8.5726 forget=1.4122 orth=0.9791 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 6 it 176 total=12.6573 mle=1.6698 pcon=8.5742 forget=1.4398 orth=0.9735 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 6 it 226 total=12.7795 mle=1.8902 pcon=8.5759 forget=1.3447 orth=0.9687 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 6 it 276 total=12.6593 mle=1.8161 pcon=8.5775 forget=1.3016 orth=0.9641 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 6 it 326 total=12.5168 mle=1.6410 pcon=8.5791 forget=1.3369 orth=0.9598 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
 14%|█▍        | 7/50 [05:48<32:32, 45.42s/it] 16%|█▌        | 8/50 [06:30<31:02, 44.35s/it] 18%|█▊        | 9/50 [07:12<29:56, 43.82s/it] 20%|██        | 10/50 [07:55<28:54, 43.36s/it] 22%|██▏       | 11/50 [08:37<27:58, 43.03s/it] 24%|██▍       | 12/50 [09:19<27:09, 42.88s/it] 26%|██▌       | 13/50 [10:02<26:21, 42.75s/it][loss] ep 6 it 376 total=12.5305 mle=1.6543 pcon=8.5808 forget=1.3398 orth=0.9556 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 6 it 426 total=12.5617 mle=1.7433 pcon=8.5824 forget=1.2843 orth=0.9516 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 7 it 47 total=12.6541 mle=1.7712 pcon=8.5839 forget=1.3513 orth=0.9476 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 7 it 97 total=12.5513 mle=1.7413 pcon=8.5855 forget=1.2810 orth=0.9435 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 7 it 147 total=12.4798 mle=1.6336 pcon=8.5870 forget=1.3200 orth=0.9392 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 7 it 197 total=12.7192 mle=1.8683 pcon=8.5885 forget=1.3274 orth=0.9350 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 7 it 247 total=12.7969 mle=1.9624 pcon=8.5899 forget=1.3138 orth=0.9307 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 7 it 297 total=12.4937 mle=1.6271 pcon=8.5912 forget=1.3488 orth=0.9266 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 7 it 347 total=12.4932 mle=1.6221 pcon=8.5925 forget=1.3561 orth=0.9225 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 7 it 397 total=12.6225 mle=1.7468 pcon=8.5937 forget=1.3636 orth=0.9184 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 8 it 18 total=12.6383 mle=1.7983 pcon=8.5949 forget=1.3310 orth=0.9142 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 8 it 68 total=12.7941 mle=1.9167 pcon=8.5959 forget=1.3712 orth=0.9103 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 8 it 118 total=12.7892 mle=1.8747 pcon=8.5969 forget=1.4114 orth=0.9062 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 8 it 168 total=12.7330 mle=1.8350 pcon=8.5979 forget=1.3978 orth=0.9024 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 8 it 218 total=12.7799 mle=1.8317 pcon=8.5987 forget=1.4509 orth=0.8985 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 8 it 268 total=12.6437 mle=1.7249 pcon=8.5995 forget=1.4250 orth=0.8943 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 8 it 318 total=12.7095 mle=1.7152 pcon=8.6003 forget=1.5038 orth=0.8901 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 8 it 368 total=12.7960 mle=1.8152 pcon=8.6009 forget=1.4936 orth=0.8863 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 8 it 418 total=12.6696 mle=1.6887 pcon=8.6016 forget=1.4969 orth=0.8825 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 9 it 39 total=12.6766 mle=1.7103 pcon=8.6021 forget=1.4859 orth=0.8783 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 9 it 89 total=12.7715 mle=1.7919 pcon=8.6026 forget=1.5026 orth=0.8744 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 9 it 139 total=13.0629 mle=2.0841 pcon=8.6030 forget=1.5053 orth=0.8705 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 9 it 189 total=12.7215 mle=1.7145 pcon=8.6033 forget=1.5368 orth=0.8669 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 9 it 239 total=12.8579 mle=1.8523 pcon=8.6036 forget=1.5391 orth=0.8630 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 9 it 289 total=12.7458 mle=1.7394 pcon=8.6038 forget=1.5438 orth=0.8589 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 9 it 339 total=12.6788 mle=1.6751 pcon=8.6039 forget=1.5447 orth=0.8551 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 9 it 389 total=13.0976 mle=2.0491 pcon=8.6040 forget=1.5933 orth=0.8511 favg=0.0000 nr=57 nf=57 protos=600 fproto_sim=NA
[loss] ep 10 it 10 total=12.7080 mle=1.7378 pcon=8.6040 forget=1.5191 orth=0.8471 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 10 it 60 total=12.7086 mle=1.7237 pcon=8.6040 forget=1.5380 orth=0.8430 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 10 it 110 total=12.6314 mle=1.6553 pcon=8.6039 forget=1.5333 orth=0.8390 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 10 it 160 total=12.7002 mle=1.7460 pcon=8.6037 forget=1.5157 orth=0.8349 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 10 it 210 total=12.7694 mle=1.7910 pcon=8.6034 forget=1.5441 orth=0.8308 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 10 it 260 total=12.5309 mle=1.6205 pcon=8.6030 forget=1.4807 orth=0.8267 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 10 it 310 total=12.7317 mle=1.7729 pcon=8.6026 forget=1.5339 orth=0.8223 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 10 it 360 total=12.7608 mle=1.8702 pcon=8.6022 forget=1.4704 orth=0.8180 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 10 it 410 total=12.5922 mle=1.7054 pcon=8.6018 forget=1.4714 orth=0.8136 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 11 it 31 total=12.5341 mle=1.7027 pcon=8.6013 forget=1.4211 orth=0.8091 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 11 it 81 total=12.7120 mle=1.8220 pcon=8.6008 forget=1.4848 orth=0.8044 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 11 it 131 total=12.5010 mle=1.6728 pcon=8.6003 forget=1.4282 orth=0.7997 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 11 it 181 total=12.5656 mle=1.7635 pcon=8.5999 forget=1.4076 orth=0.7946 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 11 it 231 total=12.7218 mle=1.9663 pcon=8.5994 forget=1.3665 orth=0.7895 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 11 it 281 total=12.4956 mle=1.8180 pcon=8.5990 forget=1.2946 orth=0.7840 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 11 it 331 total=12.4738 mle=1.7340 pcon=8.5986 forget=1.3628 orth=0.7783 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 11 it 381 total=12.3831 mle=1.7043 pcon=8.5983 forget=1.3082 orth=0.7722 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 12 it 2 total=12.2441 mle=1.6022 pcon=8.5980 forget=1.2779 orth=0.7660 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 12 it 52 total=12.4317 mle=1.8492 pcon=8.5978 forget=1.2257 orth=0.7591 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 12 it 102 total=12.3424 mle=1.7749 pcon=8.5975 forget=1.2179 orth=0.7521 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 12 it 152 total=12.4431 mle=1.8164 pcon=8.5973 forget=1.2846 orth=0.7448 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 12 it 202 total=12.3981 mle=1.8585 pcon=8.5971 forget=1.2052 orth=0.7373 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 12 it 252 total=12.3956 mle=1.9195 pcon=8.5970 forget=1.1501 orth=0.7291 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 12 it 302 total=12.2693 mle=1.7555 pcon=8.5968 forget=1.1962 orth=0.7208 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 12 it 352 total=12.3524 mle=1.7976 pcon=8.5966 forget=1.2458 orth=0.7123 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 12 it 402 total=12.2136 mle=1.7568 pcon=8.5965 forget=1.1562 orth=0.7041 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 13 it 23 total=12.3119 mle=1.8489 pcon=8.5963 forget=1.1717 orth=0.6950 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 13 it 73 total=12.4207 mle=1.9284 pcon=8.5962 forget=1.2104 orth=0.6858 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 13 it 123 total=12.5067 mle=2.0251 pcon=8.5960 forget=1.2093 orth=0.6764 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
 28%|██▊       | 14/50 [10:28<22:36, 37.68s/it] 30%|███       | 15/50 [10:48<18:51, 32.33s/it] 32%|███▏      | 16/50 [11:07<16:09, 28.52s/it] 34%|███▍      | 17/50 [11:27<14:14, 25.90s/it] 36%|███▌      | 18/50 [12:05<15:45, 29.54s/it] 38%|███▊      | 19/50 [12:45<16:51, 32.64s/it][loss] ep 13 it 173 total=12.3044 mle=1.8628 pcon=8.5958 forget=1.1790 orth=0.6668 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 13 it 223 total=12.0092 mle=1.5755 pcon=8.5957 forget=1.1809 orth=0.6572 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 13 it 273 total=12.3973 mle=1.9706 pcon=8.5955 forget=1.1838 orth=0.6474 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 13 it 323 total=12.4101 mle=1.9011 pcon=8.5954 forget=1.2763 orth=0.6373 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 13 it 373 total=12.3546 mle=1.9157 pcon=8.5952 forget=1.2168 orth=0.6269 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 13 it 423 total=12.2613 mle=1.7993 pcon=8.5950 forget=1.2507 orth=0.6162 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 14 it 44 total=12.0600 mle=1.6297 pcon=8.5949 forget=1.2299 orth=0.6055 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 14 it 94 total=12.1691 mle=1.7200 pcon=8.5948 forget=1.2599 orth=0.5944 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 14 it 144 total=12.1779 mle=1.7812 pcon=8.5946 forget=1.2189 orth=0.5832 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 14 it 194 total=12.1188 mle=1.7012 pcon=8.5945 forget=1.2513 orth=0.5718 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 14 it 244 total=12.0684 mle=1.6698 pcon=8.5944 forget=1.2440 orth=0.5603 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 14 it 294 total=12.3039 mle=1.9034 pcon=8.5943 forget=1.2574 orth=0.5488 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 14 it 344 total=12.0090 mle=1.5838 pcon=8.5943 forget=1.2935 orth=0.5374 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 14 it 394 total=12.1627 mle=1.7478 pcon=8.5942 forget=1.2952 orth=0.5254 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 15 it 15 total=12.3464 mle=1.8989 pcon=8.5941 forget=1.3400 orth=0.5134 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 15 it 65 total=12.1435 mle=1.7590 pcon=8.5941 forget=1.2889 orth=0.5015 favg=0.0000 nr=56 nf=56 protos=600 fproto_sim=NA
[loss] ep 15 it 115 total=12.1523 mle=1.7576 pcon=8.5941 forget=1.3109 orth=0.4896 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 15 it 165 total=12.2371 mle=1.7990 pcon=8.5941 forget=1.3663 orth=0.4777 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 15 it 215 total=11.9822 mle=1.6001 pcon=8.5941 forget=1.3223 orth=0.4657 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 15 it 265 total=12.1557 mle=1.7614 pcon=8.5941 forget=1.3463 orth=0.4538 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 15 it 315 total=12.1922 mle=1.7811 pcon=8.5942 forget=1.3750 orth=0.4418 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 15 it 365 total=12.0742 mle=1.6995 pcon=8.5943 forget=1.3503 orth=0.4300 favg=0.0000 nr=57 nf=57 protos=600 fproto_sim=NA
[loss] ep 15 it 415 total=12.0096 mle=1.6416 pcon=8.5944 forget=1.3554 orth=0.4182 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 16 it 36 total=12.1299 mle=1.7399 pcon=8.5945 forget=1.3891 orth=0.4064 favg=0.0000 nr=57 nf=57 protos=600 fproto_sim=NA
[loss] ep 16 it 86 total=12.0790 mle=1.7123 pcon=8.5947 forget=1.3772 orth=0.3948 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 16 it 136 total=12.1053 mle=1.7042 pcon=8.5948 forget=1.4230 orth=0.3832 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 16 it 186 total=12.3231 mle=1.9786 pcon=8.5950 forget=1.3777 orth=0.3719 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 16 it 236 total=12.1348 mle=1.7510 pcon=8.5952 forget=1.4279 orth=0.3607 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 16 it 286 total=12.0730 mle=1.7390 pcon=8.5954 forget=1.3887 orth=0.3498 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 16 it 336 total=12.0975 mle=1.7502 pcon=8.5957 forget=1.4126 orth=0.3391 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 16 it 386 total=12.2850 mle=1.9659 pcon=8.5960 forget=1.3946 orth=0.3285 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 17 it 7 total=11.9700 mle=1.6293 pcon=8.5963 forget=1.4263 orth=0.3182 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 17 it 57 total=12.1160 mle=1.7800 pcon=8.5966 forget=1.4312 orth=0.3081 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 17 it 107 total=12.0978 mle=1.8148 pcon=8.5969 forget=1.3879 orth=0.2982 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 17 it 157 total=12.1818 mle=1.9130 pcon=8.5972 forget=1.3830 orth=0.2886 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 17 it 207 total=12.0267 mle=1.7509 pcon=8.5975 forget=1.3991 orth=0.2793 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 17 it 257 total=11.9406 mle=1.6425 pcon=8.5978 forget=1.4300 orth=0.2703 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 17 it 307 total=12.0323 mle=1.7301 pcon=8.5981 forget=1.4427 orth=0.2615 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 17 it 357 total=12.0712 mle=1.8245 pcon=8.5985 forget=1.3953 orth=0.2530 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 17 it 407 total=12.0588 mle=1.7827 pcon=8.5988 forget=1.4326 orth=0.2448 favg=0.0000 nr=56 nf=56 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 18 it 28 total=11.9127 mle=1.6805 pcon=8.5991 forget=1.3962 orth=0.2368 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 18 it 78 total=11.9878 mle=1.7952 pcon=8.5994 forget=1.3640 orth=0.2291 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 18 it 128 total=11.8452 mle=1.6789 pcon=8.5997 forget=1.3449 orth=0.2218 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 18 it 178 total=11.8766 mle=1.7285 pcon=8.6001 forget=1.3335 orth=0.2146 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 18 it 228 total=12.0013 mle=1.8743 pcon=8.6004 forget=1.3189 orth=0.2077 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 18 it 278 total=11.8401 mle=1.7052 pcon=8.6006 forget=1.3332 orth=0.2011 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 18 it 328 total=11.9105 mle=1.8016 pcon=8.6009 forget=1.3133 orth=0.1947 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 18 it 378 total=11.9313 mle=1.8265 pcon=8.6012 forget=1.3154 orth=0.1882 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 18 it 428 total=11.8527 mle=1.7560 pcon=8.6014 forget=1.3132 orth=0.1820 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 19 it 49 total=11.7954 mle=1.7270 pcon=8.6016 forget=1.2908 orth=0.1760 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 19 it 99 total=11.7715 mle=1.7011 pcon=8.6018 forget=1.2984 orth=0.1702 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 19 it 149 total=11.9007 mle=1.7945 pcon=8.6020 forget=1.3397 orth=0.1645 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 19 it 199 total=11.8870 mle=1.7801 pcon=8.6021 forget=1.3458 orth=0.1590 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
 40%|████      | 20/50 [13:23<17:09, 34.32s/it] 42%|████▏     | 21/50 [14:01<17:03, 35.30s/it] 44%|████▍     | 22/50 [14:39<16:54, 36.23s/it] 46%|████▌     | 23/50 [15:16<16:25, 36.50s/it] 48%|████▊     | 24/50 [15:53<15:46, 36.40s/it] 50%|█████     | 25/50 [16:31<15:25, 37.00s/it] 52%|█████▏    | 26/50 [17:09<14:52, 37.19s/it][loss] ep 19 it 249 total=11.7988 mle=1.6910 pcon=8.6023 forget=1.3517 orth=0.1537 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 19 it 299 total=11.7437 mle=1.6748 pcon=8.6025 forget=1.3177 orth=0.1488 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 19 it 349 total=11.8694 mle=1.7817 pcon=8.6026 forget=1.3412 orth=0.1439 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 19 it 399 total=11.7785 mle=1.6939 pcon=8.6027 forget=1.3427 orth=0.1393 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 20 it 20 total=11.9036 mle=1.8594 pcon=8.6028 forget=1.3068 orth=0.1346 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 20 it 70 total=11.7209 mle=1.6319 pcon=8.6029 forget=1.3558 orth=0.1302 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 20 it 120 total=11.7435 mle=1.6986 pcon=8.6030 forget=1.3158 orth=0.1261 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 20 it 170 total=11.7039 mle=1.6083 pcon=8.6031 forget=1.3702 orth=0.1222 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 20 it 220 total=11.9336 mle=1.8657 pcon=8.6032 forget=1.3462 orth=0.1184 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 20 it 270 total=11.9603 mle=1.8662 pcon=8.6033 forget=1.3760 orth=0.1147 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 20 it 320 total=11.8104 mle=1.7312 pcon=8.6034 forget=1.3644 orth=0.1113 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 20 it 370 total=11.8138 mle=1.7358 pcon=8.6036 forget=1.3663 orth=0.1081 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 20 it 420 total=11.9612 mle=1.8675 pcon=8.6037 forget=1.3850 orth=0.1050 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 21 it 41 total=11.9393 mle=1.8507 pcon=8.6038 forget=1.3828 orth=0.1020 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 21 it 91 total=11.7960 mle=1.7007 pcon=8.6039 forget=1.3924 orth=0.0991 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 21 it 141 total=12.0842 mle=1.9675 pcon=8.6041 forget=1.4163 orth=0.0963 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 21 it 191 total=11.9213 mle=1.8109 pcon=8.6042 forget=1.4124 orth=0.0937 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 21 it 241 total=11.9416 mle=1.8588 pcon=8.6044 forget=1.3871 orth=0.0913 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 21 it 291 total=11.8701 mle=1.7106 pcon=8.6045 forget=1.4659 orth=0.0890 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 21 it 341 total=11.7666 mle=1.6776 pcon=8.6047 forget=1.3976 orth=0.0868 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 21 it 391 total=11.7589 mle=1.6424 pcon=8.6049 forget=1.4269 orth=0.0847 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 22 it 12 total=11.9268 mle=1.7893 pcon=8.6050 forget=1.4498 orth=0.0827 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 22 it 62 total=11.9629 mle=1.8094 pcon=8.6052 forget=1.4675 orth=0.0808 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 22 it 112 total=12.0761 mle=1.9433 pcon=8.6054 forget=1.4485 orth=0.0790 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 22 it 162 total=12.0813 mle=1.9626 pcon=8.6056 forget=1.4360 orth=0.0771 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 22 it 212 total=12.0726 mle=1.9516 pcon=8.6058 forget=1.4396 orth=0.0755 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 22 it 262 total=11.8219 mle=1.6919 pcon=8.6060 forget=1.4500 orth=0.0740 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 22 it 312 total=11.8988 mle=1.7563 pcon=8.6062 forget=1.4638 orth=0.0725 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 22 it 362 total=11.7730 mle=1.6380 pcon=8.6065 forget=1.4574 orth=0.0711 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 22 it 412 total=11.9439 mle=1.7941 pcon=8.6067 forget=1.4734 orth=0.0697 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 23 it 33 total=11.8962 mle=1.7369 pcon=8.6069 forget=1.4840 orth=0.0684 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 23 it 83 total=11.7327 mle=1.5541 pcon=8.6071 forget=1.5042 orth=0.0672 favg=0.0000 nr=56 nf=56 protos=600 fproto_sim=NA
[loss] ep 23 it 133 total=12.0541 mle=1.8213 pcon=8.6074 forget=1.5594 orth=0.0660 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 23 it 183 total=11.8141 mle=1.6701 pcon=8.6076 forget=1.4715 orth=0.0649 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 23 it 233 total=12.0123 mle=1.8091 pcon=8.6078 forget=1.5315 orth=0.0639 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 23 it 283 total=11.8864 mle=1.7231 pcon=8.6081 forget=1.4923 orth=0.0628 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 23 it 333 total=11.9618 mle=1.8103 pcon=8.6084 forget=1.4814 orth=0.0618 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 23 it 383 total=11.9053 mle=1.7657 pcon=8.6087 forget=1.4702 orth=0.0608 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 24 it 4 total=11.8792 mle=1.7452 pcon=8.6090 forget=1.4652 orth=0.0598 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 24 it 54 total=11.7845 mle=1.6181 pcon=8.6092 forget=1.4983 orth=0.0589 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 24 it 104 total=11.9253 mle=1.7746 pcon=8.6095 forget=1.4832 orth=0.0580 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 24 it 154 total=11.9602 mle=1.8275 pcon=8.6098 forget=1.4657 orth=0.0572 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 24 it 204 total=11.9863 mle=1.8286 pcon=8.6101 forget=1.4913 orth=0.0563 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 24 it 254 total=11.8487 mle=1.7112 pcon=8.6104 forget=1.4715 orth=0.0555 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 24 it 304 total=11.8743 mle=1.7403 pcon=8.6107 forget=1.4685 orth=0.0548 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 24 it 354 total=11.8035 mle=1.6936 pcon=8.6110 forget=1.4448 orth=0.0541 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 24 it 404 total=12.0933 mle=1.9465 pcon=8.6113 forget=1.4821 orth=0.0534 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 25 it 25 total=11.8105 mle=1.6774 pcon=8.6116 forget=1.4687 orth=0.0528 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 25 it 75 total=11.9089 mle=1.7660 pcon=8.6119 forget=1.4789 orth=0.0522 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 25 it 125 total=12.0570 mle=1.9467 pcon=8.6121 forget=1.4466 orth=0.0516 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 25 it 175 total=12.1100 mle=1.9869 pcon=8.6124 forget=1.4595 orth=0.0511 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 25 it 225 total=11.7702 mle=1.6794 pcon=8.6127 forget=1.4275 orth=0.0506 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 25 it 275 total=11.8703 mle=1.7803 pcon=8.6130 forget=1.4270 orth=0.0500 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 25 it 325 total=11.8534 mle=1.7605 pcon=8.6132 forget=1.4302 orth=0.0496 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 25 it 375 total=11.7613 mle=1.6711 pcon=8.6134 forget=1.4276 orth=0.0491 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 25 it 425 total=11.8795 mle=1.8195 pcon=8.6136 forget=1.3976 orth=0.0488 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 26 it 46 total=11.6752 mle=1.6010 pcon=8.6139 forget=1.4118 orth=0.0484 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 26 it 96 total=11.8587 mle=1.8105 pcon=8.6141 forget=1.3861 orth=0.0481 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 26 it 146 total=11.7974 mle=1.7297 pcon=8.6142 forget=1.4058 orth=0.0477 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
 54%|█████▍    | 27/50 [17:47<14:20, 37.41s/it] 56%|█████▌    | 28/50 [18:22<13:32, 36.95s/it] 58%|█████▊    | 29/50 [19:00<12:57, 37.03s/it] 60%|██████    | 30/50 [19:36<12:14, 36.73s/it] 62%|██████▏   | 31/50 [20:13<11:41, 36.94s/it] 64%|██████▍   | 32/50 [20:50<11:06, 37.00s/it] 66%|██████▌   | 33/50 [21:28<10:30, 37.08s/it][loss] ep 26 it 196 total=11.7725 mle=1.7347 pcon=8.6144 forget=1.3760 orth=0.0475 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 26 it 246 total=11.9624 mle=1.9510 pcon=8.6145 forget=1.3497 orth=0.0472 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 26 it 296 total=11.7364 mle=1.7138 pcon=8.6147 forget=1.3609 orth=0.0470 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 26 it 346 total=11.7880 mle=1.7810 pcon=8.6148 forget=1.3454 orth=0.0468 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 26 it 396 total=11.8620 mle=1.8860 pcon=8.6149 forget=1.3144 orth=0.0467 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 27 it 17 total=11.7542 mle=1.7781 pcon=8.6150 forget=1.3146 orth=0.0465 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 27 it 67 total=11.6417 mle=1.6576 pcon=8.6150 forget=1.3228 orth=0.0464 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 27 it 117 total=11.7720 mle=1.8205 pcon=8.6150 forget=1.2902 orth=0.0463 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 27 it 167 total=11.9044 mle=1.9167 pcon=8.6151 forget=1.3266 orth=0.0461 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 27 it 217 total=11.5658 mle=1.6286 pcon=8.6151 forget=1.2762 orth=0.0460 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 27 it 267 total=11.6642 mle=1.7040 pcon=8.6151 forget=1.2993 orth=0.0458 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 27 it 317 total=11.6028 mle=1.6256 pcon=8.6150 forget=1.3166 orth=0.0456 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 27 it 367 total=11.6920 mle=1.7653 pcon=8.6150 forget=1.2663 orth=0.0454 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 27 it 417 total=11.7461 mle=1.8224 pcon=8.6149 forget=1.2635 orth=0.0452 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 28 it 38 total=11.7598 mle=1.8109 pcon=8.6149 forget=1.2890 orth=0.0451 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 28 it 88 total=11.7380 mle=1.7739 pcon=8.6148 forget=1.3044 orth=0.0448 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 28 it 138 total=11.8049 mle=1.8167 pcon=8.6147 forget=1.3288 orth=0.0446 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 28 it 188 total=11.6927 mle=1.7437 pcon=8.6146 forget=1.2900 orth=0.0444 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 28 it 238 total=11.9869 mle=2.0166 pcon=8.6144 forget=1.3117 orth=0.0442 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 28 it 288 total=11.7928 mle=1.8536 pcon=8.6143 forget=1.2811 orth=0.0439 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 28 it 338 total=11.8725 mle=1.8845 pcon=8.6141 forget=1.3302 orth=0.0437 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 28 it 388 total=11.7598 mle=1.7858 pcon=8.6140 forget=1.3166 orth=0.0435 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[loss] ep 29 it 9 total=11.6632 mle=1.6856 pcon=8.6138 forget=1.3206 orth=0.0432 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 29 it 59 total=11.7425 mle=1.7590 pcon=8.6135 forget=1.3270 orth=0.0430 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 29 it 109 total=11.6652 mle=1.7057 pcon=8.6134 forget=1.3033 orth=0.0428 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 29 it 159 total=11.7609 mle=1.7394 pcon=8.6132 forget=1.3658 orth=0.0425 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 29 it 209 total=11.7593 mle=1.7799 pcon=8.6129 forget=1.3242 orth=0.0423 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 29 it 259 total=11.7221 mle=1.7456 pcon=8.6127 forget=1.3218 orth=0.0420 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 29 it 309 total=11.7891 mle=1.7696 pcon=8.6125 forget=1.3653 orth=0.0418 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 29 it 359 total=11.8401 mle=1.8060 pcon=8.6123 forget=1.3802 orth=0.0415 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 29 it 409 total=11.7038 mle=1.6893 pcon=8.6121 forget=1.3610 orth=0.0413 favg=0.0000 nr=57 nf=57 protos=600 fproto_sim=NA
[loss] ep 30 it 30 total=11.6794 mle=1.6536 pcon=8.6119 forget=1.3729 orth=0.0411 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 30 it 80 total=12.0345 mle=2.0190 pcon=8.6117 forget=1.3630 orth=0.0409 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 30 it 130 total=11.9383 mle=1.8877 pcon=8.6114 forget=1.3985 orth=0.0406 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 30 it 180 total=11.8585 mle=1.7745 pcon=8.6112 forget=1.4324 orth=0.0404 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 30 it 230 total=11.6895 mle=1.6011 pcon=8.6109 forget=1.4372 orth=0.0402 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 30 it 280 total=11.9175 mle=1.8436 pcon=8.6107 forget=1.4233 orth=0.0399 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 30 it 330 total=11.8862 mle=1.8152 pcon=8.6105 forget=1.4208 orth=0.0397 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 30 it 380 total=11.7762 mle=1.6933 pcon=8.6102 forget=1.4333 orth=0.0395 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 31 it 1 total=11.8083 mle=1.7125 pcon=8.6099 forget=1.4467 orth=0.0393 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 31 it 51 total=12.0123 mle=1.8911 pcon=8.6097 forget=1.4725 orth=0.0390 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 31 it 101 total=12.0215 mle=1.9008 pcon=8.6094 forget=1.4724 orth=0.0388 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 31 it 151 total=11.9442 mle=1.8239 pcon=8.6092 forget=1.4725 orth=0.0387 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 31 it 201 total=11.8102 mle=1.6639 pcon=8.6089 forget=1.4989 orth=0.0385 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 31 it 251 total=11.7932 mle=1.6661 pcon=8.6086 forget=1.4801 orth=0.0383 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 31 it 301 total=11.7880 mle=1.6217 pcon=8.6084 forget=1.5199 orth=0.0381 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 31 it 351 total=11.8615 mle=1.7222 pcon=8.6082 forget=1.4933 orth=0.0378 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 31 it 401 total=11.9779 mle=1.8229 pcon=8.6079 forget=1.5094 orth=0.0377 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 32 it 22 total=11.8168 mle=1.6628 pcon=8.6077 forget=1.5088 orth=0.0375 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 32 it 72 total=11.8245 mle=1.6589 pcon=8.6074 forget=1.5209 orth=0.0373 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 32 it 122 total=11.8450 mle=1.6649 pcon=8.6071 forget=1.5358 orth=0.0371 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 32 it 172 total=11.9609 mle=1.7586 pcon=8.6069 forget=1.5584 orth=0.0370 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 32 it 222 total=11.8353 mle=1.6464 pcon=8.6067 forget=1.5455 orth=0.0368 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 32 it 272 total=11.9359 mle=1.7075 pcon=8.6064 forget=1.5853 orth=0.0366 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 32 it 322 total=12.0168 mle=1.8083 pcon=8.6062 forget=1.5659 orth=0.0365 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 32 it 372 total=11.9844 mle=1.7781 pcon=8.6060 forget=1.5640 orth=0.0363 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 32 it 422 total=11.9899 mle=1.7514 pcon=8.6057 forget=1.5966 orth=0.0361 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 33 it 43 total=11.8224 mle=1.6044 pcon=8.6055 forget=1.5766 orth=0.0360 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
 68%|██████▊   | 34/50 [22:04<09:48, 36.78s/it] 70%|███████   | 35/50 [22:40<09:11, 36.75s/it] 72%|███████▏  | 36/50 [23:17<08:34, 36.73s/it] 74%|███████▍  | 37/50 [23:37<06:50, 31.59s/it] 76%|███████▌  | 38/50 [23:55<05:32, 27.70s/it] 78%|███████▊  | 39/50 [24:15<04:40, 25.46s/it] 80%|████████  | 40/50 [24:33<03:50, 23.09s/it][loss] ep 33 it 93 total=11.9160 mle=1.6827 pcon=8.6053 forget=1.5923 orth=0.0358 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 33 it 143 total=12.0160 mle=1.7577 pcon=8.6050 forget=1.6175 orth=0.0357 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 33 it 193 total=12.0274 mle=1.8001 pcon=8.6048 forget=1.5869 orth=0.0355 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 33 it 243 total=12.0244 mle=1.7593 pcon=8.6046 forget=1.6251 orth=0.0354 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 33 it 293 total=12.0741 mle=1.8195 pcon=8.6044 forget=1.6150 orth=0.0352 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 33 it 343 total=11.9118 mle=1.6423 pcon=8.6042 forget=1.6302 orth=0.0351 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 33 it 393 total=11.9764 mle=1.6896 pcon=8.6040 forget=1.6478 orth=0.0349 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 34 it 14 total=11.9813 mle=1.7148 pcon=8.6039 forget=1.6278 orth=0.0348 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 34 it 64 total=12.0092 mle=1.7488 pcon=8.6037 forget=1.6220 orth=0.0347 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 34 it 114 total=11.9953 mle=1.7429 pcon=8.6036 forget=1.6143 orth=0.0345 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 34 it 164 total=12.0205 mle=1.7495 pcon=8.6034 forget=1.6332 orth=0.0344 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 34 it 214 total=12.0521 mle=1.7920 pcon=8.6033 forget=1.6225 orth=0.0343 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 34 it 264 total=11.9522 mle=1.6829 pcon=8.6031 forget=1.6320 orth=0.0341 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 34 it 314 total=11.9168 mle=1.6422 pcon=8.6030 forget=1.6376 orth=0.0340 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 34 it 364 total=11.9479 mle=1.6564 pcon=8.6029 forget=1.6547 orth=0.0339 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 34 it 414 total=12.0592 mle=1.7529 pcon=8.6028 forget=1.6697 orth=0.0337 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 35 it 35 total=11.9597 mle=1.6790 pcon=8.6027 forget=1.6443 orth=0.0336 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 35 it 85 total=12.0454 mle=1.7609 pcon=8.6026 forget=1.6484 orth=0.0335 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 35 it 135 total=11.9845 mle=1.7029 pcon=8.6025 forget=1.6457 orth=0.0334 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 35 it 185 total=11.8521 mle=1.5624 pcon=8.6024 forget=1.6539 orth=0.0332 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 35 it 235 total=11.9326 mle=1.6727 pcon=8.6024 forget=1.6244 orth=0.0331 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 35 it 285 total=12.0379 mle=1.7543 pcon=8.6023 forget=1.6483 orth=0.0330 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 35 it 335 total=11.9325 mle=1.6543 pcon=8.6023 forget=1.6430 orth=0.0329 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 35 it 385 total=11.9535 mle=1.6857 pcon=8.6023 forget=1.6327 orth=0.0328 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 36 it 6 total=11.9490 mle=1.6884 pcon=8.6023 forget=1.6256 orth=0.0327 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 36 it 56 total=12.0196 mle=1.7571 pcon=8.6023 forget=1.6276 orth=0.0326 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 36 it 106 total=12.0509 mle=1.7790 pcon=8.6023 forget=1.6372 orth=0.0325 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 36 it 156 total=11.9080 mle=1.6522 pcon=8.6023 forget=1.6211 orth=0.0324 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 36 it 206 total=11.9854 mle=1.7434 pcon=8.6024 forget=1.6073 orth=0.0323 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 36 it 256 total=12.0180 mle=1.7621 pcon=8.6024 forget=1.6214 orth=0.0322 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 36 it 306 total=11.8778 mle=1.6330 pcon=8.6025 forget=1.6103 orth=0.0321 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 36 it 356 total=11.9462 mle=1.6821 pcon=8.6026 forget=1.6296 orth=0.0320 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 36 it 406 total=11.9442 mle=1.6954 pcon=8.6027 forget=1.6141 orth=0.0319 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 37 it 27 total=12.0149 mle=1.7887 pcon=8.6029 forget=1.5915 orth=0.0318 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 37 it 77 total=11.9331 mle=1.7161 pcon=8.6030 forget=1.5823 orth=0.0317 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 37 it 127 total=12.0448 mle=1.8220 pcon=8.6032 forget=1.5880 orth=0.0316 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 37 it 177 total=11.8916 mle=1.6727 pcon=8.6033 forget=1.5840 orth=0.0316 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 37 it 227 total=11.9333 mle=1.7412 pcon=8.6035 forget=1.5572 orth=0.0315 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 37 it 277 total=11.8412 mle=1.6468 pcon=8.6037 forget=1.5594 orth=0.0314 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 37 it 327 total=11.7434 mle=1.5688 pcon=8.6039 forget=1.5394 orth=0.0314 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 37 it 377 total=11.8523 mle=1.6732 pcon=8.6042 forget=1.5436 orth=0.0313 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 37 it 427 total=11.7634 mle=1.6046 pcon=8.6044 forget=1.5232 orth=0.0312 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 38 it 48 total=12.0692 mle=1.8727 pcon=8.6047 forget=1.5607 orth=0.0312 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 38 it 98 total=12.0061 mle=1.8669 pcon=8.6050 forget=1.5030 orth=0.0311 favg=0.0000 nr=56 nf=56 protos=600 fproto_sim=NA
[loss] ep 38 it 148 total=11.7901 mle=1.6505 pcon=8.6052 forget=1.5032 orth=0.0311 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 38 it 198 total=11.9566 mle=1.8477 pcon=8.6055 forget=1.4722 orth=0.0311 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 38 it 248 total=12.0065 mle=1.8839 pcon=8.6058 forget=1.4856 orth=0.0311 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 38 it 298 total=11.7452 mle=1.6291 pcon=8.6062 forget=1.4789 orth=0.0311 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 38 it 348 total=12.0349 mle=1.9108 pcon=8.6065 forget=1.4865 orth=0.0311 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 38 it 398 total=11.7230 mle=1.6043 pcon=8.6068 forget=1.4808 orth=0.0311 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 39 it 19 total=11.9662 mle=1.8876 pcon=8.6072 forget=1.4403 orth=0.0311 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 39 it 69 total=11.9730 mle=1.8693 pcon=8.6075 forget=1.4651 orth=0.0311 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 39 it 119 total=11.6726 mle=1.5992 pcon=8.6079 forget=1.4345 orth=0.0311 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 39 it 169 total=11.9475 mle=1.8462 pcon=8.6082 forget=1.4620 orth=0.0311 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 39 it 219 total=11.7374 mle=1.6769 pcon=8.6086 forget=1.4208 orth=0.0311 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 39 it 269 total=11.8089 mle=1.7516 pcon=8.6089 forget=1.4172 orth=0.0312 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 39 it 319 total=11.8406 mle=1.7624 pcon=8.6093 forget=1.4377 orth=0.0312 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 39 it 369 total=11.7080 mle=1.6802 pcon=8.6097 forget=1.3870 orth=0.0312 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 39 it 419 total=11.6542 mle=1.6287 pcon=8.6100 forget=1.3842 orth=0.0313 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 40 it 40 total=11.8455 mle=1.7832 pcon=8.6104 forget=1.4206 orth=0.0313 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 40 it 90 total=11.6913 mle=1.6411 pcon=8.6108 forget=1.4081 orth=0.0314 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 40 it 140 total=11.6528 mle=1.6099 pcon=8.6111 forget=1.4004 orth=0.0314 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
 82%|████████▏ | 41/50 [24:50<03:11, 21.28s/it] 84%|████████▍ | 42/50 [25:08<02:42, 20.35s/it] 86%|████████▌ | 43/50 [25:30<02:24, 20.65s/it] 88%|████████▊ | 44/50 [25:50<02:04, 20.73s/it] 90%|█████████ | 45/50 [26:10<01:42, 20.46s/it] 92%|█████████▏| 46/50 [26:30<01:20, 20.24s/it] 94%|█████████▍| 47/50 [26:50<01:00, 20.26s/it][loss] ep 40 it 190 total=11.5829 mle=1.5654 pcon=8.6115 forget=1.3745 orth=0.0315 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 40 it 240 total=11.6736 mle=1.6321 pcon=8.6118 forget=1.3983 orth=0.0315 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 40 it 290 total=11.6494 mle=1.6070 pcon=8.6121 forget=1.3987 orth=0.0315 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 40 it 340 total=11.7167 mle=1.6867 pcon=8.6125 forget=1.3859 orth=0.0316 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 40 it 390 total=11.7414 mle=1.6457 pcon=8.6128 forget=1.4513 orth=0.0317 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 41 it 11 total=11.9201 mle=1.8817 pcon=8.6131 forget=1.3936 orth=0.0317 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 41 it 61 total=11.8026 mle=1.7644 pcon=8.6134 forget=1.3930 orth=0.0318 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 41 it 111 total=11.9491 mle=1.8998 pcon=8.6137 forget=1.4038 orth=0.0318 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 41 it 161 total=11.7572 mle=1.7284 pcon=8.6140 forget=1.3830 orth=0.0318 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 41 it 211 total=11.7794 mle=1.7082 pcon=8.6143 forget=1.4250 orth=0.0319 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 41 it 261 total=11.9071 mle=1.8264 pcon=8.6146 forget=1.4341 orth=0.0319 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 41 it 311 total=11.8214 mle=1.7692 pcon=8.6149 forget=1.4053 orth=0.0320 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 41 it 361 total=11.7517 mle=1.7009 pcon=8.6152 forget=1.4035 orth=0.0320 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 41 it 411 total=11.7902 mle=1.7061 pcon=8.6155 forget=1.4366 orth=0.0321 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 42 it 32 total=11.8783 mle=1.8124 pcon=8.6158 forget=1.4180 orth=0.0321 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 42 it 82 total=11.8087 mle=1.7234 pcon=8.6161 forget=1.4371 orth=0.0322 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 42 it 132 total=11.7411 mle=1.6476 pcon=8.6163 forget=1.4449 orth=0.0322 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 42 it 182 total=11.9607 mle=1.8650 pcon=8.6166 forget=1.4469 orth=0.0323 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 42 it 232 total=11.7435 mle=1.6585 pcon=8.6168 forget=1.4359 orth=0.0323 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 42 it 282 total=11.8589 mle=1.7525 pcon=8.6171 forget=1.4569 orth=0.0323 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 42 it 332 total=12.0527 mle=1.9573 pcon=8.6174 forget=1.4457 orth=0.0324 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 42 it 382 total=11.8260 mle=1.7174 pcon=8.6176 forget=1.4586 orth=0.0324 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 43 it 3 total=11.9342 mle=1.8105 pcon=8.6178 forget=1.4735 orth=0.0325 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 43 it 53 total=11.8750 mle=1.7627 pcon=8.6181 forget=1.4616 orth=0.0325 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 43 it 103 total=11.9484 mle=1.8003 pcon=8.6183 forget=1.4972 orth=0.0325 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 43 it 153 total=11.9713 mle=1.8480 pcon=8.6186 forget=1.4721 orth=0.0326 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 43 it 203 total=11.8965 mle=1.7631 pcon=8.6188 forget=1.4820 orth=0.0326 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 43 it 253 total=11.9983 mle=1.8383 pcon=8.6191 forget=1.5082 orth=0.0327 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 43 it 303 total=12.0356 mle=1.8803 pcon=8.6193 forget=1.5033 orth=0.0327 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 43 it 353 total=11.8382 mle=1.6898 pcon=8.6195 forget=1.4962 orth=0.0327 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 43 it 403 total=11.8258 mle=1.6480 pcon=8.6197 forget=1.5253 orth=0.0328 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 44 it 24 total=11.8752 mle=1.7123 pcon=8.6199 forget=1.5102 orth=0.0328 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 44 it 74 total=11.9370 mle=1.7277 pcon=8.6201 forget=1.5563 orth=0.0328 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 44 it 124 total=11.9669 mle=1.7796 pcon=8.6203 forget=1.5341 orth=0.0329 favg=0.0000 nr=57 nf=57 protos=600 fproto_sim=NA
[loss] ep 44 it 174 total=11.9659 mle=1.7471 pcon=8.6205 forget=1.5654 orth=0.0329 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 44 it 224 total=11.9844 mle=1.7711 pcon=8.6207 forget=1.5597 orth=0.0329 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 44 it 274 total=11.9907 mle=1.7803 pcon=8.6209 forget=1.5565 orth=0.0330 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 44 it 324 total=12.0689 mle=1.8538 pcon=8.6211 forget=1.5610 orth=0.0330 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 44 it 374 total=11.9298 mle=1.6978 pcon=8.6213 forget=1.5778 orth=0.0330 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 44 it 424 total=11.9814 mle=1.7042 pcon=8.6215 forget=1.6227 orth=0.0331 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 45 it 45 total=11.9347 mle=1.6809 pcon=8.6216 forget=1.5990 orth=0.0331 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 45 it 95 total=11.9656 mle=1.7263 pcon=8.6218 forget=1.5844 orth=0.0331 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 45 it 145 total=11.8502 mle=1.5933 pcon=8.6220 forget=1.6018 orth=0.0331 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 45 it 195 total=12.0058 mle=1.7398 pcon=8.6221 forget=1.6106 orth=0.0332 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 45 it 245 total=12.0989 mle=1.8182 pcon=8.6223 forget=1.6252 orth=0.0332 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 45 it 295 total=12.0673 mle=1.7635 pcon=8.6224 forget=1.6482 orth=0.0332 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 45 it 345 total=12.0419 mle=1.7436 pcon=8.6226 forget=1.6426 orth=0.0332 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 45 it 395 total=12.1639 mle=1.8261 pcon=8.6227 forget=1.6819 orth=0.0333 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 46 it 16 total=11.8914 mle=1.5782 pcon=8.6228 forget=1.6570 orth=0.0333 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 46 it 66 total=12.1058 mle=1.7772 pcon=8.6230 forget=1.6723 orth=0.0333 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 46 it 116 total=11.9059 mle=1.5727 pcon=8.6231 forget=1.6768 orth=0.0333 favg=0.0000 nr=54 nf=54 protos=600 fproto_sim=NA
[loss] ep 46 it 166 total=11.9811 mle=1.6419 pcon=8.6232 forget=1.6825 orth=0.0333 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 46 it 216 total=12.0298 mle=1.6983 pcon=8.6233 forget=1.6748 orth=0.0334 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 46 it 266 total=12.0145 mle=1.6524 pcon=8.6235 forget=1.7053 orth=0.0334 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 46 it 316 total=11.9925 mle=1.6089 pcon=8.6236 forget=1.7266 orth=0.0334 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 46 it 366 total=12.0601 mle=1.6982 pcon=8.6237 forget=1.7048 orth=0.0334 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 46 it 416 total=11.9258 mle=1.5495 pcon=8.6238 forget=1.7191 orth=0.0334 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 47 it 37 total=12.1152 mle=1.7011 pcon=8.6239 forget=1.7568 orth=0.0334 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 47 it 87 total=12.1484 mle=1.7599 pcon=8.6240 forget=1.7311 orth=0.0334 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 47 it 137 total=12.0875 mle=1.6729 pcon=8.6241 forget=1.7570 orth=0.0335 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
[loss] ep 47 it 187 total=12.1332 mle=1.6869 pcon=8.6243 forget=1.7886 orth=0.0335 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 47 it 237 total=12.1932 mle=1.7473 pcon=8.6244 forget=1.7881 orth=0.0335 favg=0.0000 nr=58 nf=58 protos=600 fproto_sim=NA
 96%|█████████▌| 48/50 [27:11<00:40, 20.46s/it] 98%|█████████▊| 49/50 [27:31<00:20, 20.24s/it]100%|██████████| 50/50 [27:51<00:00, 20.07s/it]100%|██████████| 50/50 [27:51<00:00, 33.42s/it]
[loss] ep 47 it 287 total=12.3630 mle=1.9369 pcon=8.6244 forget=1.7682 orth=0.0335 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 47 it 337 total=12.3032 mle=1.8609 pcon=8.6245 forget=1.7843 orth=0.0335 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 47 it 387 total=12.1398 mle=1.6793 pcon=8.6246 forget=1.8024 orth=0.0335 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 48 it 8 total=12.3606 mle=1.8988 pcon=8.6247 forget=1.8036 orth=0.0335 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 48 it 58 total=12.1569 mle=1.6717 pcon=8.6247 forget=1.8269 orth=0.0335 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 48 it 108 total=12.2675 mle=1.7563 pcon=8.6248 forget=1.8530 orth=0.0335 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 48 it 158 total=12.2989 mle=1.8115 pcon=8.6249 forget=1.8289 orth=0.0335 favg=0.0000 nr=64 nf=64 protos=600 fproto_sim=NA
[loss] ep 48 it 208 total=12.2513 mle=1.7279 pcon=8.6249 forget=1.8650 orth=0.0335 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 48 it 258 total=12.3258 mle=1.8089 pcon=8.6250 forget=1.8584 orth=0.0335 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 48 it 308 total=12.4244 mle=1.8902 pcon=8.6251 forget=1.8756 orth=0.0335 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 48 it 358 total=12.3962 mle=1.8469 pcon=8.6251 forget=1.8905 orth=0.0336 favg=0.0000 nr=63 nf=63 protos=600 fproto_sim=NA
[loss] ep 48 it 408 total=12.3597 mle=1.8226 pcon=8.6252 forget=1.8784 orth=0.0336 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 49 it 29 total=12.1826 mle=1.6442 pcon=8.6253 forget=1.8796 orth=0.0336 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 49 it 79 total=12.3584 mle=1.8023 pcon=8.6253 forget=1.8972 orth=0.0336 favg=0.0000 nr=57 nf=57 protos=600 fproto_sim=NA
[loss] ep 49 it 129 total=12.3994 mle=1.8640 pcon=8.6254 forget=1.8765 orth=0.0336 favg=0.0000 nr=60 nf=60 protos=600 fproto_sim=NA
[loss] ep 49 it 179 total=12.3491 mle=1.7807 pcon=8.6254 forget=1.9094 orth=0.0336 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 49 it 229 total=12.3612 mle=1.7759 pcon=8.6255 forget=1.9262 orth=0.0336 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
[loss] ep 49 it 279 total=12.3679 mle=1.7708 pcon=8.6255 forget=1.9380 orth=0.0336 favg=0.0000 nr=62 nf=62 protos=600 fproto_sim=NA
[loss] ep 49 it 329 total=12.4369 mle=1.8334 pcon=8.6256 forget=1.9443 orth=0.0336 favg=0.0000 nr=59 nf=59 protos=600 fproto_sim=NA
[loss] ep 49 it 379 total=12.5179 mle=1.8937 pcon=8.6256 forget=1.9650 orth=0.0336 favg=0.0000 nr=61 nf=61 protos=600 fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-inc1: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:37,  1.97it/s]  3%|▎         | 11/430 [00:00<00:17, 23.31it/s]  5%|▍         | 21/430 [00:00<00:09, 41.18it/s]  7%|▋         | 31/430 [00:00<00:07, 55.39it/s] 10%|▉         | 41/430 [00:00<00:05, 66.47it/s] 12%|█▏        | 51/430 [00:01<00:05, 74.72it/s] 14%|█▍        | 61/430 [00:01<00:04, 80.50it/s] 17%|█▋        | 71/430 [00:01<00:04, 85.17it/s] 19%|█▉        | 81/430 [00:01<00:03, 88.39it/s] 21%|██        | 91/430 [00:01<00:03, 90.75it/s] 23%|██▎       | 101/430 [00:01<00:03, 91.55it/s] 26%|██▌       | 111/430 [00:01<00:03, 93.03it/s] 28%|██▊       | 121/430 [00:01<00:03, 93.99it/s] 30%|███       | 131/430 [00:01<00:03, 93.87it/s] 33%|███▎      | 141/430 [00:01<00:03, 94.55it/s] 35%|███▌      | 151/430 [00:02<00:02, 95.21it/s] 37%|███▋      | 161/430 [00:02<00:02, 95.35it/s] 40%|███▉      | 171/430 [00:02<00:02, 95.55it/s] 42%|████▏     | 181/430 [00:02<00:02, 95.29it/s] 44%|████▍     | 191/430 [00:02<00:02, 95.63it/s] 47%|████▋     | 201/430 [00:02<00:02, 95.80it/s] 49%|████▉     | 211/430 [00:02<00:02, 96.05it/s] 51%|█████▏    | 221/430 [00:02<00:02, 96.14it/s] 54%|█████▎    | 231/430 [00:02<00:02, 96.17it/s] 56%|█████▌    | 241/430 [00:03<00:01, 95.66it/s] 58%|█████▊    | 251/430 [00:03<00:01, 95.74it/s] 61%|██████    | 261/430 [00:03<00:01, 96.00it/s] 63%|██████▎   | 271/430 [00:03<00:01, 95.99it/s] 65%|██████▌   | 281/430 [00:03<00:01, 95.68it/s] 68%|██████▊   | 291/430 [00:03<00:01, 95.99it/s] 70%|███████   | 301/430 [00:03<00:01, 96.04it/s] 72%|███████▏  | 311/430 [00:03<00:01, 96.18it/s] 75%|███████▍  | 321/430 [00:03<00:01, 96.20it/s] 77%|███████▋  | 331/430 [00:03<00:01, 95.98it/s] 79%|███████▉  | 341/430 [00:04<00:00, 95.97it/s] 82%|████████▏ | 351/430 [00:04<00:00, 96.18it/s] 84%|████████▍ | 361/430 [00:04<00:00, 96.28it/s] 86%|████████▋ | 371/430 [00:04<00:00, 96.40it/s] 89%|████████▊ | 381/430 [00:04<00:00, 96.42it/s] 91%|█████████ | 391/430 [00:04<00:00, 93.45it/s] 93%|█████████▎| 401/430 [00:04<00:00, 93.24it/s] 96%|█████████▌| 411/430 [00:04<00:00, 94.12it/s] 98%|█████████▊| 421/430 [00:04<00:00, 95.01it/s]100%|██████████| 430/430 [00:04<00:00, 86.02it/s]
55000 images processed, 5.108423471450806 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:42,  2.02it/s]  9%|▉         | 8/86 [00:00<00:04, 17.15it/s] 20%|█▉        | 17/86 [00:00<00:02, 34.25it/s] 31%|███▏      | 27/86 [00:00<00:01, 50.01it/s] 42%|████▏     | 36/86 [00:00<00:00, 60.23it/s] 53%|█████▎    | 46/86 [00:01<00:00, 69.39it/s] 65%|██████▌   | 56/86 [00:01<00:00, 75.79it/s] 77%|███████▋  | 66/86 [00:01<00:00, 81.09it/s] 88%|████████▊ | 76/86 [00:01<00:00, 84.87it/s]100%|██████████| 86/86 [00:01<00:00, 86.74it/s]100%|██████████| 86/86 [00:01<00:00, 59.16it/s]
11000 images processed, 1.4803366661071777 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-inc1/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:37,  2.08it/s]  5%|▌         | 11/204 [00:00<00:07, 24.16it/s] 10%|█         | 21/204 [00:00<00:04, 42.11it/s] 15%|█▌        | 31/204 [00:00<00:03, 56.13it/s] 20%|██        | 41/204 [00:00<00:02, 66.73it/s] 25%|██▌       | 51/204 [00:01<00:02, 74.95it/s] 30%|██▉       | 61/204 [00:01<00:01, 81.03it/s] 35%|███▍      | 71/204 [00:01<00:01, 85.18it/s] 40%|███▉      | 81/204 [00:01<00:01, 88.25it/s] 45%|████▍     | 91/204 [00:01<00:01, 90.58it/s] 50%|████▉     | 101/204 [00:01<00:01, 92.01it/s] 54%|█████▍    | 111/204 [00:01<00:00, 93.18it/s] 59%|█████▉    | 121/204 [00:01<00:00, 93.92it/s] 64%|██████▍   | 131/204 [00:01<00:00, 94.31it/s] 69%|██████▉   | 141/204 [00:01<00:00, 94.47it/s] 74%|███████▍  | 151/204 [00:02<00:00, 94.67it/s] 79%|███████▉  | 161/204 [00:02<00:00, 94.43it/s] 84%|████████▍ | 171/204 [00:02<00:00, 94.87it/s] 89%|████████▊ | 181/204 [00:02<00:00, 95.24it/s] 94%|█████████▎| 191/204 [00:02<00:00, 95.76it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.89it/s]100%|██████████| 204/204 [00:02<00:00, 78.15it/s]
26032 images processed, 2.6483097076416016 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:08,  1.14it/s] 14%|█▍        | 11/79 [00:00<00:04, 14.81it/s] 25%|██▌       | 20/79 [00:01<00:02, 27.16it/s] 38%|███▊      | 30/79 [00:01<00:01, 40.23it/s] 49%|████▉     | 39/79 [00:01<00:00, 49.63it/s] 61%|██████    | 48/79 [00:01<00:00, 58.67it/s] 73%|███████▎  | 58/79 [00:01<00:00, 67.86it/s] 86%|████████▌ | 68/79 [00:01<00:00, 75.23it/s] 99%|█████████▊| 78/79 [00:01<00:00, 81.12it/s]100%|██████████| 79/79 [00:01<00:00, 45.40it/s]
10000 images processed, 1.7752876281738281 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.56it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.23it/s] 27%|██▋       | 21/79 [00:00<00:01, 35.34it/s] 39%|███▉      | 31/79 [00:00<00:00, 48.94it/s] 52%|█████▏    | 41/79 [00:01<00:00, 60.34it/s] 65%|██████▍   | 51/79 [00:01<00:00, 69.46it/s] 77%|███████▋  | 61/79 [00:01<00:00, 76.81it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.37it/s]100%|██████████| 79/79 [00:01<00:00, 54.30it/s]
10000 images processed, 1.47318696975708 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.86it/s] 16%|█▌        | 11/70 [00:00<00:02, 22.14it/s] 29%|██▊       | 20/70 [00:00<00:01, 37.47it/s] 43%|████▎     | 30/70 [00:00<00:00, 51.80it/s] 57%|█████▋    | 40/70 [00:00<00:00, 63.10it/s] 71%|███████▏  | 50/70 [00:01<00:00, 72.25it/s] 86%|████████▌ | 60/70 [00:01<00:00, 79.12it/s]100%|██████████| 70/70 [00:01<00:00, 83.10it/s]100%|██████████| 70/70 [00:01<00:00, 54.91it/s]
8925 images processed, 1.3062167167663574 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:49,  1.13s/it]  4%|▍         | 2/45 [00:01<00:23,  1.85it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.82it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.28it/s] 47%|████▋     | 21/45 [00:01<00:01, 17.78it/s] 67%|██████▋   | 30/45 [00:01<00:00, 29.37it/s] 78%|███████▊  | 35/45 [00:02<00:00, 17.74it/s]100%|██████████| 45/45 [00:02<00:00, 27.81it/s]100%|██████████| 45/45 [00:02<00:00, 17.30it/s]
5640 images processed, 2.6222519874572754 seconds used

18.133599042892456
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           9.70  97.84
places365     79.31  77.86
LSUN          47.39  90.01
iSUN          71.74  83.55
dtd           67.73  82.87
AVG           55.17  86.43
Retain-Acc: 0.6786
Forget-as-OOD (retain known vs forget novel):
  FPR: 90.20 AUROC: 69.54 AUIN: 97.89
15.972474336624146
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-inc1_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-inc1_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-inc2: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:13,  2.22it/s]  3%|▎         | 11/430 [00:00<00:16, 25.24it/s]  5%|▍         | 21/430 [00:00<00:09, 43.70it/s]  7%|▋         | 31/430 [00:00<00:06, 58.04it/s] 10%|▉         | 41/430 [00:00<00:05, 68.72it/s] 12%|█▏        | 51/430 [00:00<00:04, 76.65it/s] 14%|█▍        | 61/430 [00:01<00:04, 82.22it/s] 17%|█▋        | 71/430 [00:01<00:04, 86.23it/s] 19%|█▉        | 81/430 [00:01<00:03, 89.25it/s] 21%|██        | 91/430 [00:01<00:03, 91.26it/s] 23%|██▎       | 101/430 [00:01<00:03, 92.38it/s] 26%|██▌       | 111/430 [00:01<00:03, 93.77it/s] 28%|██▊       | 121/430 [00:01<00:03, 94.73it/s] 30%|███       | 131/430 [00:01<00:03, 94.75it/s] 33%|███▎      | 141/430 [00:01<00:03, 95.23it/s] 35%|███▌      | 151/430 [00:02<00:02, 94.78it/s] 37%|███▋      | 161/430 [00:02<00:02, 94.63it/s] 40%|███▉      | 171/430 [00:02<00:02, 89.89it/s] 42%|████▏     | 181/430 [00:02<00:02, 91.51it/s] 44%|████▍     | 191/430 [00:02<00:02, 92.52it/s] 47%|████▋     | 201/430 [00:02<00:02, 92.44it/s] 49%|████▉     | 211/430 [00:02<00:02, 93.56it/s] 51%|█████▏    | 221/430 [00:02<00:02, 92.91it/s] 54%|█████▎    | 231/430 [00:02<00:02, 92.33it/s] 56%|█████▌    | 241/430 [00:02<00:02, 92.15it/s] 58%|█████▊    | 251/430 [00:03<00:02, 89.18it/s] 61%|██████    | 261/430 [00:03<00:01, 90.46it/s] 63%|██████▎   | 271/430 [00:03<00:01, 91.69it/s] 65%|██████▌   | 281/430 [00:03<00:01, 92.39it/s] 68%|██████▊   | 291/430 [00:03<00:01, 91.23it/s] 70%|███████   | 301/430 [00:03<00:01, 90.75it/s] 72%|███████▏  | 311/430 [00:03<00:01, 90.23it/s] 75%|███████▍  | 321/430 [00:03<00:01, 91.37it/s] 77%|███████▋  | 331/430 [00:03<00:01, 89.71it/s] 79%|███████▉  | 340/430 [00:04<00:01, 87.67it/s] 81%|████████▏ | 350/430 [00:04<00:00, 89.70it/s] 84%|████████▎ | 360/430 [00:04<00:00, 90.23it/s] 86%|████████▌ | 370/430 [00:04<00:00, 91.69it/s] 88%|████████▊ | 380/430 [00:04<00:00, 92.30it/s] 91%|█████████ | 390/430 [00:04<00:00, 91.77it/s] 93%|█████████▎| 400/430 [00:04<00:00, 92.63it/s] 95%|█████████▌| 410/430 [00:04<00:00, 93.92it/s] 98%|█████████▊| 420/430 [00:04<00:00, 95.00it/s]100%|██████████| 430/430 [00:05<00:00, 93.33it/s]100%|██████████| 430/430 [00:05<00:00, 84.90it/s]
55000 images processed, 5.196807861328125 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:42,  1.99it/s] 10%|█         | 9/86 [00:00<00:04, 19.06it/s] 22%|██▏       | 19/86 [00:00<00:01, 37.70it/s] 34%|███▎      | 29/86 [00:00<00:01, 52.29it/s] 45%|████▌     | 39/86 [00:00<00:00, 63.52it/s] 57%|█████▋    | 49/86 [00:01<00:00, 71.45it/s] 69%|██████▊   | 59/86 [00:01<00:00, 77.60it/s] 80%|████████  | 69/86 [00:01<00:00, 82.47it/s] 92%|█████████▏| 79/86 [00:01<00:00, 85.90it/s]100%|██████████| 86/86 [00:01<00:00, 59.84it/s]
11000 images processed, 1.4683828353881836 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-inc2/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:44,  1.93it/s]  5%|▍         | 10/204 [00:00<00:09, 20.98it/s]  9%|▉         | 19/204 [00:00<00:04, 37.25it/s] 14%|█▍        | 29/204 [00:00<00:03, 52.31it/s] 19%|█▉        | 39/204 [00:00<00:02, 63.90it/s] 24%|██▍       | 49/204 [00:01<00:02, 72.68it/s] 29%|██▉       | 59/204 [00:01<00:01, 78.40it/s] 34%|███▍      | 69/204 [00:01<00:01, 83.15it/s] 39%|███▊      | 79/204 [00:01<00:01, 86.67it/s] 44%|████▎     | 89/204 [00:01<00:01, 88.93it/s] 49%|████▊     | 99/204 [00:01<00:01, 90.01it/s] 53%|█████▎    | 109/204 [00:01<00:01, 91.19it/s] 58%|█████▊    | 119/204 [00:01<00:00, 92.37it/s] 63%|██████▎   | 129/204 [00:01<00:00, 93.14it/s] 68%|██████▊   | 139/204 [00:01<00:00, 93.67it/s] 73%|███████▎  | 149/204 [00:02<00:00, 93.09it/s] 78%|███████▊  | 159/204 [00:02<00:00, 93.65it/s] 83%|████████▎ | 169/204 [00:02<00:00, 93.89it/s] 88%|████████▊ | 179/204 [00:02<00:00, 94.38it/s] 93%|█████████▎| 189/204 [00:02<00:00, 95.05it/s] 98%|█████████▊| 199/204 [00:02<00:00, 95.60it/s]100%|██████████| 204/204 [00:02<00:00, 76.27it/s]
26032 images processed, 2.718163251876831 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.68it/s] 13%|█▎        | 10/79 [00:00<00:03, 18.54it/s] 24%|██▍       | 19/79 [00:00<00:01, 33.76it/s] 37%|███▋      | 29/79 [00:00<00:01, 48.58it/s] 49%|████▉     | 39/79 [00:01<00:00, 59.99it/s] 62%|██████▏   | 49/79 [00:01<00:00, 68.71it/s] 75%|███████▍  | 59/79 [00:01<00:00, 76.10it/s] 87%|████████▋ | 69/79 [00:01<00:00, 81.91it/s]100%|██████████| 79/79 [00:01<00:00, 84.94it/s]100%|██████████| 79/79 [00:01<00:00, 54.74it/s]
10000 images processed, 1.4791576862335205 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.80it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.54it/s] 27%|██▋       | 21/79 [00:00<00:01, 38.32it/s] 39%|███▉      | 31/79 [00:00<00:00, 52.19it/s] 52%|█████▏    | 41/79 [00:00<00:00, 63.37it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.40it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.37it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.57it/s]100%|██████████| 79/79 [00:01<00:00, 57.45it/s]
10000 images processed, 1.4000461101531982 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:37,  1.84it/s] 16%|█▌        | 11/70 [00:00<00:02, 22.00it/s] 30%|███       | 21/70 [00:00<00:01, 38.93it/s] 43%|████▎     | 30/70 [00:00<00:00, 50.82it/s] 57%|█████▋    | 40/70 [00:00<00:00, 62.35it/s] 71%|███████▏  | 50/70 [00:01<00:00, 71.68it/s] 86%|████████▌ | 60/70 [00:01<00:00, 78.67it/s]100%|██████████| 70/70 [00:01<00:00, 82.93it/s]100%|██████████| 70/70 [00:01<00:00, 54.62it/s]
8925 images processed, 1.3124382495880127 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.04it/s]  4%|▍         | 2/45 [00:01<00:20,  2.07it/s] 27%|██▋       | 12/45 [00:01<00:02, 16.44it/s] 38%|███▊      | 17/45 [00:01<00:01, 17.38it/s] 47%|████▋     | 21/45 [00:01<00:01, 17.92it/s] 69%|██████▉   | 31/45 [00:01<00:00, 31.14it/s] 82%|████████▏ | 37/45 [00:02<00:00, 24.08it/s]100%|██████████| 45/45 [00:02<00:00, 19.97it/s]
5640 images processed, 2.278811454772949 seconds used

17.41100001335144
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           8.80  97.91
places365     76.89  78.86
LSUN          42.90  90.34
iSUN          68.48  84.42
dtd           65.71  82.83
AVG           52.56  86.87
Retain-Acc: 0.6656
Forget-as-OOD (retain known vs forget novel):
  FPR: 88.20 AUROC: 71.71 AUIN: 98.06
9.081056833267212
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-inc2_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-inc2_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-seen: Number of model parameters: 21843904
Processing in-distribution CIFAR-110 images
  0%|          | 0/430 [00:00<?, ?it/s]  0%|          | 1/430 [00:00<03:17,  2.17it/s]  3%|▎         | 11/430 [00:00<00:16, 24.96it/s]  5%|▍         | 21/430 [00:00<00:09, 43.34it/s]  7%|▋         | 30/430 [00:00<00:07, 54.55it/s]  9%|▉         | 40/430 [00:00<00:05, 66.19it/s] 12%|█▏        | 50/430 [00:00<00:05, 73.21it/s] 14%|█▍        | 60/430 [00:01<00:04, 79.77it/s] 16%|█▋        | 70/430 [00:01<00:04, 84.23it/s] 19%|█▊        | 80/430 [00:01<00:04, 84.37it/s] 21%|██        | 90/430 [00:01<00:03, 87.72it/s] 23%|██▎       | 100/430 [00:01<00:03, 88.50it/s] 26%|██▌       | 110/430 [00:01<00:03, 90.73it/s] 28%|██▊       | 120/430 [00:01<00:03, 89.82it/s] 30%|███       | 130/430 [00:01<00:03, 91.59it/s] 33%|███▎      | 140/430 [00:01<00:03, 90.93it/s] 35%|███▍      | 150/430 [00:02<00:03, 92.72it/s] 37%|███▋      | 160/430 [00:02<00:02, 93.74it/s] 40%|███▉      | 170/430 [00:02<00:02, 94.47it/s] 42%|████▏     | 180/430 [00:02<00:02, 94.96it/s] 44%|████▍     | 190/430 [00:02<00:02, 95.27it/s] 47%|████▋     | 200/430 [00:02<00:02, 95.47it/s] 49%|████▉     | 210/430 [00:02<00:02, 95.24it/s] 51%|█████     | 220/430 [00:02<00:02, 95.61it/s] 53%|█████▎    | 230/430 [00:02<00:02, 95.09it/s] 56%|█████▌    | 240/430 [00:03<00:01, 95.41it/s] 58%|█████▊    | 250/430 [00:03<00:01, 93.48it/s] 60%|██████    | 260/430 [00:03<00:01, 94.17it/s] 63%|██████▎   | 270/430 [00:03<00:01, 94.85it/s] 65%|██████▌   | 280/430 [00:03<00:01, 92.51it/s] 67%|██████▋   | 290/430 [00:03<00:01, 92.72it/s] 70%|██████▉   | 300/430 [00:03<00:01, 92.98it/s] 72%|███████▏  | 310/430 [00:03<00:01, 93.27it/s] 74%|███████▍  | 320/430 [00:03<00:01, 93.71it/s] 77%|███████▋  | 330/430 [00:03<00:01, 91.86it/s] 79%|███████▉  | 340/430 [00:04<00:00, 92.79it/s] 81%|████████▏ | 350/430 [00:04<00:00, 92.63it/s] 84%|████████▎ | 360/430 [00:04<00:00, 92.20it/s] 86%|████████▌ | 370/430 [00:04<00:00, 92.17it/s] 88%|████████▊ | 380/430 [00:04<00:00, 92.25it/s] 91%|█████████ | 390/430 [00:04<00:00, 93.30it/s] 93%|█████████▎| 400/430 [00:04<00:00, 92.45it/s] 95%|█████████▌| 410/430 [00:04<00:00, 93.61it/s] 98%|█████████▊| 420/430 [00:04<00:00, 94.81it/s]100%|██████████| 430/430 [00:05<00:00, 93.22it/s]100%|██████████| 430/430 [00:05<00:00, 85.03it/s]
55000 images processed, 5.155071496963501 seconds used

Processing in-distribution CIFAR-110 images
  0%|          | 0/86 [00:00<?, ?it/s]  1%|          | 1/86 [00:00<00:41,  2.07it/s]  9%|▉         | 8/86 [00:00<00:04, 17.37it/s] 21%|██        | 18/86 [00:00<00:01, 36.56it/s] 31%|███▏      | 27/86 [00:00<00:01, 49.91it/s] 43%|████▎     | 37/86 [00:00<00:00, 61.90it/s] 53%|█████▎    | 46/86 [00:01<00:00, 69.20it/s] 65%|██████▌   | 56/86 [00:01<00:00, 76.15it/s] 77%|███████▋  | 66/86 [00:01<00:00, 81.44it/s] 88%|████████▊ | 76/86 [00:01<00:00, 85.29it/s]100%|██████████| 86/86 [00:01<00:00, 87.05it/s]100%|██████████| 86/86 [00:01<00:00, 59.75it/s]
11000 images processed, 1.4662537574768066 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-seen/CIFAR-110/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:51,  1.83it/s]  5%|▍         | 10/204 [00:00<00:09, 19.82it/s]  9%|▉         | 19/204 [00:00<00:05, 35.66it/s] 14%|█▍        | 29/204 [00:00<00:03, 50.74it/s] 19%|█▉        | 39/204 [00:00<00:02, 62.59it/s] 24%|██▍       | 49/204 [00:01<00:02, 71.62it/s] 29%|██▉       | 59/204 [00:01<00:01, 78.28it/s] 34%|███▍      | 69/204 [00:01<00:01, 83.09it/s] 39%|███▊      | 79/204 [00:01<00:01, 86.36it/s] 44%|████▎     | 89/204 [00:01<00:01, 88.48it/s] 49%|████▊     | 99/204 [00:01<00:01, 90.26it/s] 53%|█████▎    | 109/204 [00:01<00:01, 91.48it/s] 58%|█████▊    | 119/204 [00:01<00:00, 91.75it/s] 63%|██████▎   | 129/204 [00:01<00:00, 92.36it/s] 68%|██████▊   | 139/204 [00:02<00:00, 92.74it/s] 73%|███████▎  | 149/204 [00:02<00:00, 93.49it/s] 78%|███████▊  | 159/204 [00:02<00:00, 94.04it/s] 83%|████████▎ | 169/204 [00:02<00:00, 94.38it/s] 88%|████████▊ | 179/204 [00:02<00:00, 94.74it/s] 93%|█████████▎| 189/204 [00:02<00:00, 95.47it/s] 98%|█████████▊| 199/204 [00:02<00:00, 95.93it/s]100%|██████████| 204/204 [00:02<00:00, 75.37it/s]
26032 images processed, 2.747803211212158 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.60it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.77it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.13it/s] 39%|███▉      | 31/79 [00:00<00:00, 49.89it/s] 52%|█████▏    | 41/79 [00:01<00:00, 60.92it/s] 65%|██████▍   | 51/79 [00:01<00:00, 69.52it/s] 77%|███████▋  | 61/79 [00:01<00:00, 76.19it/s] 90%|████████▉ | 71/79 [00:01<00:00, 81.97it/s]100%|██████████| 79/79 [00:01<00:00, 54.30it/s]
10000 images processed, 1.4918029308319092 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.14it/s]  8%|▊         | 6/79 [00:00<00:05, 13.32it/s] 20%|██        | 16/79 [00:00<00:01, 34.60it/s] 33%|███▎      | 26/79 [00:00<00:01, 50.23it/s] 46%|████▌     | 36/79 [00:00<00:00, 62.56it/s] 58%|█████▊    | 46/79 [00:00<00:00, 71.66it/s] 71%|███████   | 56/79 [00:01<00:00, 78.65it/s] 84%|████████▎ | 66/79 [00:01<00:00, 83.71it/s] 96%|█████████▌| 76/79 [00:01<00:00, 87.35it/s]100%|██████████| 79/79 [00:01<00:00, 59.35it/s]
10000 images processed, 1.3550691604614258 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.74it/s] 11%|█▏        | 8/70 [00:00<00:04, 15.30it/s] 24%|██▍       | 17/70 [00:00<00:01, 31.75it/s] 39%|███▊      | 27/70 [00:00<00:00, 47.25it/s] 51%|█████▏    | 36/70 [00:00<00:00, 57.11it/s] 66%|██████▌   | 46/70 [00:01<00:00, 67.54it/s] 80%|████████  | 56/70 [00:01<00:00, 75.65it/s] 94%|█████████▍| 66/70 [00:01<00:00, 81.58it/s]100%|██████████| 70/70 [00:01<00:00, 51.97it/s]
8925 images processed, 1.379854679107666 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:47,  1.07s/it] 16%|█▌        | 7/45 [00:01<00:04,  7.88it/s] 31%|███       | 14/45 [00:01<00:01, 16.41it/s] 42%|████▏     | 19/45 [00:01<00:01, 15.81it/s] 51%|█████     | 23/45 [00:01<00:01, 18.45it/s] 73%|███████▎  | 33/45 [00:02<00:00, 20.14it/s] 96%|█████████▌| 43/45 [00:02<00:00, 30.37it/s]100%|██████████| 45/45 [00:02<00:00, 19.23it/s]
5640 images processed, 2.3600962162017822 seconds used

17.48023009300232
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN          13.75  97.21
places365     77.94  78.97
LSUN          62.45  87.56
iSUN          70.82  84.14
dtd           77.00  80.33
AVG           60.39  85.64
Retain-Acc: 0.7153
Forget-as-OOD (retain known vs forget novel):
  FPR: 83.90 AUROC: 76.47 AUIN: 96.68
8.07902193069458
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-seen_domain.png
[umap] saved to figs/umap_CIFAR-110_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stage2-seen_rf.png
[done] continual incremental run finished. Adapters at: checkpoints/CIFAR-110-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-stack
