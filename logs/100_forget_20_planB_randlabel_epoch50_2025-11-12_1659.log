nohup: ignoring input
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget20.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=0.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=False, lora_impl='native', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='head', adapter_save_path=None, adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10,64,22,42,9,90', forget_list_path=None, forget_classes_inc=None, forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=1.0, forget_margin=100.0, forget_strategy='randlabel', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
[debug] trainable_count = 112
[debug] trainable: encoder.conv1.weight
[debug] trainable: encoder.bn1.weight
[debug] trainable: encoder.bn1.bias
[debug] trainable: encoder.layer1.0.conv1.weight
[debug] trainable: encoder.layer1.0.bn1.weight
[debug] trainable: encoder.layer1.0.bn1.bias
[debug] trainable: encoder.layer1.0.conv2.weight
[debug] trainable: encoder.layer1.0.bn2.weight
[debug] trainable: encoder.layer1.0.bn2.bias
[debug] trainable: encoder.layer1.1.conv1.weight
[debug] trainable: encoder.layer1.1.bn1.weight
[debug] trainable: encoder.layer1.1.bn1.bias
[debug] trainable: encoder.layer1.1.conv2.weight
[debug] trainable: encoder.layer1.1.bn2.weight
[debug] trainable: encoder.layer1.1.bn2.bias
[debug] trainable: encoder.layer1.2.conv1.weight
[debug] trainable: encoder.layer1.2.bn1.weight
[debug] trainable: encoder.layer1.2.bn1.bias
[debug] trainable: encoder.layer1.2.conv2.weight
[debug] trainable: encoder.layer1.2.bn2.weight
[debug] trainable: encoder.layer1.2.bn2.bias
[debug] trainable: encoder.layer2.0.conv1.weight
[debug] trainable: encoder.layer2.0.bn1.weight
[debug] trainable: encoder.layer2.0.bn1.bias
[debug] trainable: encoder.layer2.0.conv2.weight
[debug] trainable: encoder.layer2.0.bn2.weight
[debug] trainable: encoder.layer2.0.bn2.bias
[debug] trainable: encoder.layer2.0.shortcut.0.weight
[debug] trainable: encoder.layer2.0.shortcut.1.weight
[debug] trainable: encoder.layer2.0.shortcut.1.bias
[debug] trainable: encoder.layer2.1.conv1.weight
[debug] trainable: encoder.layer2.1.bn1.weight
[debug] trainable: encoder.layer2.1.bn1.bias
[debug] trainable: encoder.layer2.1.conv2.weight
[debug] trainable: encoder.layer2.1.bn2.weight
[debug] trainable: encoder.layer2.1.bn2.bias
[debug] trainable: encoder.layer2.2.conv1.weight
[debug] trainable: encoder.layer2.2.bn1.weight
[debug] trainable: encoder.layer2.2.bn1.bias
[debug] trainable: encoder.layer2.2.conv2.weight
[debug] trainable: encoder.layer2.2.bn2.weight
[debug] trainable: encoder.layer2.2.bn2.bias
[debug] trainable: encoder.layer2.3.conv1.weight
[debug] trainable: encoder.layer2.3.bn1.weight
[debug] trainable: encoder.layer2.3.bn1.bias
[debug] trainable: encoder.layer2.3.conv2.weight
[debug] trainable: encoder.layer2.3.bn2.weight
[debug] trainable: encoder.layer2.3.bn2.bias
[debug] trainable: encoder.layer3.0.conv1.weight
[debug] trainable: encoder.layer3.0.bn1.weight
[debug][warn] non-LoRA trainables detected: ['encoder.conv1.weight', 'encoder.bn1.weight', 'encoder.bn1.bias', 'encoder.layer1.0.conv1.weight', 'encoder.layer1.0.bn1.weight', 'encoder.layer1.0.bn1.bias', 'encoder.layer1.0.conv2.weight', 'encoder.layer1.0.bn2.weight', 'encoder.layer1.0.bn2.bias', 'encoder.layer1.1.conv1.weight']
[trainable] param_count=21605312 tensors=112
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:550: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=bool(scaler is not None)):
/home/shaokun/PALM/trainer.py:638: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/torch/csrc/autograd/generated/python_variable_methods.cpp:835.)
  print(f"[loss-{args.forget_strategy}] ep {epoch} it {it} total={loss.item():.4f} ce_r={float(loss_retain):.4f} ce_f={float(loss_forget):.4f}")
  2%|▏         | 1/50 [00:47<38:27, 47.10s/it]  4%|▍         | 2/50 [01:13<27:57, 34.94s/it]  6%|▌         | 3/50 [01:40<24:31, 31.31s/it]  8%|▊         | 4/50 [02:06<22:30, 29.36s/it] 10%|█         | 5/50 [02:29<20:10, 26.89s/it] 12%|█▏        | 6/50 [02:54<19:18, 26.32s/it] 14%|█▍        | 7/50 [03:20<18:51, 26.32s/it] 16%|█▌        | 8/50 [03:48<18:36, 26.59s/it] 18%|█▊        | 9/50 [04:14<18:07, 26.52s/it] 20%|██        | 10/50 [04:40<17:35, 26.40s/it] 22%|██▏       | 11/50 [05:06<17:01, 26.20s/it] 24%|██▍       | 12/50 [05:32<16:36, 26.22s/it] 26%|██▌       | 13/50 [05:58<16:08, 26.16s/it] 28%|██▊       | 14/50 [06:21<15:00, 25.03s/it] 30%|███       | 15/50 [06:47<14:46, 25.32s/it][loss-randlabel] ep 0 it 0 total=10.0437 ce_r=0.0326 ce_f=10.0110
[loss-randlabel] ep 0 it 50 total=10.2822 ce_r=0.0164 ce_f=10.2658
[loss-randlabel] ep 0 it 100 total=9.7593 ce_r=0.0405 ce_f=9.7187
[loss-randlabel] ep 0 it 150 total=9.1981 ce_r=0.0849 ce_f=9.1132
[loss-randlabel] ep 0 it 200 total=7.2818 ce_r=0.6675 ce_f=6.6142
[loss-randlabel] ep 0 it 250 total=6.6558 ce_r=0.9721 ce_f=5.6838
[loss-randlabel] ep 0 it 300 total=6.8690 ce_r=0.9820 ce_f=5.8870
[loss-randlabel] ep 0 it 350 total=6.2600 ce_r=0.8206 ce_f=5.4394
[loss-randlabel] ep 1 it 10 total=6.2118 ce_r=0.8165 ce_f=5.3953
[loss-randlabel] ep 1 it 60 total=6.2538 ce_r=0.7239 ce_f=5.5298
[loss-randlabel] ep 1 it 110 total=6.0013 ce_r=0.8885 ce_f=5.1129
[loss-randlabel] ep 1 it 160 total=6.2785 ce_r=1.0119 ce_f=5.2666
[loss-randlabel] ep 1 it 210 total=6.2427 ce_r=0.7865 ce_f=5.4562
[loss-randlabel] ep 1 it 260 total=6.1770 ce_r=0.7040 ce_f=5.4730
[loss-randlabel] ep 1 it 310 total=6.1493 ce_r=0.8581 ce_f=5.2912
[loss-randlabel] ep 1 it 360 total=6.2070 ce_r=0.8204 ce_f=5.3866
[loss-randlabel] ep 2 it 20 total=6.1365 ce_r=0.9438 ce_f=5.1927
[loss-randlabel] ep 2 it 70 total=5.9631 ce_r=0.6476 ce_f=5.3155
[loss-randlabel] ep 2 it 120 total=5.9040 ce_r=0.5755 ce_f=5.3285
[loss-randlabel] ep 2 it 170 total=6.0239 ce_r=0.8727 ce_f=5.1512
[loss-randlabel] ep 2 it 220 total=5.9565 ce_r=0.7176 ce_f=5.2388
[loss-randlabel] ep 2 it 270 total=6.1160 ce_r=0.9318 ce_f=5.1842
[loss-randlabel] ep 2 it 320 total=5.8007 ce_r=0.7587 ce_f=5.0419
[loss-randlabel] ep 2 it 370 total=5.8430 ce_r=0.6027 ce_f=5.2403
[loss-randlabel] ep 3 it 30 total=5.8390 ce_r=0.8817 ce_f=4.9572
[loss-randlabel] ep 3 it 80 total=5.8659 ce_r=0.8309 ce_f=5.0350
[loss-randlabel] ep 3 it 130 total=6.0582 ce_r=0.8399 ce_f=5.2184
[loss-randlabel] ep 3 it 180 total=5.9213 ce_r=0.8724 ce_f=5.0489
[loss-randlabel] ep 3 it 230 total=5.8423 ce_r=0.7803 ce_f=5.0620
[loss-randlabel] ep 3 it 280 total=5.8776 ce_r=0.8382 ce_f=5.0394
[loss-randlabel] ep 3 it 330 total=5.8873 ce_r=0.8315 ce_f=5.0558
[loss-randlabel] ep 3 it 380 total=5.9337 ce_r=0.8006 ce_f=5.1331
[loss-randlabel] ep 4 it 40 total=5.8706 ce_r=0.6847 ce_f=5.1859
[loss-randlabel] ep 4 it 90 total=5.9556 ce_r=0.7640 ce_f=5.1917
[loss-randlabel] ep 4 it 140 total=5.7423 ce_r=0.7549 ce_f=4.9874
[loss-randlabel] ep 4 it 190 total=5.7664 ce_r=0.6537 ce_f=5.1127
[loss-randlabel] ep 4 it 240 total=5.6722 ce_r=0.7179 ce_f=4.9543
[loss-randlabel] ep 4 it 290 total=5.7168 ce_r=0.7201 ce_f=4.9967
[loss-randlabel] ep 4 it 340 total=5.8481 ce_r=0.5768 ce_f=5.2712
[loss-randlabel] ep 5 it 0 total=5.8631 ce_r=0.6598 ce_f=5.2033
[loss-randlabel] ep 5 it 50 total=5.7673 ce_r=0.7405 ce_f=5.0268
[loss-randlabel] ep 5 it 100 total=5.8741 ce_r=0.7079 ce_f=5.1662
[loss-randlabel] ep 5 it 150 total=5.7878 ce_r=0.7147 ce_f=5.0731
[loss-randlabel] ep 5 it 200 total=5.7932 ce_r=0.7560 ce_f=5.0373
[loss-randlabel] ep 5 it 250 total=5.6985 ce_r=0.7483 ce_f=4.9502
[loss-randlabel] ep 5 it 300 total=5.6960 ce_r=0.6655 ce_f=5.0305
[loss-randlabel] ep 5 it 350 total=5.7730 ce_r=0.6369 ce_f=5.1361
[loss-randlabel] ep 6 it 10 total=5.7963 ce_r=0.6193 ce_f=5.1769
[loss-randlabel] ep 6 it 60 total=5.7770 ce_r=0.7552 ce_f=5.0218
[loss-randlabel] ep 6 it 110 total=5.7719 ce_r=0.7545 ce_f=5.0175
[loss-randlabel] ep 6 it 160 total=5.7980 ce_r=0.6903 ce_f=5.1076
[loss-randlabel] ep 6 it 210 total=5.7644 ce_r=0.5963 ce_f=5.1681
[loss-randlabel] ep 6 it 260 total=5.6319 ce_r=0.7239 ce_f=4.9080
[loss-randlabel] ep 6 it 310 total=5.7986 ce_r=0.6900 ce_f=5.1086
[loss-randlabel] ep 6 it 360 total=5.8942 ce_r=0.6105 ce_f=5.2838
[loss-randlabel] ep 7 it 20 total=5.8111 ce_r=0.7046 ce_f=5.1065
[loss-randlabel] ep 7 it 70 total=5.8496 ce_r=0.7267 ce_f=5.1228
[loss-randlabel] ep 7 it 120 total=5.7745 ce_r=0.6263 ce_f=5.1481
[loss-randlabel] ep 7 it 170 total=5.7586 ce_r=0.6681 ce_f=5.0905
[loss-randlabel] ep 7 it 220 total=5.7306 ce_r=0.6711 ce_f=5.0595
[loss-randlabel] ep 7 it 270 total=5.7741 ce_r=0.6644 ce_f=5.1097
[loss-randlabel] ep 7 it 320 total=5.7264 ce_r=0.6761 ce_f=5.0503
[loss-randlabel] ep 7 it 370 total=5.6369 ce_r=0.7884 ce_f=4.8485
[loss-randlabel] ep 8 it 30 total=5.8058 ce_r=0.7191 ce_f=5.0867
[loss-randlabel] ep 8 it 80 total=5.7388 ce_r=0.6268 ce_f=5.1120
[loss-randlabel] ep 8 it 130 total=5.6135 ce_r=0.6907 ce_f=4.9228
[loss-randlabel] ep 8 it 180 total=5.7209 ce_r=0.7150 ce_f=5.0060
[loss-randlabel] ep 8 it 230 total=5.7435 ce_r=0.6461 ce_f=5.0974
[loss-randlabel] ep 8 it 280 total=5.8404 ce_r=0.6975 ce_f=5.1429
[loss-randlabel] ep 8 it 330 total=5.6490 ce_r=0.5216 ce_f=5.1274
[loss-randlabel] ep 8 it 380 total=5.7414 ce_r=0.7081 ce_f=5.0333
[loss-randlabel] ep 9 it 40 total=5.8365 ce_r=0.7184 ce_f=5.1181
[loss-randlabel] ep 9 it 90 total=5.6346 ce_r=0.7102 ce_f=4.9245
[loss-randlabel] ep 9 it 140 total=5.5852 ce_r=0.6440 ce_f=4.9412
[loss-randlabel] ep 9 it 190 total=5.7672 ce_r=0.6184 ce_f=5.1488
[loss-randlabel] ep 9 it 240 total=5.8061 ce_r=0.8057 ce_f=5.0004
[loss-randlabel] ep 9 it 290 total=5.8241 ce_r=0.8332 ce_f=4.9909
[loss-randlabel] ep 9 it 340 total=5.6279 ce_r=0.6009 ce_f=5.0270
[loss-randlabel] ep 10 it 0 total=5.8108 ce_r=0.6690 ce_f=5.1418
[loss-randlabel] ep 10 it 50 total=5.6002 ce_r=0.6472 ce_f=4.9531
[loss-randlabel] ep 10 it 100 total=5.7859 ce_r=0.6369 ce_f=5.1489
[loss-randlabel] ep 10 it 150 total=5.7317 ce_r=0.6546 ce_f=5.0771
[loss-randlabel] ep 10 it 200 total=5.7709 ce_r=0.6210 ce_f=5.1498
[loss-randlabel] ep 10 it 250 total=5.6961 ce_r=0.7150 ce_f=4.9811
[loss-randlabel] ep 10 it 300 total=5.6285 ce_r=0.5063 ce_f=5.1222
[loss-randlabel] ep 10 it 350 total=5.7176 ce_r=0.6081 ce_f=5.1094
[loss-randlabel] ep 11 it 10 total=5.7505 ce_r=0.5937 ce_f=5.1569
[loss-randlabel] ep 11 it 60 total=5.8126 ce_r=0.7126 ce_f=5.1000
[loss-randlabel] ep 11 it 110 total=5.6610 ce_r=0.6890 ce_f=4.9720
[loss-randlabel] ep 11 it 160 total=5.6792 ce_r=0.5835 ce_f=5.0957
[loss-randlabel] ep 11 it 210 total=5.7549 ce_r=0.7345 ce_f=5.0205
[loss-randlabel] ep 11 it 260 total=5.8120 ce_r=0.7404 ce_f=5.0715
[loss-randlabel] ep 11 it 310 total=5.7751 ce_r=0.6520 ce_f=5.1231
[loss-randlabel] ep 11 it 360 total=5.7527 ce_r=0.6664 ce_f=5.0863
[loss-randlabel] ep 12 it 20 total=5.7451 ce_r=0.6305 ce_f=5.1146
[loss-randlabel] ep 12 it 70 total=5.7535 ce_r=0.5638 ce_f=5.1896
[loss-randlabel] ep 12 it 120 total=5.6625 ce_r=0.7040 ce_f=4.9585
[loss-randlabel] ep 12 it 170 total=5.7739 ce_r=0.7569 ce_f=5.0169
[loss-randlabel] ep 12 it 220 total=5.7526 ce_r=0.6342 ce_f=5.1184
[loss-randlabel] ep 12 it 270 total=5.7060 ce_r=0.7794 ce_f=4.9266
[loss-randlabel] ep 12 it 320 total=5.6599 ce_r=0.6121 ce_f=5.0478
[loss-randlabel] ep 12 it 370 total=5.6576 ce_r=0.6979 ce_f=4.9598
[loss-randlabel] ep 13 it 30 total=5.6945 ce_r=0.5910 ce_f=5.1035
[loss-randlabel] ep 13 it 80 total=5.6585 ce_r=0.7133 ce_f=4.9452
[loss-randlabel] ep 13 it 130 total=5.6814 ce_r=0.6418 ce_f=5.0397
[loss-randlabel] ep 13 it 180 total=5.6896 ce_r=0.6897 ce_f=4.9998
[loss-randlabel] ep 13 it 230 total=5.6189 ce_r=0.6342 ce_f=4.9847
[loss-randlabel] ep 13 it 280 total=5.7184 ce_r=0.6484 ce_f=5.0699
[loss-randlabel] ep 13 it 330 total=5.7190 ce_r=0.8082 ce_f=4.9108
[loss-randlabel] ep 13 it 380 total=5.6326 ce_r=0.6874 ce_f=4.9452
[loss-randlabel] ep 14 it 40 total=5.7727 ce_r=0.7826 ce_f=4.9901
[loss-randlabel] ep 14 it 90 total=5.7075 ce_r=0.6457 ce_f=5.0618
[loss-randlabel] ep 14 it 140 total=5.7816 ce_r=0.6405 ce_f=5.1411
[loss-randlabel] ep 14 it 190 total=5.6327 ce_r=0.6379 ce_f=4.9947
[loss-randlabel] ep 14 it 240 total=5.7068 ce_r=0.6698 ce_f=5.0370
[loss-randlabel] ep 14 it 290 total=5.6352 ce_r=0.6317 ce_f=5.0035
[loss-randlabel] ep 14 it 340 total=5.7720 ce_r=0.5881 ce_f=5.1839
[loss-randlabel] ep 15 it 0 total=5.4755 ce_r=0.5945 ce_f=4.8811
[loss-randlabel] ep 15 it 50 total=5.7861 ce_r=0.6748 ce_f=5.1113
[loss-randlabel] ep 15 it 100 total=5.6701 ce_r=0.6226 ce_f=5.0475
[loss-randlabel] ep 15 it 150 total=5.7567 ce_r=0.6967 ce_f=5.0600
[loss-randlabel] ep 15 it 200 total=5.7259 ce_r=0.5944 ce_f=5.1316
[loss-randlabel] ep 15 it 250 total=5.6529 ce_r=0.5465 ce_f=5.1064
 32%|███▏      | 16/50 [07:13<14:27, 25.52s/it] 34%|███▍      | 17/50 [07:38<13:58, 25.42s/it] 36%|███▌      | 18/50 [08:03<13:31, 25.34s/it] 38%|███▊      | 19/50 [08:29<13:12, 25.55s/it] 40%|████      | 20/50 [08:55<12:53, 25.77s/it] 42%|████▏     | 21/50 [09:21<12:24, 25.66s/it] 44%|████▍     | 22/50 [09:45<11:47, 25.27s/it] 46%|████▌     | 23/50 [10:10<11:21, 25.23s/it] 48%|████▊     | 24/50 [10:35<10:56, 25.25s/it] 50%|█████     | 25/50 [11:01<10:36, 25.48s/it] 52%|█████▏    | 26/50 [11:27<10:11, 25.46s/it] 54%|█████▍    | 27/50 [11:53<09:47, 25.56s/it] 56%|█████▌    | 28/50 [12:19<09:25, 25.72s/it] 58%|█████▊    | 29/50 [12:43<08:50, 25.27s/it] 60%|██████    | 30/50 [13:09<08:31, 25.57s/it] 62%|██████▏   | 31/50 [13:32<07:52, 24.86s/it][loss-randlabel] ep 15 it 300 total=5.6308 ce_r=0.6330 ce_f=4.9979
[loss-randlabel] ep 15 it 350 total=5.7781 ce_r=0.7340 ce_f=5.0441
[loss-randlabel] ep 16 it 10 total=5.6301 ce_r=0.6268 ce_f=5.0033
[loss-randlabel] ep 16 it 60 total=5.5836 ce_r=0.5841 ce_f=4.9995
[loss-randlabel] ep 16 it 110 total=5.6820 ce_r=0.6493 ce_f=5.0328
[loss-randlabel] ep 16 it 160 total=5.6725 ce_r=0.6554 ce_f=5.0171
[loss-randlabel] ep 16 it 210 total=5.6815 ce_r=0.6828 ce_f=4.9987
[loss-randlabel] ep 16 it 260 total=5.7580 ce_r=0.7133 ce_f=5.0447
[loss-randlabel] ep 16 it 310 total=5.6811 ce_r=0.6166 ce_f=5.0645
[loss-randlabel] ep 16 it 360 total=5.7341 ce_r=0.5958 ce_f=5.1382
[loss-randlabel] ep 17 it 20 total=5.7755 ce_r=0.7076 ce_f=5.0679
[loss-randlabel] ep 17 it 70 total=5.7690 ce_r=0.6377 ce_f=5.1313
[loss-randlabel] ep 17 it 120 total=5.6253 ce_r=0.6493 ce_f=4.9760
[loss-randlabel] ep 17 it 170 total=5.6229 ce_r=0.5925 ce_f=5.0304
[loss-randlabel] ep 17 it 220 total=5.7162 ce_r=0.6363 ce_f=5.0799
[loss-randlabel] ep 17 it 270 total=5.7686 ce_r=0.5975 ce_f=5.1710
[loss-randlabel] ep 17 it 320 total=5.7697 ce_r=0.5755 ce_f=5.1943
[loss-randlabel] ep 17 it 370 total=5.6172 ce_r=0.6426 ce_f=4.9746
[loss-randlabel] ep 18 it 30 total=5.7671 ce_r=0.7405 ce_f=5.0266
[loss-randlabel] ep 18 it 80 total=5.7195 ce_r=0.6259 ce_f=5.0935
[loss-randlabel] ep 18 it 130 total=5.6807 ce_r=0.6353 ce_f=5.0454
[loss-randlabel] ep 18 it 180 total=5.6478 ce_r=0.5738 ce_f=5.0740
[loss-randlabel] ep 18 it 230 total=5.6576 ce_r=0.6018 ce_f=5.0558
[loss-randlabel] ep 18 it 280 total=5.7036 ce_r=0.7563 ce_f=4.9473
[loss-randlabel] ep 18 it 330 total=5.6228 ce_r=0.6479 ce_f=4.9750
[loss-randlabel] ep 18 it 380 total=5.6875 ce_r=0.5776 ce_f=5.1100
[loss-randlabel] ep 19 it 40 total=5.6185 ce_r=0.6504 ce_f=4.9681
[loss-randlabel] ep 19 it 90 total=5.6800 ce_r=0.6403 ce_f=5.0397
[loss-randlabel] ep 19 it 140 total=5.7601 ce_r=0.6730 ce_f=5.0871
[loss-randlabel] ep 19 it 190 total=5.6483 ce_r=0.6444 ce_f=5.0040
[loss-randlabel] ep 19 it 240 total=5.6360 ce_r=0.6817 ce_f=4.9543
[loss-randlabel] ep 19 it 290 total=5.5250 ce_r=0.6314 ce_f=4.8936
[loss-randlabel] ep 19 it 340 total=5.6609 ce_r=0.6228 ce_f=5.0382
[loss-randlabel] ep 20 it 0 total=5.5941 ce_r=0.7341 ce_f=4.8601
[loss-randlabel] ep 20 it 50 total=5.6139 ce_r=0.5900 ce_f=5.0240
[loss-randlabel] ep 20 it 100 total=5.6136 ce_r=0.6577 ce_f=4.9558
[loss-randlabel] ep 20 it 150 total=5.7226 ce_r=0.6083 ce_f=5.1144
[loss-randlabel] ep 20 it 200 total=5.6841 ce_r=0.6958 ce_f=4.9883
[loss-randlabel] ep 20 it 250 total=5.6513 ce_r=0.6505 ce_f=5.0008
[loss-randlabel] ep 20 it 300 total=5.6624 ce_r=0.5721 ce_f=5.0903
[loss-randlabel] ep 20 it 350 total=5.7326 ce_r=0.6224 ce_f=5.1102
[loss-randlabel] ep 21 it 10 total=5.5959 ce_r=0.6766 ce_f=4.9193
[loss-randlabel] ep 21 it 60 total=5.6740 ce_r=0.7087 ce_f=4.9653
[loss-randlabel] ep 21 it 110 total=5.5402 ce_r=0.5605 ce_f=4.9798
[loss-randlabel] ep 21 it 160 total=5.7310 ce_r=0.6378 ce_f=5.0932
[loss-randlabel] ep 21 it 210 total=5.6295 ce_r=0.6384 ce_f=4.9912
[loss-randlabel] ep 21 it 260 total=5.7106 ce_r=0.7025 ce_f=5.0081
[loss-randlabel] ep 21 it 310 total=5.6415 ce_r=0.6592 ce_f=4.9823
[loss-randlabel] ep 21 it 360 total=5.5359 ce_r=0.6406 ce_f=4.8953
[loss-randlabel] ep 22 it 20 total=5.6427 ce_r=0.6408 ce_f=5.0019
[loss-randlabel] ep 22 it 70 total=5.6291 ce_r=0.6057 ce_f=5.0234
[loss-randlabel] ep 22 it 120 total=5.6353 ce_r=0.6472 ce_f=4.9881
[loss-randlabel] ep 22 it 170 total=5.6532 ce_r=0.6910 ce_f=4.9623
[loss-randlabel] ep 22 it 220 total=5.6853 ce_r=0.6514 ce_f=5.0339
[loss-randlabel] ep 22 it 270 total=5.6201 ce_r=0.6081 ce_f=5.0120
[loss-randlabel] ep 22 it 320 total=5.6298 ce_r=0.6068 ce_f=5.0230
[loss-randlabel] ep 22 it 370 total=5.5776 ce_r=0.6443 ce_f=4.9333
[loss-randlabel] ep 23 it 30 total=5.6212 ce_r=0.5115 ce_f=5.1097
[loss-randlabel] ep 23 it 80 total=5.7144 ce_r=0.5538 ce_f=5.1606
[loss-randlabel] ep 23 it 130 total=5.6777 ce_r=0.6093 ce_f=5.0684
[loss-randlabel] ep 23 it 180 total=5.6723 ce_r=0.5801 ce_f=5.0921
[loss-randlabel] ep 23 it 230 total=5.7965 ce_r=0.7097 ce_f=5.0868
[loss-randlabel] ep 23 it 280 total=5.7425 ce_r=0.7176 ce_f=5.0249
[loss-randlabel] ep 23 it 330 total=5.5363 ce_r=0.5658 ce_f=4.9705
[loss-randlabel] ep 23 it 380 total=5.5491 ce_r=0.6302 ce_f=4.9189
[loss-randlabel] ep 24 it 40 total=5.6267 ce_r=0.6650 ce_f=4.9617
[loss-randlabel] ep 24 it 90 total=5.6740 ce_r=0.6416 ce_f=5.0324
[loss-randlabel] ep 24 it 140 total=5.6927 ce_r=0.6777 ce_f=5.0149
[loss-randlabel] ep 24 it 190 total=5.6787 ce_r=0.6508 ce_f=5.0279
[loss-randlabel] ep 24 it 240 total=5.6832 ce_r=0.6154 ce_f=5.0678
[loss-randlabel] ep 24 it 290 total=5.6185 ce_r=0.5792 ce_f=5.0393
[loss-randlabel] ep 24 it 340 total=5.7330 ce_r=0.5866 ce_f=5.1464
[loss-randlabel] ep 25 it 0 total=5.7097 ce_r=0.6055 ce_f=5.1042
[loss-randlabel] ep 25 it 50 total=5.6670 ce_r=0.5843 ce_f=5.0827
[loss-randlabel] ep 25 it 100 total=5.7544 ce_r=0.6787 ce_f=5.0756
[loss-randlabel] ep 25 it 150 total=5.5950 ce_r=0.6533 ce_f=4.9417
[loss-randlabel] ep 25 it 200 total=5.5356 ce_r=0.5974 ce_f=4.9382
[loss-randlabel] ep 25 it 250 total=5.7206 ce_r=0.6088 ce_f=5.1118
[loss-randlabel] ep 25 it 300 total=5.5902 ce_r=0.6401 ce_f=4.9501
[loss-randlabel] ep 25 it 350 total=5.6315 ce_r=0.6276 ce_f=5.0039
[loss-randlabel] ep 26 it 10 total=5.7418 ce_r=0.6942 ce_f=5.0476
[loss-randlabel] ep 26 it 60 total=5.5648 ce_r=0.5664 ce_f=4.9984
[loss-randlabel] ep 26 it 110 total=5.6622 ce_r=0.5834 ce_f=5.0788
[loss-randlabel] ep 26 it 160 total=5.6850 ce_r=0.6911 ce_f=4.9939
[loss-randlabel] ep 26 it 210 total=5.4883 ce_r=0.5711 ce_f=4.9172
[loss-randlabel] ep 26 it 260 total=5.6479 ce_r=0.5649 ce_f=5.0830
[loss-randlabel] ep 26 it 310 total=5.5811 ce_r=0.6046 ce_f=4.9765
[loss-randlabel] ep 26 it 360 total=5.5751 ce_r=0.6129 ce_f=4.9622
[loss-randlabel] ep 27 it 20 total=5.6174 ce_r=0.6512 ce_f=4.9662
[loss-randlabel] ep 27 it 70 total=5.7440 ce_r=0.6298 ce_f=5.1142
[loss-randlabel] ep 27 it 120 total=5.6556 ce_r=0.5839 ce_f=5.0717
[loss-randlabel] ep 27 it 170 total=5.6869 ce_r=0.6484 ce_f=5.0386
[loss-randlabel] ep 27 it 220 total=5.5939 ce_r=0.5857 ce_f=5.0082
[loss-randlabel] ep 27 it 270 total=5.6638 ce_r=0.6193 ce_f=5.0445
[loss-randlabel] ep 27 it 320 total=5.6660 ce_r=0.7089 ce_f=4.9571
[loss-randlabel] ep 27 it 370 total=5.5545 ce_r=0.5898 ce_f=4.9647
[loss-randlabel] ep 28 it 30 total=5.6244 ce_r=0.6313 ce_f=4.9930
[loss-randlabel] ep 28 it 80 total=5.6726 ce_r=0.6334 ce_f=5.0393
[loss-randlabel] ep 28 it 130 total=5.6685 ce_r=0.6554 ce_f=5.0131
[loss-randlabel] ep 28 it 180 total=5.6596 ce_r=0.6321 ce_f=5.0275
[loss-randlabel] ep 28 it 230 total=5.5646 ce_r=0.6720 ce_f=4.8927
[loss-randlabel] ep 28 it 280 total=5.5489 ce_r=0.5867 ce_f=4.9622
[loss-randlabel] ep 28 it 330 total=5.6348 ce_r=0.6132 ce_f=5.0215
[loss-randlabel] ep 28 it 380 total=5.6496 ce_r=0.6457 ce_f=5.0039
[loss-randlabel] ep 29 it 40 total=5.5859 ce_r=0.6118 ce_f=4.9741
[loss-randlabel] ep 29 it 90 total=5.7422 ce_r=0.6601 ce_f=5.0821
[loss-randlabel] ep 29 it 140 total=5.7105 ce_r=0.6936 ce_f=5.0169
[loss-randlabel] ep 29 it 190 total=5.6294 ce_r=0.7218 ce_f=4.9076
[loss-randlabel] ep 29 it 240 total=5.6143 ce_r=0.5063 ce_f=5.1079
[loss-randlabel] ep 29 it 290 total=5.5849 ce_r=0.6035 ce_f=4.9813
[loss-randlabel] ep 29 it 340 total=5.6484 ce_r=0.6191 ce_f=5.0292
[loss-randlabel] ep 30 it 0 total=5.7104 ce_r=0.6151 ce_f=5.0954
[loss-randlabel] ep 30 it 50 total=5.5521 ce_r=0.6023 ce_f=4.9498
[loss-randlabel] ep 30 it 100 total=5.7016 ce_r=0.6110 ce_f=5.0907
[loss-randlabel] ep 30 it 150 total=5.6778 ce_r=0.6101 ce_f=5.0677
[loss-randlabel] ep 30 it 200 total=5.6631 ce_r=0.6354 ce_f=5.0277
[loss-randlabel] ep 30 it 250 total=5.5981 ce_r=0.6034 ce_f=4.9947
[loss-randlabel] ep 30 it 300 total=5.5979 ce_r=0.5418 ce_f=5.0561
[loss-randlabel] ep 30 it 350 total=5.6273 ce_r=0.6439 ce_f=4.9834
[loss-randlabel] ep 31 it 10 total=5.6374 ce_r=0.6254 ce_f=5.0120
[loss-randlabel] ep 31 it 60 total=5.6621 ce_r=0.6880 ce_f=4.9741
[loss-randlabel] ep 31 it 110 total=5.6417 ce_r=0.6432 ce_f=4.9985
 64%|██████▍   | 32/50 [13:59<07:39, 25.50s/it] 66%|██████▌   | 33/50 [14:25<07:16, 25.66s/it] 68%|██████▊   | 34/50 [14:51<06:49, 25.58s/it] 70%|███████   | 35/50 [15:18<06:29, 25.94s/it] 72%|███████▏  | 36/50 [15:43<06:02, 25.88s/it] 74%|███████▍  | 37/50 [16:10<05:40, 26.17s/it] 76%|███████▌  | 38/50 [16:37<05:15, 26.28s/it] 78%|███████▊  | 39/50 [17:01<04:42, 25.70s/it] 80%|████████  | 40/50 [17:28<04:19, 25.93s/it] 82%|████████▏ | 41/50 [17:52<03:50, 25.61s/it] 84%|████████▍ | 42/50 [18:17<03:21, 25.18s/it] 86%|████████▌ | 43/50 [18:41<02:55, 25.08s/it] 88%|████████▊ | 44/50 [19:06<02:29, 24.86s/it] 90%|█████████ | 45/50 [19:31<02:04, 24.94s/it] 92%|█████████▏| 46/50 [19:56<01:39, 24.84s/it] 94%|█████████▍| 47/50 [20:21<01:15, 25.07s/it][loss-randlabel] ep 31 it 160 total=5.5603 ce_r=0.5840 ce_f=4.9763
[loss-randlabel] ep 31 it 210 total=5.5920 ce_r=0.5806 ce_f=5.0114
[loss-randlabel] ep 31 it 260 total=5.6676 ce_r=0.6600 ce_f=5.0077
[loss-randlabel] ep 31 it 310 total=5.6423 ce_r=0.6497 ce_f=4.9926
[loss-randlabel] ep 31 it 360 total=5.7099 ce_r=0.6560 ce_f=5.0539
[loss-randlabel] ep 32 it 20 total=5.5906 ce_r=0.5971 ce_f=4.9935
[loss-randlabel] ep 32 it 70 total=5.7201 ce_r=0.5624 ce_f=5.1577
[loss-randlabel] ep 32 it 120 total=5.7211 ce_r=0.5347 ce_f=5.1864
[loss-randlabel] ep 32 it 170 total=5.7235 ce_r=0.6737 ce_f=5.0499
[loss-randlabel] ep 32 it 220 total=5.5701 ce_r=0.6391 ce_f=4.9310
[loss-randlabel] ep 32 it 270 total=5.6629 ce_r=0.7186 ce_f=4.9443
[loss-randlabel] ep 32 it 320 total=5.6619 ce_r=0.5188 ce_f=5.1431
[loss-randlabel] ep 32 it 370 total=5.5595 ce_r=0.5520 ce_f=5.0076
[loss-randlabel] ep 33 it 30 total=5.6419 ce_r=0.5846 ce_f=5.0573
[loss-randlabel] ep 33 it 80 total=5.7375 ce_r=0.6674 ce_f=5.0702
[loss-randlabel] ep 33 it 130 total=5.5889 ce_r=0.6093 ce_f=4.9796
[loss-randlabel] ep 33 it 180 total=5.5878 ce_r=0.5888 ce_f=4.9990
[loss-randlabel] ep 33 it 230 total=5.7203 ce_r=0.6126 ce_f=5.1077
[loss-randlabel] ep 33 it 280 total=5.6721 ce_r=0.6036 ce_f=5.0685
[loss-randlabel] ep 33 it 330 total=5.6774 ce_r=0.6113 ce_f=5.0661
[loss-randlabel] ep 33 it 380 total=5.6976 ce_r=0.6603 ce_f=5.0372
[loss-randlabel] ep 34 it 40 total=5.7122 ce_r=0.5439 ce_f=5.1682
[loss-randlabel] ep 34 it 90 total=5.6294 ce_r=0.5651 ce_f=5.0642
[loss-randlabel] ep 34 it 140 total=5.5760 ce_r=0.5731 ce_f=5.0028
[loss-randlabel] ep 34 it 190 total=5.6553 ce_r=0.5825 ce_f=5.0728
[loss-randlabel] ep 34 it 240 total=5.6626 ce_r=0.6191 ce_f=5.0435
[loss-randlabel] ep 34 it 290 total=5.6811 ce_r=0.5568 ce_f=5.1243
[loss-randlabel] ep 34 it 340 total=5.6324 ce_r=0.6254 ce_f=5.0069
[loss-randlabel] ep 35 it 0 total=5.5354 ce_r=0.6042 ce_f=4.9312
[loss-randlabel] ep 35 it 50 total=5.5700 ce_r=0.6299 ce_f=4.9401
[loss-randlabel] ep 35 it 100 total=5.6728 ce_r=0.5252 ce_f=5.1475
[loss-randlabel] ep 35 it 150 total=5.6357 ce_r=0.6133 ce_f=5.0224
[loss-randlabel] ep 35 it 200 total=5.5334 ce_r=0.5868 ce_f=4.9465
[loss-randlabel] ep 35 it 250 total=5.7178 ce_r=0.6775 ce_f=5.0403
[loss-randlabel] ep 35 it 300 total=5.6623 ce_r=0.5794 ce_f=5.0830
[loss-randlabel] ep 35 it 350 total=5.7006 ce_r=0.6317 ce_f=5.0689
[loss-randlabel] ep 36 it 10 total=5.5633 ce_r=0.5500 ce_f=5.0133
[loss-randlabel] ep 36 it 60 total=5.6599 ce_r=0.5869 ce_f=5.0730
[loss-randlabel] ep 36 it 110 total=5.6301 ce_r=0.5752 ce_f=5.0549
[loss-randlabel] ep 36 it 160 total=5.5855 ce_r=0.5520 ce_f=5.0335
[loss-randlabel] ep 36 it 210 total=5.6066 ce_r=0.5230 ce_f=5.0836
[loss-randlabel] ep 36 it 260 total=5.6211 ce_r=0.6309 ce_f=4.9902
[loss-randlabel] ep 36 it 310 total=5.6567 ce_r=0.6132 ce_f=5.0435
[loss-randlabel] ep 36 it 360 total=5.7065 ce_r=0.6359 ce_f=5.0706
[loss-randlabel] ep 37 it 20 total=5.6510 ce_r=0.6205 ce_f=5.0305
[loss-randlabel] ep 37 it 70 total=5.6219 ce_r=0.6107 ce_f=5.0112
[loss-randlabel] ep 37 it 120 total=5.6616 ce_r=0.6715 ce_f=4.9900
[loss-randlabel] ep 37 it 170 total=5.5332 ce_r=0.5650 ce_f=4.9682
[loss-randlabel] ep 37 it 220 total=5.6272 ce_r=0.5812 ce_f=5.0460
[loss-randlabel] ep 37 it 270 total=5.6750 ce_r=0.6171 ce_f=5.0579
[loss-randlabel] ep 37 it 320 total=5.6482 ce_r=0.5808 ce_f=5.0673
[loss-randlabel] ep 37 it 370 total=5.6232 ce_r=0.6038 ce_f=5.0194
[loss-randlabel] ep 38 it 30 total=5.5640 ce_r=0.6380 ce_f=4.9260
[loss-randlabel] ep 38 it 80 total=5.5892 ce_r=0.5931 ce_f=4.9961
[loss-randlabel] ep 38 it 130 total=5.6248 ce_r=0.5532 ce_f=5.0716
[loss-randlabel] ep 38 it 180 total=5.5317 ce_r=0.5973 ce_f=4.9344
[loss-randlabel] ep 38 it 230 total=5.6388 ce_r=0.5509 ce_f=5.0879
[loss-randlabel] ep 38 it 280 total=5.6237 ce_r=0.6598 ce_f=4.9640
[loss-randlabel] ep 38 it 330 total=5.6172 ce_r=0.5321 ce_f=5.0850
[loss-randlabel] ep 38 it 380 total=5.6014 ce_r=0.6388 ce_f=4.9626
[loss-randlabel] ep 39 it 40 total=5.6551 ce_r=0.6332 ce_f=5.0219
[loss-randlabel] ep 39 it 90 total=5.5887 ce_r=0.6560 ce_f=4.9327
[loss-randlabel] ep 39 it 140 total=5.7087 ce_r=0.6646 ce_f=5.0441
[loss-randlabel] ep 39 it 190 total=5.6212 ce_r=0.5880 ce_f=5.0331
[loss-randlabel] ep 39 it 240 total=5.6491 ce_r=0.6172 ce_f=5.0319
[loss-randlabel] ep 39 it 290 total=5.5853 ce_r=0.6352 ce_f=4.9501
[loss-randlabel] ep 39 it 340 total=5.6082 ce_r=0.6545 ce_f=4.9536
[loss-randlabel] ep 40 it 0 total=5.6020 ce_r=0.5864 ce_f=5.0156
[loss-randlabel] ep 40 it 50 total=5.4976 ce_r=0.5420 ce_f=4.9555
[loss-randlabel] ep 40 it 100 total=5.6609 ce_r=0.6537 ce_f=5.0072
[loss-randlabel] ep 40 it 150 total=5.6189 ce_r=0.6083 ce_f=5.0105
[loss-randlabel] ep 40 it 200 total=5.6234 ce_r=0.5444 ce_f=5.0791
[loss-randlabel] ep 40 it 250 total=5.5085 ce_r=0.5883 ce_f=4.9202
[loss-randlabel] ep 40 it 300 total=5.6600 ce_r=0.5696 ce_f=5.0904
[loss-randlabel] ep 40 it 350 total=5.6322 ce_r=0.5778 ce_f=5.0544
[loss-randlabel] ep 41 it 10 total=5.6138 ce_r=0.6701 ce_f=4.9437
[loss-randlabel] ep 41 it 60 total=5.6444 ce_r=0.6045 ce_f=5.0400
[loss-randlabel] ep 41 it 110 total=5.5844 ce_r=0.5773 ce_f=5.0071
[loss-randlabel] ep 41 it 160 total=5.5316 ce_r=0.6415 ce_f=4.8901
[loss-randlabel] ep 41 it 210 total=5.5866 ce_r=0.6083 ce_f=4.9783
[loss-randlabel] ep 41 it 260 total=5.6311 ce_r=0.5858 ce_f=5.0453
[loss-randlabel] ep 41 it 310 total=5.6233 ce_r=0.6163 ce_f=5.0070
[loss-randlabel] ep 41 it 360 total=5.6551 ce_r=0.5411 ce_f=5.1140
[loss-randlabel] ep 42 it 20 total=5.7046 ce_r=0.6840 ce_f=5.0206
[loss-randlabel] ep 42 it 70 total=5.5811 ce_r=0.5953 ce_f=4.9858
[loss-randlabel] ep 42 it 120 total=5.6529 ce_r=0.6061 ce_f=5.0468
[loss-randlabel] ep 42 it 170 total=5.6362 ce_r=0.5932 ce_f=5.0430
[loss-randlabel] ep 42 it 220 total=5.6441 ce_r=0.6105 ce_f=5.0335
[loss-randlabel] ep 42 it 270 total=5.5721 ce_r=0.6352 ce_f=4.9368
[loss-randlabel] ep 42 it 320 total=5.5561 ce_r=0.6425 ce_f=4.9137
[loss-randlabel] ep 42 it 370 total=5.6589 ce_r=0.6184 ce_f=5.0404
[loss-randlabel] ep 43 it 30 total=5.5674 ce_r=0.5510 ce_f=5.0164
[loss-randlabel] ep 43 it 80 total=5.4936 ce_r=0.5858 ce_f=4.9077
[loss-randlabel] ep 43 it 130 total=5.6213 ce_r=0.6142 ce_f=5.0072
[loss-randlabel] ep 43 it 180 total=5.6487 ce_r=0.6599 ce_f=4.9888
[loss-randlabel] ep 43 it 230 total=5.6347 ce_r=0.6372 ce_f=4.9975
[loss-randlabel] ep 43 it 280 total=5.5097 ce_r=0.5931 ce_f=4.9166
[loss-randlabel] ep 43 it 330 total=5.6551 ce_r=0.7380 ce_f=4.9171
[loss-randlabel] ep 43 it 380 total=5.7573 ce_r=0.7143 ce_f=5.0430
[loss-randlabel] ep 44 it 40 total=5.6018 ce_r=0.5931 ce_f=5.0087
[loss-randlabel] ep 44 it 90 total=5.7531 ce_r=0.6339 ce_f=5.1192
[loss-randlabel] ep 44 it 140 total=5.7297 ce_r=0.6519 ce_f=5.0778
[loss-randlabel] ep 44 it 190 total=5.4963 ce_r=0.6145 ce_f=4.8818
[loss-randlabel] ep 44 it 240 total=5.5964 ce_r=0.5951 ce_f=5.0013
[loss-randlabel] ep 44 it 290 total=5.6024 ce_r=0.5801 ce_f=5.0223
[loss-randlabel] ep 44 it 340 total=5.6160 ce_r=0.5681 ce_f=5.0479
[loss-randlabel] ep 45 it 0 total=5.6259 ce_r=0.5754 ce_f=5.0505
[loss-randlabel] ep 45 it 50 total=5.6846 ce_r=0.6947 ce_f=4.9900
[loss-randlabel] ep 45 it 100 total=5.6072 ce_r=0.6042 ce_f=5.0030
[loss-randlabel] ep 45 it 150 total=5.5178 ce_r=0.5786 ce_f=4.9392
[loss-randlabel] ep 45 it 200 total=5.7298 ce_r=0.5692 ce_f=5.1606
[loss-randlabel] ep 45 it 250 total=5.5890 ce_r=0.5849 ce_f=5.0041
[loss-randlabel] ep 45 it 300 total=5.6559 ce_r=0.6614 ce_f=4.9946
[loss-randlabel] ep 45 it 350 total=5.5517 ce_r=0.5882 ce_f=4.9635
[loss-randlabel] ep 46 it 10 total=5.6168 ce_r=0.6783 ce_f=4.9386
[loss-randlabel] ep 46 it 60 total=5.6285 ce_r=0.5784 ce_f=5.0501
[loss-randlabel] ep 46 it 110 total=5.6817 ce_r=0.5760 ce_f=5.1057
[loss-randlabel] ep 46 it 160 total=5.4646 ce_r=0.5582 ce_f=4.9064
[loss-randlabel] ep 46 it 210 total=5.6544 ce_r=0.6083 ce_f=5.0461
[loss-randlabel] ep 46 it 260 total=5.6042 ce_r=0.6584 ce_f=4.9458
[loss-randlabel] ep 46 it 310 total=5.6971 ce_r=0.6731 ce_f=5.0240
[loss-randlabel] ep 46 it 360 total=5.5325 ce_r=0.5559 ce_f=4.9767
 96%|█████████▌| 48/50 [20:45<00:49, 24.58s/it] 98%|█████████▊| 49/50 [21:10<00:24, 24.80s/it]100%|██████████| 50/50 [21:35<00:00, 24.84s/it]100%|██████████| 50/50 [21:35<00:00, 25.91s/it]
[loss-randlabel] ep 47 it 20 total=5.6471 ce_r=0.5701 ce_f=5.0770
[loss-randlabel] ep 47 it 70 total=5.6573 ce_r=0.6547 ce_f=5.0025
[loss-randlabel] ep 47 it 120 total=5.6181 ce_r=0.5906 ce_f=5.0275
[loss-randlabel] ep 47 it 170 total=5.5535 ce_r=0.5141 ce_f=5.0395
[loss-randlabel] ep 47 it 220 total=5.6322 ce_r=0.6162 ce_f=5.0160
[loss-randlabel] ep 47 it 270 total=5.5848 ce_r=0.6123 ce_f=4.9725
[loss-randlabel] ep 47 it 320 total=5.6034 ce_r=0.6373 ce_f=4.9660
[loss-randlabel] ep 47 it 370 total=5.6107 ce_r=0.5472 ce_f=5.0635
[loss-randlabel] ep 48 it 30 total=5.6978 ce_r=0.6524 ce_f=5.0455
[loss-randlabel] ep 48 it 80 total=5.6158 ce_r=0.6006 ce_f=5.0151
[loss-randlabel] ep 48 it 130 total=5.7144 ce_r=0.5937 ce_f=5.1208
[loss-randlabel] ep 48 it 180 total=5.5850 ce_r=0.6848 ce_f=4.9002
[loss-randlabel] ep 48 it 230 total=5.5787 ce_r=0.5691 ce_f=5.0096
[loss-randlabel] ep 48 it 280 total=5.6451 ce_r=0.6569 ce_f=4.9882
[loss-randlabel] ep 48 it 330 total=5.6531 ce_r=0.5973 ce_f=5.0559
[loss-randlabel] ep 48 it 380 total=5.5909 ce_r=0.5936 ce_f=4.9973
[loss-randlabel] ep 49 it 40 total=5.5684 ce_r=0.5759 ce_f=4.9925
[loss-randlabel] ep 49 it 90 total=5.5014 ce_r=0.6104 ce_f=4.8910
[loss-randlabel] ep 49 it 140 total=5.5849 ce_r=0.5845 ce_f=5.0004
[loss-randlabel] ep 49 it 190 total=5.6560 ce_r=0.5203 ce_f=5.1358
[loss-randlabel] ep 49 it 240 total=5.5852 ce_r=0.6284 ce_f=4.9568
[loss-randlabel] ep 49 it 290 total=5.5317 ce_r=0.5860 ce_f=4.9457
[loss-randlabel] ep 49 it 340 total=5.6049 ce_r=0.5646 ce_f=5.0403
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget20.pt
resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget20: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:56,  2.21it/s]  1%|▏         | 5/391 [00:00<00:34, 11.26it/s]  3%|▎         | 10/391 [00:00<00:18, 20.66it/s]  5%|▍         | 19/391 [00:00<00:09, 38.53it/s]  7%|▋         | 29/391 [00:00<00:06, 53.86it/s] 10%|▉         | 38/391 [00:00<00:05, 63.41it/s] 12%|█▏        | 47/391 [00:01<00:05, 68.55it/s] 14%|█▍        | 55/391 [00:01<00:05, 59.80it/s] 16%|█▌        | 62/391 [00:01<00:05, 55.68it/s] 18%|█▊        | 69/391 [00:01<00:06, 52.20it/s] 19%|█▉        | 75/391 [00:01<00:06, 48.53it/s] 21%|██        | 83/391 [00:01<00:05, 55.21it/s] 24%|██▍       | 93/391 [00:01<00:04, 64.84it/s] 26%|██▌       | 102/391 [00:02<00:04, 69.80it/s] 29%|██▊       | 112/391 [00:02<00:03, 75.94it/s] 31%|███       | 120/391 [00:02<00:04, 65.15it/s] 32%|███▏      | 127/391 [00:02<00:04, 59.43it/s] 34%|███▍      | 134/391 [00:02<00:04, 57.35it/s] 36%|███▌      | 140/391 [00:02<00:04, 56.72it/s] 37%|███▋      | 146/391 [00:02<00:04, 53.89it/s] 40%|███▉      | 155/391 [00:02<00:03, 62.80it/s] 42%|████▏     | 164/391 [00:03<00:03, 69.26it/s] 45%|████▍     | 174/391 [00:03<00:02, 75.56it/s] 47%|████▋     | 184/391 [00:03<00:02, 80.58it/s] 50%|████▉     | 194/391 [00:03<00:02, 84.44it/s] 52%|█████▏    | 203/391 [00:03<00:02, 77.21it/s] 54%|█████▍    | 211/391 [00:03<00:02, 65.58it/s] 56%|█████▌    | 218/391 [00:03<00:02, 59.77it/s] 58%|█████▊    | 225/391 [00:03<00:02, 60.46it/s] 59%|█████▉    | 232/391 [00:04<00:02, 56.11it/s] 61%|██████▏   | 240/391 [00:04<00:02, 61.61it/s] 64%|██████▍   | 250/391 [00:04<00:02, 69.90it/s] 66%|██████▌   | 259/391 [00:04<00:01, 75.00it/s] 69%|██████▉   | 269/391 [00:04<00:01, 79.78it/s] 71%|███████   | 278/391 [00:04<00:01, 76.63it/s] 73%|███████▎  | 286/391 [00:04<00:01, 65.22it/s] 75%|███████▍  | 293/391 [00:04<00:01, 59.45it/s] 77%|███████▋  | 300/391 [00:05<00:01, 59.13it/s] 79%|███████▊  | 307/391 [00:05<00:01, 54.71it/s] 81%|████████  | 315/391 [00:05<00:01, 60.21it/s] 83%|████████▎ | 325/391 [00:05<00:00, 68.74it/s] 85%|████████▌ | 334/391 [00:05<00:00, 73.96it/s] 88%|████████▊ | 343/391 [00:05<00:00, 76.69it/s] 90%|████████▉ | 351/391 [00:05<00:00, 61.82it/s] 92%|█████████▏| 358/391 [00:05<00:00, 57.30it/s] 93%|█████████▎| 365/391 [00:06<00:00, 59.13it/s] 95%|█████████▌| 372/391 [00:06<00:00, 55.37it/s] 97%|█████████▋| 378/391 [00:06<00:00, 56.08it/s] 99%|█████████▉| 388/391 [00:06<00:00, 66.26it/s]100%|██████████| 391/391 [00:06<00:00, 60.34it/s]
50000 images processed, 6.59174108505249 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.17it/s]  6%|▋         | 5/79 [00:00<00:06, 10.88it/s] 13%|█▎        | 10/79 [00:00<00:03, 20.36it/s] 23%|██▎       | 18/79 [00:00<00:01, 35.36it/s] 30%|███       | 24/79 [00:00<00:01, 38.88it/s] 39%|███▉      | 31/79 [00:01<00:01, 46.16it/s] 47%|████▋     | 37/79 [00:01<00:00, 49.38it/s] 58%|█████▊    | 46/79 [00:01<00:00, 59.74it/s] 70%|██████▉   | 55/79 [00:01<00:00, 67.95it/s] 80%|███████▉  | 63/79 [00:01<00:00, 65.07it/s] 89%|████████▊ | 70/79 [00:01<00:00, 58.74it/s] 97%|█████████▋| 77/79 [00:01<00:00, 51.02it/s]100%|██████████| 79/79 [00:01<00:00, 42.35it/s]
10000 images processed, 1.9053401947021484 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget20/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:49,  1.86it/s]  2%|▏         | 5/204 [00:00<00:20,  9.74it/s]  5%|▍         | 10/204 [00:00<00:10, 18.70it/s]  7%|▋         | 14/204 [00:00<00:08, 22.82it/s]  9%|▉         | 19/204 [00:00<00:06, 28.20it/s] 12%|█▏        | 24/204 [00:01<00:05, 32.35it/s] 14%|█▍        | 29/204 [00:01<00:05, 34.43it/s] 17%|█▋        | 34/204 [00:01<00:04, 36.75it/s] 21%|██        | 43/204 [00:01<00:03, 50.15it/s] 26%|██▌       | 53/204 [00:01<00:02, 61.77it/s] 30%|██▉       | 61/204 [00:01<00:02, 64.90it/s] 34%|███▍      | 70/204 [00:01<00:01, 71.70it/s] 38%|███▊      | 78/204 [00:01<00:01, 63.71it/s] 42%|████▏     | 85/204 [00:02<00:02, 56.14it/s] 45%|████▍     | 91/204 [00:02<00:02, 54.45it/s] 48%|████▊     | 97/204 [00:02<00:02, 52.73it/s] 50%|█████     | 103/204 [00:02<00:01, 52.42it/s] 55%|█████▌    | 113/204 [00:02<00:01, 62.89it/s] 60%|█████▉    | 122/204 [00:02<00:01, 69.80it/s] 64%|██████▎   | 130/204 [00:02<00:01, 70.74it/s] 68%|██████▊   | 138/204 [00:02<00:01, 59.12it/s] 71%|███████   | 145/204 [00:03<00:01, 53.52it/s] 75%|███████▍  | 152/204 [00:03<00:00, 55.44it/s] 77%|███████▋  | 158/204 [00:03<00:00, 51.49it/s] 81%|████████▏ | 166/204 [00:03<00:00, 57.35it/s] 85%|████████▌ | 174/204 [00:03<00:00, 62.30it/s] 89%|████████▉ | 182/204 [00:03<00:00, 66.91it/s] 93%|█████████▎| 189/204 [00:03<00:00, 65.72it/s] 98%|█████████▊| 199/204 [00:03<00:00, 73.43it/s]100%|██████████| 204/204 [00:03<00:00, 51.33it/s]
26032 images processed, 4.036269664764404 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:52,  1.50it/s]  8%|▊         | 6/79 [00:00<00:07,  9.77it/s] 14%|█▍        | 11/79 [00:00<00:03, 17.07it/s] 22%|██▏       | 17/79 [00:01<00:02, 26.03it/s] 28%|██▊       | 22/79 [00:01<00:01, 30.10it/s] 39%|███▉      | 31/79 [00:01<00:01, 43.39it/s] 51%|█████     | 40/79 [00:01<00:00, 54.39it/s] 63%|██████▎   | 50/79 [00:01<00:00, 64.62it/s] 76%|███████▌  | 60/79 [00:01<00:00, 73.02it/s] 89%|████████▊ | 70/79 [00:01<00:00, 78.35it/s]100%|██████████| 79/79 [00:01<00:00, 64.90it/s]100%|██████████| 79/79 [00:01<00:00, 42.46it/s]
10000 images processed, 1.8894071578979492 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:50,  1.53it/s]  9%|▉         | 7/79 [00:00<00:06, 11.68it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.46it/s] 20%|██        | 16/79 [00:00<00:02, 23.47it/s] 25%|██▌       | 20/79 [00:01<00:02, 25.66it/s] 32%|███▏      | 25/79 [00:01<00:01, 30.23it/s] 38%|███▊      | 30/79 [00:01<00:01, 33.69it/s] 46%|████▌     | 36/79 [00:01<00:01, 39.83it/s] 52%|█████▏    | 41/79 [00:01<00:00, 40.64it/s] 61%|██████    | 48/79 [00:01<00:00, 47.63it/s] 68%|██████▊   | 54/79 [00:01<00:00, 50.69it/s] 76%|███████▌  | 60/79 [00:01<00:00, 44.60it/s] 82%|████████▏ | 65/79 [00:02<00:00, 44.09it/s] 89%|████████▊ | 70/79 [00:02<00:00, 44.17it/s] 96%|█████████▌| 76/79 [00:02<00:00, 46.51it/s]100%|██████████| 79/79 [00:02<00:00, 33.50it/s]
10000 images processed, 2.406419038772583 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:58,  1.18it/s]  9%|▊         | 6/70 [00:00<00:07,  8.12it/s] 21%|██▏       | 15/70 [00:01<00:02, 21.86it/s] 33%|███▎      | 23/70 [00:01<00:01, 32.86it/s] 46%|████▌     | 32/70 [00:01<00:00, 44.18it/s] 56%|█████▌    | 39/70 [00:01<00:00, 43.71it/s] 66%|██████▌   | 46/70 [00:01<00:00, 43.41it/s] 76%|███████▌  | 53/70 [00:01<00:00, 46.96it/s] 84%|████████▍ | 59/70 [00:01<00:00, 45.67it/s] 96%|█████████▌| 67/70 [00:01<00:00, 53.22it/s]100%|██████████| 70/70 [00:02<00:00, 34.91it/s]
8925 images processed, 2.050365686416626 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<01:01,  1.40s/it] 11%|█         | 5/45 [00:01<00:09,  4.31it/s] 18%|█▊        | 8/45 [00:01<00:05,  6.71it/s] 29%|██▉       | 13/45 [00:01<00:02, 12.09it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.78it/s] 49%|████▉     | 22/45 [00:02<00:01, 20.35it/s] 58%|█████▊    | 26/45 [00:02<00:01, 18.01it/s] 69%|██████▉   | 31/45 [00:02<00:00, 22.75it/s] 78%|███████▊  | 35/45 [00:02<00:00, 19.77it/s]100%|██████████| 45/45 [00:03<00:00, 20.57it/s]100%|██████████| 45/45 [00:03<00:00, 14.05it/s]
5640 images processed, 3.230708599090576 seconds used

24.130614757537842
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.16  99.02  97.04
places365     68.62  80.89  76.21
LSUN          25.41  94.74  94.29
iSUN          48.93  89.07  89.06
dtd           47.30  89.44  92.46
AVG           38.89  90.63  89.81
Retain-Acc: 0.7599
Forget-as-OOD (retain known vs forget novel):
  FPR: 45.05 AUROC: 91.13 AUIN: 97.51
18.074687004089355
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget20_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget20_rf.png
