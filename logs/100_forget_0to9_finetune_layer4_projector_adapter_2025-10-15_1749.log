nohup: ignoring input
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from /home/shaokun/PALM/checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] failed to load adapter: Repo id must use alphanumeric chars or '-', '_', '.', '--' and '..' are forbidden, '-' and '.' cannot start or end the name, max length is 96: '0,1,2,3,4,5,6,7,8,9'.
resnet34-top5-palm-cache6-ema0.999-eval-retainforget: Number of model parameters: 21610432
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<01:45,  3.71it/s]  3%|▎         | 12/391 [00:00<00:09, 39.67it/s]  6%|▌         | 23/391 [00:00<00:06, 59.92it/s]  8%|▊         | 31/391 [00:00<00:06, 56.48it/s] 10%|▉         | 38/391 [00:00<00:06, 55.82it/s] 12%|█▏        | 45/391 [00:00<00:06, 57.61it/s] 13%|█▎        | 52/391 [00:01<00:06, 55.48it/s] 15%|█▍        | 58/391 [00:01<00:06, 54.98it/s] 16%|█▋        | 64/391 [00:01<00:06, 53.25it/s] 18%|█▊        | 71/391 [00:01<00:05, 55.24it/s] 20%|█▉        | 77/391 [00:01<00:05, 53.78it/s] 21%|██        | 83/391 [00:01<00:05, 53.15it/s] 23%|██▎       | 90/391 [00:01<00:05, 54.95it/s] 25%|██▍       | 96/391 [00:01<00:05, 54.36it/s] 26%|██▌       | 102/391 [00:01<00:05, 54.75it/s] 28%|██▊       | 108/391 [00:02<00:05, 54.37it/s] 29%|██▉       | 114/391 [00:02<00:05, 53.09it/s] 31%|███       | 120/391 [00:02<00:05, 51.91it/s] 32%|███▏      | 126/391 [00:02<00:05, 52.18it/s] 34%|███▍      | 133/391 [00:02<00:04, 55.92it/s] 36%|███▌      | 139/391 [00:02<00:04, 54.41it/s] 37%|███▋      | 145/391 [00:02<00:04, 55.39it/s] 39%|███▊      | 151/391 [00:02<00:04, 54.88it/s] 40%|████      | 157/391 [00:02<00:04, 54.69it/s] 42%|████▏     | 163/391 [00:03<00:04, 53.31it/s] 43%|████▎     | 169/391 [00:03<00:04, 53.18it/s] 45%|████▍     | 175/391 [00:03<00:03, 54.28it/s] 46%|████▋     | 181/391 [00:03<00:03, 53.48it/s] 48%|████▊     | 187/391 [00:03<00:03, 54.11it/s] 49%|████▉     | 193/391 [00:03<00:03, 53.93it/s] 51%|█████     | 199/391 [00:03<00:03, 54.17it/s] 52%|█████▏    | 205/391 [00:03<00:03, 53.03it/s] 54%|█████▍    | 211/391 [00:03<00:03, 52.96it/s] 56%|█████▌    | 218/391 [00:04<00:03, 55.72it/s] 57%|█████▋    | 224/391 [00:04<00:03, 54.20it/s] 59%|█████▉    | 230/391 [00:04<00:02, 54.65it/s] 60%|██████    | 236/391 [00:04<00:02, 54.04it/s] 62%|██████▏   | 242/391 [00:04<00:02, 53.35it/s] 63%|██████▎   | 248/391 [00:04<00:02, 52.42it/s] 65%|██████▍   | 254/391 [00:04<00:02, 52.16it/s] 67%|██████▋   | 261/391 [00:04<00:02, 54.35it/s] 68%|██████▊   | 267/391 [00:05<00:02, 53.11it/s] 70%|██████▉   | 273/391 [00:05<00:02, 53.02it/s] 72%|███████▏  | 280/391 [00:05<00:02, 54.71it/s] 73%|███████▎  | 286/391 [00:05<00:01, 54.40it/s] 75%|███████▍  | 292/391 [00:05<00:01, 54.55it/s] 76%|███████▌  | 298/391 [00:05<00:01, 52.94it/s] 78%|███████▊  | 305/391 [00:05<00:01, 54.59it/s] 80%|███████▉  | 311/391 [00:05<00:01, 53.33it/s] 81%|████████  | 317/391 [00:05<00:01, 53.16it/s] 83%|████████▎ | 323/391 [00:06<00:01, 53.79it/s] 84%|████████▍ | 329/391 [00:06<00:01, 52.40it/s] 86%|████████▌ | 335/391 [00:06<00:01, 53.02it/s] 87%|████████▋ | 341/391 [00:06<00:00, 52.84it/s] 89%|████████▊ | 347/391 [00:06<00:00, 52.54it/s] 90%|█████████ | 353/391 [00:06<00:00, 52.86it/s] 92%|█████████▏| 359/391 [00:06<00:00, 51.67it/s] 94%|█████████▎| 366/391 [00:06<00:00, 53.81it/s] 95%|█████████▌| 372/391 [00:06<00:00, 52.81it/s] 97%|█████████▋| 378/391 [00:07<00:00, 52.34it/s] 98%|█████████▊| 384/391 [00:07<00:00, 53.43it/s]100%|█████████▉| 390/391 [00:07<00:00, 53.31it/s]100%|██████████| 391/391 [00:07<00:00, 53.23it/s]
50000 images processed, 7.433512926101685 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:18,  4.20it/s] 11%|█▏        | 9/79 [00:00<00:02, 32.36it/s] 25%|██▌       | 20/79 [00:00<00:01, 57.48it/s] 39%|███▉      | 31/79 [00:00<00:00, 72.69it/s] 53%|█████▎    | 42/79 [00:00<00:00, 82.04it/s] 67%|██████▋   | 53/79 [00:00<00:00, 88.39it/s] 81%|████████  | 64/79 [00:00<00:00, 92.25it/s] 94%|█████████▎| 74/79 [00:01<00:00, 80.55it/s]100%|██████████| 79/79 [00:01<00:00, 69.30it/s]
10000 images processed, 1.159407377243042 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<00:51,  3.93it/s]  6%|▌         | 12/204 [00:00<00:04, 41.00it/s] 10%|▉         | 20/204 [00:00<00:03, 52.75it/s] 13%|█▎        | 27/204 [00:00<00:03, 51.19it/s] 17%|█▋        | 34/204 [00:00<00:03, 49.19it/s] 21%|██        | 43/204 [00:00<00:02, 57.12it/s] 25%|██▍       | 50/204 [00:01<00:02, 53.42it/s] 27%|██▋       | 56/204 [00:01<00:02, 52.00it/s] 31%|███       | 63/204 [00:01<00:02, 56.48it/s] 34%|███▍      | 69/204 [00:01<00:02, 53.59it/s] 37%|███▋      | 75/204 [00:01<00:02, 52.93it/s] 40%|████      | 82/204 [00:01<00:02, 56.01it/s] 43%|████▎     | 88/204 [00:01<00:02, 53.63it/s] 46%|████▌     | 94/204 [00:01<00:02, 52.36it/s] 49%|████▉     | 100/204 [00:01<00:02, 51.73it/s] 53%|█████▎    | 108/204 [00:02<00:01, 56.53it/s] 56%|█████▌    | 114/204 [00:02<00:01, 52.76it/s] 59%|█████▉    | 120/204 [00:02<00:01, 51.31it/s] 63%|██████▎   | 128/204 [00:02<00:01, 56.48it/s] 66%|██████▌   | 134/204 [00:02<00:01, 53.26it/s] 69%|██████▊   | 140/204 [00:02<00:01, 51.11it/s] 73%|███████▎  | 148/204 [00:02<00:00, 57.95it/s] 75%|███████▌  | 154/204 [00:02<00:00, 54.26it/s] 78%|███████▊  | 160/204 [00:03<00:00, 53.07it/s] 81%|████████▏ | 166/204 [00:03<00:00, 54.08it/s] 85%|████████▍ | 173/204 [00:03<00:00, 57.08it/s] 88%|████████▊ | 179/204 [00:03<00:00, 53.06it/s] 91%|█████████ | 185/204 [00:03<00:00, 51.54it/s] 95%|█████████▍| 193/204 [00:03<00:00, 58.08it/s] 98%|█████████▊| 199/204 [00:03<00:00, 55.43it/s]100%|██████████| 204/204 [00:03<00:00, 52.68it/s]
26032 images processed, 3.913179874420166 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.36it/s] 11%|█▏        | 9/79 [00:00<00:03, 19.19it/s] 18%|█▊        | 14/79 [00:00<00:02, 26.35it/s] 24%|██▍       | 19/79 [00:00<00:01, 31.37it/s] 33%|███▎      | 26/79 [00:00<00:01, 39.75it/s] 39%|███▉      | 31/79 [00:01<00:01, 41.97it/s] 46%|████▌     | 36/79 [00:01<00:00, 43.18it/s] 52%|█████▏    | 41/79 [00:01<00:00, 44.80it/s] 61%|██████    | 48/79 [00:01<00:00, 50.50it/s] 68%|██████▊   | 54/79 [00:01<00:00, 47.36it/s] 75%|███████▍  | 59/79 [00:01<00:00, 47.27it/s] 84%|████████▎ | 66/79 [00:01<00:00, 49.86it/s] 91%|█████████ | 72/79 [00:01<00:00, 49.54it/s] 99%|█████████▊| 78/79 [00:01<00:00, 48.92it/s]100%|██████████| 79/79 [00:01<00:00, 40.14it/s]
10000 images processed, 1.9973912239074707 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:23,  3.37it/s] 11%|█▏        | 9/79 [00:00<00:02, 27.32it/s] 18%|█▊        | 14/79 [00:00<00:01, 33.12it/s] 24%|██▍       | 19/79 [00:00<00:01, 37.82it/s] 33%|███▎      | 26/79 [00:00<00:01, 46.15it/s] 42%|████▏     | 33/79 [00:00<00:00, 51.78it/s] 49%|████▉     | 39/79 [00:00<00:00, 49.40it/s] 57%|█████▋    | 45/79 [00:01<00:00, 48.72it/s] 66%|██████▌   | 52/79 [00:01<00:00, 54.25it/s] 73%|███████▎  | 58/79 [00:01<00:00, 52.26it/s] 81%|████████  | 64/79 [00:01<00:00, 51.34it/s] 91%|█████████ | 72/79 [00:01<00:00, 56.26it/s] 99%|█████████▊| 78/79 [00:01<00:00, 53.11it/s]100%|██████████| 79/79 [00:01<00:00, 46.42it/s]
10000 images processed, 1.7248265743255615 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:20,  3.34it/s] 17%|█▋        | 12/70 [00:00<00:01, 36.81it/s] 30%|███       | 21/70 [00:00<00:00, 50.63it/s] 40%|████      | 28/70 [00:00<00:00, 50.29it/s] 50%|█████     | 35/70 [00:00<00:00, 48.69it/s] 61%|██████▏   | 43/70 [00:00<00:00, 56.46it/s] 71%|███████▏  | 50/70 [00:01<00:00, 54.01it/s] 80%|████████  | 56/70 [00:01<00:00, 52.08it/s] 89%|████████▊ | 62/70 [00:01<00:00, 53.94it/s] 97%|█████████▋| 68/70 [00:01<00:00, 52.35it/s]100%|██████████| 70/70 [00:01<00:00, 48.09it/s]
8925 images processed, 1.4833388328552246 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:35,  1.23it/s]  4%|▍         | 2/45 [00:00<00:17,  2.41it/s] 18%|█▊        | 8/45 [00:01<00:03, 11.74it/s] 24%|██▍       | 11/45 [00:01<00:03,  9.32it/s] 38%|███▊      | 17/45 [00:01<00:02, 11.96it/s] 42%|████▏     | 19/45 [00:02<00:02, 12.22it/s] 51%|█████     | 23/45 [00:02<00:01, 15.92it/s] 58%|█████▊    | 26/45 [00:02<00:01, 11.72it/s] 69%|██████▉   | 31/45 [00:02<00:00, 15.94it/s] 76%|███████▌  | 34/45 [00:03<00:01, 10.19it/s] 89%|████████▉ | 40/45 [00:03<00:00, 15.49it/s] 96%|█████████▌| 43/45 [00:03<00:00, 11.25it/s]100%|██████████| 45/45 [00:03<00:00, 11.37it/s]
5640 images processed, 3.9776065349578857 seconds used

23.34240746498108
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
usage: eval_cifar.py [-h] [--in-dataset IN_DATASET]
                     [--out-datasets [OUT_DATASETS ...]] [--backbone BACKBONE]
                     [--method METHOD] [--seed SEED] [--gpu GPU]
                     [--epochs EPOCHS] [-b BATCH_SIZE] [--lr LR]
                     [--weight-decay WEIGHT_DECAY] [--print_every PRINT_EVERY]
                     [--fine_tune] [--temp TEMP] [--cosine] [--warm]
                     [--lr_decay_epochs LR_DECAY_EPOCHS]
                     [--lr_decay_rate LR_DECAY_RATE] [--layers LAYERS]
                     [--depth DEPTH] [--width WIDTH] [--growth GROWTH]
                     [--droprate DROPRATE] [--save-path SAVE_PATH]
                     [--load-path LOAD_PATH] [--reduce REDUCE] [--score SCORE]
                     [--threshold THRESHOLD] [--k K] [--momentum MOMENTUM]
                     [--proto_m PROTO_M] [--cache-size CACHE_SIZE]
                     [--nviews NVIEWS] [--lambda_pcon LAMBDA_PCON]
                     [--epsilon EPSILON] [--incremental] [--use_lora]
                     [--lora_impl {native,peft}] [--lora_r LORA_R]
                     [--lora_alpha LORA_ALPHA] [--lora_dropout LORA_DROPOUT]
                     [--lora_target {head,encoder,both}]
                     [--adapter_save_path ADAPTER_SAVE_PATH]
                     [--adapter_load_path ADAPTER_LOAD_PATH]
                     [--forget_classes FORGET_CLASSES]
                     [--forget_list_path FORGET_LIST_PATH]
                     [--forget_center_set {all,retain}]
                     [--forget_lambda FORGET_LAMBDA]
                     [--forget_margin FORGET_MARGIN]
                     [--centers_path CENTERS_PATH]
                     [--precision_path PRECISION_PATH]
                     [--batch_forget_mode {none,balanced,proportional,retain_only}]
eval_cifar.py: error: argument --forget_center_set: invalid choice: '0' (choose from 'all', 'retain')
