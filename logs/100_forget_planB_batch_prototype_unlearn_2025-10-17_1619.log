nohup: ignoring input
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:54: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.1, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter', adapter_load_path=None, forget_classes='0,8,11,40,51,66,67,88,94,57', forget_list_path=None, forget_lambda=1.0, forget_margin=100.0, centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=True, forget_attr_w=0.25, forget_proto_rep_w=2.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:108: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [00:14<11:59, 14.69s/it]  4%|▍         | 2/50 [00:26<10:12, 12.77s/it]  6%|▌         | 3/50 [00:37<09:31, 12.16s/it]  8%|▊         | 4/50 [00:48<09:00, 11.75s/it] 10%|█         | 5/50 [00:59<08:37, 11.49s/it] 12%|█▏        | 6/50 [01:11<08:25, 11.49s/it] 14%|█▍        | 7/50 [01:22<08:06, 11.32s/it][loss] ep 0 it 0 total=25.8818 mle=1.4969 pcon=5.2950 forget=6.6280 nr=64 nf=64 protos=540 fproto_sim=-0.0242156982421875
[loss] ep 0 it 50 total=26.0777 mle=1.4711 pcon=5.2879 forget=6.6889 nr=64 nf=64 protos=540 fproto_sim=-0.032562255859375
[loss] ep 0 it 100 total=25.9681 mle=1.5969 pcon=5.2809 forget=6.6243 nr=64 nf=64 protos=540 fproto_sim=-0.03155517578125
[loss] ep 0 it 150 total=26.1533 mle=1.7520 pcon=5.2738 forget=6.6055 nr=64 nf=64 protos=540 fproto_sim=-0.0309600830078125
[loss] ep 0 it 200 total=25.9756 mle=1.6199 pcon=5.2670 forget=6.6484 nr=64 nf=64 protos=540 fproto_sim=-0.029754638671875
[loss] ep 0 it 250 total=25.6917 mle=1.4374 pcon=5.2603 forget=6.6411 nr=64 nf=64 protos=540 fproto_sim=-0.032135009765625
[loss] ep 0 it 300 total=25.8106 mle=1.4844 pcon=5.2540 forget=6.6427 nr=64 nf=64 protos=540 fproto_sim=-0.0272369384765625
[loss] ep 0 it 350 total=26.0120 mle=1.5889 pcon=5.2476 forget=6.6605 nr=64 nf=64 protos=540 fproto_sim=-0.034423828125
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 1 it 10 total=26.1175 mle=1.5755 pcon=5.2409 forget=6.7248 nr=64 nf=64 protos=540 fproto_sim=-0.03656005859375
[loss] ep 1 it 60 total=25.7163 mle=1.5658 pcon=5.2346 forget=6.6005 nr=64 nf=64 protos=540 fproto_sim=-0.0311126708984375
[loss] ep 1 it 110 total=25.8477 mle=1.4493 pcon=5.2285 forget=6.6530 nr=64 nf=64 protos=540 fproto_sim=-0.0306396484375
[loss] ep 1 it 160 total=26.0154 mle=1.6639 pcon=5.2225 forget=6.6616 nr=64 nf=64 protos=540 fproto_sim=-0.0333251953125
[loss] ep 1 it 210 total=25.9287 mle=1.6526 pcon=5.2167 forget=6.6434 nr=64 nf=64 protos=540 fproto_sim=-0.034881591796875
[loss] ep 1 it 260 total=25.6568 mle=1.5319 pcon=5.2113 forget=6.6033 nr=64 nf=64 protos=540 fproto_sim=-0.0299224853515625
[loss] ep 1 it 310 total=25.8063 mle=1.6303 pcon=5.2057 forget=6.6171 nr=64 nf=64 protos=540 fproto_sim=-0.028656005859375
[loss] ep 1 it 360 total=25.8781 mle=1.6855 pcon=5.2004 forget=6.6368 nr=64 nf=64 protos=540 fproto_sim=-0.03302001953125
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 2 it 20 total=25.5648 mle=1.4943 pcon=5.1952 forget=6.6143 nr=64 nf=64 protos=540 fproto_sim=-0.0325927734375
[loss] ep 2 it 70 total=25.6959 mle=1.7517 pcon=5.1902 forget=6.5567 nr=64 nf=64 protos=540 fproto_sim=-0.033203125
[loss] ep 2 it 120 total=25.6579 mle=1.6380 pcon=5.1850 forget=6.6121 nr=64 nf=64 protos=540 fproto_sim=-0.0272979736328125
[loss] ep 2 it 170 total=25.4305 mle=1.4605 pcon=5.1800 forget=6.5832 nr=64 nf=64 protos=540 fproto_sim=-0.0301513671875
[loss] ep 2 it 220 total=25.5885 mle=1.5217 pcon=5.1750 forget=6.6135 nr=64 nf=64 protos=540 fproto_sim=-0.037445068359375
[loss] ep 2 it 270 total=25.7001 mle=1.7624 pcon=5.1704 forget=6.5765 nr=64 nf=64 protos=540 fproto_sim=-0.0291290283203125
[loss] ep 2 it 320 total=25.3849 mle=1.5214 pcon=5.1657 forget=6.5361 nr=64 nf=64 protos=540 fproto_sim=-0.03167724609375
[loss] ep 2 it 370 total=25.6738 mle=1.7208 pcon=5.1611 forget=6.5341 nr=64 nf=64 protos=540 fproto_sim=-0.026397705078125
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 3 it 30 total=25.5216 mle=1.6339 pcon=5.1566 forget=6.5451 nr=64 nf=64 protos=540 fproto_sim=-0.0306549072265625
[loss] ep 3 it 80 total=25.4865 mle=1.5823 pcon=5.1526 forget=6.5709 nr=64 nf=64 protos=540 fproto_sim=-0.027801513671875
[loss] ep 3 it 130 total=25.5529 mle=1.6636 pcon=5.1483 forget=6.5253 nr=64 nf=64 protos=540 fproto_sim=-0.0246429443359375
[loss] ep 3 it 180 total=25.6774 mle=1.7995 pcon=5.1444 forget=6.5002 nr=64 nf=64 protos=540 fproto_sim=-0.0244140625
[loss] ep 3 it 230 total=25.4285 mle=1.5003 pcon=5.1404 forget=6.5031 nr=64 nf=64 protos=540 fproto_sim=-0.0250244140625
[loss] ep 3 it 280 total=25.7239 mle=1.7382 pcon=5.1363 forget=6.5081 nr=64 nf=64 protos=540 fproto_sim=-0.0235443115234375
[loss] ep 3 it 330 total=25.6855 mle=1.6268 pcon=5.1322 forget=6.5495 nr=64 nf=64 protos=540 fproto_sim=-0.020721435546875
[loss] ep 3 it 380 total=25.6850 mle=1.5907 pcon=5.1288 forget=6.5421 nr=64 nf=64 protos=540 fproto_sim=-0.016387939453125
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 4 it 40 total=25.6802 mle=1.5718 pcon=5.1251 forget=6.4960 nr=64 nf=64 protos=540 fproto_sim=-0.012176513671875
[loss] ep 4 it 90 total=25.8821 mle=1.6531 pcon=5.1214 forget=6.5308 nr=64 nf=64 protos=540 fproto_sim=-0.01111602783203125
[loss] ep 4 it 140 total=25.9243 mle=1.5920 pcon=5.1180 forget=6.5651 nr=64 nf=64 protos=540 fproto_sim=-0.006771087646484375
[loss] ep 4 it 190 total=25.8645 mle=1.4161 pcon=5.1149 forget=6.6005 nr=64 nf=64 protos=540 fproto_sim=-0.0015888214111328125
[loss] ep 4 it 240 total=26.1921 mle=1.6784 pcon=5.1115 forget=6.5884 nr=64 nf=64 protos=540 fproto_sim=0.006439208984375
[loss] ep 4 it 290 total=26.0981 mle=1.4540 pcon=5.1084 forget=6.6295 nr=64 nf=64 protos=540 fproto_sim=0.0110321044921875
[loss] ep 4 it 340 total=26.6223 mle=1.8466 pcon=5.1055 forget=6.6683 nr=64 nf=64 protos=540 fproto_sim=0.01389312744140625
[loss] ep 5 it 0 total=26.7120 mle=1.8042 pcon=5.1028 forget=6.6975 nr=64 nf=64 protos=540 fproto_sim=0.0162811279296875
[loss] ep 5 it 50 total=26.7438 mle=1.7237 pcon=5.0998 forget=6.7133 nr=64 nf=64 protos=540 fproto_sim=0.0261383056640625
[loss] ep 5 it 100 total=26.7230 mle=1.5579 pcon=5.0973 forget=6.7676 nr=64 nf=64 protos=540 fproto_sim=0.02606201171875
[loss] ep 5 it 150 total=26.8368 mle=1.5343 pcon=5.0945 forget=6.8083 nr=64 nf=64 protos=540 fproto_sim=0.032196044921875
[loss] ep 5 it 200 total=27.0232 mle=1.6161 pcon=5.0923 forget=6.8201 nr=64 nf=64 protos=540 fproto_sim=0.0352783203125
[loss] ep 5 it 250 total=27.2149 mle=1.7052 pcon=5.0900 forget=6.8460 nr=64 nf=64 protos=540 fproto_sim=0.041015625
[loss] ep 5 it 300 total=27.1395 mle=1.5302 pcon=5.0877 forget=6.8776 nr=64 nf=64 protos=540 fproto_sim=0.043853759765625
[loss] ep 5 it 350 total=27.3413 mle=1.6659 pcon=5.0854 forget=6.8914 nr=64 nf=64 protos=540 fproto_sim=0.042816162109375
[loss] ep 6 it 10 total=27.1971 mle=1.4191 pcon=5.0831 forget=6.9611 nr=64 nf=64 protos=540 fproto_sim=0.0433349609375
[loss] ep 6 it 60 total=27.1967 mle=1.5152 pcon=5.0809 forget=6.8748 nr=64 nf=64 protos=540 fproto_sim=0.04425048828125
[loss] ep 6 it 110 total=27.1121 mle=1.5626 pcon=5.0786 forget=6.8704 nr=64 nf=64 protos=540 fproto_sim=0.038787841796875
[loss] ep 6 it 160 total=26.9319 mle=1.6694 pcon=5.0760 forget=6.7861 nr=64 nf=64 protos=540 fproto_sim=0.0312347412109375
[loss] ep 6 it 210 total=26.4162 mle=1.5961 pcon=5.0736 forget=6.6673 nr=64 nf=64 protos=540 fproto_sim=0.0160369873046875
[loss] ep 6 it 260 total=25.9014 mle=1.7327 pcon=5.0703 forget=6.4909 nr=64 nf=64 protos=540 fproto_sim=-0.0016717910766601562
[loss] ep 6 it 310 total=25.1557 mle=1.5467 pcon=5.0671 forget=6.3328 nr=64 nf=64 protos=540 fproto_sim=-0.018402099609375
[loss] ep 6 it 360 total=24.9838 mle=1.6801 pcon=5.0635 forget=6.2309 nr=64 nf=64 protos=540 fproto_sim=-0.0252685546875
[loss] ep 7 it 20 total=24.8900 mle=1.7211 pcon=5.0596 forget=6.1830 nr=64 nf=64 protos=540 fproto_sim=-0.0288543701171875
[loss] ep 7 it 70 total=25.0069 mle=1.7870 pcon=5.0561 forget=6.1968 nr=64 nf=64 protos=540 fproto_sim=-0.027313232421875
[loss] ep 7 it 120 total=25.0424 mle=1.7102 pcon=5.0525 forget=6.2316 nr=64 nf=64 protos=540 fproto_sim=-0.024078369140625
[loss] ep 7 it 170 total=25.0951 mle=1.6044 pcon=5.0491 forget=6.2804 nr=64 nf=64 protos=540 fproto_sim=-0.01983642578125
[loss] ep 7 it 220 total=25.3214 mle=1.6480 pcon=5.0463 forget=6.3406 nr=64 nf=64 protos=540 fproto_sim=-0.01377105712890625
 16%|█▌        | 8/50 [01:33<07:55, 11.32s/it] 18%|█▊        | 9/50 [01:45<07:48, 11.43s/it] 20%|██        | 10/50 [01:56<07:30, 11.25s/it] 22%|██▏       | 11/50 [02:07<07:16, 11.20s/it] 24%|██▍       | 12/50 [02:18<07:02, 11.12s/it] 26%|██▌       | 13/50 [02:28<06:48, 11.04s/it] 28%|██▊       | 14/50 [02:40<06:38, 11.08s/it] 30%|███       | 15/50 [02:51<06:29, 11.12s/it][loss] ep 7 it 270 total=25.5669 mle=1.7309 pcon=5.0434 forget=6.3967 nr=64 nf=64 protos=540 fproto_sim=-0.00923919677734375
[loss] ep 7 it 320 total=25.6380 mle=1.6742 pcon=5.0405 forget=6.4251 nr=64 nf=64 protos=540 fproto_sim=-0.005123138427734375
[loss] ep 7 it 370 total=25.7188 mle=1.6205 pcon=5.0380 forget=6.4707 nr=64 nf=64 protos=540 fproto_sim=-0.0006222724914550781
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 8 it 30 total=25.7449 mle=1.5277 pcon=5.0358 forget=6.5257 nr=64 nf=64 protos=540 fproto_sim=0.00311279296875
[loss] ep 8 it 80 total=25.8337 mle=1.5838 pcon=5.0336 forget=6.5123 nr=64 nf=64 protos=540 fproto_sim=0.004638671875
[loss] ep 8 it 130 total=25.7320 mle=1.4840 pcon=5.0313 forget=6.5230 nr=64 nf=64 protos=540 fproto_sim=0.006031036376953125
[loss] ep 8 it 180 total=25.8590 mle=1.6436 pcon=5.0293 forget=6.5083 nr=64 nf=64 protos=540 fproto_sim=0.004901885986328125
[loss] ep 8 it 230 total=25.6107 mle=1.5010 pcon=5.0277 forget=6.4724 nr=64 nf=64 protos=540 fproto_sim=0.003253936767578125
[loss] ep 8 it 280 total=25.5838 mle=1.6187 pcon=5.0256 forget=6.4279 nr=64 nf=64 protos=540 fproto_sim=-0.0005011558532714844
[loss] ep 8 it 330 total=25.5958 mle=1.7060 pcon=5.0234 forget=6.4238 nr=64 nf=64 protos=540 fproto_sim=-0.0033359527587890625
[loss] ep 8 it 380 total=25.1805 mle=1.4723 pcon=5.0214 forget=6.3517 nr=64 nf=64 protos=540 fproto_sim=-0.00814056396484375
[loss] ep 9 it 40 total=25.1855 mle=1.6114 pcon=5.0193 forget=6.3013 nr=64 nf=64 protos=540 fproto_sim=-0.0113525390625
[loss] ep 9 it 90 total=25.2261 mle=1.6878 pcon=5.0170 forget=6.3023 nr=64 nf=64 protos=540 fproto_sim=-0.01309967041015625
[loss] ep 9 it 140 total=25.2579 mle=1.7151 pcon=5.0152 forget=6.3137 nr=64 nf=64 protos=540 fproto_sim=-0.01428985595703125
[loss] ep 9 it 190 total=25.1074 mle=1.5873 pcon=5.0134 forget=6.2906 nr=64 nf=64 protos=540 fproto_sim=-0.0124053955078125
[loss] ep 9 it 240 total=25.1511 mle=1.5652 pcon=5.0116 forget=6.3170 nr=64 nf=64 protos=540 fproto_sim=-0.0117950439453125
[loss] ep 9 it 290 total=25.2662 mle=1.5965 pcon=5.0096 forget=6.3434 nr=64 nf=64 protos=540 fproto_sim=-0.008514404296875
[loss] ep 9 it 340 total=25.3366 mle=1.5614 pcon=5.0079 forget=6.3711 nr=64 nf=64 protos=540 fproto_sim=-0.004955291748046875
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 10 it 0 total=25.5262 mle=1.6056 pcon=5.0062 forget=6.4230 nr=64 nf=64 protos=540 fproto_sim=-0.0009517669677734375
[loss] ep 10 it 50 total=25.6316 mle=1.5607 pcon=5.0045 forget=6.4710 nr=64 nf=64 protos=540 fproto_sim=0.00458526611328125
[loss] ep 10 it 100 total=25.9237 mle=1.7162 pcon=5.0030 forget=6.5064 nr=64 nf=64 protos=540 fproto_sim=0.009674072265625
[loss] ep 10 it 150 total=26.1400 mle=1.7727 pcon=5.0018 forget=6.5538 nr=64 nf=64 protos=540 fproto_sim=0.01531982421875
[loss] ep 10 it 200 total=26.2989 mle=1.7873 pcon=5.0005 forget=6.5980 nr=64 nf=64 protos=540 fproto_sim=0.019866943359375
[loss] ep 10 it 250 total=26.2437 mle=1.5844 pcon=4.9994 forget=6.6466 nr=64 nf=64 protos=540 fproto_sim=0.024871826171875
[loss] ep 10 it 300 total=26.3509 mle=1.5604 pcon=4.9985 forget=6.6889 nr=64 nf=64 protos=540 fproto_sim=0.029052734375
[loss] ep 10 it 350 total=26.5330 mle=1.6113 pcon=4.9975 forget=6.7567 nr=64 nf=64 protos=540 fproto_sim=0.032073974609375
[loss] ep 11 it 10 total=26.5265 mle=1.5528 pcon=4.9964 forget=6.7529 nr=64 nf=64 protos=540 fproto_sim=0.03497314453125
[loss] ep 11 it 60 total=26.6304 mle=1.6466 pcon=4.9953 forget=6.7441 nr=64 nf=64 protos=540 fproto_sim=0.036895751953125
[loss] ep 11 it 110 total=26.5524 mle=1.5876 pcon=4.9944 forget=6.7384 nr=64 nf=64 protos=540 fproto_sim=0.03582763671875
[loss] ep 11 it 160 total=26.5314 mle=1.6192 pcon=4.9930 forget=6.7313 nr=64 nf=64 protos=540 fproto_sim=0.0333251953125
[loss] ep 11 it 210 total=26.5353 mle=1.7096 pcon=4.9920 forget=6.7029 nr=64 nf=64 protos=540 fproto_sim=0.031158447265625
[loss] ep 11 it 260 total=26.2850 mle=1.6112 pcon=4.9912 forget=6.6621 nr=64 nf=64 protos=540 fproto_sim=0.0245361328125
[loss] ep 11 it 310 total=26.3604 mle=1.8849 pcon=4.9897 forget=6.5952 nr=64 nf=64 protos=540 fproto_sim=0.0177764892578125
[loss] ep 11 it 360 total=25.9100 mle=1.6334 pcon=4.9883 forget=6.5252 nr=64 nf=64 protos=540 fproto_sim=0.01187896728515625
[loss] ep 12 it 20 total=25.6025 mle=1.5544 pcon=4.9866 forget=6.4538 nr=64 nf=64 protos=540 fproto_sim=0.0046234130859375
[loss] ep 12 it 70 total=25.5679 mle=1.6785 pcon=4.9849 forget=6.4097 nr=64 nf=64 protos=540 fproto_sim=-0.0005426406860351562
[loss] ep 12 it 120 total=25.2512 mle=1.5617 pcon=4.9832 forget=6.3547 nr=64 nf=64 protos=540 fproto_sim=-0.00847625732421875
[loss] ep 12 it 170 total=25.2585 mle=1.7225 pcon=4.9814 forget=6.2873 nr=64 nf=64 protos=540 fproto_sim=-0.0111846923828125
[loss] ep 12 it 220 total=25.0775 mle=1.6240 pcon=4.9793 forget=6.2655 nr=64 nf=64 protos=540 fproto_sim=-0.01377105712890625
[loss] ep 12 it 270 total=24.9643 mle=1.5669 pcon=4.9778 forget=6.2542 nr=64 nf=64 protos=540 fproto_sim=-0.0157318115234375
[loss] ep 12 it 320 total=24.9130 mle=1.5259 pcon=4.9758 forget=6.2515 nr=64 nf=64 protos=540 fproto_sim=-0.015716552734375
[loss] ep 12 it 370 total=25.1639 mle=1.8002 pcon=4.9737 forget=6.2414 nr=64 nf=64 protos=540 fproto_sim=-0.015655517578125
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 13 it 30 total=24.8566 mle=1.4404 pcon=4.9718 forget=6.2578 nr=64 nf=64 protos=540 fproto_sim=-0.01373291015625
[loss] ep 13 it 80 total=24.9666 mle=1.4917 pcon=4.9699 forget=6.2926 nr=64 nf=64 protos=540 fproto_sim=-0.0124359130859375
[loss] ep 13 it 130 total=25.0773 mle=1.5471 pcon=4.9678 forget=6.3004 nr=64 nf=64 protos=540 fproto_sim=-0.00991058349609375
[loss] ep 13 it 180 total=25.1851 mle=1.5783 pcon=4.9660 forget=6.3237 nr=64 nf=64 protos=540 fproto_sim=-0.006572723388671875
[loss] ep 13 it 230 total=25.3008 mle=1.6101 pcon=4.9642 forget=6.3487 nr=64 nf=64 protos=540 fproto_sim=-0.00360107421875
[loss] ep 13 it 280 total=25.2944 mle=1.5437 pcon=4.9624 forget=6.3604 nr=64 nf=64 protos=540 fproto_sim=-0.0005941390991210938
[loss] ep 13 it 330 total=25.4014 mle=1.5546 pcon=4.9606 forget=6.4086 nr=64 nf=64 protos=540 fproto_sim=0.0011425018310546875
[loss] ep 13 it 380 total=25.4456 mle=1.5473 pcon=4.9588 forget=6.4150 nr=64 nf=64 protos=540 fproto_sim=0.003742218017578125
[loss] ep 14 it 40 total=25.7689 mle=1.7959 pcon=4.9568 forget=6.4363 nr=64 nf=64 protos=540 fproto_sim=0.0059661865234375
[loss] ep 14 it 90 total=25.7646 mle=1.7272 pcon=4.9554 forget=6.4562 nr=64 nf=64 protos=540 fproto_sim=0.00855255126953125
[loss] ep 14 it 140 total=25.6866 mle=1.5801 pcon=4.9541 forget=6.4818 nr=64 nf=64 protos=540 fproto_sim=0.0106048583984375
[loss] ep 14 it 190 total=25.9544 mle=1.7863 pcon=4.9522 forget=6.5005 nr=64 nf=64 protos=540 fproto_sim=0.01311492919921875
[loss] ep 14 it 240 total=25.7804 mle=1.5740 pcon=4.9508 forget=6.5154 nr=64 nf=64 protos=540 fproto_sim=0.01404571533203125
[loss] ep 14 it 290 total=25.8506 mle=1.6135 pcon=4.9491 forget=6.5193 nr=64 nf=64 protos=540 fproto_sim=0.015533447265625
[loss] ep 14 it 340 total=25.9233 mle=1.6560 pcon=4.9474 forget=6.5306 nr=64 nf=64 protos=540 fproto_sim=0.0155181884765625
[loss] ep 15 it 0 total=25.9391 mle=1.6406 pcon=4.9458 forget=6.5503 nr=64 nf=64 protos=540 fproto_sim=0.0162506103515625
[loss] ep 15 it 50 total=25.7931 mle=1.5018 pcon=4.9440 forget=6.5404 nr=64 nf=64 protos=540 fproto_sim=0.0169830322265625
[loss] ep 15 it 100 total=25.8429 mle=1.5587 pcon=4.9423 forget=6.5417 nr=64 nf=64 protos=540 fproto_sim=0.0164337158203125
[loss] ep 15 it 150 total=25.9572 mle=1.6788 pcon=4.9406 forget=6.5472 nr=64 nf=64 protos=540 fproto_sim=0.01522064208984375
 32%|███▏      | 16/50 [03:02<06:21, 11.22s/it] 34%|███▍      | 17/50 [03:14<06:11, 11.27s/it] 36%|███▌      | 18/50 [03:25<06:03, 11.36s/it] 38%|███▊      | 19/50 [03:36<05:51, 11.34s/it] 40%|████      | 20/50 [03:48<05:41, 11.37s/it] 42%|████▏     | 21/50 [03:59<05:30, 11.38s/it] 44%|████▍     | 22/50 [04:11<05:19, 11.42s/it] 46%|████▌     | 23/50 [04:22<05:08, 11.43s/it][loss] ep 15 it 200 total=25.8507 mle=1.5944 pcon=4.9389 forget=6.5335 nr=64 nf=64 protos=540 fproto_sim=0.01528167724609375
[loss] ep 15 it 250 total=26.0450 mle=1.8404 pcon=4.9372 forget=6.5140 nr=64 nf=64 protos=540 fproto_sim=0.01392364501953125
[loss] ep 15 it 300 total=25.7394 mle=1.5594 pcon=4.9357 forget=6.5135 nr=64 nf=64 protos=540 fproto_sim=0.01299285888671875
[loss] ep 15 it 350 total=25.7086 mle=1.5222 pcon=4.9341 forget=6.5294 nr=64 nf=64 protos=540 fproto_sim=0.01220703125
[loss] ep 16 it 10 total=25.6621 mle=1.5670 pcon=4.9325 forget=6.4920 nr=64 nf=64 protos=540 fproto_sim=0.00911712646484375
[loss] ep 16 it 60 total=25.6285 mle=1.5244 pcon=4.9312 forget=6.4846 nr=64 nf=64 protos=540 fproto_sim=0.01055908203125
[loss] ep 16 it 110 total=25.7052 mle=1.5891 pcon=4.9300 forget=6.4880 nr=64 nf=64 protos=540 fproto_sim=0.0107421875
[loss] ep 16 it 160 total=25.8120 mle=1.6407 pcon=4.9285 forget=6.5063 nr=64 nf=64 protos=540 fproto_sim=0.012237548828125
[loss] ep 16 it 210 total=25.7850 mle=1.5796 pcon=4.9271 forget=6.5092 nr=64 nf=64 protos=540 fproto_sim=0.01412200927734375
[loss] ep 16 it 260 total=26.1952 mle=1.8608 pcon=4.9257 forget=6.5645 nr=64 nf=64 protos=540 fproto_sim=0.0175628662109375
[loss] ep 16 it 310 total=26.1742 mle=1.7862 pcon=4.9246 forget=6.5713 nr=64 nf=64 protos=540 fproto_sim=0.0195159912109375
[loss] ep 16 it 360 total=26.1124 mle=1.6174 pcon=4.9233 forget=6.6050 nr=64 nf=64 protos=540 fproto_sim=0.022613525390625
[loss] ep 17 it 20 total=26.3162 mle=1.7199 pcon=4.9217 forget=6.6436 nr=64 nf=64 protos=540 fproto_sim=0.02557373046875
[loss] ep 17 it 70 total=26.4377 mle=1.7653 pcon=4.9207 forget=6.6546 nr=64 nf=64 protos=540 fproto_sim=0.028289794921875
[loss] ep 17 it 120 total=26.3440 mle=1.5775 pcon=4.9192 forget=6.6992 nr=64 nf=64 protos=540 fproto_sim=0.02996826171875
[loss] ep 17 it 170 total=26.4177 mle=1.5769 pcon=4.9173 forget=6.7324 nr=64 nf=64 protos=540 fproto_sim=0.031585693359375
[loss] ep 17 it 220 total=26.4695 mle=1.6118 pcon=4.9156 forget=6.7329 nr=64 nf=64 protos=540 fproto_sim=0.03125
[loss] ep 17 it 270 total=26.3522 mle=1.4826 pcon=4.9142 forget=6.7306 nr=64 nf=64 protos=540 fproto_sim=0.031524658203125
[loss] ep 17 it 320 total=26.6096 mle=1.7484 pcon=4.9122 forget=6.7286 nr=64 nf=64 protos=540 fproto_sim=0.0306396484375
[loss] ep 17 it 370 total=26.5376 mle=1.6955 pcon=4.9097 forget=6.7213 nr=64 nf=64 protos=540 fproto_sim=0.02978515625
[loss] ep 18 it 30 total=26.3439 mle=1.5559 pcon=4.9078 forget=6.7047 nr=64 nf=64 protos=540 fproto_sim=0.02777099609375
[loss] ep 18 it 80 total=26.3403 mle=1.6291 pcon=4.9053 forget=6.6872 nr=64 nf=64 protos=540 fproto_sim=0.024505615234375
[loss] ep 18 it 130 total=26.2646 mle=1.6410 pcon=4.9026 forget=6.6674 nr=64 nf=64 protos=540 fproto_sim=0.0215301513671875
[loss] ep 18 it 180 total=26.0376 mle=1.5499 pcon=4.8998 forget=6.6137 nr=64 nf=64 protos=540 fproto_sim=0.018585205078125
[loss] ep 18 it 230 total=25.9976 mle=1.6180 pcon=4.8969 forget=6.5826 nr=64 nf=64 protos=540 fproto_sim=0.0156402587890625
[loss] ep 18 it 280 total=25.8556 mle=1.6243 pcon=4.8938 forget=6.5368 nr=64 nf=64 protos=540 fproto_sim=0.01166534423828125
[loss] ep 18 it 330 total=25.8106 mle=1.7274 pcon=4.8907 forget=6.4848 nr=64 nf=64 protos=540 fproto_sim=0.0085906982421875
[loss] ep 18 it 380 total=25.6781 mle=1.7073 pcon=4.8877 forget=6.4547 nr=64 nf=64 protos=540 fproto_sim=0.005157470703125
[loss] ep 19 it 40 total=25.3561 mle=1.5262 pcon=4.8846 forget=6.4212 nr=64 nf=64 protos=540 fproto_sim=0.0009684562683105469
[loss] ep 19 it 90 total=25.4038 mle=1.6694 pcon=4.8814 forget=6.3952 nr=64 nf=64 protos=540 fproto_sim=-0.000946044921875
[loss] ep 19 it 140 total=25.1920 mle=1.5660 pcon=4.8780 forget=6.3533 nr=64 nf=64 protos=540 fproto_sim=-0.00335693359375
[loss] ep 19 it 190 total=25.1828 mle=1.6536 pcon=4.8745 forget=6.3139 nr=64 nf=64 protos=540 fproto_sim=-0.00522613525390625
[loss] ep 19 it 240 total=25.2783 mle=1.8192 pcon=4.8712 forget=6.2936 nr=64 nf=64 protos=540 fproto_sim=-0.00690460205078125
[loss] ep 19 it 290 total=25.1152 mle=1.6557 pcon=4.8681 forget=6.3043 nr=64 nf=64 protos=540 fproto_sim=-0.00751495361328125
[loss] ep 19 it 340 total=24.9643 mle=1.5436 pcon=4.8649 forget=6.2910 nr=64 nf=64 protos=540 fproto_sim=-0.0080108642578125
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 20 it 0 total=25.0540 mle=1.6684 pcon=4.8616 forget=6.2809 nr=64 nf=64 protos=540 fproto_sim=-0.0085296630859375
[loss] ep 20 it 50 total=25.0350 mle=1.6482 pcon=4.8584 forget=6.2762 nr=64 nf=64 protos=540 fproto_sim=-0.00806427001953125
[loss] ep 20 it 100 total=25.1407 mle=1.7122 pcon=4.8554 forget=6.3060 nr=64 nf=64 protos=540 fproto_sim=-0.0081024169921875
[loss] ep 20 it 150 total=25.2231 mle=1.7928 pcon=4.8521 forget=6.2928 nr=64 nf=64 protos=540 fproto_sim=-0.00689697265625
[loss] ep 20 it 200 total=25.0427 mle=1.5793 pcon=4.8490 forget=6.3047 nr=64 nf=64 protos=540 fproto_sim=-0.00557708740234375
[loss] ep 20 it 250 total=25.3712 mle=1.8734 pcon=4.8459 forget=6.3135 nr=64 nf=64 protos=540 fproto_sim=-0.004150390625
[loss] ep 20 it 300 total=25.3418 mle=1.7749 pcon=4.8430 forget=6.3492 nr=64 nf=64 protos=540 fproto_sim=-0.0030612945556640625
[loss] ep 20 it 350 total=25.1334 mle=1.4994 pcon=4.8402 forget=6.3630 nr=64 nf=64 protos=540 fproto_sim=-0.0001277923583984375
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 21 it 10 total=25.2286 mle=1.5057 pcon=4.8377 forget=6.3925 nr=64 nf=64 protos=540 fproto_sim=0.0025310516357421875
[loss] ep 21 it 60 total=25.4520 mle=1.6365 pcon=4.8352 forget=6.4284 nr=64 nf=64 protos=540 fproto_sim=0.005130767822265625
[loss] ep 21 it 110 total=25.4904 mle=1.5881 pcon=4.8330 forget=6.4535 nr=64 nf=64 protos=540 fproto_sim=0.007793426513671875
[loss] ep 21 it 160 total=25.5874 mle=1.6006 pcon=4.8309 forget=6.4761 nr=64 nf=64 protos=540 fproto_sim=0.0111846923828125
[loss] ep 21 it 210 total=25.8719 mle=1.7656 pcon=4.8289 forget=6.5190 nr=64 nf=64 protos=540 fproto_sim=0.01419830322265625
[loss] ep 21 it 260 total=25.8807 mle=1.6711 pcon=4.8269 forget=6.5488 nr=64 nf=64 protos=540 fproto_sim=0.0175323486328125
[loss] ep 21 it 310 total=25.8939 mle=1.5749 pcon=4.8248 forget=6.5870 nr=64 nf=64 protos=540 fproto_sim=0.0210113525390625
[loss] ep 21 it 360 total=26.0400 mle=1.5930 pcon=4.8229 forget=6.6458 nr=64 nf=64 protos=540 fproto_sim=0.0238494873046875
[loss] ep 22 it 20 total=26.1911 mle=1.6501 pcon=4.8211 forget=6.6645 nr=64 nf=64 protos=540 fproto_sim=0.0272979736328125
[loss] ep 22 it 70 total=26.3160 mle=1.6928 pcon=4.8193 forget=6.6832 nr=64 nf=64 protos=540 fproto_sim=0.030517578125
[loss] ep 22 it 120 total=26.3515 mle=1.6012 pcon=4.8175 forget=6.7442 nr=64 nf=64 protos=540 fproto_sim=0.03253173828125
[loss] ep 22 it 170 total=26.4547 mle=1.6404 pcon=4.8159 forget=6.7509 nr=64 nf=64 protos=540 fproto_sim=0.035400390625
[loss] ep 22 it 220 total=26.5038 mle=1.6058 pcon=4.8145 forget=6.7723 nr=64 nf=64 protos=540 fproto_sim=0.037994384765625
[loss] ep 22 it 270 total=26.4755 mle=1.5211 pcon=4.8129 forget=6.7998 nr=64 nf=64 protos=540 fproto_sim=0.038604736328125
[loss] ep 22 it 320 total=26.7185 mle=1.7118 pcon=4.8115 forget=6.8091 nr=64 nf=64 protos=540 fproto_sim=0.040802001953125
[loss] ep 22 it 370 total=26.9777 mle=1.9266 pcon=4.8099 forget=6.8309 nr=64 nf=64 protos=540 fproto_sim=0.041748046875
[loss] ep 23 it 30 total=26.5817 mle=1.5293 pcon=4.8088 forget=6.8277 nr=64 nf=64 protos=540 fproto_sim=0.04150390625
[loss] ep 23 it 80 total=26.6944 mle=1.6553 pcon=4.8072 forget=6.8184 nr=64 nf=64 protos=540 fproto_sim=0.040924072265625
[loss] ep 23 it 130 total=26.5985 mle=1.5702 pcon=4.8056 forget=6.8180 nr=64 nf=64 protos=540 fproto_sim=0.040771484375
[loss] ep 23 it 180 total=26.6858 mle=1.7185 pcon=4.8039 forget=6.7990 nr=64 nf=64 protos=540 fproto_sim=0.03912353515625
 48%|████▊     | 24/50 [04:34<04:58, 11.49s/it] 50%|█████     | 25/50 [04:46<04:48, 11.54s/it] 52%|█████▏    | 26/50 [04:57<04:36, 11.51s/it] 54%|█████▍    | 27/50 [05:08<04:24, 11.50s/it] 56%|█████▌    | 28/50 [05:20<04:12, 11.49s/it] 58%|█████▊    | 29/50 [05:31<04:00, 11.44s/it] 60%|██████    | 30/50 [05:43<03:50, 11.51s/it] 62%|██████▏   | 31/50 [05:54<03:37, 11.45s/it][loss] ep 23 it 230 total=26.5163 mle=1.6232 pcon=4.8024 forget=6.7814 nr=64 nf=64 protos=540 fproto_sim=0.03643798828125
[loss] ep 23 it 280 total=26.3937 mle=1.6019 pcon=4.8007 forget=6.7446 nr=64 nf=64 protos=540 fproto_sim=0.033935546875
[loss] ep 23 it 330 total=26.3117 mle=1.6227 pcon=4.7990 forget=6.7175 nr=64 nf=64 protos=540 fproto_sim=0.0305023193359375
[loss] ep 23 it 380 total=26.1585 mle=1.5901 pcon=4.7973 forget=6.6827 nr=64 nf=64 protos=540 fproto_sim=0.02655029296875
[loss] ep 24 it 40 total=25.9961 mle=1.5694 pcon=4.7958 forget=6.6301 nr=64 nf=64 protos=540 fproto_sim=0.0233306884765625
[loss] ep 24 it 90 total=25.8791 mle=1.6173 pcon=4.7942 forget=6.5791 nr=64 nf=64 protos=540 fproto_sim=0.0178985595703125
[loss] ep 24 it 140 total=25.7311 mle=1.5687 pcon=4.7924 forget=6.5496 nr=64 nf=64 protos=540 fproto_sim=0.01471710205078125
[loss] ep 24 it 190 total=25.5346 mle=1.6223 pcon=4.7908 forget=6.4651 nr=64 nf=64 protos=540 fproto_sim=0.00733184814453125
[loss] ep 24 it 240 total=25.2567 mle=1.5069 pcon=4.7891 forget=6.4141 nr=64 nf=64 protos=540 fproto_sim=0.002353668212890625
[loss] ep 24 it 290 total=25.3105 mle=1.7166 pcon=4.7875 forget=6.3648 nr=64 nf=64 protos=540 fproto_sim=-0.0026111602783203125
[loss] ep 24 it 340 total=25.0759 mle=1.6052 pcon=4.7857 forget=6.3238 nr=64 nf=64 protos=540 fproto_sim=-0.006282806396484375
[loss] ep 25 it 0 total=24.8800 mle=1.6009 pcon=4.7839 forget=6.2662 nr=64 nf=64 protos=540 fproto_sim=-0.0130615234375
[loss] ep 25 it 50 total=24.9171 mle=1.7294 pcon=4.7824 forget=6.2545 nr=64 nf=64 protos=540 fproto_sim=-0.016876220703125
[loss] ep 25 it 100 total=24.6351 mle=1.6087 pcon=4.7806 forget=6.1838 nr=64 nf=64 protos=540 fproto_sim=-0.0211181640625
[loss] ep 25 it 150 total=24.6898 mle=1.7544 pcon=4.7792 forget=6.1547 nr=64 nf=64 protos=540 fproto_sim=-0.0241851806640625
[loss] ep 25 it 200 total=24.6421 mle=1.8144 pcon=4.7774 forget=6.1343 nr=64 nf=64 protos=540 fproto_sim=-0.028961181640625
[loss] ep 25 it 250 total=24.5194 mle=1.7059 pcon=4.7756 forget=6.1463 nr=64 nf=64 protos=540 fproto_sim=-0.0301361083984375
[loss] ep 25 it 300 total=24.4175 mle=1.6554 pcon=4.7739 forget=6.1147 nr=64 nf=64 protos=540 fproto_sim=-0.03125
[loss] ep 25 it 350 total=24.3041 mle=1.5862 pcon=4.7726 forget=6.0983 nr=64 nf=64 protos=540 fproto_sim=-0.03289794921875
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 26 it 10 total=24.2933 mle=1.6057 pcon=4.7710 forget=6.0897 nr=64 nf=64 protos=540 fproto_sim=-0.033843994140625
[loss] ep 26 it 60 total=24.3470 mle=1.6173 pcon=4.7695 forget=6.1046 nr=64 nf=64 protos=540 fproto_sim=-0.03271484375
[loss] ep 26 it 110 total=24.4236 mle=1.6817 pcon=4.7681 forget=6.1039 nr=64 nf=64 protos=540 fproto_sim=-0.03204345703125
[loss] ep 26 it 160 total=24.3457 mle=1.5557 pcon=4.7667 forget=6.1203 nr=64 nf=64 protos=540 fproto_sim=-0.0305938720703125
[loss] ep 26 it 210 total=24.5423 mle=1.6740 pcon=4.7652 forget=6.1452 nr=64 nf=64 protos=540 fproto_sim=-0.02825927734375
[loss] ep 26 it 260 total=24.5708 mle=1.5812 pcon=4.7641 forget=6.2014 nr=64 nf=64 protos=540 fproto_sim=-0.0255126953125
[loss] ep 26 it 310 total=24.9011 mle=1.8618 pcon=4.7630 forget=6.1932 nr=64 nf=64 protos=540 fproto_sim=-0.0230255126953125
[loss] ep 26 it 360 total=24.7515 mle=1.6085 pcon=4.7619 forget=6.2297 nr=64 nf=64 protos=540 fproto_sim=-0.0201568603515625
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
[loss] ep 27 it 20 total=24.8803 mle=1.6509 pcon=4.7609 forget=6.2555 nr=64 nf=64 protos=540 fproto_sim=-0.016998291015625
[loss] ep 27 it 70 total=24.9436 mle=1.5935 pcon=4.7599 forget=6.3061 nr=64 nf=64 protos=540 fproto_sim=-0.0141448974609375
[loss] ep 27 it 120 total=25.0143 mle=1.5745 pcon=4.7589 forget=6.3264 nr=64 nf=64 protos=540 fproto_sim=-0.01177978515625
[loss] ep 27 it 170 total=25.1324 mle=1.5825 pcon=4.7579 forget=6.3647 nr=64 nf=64 protos=540 fproto_sim=-0.00823211669921875
[loss] ep 27 it 220 total=25.1762 mle=1.5471 pcon=4.7570 forget=6.3832 nr=64 nf=64 protos=540 fproto_sim=-0.005558013916015625
[loss] ep 27 it 270 total=25.3430 mle=1.6057 pcon=4.7561 forget=6.4211 nr=64 nf=64 protos=540 fproto_sim=-0.0028896331787109375
[loss] ep 27 it 320 total=25.5176 mle=1.7144 pcon=4.7553 forget=6.4421 nr=64 nf=64 protos=540 fproto_sim=-0.0010175704956054688
[loss] ep 27 it 370 total=25.6706 mle=1.7543 pcon=4.7545 forget=6.4825 nr=64 nf=64 protos=540 fproto_sim=0.0018930435180664062
[loss] ep 28 it 30 total=25.6370 mle=1.6751 pcon=4.7538 forget=6.4916 nr=64 nf=64 protos=540 fproto_sim=0.0028743743896484375
[loss] ep 28 it 80 total=25.7672 mle=1.6921 pcon=4.7531 forget=6.5373 nr=64 nf=64 protos=540 fproto_sim=0.00592803955078125
[loss] ep 28 it 130 total=25.7333 mle=1.5929 pcon=4.7524 forget=6.5540 nr=64 nf=64 protos=540 fproto_sim=0.007755279541015625
[loss] ep 28 it 180 total=25.8062 mle=1.6022 pcon=4.7516 forget=6.5684 nr=64 nf=64 protos=540 fproto_sim=0.01019287109375
[loss] ep 28 it 230 total=25.7369 mle=1.4660 pcon=4.7504 forget=6.5928 nr=64 nf=64 protos=540 fproto_sim=0.0110931396484375
[loss] ep 28 it 280 total=25.9178 mle=1.5856 pcon=4.7494 forget=6.6222 nr=64 nf=64 protos=540 fproto_sim=0.01218414306640625
[loss] ep 28 it 330 total=26.2190 mle=1.8210 pcon=4.7482 forget=6.6369 nr=64 nf=64 protos=540 fproto_sim=0.0144805908203125
[loss] ep 28 it 380 total=26.1486 mle=1.7092 pcon=4.7471 forget=6.6527 nr=64 nf=64 protos=540 fproto_sim=0.01560211181640625
[loss] ep 29 it 40 total=26.1893 mle=1.7236 pcon=4.7459 forget=6.6576 nr=64 nf=64 protos=540 fproto_sim=0.0159149169921875
[loss] ep 29 it 90 total=26.1542 mle=1.6236 pcon=4.7446 forget=6.6924 nr=64 nf=64 protos=540 fproto_sim=0.0178985595703125
[loss] ep 29 it 140 total=26.2067 mle=1.6475 pcon=4.7436 forget=6.6943 nr=64 nf=64 protos=540 fproto_sim=0.01885986328125
[loss] ep 29 it 190 total=26.1970 mle=1.6187 pcon=4.7424 forget=6.6965 nr=64 nf=64 protos=540 fproto_sim=0.0196685791015625
[loss] ep 29 it 240 total=26.1951 mle=1.5675 pcon=4.7414 forget=6.7224 nr=64 nf=64 protos=540 fproto_sim=0.0202789306640625
[loss] ep 29 it 290 total=26.3610 mle=1.7420 pcon=4.7404 forget=6.7054 nr=64 nf=64 protos=540 fproto_sim=0.021514892578125
[loss] ep 29 it 340 total=26.2408 mle=1.5942 pcon=4.7394 forget=6.7283 nr=64 nf=64 protos=540 fproto_sim=0.0220184326171875
[loss] ep 30 it 0 total=26.3147 mle=1.6601 pcon=4.7382 forget=6.7291 nr=64 nf=64 protos=540 fproto_sim=0.02252197265625
[loss] ep 30 it 50 total=26.3676 mle=1.6860 pcon=4.7372 forget=6.7415 nr=64 nf=64 protos=540 fproto_sim=0.022979736328125
[loss] ep 30 it 100 total=26.2558 mle=1.5894 pcon=4.7362 forget=6.7270 nr=64 nf=64 protos=540 fproto_sim=0.0235595703125
[loss] ep 30 it 150 total=26.4572 mle=1.7868 pcon=4.7350 forget=6.7220 nr=64 nf=64 protos=540 fproto_sim=0.0242462158203125
[loss] ep 30 it 200 total=26.2056 mle=1.5061 pcon=4.7339 forget=6.7480 nr=64 nf=64 protos=540 fproto_sim=0.0243682861328125
[loss] ep 30 it 250 total=26.5113 mle=1.7927 pcon=4.7327 forget=6.7523 nr=64 nf=64 protos=540 fproto_sim=0.02520751953125
[loss] ep 30 it 300 total=26.2306 mle=1.5290 pcon=4.7317 forget=6.7440 nr=64 nf=64 protos=540 fproto_sim=0.025177001953125
[loss] ep 30 it 350 total=26.4246 mle=1.7385 pcon=4.7306 forget=6.7363 nr=64 nf=64 protos=540 fproto_sim=0.024993896484375
[loss] ep 31 it 10 total=26.3106 mle=1.6295 pcon=4.7296 forget=6.7395 nr=64 nf=64 protos=540 fproto_sim=0.0254364013671875
[loss] ep 31 it 60 total=26.2494 mle=1.5888 pcon=4.7286 forget=6.7262 nr=64 nf=64 protos=540 fproto_sim=0.0254058837890625
[loss] ep 31 it 110 total=26.2754 mle=1.6351 pcon=4.7275 forget=6.7243 nr=64 nf=64 protos=540 fproto_sim=0.0249176025390625
[loss] ep 31 it 160 total=26.2389 mle=1.6044 pcon=4.7264 forget=6.7290 nr=64 nf=64 protos=540 fproto_sim=0.02490234375
[loss] ep 31 it 210 total=26.1807 mle=1.5835 pcon=4.7254 forget=6.7066 nr=64 nf=64 protos=540 fproto_sim=0.0250701904296875
 64%|██████▍   | 32/50 [06:06<03:25, 11.42s/it] 66%|██████▌   | 33/50 [06:17<03:13, 11.36s/it] 68%|██████▊   | 34/50 [06:28<03:02, 11.43s/it] 70%|███████   | 35/50 [06:40<02:51, 11.43s/it] 72%|███████▏  | 36/50 [06:51<02:39, 11.39s/it] 74%|███████▍  | 37/50 [07:02<02:27, 11.34s/it] 76%|███████▌  | 38/50 [07:14<02:16, 11.39s/it] 78%|███████▊  | 39/50 [07:25<02:05, 11.42s/it] 80%|████████  | 40/50 [07:37<01:54, 11.42s/it][loss] ep 31 it 260 total=26.1401 mle=1.5399 pcon=4.7243 forget=6.7096 nr=64 nf=64 protos=540 fproto_sim=0.0247650146484375
[loss] ep 31 it 310 total=26.2254 mle=1.6247 pcon=4.7232 forget=6.7205 nr=64 nf=64 protos=540 fproto_sim=0.02459716796875
[loss] ep 31 it 360 total=26.1161 mle=1.5598 pcon=4.7221 forget=6.6930 nr=64 nf=64 protos=540 fproto_sim=0.0249786376953125
[loss] ep 32 it 20 total=26.2745 mle=1.7179 pcon=4.7211 forget=6.7010 nr=64 nf=64 protos=540 fproto_sim=0.0246429443359375
[loss] ep 32 it 70 total=26.0960 mle=1.5776 pcon=4.7199 forget=6.6827 nr=64 nf=64 protos=540 fproto_sim=0.02386474609375
[loss] ep 32 it 120 total=26.2248 mle=1.6480 pcon=4.7189 forget=6.7162 nr=64 nf=64 protos=540 fproto_sim=0.0239715576171875
[loss] ep 32 it 170 total=26.0969 mle=1.5606 pcon=4.7182 forget=6.7025 nr=64 nf=64 protos=540 fproto_sim=0.023040771484375
[loss] ep 32 it 220 total=26.1861 mle=1.6966 pcon=4.7174 forget=6.6720 nr=64 nf=64 protos=540 fproto_sim=0.02301025390625
[loss] ep 32 it 270 total=26.1071 mle=1.6219 pcon=4.7167 forget=6.6812 nr=64 nf=64 protos=540 fproto_sim=0.02294921875
[loss] ep 32 it 320 total=26.0410 mle=1.5358 pcon=4.7159 forget=6.6826 nr=64 nf=64 protos=540 fproto_sim=0.02386474609375
[loss] ep 32 it 370 total=26.0445 mle=1.5091 pcon=4.7155 forget=6.6912 nr=64 nf=64 protos=540 fproto_sim=0.023529052734375
[loss] ep 33 it 30 total=26.2268 mle=1.6774 pcon=4.7149 forget=6.7071 nr=64 nf=64 protos=540 fproto_sim=0.0240478515625
[loss] ep 33 it 80 total=26.4358 mle=1.9177 pcon=4.7144 forget=6.6874 nr=64 nf=64 protos=540 fproto_sim=0.0252685546875
[loss] ep 33 it 130 total=26.1214 mle=1.5534 pcon=4.7139 forget=6.6988 nr=64 nf=64 protos=540 fproto_sim=0.02545166015625
[loss] ep 33 it 180 total=26.3620 mle=1.7170 pcon=4.7135 forget=6.7436 nr=64 nf=64 protos=540 fproto_sim=0.0267486572265625
[loss] ep 33 it 230 total=26.2995 mle=1.6631 pcon=4.7132 forget=6.7289 nr=64 nf=64 protos=540 fproto_sim=0.02886962890625
[loss] ep 33 it 280 total=26.4295 mle=1.7311 pcon=4.7129 forget=6.7476 nr=64 nf=64 protos=540 fproto_sim=0.02880859375
[loss] ep 33 it 330 total=26.4606 mle=1.7073 pcon=4.7128 forget=6.7585 nr=64 nf=64 protos=540 fproto_sim=0.0311431884765625
[loss] ep 33 it 380 total=26.4474 mle=1.6386 pcon=4.7126 forget=6.7874 nr=64 nf=64 protos=540 fproto_sim=0.03131103515625
[loss] ep 34 it 40 total=26.5802 mle=1.7254 pcon=4.7123 forget=6.7951 nr=64 nf=64 protos=540 fproto_sim=0.032806396484375
[loss] ep 34 it 90 total=26.4582 mle=1.5575 pcon=4.7121 forget=6.8099 nr=64 nf=64 protos=540 fproto_sim=0.034515380859375
[loss] ep 34 it 140 total=26.6172 mle=1.6705 pcon=4.7121 forget=6.8182 nr=64 nf=64 protos=540 fproto_sim=0.03619384765625
[loss] ep 34 it 190 total=26.7116 mle=1.7071 pcon=4.7121 forget=6.8367 nr=64 nf=64 protos=540 fproto_sim=0.036773681640625
[loss] ep 34 it 240 total=26.7863 mle=1.7234 pcon=4.7121 forget=6.8554 nr=64 nf=64 protos=540 fproto_sim=0.037261962890625
[loss] ep 34 it 290 total=26.7817 mle=1.6604 pcon=4.7121 forget=6.8785 nr=64 nf=64 protos=540 fproto_sim=0.038238525390625
[loss] ep 34 it 340 total=26.8191 mle=1.6408 pcon=4.7122 forget=6.9019 nr=64 nf=64 protos=540 fproto_sim=0.0386962890625
[loss] ep 35 it 0 total=26.8733 mle=1.6604 pcon=4.7122 forget=6.9043 nr=64 nf=64 protos=540 fproto_sim=0.03985595703125
[loss] ep 35 it 50 total=26.8681 mle=1.5990 pcon=4.7124 forget=6.9321 nr=64 nf=64 protos=540 fproto_sim=0.041015625
[loss] ep 35 it 100 total=27.1543 mle=1.8000 pcon=4.7123 forget=6.9684 nr=64 nf=64 protos=540 fproto_sim=0.042266845703125
[loss] ep 35 it 150 total=26.9700 mle=1.6369 pcon=4.7124 forget=6.9464 nr=64 nf=64 protos=540 fproto_sim=0.041839599609375
[loss] ep 35 it 200 total=26.9435 mle=1.5854 pcon=4.7125 forget=6.9548 nr=64 nf=64 protos=540 fproto_sim=0.041900634765625
[loss] ep 35 it 250 total=27.1321 mle=1.7273 pcon=4.7125 forget=6.9770 nr=64 nf=64 protos=540 fproto_sim=0.042449951171875
[loss] ep 35 it 300 total=26.9812 mle=1.5699 pcon=4.7125 forget=6.9699 nr=64 nf=64 protos=540 fproto_sim=0.042816162109375
[loss] ep 35 it 350 total=27.1731 mle=1.7277 pcon=4.7125 forget=6.9867 nr=64 nf=64 protos=540 fproto_sim=0.04290771484375
[loss] ep 36 it 10 total=27.1866 mle=1.7450 pcon=4.7126 forget=6.9780 nr=64 nf=64 protos=540 fproto_sim=0.042755126953125
[loss] ep 36 it 60 total=27.0007 mle=1.5634 pcon=4.7127 forget=6.9783 nr=64 nf=64 protos=540 fproto_sim=0.04248046875
[loss] ep 36 it 110 total=27.0261 mle=1.5972 pcon=4.7127 forget=6.9751 nr=64 nf=64 protos=540 fproto_sim=0.0411376953125
[loss] ep 36 it 160 total=27.0880 mle=1.6720 pcon=4.7125 forget=6.9714 nr=64 nf=64 protos=540 fproto_sim=0.040557861328125
[loss] ep 36 it 210 total=26.9690 mle=1.5737 pcon=4.7125 forget=6.9642 nr=64 nf=64 protos=540 fproto_sim=0.039337158203125
[loss] ep 36 it 260 total=27.0577 mle=1.6356 pcon=4.7125 forget=6.9889 nr=64 nf=64 protos=540 fproto_sim=0.03955078125
[loss] ep 36 it 310 total=27.0848 mle=1.6755 pcon=4.7123 forget=6.9890 nr=64 nf=64 protos=540 fproto_sim=0.038970947265625
[loss] ep 36 it 360 total=26.9880 mle=1.6469 pcon=4.7121 forget=6.9443 nr=64 nf=64 protos=540 fproto_sim=0.037109375
[loss] ep 37 it 20 total=26.8466 mle=1.5304 pcon=4.7116 forget=6.9435 nr=64 nf=64 protos=540 fproto_sim=0.036224365234375
[loss] ep 37 it 70 total=26.9762 mle=1.7118 pcon=4.7115 forget=6.9293 nr=64 nf=64 protos=540 fproto_sim=0.034423828125
[loss] ep 37 it 120 total=26.8314 mle=1.6488 pcon=4.7112 forget=6.9001 nr=64 nf=64 protos=540 fproto_sim=0.03179931640625
[loss] ep 37 it 170 total=26.7954 mle=1.6200 pcon=4.7108 forget=6.8997 nr=64 nf=64 protos=540 fproto_sim=0.03204345703125
[loss] ep 37 it 220 total=26.8301 mle=1.7264 pcon=4.7103 forget=6.8759 nr=64 nf=64 protos=540 fproto_sim=0.028900146484375
[loss] ep 37 it 270 total=26.6658 mle=1.6296 pcon=4.7099 forget=6.8472 nr=64 nf=64 protos=540 fproto_sim=0.0278167724609375
[loss] ep 37 it 320 total=26.6273 mle=1.6561 pcon=4.7095 forget=6.8328 nr=64 nf=64 protos=540 fproto_sim=0.0255279541015625
[loss] ep 37 it 370 total=26.5769 mle=1.6496 pcon=4.7092 forget=6.8358 nr=64 nf=64 protos=540 fproto_sim=0.0222625732421875
[loss] ep 38 it 30 total=26.5794 mle=1.6895 pcon=4.7090 forget=6.8275 nr=64 nf=64 protos=540 fproto_sim=0.0218048095703125
[loss] ep 38 it 80 total=26.3218 mle=1.5295 pcon=4.7086 forget=6.7753 nr=64 nf=64 protos=540 fproto_sim=0.0204620361328125
[loss] ep 38 it 130 total=26.3990 mle=1.6707 pcon=4.7082 forget=6.7574 nr=64 nf=64 protos=540 fproto_sim=0.0181427001953125
[loss] ep 38 it 180 total=26.2776 mle=1.6119 pcon=4.7077 forget=6.7350 nr=64 nf=64 protos=540 fproto_sim=0.0161895751953125
[loss] ep 38 it 230 total=26.1035 mle=1.5559 pcon=4.7072 forget=6.6965 nr=64 nf=64 protos=540 fproto_sim=0.01319122314453125
[loss] ep 38 it 280 total=26.1961 mle=1.6873 pcon=4.7068 forget=6.6836 nr=64 nf=64 protos=540 fproto_sim=0.0128631591796875
[loss] ep 38 it 330 total=25.9896 mle=1.5991 pcon=4.7062 forget=6.6504 nr=64 nf=64 protos=540 fproto_sim=0.00853729248046875
[loss] ep 38 it 380 total=25.8167 mle=1.5052 pcon=4.7058 forget=6.6187 nr=64 nf=64 protos=540 fproto_sim=0.006198883056640625
[loss] ep 39 it 40 total=26.0101 mle=1.7544 pcon=4.7055 forget=6.5982 nr=64 nf=64 protos=540 fproto_sim=0.00550079345703125
[loss] ep 39 it 90 total=25.6848 mle=1.6518 pcon=4.7050 forget=6.5380 nr=64 nf=64 protos=540 fproto_sim=-0.002758026123046875
[loss] ep 39 it 140 total=25.7613 mle=1.6552 pcon=4.7045 forget=6.5601 nr=64 nf=64 protos=540 fproto_sim=-0.00031828880310058594
[loss] ep 39 it 190 total=25.4642 mle=1.5195 pcon=4.7040 forget=6.5000 nr=64 nf=64 protos=540 fproto_sim=-0.0041351318359375
[loss] ep 39 it 240 total=25.5244 mle=1.6582 pcon=4.7036 forget=6.4872 nr=64 nf=64 protos=540 fproto_sim=-0.007678985595703125
[loss] ep 39 it 290 total=25.4038 mle=1.5337 pcon=4.7031 forget=6.4879 nr=64 nf=64 protos=540 fproto_sim=-0.007472991943359375
[loss] ep 39 it 340 total=25.4021 mle=1.6191 pcon=4.7027 forget=6.4659 nr=64 nf=64 protos=540 fproto_sim=-0.01007080078125
[loss] ep 40 it 0 total=25.2790 mle=1.5730 pcon=4.7021 forget=6.4412 nr=64 nf=64 protos=540 fproto_sim=-0.01251220703125
 82%|████████▏ | 41/50 [07:48<01:41, 11.32s/it] 84%|████████▍ | 42/50 [07:59<01:30, 11.31s/it] 86%|████████▌ | 43/50 [08:11<01:19, 11.33s/it] 88%|████████▊ | 44/50 [08:22<01:07, 11.32s/it] 90%|█████████ | 45/50 [08:33<00:56, 11.30s/it] 92%|█████████▏| 46/50 [08:45<00:45, 11.35s/it] 94%|█████████▍| 47/50 [08:56<00:34, 11.36s/it] 96%|█████████▌| 48/50 [09:07<00:22, 11.31s/it][loss] ep 40 it 50 total=25.3169 mle=1.6357 pcon=4.7017 forget=6.4291 nr=64 nf=64 protos=540 fproto_sim=-0.01282501220703125
[loss] ep 40 it 100 total=25.3445 mle=1.6563 pcon=4.7010 forget=6.4291 nr=64 nf=64 protos=540 fproto_sim=-0.013092041015625
[loss] ep 40 it 150 total=25.2318 mle=1.5396 pcon=4.7006 forget=6.4265 nr=64 nf=64 protos=540 fproto_sim=-0.0124359130859375
[loss] ep 40 it 200 total=25.4575 mle=1.7567 pcon=4.7002 forget=6.4506 nr=64 nf=64 protos=540 fproto_sim=-0.01373291015625
[loss] ep 40 it 250 total=25.4098 mle=1.8149 pcon=4.6998 forget=6.4174 nr=64 nf=64 protos=540 fproto_sim=-0.0166015625
[loss] ep 40 it 300 total=25.2749 mle=1.6076 pcon=4.6996 forget=6.4213 nr=64 nf=64 protos=540 fproto_sim=-0.01361846923828125
[loss] ep 40 it 350 total=25.0678 mle=1.4628 pcon=4.6994 forget=6.4002 nr=64 nf=64 protos=540 fproto_sim=-0.01560211181640625
[loss] ep 41 it 10 total=25.1898 mle=1.5492 pcon=4.6993 forget=6.4119 nr=64 nf=64 protos=540 fproto_sim=-0.01386260986328125
[loss] ep 41 it 60 total=25.5122 mle=1.8546 pcon=4.6993 forget=6.4470 nr=64 nf=64 protos=540 fproto_sim=-0.01534271240234375
[loss] ep 41 it 110 total=25.2722 mle=1.6383 pcon=4.6991 forget=6.4168 nr=64 nf=64 protos=540 fproto_sim=-0.01485443115234375
[loss] ep 41 it 160 total=25.3496 mle=1.6484 pcon=4.6992 forget=6.4462 nr=64 nf=64 protos=540 fproto_sim=-0.013916015625
[loss] ep 41 it 210 total=25.3616 mle=1.6736 pcon=4.6993 forget=6.4294 nr=64 nf=64 protos=540 fproto_sim=-0.01378631591796875
[loss] ep 41 it 260 total=25.2678 mle=1.5501 pcon=4.6996 forget=6.4321 nr=64 nf=64 protos=540 fproto_sim=-0.0126953125
[loss] ep 41 it 310 total=25.3050 mle=1.5524 pcon=4.7000 forget=6.4465 nr=64 nf=64 protos=540 fproto_sim=-0.0121307373046875
[loss] ep 41 it 360 total=25.4595 mle=1.6717 pcon=4.7002 forget=6.4599 nr=64 nf=64 protos=540 fproto_sim=-0.01087188720703125
[loss] ep 42 it 20 total=25.5370 mle=1.6773 pcon=4.7005 forget=6.5051 nr=64 nf=64 protos=540 fproto_sim=-0.01094818115234375
[loss] ep 42 it 70 total=25.5331 mle=1.6678 pcon=4.7006 forget=6.4920 nr=64 nf=64 protos=540 fproto_sim=-0.00997161865234375
[loss] ep 42 it 120 total=25.8105 mle=1.9044 pcon=4.7008 forget=6.5040 nr=64 nf=64 protos=540 fproto_sim=-0.0096282958984375
[loss] ep 42 it 170 total=25.5426 mle=1.6196 pcon=4.7012 forget=6.4966 nr=64 nf=64 protos=540 fproto_sim=-0.00959014892578125
[loss] ep 42 it 220 total=25.5834 mle=1.6220 pcon=4.7016 forget=6.5129 nr=64 nf=64 protos=540 fproto_sim=-0.00867462158203125
[loss] ep 42 it 270 total=25.7459 mle=1.7570 pcon=4.7020 forget=6.5214 nr=64 nf=64 protos=540 fproto_sim=-0.00878143310546875
[loss] ep 42 it 320 total=25.7489 mle=1.6927 pcon=4.7025 forget=6.5449 nr=64 nf=64 protos=540 fproto_sim=-0.005245208740234375
[loss] ep 42 it 370 total=25.7358 mle=1.6525 pcon=4.7029 forget=6.5494 nr=64 nf=64 protos=540 fproto_sim=-0.005870819091796875
[loss] ep 43 it 30 total=25.7856 mle=1.6251 pcon=4.7033 forget=6.5788 nr=64 nf=64 protos=540 fproto_sim=-0.003093719482421875
[loss] ep 43 it 80 total=25.7355 mle=1.5832 pcon=4.7036 forget=6.5737 nr=64 nf=64 protos=540 fproto_sim=-0.004833221435546875
[loss] ep 43 it 130 total=25.9060 mle=1.6801 pcon=4.7040 forget=6.6012 nr=64 nf=64 protos=540 fproto_sim=-0.0023212432861328125
[loss] ep 43 it 180 total=25.8483 mle=1.5619 pcon=4.7045 forget=6.6197 nr=64 nf=64 protos=540 fproto_sim=0.0005354881286621094
[loss] ep 43 it 230 total=25.8114 mle=1.5577 pcon=4.7047 forget=6.6003 nr=64 nf=64 protos=540 fproto_sim=-0.0018873214721679688
[loss] ep 43 it 280 total=25.8626 mle=1.5519 pcon=4.7052 forget=6.6150 nr=64 nf=64 protos=540 fproto_sim=-0.0014238357543945312
[loss] ep 43 it 330 total=25.9356 mle=1.5447 pcon=4.7054 forget=6.6529 nr=64 nf=64 protos=540 fproto_sim=0.0014257431030273438
[loss] ep 43 it 380 total=25.8928 mle=1.5464 pcon=4.7057 forget=6.6259 nr=64 nf=64 protos=540 fproto_sim=-0.00048828125
[loss] ep 44 it 40 total=26.1701 mle=1.7208 pcon=4.7060 forget=6.6661 nr=64 nf=64 protos=540 fproto_sim=0.0011882781982421875
[loss] ep 44 it 90 total=26.1193 mle=1.6393 pcon=4.7063 forget=6.6717 nr=64 nf=64 protos=540 fproto_sim=0.0032138824462890625
[loss] ep 44 it 140 total=26.1867 mle=1.6534 pcon=4.7067 forget=6.6956 nr=64 nf=64 protos=540 fproto_sim=0.0036830902099609375
[loss] ep 44 it 190 total=26.1333 mle=1.5593 pcon=4.7070 forget=6.7015 nr=64 nf=64 protos=540 fproto_sim=0.00586700439453125
[loss] ep 44 it 240 total=26.1833 mle=1.5578 pcon=4.7074 forget=6.7333 nr=64 nf=64 protos=540 fproto_sim=0.0053253173828125
[loss] ep 44 it 290 total=26.4499 mle=1.8131 pcon=4.7077 forget=6.7287 nr=64 nf=64 protos=540 fproto_sim=0.006282806396484375
[loss] ep 44 it 340 total=26.4712 mle=1.7711 pcon=4.7080 forget=6.7424 nr=64 nf=64 protos=540 fproto_sim=0.0072021484375
[loss] ep 45 it 0 total=26.3331 mle=1.5693 pcon=4.7082 forget=6.7695 nr=64 nf=64 protos=540 fproto_sim=0.00875091552734375
[loss] ep 45 it 50 total=26.3750 mle=1.5928 pcon=4.7084 forget=6.7646 nr=64 nf=64 protos=540 fproto_sim=0.0092010498046875
[loss] ep 45 it 100 total=26.4097 mle=1.5816 pcon=4.7086 forget=6.7765 nr=64 nf=64 protos=540 fproto_sim=0.01049041748046875
[loss] ep 45 it 150 total=26.3960 mle=1.5584 pcon=4.7088 forget=6.7934 nr=64 nf=64 protos=540 fproto_sim=0.00952911376953125
[loss] ep 45 it 200 total=26.5408 mle=1.6042 pcon=4.7090 forget=6.8295 nr=64 nf=64 protos=540 fproto_sim=0.01267242431640625
[loss] ep 45 it 250 total=26.5554 mle=1.5832 pcon=4.7092 forget=6.8298 nr=64 nf=64 protos=540 fproto_sim=0.0138397216796875
[loss] ep 45 it 300 total=26.6100 mle=1.6366 pcon=4.7092 forget=6.8255 nr=64 nf=64 protos=540 fproto_sim=0.01435089111328125
[loss] ep 45 it 350 total=26.5399 mle=1.5293 pcon=4.7094 forget=6.8425 nr=64 nf=64 protos=540 fproto_sim=0.0144195556640625
[loss] ep 46 it 10 total=26.6506 mle=1.5147 pcon=4.7096 forget=6.8777 nr=64 nf=64 protos=540 fproto_sim=0.018035888671875
[loss] ep 46 it 60 total=26.6999 mle=1.5403 pcon=4.7097 forget=6.8894 nr=64 nf=64 protos=540 fproto_sim=0.018707275390625
[loss] ep 46 it 110 total=26.9399 mle=1.7178 pcon=4.7098 forget=6.9071 nr=64 nf=64 protos=540 fproto_sim=0.0197601318359375
[loss] ep 46 it 160 total=26.7641 mle=1.5303 pcon=4.7099 forget=6.9161 nr=64 nf=64 protos=540 fproto_sim=0.019866943359375
[loss] ep 46 it 210 total=27.0617 mle=1.7562 pcon=4.7099 forget=6.9299 nr=64 nf=64 protos=540 fproto_sim=0.0217742919921875
[loss] ep 46 it 260 total=27.0047 mle=1.6788 pcon=4.7100 forget=6.9392 nr=64 nf=64 protos=540 fproto_sim=0.022216796875
[loss] ep 46 it 310 total=27.0001 mle=1.5710 pcon=4.7101 forget=6.9724 nr=64 nf=64 protos=540 fproto_sim=0.02423095703125
[loss] ep 46 it 360 total=27.2018 mle=1.7185 pcon=4.7101 forget=6.9894 nr=64 nf=64 protos=540 fproto_sim=0.02557373046875
[loss] ep 47 it 20 total=27.0798 mle=1.5930 pcon=4.7100 forget=6.9896 nr=64 nf=64 protos=540 fproto_sim=0.025360107421875
[loss] ep 47 it 70 total=27.1092 mle=1.5822 pcon=4.7101 forget=7.0100 nr=64 nf=64 protos=540 fproto_sim=0.02752685546875
[loss] ep 47 it 120 total=27.3557 mle=1.6993 pcon=4.7100 forget=7.0437 nr=64 nf=64 protos=540 fproto_sim=0.0297088623046875
[loss] ep 47 it 170 total=27.3159 mle=1.5749 pcon=4.7098 forget=7.0880 nr=64 nf=64 protos=540 fproto_sim=0.030120849609375
[loss] ep 47 it 220 total=27.2324 mle=1.4816 pcon=4.7099 forget=7.0799 nr=64 nf=64 protos=540 fproto_sim=0.031219482421875
[loss] ep 47 it 270 total=27.5678 mle=1.6337 pcon=4.7100 forget=7.1342 nr=64 nf=64 protos=540 fproto_sim=0.033782958984375
[loss] ep 47 it 320 total=27.5725 mle=1.6317 pcon=4.7100 forget=7.1391 nr=64 nf=64 protos=540 fproto_sim=0.03515625
[loss] ep 47 it 370 total=27.5655 mle=1.6491 pcon=4.7100 forget=7.1360 nr=64 nf=64 protos=540 fproto_sim=0.033355712890625
[loss] ep 48 it 30 total=27.6540 mle=1.6172 pcon=4.7102 forget=7.1750 nr=64 nf=64 protos=540 fproto_sim=0.03558349609375
[loss] ep 48 it 80 total=27.7091 mle=1.6242 pcon=4.7101 forget=7.1929 nr=64 nf=64 protos=540 fproto_sim=0.037322998046875
[loss] ep 48 it 130 total=27.7508 mle=1.6521 pcon=4.7102 forget=7.1873 nr=64 nf=64 protos=540 fproto_sim=0.037322998046875
[loss] ep 48 it 180 total=28.0368 mle=1.6710 pcon=4.7103 forget=7.2636 nr=64 nf=64 protos=540 fproto_sim=0.042083740234375
 98%|█████████▊| 49/50 [09:18<00:11, 11.28s/it]100%|██████████| 50/50 [09:30<00:00, 11.31s/it]100%|██████████| 50/50 [09:30<00:00, 11.40s/it]
[loss] ep 48 it 230 total=27.8916 mle=1.6547 pcon=4.7104 forget=7.2280 nr=64 nf=64 protos=540 fproto_sim=0.040802001953125
[loss] ep 48 it 280 total=27.8604 mle=1.5975 pcon=4.7104 forget=7.2345 nr=64 nf=64 protos=540 fproto_sim=0.040771484375
[loss] ep 48 it 330 total=27.9171 mle=1.5830 pcon=4.7104 forget=7.2467 nr=64 nf=64 protos=540 fproto_sim=0.0426025390625
[loss] ep 48 it 380 total=28.0956 mle=1.5706 pcon=4.7103 forget=7.3126 nr=64 nf=64 protos=540 fproto_sim=0.044769287109375
[loss] ep 49 it 40 total=28.2061 mle=1.5945 pcon=4.7104 forget=7.3480 nr=64 nf=64 protos=540 fproto_sim=0.04705810546875
[loss] ep 49 it 90 total=28.3645 mle=1.6267 pcon=4.7105 forget=7.3832 nr=64 nf=64 protos=540 fproto_sim=0.048980712890625
[loss] ep 49 it 140 total=28.4410 mle=1.6369 pcon=4.7105 forget=7.3965 nr=64 nf=64 protos=540 fproto_sim=0.04931640625
[loss] ep 49 it 190 total=28.6174 mle=1.7578 pcon=4.7104 forget=7.4152 nr=64 nf=64 protos=540 fproto_sim=0.05029296875
[loss] ep 49 it 240 total=28.5114 mle=1.6969 pcon=4.7104 forget=7.4063 nr=64 nf=64 protos=540 fproto_sim=0.049591064453125
[loss] ep 49 it 290 total=28.5790 mle=1.6296 pcon=4.7103 forget=7.4505 nr=64 nf=64 protos=540 fproto_sim=0.050933837890625
[loss] ep 49 it 340 total=28.6320 mle=1.5295 pcon=4.7105 forget=7.4916 nr=64 nf=64 protos=540 fproto_sim=0.053680419921875
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2-forget_proto_enable-planB_adapter
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<01:39,  3.91it/s]  3%|▎         | 11/391 [00:00<00:10, 37.78it/s]  5%|▌         | 21/391 [00:00<00:06, 57.78it/s]  8%|▊         | 31/391 [00:00<00:05, 70.34it/s] 10%|█         | 41/391 [00:00<00:04, 77.66it/s] 13%|█▎        | 51/391 [00:00<00:04, 83.44it/s] 16%|█▌        | 61/391 [00:00<00:03, 87.32it/s] 18%|█▊        | 71/391 [00:00<00:03, 89.97it/s] 21%|██        | 81/391 [00:01<00:03, 91.89it/s] 23%|██▎       | 91/391 [00:01<00:03, 93.22it/s] 26%|██▌       | 101/391 [00:01<00:03, 94.10it/s] 28%|██▊       | 111/391 [00:01<00:02, 94.75it/s] 31%|███       | 121/391 [00:01<00:02, 95.27it/s] 34%|███▎      | 131/391 [00:01<00:02, 95.75it/s] 36%|███▌      | 141/391 [00:01<00:02, 96.08it/s] 39%|███▊      | 151/391 [00:01<00:02, 96.26it/s] 41%|████      | 161/391 [00:01<00:02, 96.47it/s] 44%|████▎     | 171/391 [00:02<00:02, 96.56it/s] 46%|████▋     | 181/391 [00:02<00:02, 96.38it/s] 49%|████▉     | 191/391 [00:02<00:02, 96.37it/s] 51%|█████▏    | 201/391 [00:02<00:01, 96.45it/s] 54%|█████▍    | 211/391 [00:02<00:01, 96.14it/s] 57%|█████▋    | 221/391 [00:02<00:01, 96.12it/s] 59%|█████▉    | 231/391 [00:02<00:01, 96.36it/s] 62%|██████▏   | 241/391 [00:02<00:01, 96.32it/s] 64%|██████▍   | 251/391 [00:02<00:01, 96.37it/s] 67%|██████▋   | 261/391 [00:02<00:01, 96.30it/s] 69%|██████▉   | 271/391 [00:03<00:01, 96.34it/s] 72%|███████▏  | 281/391 [00:03<00:01, 96.14it/s] 74%|███████▍  | 291/391 [00:03<00:01, 96.29it/s] 77%|███████▋  | 301/391 [00:03<00:00, 96.24it/s] 80%|███████▉  | 311/391 [00:03<00:00, 96.07it/s] 82%|████████▏ | 321/391 [00:03<00:00, 96.12it/s] 85%|████████▍ | 331/391 [00:03<00:00, 96.36it/s] 87%|████████▋ | 341/391 [00:03<00:00, 96.31it/s] 90%|████████▉ | 351/391 [00:03<00:00, 96.40it/s] 92%|█████████▏| 361/391 [00:03<00:00, 96.28it/s] 95%|█████████▍| 371/391 [00:04<00:00, 96.26it/s] 97%|█████████▋| 381/391 [00:04<00:00, 95.70it/s]100%|██████████| 391/391 [00:04<00:00, 94.13it/s]100%|██████████| 391/391 [00:04<00:00, 90.53it/s]
50000 images processed, 4.413180351257324 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:16,  4.63it/s] 14%|█▍        | 11/79 [00:00<00:01, 41.87it/s] 27%|██▋       | 21/79 [00:00<00:00, 61.79it/s] 39%|███▉      | 31/79 [00:00<00:00, 73.65it/s] 52%|█████▏    | 41/79 [00:00<00:00, 81.04it/s] 65%|██████▍   | 51/79 [00:00<00:00, 85.90it/s] 77%|███████▋  | 61/79 [00:00<00:00, 88.77it/s] 90%|████████▉ | 71/79 [00:00<00:00, 91.02it/s]100%|██████████| 79/79 [00:01<00:00, 76.42it/s]
10000 images processed, 1.054582118988037 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<00:47,  4.28it/s]  5%|▌         | 11/204 [00:00<00:04, 39.60it/s] 10%|█         | 21/204 [00:00<00:03, 59.44it/s] 15%|█▌        | 31/204 [00:00<00:02, 71.49it/s] 20%|██        | 41/204 [00:00<00:02, 79.36it/s] 25%|██▌       | 51/204 [00:00<00:01, 84.53it/s] 30%|██▉       | 61/204 [00:00<00:01, 88.03it/s] 35%|███▍      | 71/204 [00:00<00:01, 90.26it/s] 40%|███▉      | 81/204 [00:01<00:01, 91.80it/s] 45%|████▍     | 91/204 [00:01<00:01, 92.93it/s] 50%|████▉     | 101/204 [00:01<00:01, 93.78it/s] 54%|█████▍    | 111/204 [00:01<00:00, 94.05it/s] 59%|█████▉    | 121/204 [00:01<00:00, 94.43it/s] 64%|██████▍   | 131/204 [00:01<00:00, 94.83it/s] 69%|██████▉   | 141/204 [00:01<00:00, 95.02it/s] 74%|███████▍  | 151/204 [00:01<00:00, 95.03it/s] 79%|███████▉  | 161/204 [00:01<00:00, 95.20it/s] 84%|████████▍ | 171/204 [00:02<00:00, 95.36it/s] 89%|████████▊ | 181/204 [00:02<00:00, 95.37it/s] 94%|█████████▎| 191/204 [00:02<00:00, 95.25it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.73it/s]100%|██████████| 204/204 [00:02<00:00, 86.25it/s]
26032 images processed, 2.415426254272461 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:28,  2.69it/s] 11%|█▏        | 9/79 [00:00<00:03, 21.37it/s] 22%|██▏       | 17/79 [00:00<00:01, 33.61it/s] 32%|███▏      | 25/79 [00:00<00:01, 41.95it/s] 42%|████▏     | 33/79 [00:00<00:00, 47.26it/s] 52%|█████▏    | 41/79 [00:01<00:00, 50.94it/s] 62%|██████▏   | 49/79 [00:01<00:00, 51.61it/s] 72%|███████▏  | 57/79 [00:01<00:00, 53.32it/s] 82%|████████▏ | 65/79 [00:01<00:00, 54.79it/s] 92%|█████████▏| 73/79 [00:01<00:00, 55.46it/s]100%|██████████| 79/79 [00:01<00:00, 46.96it/s]
10000 images processed, 1.7173802852630615 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:20,  3.75it/s] 13%|█▎        | 10/79 [00:00<00:02, 32.94it/s] 25%|██▌       | 20/79 [00:00<00:01, 53.85it/s] 38%|███▊      | 30/79 [00:00<00:00, 67.37it/s] 51%|█████     | 40/79 [00:00<00:00, 76.09it/s] 63%|██████▎   | 50/79 [00:00<00:00, 81.45it/s] 76%|███████▌  | 60/79 [00:00<00:00, 85.88it/s] 89%|████████▊ | 70/79 [00:01<00:00, 89.10it/s]100%|██████████| 79/79 [00:01<00:00, 72.38it/s]
10000 images processed, 1.114023208618164 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:21,  3.26it/s] 16%|█▌        | 11/70 [00:00<00:01, 33.12it/s] 30%|███       | 21/70 [00:00<00:00, 52.71it/s] 44%|████▍     | 31/70 [00:00<00:00, 65.57it/s] 59%|█████▊    | 41/70 [00:00<00:00, 74.33it/s] 73%|███████▎  | 51/70 [00:00<00:00, 80.47it/s] 87%|████████▋ | 61/70 [00:00<00:00, 85.20it/s]100%|██████████| 70/70 [00:01<00:00, 67.29it/s]
8925 images processed, 1.0695216655731201 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:31,  1.39it/s] 11%|█         | 5/45 [00:00<00:05,  7.77it/s] 20%|██        | 9/45 [00:01<00:03, 10.59it/s] 24%|██▍       | 11/45 [00:01<00:03, 11.03it/s] 31%|███       | 14/45 [00:01<00:02, 12.23it/s] 38%|███▊      | 17/45 [00:01<00:01, 14.98it/s] 42%|████▏     | 19/45 [00:01<00:01, 15.65it/s] 49%|████▉     | 22/45 [00:01<00:01, 13.82it/s] 58%|█████▊    | 26/45 [00:02<00:01, 16.36it/s] 67%|██████▋   | 30/45 [00:02<00:01, 14.31it/s] 73%|███████▎  | 33/45 [00:02<00:00, 15.26it/s] 78%|███████▊  | 35/45 [00:02<00:00, 15.64it/s] 91%|█████████ | 41/45 [00:03<00:00, 17.11it/s] 96%|█████████▌| 43/45 [00:03<00:00, 13.12it/s]100%|██████████| 45/45 [00:03<00:00, 13.24it/s]
5640 images processed, 3.4287898540496826 seconds used

16.665594816207886
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
Evaluating forget
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.76  98.78
places365     81.22  77.22
LSUN          36.88  93.24
iSUN          83.83  77.29
dtd           48.10  89.08
forget        53.10  89.47
AVG           51.48  87.51
Forget-Acc: 0.7800 | Retain-Acc: 0.7380
Forget-as-OOD (retain known vs forget novel):
  FPR: 53.10 AUROC: 89.47 AUIN: 98.65
7.77790093421936
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl1-lora_r8a32d0.05-fa0.25-fpr2_rf.png
