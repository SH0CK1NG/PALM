nohup: ignoring input
Namespace(in_dataset='CIFAR-10', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=500, batch_size=512, lr=0.5, weight_decay=1e-06, print_every=50, fine_tune=False, temp=0.1, cosine=True, warm=True, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='checkpoints/CIFAR-10-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, incremental=True, residual_space=True, residual_dim=None, residual_mode='dcc', residual_norm='l2', residual_cache='cache', residual_basis_path=None, residual_projector_path='/home/shaokun/PALM/cache/resnet34-supcon/CIFAR-100/residual_projector.pt', save_residual_basis_path=None, save_residual_projector_path=None, argument=True, warmup_from=0.01, warm_epochs=10, warmup_to=0.4995071754249608)
Files already downloaded and verified
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
Traceback (most recent call last):
  File "/home/shaokun/PALM/main.py", line 160, in <module>
    main()
  File "/home/shaokun/PALM/main.py", line 32, in main
    loss_min = np.Inf
UnboundLocalError: local variable 'np' referenced before assignment
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-10-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
Processing in-distribution CIFAR-10 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<01:06,  5.88it/s]  3%|▎         | 10/391 [00:00<00:09, 42.05it/s]  5%|▍         | 18/391 [00:00<00:07, 53.04it/s]  7%|▋         | 28/391 [00:00<00:05, 67.85it/s] 10%|▉         | 39/391 [00:00<00:04, 81.42it/s] 13%|█▎        | 51/391 [00:00<00:03, 91.24it/s] 16%|█▌        | 63/391 [00:00<00:03, 97.89it/s] 19%|█▉        | 75/391 [00:00<00:03, 102.20it/s] 22%|██▏       | 87/391 [00:01<00:02, 104.85it/s] 25%|██▌       | 99/391 [00:01<00:02, 106.66it/s] 28%|██▊       | 111/391 [00:01<00:02, 107.89it/s] 31%|███▏      | 123/391 [00:01<00:02, 108.77it/s] 35%|███▍      | 135/391 [00:01<00:02, 109.38it/s] 38%|███▊      | 147/391 [00:01<00:02, 109.83it/s] 41%|████      | 159/391 [00:01<00:02, 110.09it/s] 44%|████▎     | 171/391 [00:01<00:01, 110.34it/s] 47%|████▋     | 183/391 [00:01<00:01, 110.48it/s] 50%|████▉     | 195/391 [00:02<00:01, 110.53it/s] 53%|█████▎    | 207/391 [00:02<00:01, 110.61it/s] 56%|█████▌    | 219/391 [00:02<00:01, 110.71it/s] 59%|█████▉    | 231/391 [00:02<00:01, 110.69it/s] 62%|██████▏   | 243/391 [00:02<00:01, 110.76it/s] 65%|██████▌   | 255/391 [00:02<00:01, 110.74it/s] 68%|██████▊   | 267/391 [00:02<00:01, 110.76it/s] 71%|███████▏  | 279/391 [00:02<00:01, 110.70it/s] 74%|███████▍  | 291/391 [00:02<00:00, 110.77it/s] 77%|███████▋  | 303/391 [00:02<00:00, 110.87it/s] 81%|████████  | 315/391 [00:03<00:00, 110.89it/s] 84%|████████▎ | 327/391 [00:03<00:00, 110.89it/s] 87%|████████▋ | 339/391 [00:03<00:00, 110.76it/s] 90%|████████▉ | 351/391 [00:03<00:00, 110.86it/s] 93%|█████████▎| 363/391 [00:03<00:00, 110.63it/s] 96%|█████████▌| 375/391 [00:03<00:00, 110.69it/s] 99%|█████████▉| 387/391 [00:03<00:00, 110.32it/s]100%|██████████| 391/391 [00:03<00:00, 102.52it/s]
50000 images processed, 3.90425968170166 seconds used

Processing in-distribution CIFAR-10 images
  0%|          | 0/79 [00:00<?, ?it/s]  6%|▋         | 5/79 [00:00<00:01, 48.69it/s] 20%|██        | 16/79 [00:00<00:00, 83.16it/s] 35%|███▌      | 28/79 [00:00<00:00, 95.86it/s] 51%|█████     | 40/79 [00:00<00:00, 101.59it/s] 66%|██████▌   | 52/79 [00:00<00:00, 104.75it/s] 81%|████████  | 64/79 [00:00<00:00, 106.60it/s] 96%|█████████▌| 76/79 [00:00<00:00, 107.83it/s]100%|██████████| 79/79 [00:01<00:00, 60.42it/s] 
10000 images processed, 1.3491268157958984 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  1%|▏         | 3/204 [00:00<00:06, 29.25it/s]  6%|▋         | 13/204 [00:00<00:02, 70.00it/s] 12%|█▏        | 24/204 [00:00<00:02, 87.65it/s] 17%|█▋        | 35/204 [00:00<00:01, 96.13it/s] 23%|██▎       | 47/204 [00:00<00:01, 101.36it/s] 28%|██▊       | 58/204 [00:00<00:01, 104.08it/s] 34%|███▍      | 69/204 [00:00<00:01, 105.27it/s] 39%|███▉      | 80/204 [00:00<00:01, 106.44it/s] 45%|████▍     | 91/204 [00:00<00:01, 107.29it/s] 50%|█████     | 102/204 [00:01<00:00, 108.07it/s] 55%|█████▌    | 113/204 [00:01<00:00, 108.61it/s] 61%|██████    | 124/204 [00:01<00:00, 108.96it/s] 66%|██████▌   | 135/204 [00:01<00:00, 109.17it/s] 72%|███████▏  | 146/204 [00:01<00:00, 109.37it/s] 77%|███████▋  | 157/204 [00:01<00:00, 109.48it/s] 82%|████████▏ | 168/204 [00:01<00:00, 109.55it/s] 88%|████████▊ | 179/204 [00:01<00:00, 109.60it/s] 93%|█████████▎| 190/204 [00:01<00:00, 109.63it/s] 99%|█████████▊| 201/204 [00:01<00:00, 109.71it/s]100%|██████████| 204/204 [00:02<00:00, 101.59it/s]
26032 images processed, 2.0406577587127686 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:17,  4.46it/s]  6%|▋         | 5/79 [00:00<00:04, 16.43it/s] 11%|█▏        | 9/79 [00:00<00:03, 21.97it/s] 16%|█▋        | 13/79 [00:00<00:02, 25.11it/s] 22%|██▏       | 17/79 [00:00<00:02, 26.99it/s] 27%|██▋       | 21/79 [00:00<00:02, 28.27it/s] 32%|███▏      | 25/79 [00:01<00:01, 29.09it/s] 37%|███▋      | 29/79 [00:01<00:01, 29.63it/s] 42%|████▏     | 33/79 [00:01<00:01, 29.99it/s] 47%|████▋     | 37/79 [00:01<00:01, 30.12it/s] 52%|█████▏    | 41/79 [00:01<00:01, 30.37it/s] 57%|█████▋    | 45/79 [00:01<00:01, 30.49it/s] 62%|██████▏   | 49/79 [00:01<00:00, 30.59it/s] 67%|██████▋   | 53/79 [00:01<00:00, 30.68it/s] 72%|███████▏  | 57/79 [00:02<00:00, 30.63it/s] 77%|███████▋  | 61/79 [00:02<00:00, 30.74it/s] 82%|████████▏ | 65/79 [00:02<00:00, 30.80it/s] 87%|████████▋ | 69/79 [00:02<00:00, 30.78it/s] 92%|█████████▏| 73/79 [00:02<00:00, 30.82it/s] 97%|█████████▋| 77/79 [00:02<00:00, 30.66it/s]100%|██████████| 79/79 [00:02<00:00, 28.82it/s]
10000 images processed, 2.7822482585906982 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  3%|▎         | 2/79 [00:00<00:04, 18.63it/s] 16%|█▋        | 13/79 [00:00<00:00, 67.31it/s] 30%|███       | 24/79 [00:00<00:00, 85.02it/s] 44%|████▍     | 35/79 [00:00<00:00, 94.00it/s] 58%|█████▊    | 46/79 [00:00<00:00, 99.57it/s] 72%|███████▏  | 57/79 [00:00<00:00, 102.29it/s] 86%|████████▌ | 68/79 [00:00<00:00, 104.41it/s]100%|██████████| 79/79 [00:00<00:00, 94.02it/s] 
10000 images processed, 0.8557884693145752 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:07,  8.68it/s] 16%|█▌        | 11/70 [00:00<00:00, 59.14it/s] 31%|███▏      | 22/70 [00:00<00:00, 80.50it/s] 49%|████▊     | 34/70 [00:00<00:00, 92.46it/s] 64%|██████▍   | 45/70 [00:00<00:00, 98.52it/s] 80%|████████  | 56/70 [00:00<00:00, 102.28it/s] 96%|█████████▌| 67/70 [00:00<00:00, 104.74it/s]100%|██████████| 70/70 [00:00<00:00, 87.79it/s] 
8925 images processed, 0.8150503635406494 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:23,  1.87it/s]  4%|▍         | 2/45 [00:00<00:12,  3.56it/s] 11%|█         | 5/45 [00:00<00:05,  6.82it/s] 13%|█▎        | 6/45 [00:01<00:05,  6.54it/s] 20%|██        | 9/45 [00:01<00:03,  9.58it/s] 24%|██▍       | 11/45 [00:01<00:03,  8.89it/s] 29%|██▉       | 13/45 [00:01<00:03, 10.40it/s] 33%|███▎      | 15/45 [00:02<00:04,  7.01it/s] 40%|████      | 18/45 [00:02<00:03,  7.25it/s] 47%|████▋     | 21/45 [00:02<00:02,  9.50it/s] 51%|█████     | 23/45 [00:02<00:02,  8.42it/s] 56%|█████▌    | 25/45 [00:03<00:02,  9.89it/s] 60%|██████    | 27/45 [00:03<00:02,  8.45it/s] 67%|██████▋   | 30/45 [00:03<00:01,  7.54it/s] 73%|███████▎  | 33/45 [00:04<00:01,  9.09it/s] 78%|███████▊  | 35/45 [00:04<00:01,  7.66it/s] 84%|████████▍ | 38/45 [00:04<00:00,  8.72it/s] 93%|█████████▎| 42/45 [00:05<00:00,  7.68it/s]100%|██████████| 45/45 [00:05<00:00,  8.68it/s]100%|██████████| 45/45 [00:05<00:00,  7.99it/s]
5640 images processed, 5.6524412631988525 seconds used

18.535964727401733
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           1.16  99.78
places365     70.70  80.73
LSUN          14.65  97.13
iSUN          86.18  72.41
dtd           19.01  96.27
AVG           38.34  89.26
3.3466262817382812
