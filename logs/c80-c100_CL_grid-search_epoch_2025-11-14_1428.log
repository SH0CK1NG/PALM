nohup: ignoring input
[Grid Search Continual] Searching over: lambda_pcon(1) × lrs(0.001) × epochs(5 10 15 20 25 30 35 40 45 50) × lora_r(8)
[Grid Search Continual] Stages: 0,8,11,40,51 66,67,88,94,57 59,58,44,93,10 64,22,42,9,90

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=5 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=5, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/5 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
 20%|██        | 1/5 [00:14<00:58, 14.66s/it] 40%|████      | 2/5 [00:23<00:32, 10.98s/it] 60%|██████    | 3/5 [00:31<00:19,  9.61s/it] 80%|████████  | 4/5 [00:39<00:09,  9.04s/it]100%|██████████| 5/5 [00:47<00:00,  8.78s/it]100%|██████████| 5/5 [00:47<00:00,  9.51s/it]
[loss] ep 0 it 0 total=8.5894 mle=3.2128 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6441 mle=3.2648 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0877 mle=3.7056 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6781 mle=3.2933 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9791 mle=2.5920 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9919 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4733 mle=4.0810 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4956 mle=3.1008 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5368 mle=3.1398 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2411 mle=2.8415 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7242 mle=3.3223 pcon=5.4019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0963 mle=3.6917 pcon=5.4045 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4458 mle=4.0385 pcon=5.4073 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3582 mle=2.9487 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0700 mle=3.6581 pcon=5.4119 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5545 mle=3.1403 pcon=5.4142 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5077 mle=3.0908 pcon=5.4169 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6320 mle=3.2131 pcon=5.4189 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2433 mle=2.8213 pcon=5.4220 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4329 mle=3.0085 pcon=5.4244 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7380 mle=2.3110 pcon=5.4270 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6783 mle=3.2489 pcon=5.4294 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8375 mle=3.4056 pcon=5.4319 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7150 mle=2.2806 pcon=5.4345 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.3000 mle=2.8637 pcon=5.4362 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4255 mle=2.9875 pcon=5.4380 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1015 mle=2.6615 pcon=5.4400 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9324 mle=2.4908 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6432 mle=2.2005 pcon=5.4427 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6506 mle=2.2064 pcon=5.4442 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6232 mle=2.1785 pcon=5.4447 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6688 mle=2.2233 pcon=5.4455 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6921 mle=2.2453 pcon=5.4467 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6985 mle=2.2507 pcon=5.4477 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7878 mle=2.3394 pcon=5.4484 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4443 mle=1.9940 pcon=5.4503 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4893 mle=2.0372 pcon=5.4521 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4849 mle=2.0302 pcon=5.4547 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9107 mle=2.4538 pcon=5.4568 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4954 mle=2.0361 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:00,  1.62it/s]  3%|▎         | 11/391 [00:00<00:19, 19.86it/s]  5%|▌         | 21/391 [00:00<00:10, 36.11it/s]  7%|▋         | 29/391 [00:00<00:07, 45.65it/s] 10%|▉         | 38/391 [00:01<00:06, 56.36it/s] 12%|█▏        | 48/391 [00:01<00:05, 65.94it/s] 15%|█▍        | 57/391 [00:01<00:04, 71.61it/s] 17%|█▋        | 67/391 [00:01<00:04, 77.05it/s] 20%|█▉        | 77/391 [00:01<00:03, 82.07it/s] 22%|██▏       | 87/391 [00:01<00:03, 84.63it/s] 25%|██▍       | 97/391 [00:01<00:03, 86.62it/s] 27%|██▋       | 107/391 [00:01<00:03, 88.18it/s] 30%|██▉       | 117/391 [00:01<00:03, 89.69it/s] 32%|███▏      | 127/391 [00:02<00:03, 86.86it/s] 35%|███▌      | 137/391 [00:02<00:02, 89.05it/s] 38%|███▊      | 147/391 [00:02<00:02, 82.37it/s] 40%|████      | 157/391 [00:02<00:02, 85.36it/s] 43%|████▎     | 167/391 [00:02<00:02, 87.32it/s] 45%|████▌     | 177/391 [00:02<00:02, 89.67it/s] 48%|████▊     | 187/391 [00:02<00:02, 91.10it/s] 50%|█████     | 197/391 [00:02<00:02, 92.26it/s] 53%|█████▎    | 207/391 [00:02<00:01, 93.26it/s] 55%|█████▌    | 217/391 [00:03<00:01, 89.58it/s] 58%|█████▊    | 227/391 [00:03<00:01, 91.04it/s] 61%|██████    | 237/391 [00:03<00:01, 89.27it/s] 63%|██████▎   | 247/391 [00:03<00:01, 90.84it/s] 66%|██████▌   | 257/391 [00:03<00:01, 91.56it/s] 68%|██████▊   | 267/391 [00:03<00:01, 91.96it/s] 71%|███████   | 277/391 [00:03<00:01, 92.61it/s] 73%|███████▎  | 287/391 [00:03<00:01, 88.56it/s] 76%|███████▌  | 297/391 [00:03<00:01, 90.39it/s] 79%|███████▊  | 307/391 [00:04<00:00, 86.11it/s] 81%|████████  | 317/391 [00:04<00:00, 87.54it/s] 84%|████████▎ | 327/391 [00:04<00:00, 89.66it/s] 86%|████████▌ | 337/391 [00:04<00:00, 91.02it/s] 89%|████████▊ | 347/391 [00:04<00:00, 91.63it/s] 91%|█████████▏| 357/391 [00:04<00:00, 92.27it/s] 94%|█████████▍| 367/391 [00:04<00:00, 92.79it/s] 96%|█████████▋| 377/391 [00:04<00:00, 93.77it/s] 99%|█████████▉| 387/391 [00:04<00:00, 94.55it/s]100%|██████████| 391/391 [00:04<00:00, 79.10it/s]
50000 images processed, 4.985093116760254 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.72it/s]  5%|▌         | 4/79 [00:00<00:10,  7.22it/s] 10%|█         | 8/79 [00:00<00:05, 14.18it/s] 16%|█▋        | 13/79 [00:00<00:03, 21.87it/s] 24%|██▍       | 19/79 [00:01<00:01, 31.06it/s] 32%|███▏      | 25/79 [00:01<00:01, 38.34it/s] 38%|███▊      | 30/79 [00:01<00:01, 39.67it/s] 47%|████▋     | 37/79 [00:01<00:00, 47.74it/s] 59%|█████▉    | 47/79 [00:01<00:00, 60.98it/s] 72%|███████▏  | 57/79 [00:01<00:00, 71.01it/s] 85%|████████▍ | 67/79 [00:01<00:00, 78.34it/s] 97%|█████████▋| 77/79 [00:01<00:00, 83.61it/s]100%|██████████| 79/79 [00:01<00:00, 44.42it/s]
10000 images processed, 1.792710304260254 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:59,  1.13it/s]  5%|▍         | 10/204 [00:00<00:14, 13.42it/s] 10%|▉         | 20/204 [00:01<00:06, 27.33it/s] 15%|█▍        | 30/204 [00:01<00:04, 40.26it/s] 20%|█▉        | 40/204 [00:01<00:03, 51.90it/s] 24%|██▍       | 49/204 [00:01<00:02, 59.27it/s] 28%|██▊       | 58/204 [00:01<00:02, 66.00it/s] 33%|███▎      | 68/204 [00:01<00:01, 72.81it/s] 38%|███▊      | 78/204 [00:01<00:01, 78.11it/s] 43%|████▎     | 88/204 [00:01<00:01, 82.72it/s] 48%|████▊     | 98/204 [00:01<00:01, 86.08it/s] 53%|█████▎    | 108/204 [00:02<00:01, 88.35it/s] 58%|█████▊    | 118/204 [00:02<00:01, 79.74it/s] 62%|██████▏   | 127/204 [00:02<00:01, 74.20it/s] 67%|██████▋   | 137/204 [00:02<00:00, 79.30it/s] 72%|███████▏  | 147/204 [00:02<00:00, 83.10it/s] 77%|███████▋  | 157/204 [00:02<00:00, 86.14it/s] 81%|████████▏ | 166/204 [00:02<00:00, 84.30it/s] 86%|████████▌ | 175/204 [00:02<00:00, 75.02it/s] 90%|████████▉ | 183/204 [00:03<00:00, 75.70it/s] 95%|█████████▍| 193/204 [00:03<00:00, 81.32it/s]100%|█████████▉| 203/204 [00:03<00:00, 85.48it/s]100%|██████████| 204/204 [00:03<00:00, 62.34it/s]
26032 images processed, 3.3118371963500977 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:05,  1.20it/s] 13%|█▎        | 10/79 [00:00<00:04, 13.98it/s] 24%|██▍       | 19/79 [00:01<00:02, 26.28it/s] 33%|███▎      | 26/79 [00:01<00:01, 30.78it/s] 44%|████▍     | 35/79 [00:01<00:01, 42.05it/s] 53%|█████▎    | 42/79 [00:01<00:00, 37.03it/s] 63%|██████▎   | 50/79 [00:01<00:00, 44.77it/s] 76%|███████▌  | 60/79 [00:01<00:00, 55.45it/s] 89%|████████▊ | 70/79 [00:01<00:00, 65.03it/s]100%|██████████| 79/79 [00:01<00:00, 40.02it/s]
10000 images processed, 1.996279001235962 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.70it/s] 13%|█▎        | 10/79 [00:00<00:03, 18.60it/s] 25%|██▌       | 20/79 [00:00<00:01, 35.63it/s] 38%|███▊      | 30/79 [00:00<00:00, 49.87it/s] 51%|█████     | 40/79 [00:01<00:00, 61.26it/s] 63%|██████▎   | 50/79 [00:01<00:00, 70.24it/s] 76%|███████▌  | 60/79 [00:01<00:00, 77.34it/s] 89%|████████▊ | 70/79 [00:01<00:00, 82.70it/s]100%|██████████| 79/79 [00:01<00:00, 55.74it/s]
10000 images processed, 1.44016695022583 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<01:00,  1.14it/s] 16%|█▌        | 11/70 [00:00<00:03, 14.79it/s] 30%|███       | 21/70 [00:01<00:01, 28.55it/s] 44%|████▍     | 31/70 [00:01<00:00, 41.68it/s] 59%|█████▊    | 41/70 [00:01<00:00, 53.41it/s] 73%|███████▎  | 51/70 [00:01<00:00, 63.56it/s] 87%|████████▋ | 61/70 [00:01<00:00, 71.86it/s]100%|██████████| 70/70 [00:01<00:00, 43.53it/s]
8925 images processed, 1.6348466873168945 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<01:00,  1.36s/it]  4%|▍         | 2/45 [00:01<00:30,  1.40it/s] 27%|██▋       | 12/45 [00:01<00:02, 11.72it/s] 38%|███▊      | 17/45 [00:02<00:02, 12.44it/s] 47%|████▋     | 21/45 [00:02<00:01, 14.53it/s] 67%|██████▋   | 30/45 [00:02<00:00, 24.53it/s] 78%|███████▊  | 35/45 [00:03<00:00, 15.43it/s]100%|██████████| 45/45 [00:03<00:00, 24.54it/s]100%|██████████| 45/45 [00:03<00:00, 14.45it/s]
5640 images processed, 3.1364402770996094 seconds used

20.252135515213013
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.59
places365     49.90  89.49  51.37
LSUN          25.88  95.18  76.03
iSUN          25.98  95.04  73.74
dtd           24.61  94.43  71.73
AVG           25.99  94.64  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
2.5523183345794678
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=5, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/5 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
 20%|██        | 1/5 [00:16<01:06, 16.52s/it] 40%|████      | 2/5 [00:26<00:38, 12.70s/it] 60%|██████    | 3/5 [00:36<00:22, 11.35s/it] 80%|████████  | 4/5 [00:45<00:10, 10.67s/it]100%|██████████| 5/5 [00:55<00:00, 10.45s/it]100%|██████████| 5/5 [00:55<00:00, 11.20s/it]
[loss] ep 0 it 0 total=12.0568 mle=2.2873 pcon=8.7277 forget=0.0000 orth=1.0418 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0658 mle=2.2924 pcon=8.7317 forget=0.0000 orth=1.0417 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2254 mle=2.4489 pcon=8.7348 forget=0.0000 orth=1.0417 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1260 mle=2.3464 pcon=8.7380 forget=0.0000 orth=1.0416 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7763 mle=1.9941 pcon=8.7408 forget=0.0000 orth=1.0414 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=12.0085 mle=2.2240 pcon=8.7432 forget=0.0000 orth=1.0413 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4257 mle=2.6394 pcon=8.7452 forget=0.0000 orth=1.0411 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9959 mle=2.2082 pcon=8.7468 forget=0.0000 orth=1.0409 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9517 mle=2.1624 pcon=8.7486 forget=0.0000 orth=1.0407 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9424 mle=2.1516 pcon=8.7504 forget=0.0000 orth=1.0404 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0977 mle=2.3057 pcon=8.7518 forget=0.0000 orth=1.0401 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3345 mle=2.5415 pcon=8.7533 forget=0.0000 orth=1.0398 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2875 mle=2.4939 pcon=8.7542 forget=0.0000 orth=1.0395 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.9022 mle=2.1080 pcon=8.7551 forget=0.0000 orth=1.0391 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.2023 mle=2.4075 pcon=8.7562 forget=0.0000 orth=1.0386 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0875 mle=2.2923 pcon=8.7571 forget=0.0000 orth=1.0381 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0256 mle=2.2305 pcon=8.7576 forget=0.0000 orth=1.0375 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0737 mle=2.2784 pcon=8.7585 forget=0.0000 orth=1.0368 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9202 mle=2.1241 pcon=8.7598 forget=0.0000 orth=1.0363 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9644 mle=2.1681 pcon=8.7607 forget=0.0000 orth=1.0356 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5860 mle=1.7893 pcon=8.7617 forget=0.0000 orth=1.0350 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1395 mle=2.3431 pcon=8.7621 forget=0.0000 orth=1.0343 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1799 mle=2.3838 pcon=8.7627 forget=0.0000 orth=1.0334 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6906 mle=1.8942 pcon=8.7639 forget=0.0000 orth=1.0326 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0812 mle=2.2854 pcon=8.7642 forget=0.0000 orth=1.0317 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1976 mle=2.4020 pcon=8.7650 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1283 mle=2.3329 pcon=8.7657 forget=0.0000 orth=1.0297 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0211 mle=2.2257 pcon=8.7667 forget=0.0000 orth=1.0287 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9348 mle=2.1393 pcon=8.7678 forget=0.0000 orth=1.0277 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9652 mle=2.1700 pcon=8.7687 forget=0.0000 orth=1.0265 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9473 mle=2.1527 pcon=8.7693 forget=0.0000 orth=1.0253 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=11.9963 mle=2.2025 pcon=8.7698 forget=0.0000 orth=1.0240 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0116 mle=2.2176 pcon=8.7712 forget=0.0000 orth=1.0228 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0167 mle=2.2226 pcon=8.7723 forget=0.0000 orth=1.0218 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1380 mle=2.3441 pcon=8.7732 forget=0.0000 orth=1.0206 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8201 mle=2.0269 pcon=8.7738 forget=0.0000 orth=1.0194 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8667 mle=2.0742 pcon=8.7745 forget=0.0000 orth=1.0180 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8297 mle=2.0371 pcon=8.7759 forget=0.0000 orth=1.0166 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1794 mle=2.3869 pcon=8.7769 forget=0.0000 orth=1.0157 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.7977 mle=2.0052 pcon=8.7781 forget=0.0000 orth=1.0144 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:08,  2.06it/s]  3%|▎         | 11/391 [00:00<00:15, 24.00it/s]  5%|▌         | 21/391 [00:00<00:08, 41.83it/s]  8%|▊         | 31/391 [00:00<00:06, 55.88it/s] 10%|█         | 41/391 [00:00<00:05, 66.58it/s] 13%|█▎        | 51/391 [00:01<00:04, 74.60it/s] 16%|█▌        | 61/391 [00:01<00:04, 80.44it/s] 18%|█▊        | 71/391 [00:01<00:03, 84.88it/s] 21%|██        | 81/391 [00:01<00:03, 88.15it/s] 23%|██▎       | 91/391 [00:01<00:03, 90.41it/s] 26%|██▌       | 101/391 [00:01<00:03, 92.05it/s] 28%|██▊       | 111/391 [00:01<00:03, 93.10it/s] 31%|███       | 121/391 [00:01<00:02, 93.98it/s] 34%|███▎      | 131/391 [00:01<00:02, 94.59it/s] 36%|███▌      | 141/391 [00:01<00:02, 94.99it/s] 39%|███▊      | 151/391 [00:02<00:02, 95.25it/s] 41%|████      | 161/391 [00:02<00:02, 95.38it/s] 44%|████▎     | 171/391 [00:02<00:02, 95.39it/s] 46%|████▋     | 181/391 [00:02<00:02, 95.39it/s] 49%|████▉     | 191/391 [00:02<00:02, 95.39it/s] 51%|█████▏    | 201/391 [00:02<00:01, 95.44it/s] 54%|█████▍    | 211/391 [00:02<00:01, 94.38it/s] 57%|█████▋    | 221/391 [00:02<00:01, 94.45it/s] 59%|█████▉    | 231/391 [00:02<00:01, 94.37it/s] 62%|██████▏   | 241/391 [00:03<00:01, 87.09it/s] 64%|██████▍   | 250/391 [00:03<00:01, 76.53it/s] 66%|██████▌   | 259/391 [00:03<00:01, 79.21it/s] 69%|██████▊   | 268/391 [00:03<00:01, 76.86it/s] 71%|███████   | 278/391 [00:03<00:01, 81.90it/s] 73%|███████▎  | 287/391 [00:03<00:01, 78.52it/s] 76%|███████▌  | 296/391 [00:03<00:01, 80.81it/s] 78%|███████▊  | 306/391 [00:03<00:01, 84.50it/s] 81%|████████  | 315/391 [00:03<00:00, 81.92it/s] 83%|████████▎ | 325/391 [00:04<00:00, 85.66it/s] 85%|████████▌ | 334/391 [00:04<00:00, 78.71it/s] 88%|████████▊ | 343/391 [00:04<00:00, 75.80it/s] 90%|████████▉ | 351/391 [00:04<00:00, 73.41it/s] 92%|█████████▏| 359/391 [00:04<00:00, 70.66it/s] 94%|█████████▍| 367/391 [00:04<00:00, 70.16it/s] 96%|█████████▋| 377/391 [00:04<00:00, 77.50it/s] 99%|█████████▉| 387/391 [00:04<00:00, 83.14it/s]100%|██████████| 391/391 [00:04<00:00, 78.76it/s]
50000 images processed, 5.016031980514526 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.30it/s] 13%|█▎        | 10/79 [00:00<00:02, 23.41it/s] 24%|██▍       | 19/79 [00:00<00:01, 39.67it/s] 37%|███▋      | 29/79 [00:00<00:00, 53.91it/s] 47%|████▋     | 37/79 [00:00<00:00, 54.09it/s] 56%|█████▌    | 44/79 [00:01<00:00, 57.58it/s] 65%|██████▍   | 51/79 [00:01<00:00, 54.23it/s] 75%|███████▍  | 59/79 [00:01<00:00, 59.43it/s] 86%|████████▌ | 68/79 [00:01<00:00, 66.24it/s] 96%|█████████▌| 76/79 [00:01<00:00, 64.73it/s]100%|██████████| 79/79 [00:01<00:00, 50.36it/s]
10000 images processed, 1.5828638076782227 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<03:16,  1.04it/s]  5%|▌         | 11/204 [00:01<00:14, 13.68it/s] 10%|▉         | 20/204 [00:01<00:07, 25.46it/s] 14%|█▍        | 29/204 [00:01<00:04, 37.06it/s] 19%|█▉        | 39/204 [00:01<00:03, 49.01it/s] 24%|██▍       | 49/204 [00:01<00:02, 58.96it/s] 28%|██▊       | 58/204 [00:01<00:02, 65.58it/s] 33%|███▎      | 68/204 [00:01<00:01, 72.35it/s] 38%|███▊      | 78/204 [00:01<00:01, 78.18it/s] 43%|████▎     | 88/204 [00:01<00:01, 81.78it/s] 48%|████▊     | 98/204 [00:02<00:01, 84.91it/s] 53%|█████▎    | 108/204 [00:02<00:01, 87.30it/s] 58%|█████▊    | 118/204 [00:02<00:00, 86.31it/s] 63%|██████▎   | 128/204 [00:02<00:00, 87.82it/s] 67%|██████▋   | 137/204 [00:02<00:00, 87.62it/s] 72%|███████▏  | 146/204 [00:02<00:00, 87.84it/s] 76%|███████▌  | 155/204 [00:02<00:00, 88.43it/s] 80%|████████  | 164/204 [00:02<00:00, 85.46it/s] 85%|████████▍ | 173/204 [00:02<00:00, 84.78it/s] 90%|████████▉ | 183/204 [00:02<00:00, 88.14it/s] 95%|█████████▍| 193/204 [00:03<00:00, 90.62it/s]100%|█████████▉| 203/204 [00:03<00:00, 92.31it/s]100%|██████████| 204/204 [00:03<00:00, 63.28it/s]
26032 images processed, 3.275479316711426 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.67it/s] 11%|█▏        | 9/79 [00:00<00:04, 16.48it/s] 23%|██▎       | 18/79 [00:00<00:02, 30.35it/s] 35%|███▌      | 28/79 [00:00<00:01, 45.16it/s] 46%|████▌     | 36/79 [00:01<00:00, 49.32it/s] 58%|█████▊    | 46/79 [00:01<00:00, 59.87it/s] 68%|██████▊   | 54/79 [00:01<00:00, 64.19it/s] 78%|███████▊  | 62/79 [00:01<00:00, 65.81it/s] 91%|█████████ | 72/79 [00:01<00:00, 74.04it/s]100%|██████████| 79/79 [00:01<00:00, 50.06it/s]
10000 images processed, 1.5994410514831543 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:42,  1.82it/s] 11%|█▏        | 9/79 [00:00<00:03, 17.66it/s] 24%|██▍       | 19/79 [00:00<00:01, 35.80it/s] 37%|███▋      | 29/79 [00:00<00:00, 50.73it/s] 49%|████▉     | 39/79 [00:00<00:00, 62.52it/s] 62%|██████▏   | 49/79 [00:01<00:00, 71.62it/s] 75%|███████▍  | 59/79 [00:01<00:00, 78.67it/s] 87%|████████▋ | 69/79 [00:01<00:00, 83.94it/s]100%|██████████| 79/79 [00:01<00:00, 57.35it/s]
10000 images processed, 1.3996448516845703 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:33,  2.06it/s] 11%|█▏        | 8/70 [00:00<00:03, 17.37it/s] 20%|██        | 14/70 [00:00<00:02, 26.87it/s] 31%|███▏      | 22/70 [00:00<00:01, 39.76it/s] 44%|████▍     | 31/70 [00:00<00:00, 52.61it/s] 59%|█████▊    | 41/70 [00:01<00:00, 64.16it/s] 73%|███████▎  | 51/70 [00:01<00:00, 73.30it/s] 87%|████████▋ | 61/70 [00:01<00:00, 79.98it/s]100%|██████████| 70/70 [00:01<00:00, 52.96it/s]
8925 images processed, 1.3535959720611572 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:55,  1.26s/it]  4%|▍         | 2/45 [00:01<00:26,  1.63it/s] 16%|█▌        | 7/45 [00:01<00:05,  7.06it/s] 38%|███▊      | 17/45 [00:01<00:01, 16.50it/s] 44%|████▍     | 20/45 [00:01<00:01, 17.74it/s] 51%|█████     | 23/45 [00:02<00:01, 14.90it/s] 67%|██████▋   | 30/45 [00:02<00:00, 22.90it/s] 76%|███████▌  | 34/45 [00:02<00:00, 21.97it/s] 87%|████████▋ | 39/45 [00:02<00:00, 24.63it/s] 96%|█████████▌| 43/45 [00:02<00:00, 22.06it/s]100%|██████████| 45/45 [00:02<00:00, 15.09it/s]
5640 images processed, 3.001474380493164 seconds used

19.248986959457397
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.80  98.86  78.74
places365     52.94  85.11  47.14
LSUN          44.80  89.30  61.99
iSUN          35.92  91.34  65.44
dtd           32.98  92.12  73.39
AVG           34.09  91.35  65.34
[incremental] Overall: 0.7390 New: 0.7200 Old: 0.7580
[incremental] Final(Top-1): 0.7390  Average: 0.7935
6.300378084182739
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=5, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/5 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
 20%|██        | 1/5 [00:17<01:10, 17.66s/it] 40%|████      | 2/5 [00:27<00:39, 13.11s/it] 60%|██████    | 3/5 [00:37<00:23, 11.69s/it] 80%|████████  | 4/5 [00:47<00:11, 11.08s/it]100%|██████████| 5/5 [00:57<00:00, 10.64s/it]100%|██████████| 5/5 [00:57<00:00, 11.52s/it]
[loss] ep 0 it 0 total=12.7848 mle=2.3306 pcon=9.4392 forget=0.0000 orth=1.0149 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.7517 mle=2.2941 pcon=9.4428 forget=0.0000 orth=1.0149 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.8545 mle=2.3934 pcon=9.4463 forget=0.0000 orth=1.0148 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.7973 mle=2.3327 pcon=9.4499 forget=0.0000 orth=1.0147 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=12.4288 mle=1.9606 pcon=9.4537 forget=0.0000 orth=1.0145 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=12.6440 mle=2.1735 pcon=9.4562 forget=0.0000 orth=1.0144 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.0663 mle=2.5924 pcon=9.4597 forget=0.0000 orth=1.0142 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=12.6429 mle=2.1660 pcon=9.4628 forget=0.0000 orth=1.0141 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=12.6136 mle=2.1340 pcon=9.4656 forget=0.0000 orth=1.0140 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=12.6198 mle=2.1382 pcon=9.4677 forget=0.0000 orth=1.0139 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.7473 mle=2.2631 pcon=9.4703 forget=0.0000 orth=1.0139 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.9840 mle=2.4980 pcon=9.4722 forget=0.0000 orth=1.0138 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.9012 mle=2.4138 pcon=9.4737 forget=0.0000 orth=1.0138 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=12.5572 mle=2.0685 pcon=9.4750 forget=0.0000 orth=1.0137 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.8540 mle=2.3635 pcon=9.4768 forget=0.0000 orth=1.0136 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.7573 mle=2.2652 pcon=9.4785 forget=0.0000 orth=1.0136 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=12.6851 mle=2.1914 pcon=9.4803 forget=0.0000 orth=1.0135 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.7630 mle=2.2677 pcon=9.4818 forget=0.0000 orth=1.0134 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=12.5977 mle=2.1005 pcon=9.4838 forget=0.0000 orth=1.0133 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=12.6488 mle=2.1501 pcon=9.4854 forget=0.0000 orth=1.0133 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=12.2759 mle=1.7752 pcon=9.4875 forget=0.0000 orth=1.0132 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.8024 mle=2.3007 pcon=9.4886 forget=0.0000 orth=1.0131 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.8694 mle=2.3660 pcon=9.4904 forget=0.0000 orth=1.0130 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=12.3882 mle=1.8829 pcon=9.4924 forget=0.0000 orth=1.0129 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=12.7629 mle=2.2560 pcon=9.4942 forget=0.0000 orth=1.0128 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.8751 mle=2.3663 pcon=9.4962 forget=0.0000 orth=1.0126 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.8282 mle=2.3181 pcon=9.4977 forget=0.0000 orth=1.0125 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.7103 mle=2.1988 pcon=9.4992 forget=0.0000 orth=1.0123 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=12.6326 mle=2.1197 pcon=9.5007 forget=0.0000 orth=1.0122 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=12.6706 mle=2.1559 pcon=9.5027 forget=0.0000 orth=1.0120 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=12.6582 mle=2.1425 pcon=9.5040 forget=0.0000 orth=1.0118 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.7191 mle=2.2015 pcon=9.5060 forget=0.0000 orth=1.0115 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=12.7192 mle=2.2001 pcon=9.5078 forget=0.0000 orth=1.0113 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.7430 mle=2.2220 pcon=9.5097 forget=0.0000 orth=1.0112 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.8567 mle=2.3343 pcon=9.5114 forget=0.0000 orth=1.0111 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.5499 mle=2.0261 pcon=9.5130 forget=0.0000 orth=1.0108 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.6067 mle=2.0816 pcon=9.5146 forget=0.0000 orth=1.0105 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.5552 mle=2.0287 pcon=9.5163 forget=0.0000 orth=1.0102 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.8856 mle=2.3575 pcon=9.5180 forget=0.0000 orth=1.0102 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.5217 mle=1.9922 pcon=9.5197 forget=0.0000 orth=1.0099 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:48,  1.71it/s]  3%|▎         | 10/391 [00:00<00:20, 19.00it/s]  5%|▌         | 20/391 [00:00<00:10, 36.31it/s]  8%|▊         | 30/391 [00:00<00:07, 50.60it/s] 10%|█         | 40/391 [00:01<00:05, 61.72it/s] 13%|█▎        | 50/391 [00:01<00:04, 70.51it/s] 15%|█▌        | 60/391 [00:01<00:04, 77.43it/s] 18%|█▊        | 70/391 [00:01<00:03, 82.38it/s] 20%|██        | 80/391 [00:01<00:03, 86.01it/s] 23%|██▎       | 90/391 [00:01<00:03, 88.68it/s] 26%|██▌       | 100/391 [00:01<00:03, 89.51it/s] 28%|██▊       | 110/391 [00:01<00:03, 91.15it/s] 31%|███       | 120/391 [00:01<00:02, 92.24it/s] 33%|███▎      | 130/391 [00:01<00:02, 93.07it/s] 36%|███▌      | 140/391 [00:02<00:02, 93.41it/s] 38%|███▊      | 150/391 [00:02<00:02, 93.92it/s] 41%|████      | 160/391 [00:02<00:02, 94.24it/s] 43%|████▎     | 170/391 [00:02<00:02, 94.41it/s] 46%|████▌     | 180/391 [00:02<00:02, 94.60it/s] 49%|████▊     | 190/391 [00:02<00:02, 94.78it/s] 51%|█████     | 200/391 [00:02<00:02, 94.11it/s] 54%|█████▎    | 210/391 [00:02<00:01, 94.24it/s] 56%|█████▋    | 220/391 [00:02<00:01, 94.28it/s] 59%|█████▉    | 230/391 [00:03<00:01, 93.92it/s] 61%|██████▏   | 240/391 [00:03<00:01, 94.26it/s] 64%|██████▍   | 250/391 [00:03<00:01, 94.13it/s] 66%|██████▋   | 260/391 [00:03<00:01, 94.13it/s] 69%|██████▉   | 270/391 [00:03<00:01, 93.02it/s] 72%|███████▏  | 280/391 [00:03<00:01, 92.96it/s] 74%|███████▍  | 290/391 [00:03<00:01, 93.76it/s] 77%|███████▋  | 300/391 [00:03<00:00, 93.17it/s] 79%|███████▉  | 310/391 [00:03<00:00, 92.97it/s] 82%|████████▏ | 320/391 [00:03<00:00, 93.60it/s] 84%|████████▍ | 330/391 [00:04<00:00, 94.23it/s] 87%|████████▋ | 340/391 [00:04<00:00, 93.93it/s] 90%|████████▉ | 350/391 [00:04<00:00, 93.82it/s] 92%|█████████▏| 360/391 [00:04<00:00, 93.68it/s] 95%|█████████▍| 370/391 [00:04<00:00, 94.15it/s] 97%|█████████▋| 380/391 [00:04<00:00, 95.15it/s]100%|█████████▉| 390/391 [00:04<00:00, 95.84it/s]100%|██████████| 391/391 [00:04<00:00, 82.52it/s]
50000 images processed, 4.800530433654785 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.11it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.97it/s] 25%|██▌       | 20/79 [00:00<00:01, 40.33it/s] 38%|███▊      | 30/79 [00:00<00:00, 54.84it/s] 51%|█████     | 40/79 [00:00<00:00, 65.14it/s] 63%|██████▎   | 50/79 [00:01<00:00, 73.42it/s] 76%|███████▌  | 60/79 [00:01<00:00, 80.01it/s] 89%|████████▊ | 70/79 [00:01<00:00, 84.81it/s]100%|██████████| 79/79 [00:01<00:00, 59.39it/s]
10000 images processed, 1.3463003635406494 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:53,  1.78it/s]  4%|▍         | 9/204 [00:00<00:11, 17.66it/s]  9%|▉         | 18/204 [00:00<00:05, 33.87it/s] 14%|█▎        | 28/204 [00:00<00:03, 49.00it/s] 18%|█▊        | 37/204 [00:00<00:02, 59.36it/s] 23%|██▎       | 47/204 [00:01<00:02, 68.50it/s] 28%|██▊       | 57/204 [00:01<00:01, 75.10it/s] 33%|███▎      | 67/204 [00:01<00:01, 79.72it/s] 38%|███▊      | 77/204 [00:01<00:01, 83.63it/s] 43%|████▎     | 87/204 [00:01<00:01, 85.51it/s] 48%|████▊     | 97/204 [00:01<00:01, 86.93it/s] 52%|█████▏    | 106/204 [00:01<00:01, 82.73it/s] 57%|█████▋    | 116/204 [00:01<00:01, 85.70it/s] 62%|██████▏   | 126/204 [00:01<00:00, 88.15it/s] 67%|██████▋   | 136/204 [00:02<00:00, 90.09it/s] 72%|███████▏  | 146/204 [00:02<00:00, 91.15it/s] 76%|███████▋  | 156/204 [00:02<00:00, 92.15it/s] 81%|████████▏ | 166/204 [00:02<00:00, 92.40it/s] 86%|████████▋ | 176/204 [00:02<00:00, 93.03it/s] 91%|█████████ | 186/204 [00:02<00:00, 94.08it/s] 96%|█████████▌| 196/204 [00:02<00:00, 94.71it/s]100%|██████████| 204/204 [00:02<00:00, 73.07it/s]
26032 images processed, 2.835771322250366 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:55,  1.40it/s] 14%|█▍        | 11/79 [00:00<00:03, 17.74it/s] 27%|██▋       | 21/79 [00:00<00:01, 32.88it/s] 39%|███▉      | 31/79 [00:01<00:01, 46.49it/s] 52%|█████▏    | 41/79 [00:01<00:00, 58.04it/s] 65%|██████▍   | 51/79 [00:01<00:00, 67.34it/s] 76%|███████▌  | 60/79 [00:01<00:00, 65.17it/s] 89%|████████▊ | 70/79 [00:01<00:00, 72.89it/s]100%|██████████| 79/79 [00:01<00:00, 49.90it/s]
10000 images processed, 1.6044085025787354 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.66it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.19it/s] 25%|██▌       | 20/79 [00:00<00:01, 34.54it/s] 38%|███▊      | 30/79 [00:00<00:01, 48.47it/s] 51%|█████     | 40/79 [00:01<00:00, 60.16it/s] 63%|██████▎   | 50/79 [00:01<00:00, 68.76it/s] 76%|███████▌  | 60/79 [00:01<00:00, 76.17it/s] 89%|████████▊ | 70/79 [00:01<00:00, 81.76it/s]100%|██████████| 79/79 [00:01<00:00, 54.44it/s]
10000 images processed, 1.4810798168182373 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.73it/s] 16%|█▌        | 11/70 [00:00<00:02, 20.78it/s] 30%|███       | 21/70 [00:00<00:01, 37.27it/s] 44%|████▍     | 31/70 [00:00<00:00, 51.12it/s] 59%|█████▊    | 41/70 [00:01<00:00, 62.01it/s] 73%|███████▎  | 51/70 [00:01<00:00, 70.89it/s] 87%|████████▋ | 61/70 [00:01<00:00, 77.88it/s]100%|██████████| 70/70 [00:01<00:00, 52.86it/s]
8925 images processed, 1.3664629459381104 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:49,  1.12s/it]  4%|▍         | 2/45 [00:01<00:24,  1.77it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.32it/s] 38%|███▊      | 17/45 [00:01<00:02, 12.25it/s] 60%|██████    | 27/45 [00:02<00:00, 22.68it/s] 73%|███████▎  | 33/45 [00:02<00:00, 15.89it/s] 96%|█████████▌| 43/45 [00:02<00:00, 24.57it/s]100%|██████████| 45/45 [00:02<00:00, 15.75it/s]
5640 images processed, 2.8910257816314697 seconds used

18.296507596969604
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.89  98.75  81.58
places365     60.92  83.07  47.77
LSUN          45.74  89.18  68.09
iSUN          40.48  90.58  71.20
dtd           35.50  90.89  75.67
AVG           37.31  90.49  68.86
[incremental] Overall: 0.6980 New: 0.7060 Old: 0.6940
[incremental] Final(Top-1): 0.6980  Average: 0.7617
8.503447532653809
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=5, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/5 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
 20%|██        | 1/5 [00:19<01:19, 19.80s/it] 40%|████      | 2/5 [00:29<00:42, 14.07s/it] 60%|██████    | 3/5 [00:39<00:24, 12.21s/it] 80%|████████  | 4/5 [00:49<00:11, 11.35s/it]100%|██████████| 5/5 [00:59<00:00, 10.76s/it]100%|██████████| 5/5 [00:59<00:00, 11.92s/it]
[loss] ep 0 it 0 total=13.1670 mle=2.3186 pcon=9.8395 forget=0.0000 orth=1.0089 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=13.1470 mle=2.2942 pcon=9.8440 forget=0.0000 orth=1.0089 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=13.2519 mle=2.3942 pcon=9.8490 forget=0.0000 orth=1.0088 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=13.1802 mle=2.3188 pcon=9.8526 forget=0.0000 orth=1.0087 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=12.8153 mle=1.9500 pcon=9.8567 forget=0.0000 orth=1.0086 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.0197 mle=2.1508 pcon=9.8605 forget=0.0000 orth=1.0085 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.4483 mle=2.5765 pcon=9.8634 forget=0.0000 orth=1.0084 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.0259 mle=2.1521 pcon=9.8655 forget=0.0000 orth=1.0083 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.0073 mle=2.1313 pcon=9.8677 forget=0.0000 orth=1.0083 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.0054 mle=2.1272 pcon=9.8700 forget=0.0000 orth=1.0082 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.1327 mle=2.2524 pcon=9.8720 forget=0.0000 orth=1.0082 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=13.3604 mle=2.4779 pcon=9.8744 forget=0.0000 orth=1.0081 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.2767 mle=2.3928 pcon=9.8758 forget=0.0000 orth=1.0081 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=12.9406 mle=2.0556 pcon=9.8770 forget=0.0000 orth=1.0081 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.2336 mle=2.3467 pcon=9.8788 forget=0.0000 orth=1.0081 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.1404 mle=2.2528 pcon=9.8795 forget=0.0000 orth=1.0081 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.0619 mle=2.1725 pcon=9.8813 forget=0.0000 orth=1.0080 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.1557 mle=2.2645 pcon=9.8833 forget=0.0000 orth=1.0080 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=12.9868 mle=2.0937 pcon=9.8851 forget=0.0000 orth=1.0080 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.0414 mle=2.1465 pcon=9.8870 forget=0.0000 orth=1.0079 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=12.6646 mle=1.7687 pcon=9.8880 forget=0.0000 orth=1.0079 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.1786 mle=2.2817 pcon=9.8889 forget=0.0000 orth=1.0079 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.2506 mle=2.3524 pcon=9.8903 forget=0.0000 orth=1.0079 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=12.7745 mle=1.8746 pcon=9.8920 forget=0.0000 orth=1.0079 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.1410 mle=2.2397 pcon=9.8935 forget=0.0000 orth=1.0078 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.2495 mle=2.3467 pcon=9.8952 forget=0.0000 orth=1.0077 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.2141 mle=2.3100 pcon=9.8964 forget=0.0000 orth=1.0077 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.0905 mle=2.1853 pcon=9.8976 forget=0.0000 orth=1.0076 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.0175 mle=2.1110 pcon=9.8989 forget=0.0000 orth=1.0076 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.0590 mle=2.1511 pcon=9.9004 forget=0.0000 orth=1.0075 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.0469 mle=2.1380 pcon=9.9015 forget=0.0000 orth=1.0074 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.1088 mle=2.1986 pcon=9.9029 forget=0.0000 orth=1.0073 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.0999 mle=2.1886 pcon=9.9040 forget=0.0000 orth=1.0072 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.1304 mle=2.2179 pcon=9.9053 forget=0.0000 orth=1.0072 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.2404 mle=2.3265 pcon=9.9067 forget=0.0000 orth=1.0072 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.9379 mle=2.0228 pcon=9.9080 forget=0.0000 orth=1.0071 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.9950 mle=2.0787 pcon=9.9094 forget=0.0000 orth=1.0069 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.9416 mle=2.0239 pcon=9.9109 forget=0.0000 orth=1.0068 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.2606 mle=2.3416 pcon=9.9122 forget=0.0000 orth=1.0068 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.9064 mle=1.9861 pcon=9.9136 forget=0.0000 orth=1.0067 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e5-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:30,  1.85it/s]  3%|▎         | 10/391 [00:00<00:18, 20.11it/s]  5%|▌         | 20/391 [00:00<00:09, 37.94it/s]  7%|▋         | 29/391 [00:00<00:07, 50.27it/s] 10%|▉         | 39/391 [00:00<00:05, 62.14it/s] 13%|█▎        | 49/391 [00:01<00:04, 71.10it/s] 15%|█▌        | 59/391 [00:01<00:04, 77.35it/s] 18%|█▊        | 69/391 [00:01<00:03, 82.60it/s] 20%|██        | 79/391 [00:01<00:03, 85.06it/s] 23%|██▎       | 89/391 [00:01<00:03, 87.87it/s] 25%|██▌       | 99/391 [00:01<00:03, 90.19it/s] 28%|██▊       | 109/391 [00:01<00:03, 90.60it/s] 30%|███       | 119/391 [00:01<00:02, 91.94it/s] 33%|███▎      | 129/391 [00:01<00:02, 92.13it/s] 36%|███▌      | 139/391 [00:02<00:02, 92.79it/s] 38%|███▊      | 149/391 [00:02<00:02, 92.87it/s] 41%|████      | 159/391 [00:02<00:02, 92.66it/s] 43%|████▎     | 169/391 [00:02<00:02, 92.49it/s] 46%|████▌     | 179/391 [00:02<00:02, 92.65it/s] 48%|████▊     | 189/391 [00:02<00:02, 93.15it/s] 51%|█████     | 199/391 [00:02<00:02, 93.00it/s] 53%|█████▎    | 209/391 [00:02<00:01, 92.78it/s] 56%|█████▌    | 219/391 [00:02<00:01, 93.34it/s] 59%|█████▊    | 229/391 [00:02<00:01, 94.00it/s] 61%|██████    | 239/391 [00:03<00:01, 94.49it/s] 64%|██████▎   | 249/391 [00:03<00:01, 94.57it/s] 66%|██████▌   | 259/391 [00:03<00:01, 95.00it/s] 69%|██████▉   | 269/391 [00:03<00:01, 94.50it/s] 71%|███████▏  | 279/391 [00:03<00:01, 94.70it/s] 74%|███████▍  | 289/391 [00:03<00:01, 84.69it/s] 76%|███████▋  | 299/391 [00:03<00:01, 87.62it/s] 79%|███████▉  | 309/391 [00:03<00:00, 89.93it/s] 82%|████████▏ | 319/391 [00:03<00:00, 91.00it/s] 84%|████████▍ | 329/391 [00:04<00:00, 91.99it/s] 87%|████████▋ | 339/391 [00:04<00:00, 92.88it/s] 89%|████████▉ | 349/391 [00:04<00:00, 93.62it/s] 92%|█████████▏| 359/391 [00:04<00:00, 93.15it/s] 94%|█████████▍| 369/391 [00:04<00:00, 94.46it/s] 97%|█████████▋| 379/391 [00:04<00:00, 95.33it/s] 99%|█████████▉| 389/391 [00:04<00:00, 95.98it/s]100%|██████████| 391/391 [00:04<00:00, 82.43it/s]
50000 images processed, 4.793656826019287 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.81it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.81it/s] 27%|██▋       | 21/79 [00:00<00:01, 38.94it/s] 39%|███▉      | 31/79 [00:00<00:00, 52.64it/s] 52%|█████▏    | 41/79 [00:00<00:00, 63.46it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.70it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.38it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.35it/s]100%|██████████| 79/79 [00:01<00:00, 42.35it/s]
10000 images processed, 1.8878908157348633 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:42,  1.99it/s]  5%|▌         | 11/204 [00:00<00:08, 23.22it/s] 10%|▉         | 20/204 [00:00<00:04, 38.84it/s] 15%|█▍        | 30/204 [00:00<00:03, 53.44it/s] 19%|█▉        | 39/204 [00:00<00:02, 62.16it/s] 24%|██▎       | 48/204 [00:01<00:02, 68.94it/s] 28%|██▊       | 58/204 [00:01<00:01, 76.38it/s] 33%|███▎      | 67/204 [00:01<00:01, 80.11it/s] 38%|███▊      | 77/204 [00:01<00:01, 84.57it/s] 43%|████▎     | 87/204 [00:01<00:01, 87.58it/s] 48%|████▊     | 97/204 [00:01<00:01, 89.68it/s] 52%|█████▏    | 107/204 [00:01<00:01, 90.03it/s] 57%|█████▋    | 117/204 [00:01<00:00, 89.31it/s] 62%|██████▏   | 127/204 [00:01<00:00, 80.89it/s] 67%|██████▋   | 136/204 [00:02<00:00, 81.89it/s] 71%|███████   | 145/204 [00:02<00:00, 83.28it/s] 76%|███████▌  | 155/204 [00:02<00:00, 86.72it/s] 80%|████████  | 164/204 [00:02<00:00, 86.79it/s] 85%|████████▍ | 173/204 [00:02<00:00, 84.92it/s] 90%|████████▉ | 183/204 [00:02<00:00, 88.06it/s] 95%|█████████▍| 193/204 [00:02<00:00, 90.49it/s]100%|█████████▉| 203/204 [00:02<00:00, 92.19it/s]100%|██████████| 204/204 [00:02<00:00, 73.27it/s]
26032 images processed, 2.829704761505127 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:53,  1.45it/s]  6%|▋         | 5/79 [00:00<00:09,  7.97it/s] 19%|█▉        | 15/79 [00:00<00:02, 25.64it/s] 32%|███▏      | 25/79 [00:01<00:01, 40.92it/s] 44%|████▍     | 35/79 [00:01<00:00, 53.53it/s] 57%|█████▋    | 45/79 [00:01<00:00, 63.96it/s] 70%|██████▉   | 55/79 [00:01<00:00, 72.09it/s] 82%|████████▏ | 65/79 [00:01<00:00, 77.79it/s] 95%|█████████▍| 75/79 [00:01<00:00, 83.02it/s]100%|██████████| 79/79 [00:01<00:00, 50.04it/s]
10000 images processed, 1.633298397064209 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:41,  1.87it/s] 13%|█▎        | 10/79 [00:00<00:03, 20.20it/s] 25%|██▌       | 20/79 [00:00<00:01, 38.04it/s] 38%|███▊      | 30/79 [00:00<00:00, 52.40it/s] 51%|█████     | 40/79 [00:00<00:00, 63.78it/s] 63%|██████▎   | 50/79 [00:01<00:00, 72.50it/s] 76%|███████▌  | 60/79 [00:01<00:00, 79.26it/s] 89%|████████▊ | 70/79 [00:01<00:00, 84.19it/s]100%|██████████| 79/79 [00:01<00:00, 58.30it/s]
10000 images processed, 1.3754098415374756 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:32,  2.14it/s] 13%|█▎        | 9/70 [00:00<00:03, 20.26it/s] 26%|██▌       | 18/70 [00:00<00:01, 37.29it/s] 40%|████      | 28/70 [00:00<00:00, 52.63it/s] 54%|█████▍    | 38/70 [00:00<00:00, 64.29it/s] 69%|██████▊   | 48/70 [00:00<00:00, 73.44it/s] 83%|████████▎ | 58/70 [00:01<00:00, 80.23it/s] 97%|█████████▋| 68/70 [00:01<00:00, 85.09it/s]100%|██████████| 70/70 [00:01<00:00, 57.36it/s]
8925 images processed, 1.2536890506744385 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:52,  1.19s/it] 24%|██▍       | 11/45 [00:01<00:02, 11.39it/s] 38%|███▊      | 17/45 [00:01<00:02, 12.09it/s] 51%|█████     | 23/45 [00:01<00:01, 16.82it/s] 73%|███████▎  | 33/45 [00:02<00:00, 18.69it/s] 93%|█████████▎| 42/45 [00:02<00:00, 20.89it/s]100%|██████████| 45/45 [00:02<00:00, 16.37it/s]
5640 images processed, 2.770266532897949 seconds used

18.510284900665283
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.16  98.71  84.56
places365     72.97  79.73  49.10
LSUN          48.72  88.56  71.38
iSUN          50.34  88.35  71.83
dtd           40.80  90.08  78.06
AVG           43.40  89.08  70.99
[incremental] Overall: 0.6215 New: 0.6220 Old: 0.6213
[incremental] Final(Top-1): 0.6215  Average: 0.7266
4.626675844192505
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.70it/s] 13%|█▎        | 10/79 [00:00<00:03, 18.73it/s] 25%|██▌       | 20/79 [00:00<00:01, 35.66it/s] 34%|███▍      | 27/79 [00:00<00:01, 40.96it/s] 43%|████▎     | 34/79 [00:01<00:01, 43.18it/s] 52%|█████▏    | 41/79 [00:01<00:00, 48.54it/s] 65%|██████▍   | 51/79 [00:01<00:00, 60.44it/s] 75%|███████▍  | 59/79 [00:01<00:00, 57.46it/s] 87%|████████▋ | 69/79 [00:01<00:00, 67.12it/s]100%|██████████| 79/79 [00:01<00:00, 47.95it/s]
10000 images processed, 1.6663596630096436 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:44,  1.56it/s] 13%|█▎        | 9/70 [00:00<00:03, 15.64it/s] 27%|██▋       | 19/70 [00:00<00:01, 32.29it/s] 40%|████      | 28/70 [00:00<00:00, 45.14it/s] 51%|█████▏    | 36/70 [00:01<00:00, 52.25it/s] 66%|██████▌   | 46/70 [00:01<00:00, 63.35it/s] 79%|███████▊  | 55/70 [00:01<00:00, 69.84it/s] 91%|█████████▏| 64/70 [00:01<00:00, 71.10it/s]100%|██████████| 70/70 [00:01<00:00, 47.62it/s]
8925 images processed, 1.507491111755371 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:58,  1.33s/it]  4%|▍         | 2/45 [00:01<00:30,  1.40it/s] 27%|██▋       | 12/45 [00:01<00:02, 11.70it/s] 38%|███▊      | 17/45 [00:02<00:02, 12.86it/s] 47%|████▋     | 21/45 [00:02<00:01, 12.55it/s] 69%|██████▉   | 31/45 [00:02<00:00, 22.99it/s] 80%|████████  | 36/45 [00:03<00:00, 15.51it/s]100%|██████████| 45/45 [00:03<00:00, 14.11it/s]
5640 images processed, 3.2089269161224365 seconds used

20.043335914611816
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.16  98.71  84.56
places365     72.97  79.73  49.10
LSUN          48.72  88.56  71.38
iSUN          50.34  88.35  71.83
dtd           40.80  90.08  78.06
AVG           43.40  89.08  70.99
[incremental] Overall: 0.6215 New: 0.6220 Old: 0.6213
[incremental] Final(Top-1): 0.6215  Average: 0.7266
6.355329751968384
[DEBUG] Parsed: avg_fpr=43.40 avg_auroc=89.08 final_top1=0.6215 average=0.7266
[Result] AVG-AUROC=89.08 AVG-FPR=43.40 Final-Top1=0.6215 Average=0.7266 Score=70.12

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=10 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=10, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/10 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
 10%|█         | 1/10 [00:15<02:19, 15.48s/it] 20%|██        | 2/10 [00:24<01:33, 11.75s/it] 30%|███       | 3/10 [00:32<01:11, 10.16s/it] 40%|████      | 4/10 [00:41<00:57,  9.58s/it] 50%|█████     | 5/10 [00:49<00:45,  9.15s/it] 60%|██████    | 6/10 [00:57<00:34,  8.68s/it][loss] ep 0 it 0 total=8.5895 mle=3.2130 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6441 mle=3.2647 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0878 mle=3.7057 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6783 mle=3.2935 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9792 mle=2.5920 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9918 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4733 mle=4.0810 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4955 mle=3.1007 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5368 mle=3.1398 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2413 mle=2.8417 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7243 mle=3.3224 pcon=5.4019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0961 mle=3.6916 pcon=5.4045 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4458 mle=4.0386 pcon=5.4072 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3582 mle=2.9487 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0699 mle=3.6581 pcon=5.4118 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5544 mle=3.1402 pcon=5.4141 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5076 mle=3.0907 pcon=5.4169 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6320 mle=3.2130 pcon=5.4189 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2433 mle=2.8213 pcon=5.4220 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4330 mle=3.0086 pcon=5.4244 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7380 mle=2.3110 pcon=5.4269 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6782 mle=3.2489 pcon=5.4293 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8372 mle=3.4054 pcon=5.4318 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7149 mle=2.2804 pcon=5.4344 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.2998 mle=2.8636 pcon=5.4361 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4255 mle=2.9875 pcon=5.4380 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1013 mle=2.6614 pcon=5.4399 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9322 mle=2.4906 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6430 mle=2.2004 pcon=5.4426 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6507 mle=2.2065 pcon=5.4442 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6233 mle=2.1786 pcon=5.4446 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6688 mle=2.2232 pcon=5.4456 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6919 mle=2.2452 pcon=5.4468 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6985 mle=2.2507 pcon=5.4478 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7880 mle=2.3396 pcon=5.4484 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4442 mle=1.9940 pcon=5.4503 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4892 mle=2.0371 pcon=5.4521 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4849 mle=2.0301 pcon=5.4548 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9108 mle=2.4539 pcon=5.4569 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4957 mle=2.0364 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 5 it 45 total=7.5989 mle=2.1380 pcon=5.4609 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.5303 mle=2.0671 pcon=5.4632 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.5470 mle=2.0818 pcon=5.4652 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.6398 mle=2.1722 pcon=5.4676 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.6795 mle=2.2099 pcon=5.4696 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.3914 mle=1.9190 pcon=5.4724 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7725 mle=2.2973 pcon=5.4751 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 6 it 4 total=7.6268 mle=2.1493 pcon=5.4775 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.7450 mle=2.2647 pcon=5.4803 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.5333 mle=2.0504 pcon=5.4829 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.3495 mle=1.8649 pcon=5.4846 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.5081 mle=2.0203 pcon=5.4878 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
 70%|███████   | 7/10 [01:06<00:26,  8.73s/it] 80%|████████  | 8/10 [01:14<00:17,  8.56s/it] 90%|█████████ | 9/10 [01:23<00:08,  8.63s/it]100%|██████████| 10/10 [01:32<00:00,  8.66s/it]100%|██████████| 10/10 [01:32<00:00,  9.23s/it]
[loss] ep 6 it 254 total=7.5030 mle=2.0122 pcon=5.4908 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.9123 mle=2.4185 pcon=5.4938 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.4511 mle=1.9539 pcon=5.4972 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 13 total=7.7899 mle=2.2892 pcon=5.5007 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.9123 mle=2.4082 pcon=5.5041 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.7383 mle=2.2307 pcon=5.5076 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.8008 mle=2.2896 pcon=5.5112 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.5629 mle=2.0487 pcon=5.5142 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.6839 mle=2.1655 pcon=5.5184 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.5470 mle=2.0252 pcon=5.5217 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.6893 mle=2.1636 pcon=5.5257 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 22 total=7.6968 mle=2.1676 pcon=5.5292 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.5196 mle=1.9873 pcon=5.5323 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.3985 mle=1.8632 pcon=5.5353 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=7.3097 mle=1.7706 pcon=5.5391 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=7.3352 mle=1.7921 pcon=5.5431 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.5150 mle=1.9685 pcon=5.5465 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=7.5382 mle=1.9884 pcon=5.5498 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=7.7814 mle=2.2278 pcon=5.5536 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 31 total=7.9267 mle=2.3703 pcon=5.5564 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=7.6418 mle=2.0818 pcon=5.5600 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=7.4833 mle=1.9206 pcon=5.5628 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=7.6007 mle=2.0348 pcon=5.5659 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=7.5366 mle=1.9671 pcon=5.5695 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=7.5924 mle=2.0194 pcon=5.5730 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=7.6971 mle=2.1210 pcon=5.5761 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=7.5190 mle=1.9397 pcon=5.5792 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:12,  1.54it/s]  3%|▎         | 11/391 [00:00<00:19, 19.14it/s]  5%|▌         | 21/391 [00:00<00:10, 34.91it/s]  8%|▊         | 31/391 [00:00<00:07, 48.83it/s] 10%|█         | 41/391 [00:01<00:05, 60.41it/s] 13%|█▎        | 51/391 [00:01<00:04, 68.88it/s] 16%|█▌        | 61/391 [00:01<00:04, 73.10it/s] 18%|█▊        | 71/391 [00:01<00:04, 78.96it/s] 21%|██        | 81/391 [00:01<00:03, 83.30it/s] 23%|██▎       | 91/391 [00:01<00:03, 84.54it/s] 26%|██▌       | 101/391 [00:01<00:03, 87.22it/s] 28%|██▊       | 111/391 [00:01<00:03, 87.22it/s] 31%|███       | 121/391 [00:01<00:03, 88.80it/s] 34%|███▎      | 131/391 [00:02<00:02, 90.46it/s] 36%|███▌      | 141/391 [00:02<00:02, 91.36it/s] 39%|███▊      | 151/391 [00:02<00:02, 90.99it/s] 41%|████      | 161/391 [00:02<00:02, 84.93it/s] 44%|████▎     | 171/391 [00:02<00:02, 86.89it/s] 46%|████▌     | 180/391 [00:02<00:02, 84.71it/s] 49%|████▊     | 190/391 [00:02<00:02, 87.40it/s] 51%|█████     | 200/391 [00:02<00:02, 89.01it/s] 53%|█████▎    | 209/391 [00:02<00:02, 86.32it/s] 56%|█████▌    | 218/391 [00:03<00:02, 72.61it/s] 58%|█████▊    | 227/391 [00:03<00:02, 75.29it/s] 61%|██████    | 237/391 [00:03<00:01, 79.93it/s] 63%|██████▎   | 247/391 [00:03<00:01, 83.95it/s] 66%|██████▌   | 257/391 [00:03<00:01, 87.27it/s] 68%|██████▊   | 266/391 [00:03<00:01, 86.61it/s] 71%|███████   | 276/391 [00:03<00:01, 89.19it/s] 73%|███████▎  | 286/391 [00:03<00:01, 91.07it/s] 76%|███████▌  | 296/391 [00:03<00:01, 92.20it/s] 78%|███████▊  | 306/391 [00:04<00:00, 92.98it/s] 81%|████████  | 316/391 [00:04<00:00, 93.72it/s] 83%|████████▎ | 326/391 [00:04<00:00, 93.92it/s] 86%|████████▌ | 336/391 [00:04<00:00, 94.34it/s] 88%|████████▊ | 346/391 [00:04<00:00, 81.09it/s] 91%|█████████ | 355/391 [00:04<00:00, 76.08it/s] 93%|█████████▎| 365/391 [00:04<00:00, 80.95it/s] 96%|█████████▌| 375/391 [00:04<00:00, 85.38it/s] 98%|█████████▊| 385/391 [00:05<00:00, 88.72it/s]100%|██████████| 391/391 [00:05<00:00, 76.28it/s]
50000 images processed, 5.176676034927368 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.05it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.99it/s] 27%|██▋       | 21/79 [00:00<00:01, 41.88it/s] 39%|███▉      | 31/79 [00:00<00:00, 55.80it/s] 51%|█████     | 40/79 [00:00<00:00, 55.04it/s] 63%|██████▎   | 50/79 [00:01<00:00, 65.17it/s] 75%|███████▍  | 59/79 [00:01<00:00, 70.04it/s] 87%|████████▋ | 69/79 [00:01<00:00, 77.23it/s]100%|██████████| 79/79 [00:01<00:00, 78.20it/s]100%|██████████| 79/79 [00:01<00:00, 55.91it/s]
10000 images processed, 1.4256508350372314 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:25,  1.39it/s]  5%|▌         | 11/204 [00:00<00:10, 17.59it/s] 10%|█         | 21/204 [00:00<00:05, 32.94it/s] 15%|█▌        | 31/204 [00:01<00:03, 46.36it/s] 20%|██        | 41/204 [00:01<00:02, 57.38it/s] 25%|██▌       | 51/204 [00:01<00:02, 65.89it/s] 30%|██▉       | 61/204 [00:01<00:01, 72.90it/s] 35%|███▍      | 71/204 [00:01<00:01, 78.61it/s] 40%|███▉      | 81/204 [00:01<00:01, 82.13it/s] 45%|████▍     | 91/204 [00:01<00:01, 85.32it/s] 50%|████▉     | 101/204 [00:01<00:01, 87.00it/s] 54%|█████▍    | 111/204 [00:01<00:01, 88.65it/s] 59%|█████▉    | 121/204 [00:02<00:00, 88.90it/s] 64%|██████▍   | 131/204 [00:02<00:00, 89.52it/s] 69%|██████▉   | 141/204 [00:02<00:00, 90.16it/s] 74%|███████▍  | 151/204 [00:02<00:00, 90.58it/s] 79%|███████▉  | 161/204 [00:02<00:00, 91.52it/s] 84%|████████▍ | 171/204 [00:02<00:00, 92.32it/s] 89%|████████▊ | 181/204 [00:02<00:00, 93.03it/s] 94%|█████████▎| 191/204 [00:02<00:00, 94.09it/s] 99%|█████████▊| 201/204 [00:02<00:00, 94.70it/s]100%|██████████| 204/204 [00:02<00:00, 70.05it/s]
26032 images processed, 2.9528310298919678 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:53,  1.46it/s]  5%|▌         | 4/79 [00:00<00:11,  6.36it/s] 18%|█▊        | 14/79 [00:00<00:02, 24.49it/s] 27%|██▋       | 21/79 [00:01<00:01, 33.90it/s] 38%|███▊      | 30/79 [00:01<00:01, 46.95it/s] 47%|████▋     | 37/79 [00:01<00:00, 51.71it/s] 59%|█████▉    | 47/79 [00:01<00:00, 62.86it/s] 70%|██████▉   | 55/79 [00:01<00:00, 62.95it/s] 80%|███████▉  | 63/79 [00:01<00:00, 61.01it/s] 89%|████████▊ | 70/79 [00:01<00:00, 58.25it/s] 97%|█████████▋| 77/79 [00:01<00:00, 55.81it/s]100%|██████████| 79/79 [00:01<00:00, 41.65it/s]
10000 images processed, 1.9719035625457764 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:55,  1.39it/s] 10%|█         | 8/79 [00:00<00:05, 12.75it/s] 23%|██▎       | 18/79 [00:00<00:02, 28.99it/s] 35%|███▌      | 28/79 [00:01<00:01, 43.12it/s] 48%|████▊     | 38/79 [00:01<00:00, 54.94it/s] 59%|█████▉    | 47/79 [00:01<00:00, 63.42it/s] 72%|███████▏  | 57/79 [00:01<00:00, 72.18it/s] 85%|████████▍ | 67/79 [00:01<00:00, 78.87it/s] 97%|█████████▋| 77/79 [00:01<00:00, 83.87it/s]100%|██████████| 79/79 [00:01<00:00, 50.28it/s]
10000 images processed, 1.5889220237731934 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:53,  1.29it/s]  9%|▊         | 6/70 [00:00<00:07,  8.77it/s] 21%|██▏       | 15/70 [00:00<00:02, 23.12it/s] 36%|███▌      | 25/70 [00:01<00:01, 38.09it/s] 50%|█████     | 35/70 [00:01<00:00, 50.77it/s] 64%|██████▍   | 45/70 [00:01<00:00, 61.35it/s] 79%|███████▊  | 55/70 [00:01<00:00, 70.38it/s] 93%|█████████▎| 65/70 [00:01<00:00, 77.35it/s]100%|██████████| 70/70 [00:01<00:00, 44.11it/s]
8925 images processed, 1.6279981136322021 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:56,  1.30s/it]  4%|▍         | 2/45 [00:01<00:26,  1.64it/s] 16%|█▌        | 7/45 [00:01<00:05,  7.46it/s] 31%|███       | 14/45 [00:01<00:02, 14.97it/s] 40%|████      | 18/45 [00:01<00:01, 14.67it/s] 47%|████▋     | 21/45 [00:02<00:01, 15.99it/s] 53%|█████▎    | 24/45 [00:02<00:01, 18.19it/s] 67%|██████▋   | 30/45 [00:02<00:00, 24.87it/s] 76%|███████▌  | 34/45 [00:02<00:00, 15.73it/s] 98%|█████████▊| 44/45 [00:02<00:00, 27.53it/s]100%|██████████| 45/45 [00:02<00:00, 15.16it/s]
5640 images processed, 2.991020441055298 seconds used

19.866769552230835
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.60
places365     49.91  89.49  51.36
LSUN          25.94  95.19  76.04
iSUN          26.01  95.03  73.73
dtd           24.68  94.43  71.73
AVG           26.02  94.63  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
3.458090305328369
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=10, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/10 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
 10%|█         | 1/10 [00:18<02:49, 18.85s/it] 20%|██        | 2/10 [00:31<02:02, 15.35s/it] 30%|███       | 3/10 [00:42<01:31, 13.14s/it] 40%|████      | 4/10 [00:53<01:13, 12.29s/it] 50%|█████     | 5/10 [01:04<00:59, 11.86s/it] 60%|██████    | 6/10 [01:16<00:47, 11.99s/it][loss] ep 0 it 0 total=12.0908 mle=2.3145 pcon=8.7277 forget=0.0000 orth=1.0486 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0666 mle=2.2862 pcon=8.7319 forget=0.0000 orth=1.0485 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2136 mle=2.4300 pcon=8.7353 forget=0.0000 orth=1.0484 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1216 mle=2.3346 pcon=8.7388 forget=0.0000 orth=1.0482 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7748 mle=1.9851 pcon=8.7417 forget=0.0000 orth=1.0480 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=11.9872 mle=2.1951 pcon=8.7444 forget=0.0000 orth=1.0477 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4181 mle=2.6241 pcon=8.7466 forget=0.0000 orth=1.0474 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9928 mle=2.1975 pcon=8.7482 forget=0.0000 orth=1.0471 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9501 mle=2.1529 pcon=8.7504 forget=0.0000 orth=1.0467 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9380 mle=2.1393 pcon=8.7523 forget=0.0000 orth=1.0463 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0895 mle=2.2897 pcon=8.7539 forget=0.0000 orth=1.0459 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3273 mle=2.5263 pcon=8.7556 forget=0.0000 orth=1.0454 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2573 mle=2.4555 pcon=8.7567 forget=0.0000 orth=1.0450 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.8904 mle=2.0880 pcon=8.7579 forget=0.0000 orth=1.0445 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.1924 mle=2.3893 pcon=8.7592 forget=0.0000 orth=1.0439 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0808 mle=2.2773 pcon=8.7602 forget=0.0000 orth=1.0433 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0150 mle=2.2114 pcon=8.7610 forget=0.0000 orth=1.0425 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0752 mle=2.2713 pcon=8.7621 forget=0.0000 orth=1.0418 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9124 mle=2.1076 pcon=8.7636 forget=0.0000 orth=1.0411 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9621 mle=2.1571 pcon=8.7647 forget=0.0000 orth=1.0403 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5838 mle=1.7782 pcon=8.7659 forget=0.0000 orth=1.0396 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1267 mle=2.3213 pcon=8.7665 forget=0.0000 orth=1.0388 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1812 mle=2.3760 pcon=8.7674 forget=0.0000 orth=1.0379 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6931 mle=1.8873 pcon=8.7687 forget=0.0000 orth=1.0370 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0740 mle=2.2688 pcon=8.7691 forget=0.0000 orth=1.0360 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1937 mle=2.3885 pcon=8.7703 forget=0.0000 orth=1.0349 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1311 mle=2.3261 pcon=8.7710 forget=0.0000 orth=1.0339 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0204 mle=2.2153 pcon=8.7722 forget=0.0000 orth=1.0329 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9359 mle=2.1307 pcon=8.7734 forget=0.0000 orth=1.0318 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9652 mle=2.1601 pcon=8.7745 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9501 mle=2.1455 pcon=8.7752 forget=0.0000 orth=1.0293 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.0058 mle=2.2017 pcon=8.7760 forget=0.0000 orth=1.0281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0140 mle=2.2096 pcon=8.7775 forget=0.0000 orth=1.0268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0256 mle=2.2212 pcon=8.7786 forget=0.0000 orth=1.0259 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1450 mle=2.3408 pcon=8.7796 forget=0.0000 orth=1.0247 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8311 mle=2.0273 pcon=8.7803 forget=0.0000 orth=1.0234 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8797 mle=2.0766 pcon=8.7812 forget=0.0000 orth=1.0219 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8367 mle=2.0335 pcon=8.7826 forget=0.0000 orth=1.0206 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1785 mle=2.3753 pcon=8.7836 forget=0.0000 orth=1.0196 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.8035 mle=2.0002 pcon=8.7850 forget=0.0000 orth=1.0184 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 5 it 45 total=11.9765 mle=2.1738 pcon=8.7856 forget=0.0000 orth=1.0170 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=11.8750 mle=2.0728 pcon=8.7868 forget=0.0000 orth=1.0154 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=11.9057 mle=2.1040 pcon=8.7875 forget=0.0000 orth=1.0142 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=11.9913 mle=2.1896 pcon=8.7890 forget=0.0000 orth=1.0127 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.0464 mle=2.2448 pcon=8.7902 forget=0.0000 orth=1.0114 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=11.7280 mle=1.9259 pcon=8.7922 forget=0.0000 orth=1.0100 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.1237 mle=2.3213 pcon=8.7938 forget=0.0000 orth=1.0086 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 6 it 4 total=11.9788 mle=2.1771 pcon=8.7944 forget=0.0000 orth=1.0074 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.0673 mle=2.2651 pcon=8.7961 forget=0.0000 orth=1.0061 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.8458 mle=2.0433 pcon=8.7980 forget=0.0000 orth=1.0046 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.6712 mle=1.8693 pcon=8.7987 forget=0.0000 orth=1.0032 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
 70%|███████   | 7/10 [01:28<00:36, 12.02s/it] 80%|████████  | 8/10 [01:39<00:23, 11.52s/it] 90%|█████████ | 9/10 [01:50<00:11, 11.37s/it]100%|██████████| 10/10 [02:01<00:00, 11.23s/it]100%|██████████| 10/10 [02:01<00:00, 12.11s/it]
[loss] ep 6 it 204 total=11.8449 mle=2.0434 pcon=8.7999 forget=0.0000 orth=1.0016 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.8538 mle=2.0526 pcon=8.8009 forget=0.0000 orth=1.0003 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2113 mle=2.4097 pcon=8.8025 forget=0.0000 orth=0.9991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.7711 mle=1.9694 pcon=8.8040 forget=0.0000 orth=0.9977 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 7 it 13 total=12.1376 mle=2.3355 pcon=8.8057 forget=0.0000 orth=0.9965 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2206 mle=2.4182 pcon=8.8072 forget=0.0000 orth=0.9952 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0889 mle=2.2865 pcon=8.8087 forget=0.0000 orth=0.9937 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1136 mle=2.3104 pcon=8.8108 forget=0.0000 orth=0.9924 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9123 mle=2.1098 pcon=8.8114 forget=0.0000 orth=0.9911 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9890 mle=2.1855 pcon=8.8137 forget=0.0000 orth=0.9898 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8658 mle=2.0618 pcon=8.8155 forget=0.0000 orth=0.9885 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0132 mle=2.2090 pcon=8.8172 forget=0.0000 orth=0.9870 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 8 it 22 total=11.9793 mle=2.1749 pcon=8.8184 forget=0.0000 orth=0.9860 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8126 mle=2.0083 pcon=8.8198 forget=0.0000 orth=0.9845 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7032 mle=1.8991 pcon=8.8210 forget=0.0000 orth=0.9831 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5988 mle=1.7945 pcon=8.8225 forget=0.0000 orth=0.9818 favg=0.0000 nr=124 nf=1 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6303 mle=1.8259 pcon=8.8241 forget=0.0000 orth=0.9803 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.7918 mle=1.9878 pcon=8.8250 forget=0.0000 orth=0.9791 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8223 mle=2.0182 pcon=8.8264 forget=0.0000 orth=0.9777 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0350 mle=2.2301 pcon=8.8286 forget=0.0000 orth=0.9763 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 9 it 31 total=12.1875 mle=2.3827 pcon=8.8300 forget=0.0000 orth=0.9748 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9306 mle=2.1261 pcon=8.8310 forget=0.0000 orth=0.9736 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7378 mle=1.9342 pcon=8.8317 forget=0.0000 orth=0.9719 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8460 mle=2.0426 pcon=8.8325 forget=0.0000 orth=0.9709 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7755 mle=1.9712 pcon=8.8352 forget=0.0000 orth=0.9691 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8323 mle=2.0280 pcon=8.8369 forget=0.0000 orth=0.9674 favg=0.0000 nr=122 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9323 mle=2.1280 pcon=8.8388 forget=0.0000 orth=0.9656 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7589 mle=1.9543 pcon=8.8403 forget=0.0000 orth=0.9642 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:27,  1.88it/s]  3%|▎         | 11/391 [00:00<00:17, 22.25it/s]  5%|▌         | 21/391 [00:00<00:09, 39.67it/s]  8%|▊         | 31/391 [00:00<00:06, 53.86it/s] 10%|█         | 41/391 [00:00<00:05, 64.77it/s] 13%|█▎        | 51/391 [00:01<00:04, 72.99it/s] 16%|█▌        | 61/391 [00:01<00:04, 79.35it/s] 18%|█▊        | 71/391 [00:01<00:03, 83.09it/s] 21%|██        | 81/391 [00:01<00:03, 84.07it/s] 23%|██▎       | 91/391 [00:01<00:03, 87.15it/s] 26%|██▌       | 101/391 [00:01<00:03, 88.89it/s] 28%|██▊       | 111/391 [00:01<00:03, 90.76it/s] 31%|███       | 121/391 [00:01<00:02, 92.06it/s] 34%|███▎      | 131/391 [00:01<00:02, 92.98it/s] 36%|███▌      | 141/391 [00:02<00:02, 93.68it/s] 39%|███▊      | 151/391 [00:02<00:02, 92.75it/s] 41%|████      | 161/391 [00:02<00:02, 93.73it/s] 44%|████▎     | 171/391 [00:02<00:02, 94.41it/s] 46%|████▋     | 181/391 [00:02<00:02, 94.73it/s] 49%|████▉     | 191/391 [00:02<00:02, 94.02it/s] 51%|█████▏    | 201/391 [00:02<00:02, 93.19it/s] 54%|█████▍    | 211/391 [00:02<00:01, 93.99it/s] 57%|█████▋    | 221/391 [00:02<00:01, 94.28it/s] 59%|█████▉    | 231/391 [00:02<00:01, 94.47it/s] 62%|██████▏   | 241/391 [00:03<00:01, 94.81it/s] 64%|██████▍   | 251/391 [00:03<00:01, 94.82it/s] 67%|██████▋   | 261/391 [00:03<00:01, 95.04it/s] 69%|██████▉   | 271/391 [00:03<00:01, 95.31it/s] 72%|███████▏  | 281/391 [00:03<00:01, 94.29it/s] 74%|███████▍  | 291/391 [00:03<00:01, 94.52it/s] 77%|███████▋  | 301/391 [00:03<00:00, 94.71it/s] 80%|███████▉  | 311/391 [00:03<00:00, 94.49it/s] 82%|████████▏ | 321/391 [00:03<00:00, 94.86it/s] 85%|████████▍ | 331/391 [00:04<00:00, 94.93it/s] 87%|████████▋ | 341/391 [00:04<00:00, 95.24it/s] 90%|████████▉ | 351/391 [00:04<00:00, 95.29it/s] 92%|█████████▏| 361/391 [00:04<00:00, 93.98it/s] 95%|█████████▍| 371/391 [00:04<00:00, 95.04it/s] 97%|█████████▋| 381/391 [00:04<00:00, 95.84it/s]100%|██████████| 391/391 [00:04<00:00, 93.38it/s]100%|██████████| 391/391 [00:04<00:00, 83.72it/s]
50000 images processed, 4.727433443069458 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:42,  1.84it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.98it/s] 27%|██▋       | 21/79 [00:00<00:01, 39.12it/s] 39%|███▉      | 31/79 [00:00<00:00, 53.20it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.19it/s] 65%|██████▍   | 51/79 [00:01<00:00, 72.82it/s] 77%|███████▋  | 61/79 [00:01<00:00, 79.63it/s] 90%|████████▉ | 71/79 [00:01<00:00, 84.71it/s]100%|██████████| 79/79 [00:01<00:00, 42.26it/s]
10000 images processed, 1.8856244087219238 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:56,  1.74it/s]  5%|▌         | 11/204 [00:00<00:09, 20.95it/s] 10%|▉         | 20/204 [00:00<00:05, 35.65it/s] 14%|█▍        | 29/204 [00:00<00:03, 48.27it/s] 19%|█▉        | 39/204 [00:00<00:02, 59.86it/s] 24%|██▍       | 49/204 [00:01<00:02, 68.96it/s] 29%|██▉       | 59/204 [00:01<00:01, 75.34it/s] 33%|███▎      | 68/204 [00:01<00:01, 79.17it/s] 38%|███▊      | 78/204 [00:01<00:01, 83.36it/s] 43%|████▎     | 88/204 [00:01<00:01, 85.76it/s] 48%|████▊     | 98/204 [00:01<00:01, 86.31it/s] 52%|█████▏    | 107/204 [00:01<00:01, 86.01it/s] 57%|█████▋    | 117/204 [00:01<00:00, 88.53it/s] 62%|██████▏   | 127/204 [00:01<00:00, 89.73it/s] 67%|██████▋   | 137/204 [00:02<00:00, 90.56it/s] 72%|███████▏  | 147/204 [00:02<00:00, 91.35it/s] 77%|███████▋  | 157/204 [00:02<00:00, 91.82it/s] 82%|████████▏ | 167/204 [00:02<00:00, 92.36it/s] 87%|████████▋ | 177/204 [00:02<00:00, 93.32it/s] 92%|█████████▏| 187/204 [00:02<00:00, 94.47it/s] 97%|█████████▋| 197/204 [00:02<00:00, 95.27it/s]100%|██████████| 204/204 [00:02<00:00, 73.32it/s]
26032 images processed, 2.825512409210205 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.59it/s] 13%|█▎        | 10/79 [00:00<00:03, 17.79it/s] 23%|██▎       | 18/79 [00:01<00:02, 22.47it/s] 35%|███▌      | 28/79 [00:01<00:01, 35.97it/s] 48%|████▊     | 38/79 [00:01<00:00, 48.42it/s] 61%|██████    | 48/79 [00:01<00:00, 59.17it/s] 73%|███████▎  | 58/79 [00:01<00:00, 68.26it/s] 86%|████████▌ | 68/79 [00:01<00:00, 75.69it/s] 99%|█████████▊| 78/79 [00:01<00:00, 81.46it/s]100%|██████████| 79/79 [00:01<00:00, 48.20it/s]
10000 images processed, 1.656782865524292 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.68it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.42it/s] 27%|██▋       | 21/79 [00:00<00:01, 37.06it/s] 39%|███▉      | 31/79 [00:00<00:00, 51.08it/s] 52%|█████▏    | 41/79 [00:01<00:00, 62.25it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.23it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.25it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.57it/s]100%|██████████| 79/79 [00:01<00:00, 56.25it/s]
10000 images processed, 1.421396017074585 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:38,  1.80it/s] 16%|█▌        | 11/70 [00:00<00:02, 21.43it/s] 29%|██▊       | 20/70 [00:00<00:01, 36.44it/s] 43%|████▎     | 30/70 [00:00<00:00, 50.99it/s] 57%|█████▋    | 40/70 [00:00<00:00, 60.57it/s] 71%|███████▏  | 50/70 [00:01<00:00, 70.04it/s] 86%|████████▌ | 60/70 [00:01<00:00, 77.41it/s]100%|██████████| 70/70 [00:01<00:00, 81.77it/s]100%|██████████| 70/70 [00:01<00:00, 53.50it/s]
8925 images processed, 1.33674955368042 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:50,  1.15s/it]  4%|▍         | 2/45 [00:01<00:23,  1.86it/s] 27%|██▋       | 12/45 [00:01<00:02, 15.06it/s] 38%|███▊      | 17/45 [00:01<00:01, 14.59it/s] 47%|████▋     | 21/45 [00:01<00:01, 17.99it/s] 56%|█████▌    | 25/45 [00:01<00:00, 20.21it/s] 73%|███████▎  | 33/45 [00:02<00:00, 18.84it/s] 80%|████████  | 36/45 [00:02<00:00, 20.12it/s]100%|██████████| 45/45 [00:02<00:00, 17.10it/s]
5640 images processed, 2.649768829345703 seconds used

18.205145359039307
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.84  98.87  79.06
places365     53.69  85.18  47.47
LSUN          45.03  89.47  62.60
iSUN          36.45  91.38  65.70
dtd           33.28  92.15  73.50
AVG           34.46  91.41  65.67
[incremental] Overall: 0.7380 New: 0.7220 Old: 0.7540
[incremental] Final(Top-1): 0.7380  Average: 0.7930
4.005035400390625
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=10, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/10 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
 10%|█         | 1/10 [00:18<02:43, 18.13s/it] 20%|██        | 2/10 [00:29<01:53, 14.20s/it] 30%|███       | 3/10 [00:41<01:31, 13.14s/it] 40%|████      | 4/10 [00:53<01:16, 12.81s/it] 50%|█████     | 5/10 [01:05<01:02, 12.41s/it] 60%|██████    | 6/10 [01:17<00:49, 12.45s/it][loss] ep 0 it 0 total=12.7932 mle=2.3182 pcon=9.4392 forget=0.0000 orth=1.0357 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.7670 mle=2.2876 pcon=9.4436 forget=0.0000 orth=1.0357 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.9121 mle=2.4283 pcon=9.4482 forget=0.0000 orth=1.0356 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.7820 mle=2.2940 pcon=9.4526 forget=0.0000 orth=1.0355 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=12.4356 mle=1.9433 pcon=9.4570 forget=0.0000 orth=1.0353 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=12.5978 mle=2.1024 pcon=9.4603 forget=0.0000 orth=1.0350 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.0653 mle=2.5662 pcon=9.4643 forget=0.0000 orth=1.0348 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=12.6585 mle=2.1560 pcon=9.4680 forget=0.0000 orth=1.0345 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=12.6531 mle=2.1476 pcon=9.4713 forget=0.0000 orth=1.0342 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=12.6174 mle=2.1095 pcon=9.4741 forget=0.0000 orth=1.0338 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.7747 mle=2.2638 pcon=9.4775 forget=0.0000 orth=1.0334 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.9774 mle=2.4644 pcon=9.4800 forget=0.0000 orth=1.0330 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.9025 mle=2.3879 pcon=9.4821 forget=0.0000 orth=1.0325 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=12.5660 mle=2.0499 pcon=9.4841 forget=0.0000 orth=1.0320 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.8533 mle=2.3353 pcon=9.4865 forget=0.0000 orth=1.0315 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.7573 mle=2.2374 pcon=9.4890 forget=0.0000 orth=1.0309 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=12.6791 mle=2.1575 pcon=9.4913 forget=0.0000 orth=1.0303 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.7967 mle=2.2735 pcon=9.4935 forget=0.0000 orth=1.0296 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=12.5984 mle=2.0734 pcon=9.4960 forget=0.0000 orth=1.0290 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=12.6786 mle=2.1521 pcon=9.4982 forget=0.0000 orth=1.0283 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=12.2868 mle=1.7583 pcon=9.5010 forget=0.0000 orth=1.0275 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.7863 mle=2.2568 pcon=9.5027 forget=0.0000 orth=1.0268 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.8622 mle=2.3313 pcon=9.5050 forget=0.0000 orth=1.0259 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=12.3931 mle=1.8605 pcon=9.5075 forget=0.0000 orth=1.0251 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=12.7475 mle=2.2135 pcon=9.5099 forget=0.0000 orth=1.0242 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.8529 mle=2.3172 pcon=9.5124 forget=0.0000 orth=1.0232 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.8333 mle=2.2968 pcon=9.5143 forget=0.0000 orth=1.0222 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.7002 mle=2.1627 pcon=9.5163 forget=0.0000 orth=1.0212 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=12.6388 mle=2.1004 pcon=9.5181 forget=0.0000 orth=1.0202 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=12.6952 mle=2.1556 pcon=9.5205 forget=0.0000 orth=1.0191 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=12.6674 mle=2.1272 pcon=9.5222 forget=0.0000 orth=1.0180 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.7344 mle=2.1930 pcon=9.5245 forget=0.0000 orth=1.0169 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=12.7183 mle=2.1759 pcon=9.5267 forget=0.0000 orth=1.0157 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.7494 mle=2.2061 pcon=9.5288 forget=0.0000 orth=1.0146 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.8506 mle=2.3064 pcon=9.5308 forget=0.0000 orth=1.0133 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.5634 mle=2.0187 pcon=9.5327 forget=0.0000 orth=1.0120 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.6109 mle=2.0658 pcon=9.5344 forget=0.0000 orth=1.0107 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.5576 mle=2.0121 pcon=9.5361 forget=0.0000 orth=1.0094 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.8616 mle=2.3155 pcon=9.5380 forget=0.0000 orth=1.0080 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.5268 mle=1.9804 pcon=9.5398 forget=0.0000 orth=1.0066 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 5 it 45 total=12.7077 mle=2.1614 pcon=9.5413 forget=0.0000 orth=1.0051 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.6147 mle=2.0678 pcon=9.5433 forget=0.0000 orth=1.0036 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.6313 mle=2.0839 pcon=9.5454 forget=0.0000 orth=1.0021 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.6997 mle=2.1518 pcon=9.5474 forget=0.0000 orth=1.0005 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.7779 mle=2.2297 pcon=9.5493 forget=0.0000 orth=0.9990 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.4596 mle=1.9106 pcon=9.5516 forget=0.0000 orth=0.9974 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.8419 mle=2.2926 pcon=9.5536 forget=0.0000 orth=0.9957 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 6 it 4 total=12.7221 mle=2.1724 pcon=9.5557 forget=0.0000 orth=0.9940 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.7746 mle=2.2250 pcon=9.5573 forget=0.0000 orth=0.9923 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.5693 mle=2.0193 pcon=9.5594 forget=0.0000 orth=0.9906 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.4082 mle=1.8585 pcon=9.5609 forget=0.0000 orth=0.9888 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
 70%|███████   | 7/10 [01:29<00:36, 12.15s/it] 80%|████████  | 8/10 [01:40<00:23, 11.67s/it] 90%|█████████ | 9/10 [01:52<00:11, 11.74s/it]100%|██████████| 10/10 [02:02<00:00, 11.43s/it]100%|██████████| 10/10 [02:02<00:00, 12.28s/it]
[loss] ep 6 it 204 total=12.5890 mle=2.0397 pcon=9.5622 forget=0.0000 orth=0.9870 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=12.5979 mle=2.0492 pcon=9.5636 forget=0.0000 orth=0.9852 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.9314 mle=2.3826 pcon=9.5655 forget=0.0000 orth=0.9833 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.4984 mle=1.9497 pcon=9.5673 forget=0.0000 orth=0.9814 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 7 it 13 total=12.8638 mle=2.3155 pcon=9.5688 forget=0.0000 orth=0.9795 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.9484 mle=2.4007 pcon=9.5702 forget=0.0000 orth=0.9775 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.8239 mle=2.2767 pcon=9.5717 forget=0.0000 orth=0.9755 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.8490 mle=2.3021 pcon=9.5734 forget=0.0000 orth=0.9734 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.6460 mle=2.0995 pcon=9.5751 forget=0.0000 orth=0.9714 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.7215 mle=2.1751 pcon=9.5772 forget=0.0000 orth=0.9693 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.6006 mle=2.0546 pcon=9.5788 forget=0.0000 orth=0.9672 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.7461 mle=2.2003 pcon=9.5808 forget=0.0000 orth=0.9650 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 8 it 22 total=12.7010 mle=2.1561 pcon=9.5821 forget=0.0000 orth=0.9628 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.5415 mle=1.9973 pcon=9.5836 forget=0.0000 orth=0.9605 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.4428 mle=1.8997 pcon=9.5849 forget=0.0000 orth=0.9582 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=12.3260 mle=1.7836 pcon=9.5864 forget=0.0000 orth=0.9559 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=12.3570 mle=1.8156 pcon=9.5879 forget=0.0000 orth=0.9535 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.5166 mle=1.9769 pcon=9.5887 forget=0.0000 orth=0.9510 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.5588 mle=2.0205 pcon=9.5898 forget=0.0000 orth=0.9485 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.7470 mle=2.2104 pcon=9.5908 forget=0.0000 orth=0.9458 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 9 it 31 total=12.9067 mle=2.3717 pcon=9.5919 forget=0.0000 orth=0.9431 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=12.6363 mle=2.1032 pcon=9.5927 forget=0.0000 orth=0.9403 favg=0.0000 nr=110 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=12.4724 mle=1.9416 pcon=9.5935 forget=0.0000 orth=0.9374 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=12.5601 mle=2.0316 pcon=9.5941 forget=0.0000 orth=0.9345 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=12.4775 mle=1.9508 pcon=9.5954 forget=0.0000 orth=0.9313 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=12.5468 mle=2.0223 pcon=9.5964 forget=0.0000 orth=0.9281 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.6414 mle=2.1199 pcon=9.5968 forget=0.0000 orth=0.9247 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=12.4581 mle=1.9397 pcon=9.5972 forget=0.0000 orth=0.9212 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:34,  1.42it/s]  3%|▎         | 10/391 [00:00<00:24, 15.83it/s]  4%|▍         | 17/391 [00:00<00:14, 25.66it/s]  7%|▋         | 27/391 [00:01<00:08, 40.50it/s]  9%|▉         | 36/391 [00:01<00:06, 50.89it/s] 12%|█▏        | 46/391 [00:01<00:05, 61.94it/s] 14%|█▍        | 56/391 [00:01<00:04, 70.80it/s] 17%|█▋        | 65/391 [00:01<00:04, 74.93it/s] 19%|█▉        | 75/391 [00:01<00:03, 80.33it/s] 22%|██▏       | 85/391 [00:01<00:03, 84.55it/s] 24%|██▍       | 95/391 [00:01<00:03, 87.22it/s] 27%|██▋       | 105/391 [00:01<00:03, 89.68it/s] 29%|██▉       | 115/391 [00:01<00:03, 91.12it/s] 32%|███▏      | 125/391 [00:02<00:02, 91.89it/s] 35%|███▍      | 135/391 [00:02<00:02, 92.45it/s] 37%|███▋      | 145/391 [00:02<00:02, 93.39it/s] 40%|███▉      | 155/391 [00:02<00:02, 93.98it/s] 42%|████▏     | 165/391 [00:02<00:02, 94.24it/s] 45%|████▍     | 175/391 [00:02<00:02, 94.82it/s] 47%|████▋     | 185/391 [00:02<00:02, 94.21it/s] 50%|████▉     | 195/391 [00:02<00:02, 93.00it/s] 52%|█████▏    | 205/391 [00:02<00:02, 92.13it/s] 55%|█████▍    | 215/391 [00:03<00:01, 92.22it/s] 58%|█████▊    | 225/391 [00:03<00:01, 92.76it/s] 60%|██████    | 235/391 [00:03<00:01, 93.52it/s] 63%|██████▎   | 245/391 [00:03<00:01, 93.60it/s] 65%|██████▌   | 255/391 [00:03<00:01, 93.30it/s] 68%|██████▊   | 265/391 [00:03<00:01, 90.88it/s] 70%|███████   | 275/391 [00:03<00:01, 90.75it/s] 73%|███████▎  | 285/391 [00:03<00:01, 90.69it/s] 75%|███████▌  | 295/391 [00:03<00:01, 89.94it/s] 78%|███████▊  | 305/391 [00:04<00:00, 89.98it/s] 81%|████████  | 315/391 [00:04<00:00, 90.73it/s] 83%|████████▎ | 325/391 [00:04<00:00, 91.19it/s] 86%|████████▌ | 335/391 [00:04<00:00, 91.80it/s] 88%|████████▊ | 345/391 [00:04<00:00, 91.75it/s] 91%|█████████ | 355/391 [00:04<00:00, 92.18it/s] 93%|█████████▎| 365/391 [00:04<00:00, 92.78it/s] 96%|█████████▌| 375/391 [00:04<00:00, 94.15it/s] 98%|█████████▊| 385/391 [00:04<00:00, 95.08it/s]100%|██████████| 391/391 [00:04<00:00, 78.58it/s]
50000 images processed, 5.0389673709869385 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:05,  1.20it/s] 13%|█▎        | 10/79 [00:00<00:04, 14.05it/s] 25%|██▌       | 20/79 [00:01<00:02, 28.45it/s] 35%|███▌      | 28/79 [00:01<00:01, 37.12it/s] 48%|████▊     | 38/79 [00:01<00:00, 49.74it/s] 61%|██████    | 48/79 [00:01<00:00, 60.19it/s] 72%|███████▏  | 57/79 [00:01<00:00, 63.30it/s] 85%|████████▍ | 67/79 [00:01<00:00, 71.77it/s] 97%|█████████▋| 77/79 [00:01<00:00, 78.44it/s]100%|██████████| 79/79 [00:01<00:00, 45.35it/s]
10000 images processed, 1.758115530014038 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:48,  1.87it/s]  5%|▍         | 10/204 [00:00<00:09, 20.41it/s]  9%|▉         | 19/204 [00:00<00:05, 36.22it/s] 14%|█▎        | 28/204 [00:00<00:03, 49.35it/s] 19%|█▊        | 38/204 [00:00<00:02, 61.32it/s] 23%|██▎       | 47/204 [00:01<00:02, 66.67it/s] 27%|██▋       | 56/204 [00:01<00:02, 61.05it/s] 32%|███▏      | 66/204 [00:01<00:02, 68.72it/s] 37%|███▋      | 76/204 [00:01<00:01, 74.58it/s] 42%|████▏     | 86/204 [00:01<00:01, 79.38it/s] 47%|████▋     | 96/204 [00:01<00:01, 83.07it/s] 52%|█████▏    | 106/204 [00:01<00:01, 85.49it/s] 56%|█████▋    | 115/204 [00:01<00:01, 84.06it/s] 61%|██████▏   | 125/204 [00:01<00:00, 86.83it/s] 66%|██████▌   | 135/204 [00:02<00:00, 88.31it/s] 71%|███████   | 145/204 [00:02<00:00, 89.53it/s] 76%|███████▌  | 155/204 [00:02<00:00, 90.43it/s] 81%|████████  | 165/204 [00:02<00:00, 83.75it/s] 85%|████████▌ | 174/204 [00:02<00:00, 81.44it/s] 90%|████████▉ | 183/204 [00:02<00:00, 81.54it/s] 95%|█████████▍| 193/204 [00:02<00:00, 85.77it/s] 99%|█████████▉| 202/204 [00:02<00:00, 79.40it/s]100%|██████████| 204/204 [00:03<00:00, 67.66it/s]
26032 images processed, 3.160681962966919 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:05,  1.19it/s] 11%|█▏        | 9/79 [00:00<00:05, 11.71it/s] 24%|██▍       | 19/79 [00:01<00:02, 25.70it/s] 37%|███▋      | 29/79 [00:01<00:01, 39.11it/s] 47%|████▋     | 37/79 [00:01<00:01, 37.86it/s] 59%|█████▉    | 47/79 [00:01<00:00, 48.97it/s] 72%|███████▏  | 57/79 [00:01<00:00, 59.04it/s] 82%|████████▏ | 65/79 [00:01<00:00, 58.65it/s] 95%|█████████▍| 75/79 [00:01<00:00, 67.70it/s]100%|██████████| 79/79 [00:01<00:00, 41.09it/s]
10000 images processed, 1.94563889503479 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:57,  1.36it/s] 13%|█▎        | 10/79 [00:00<00:04, 15.82it/s] 23%|██▎       | 18/79 [00:00<00:02, 27.70it/s] 35%|███▌      | 28/79 [00:01<00:01, 42.40it/s] 48%|████▊     | 38/79 [00:01<00:00, 54.98it/s] 61%|██████    | 48/79 [00:01<00:00, 65.11it/s] 73%|███████▎  | 58/79 [00:01<00:00, 72.98it/s] 86%|████████▌ | 68/79 [00:01<00:00, 79.38it/s] 99%|█████████▊| 78/79 [00:01<00:00, 84.12it/s]100%|██████████| 79/79 [00:01<00:00, 50.25it/s]
10000 images processed, 1.595829963684082 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:55,  1.25it/s] 14%|█▍        | 10/70 [00:00<00:04, 14.61it/s] 29%|██▊       | 20/70 [00:01<00:01, 29.39it/s] 43%|████▎     | 30/70 [00:01<00:00, 42.80it/s] 57%|█████▋    | 40/70 [00:01<00:00, 54.40it/s] 71%|███████▏  | 50/70 [00:01<00:00, 64.52it/s] 84%|████████▍ | 59/70 [00:01<00:00, 68.95it/s] 97%|█████████▋| 68/70 [00:01<00:00, 68.81it/s]100%|██████████| 70/70 [00:01<00:00, 43.72it/s]
8925 images processed, 1.6354765892028809 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:43,  1.01it/s]  4%|▍         | 2/45 [00:01<00:23,  1.84it/s] 16%|█▌        | 7/45 [00:01<00:05,  7.04it/s] 33%|███▎      | 15/45 [00:01<00:01, 17.17it/s] 42%|████▏     | 19/45 [00:01<00:01, 17.83it/s] 51%|█████     | 23/45 [00:02<00:01, 15.02it/s] 73%|███████▎  | 33/45 [00:02<00:00, 25.14it/s] 82%|████████▏ | 37/45 [00:02<00:00, 18.82it/s]100%|██████████| 45/45 [00:02<00:00, 16.29it/s]
5640 images processed, 2.7836713790893555 seconds used

20.458398818969727
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.83  98.89  84.02
places365     61.83  83.68  49.34
LSUN          43.88  90.29  71.27
iSUN          40.47  90.97  72.87
dtd           34.57  91.27  76.73
AVG           36.92  91.02  70.85
[incremental] Overall: 0.6940 New: 0.7000 Old: 0.6910
[incremental] Final(Top-1): 0.6940  Average: 0.7600
3.3376595973968506
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=10, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/10 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
 10%|█         | 1/10 [00:15<02:21, 15.72s/it] 20%|██        | 2/10 [00:25<01:38, 12.32s/it] 30%|███       | 3/10 [00:35<01:17, 11.11s/it] 40%|████      | 4/10 [00:45<01:03, 10.66s/it] 50%|█████     | 5/10 [00:55<00:51, 10.35s/it] 60%|██████    | 6/10 [01:04<00:40, 10.18s/it][loss] ep 0 it 0 total=13.2615 mle=2.2945 pcon=9.8395 forget=0.0000 orth=1.1275 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=13.2372 mle=2.2660 pcon=9.8438 forget=0.0000 orth=1.1274 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=13.3393 mle=2.3634 pcon=9.8487 forget=0.0000 orth=1.1272 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=13.2415 mle=2.2624 pcon=9.8522 forget=0.0000 orth=1.1269 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=12.9021 mle=1.9196 pcon=9.8561 forget=0.0000 orth=1.1264 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.0621 mle=2.0767 pcon=9.8596 forget=0.0000 orth=1.1259 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.5260 mle=2.5386 pcon=9.8623 forget=0.0000 orth=1.1252 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.1125 mle=2.1238 pcon=9.8644 forget=0.0000 orth=1.1244 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.0974 mle=2.1075 pcon=9.8664 forget=0.0000 orth=1.1234 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.0798 mle=2.0889 pcon=9.8685 forget=0.0000 orth=1.1224 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.2359 mle=2.2440 pcon=9.8706 forget=0.0000 orth=1.1212 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=13.4207 mle=2.4279 pcon=9.8729 forget=0.0000 orth=1.1199 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.3628 mle=2.3700 pcon=9.8742 forget=0.0000 orth=1.1185 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.0324 mle=2.0399 pcon=9.8756 forget=0.0000 orth=1.1169 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.2905 mle=2.2978 pcon=9.8774 forget=0.0000 orth=1.1153 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.2074 mle=2.2160 pcon=9.8780 forget=0.0000 orth=1.1134 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.1158 mle=2.1244 pcon=9.8800 forget=0.0000 orth=1.1115 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.2474 mle=2.2559 pcon=9.8820 forget=0.0000 orth=1.1094 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.0421 mle=2.0510 pcon=9.8839 forget=0.0000 orth=1.1072 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.1268 mle=2.1361 pcon=9.8859 forget=0.0000 orth=1.1048 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=12.7282 mle=1.7389 pcon=9.8870 forget=0.0000 orth=1.1023 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.2443 mle=2.2565 pcon=9.8881 forget=0.0000 orth=1.0997 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.2939 mle=2.3075 pcon=9.8894 forget=0.0000 orth=1.0969 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=12.8327 mle=1.8475 pcon=9.8911 forget=0.0000 orth=1.0940 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.1738 mle=2.1903 pcon=9.8925 forget=0.0000 orth=1.0910 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.2742 mle=2.2923 pcon=9.8941 forget=0.0000 orth=1.0878 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.2392 mle=2.2596 pcon=9.8952 forget=0.0000 orth=1.0844 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.0947 mle=2.1175 pcon=9.8962 forget=0.0000 orth=1.0809 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.0552 mle=2.0806 pcon=9.8974 forget=0.0000 orth=1.0773 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.0970 mle=2.1247 pcon=9.8988 forget=0.0000 orth=1.0735 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.0636 mle=2.0944 pcon=9.8997 forget=0.0000 orth=1.0696 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.1324 mle=2.1660 pcon=9.9010 forget=0.0000 orth=1.0655 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.1182 mle=2.1551 pcon=9.9018 forget=0.0000 orth=1.0613 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.1360 mle=2.1764 pcon=9.9026 forget=0.0000 orth=1.0569 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.2216 mle=2.2654 pcon=9.9039 forget=0.0000 orth=1.0524 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.9398 mle=1.9871 pcon=9.9050 forget=0.0000 orth=1.0478 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.9933 mle=2.0443 pcon=9.9059 forget=0.0000 orth=1.0430 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.9337 mle=1.9885 pcon=9.9071 forget=0.0000 orth=1.0381 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.2285 mle=2.2874 pcon=9.9081 forget=0.0000 orth=1.0330 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.9128 mle=1.9756 pcon=9.9093 forget=0.0000 orth=1.0278 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 5 it 45 total=13.0705 mle=2.1378 pcon=9.9102 forget=0.0000 orth=1.0225 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.9751 mle=2.0469 pcon=9.9112 forget=0.0000 orth=1.0171 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.9743 mle=2.0507 pcon=9.9120 forget=0.0000 orth=1.0115 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=13.0251 mle=2.1062 pcon=9.9131 forget=0.0000 orth=1.0058 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=13.1017 mle=2.1874 pcon=9.9142 forget=0.0000 orth=1.0001 favg=0.0000 nr=97 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.7782 mle=1.8686 pcon=9.9154 forget=0.0000 orth=0.9942 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=13.1601 mle=2.2549 pcon=9.9169 forget=0.0000 orth=0.9883 favg=0.0000 nr=95 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 6 it 4 total=13.0286 mle=2.1290 pcon=9.9175 forget=0.0000 orth=0.9822 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=13.0918 mle=2.1972 pcon=9.9185 forget=0.0000 orth=0.9761 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.8764 mle=1.9868 pcon=9.9196 forget=0.0000 orth=0.9699 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.6988 mle=1.8148 pcon=9.9203 forget=0.0000 orth=0.9637 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=12.8828 mle=2.0047 pcon=9.9208 forget=0.0000 orth=0.9574 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
 70%|███████   | 7/10 [01:14<00:30, 10.12s/it] 80%|████████  | 8/10 [01:24<00:20, 10.10s/it] 90%|█████████ | 9/10 [01:34<00:09,  9.98s/it]100%|██████████| 10/10 [01:44<00:00,  9.87s/it]100%|██████████| 10/10 [01:44<00:00, 10.43s/it]
[loss] ep 6 it 254 total=12.9065 mle=2.0341 pcon=9.9214 forget=0.0000 orth=0.9511 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=13.2020 mle=2.3351 pcon=9.9222 forget=0.0000 orth=0.9448 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.7805 mle=1.9195 pcon=9.9227 forget=0.0000 orth=0.9384 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 7 it 13 total=13.1205 mle=2.2650 pcon=9.9234 forget=0.0000 orth=0.9320 favg=0.0000 nr=98 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=13.1918 mle=2.3421 pcon=9.9241 forget=0.0000 orth=0.9256 favg=0.0000 nr=94 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=13.0885 mle=2.2445 pcon=9.9248 forget=0.0000 orth=0.9192 favg=0.0000 nr=93 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=13.0780 mle=2.2399 pcon=9.9254 forget=0.0000 orth=0.9128 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.8962 mle=2.0642 pcon=9.9256 forget=0.0000 orth=0.9064 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.9875 mle=2.1612 pcon=9.9263 forget=0.0000 orth=0.9000 favg=0.0000 nr=102 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.8534 mle=2.0326 pcon=9.9272 forget=0.0000 orth=0.8936 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.9763 mle=2.1615 pcon=9.9276 forget=0.0000 orth=0.8872 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 8 it 22 total=12.9179 mle=2.1093 pcon=9.9278 forget=0.0000 orth=0.8809 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.7397 mle=1.9371 pcon=9.9281 forget=0.0000 orth=0.8746 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.6890 mle=1.8928 pcon=9.9280 forget=0.0000 orth=0.8682 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=12.5614 mle=1.7711 pcon=9.9283 forget=0.0000 orth=0.8619 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=12.5745 mle=1.7904 pcon=9.9284 forget=0.0000 orth=0.8557 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.7219 mle=1.9442 pcon=9.9283 forget=0.0000 orth=0.8494 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.7792 mle=2.0076 pcon=9.9285 forget=0.0000 orth=0.8432 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.9277 mle=2.1625 pcon=9.9283 forget=0.0000 orth=0.8369 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 9 it 31 total=13.0825 mle=2.3241 pcon=9.9277 forget=0.0000 orth=0.8307 favg=0.0000 nr=92 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=12.8134 mle=2.0613 pcon=9.9276 forget=0.0000 orth=0.8245 favg=0.0000 nr=97 nf=13 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=12.6780 mle=1.9329 pcon=9.9269 forget=0.0000 orth=0.8182 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=12.7302 mle=1.9919 pcon=9.9263 forget=0.0000 orth=0.8120 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=12.6370 mle=1.9050 pcon=9.9263 forget=0.0000 orth=0.8057 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=12.7399 mle=2.0147 pcon=9.9258 forget=0.0000 orth=0.7994 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.8259 mle=2.1081 pcon=9.9246 forget=0.0000 orth=0.7931 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=12.5988 mle=1.8881 pcon=9.9238 forget=0.0000 orth=0.7869 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e10-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:48,  1.71it/s]  2%|▏         | 9/391 [00:00<00:23, 16.32it/s]  5%|▍         | 19/391 [00:00<00:11, 33.35it/s]  7%|▋         | 29/391 [00:00<00:07, 47.88it/s] 10%|▉         | 39/391 [00:01<00:05, 59.85it/s] 13%|█▎        | 49/391 [00:01<00:04, 69.14it/s] 15%|█▌        | 59/391 [00:01<00:04, 76.49it/s] 18%|█▊        | 69/391 [00:01<00:03, 81.87it/s] 20%|██        | 79/391 [00:01<00:03, 85.57it/s] 23%|██▎       | 89/391 [00:01<00:03, 88.28it/s] 25%|██▌       | 99/391 [00:01<00:03, 90.47it/s] 28%|██▊       | 109/391 [00:01<00:03, 91.88it/s] 30%|███       | 119/391 [00:01<00:02, 92.68it/s] 33%|███▎      | 129/391 [00:01<00:02, 93.22it/s] 36%|███▌      | 139/391 [00:02<00:02, 93.84it/s] 38%|███▊      | 149/391 [00:02<00:02, 94.05it/s] 41%|████      | 159/391 [00:02<00:02, 94.35it/s] 43%|████▎     | 169/391 [00:02<00:02, 94.51it/s] 46%|████▌     | 179/391 [00:02<00:02, 94.01it/s] 48%|████▊     | 189/391 [00:02<00:02, 94.48it/s] 51%|█████     | 199/391 [00:02<00:02, 94.61it/s] 53%|█████▎    | 209/391 [00:02<00:01, 94.84it/s] 56%|█████▌    | 219/391 [00:02<00:01, 94.27it/s] 59%|█████▊    | 229/391 [00:03<00:01, 94.33it/s] 61%|██████    | 239/391 [00:03<00:01, 94.44it/s] 64%|██████▎   | 249/391 [00:03<00:01, 92.61it/s] 66%|██████▌   | 259/391 [00:03<00:01, 93.33it/s] 69%|██████▉   | 269/391 [00:03<00:01, 91.50it/s] 71%|███████▏  | 279/391 [00:03<00:01, 92.59it/s] 74%|███████▍  | 289/391 [00:03<00:01, 91.56it/s] 76%|███████▋  | 299/391 [00:03<00:00, 92.76it/s] 79%|███████▉  | 309/391 [00:03<00:00, 93.68it/s] 82%|████████▏ | 319/391 [00:04<00:00, 93.92it/s] 84%|████████▍ | 329/391 [00:04<00:00, 94.31it/s] 87%|████████▋ | 339/391 [00:04<00:00, 94.31it/s] 89%|████████▉ | 349/391 [00:04<00:00, 93.68it/s] 92%|█████████▏| 359/391 [00:04<00:00, 92.67it/s] 94%|█████████▍| 369/391 [00:04<00:00, 94.07it/s] 97%|█████████▋| 379/391 [00:04<00:00, 95.16it/s] 99%|█████████▉| 389/391 [00:04<00:00, 95.93it/s]100%|██████████| 391/391 [00:04<00:00, 81.99it/s]
50000 images processed, 4.8151304721832275 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:34,  2.25it/s] 11%|█▏        | 9/79 [00:00<00:03, 20.66it/s] 24%|██▍       | 19/79 [00:00<00:01, 40.29it/s] 37%|███▋      | 29/79 [00:00<00:00, 55.13it/s] 48%|████▊     | 38/79 [00:00<00:00, 63.98it/s] 61%|██████    | 48/79 [00:00<00:00, 72.71it/s] 73%|███████▎  | 58/79 [00:01<00:00, 79.58it/s] 86%|████████▌ | 68/79 [00:01<00:00, 84.52it/s] 99%|█████████▊| 78/79 [00:01<00:00, 88.16it/s]100%|██████████| 79/79 [00:01<00:00, 41.91it/s]
10000 images processed, 1.9040284156799316 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:32,  1.33it/s]  3%|▎         | 7/204 [00:00<00:19, 10.36it/s]  7%|▋         | 15/204 [00:00<00:08, 22.70it/s] 11%|█▏        | 23/204 [00:01<00:05, 34.30it/s] 16%|█▌        | 32/204 [00:01<00:03, 45.81it/s] 20%|█▉        | 40/204 [00:01<00:03, 53.68it/s] 24%|██▍       | 49/204 [00:01<00:02, 61.62it/s] 28%|██▊       | 58/204 [00:01<00:02, 67.49it/s] 32%|███▏      | 66/204 [00:01<00:02, 66.90it/s] 37%|███▋      | 75/204 [00:01<00:01, 71.00it/s] 41%|████      | 83/204 [00:01<00:01, 67.30it/s] 45%|████▌     | 92/204 [00:02<00:01, 68.28it/s] 49%|████▉     | 100/204 [00:02<00:01, 59.72it/s] 53%|█████▎    | 109/204 [00:02<00:01, 65.65it/s] 58%|█████▊    | 118/204 [00:02<00:01, 69.77it/s] 62%|██████▏   | 127/204 [00:02<00:01, 73.90it/s] 67%|██████▋   | 136/204 [00:02<00:00, 76.72it/s] 72%|███████▏  | 146/204 [00:02<00:00, 78.92it/s] 76%|███████▋  | 156/204 [00:02<00:00, 82.91it/s] 81%|████████▏ | 166/204 [00:02<00:00, 86.44it/s] 86%|████████▋ | 176/204 [00:03<00:00, 88.96it/s] 91%|█████████ | 186/204 [00:03<00:00, 91.30it/s] 96%|█████████▌| 196/204 [00:03<00:00, 92.87it/s]100%|██████████| 204/204 [00:03<00:00, 61.10it/s]
26032 images processed, 3.3851375579833984 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:55,  1.40it/s] 14%|█▍        | 11/79 [00:00<00:03, 17.72it/s] 23%|██▎       | 18/79 [00:00<00:02, 27.47it/s] 35%|███▌      | 28/79 [00:01<00:01, 42.08it/s] 47%|████▋     | 37/79 [00:01<00:00, 51.92it/s] 57%|█████▋    | 45/79 [00:01<00:00, 46.77it/s] 70%|██████▉   | 55/79 [00:01<00:00, 57.58it/s] 82%|████████▏ | 65/79 [00:01<00:00, 66.49it/s] 95%|█████████▍| 75/79 [00:01<00:00, 74.18it/s]100%|██████████| 79/79 [00:01<00:00, 45.59it/s]
10000 images processed, 1.769857406616211 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:56,  1.37it/s] 14%|█▍        | 11/79 [00:00<00:03, 17.29it/s] 27%|██▋       | 21/79 [00:00<00:01, 32.48it/s] 39%|███▉      | 31/79 [00:01<00:01, 46.12it/s] 52%|█████▏    | 41/79 [00:01<00:00, 57.80it/s] 65%|██████▍   | 51/79 [00:01<00:00, 66.82it/s] 77%|███████▋  | 61/79 [00:01<00:00, 74.63it/s] 90%|████████▉ | 71/79 [00:01<00:00, 80.56it/s]100%|██████████| 79/79 [00:01<00:00, 51.13it/s]
10000 images processed, 1.5660927295684814 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.88it/s] 14%|█▍        | 10/70 [00:00<00:02, 20.49it/s] 29%|██▊       | 20/70 [00:00<00:01, 38.42it/s] 43%|████▎     | 30/70 [00:00<00:00, 52.76it/s] 57%|█████▋    | 40/70 [00:00<00:00, 63.94it/s] 71%|███████▏  | 50/70 [00:01<00:00, 72.83it/s] 86%|████████▌ | 60/70 [00:01<00:00, 79.53it/s]100%|██████████| 70/70 [00:01<00:00, 83.64it/s]100%|██████████| 70/70 [00:01<00:00, 55.35it/s]
8925 images processed, 1.2929649353027344 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:43,  1.00it/s]  9%|▉         | 4/45 [00:01<00:08,  4.59it/s] 20%|██        | 9/45 [00:01<00:03, 10.54it/s] 38%|███▊      | 17/45 [00:01<00:01, 17.61it/s] 47%|████▋     | 21/45 [00:01<00:01, 16.86it/s] 56%|█████▌    | 25/45 [00:01<00:00, 20.36it/s] 73%|███████▎  | 33/45 [00:02<00:00, 22.54it/s] 80%|████████  | 36/45 [00:02<00:00, 20.39it/s] 93%|█████████▎| 42/45 [00:02<00:00, 21.49it/s]100%|██████████| 45/45 [00:02<00:00, 16.79it/s]
5640 images processed, 2.700489044189453 seconds used

19.251814365386963
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.80  99.12  90.07
places365     74.20  81.79  54.56
LSUN          42.34  91.63  78.74
iSUN          49.10  89.66  75.51
dtd           36.01  91.31  80.73
AVG           41.09  90.70  75.92
[incremental] Overall: 0.6060 New: 0.6060 Old: 0.6060
[incremental] Final(Top-1): 0.6060  Average: 0.7215
3.231248378753662
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.76it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.26it/s] 27%|██▋       | 21/79 [00:00<00:01, 38.23it/s] 39%|███▉      | 31/79 [00:00<00:00, 51.97it/s] 52%|█████▏    | 41/79 [00:00<00:00, 63.16it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.83it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.70it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.86it/s]100%|██████████| 79/79 [00:01<00:00, 57.29it/s]
10000 images processed, 1.39839768409729 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.95it/s] 14%|█▍        | 10/70 [00:00<00:02, 21.15it/s] 29%|██▊       | 20/70 [00:00<00:01, 39.19it/s] 43%|████▎     | 30/70 [00:00<00:00, 53.41it/s] 57%|█████▋    | 40/70 [00:00<00:00, 64.27it/s] 71%|███████▏  | 50/70 [00:01<00:00, 73.03it/s] 86%|████████▌ | 60/70 [00:01<00:00, 79.81it/s]100%|██████████| 70/70 [00:01<00:00, 84.00it/s]100%|██████████| 70/70 [00:01<00:00, 56.10it/s]
8925 images processed, 1.277306318283081 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:50,  1.15s/it]  4%|▍         | 2/45 [00:01<00:28,  1.51it/s] 24%|██▍       | 11/45 [00:01<00:02, 11.41it/s] 38%|███▊      | 17/45 [00:01<00:01, 17.28it/s] 49%|████▉     | 22/45 [00:02<00:01, 16.05it/s] 71%|███████   | 32/45 [00:02<00:00, 27.55it/s] 84%|████████▍ | 38/45 [00:02<00:00, 20.01it/s]100%|██████████| 45/45 [00:02<00:00, 16.44it/s]
5640 images processed, 2.7627134323120117 seconds used

18.393120527267456
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.80  99.12  90.07
places365     74.20  81.79  54.56
LSUN          42.34  91.63  78.74
iSUN          49.10  89.66  75.51
dtd           36.01  91.31  80.73
AVG           41.09  90.70  75.92
[incremental] Overall: 0.6060 New: 0.6060 Old: 0.6060
[incremental] Final(Top-1): 0.6060  Average: 0.7215
6.441847085952759
[DEBUG] Parsed: avg_fpr=41.09 avg_auroc=90.70 final_top1=0.6060 average=0.7215
[Result] AVG-AUROC=90.70 AVG-FPR=41.09 Final-Top1=0.6060 Average=0.7215 Score=70.59

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=15 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=15, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/15 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  7%|▋         | 1/15 [00:17<04:03, 17.40s/it] 13%|█▎        | 2/15 [00:26<02:42, 12.52s/it] 20%|██        | 3/15 [00:34<02:04, 10.36s/it] 27%|██▋       | 4/15 [00:42<01:43,  9.39s/it] 33%|███▎      | 5/15 [00:50<01:28,  8.88s/it] 40%|████      | 6/15 [00:57<01:16,  8.47s/it][loss] ep 0 it 0 total=8.5895 mle=3.2130 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6441 mle=3.2647 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0878 mle=3.7057 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6783 mle=3.2935 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9792 mle=2.5920 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9918 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4733 mle=4.0810 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4955 mle=3.1007 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5368 mle=3.1398 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2411 mle=2.8415 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7243 mle=3.3225 pcon=5.4019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0962 mle=3.6917 pcon=5.4045 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4459 mle=4.0387 pcon=5.4072 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3582 mle=2.9488 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0700 mle=3.6581 pcon=5.4119 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5543 mle=3.1402 pcon=5.4141 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5075 mle=3.0907 pcon=5.4168 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6320 mle=3.2131 pcon=5.4189 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2432 mle=2.8212 pcon=5.4220 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4328 mle=3.0085 pcon=5.4244 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7374 mle=2.3105 pcon=5.4269 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6782 mle=3.2488 pcon=5.4294 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8372 mle=3.4054 pcon=5.4319 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7151 mle=2.2806 pcon=5.4345 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.2999 mle=2.8637 pcon=5.4361 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4255 mle=2.9874 pcon=5.4380 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1016 mle=2.6616 pcon=5.4399 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9323 mle=2.4907 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6432 mle=2.2005 pcon=5.4427 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6506 mle=2.2064 pcon=5.4442 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6231 mle=2.1784 pcon=5.4447 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6688 mle=2.2232 pcon=5.4456 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6921 mle=2.2452 pcon=5.4468 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6984 mle=2.2506 pcon=5.4478 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7879 mle=2.3395 pcon=5.4484 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4443 mle=1.9940 pcon=5.4503 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4894 mle=2.0373 pcon=5.4521 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4849 mle=2.0301 pcon=5.4548 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9107 mle=2.4539 pcon=5.4569 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4957 mle=2.0364 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 5 it 45 total=7.5990 mle=2.1381 pcon=5.4609 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.5303 mle=2.0671 pcon=5.4632 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.5470 mle=2.0819 pcon=5.4652 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.6399 mle=2.1723 pcon=5.4676 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.6794 mle=2.2098 pcon=5.4696 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.3916 mle=1.9192 pcon=5.4724 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7724 mle=2.2973 pcon=5.4751 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 6 it 4 total=7.6268 mle=2.1493 pcon=5.4775 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.7451 mle=2.2648 pcon=5.4803 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.5335 mle=2.0506 pcon=5.4829 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.3494 mle=1.8647 pcon=5.4847 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.5080 mle=2.0203 pcon=5.4878 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
 47%|████▋     | 7/15 [01:05<01:06,  8.27s/it] 53%|█████▎    | 8/15 [01:13<00:57,  8.19s/it] 60%|██████    | 9/15 [01:21<00:48,  8.05s/it] 67%|██████▋   | 10/15 [01:29<00:39,  7.94s/it] 73%|███████▎  | 11/15 [01:36<00:31,  7.85s/it] 80%|████████  | 12/15 [01:44<00:23,  7.78s/it] 87%|████████▋ | 13/15 [01:52<00:15,  7.88s/it] 93%|█████████▎| 14/15 [02:00<00:07,  7.92s/it][loss] ep 6 it 254 total=7.5032 mle=2.0123 pcon=5.4908 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.9122 mle=2.4184 pcon=5.4939 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.4513 mle=1.9541 pcon=5.4972 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 13 total=7.7897 mle=2.2890 pcon=5.5007 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.9125 mle=2.4083 pcon=5.5042 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.7384 mle=2.2308 pcon=5.5077 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.8007 mle=2.2895 pcon=5.5112 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.5631 mle=2.0488 pcon=5.5142 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.6841 mle=2.1656 pcon=5.5185 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.5469 mle=2.0250 pcon=5.5218 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.6894 mle=2.1636 pcon=5.5258 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 22 total=7.6969 mle=2.1677 pcon=5.5293 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.5198 mle=1.9875 pcon=5.5323 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.3987 mle=1.8633 pcon=5.5354 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=7.3097 mle=1.7706 pcon=5.5392 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=7.3351 mle=1.7920 pcon=5.5432 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.5150 mle=1.9685 pcon=5.5466 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=7.5382 mle=1.9883 pcon=5.5499 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=7.7813 mle=2.2277 pcon=5.5537 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 31 total=7.9270 mle=2.3706 pcon=5.5565 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=7.6420 mle=2.0820 pcon=5.5600 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=7.4834 mle=1.9206 pcon=5.5628 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=7.6008 mle=2.0349 pcon=5.5660 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=7.5366 mle=1.9670 pcon=5.5696 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=7.5926 mle=2.0195 pcon=5.5731 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=7.6973 mle=2.1212 pcon=5.5761 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=7.5189 mle=1.9396 pcon=5.5793 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 40 total=7.4385 mle=1.8567 pcon=5.5818 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=7.9048 mle=2.3207 pcon=5.5842 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=7.5867 mle=1.9997 pcon=5.5870 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=7.5870 mle=1.9970 pcon=5.5900 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=7.4325 mle=1.8404 pcon=5.5922 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=7.8545 mle=2.2592 pcon=5.5953 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=7.5764 mle=1.9789 pcon=5.5975 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=7.8366 mle=2.2360 pcon=5.6005 forget=0.0000 orth=0.0000 favg=0.0000 nr=77 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 49 total=7.5665 mle=1.9628 pcon=5.6037 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=7.9005 mle=2.2938 pcon=5.6067 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=7.7704 mle=2.1610 pcon=5.6094 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=7.6115 mle=1.9990 pcon=5.6125 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=7.4143 mle=1.7986 pcon=5.6157 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=7.7324 mle=2.1141 pcon=5.6182 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=7.4550 mle=1.8345 pcon=5.6204 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 8 total=7.8477 mle=2.2247 pcon=5.6229 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=7.6114 mle=1.9861 pcon=5.6253 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=7.8298 mle=2.2017 pcon=5.6281 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=7.6011 mle=1.9702 pcon=5.6309 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=7.6281 mle=1.9947 pcon=5.6333 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=7.9036 mle=2.2677 pcon=5.6360 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=7.7446 mle=2.1065 pcon=5.6381 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=7.7925 mle=2.1518 pcon=5.6406 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 17 total=7.8759 mle=2.2329 pcon=5.6430 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=7.6787 mle=2.0332 pcon=5.6455 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=7.9307 mle=2.2835 pcon=5.6472 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=7.7548 mle=2.1058 pcon=5.6490 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=7.9506 mle=2.3003 pcon=5.6502 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=7.8521 mle=2.1996 pcon=5.6525 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=7.7414 mle=2.0870 pcon=5.6544 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=7.7644 mle=2.1074 pcon=5.6570 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 26 total=7.9697 mle=2.3110 pcon=5.6587 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=7.7088 mle=2.0485 pcon=5.6603 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=7.7310 mle=2.0695 pcon=5.6616 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=7.8669 mle=2.2038 pcon=5.6631 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
100%|██████████| 15/15 [02:08<00:00,  7.93s/it]100%|██████████| 15/15 [02:08<00:00,  8.57s/it]
[loss] ep 14 it 226 total=7.6190 mle=1.9540 pcon=5.6650 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=7.8356 mle=2.1686 pcon=5.6671 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=7.7836 mle=2.1151 pcon=5.6685 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=7.5970 mle=1.9269 pcon=5.6701 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:48,  1.70it/s]  3%|▎         | 10/391 [00:00<00:20, 18.84it/s]  5%|▌         | 20/391 [00:00<00:10, 36.12it/s]  8%|▊         | 30/391 [00:00<00:07, 50.66it/s] 10%|█         | 40/391 [00:01<00:05, 62.18it/s] 13%|█▎        | 50/391 [00:01<00:04, 71.16it/s] 15%|█▌        | 59/391 [00:01<00:04, 73.30it/s] 18%|█▊        | 69/391 [00:01<00:04, 79.50it/s] 20%|██        | 79/391 [00:01<00:03, 83.75it/s] 23%|██▎       | 89/391 [00:01<00:03, 86.69it/s] 25%|██▌       | 99/391 [00:01<00:03, 89.22it/s] 28%|██▊       | 109/391 [00:01<00:03, 91.06it/s] 30%|███       | 119/391 [00:01<00:02, 91.98it/s] 33%|███▎      | 129/391 [00:01<00:02, 92.79it/s] 36%|███▌      | 139/391 [00:02<00:02, 93.56it/s] 38%|███▊      | 149/391 [00:02<00:02, 94.04it/s] 41%|████      | 159/391 [00:02<00:02, 94.03it/s] 43%|████▎     | 169/391 [00:02<00:02, 94.29it/s] 46%|████▌     | 179/391 [00:02<00:02, 94.60it/s] 48%|████▊     | 189/391 [00:02<00:02, 94.51it/s] 51%|█████     | 199/391 [00:02<00:02, 94.09it/s] 53%|█████▎    | 209/391 [00:02<00:01, 94.69it/s] 56%|█████▌    | 219/391 [00:02<00:01, 93.83it/s] 59%|█████▊    | 229/391 [00:03<00:01, 93.77it/s] 61%|██████    | 239/391 [00:03<00:01, 94.22it/s] 64%|██████▎   | 249/391 [00:03<00:01, 93.90it/s] 66%|██████▌   | 259/391 [00:03<00:01, 94.26it/s] 69%|██████▉   | 269/391 [00:03<00:01, 94.51it/s] 71%|███████▏  | 279/391 [00:03<00:01, 94.95it/s] 74%|███████▍  | 289/391 [00:03<00:01, 95.19it/s] 76%|███████▋  | 299/391 [00:03<00:00, 94.74it/s] 79%|███████▉  | 309/391 [00:03<00:00, 94.59it/s] 82%|████████▏ | 319/391 [00:03<00:00, 94.64it/s] 84%|████████▍ | 329/391 [00:04<00:00, 95.09it/s] 87%|████████▋ | 339/391 [00:04<00:00, 95.17it/s] 89%|████████▉ | 349/391 [00:04<00:00, 95.07it/s] 92%|█████████▏| 359/391 [00:04<00:00, 94.49it/s] 94%|█████████▍| 369/391 [00:04<00:00, 95.26it/s] 97%|█████████▋| 379/391 [00:04<00:00, 95.98it/s] 99%|█████████▉| 389/391 [00:04<00:00, 96.53it/s]100%|██████████| 391/391 [00:04<00:00, 82.64it/s]
50000 images processed, 4.76561713218689 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.23it/s] 14%|█▍        | 11/79 [00:00<00:02, 25.47it/s] 27%|██▋       | 21/79 [00:00<00:01, 43.84it/s] 39%|███▉      | 31/79 [00:00<00:00, 57.73it/s] 52%|█████▏    | 41/79 [00:00<00:00, 68.02it/s] 65%|██████▍   | 51/79 [00:00<00:00, 75.86it/s] 77%|███████▋  | 61/79 [00:01<00:00, 81.95it/s] 90%|████████▉ | 71/79 [00:01<00:00, 86.34it/s]100%|██████████| 79/79 [00:01<00:00, 48.43it/s]
10000 images processed, 1.6538496017456055 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:43,  1.96it/s]  4%|▍         | 9/204 [00:00<00:10, 18.95it/s]  9%|▉         | 19/204 [00:00<00:04, 37.49it/s] 14%|█▍        | 29/204 [00:00<00:03, 52.20it/s] 19%|█▉        | 39/204 [00:00<00:02, 63.38it/s] 24%|██▍       | 49/204 [00:01<00:02, 72.09it/s] 29%|██▉       | 59/204 [00:01<00:01, 78.02it/s] 34%|███▍      | 69/204 [00:01<00:01, 82.85it/s] 39%|███▊      | 79/204 [00:01<00:01, 86.23it/s] 44%|████▎     | 89/204 [00:01<00:01, 88.74it/s] 49%|████▊     | 99/204 [00:01<00:01, 90.61it/s] 53%|█████▎    | 109/204 [00:01<00:01, 91.96it/s] 58%|█████▊    | 119/204 [00:01<00:00, 92.95it/s] 63%|██████▎   | 129/204 [00:01<00:00, 92.00it/s] 68%|██████▊   | 139/204 [00:02<00:00, 85.59it/s] 73%|███████▎  | 149/204 [00:02<00:00, 88.09it/s] 78%|███████▊  | 159/204 [00:02<00:00, 90.01it/s] 83%|████████▎ | 169/204 [00:02<00:00, 91.48it/s] 88%|████████▊ | 179/204 [00:02<00:00, 92.69it/s] 93%|█████████▎| 189/204 [00:02<00:00, 93.91it/s] 98%|█████████▊| 199/204 [00:02<00:00, 94.60it/s]100%|██████████| 204/204 [00:02<00:00, 75.20it/s]
26032 images processed, 2.755044460296631 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.61it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.78it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.01it/s] 39%|███▉      | 31/79 [00:00<00:00, 49.87it/s] 52%|█████▏    | 41/79 [00:01<00:00, 61.11it/s] 65%|██████▍   | 51/79 [00:01<00:00, 69.95it/s] 77%|███████▋  | 61/79 [00:01<00:00, 76.96it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.18it/s]100%|██████████| 79/79 [00:01<00:00, 54.89it/s]
10000 images processed, 1.4638805389404297 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.73it/s] 13%|█▎        | 10/79 [00:00<00:03, 19.17it/s] 25%|██▌       | 20/79 [00:00<00:01, 36.56it/s] 38%|███▊      | 30/79 [00:00<00:00, 50.97it/s] 51%|█████     | 40/79 [00:00<00:00, 62.65it/s] 63%|██████▎   | 50/79 [00:01<00:00, 71.76it/s] 76%|███████▌  | 60/79 [00:01<00:00, 78.81it/s] 89%|████████▊ | 70/79 [00:01<00:00, 84.02it/s]100%|██████████| 79/79 [00:01<00:00, 56.90it/s]
10000 images processed, 1.4069838523864746 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:33,  2.09it/s] 16%|█▌        | 11/70 [00:00<00:02, 24.22it/s] 30%|███       | 21/70 [00:00<00:01, 42.22it/s] 41%|████▏     | 29/70 [00:00<00:00, 50.44it/s] 53%|█████▎    | 37/70 [00:00<00:00, 54.37it/s] 67%|██████▋   | 47/70 [00:01<00:00, 65.59it/s] 81%|████████▏ | 57/70 [00:01<00:00, 74.17it/s] 96%|█████████▌| 67/70 [00:01<00:00, 80.53it/s]100%|██████████| 70/70 [00:01<00:00, 54.84it/s]
8925 images processed, 1.3089182376861572 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:49,  1.14s/it]  4%|▍         | 2/45 [00:01<00:25,  1.69it/s] 27%|██▋       | 12/45 [00:01<00:02, 13.80it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.87it/s] 47%|████▋     | 21/45 [00:01<00:01, 17.14it/s] 53%|█████▎    | 24/45 [00:02<00:01, 17.85it/s] 67%|██████▋   | 30/45 [00:02<00:00, 23.83it/s] 76%|███████▌  | 34/45 [00:02<00:00, 17.06it/s] 98%|█████████▊| 44/45 [00:02<00:00, 29.10it/s]100%|██████████| 45/45 [00:02<00:00, 16.72it/s]
5640 images processed, 2.7167656421661377 seconds used

17.696035861968994
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.60
places365     49.94  89.49  51.36
LSUN          25.94  95.19  76.04
iSUN          26.01  95.03  73.73
dtd           24.68  94.43  71.73
AVG           26.03  94.63  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
2.5408501625061035
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=15, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/15 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  7%|▋         | 1/15 [00:19<04:35, 19.69s/it] 13%|█▎        | 2/15 [00:30<03:05, 14.28s/it] 20%|██        | 3/15 [00:40<02:29, 12.50s/it] 27%|██▋       | 4/15 [00:51<02:12, 12.02s/it] 33%|███▎      | 5/15 [01:02<01:54, 11.42s/it] 40%|████      | 6/15 [01:12<01:40, 11.18s/it][loss] ep 0 it 0 total=12.0911 mle=2.3148 pcon=8.7277 forget=0.0000 orth=1.0486 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0666 mle=2.2863 pcon=8.7318 forget=0.0000 orth=1.0485 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2135 mle=2.4299 pcon=8.7353 forget=0.0000 orth=1.0484 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1217 mle=2.3347 pcon=8.7388 forget=0.0000 orth=1.0482 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7747 mle=1.9850 pcon=8.7417 forget=0.0000 orth=1.0480 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=11.9872 mle=2.1952 pcon=8.7444 forget=0.0000 orth=1.0477 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4181 mle=2.6242 pcon=8.7466 forget=0.0000 orth=1.0474 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9926 mle=2.1973 pcon=8.7483 forget=0.0000 orth=1.0471 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9501 mle=2.1530 pcon=8.7504 forget=0.0000 orth=1.0467 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9381 mle=2.1393 pcon=8.7524 forget=0.0000 orth=1.0463 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0897 mle=2.2898 pcon=8.7540 forget=0.0000 orth=1.0459 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3274 mle=2.5263 pcon=8.7557 forget=0.0000 orth=1.0454 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2573 mle=2.4554 pcon=8.7568 forget=0.0000 orth=1.0450 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.8903 mle=2.0879 pcon=8.7579 forget=0.0000 orth=1.0445 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.1922 mle=2.3891 pcon=8.7592 forget=0.0000 orth=1.0439 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0808 mle=2.2771 pcon=8.7604 forget=0.0000 orth=1.0433 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0149 mle=2.2113 pcon=8.7611 forget=0.0000 orth=1.0425 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0754 mle=2.2714 pcon=8.7622 forget=0.0000 orth=1.0418 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9125 mle=2.1078 pcon=8.7636 forget=0.0000 orth=1.0411 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9621 mle=2.1570 pcon=8.7648 forget=0.0000 orth=1.0403 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5838 mle=1.7783 pcon=8.7659 forget=0.0000 orth=1.0396 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1268 mle=2.3213 pcon=8.7667 forget=0.0000 orth=1.0388 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1814 mle=2.3761 pcon=8.7674 forget=0.0000 orth=1.0379 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6932 mle=1.8875 pcon=8.7688 forget=0.0000 orth=1.0370 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0742 mle=2.2690 pcon=8.7692 forget=0.0000 orth=1.0360 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1939 mle=2.3886 pcon=8.7703 forget=0.0000 orth=1.0349 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1311 mle=2.3260 pcon=8.7711 forget=0.0000 orth=1.0339 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0206 mle=2.2154 pcon=8.7723 forget=0.0000 orth=1.0329 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9360 mle=2.1307 pcon=8.7734 forget=0.0000 orth=1.0318 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9652 mle=2.1600 pcon=8.7745 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9502 mle=2.1455 pcon=8.7753 forget=0.0000 orth=1.0293 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.0058 mle=2.2017 pcon=8.7760 forget=0.0000 orth=1.0281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0140 mle=2.2096 pcon=8.7775 forget=0.0000 orth=1.0268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0255 mle=2.2211 pcon=8.7786 forget=0.0000 orth=1.0259 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1450 mle=2.3407 pcon=8.7796 forget=0.0000 orth=1.0247 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8307 mle=2.0268 pcon=8.7804 forget=0.0000 orth=1.0234 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8796 mle=2.0764 pcon=8.7812 forget=0.0000 orth=1.0219 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8368 mle=2.0335 pcon=8.7826 forget=0.0000 orth=1.0206 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1786 mle=2.3753 pcon=8.7837 forget=0.0000 orth=1.0196 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.8035 mle=2.0002 pcon=8.7849 forget=0.0000 orth=1.0184 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 5 it 45 total=11.9763 mle=2.1737 pcon=8.7856 forget=0.0000 orth=1.0170 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=11.8750 mle=2.0727 pcon=8.7869 forget=0.0000 orth=1.0154 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=11.9058 mle=2.1041 pcon=8.7876 forget=0.0000 orth=1.0142 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=11.9913 mle=2.1896 pcon=8.7891 forget=0.0000 orth=1.0127 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.0464 mle=2.2448 pcon=8.7903 forget=0.0000 orth=1.0114 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=11.7280 mle=1.9258 pcon=8.7922 forget=0.0000 orth=1.0100 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.1236 mle=2.3212 pcon=8.7938 forget=0.0000 orth=1.0086 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 6 it 4 total=11.9788 mle=2.1770 pcon=8.7945 forget=0.0000 orth=1.0074 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.0673 mle=2.2650 pcon=8.7962 forget=0.0000 orth=1.0061 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.8459 mle=2.0433 pcon=8.7981 forget=0.0000 orth=1.0046 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.6712 mle=1.8692 pcon=8.7987 forget=0.0000 orth=1.0032 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
 47%|████▋     | 7/15 [01:23<01:26, 10.87s/it] 53%|█████▎    | 8/15 [01:34<01:16, 10.89s/it] 60%|██████    | 9/15 [01:44<01:04, 10.72s/it] 67%|██████▋   | 10/15 [01:55<00:53, 10.76s/it] 73%|███████▎  | 11/15 [02:05<00:42, 10.68s/it] 80%|████████  | 12/15 [02:17<00:32, 10.89s/it][loss] ep 6 it 204 total=11.8448 mle=2.0433 pcon=8.7999 forget=0.0000 orth=1.0016 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.8538 mle=2.0526 pcon=8.8009 forget=0.0000 orth=1.0003 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2115 mle=2.4098 pcon=8.8026 forget=0.0000 orth=0.9991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.7711 mle=1.9693 pcon=8.8041 forget=0.0000 orth=0.9977 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 7 it 13 total=12.1378 mle=2.3355 pcon=8.8058 forget=0.0000 orth=0.9965 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2207 mle=2.4182 pcon=8.8073 forget=0.0000 orth=0.9952 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0888 mle=2.2862 pcon=8.8088 forget=0.0000 orth=0.9937 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1136 mle=2.3104 pcon=8.8108 forget=0.0000 orth=0.9924 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9124 mle=2.1098 pcon=8.8115 forget=0.0000 orth=0.9911 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9891 mle=2.1855 pcon=8.8138 forget=0.0000 orth=0.9898 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8656 mle=2.0616 pcon=8.8156 forget=0.0000 orth=0.9885 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0134 mle=2.2090 pcon=8.8174 forget=0.0000 orth=0.9870 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 8 it 22 total=11.9794 mle=2.1750 pcon=8.8184 forget=0.0000 orth=0.9860 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8128 mle=2.0084 pcon=8.8199 forget=0.0000 orth=0.9845 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7030 mle=1.8989 pcon=8.8211 forget=0.0000 orth=0.9831 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5990 mle=1.7946 pcon=8.8226 forget=0.0000 orth=0.9818 favg=0.0000 nr=124 nf=1 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6304 mle=1.8259 pcon=8.8242 forget=0.0000 orth=0.9803 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.7918 mle=1.9877 pcon=8.8250 forget=0.0000 orth=0.9791 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8224 mle=2.0182 pcon=8.8266 forget=0.0000 orth=0.9777 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0350 mle=2.2300 pcon=8.8287 forget=0.0000 orth=0.9763 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 9 it 31 total=12.1879 mle=2.3830 pcon=8.8302 forget=0.0000 orth=0.9748 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9306 mle=2.1259 pcon=8.8311 forget=0.0000 orth=0.9736 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7380 mle=1.9343 pcon=8.8318 forget=0.0000 orth=0.9719 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8461 mle=2.0426 pcon=8.8327 forget=0.0000 orth=0.9709 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7757 mle=1.9712 pcon=8.8354 forget=0.0000 orth=0.9691 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8322 mle=2.0279 pcon=8.8369 forget=0.0000 orth=0.9674 favg=0.0000 nr=122 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9327 mle=2.1282 pcon=8.8390 forget=0.0000 orth=0.9656 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7591 mle=1.9545 pcon=8.8404 forget=0.0000 orth=0.9642 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 10 it 40 total=11.6746 mle=1.8700 pcon=8.8420 forget=0.0000 orth=0.9627 favg=0.0000 nr=123 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.1516 mle=2.3475 pcon=8.8430 forget=0.0000 orth=0.9611 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.8341 mle=2.0298 pcon=8.8451 forget=0.0000 orth=0.9593 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.8002 mle=1.9961 pcon=8.8467 forget=0.0000 orth=0.9574 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6464 mle=1.8433 pcon=8.8471 forget=0.0000 orth=0.9560 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0895 mle=2.2861 pcon=8.8495 forget=0.0000 orth=0.9539 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.7923 mle=1.9902 pcon=8.8501 forget=0.0000 orth=0.9520 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.0296 mle=2.2284 pcon=8.8512 forget=0.0000 orth=0.9500 favg=0.0000 nr=74 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 11 it 49 total=11.7765 mle=1.9755 pcon=8.8529 forget=0.0000 orth=0.9481 favg=0.0000 nr=117 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.0844 mle=2.2839 pcon=8.8541 forget=0.0000 orth=0.9464 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.9682 mle=2.1690 pcon=8.8549 forget=0.0000 orth=0.9444 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.8153 mle=2.0166 pcon=8.8560 forget=0.0000 orth=0.9426 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.6048 mle=1.8067 pcon=8.8573 forget=0.0000 orth=0.9408 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.9142 mle=2.1173 pcon=8.8581 forget=0.0000 orth=0.9388 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.6475 mle=1.8511 pcon=8.8594 forget=0.0000 orth=0.9370 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 12 it 8 total=11.9967 mle=2.2003 pcon=8.8610 forget=0.0000 orth=0.9354 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.7880 mle=1.9928 pcon=8.8617 forget=0.0000 orth=0.9335 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.9906 mle=2.1961 pcon=8.8627 forget=0.0000 orth=0.9318 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.7641 mle=1.9701 pcon=8.8638 forget=0.0000 orth=0.9302 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.7960 mle=2.0024 pcon=8.8650 forget=0.0000 orth=0.9285 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.0836 mle=2.2898 pcon=8.8667 forget=0.0000 orth=0.9271 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8982 mle=2.1053 pcon=8.8672 forget=0.0000 orth=0.9257 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9631 mle=2.1700 pcon=8.8686 forget=0.0000 orth=0.9245 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
 87%|████████▋ | 13/15 [02:28<00:21, 10.95s/it] 93%|█████████▎| 14/15 [02:39<00:10, 10.92s/it]100%|██████████| 15/15 [02:49<00:00, 10.82s/it]100%|██████████| 15/15 [02:49<00:00, 11.31s/it]
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 13 it 17 total=12.0299 mle=2.2363 pcon=8.8704 forget=0.0000 orth=0.9232 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.8184 mle=2.0247 pcon=8.8716 forget=0.0000 orth=0.9222 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.0691 mle=2.2753 pcon=8.8725 forget=0.0000 orth=0.9212 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.9042 mle=2.1114 pcon=8.8723 forget=0.0000 orth=0.9204 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.0967 mle=2.3039 pcon=8.8731 forget=0.0000 orth=0.9197 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.9979 mle=2.2051 pcon=8.8737 forget=0.0000 orth=0.9190 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.8934 mle=2.0996 pcon=8.8752 forget=0.0000 orth=0.9185 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.9178 mle=2.1238 pcon=8.8760 forget=0.0000 orth=0.9181 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 26 total=12.1023 mle=2.3078 pcon=8.8768 forget=0.0000 orth=0.9177 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.8217 mle=2.0269 pcon=8.8773 forget=0.0000 orth=0.9174 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.8649 mle=2.0690 pcon=8.8787 forget=0.0000 orth=0.9172 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=12.0110 mle=2.2166 pcon=8.8773 forget=0.0000 orth=0.9171 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.7384 mle=1.9432 pcon=8.8783 forget=0.0000 orth=0.9170 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.9646 mle=2.1689 pcon=8.8788 forget=0.0000 orth=0.9169 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.9170 mle=2.1206 pcon=8.8794 forget=0.0000 orth=0.9169 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.7241 mle=1.9278 pcon=8.8795 forget=0.0000 orth=0.9169 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<06:19,  1.03it/s]  2%|▏         | 9/391 [00:01<00:34, 11.04it/s]  4%|▍         | 16/391 [00:01<00:18, 20.02it/s]  7%|▋         | 26/391 [00:01<00:10, 34.07it/s]  9%|▉         | 36/391 [00:01<00:07, 46.50it/s] 12%|█▏        | 46/391 [00:01<00:05, 57.68it/s] 14%|█▍        | 56/391 [00:01<00:05, 66.99it/s] 17%|█▋        | 66/391 [00:01<00:04, 74.24it/s] 19%|█▉        | 76/391 [00:01<00:03, 80.11it/s] 22%|██▏       | 86/391 [00:01<00:03, 84.38it/s] 25%|██▍       | 96/391 [00:02<00:03, 80.45it/s] 27%|██▋       | 105/391 [00:02<00:03, 74.41it/s] 29%|██▉       | 115/391 [00:02<00:03, 79.37it/s] 32%|███▏      | 124/391 [00:02<00:03, 80.34it/s] 34%|███▍      | 133/391 [00:02<00:04, 57.95it/s] 37%|███▋      | 143/391 [00:02<00:03, 66.10it/s] 39%|███▉      | 152/391 [00:02<00:03, 71.26it/s] 41%|████▏     | 162/391 [00:02<00:02, 76.80it/s] 44%|████▍     | 172/391 [00:03<00:02, 81.37it/s] 47%|████▋     | 182/391 [00:03<00:02, 85.23it/s] 49%|████▉     | 192/391 [00:03<00:02, 88.00it/s] 52%|█████▏    | 202/391 [00:03<00:02, 88.47it/s] 54%|█████▍    | 212/391 [00:03<00:02, 85.92it/s] 57%|█████▋    | 222/391 [00:03<00:01, 88.29it/s] 59%|█████▉    | 232/391 [00:03<00:01, 89.80it/s] 62%|██████▏   | 242/391 [00:03<00:01, 90.71it/s] 64%|██████▍   | 252/391 [00:03<00:01, 91.82it/s] 67%|██████▋   | 262/391 [00:04<00:01, 92.99it/s] 70%|██████▉   | 272/391 [00:04<00:01, 93.43it/s] 72%|███████▏  | 282/391 [00:04<00:01, 94.15it/s] 75%|███████▍  | 292/391 [00:04<00:01, 94.59it/s] 77%|███████▋  | 302/391 [00:04<00:00, 94.89it/s] 80%|███████▉  | 312/391 [00:04<00:00, 95.11it/s] 82%|████████▏ | 322/391 [00:04<00:00, 95.27it/s] 85%|████████▍ | 332/391 [00:04<00:00, 95.30it/s] 87%|████████▋ | 342/391 [00:04<00:00, 95.43it/s] 90%|█████████ | 352/391 [00:05<00:00, 94.43it/s] 93%|█████████▎| 362/391 [00:05<00:00, 94.43it/s] 95%|█████████▌| 372/391 [00:05<00:00, 94.48it/s] 98%|█████████▊| 382/391 [00:05<00:00, 95.26it/s]100%|██████████| 391/391 [00:05<00:00, 71.83it/s]
50000 images processed, 5.501785516738892 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:42,  1.82it/s] 11%|█▏        | 9/79 [00:00<00:03, 17.51it/s] 18%|█▊        | 14/79 [00:00<00:02, 24.47it/s] 28%|██▊       | 22/79 [00:00<00:01, 37.26it/s] 41%|████      | 32/79 [00:00<00:00, 51.87it/s] 52%|█████▏    | 41/79 [00:01<00:00, 60.39it/s] 65%|██████▍   | 51/79 [00:01<00:00, 69.53it/s] 76%|███████▌  | 60/79 [00:01<00:00, 73.98it/s] 87%|████████▋ | 69/79 [00:01<00:00, 63.84it/s]100%|██████████| 79/79 [00:01<00:00, 70.38it/s]100%|██████████| 79/79 [00:01<00:00, 49.35it/s]
10000 images processed, 1.6204423904418945 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:06,  1.61it/s]  3%|▎         | 6/204 [00:00<00:18, 10.59it/s]  7%|▋         | 14/204 [00:00<00:07, 24.63it/s] 11%|█▏        | 23/204 [00:00<00:04, 38.82it/s] 16%|█▌        | 33/204 [00:01<00:03, 52.72it/s] 20%|██        | 41/204 [00:01<00:02, 56.90it/s] 24%|██▍       | 49/204 [00:01<00:02, 54.05it/s] 28%|██▊       | 57/204 [00:01<00:02, 59.57it/s] 32%|███▏      | 66/204 [00:01<00:02, 67.11it/s] 37%|███▋      | 76/204 [00:01<00:01, 74.56it/s] 42%|████▏     | 86/204 [00:01<00:01, 79.29it/s] 47%|████▋     | 96/204 [00:01<00:01, 83.18it/s] 52%|█████▏    | 106/204 [00:01<00:01, 85.57it/s] 57%|█████▋    | 116/204 [00:02<00:01, 87.93it/s] 62%|██████▏   | 126/204 [00:02<00:00, 89.01it/s] 67%|██████▋   | 136/204 [00:02<00:00, 90.35it/s] 72%|███████▏  | 146/204 [00:02<00:00, 89.48it/s] 76%|███████▋  | 156/204 [00:02<00:00, 90.85it/s] 81%|████████▏ | 166/204 [00:02<00:00, 91.21it/s] 86%|████████▋ | 176/204 [00:02<00:00, 91.30it/s] 91%|█████████ | 186/204 [00:02<00:00, 89.44it/s] 96%|█████████▌| 196/204 [00:02<00:00, 91.36it/s]100%|██████████| 204/204 [00:03<00:00, 66.66it/s]
26032 images processed, 3.1083061695098877 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:07,  1.16it/s] 13%|█▎        | 10/79 [00:00<00:05, 13.70it/s] 25%|██▌       | 20/79 [00:01<00:02, 27.88it/s] 35%|███▌      | 28/79 [00:01<00:01, 34.21it/s] 44%|████▍     | 35/79 [00:01<00:01, 41.30it/s] 54%|█████▍    | 43/79 [00:01<00:00, 49.15it/s] 63%|██████▎   | 50/79 [00:01<00:00, 53.83it/s] 76%|███████▌  | 60/79 [00:01<00:00, 64.75it/s] 86%|████████▌ | 68/79 [00:01<00:00, 60.10it/s] 95%|█████████▍| 75/79 [00:01<00:00, 56.64it/s]100%|██████████| 79/79 [00:01<00:00, 40.02it/s]
10000 images processed, 2.0011518001556396 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.60it/s] 11%|█▏        | 9/79 [00:00<00:04, 16.00it/s] 24%|██▍       | 19/79 [00:00<00:01, 33.07it/s] 35%|███▌      | 28/79 [00:00<00:01, 45.80it/s] 48%|████▊     | 38/79 [00:01<00:00, 58.22it/s] 61%|██████    | 48/79 [00:01<00:00, 67.77it/s] 73%|███████▎  | 58/79 [00:01<00:00, 75.53it/s] 86%|████████▌ | 68/79 [00:01<00:00, 81.39it/s] 99%|█████████▊| 78/79 [00:01<00:00, 85.49it/s]100%|██████████| 79/79 [00:01<00:00, 53.84it/s]
10000 images processed, 1.4909586906433105 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:52,  1.32it/s] 14%|█▍        | 10/70 [00:00<00:03, 15.30it/s] 29%|██▊       | 20/70 [00:00<00:01, 30.51it/s] 43%|████▎     | 30/70 [00:01<00:00, 44.25it/s] 57%|█████▋    | 40/70 [00:01<00:00, 56.17it/s] 71%|███████▏  | 50/70 [00:01<00:00, 66.16it/s] 86%|████████▌ | 60/70 [00:01<00:00, 74.14it/s]100%|██████████| 70/70 [00:01<00:00, 79.34it/s]100%|██████████| 70/70 [00:01<00:00, 46.85it/s]
8925 images processed, 1.5379364490509033 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:44,  1.00s/it]  4%|▍         | 2/45 [00:01<00:26,  1.59it/s] 27%|██▋       | 12/45 [00:01<00:02, 13.13it/s] 40%|████      | 18/45 [00:01<00:02, 12.55it/s] 56%|█████▌    | 25/45 [00:02<00:01, 19.12it/s] 67%|██████▋   | 30/45 [00:02<00:00, 23.07it/s] 78%|███████▊  | 35/45 [00:02<00:00, 14.46it/s]100%|██████████| 45/45 [00:02<00:00, 23.62it/s]100%|██████████| 45/45 [00:02<00:00, 15.25it/s]
5640 images processed, 2.9713327884674072 seconds used

20.427703857421875
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.72  98.93  80.32
places365     51.58  85.51  48.69
LSUN          42.75  89.99  64.39
iSUN          34.49  91.56  66.68
dtd           31.22  92.30  73.91
AVG           32.75  91.66  66.80
[incremental] Overall: 0.7340 New: 0.7140 Old: 0.7540
[incremental] Final(Top-1): 0.7340  Average: 0.7910
4.793065309524536
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=15, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/15 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  7%|▋         | 1/15 [00:19<04:29, 19.28s/it] 13%|█▎        | 2/15 [00:29<03:05, 14.24s/it] 20%|██        | 3/15 [00:40<02:31, 12.64s/it] 27%|██▋       | 4/15 [00:51<02:11, 11.92s/it] 33%|███▎      | 5/15 [01:02<01:55, 11.53s/it] 40%|████      | 6/15 [01:13<01:41, 11.32s/it][loss] ep 0 it 0 total=12.8871 mle=2.3149 pcon=9.4393 forget=0.0000 orth=1.1330 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.8555 mle=2.2789 pcon=9.4437 forget=0.0000 orth=1.1328 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=13.0075 mle=2.4266 pcon=9.4484 forget=0.0000 orth=1.1326 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.8686 mle=2.2839 pcon=9.4527 forget=0.0000 orth=1.1321 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=12.5312 mle=1.9427 pcon=9.4571 forget=0.0000 orth=1.1314 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=12.6691 mle=2.0782 pcon=9.4603 forget=0.0000 orth=1.1305 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.1480 mle=2.5541 pcon=9.4644 forget=0.0000 orth=1.1295 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=12.7467 mle=2.1506 pcon=9.4680 forget=0.0000 orth=1.1282 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=12.7414 mle=2.1433 pcon=9.4713 forget=0.0000 orth=1.1268 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=12.7053 mle=2.1060 pcon=9.4741 forget=0.0000 orth=1.1252 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.8692 mle=2.2683 pcon=9.4774 forget=0.0000 orth=1.1234 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=13.0537 mle=2.4525 pcon=9.4798 forget=0.0000 orth=1.1215 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.9937 mle=2.3927 pcon=9.4816 forget=0.0000 orth=1.1193 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=12.6542 mle=2.0535 pcon=9.4836 forget=0.0000 orth=1.1171 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.9243 mle=2.3235 pcon=9.4861 forget=0.0000 orth=1.1147 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.8296 mle=2.2290 pcon=9.4885 forget=0.0000 orth=1.1121 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=12.7443 mle=2.1442 pcon=9.4907 forget=0.0000 orth=1.1093 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.8740 mle=2.2747 pcon=9.4928 forget=0.0000 orth=1.1065 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=12.6615 mle=2.0631 pcon=9.4950 forget=0.0000 orth=1.1034 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=12.7536 mle=2.1560 pcon=9.4974 forget=0.0000 orth=1.1002 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=12.3469 mle=1.7501 pcon=9.4999 forget=0.0000 orth=1.0969 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.8532 mle=2.2584 pcon=9.5014 forget=0.0000 orth=1.0935 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.9115 mle=2.3179 pcon=9.5036 forget=0.0000 orth=1.0899 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=12.4488 mle=1.8565 pcon=9.5061 forget=0.0000 orth=1.0862 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=12.7925 mle=2.2020 pcon=9.5082 forget=0.0000 orth=1.0823 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.8966 mle=2.3077 pcon=9.5105 forget=0.0000 orth=1.0784 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.8669 mle=2.2804 pcon=9.5123 forget=0.0000 orth=1.0742 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.7190 mle=2.1350 pcon=9.5140 forget=0.0000 orth=1.0701 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=12.6760 mle=2.0947 pcon=9.5156 forget=0.0000 orth=1.0658 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=12.7330 mle=2.1539 pcon=9.5176 forget=0.0000 orth=1.0614 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=12.6890 mle=2.1127 pcon=9.5192 forget=0.0000 orth=1.0571 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.7557 mle=2.1820 pcon=9.5211 forget=0.0000 orth=1.0526 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=12.7347 mle=2.1637 pcon=9.5230 forget=0.0000 orth=1.0480 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.7604 mle=2.1923 pcon=9.5249 forget=0.0000 orth=1.0433 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.8488 mle=2.2837 pcon=9.5266 forget=0.0000 orth=1.0385 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.5701 mle=2.0083 pcon=9.5280 forget=0.0000 orth=1.0338 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.6089 mle=2.0505 pcon=9.5295 forget=0.0000 orth=1.0289 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.5575 mle=2.0025 pcon=9.5309 forget=0.0000 orth=1.0241 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.8541 mle=2.3024 pcon=9.5326 forget=0.0000 orth=1.0192 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.5288 mle=1.9804 pcon=9.5341 forget=0.0000 orth=1.0143 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 5 it 45 total=12.6976 mle=2.1532 pcon=9.5351 forget=0.0000 orth=1.0093 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.5948 mle=2.0538 pcon=9.5367 forget=0.0000 orth=1.0043 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.6034 mle=2.0655 pcon=9.5385 forget=0.0000 orth=0.9994 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.6667 mle=2.1323 pcon=9.5399 forget=0.0000 orth=0.9945 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.7372 mle=2.2061 pcon=9.5415 forget=0.0000 orth=0.9896 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.4153 mle=1.8872 pcon=9.5434 forget=0.0000 orth=0.9847 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.7999 mle=2.2752 pcon=9.5449 forget=0.0000 orth=0.9798 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 6 it 4 total=12.6740 mle=2.1528 pcon=9.5464 forget=0.0000 orth=0.9748 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.7331 mle=2.2155 pcon=9.5477 forget=0.0000 orth=0.9699 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.5187 mle=2.0043 pcon=9.5493 forget=0.0000 orth=0.9652 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.3474 mle=1.8368 pcon=9.5503 forget=0.0000 orth=0.9603 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
 47%|████▋     | 7/15 [01:23<01:28, 11.00s/it] 53%|█████▎    | 8/15 [01:34<01:15, 10.81s/it] 60%|██████    | 9/15 [01:45<01:06, 11.03s/it] 67%|██████▋   | 10/15 [01:55<00:54, 10.80s/it] 73%|███████▎  | 11/15 [02:06<00:42, 10.67s/it] 80%|████████  | 12/15 [02:17<00:32, 10.74s/it][loss] ep 6 it 204 total=12.5316 mle=2.0250 pcon=9.5510 forget=0.0000 orth=0.9556 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=12.5419 mle=2.0392 pcon=9.5519 forget=0.0000 orth=0.9508 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.8636 mle=2.3642 pcon=9.5533 forget=0.0000 orth=0.9460 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.4259 mle=1.9299 pcon=9.5547 forget=0.0000 orth=0.9413 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 7 it 13 total=12.7709 mle=2.2787 pcon=9.5556 forget=0.0000 orth=0.9367 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.8584 mle=2.3699 pcon=9.5563 forget=0.0000 orth=0.9321 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.7425 mle=2.2577 pcon=9.5573 forget=0.0000 orth=0.9274 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.7550 mle=2.2737 pcon=9.5585 forget=0.0000 orth=0.9228 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.5616 mle=2.0836 pcon=9.5597 forget=0.0000 orth=0.9183 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.6441 mle=2.1694 pcon=9.5609 forget=0.0000 orth=0.9138 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.5166 mle=2.0454 pcon=9.5619 forget=0.0000 orth=0.9093 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.6523 mle=2.1845 pcon=9.5630 forget=0.0000 orth=0.9048 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 8 it 22 total=12.6033 mle=2.1395 pcon=9.5635 forget=0.0000 orth=0.9003 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.4315 mle=1.9713 pcon=9.5643 forget=0.0000 orth=0.8958 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.3489 mle=1.8928 pcon=9.5648 forget=0.0000 orth=0.8913 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=12.2289 mle=1.7765 pcon=9.5656 forget=0.0000 orth=0.8868 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=12.2459 mle=1.7973 pcon=9.5662 forget=0.0000 orth=0.8824 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.4075 mle=1.9634 pcon=9.5663 forget=0.0000 orth=0.8778 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.4556 mle=2.0155 pcon=9.5668 forget=0.0000 orth=0.8733 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.6190 mle=2.1832 pcon=9.5672 forget=0.0000 orth=0.8686 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 9 it 31 total=12.7787 mle=2.3474 pcon=9.5673 forget=0.0000 orth=0.8639 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=12.5032 mle=2.0768 pcon=9.5672 forget=0.0000 orth=0.8592 favg=0.0000 nr=110 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=12.3646 mle=1.9430 pcon=9.5671 forget=0.0000 orth=0.8545 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=12.4304 mle=2.0138 pcon=9.5670 forget=0.0000 orth=0.8496 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=12.3477 mle=1.9354 pcon=9.5675 forget=0.0000 orth=0.8448 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=12.4238 mle=2.0163 pcon=9.5676 forget=0.0000 orth=0.8399 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.5271 mle=2.1252 pcon=9.5670 forget=0.0000 orth=0.8349 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=12.3065 mle=1.9104 pcon=9.5664 forget=0.0000 orth=0.8297 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 10 it 40 total=12.2576 mle=1.8667 pcon=9.5664 forget=0.0000 orth=0.8245 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.7100 mle=2.3248 pcon=9.5661 forget=0.0000 orth=0.8191 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=12.3685 mle=1.9882 pcon=9.5665 forget=0.0000 orth=0.8138 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=12.3484 mle=1.9739 pcon=9.5661 forget=0.0000 orth=0.8084 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=12.1926 mle=1.8240 pcon=9.5656 forget=0.0000 orth=0.8031 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.6171 mle=2.2532 pcon=9.5660 forget=0.0000 orth=0.7978 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=12.3239 mle=1.9665 pcon=9.5649 forget=0.0000 orth=0.7926 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.5620 mle=2.2106 pcon=9.5641 forget=0.0000 orth=0.7873 favg=0.0000 nr=68 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 11 it 49 total=12.3079 mle=1.9624 pcon=9.5632 forget=0.0000 orth=0.7823 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.5310 mle=2.1915 pcon=9.5623 forget=0.0000 orth=0.7772 favg=0.0000 nr=102 nf=11 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=12.4488 mle=2.1150 pcon=9.5615 forget=0.0000 orth=0.7723 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=12.3236 mle=1.9957 pcon=9.5605 forget=0.0000 orth=0.7674 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=12.1008 mle=1.7790 pcon=9.5591 forget=0.0000 orth=0.7627 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=12.4175 mle=2.1022 pcon=9.5572 forget=0.0000 orth=0.7581 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=12.1645 mle=1.8549 pcon=9.5558 forget=0.0000 orth=0.7537 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 12 it 8 total=12.4244 mle=2.1201 pcon=9.5548 forget=0.0000 orth=0.7495 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=12.2773 mle=1.9789 pcon=9.5529 forget=0.0000 orth=0.7455 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=12.4579 mle=2.1649 pcon=9.5513 forget=0.0000 orth=0.7417 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=12.2837 mle=1.9959 pcon=9.5497 forget=0.0000 orth=0.7381 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=12.2098 mle=1.9274 pcon=9.5476 forget=0.0000 orth=0.7348 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.5612 mle=2.2830 pcon=9.5466 forget=0.0000 orth=0.7317 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=12.3698 mle=2.0958 pcon=9.5452 forget=0.0000 orth=0.7288 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=12.3836 mle=2.1137 pcon=9.5437 forget=0.0000 orth=0.7262 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
 87%|████████▋ | 13/15 [02:26<00:20, 10.41s/it] 93%|█████████▎| 14/15 [02:35<00:10, 10.05s/it]100%|██████████| 15/15 [02:47<00:00, 10.44s/it]100%|██████████| 15/15 [02:47<00:00, 11.15s/it]
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 13 it 17 total=12.4235 mle=2.1573 pcon=9.5423 forget=0.0000 orth=0.7239 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=12.1907 mle=1.9283 pcon=9.5407 forget=0.0000 orth=0.7217 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.5198 mle=2.2603 pcon=9.5397 forget=0.0000 orth=0.7199 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=12.3642 mle=2.1088 pcon=9.5373 forget=0.0000 orth=0.7182 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.4930 mle=2.2400 pcon=9.5363 forget=0.0000 orth=0.7168 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=12.4245 mle=2.1743 pcon=9.5347 forget=0.0000 orth=0.7155 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=12.3284 mle=2.0800 pcon=9.5340 forget=0.0000 orth=0.7145 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=12.3411 mle=2.0953 pcon=9.5322 forget=0.0000 orth=0.7136 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 14 it 26 total=12.5025 mle=2.2582 pcon=9.5313 forget=0.0000 orth=0.7130 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=12.2200 mle=1.9776 pcon=9.5300 forget=0.0000 orth=0.7124 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=12.2921 mle=2.0515 pcon=9.5286 forget=0.0000 orth=0.7121 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=12.4135 mle=2.1758 pcon=9.5259 forget=0.0000 orth=0.7118 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=12.1840 mle=1.9480 pcon=9.5244 forget=0.0000 orth=0.7116 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=12.3784 mle=2.1439 pcon=9.5229 forget=0.0000 orth=0.7115 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=12.2813 mle=2.0477 pcon=9.5221 forget=0.0000 orth=0.7115 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=12.1146 mle=1.8823 pcon=9.5208 forget=0.0000 orth=0.7115 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:59,  2.18it/s]  3%|▎         | 10/391 [00:00<00:16, 23.02it/s]  5%|▌         | 20/391 [00:00<00:08, 41.88it/s]  7%|▋         | 28/391 [00:00<00:07, 50.51it/s] 10%|▉         | 38/391 [00:00<00:05, 62.86it/s] 12%|█▏        | 48/391 [00:00<00:04, 71.90it/s] 15%|█▍        | 58/391 [00:01<00:04, 78.61it/s] 17%|█▋        | 68/391 [00:01<00:03, 83.53it/s] 20%|█▉        | 78/391 [00:01<00:03, 86.01it/s] 23%|██▎       | 88/391 [00:01<00:03, 84.39it/s] 25%|██▌       | 98/391 [00:01<00:03, 87.63it/s] 28%|██▊       | 108/391 [00:01<00:03, 89.89it/s] 30%|███       | 118/391 [00:01<00:02, 91.37it/s] 33%|███▎      | 128/391 [00:01<00:02, 92.55it/s] 35%|███▌      | 138/391 [00:01<00:02, 93.58it/s] 38%|███▊      | 148/391 [00:02<00:02, 94.48it/s] 40%|████      | 158/391 [00:02<00:02, 95.03it/s] 43%|████▎     | 168/391 [00:02<00:02, 94.79it/s] 46%|████▌     | 178/391 [00:02<00:02, 95.06it/s] 48%|████▊     | 188/391 [00:02<00:02, 95.55it/s] 51%|█████     | 198/391 [00:02<00:02, 95.94it/s] 53%|█████▎    | 208/391 [00:02<00:01, 95.86it/s] 56%|█████▌    | 218/391 [00:02<00:01, 93.82it/s] 58%|█████▊    | 228/391 [00:02<00:01, 94.18it/s] 61%|██████    | 238/391 [00:03<00:01, 94.31it/s] 63%|██████▎   | 248/391 [00:03<00:01, 93.82it/s] 66%|██████▌   | 258/391 [00:03<00:01, 85.76it/s] 68%|██████▊   | 267/391 [00:03<00:01, 75.98it/s] 71%|███████   | 277/391 [00:03<00:01, 80.89it/s] 73%|███████▎  | 286/391 [00:03<00:01, 80.26it/s] 76%|███████▌  | 296/391 [00:03<00:01, 83.53it/s] 78%|███████▊  | 306/391 [00:03<00:00, 86.83it/s] 81%|████████  | 316/391 [00:03<00:00, 89.15it/s] 83%|████████▎ | 326/391 [00:04<00:00, 90.82it/s] 86%|████████▌ | 336/391 [00:04<00:00, 92.20it/s] 88%|████████▊ | 346/391 [00:04<00:00, 93.16it/s] 91%|█████████ | 356/391 [00:04<00:00, 94.05it/s] 94%|█████████▎| 366/391 [00:04<00:00, 94.07it/s] 96%|█████████▌| 376/391 [00:04<00:00, 95.22it/s] 99%|█████████▊| 386/391 [00:04<00:00, 96.01it/s]100%|██████████| 391/391 [00:04<00:00, 82.61it/s]
50000 images processed, 4.7701780796051025 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.17it/s] 14%|█▍        | 11/79 [00:00<00:02, 25.05it/s] 27%|██▋       | 21/79 [00:00<00:01, 43.05it/s] 39%|███▉      | 31/79 [00:00<00:00, 56.60it/s] 52%|█████▏    | 41/79 [00:00<00:00, 66.89it/s] 65%|██████▍   | 51/79 [00:00<00:00, 74.68it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.63it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.22it/s]100%|██████████| 79/79 [00:01<00:00, 44.74it/s]
10000 images processed, 1.7838528156280518 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:33,  2.18it/s]  5%|▌         | 11/204 [00:00<00:07, 25.00it/s] 10%|█         | 21/204 [00:00<00:04, 42.81it/s] 15%|█▌        | 31/204 [00:00<00:03, 56.49it/s] 20%|█▉        | 40/204 [00:00<00:02, 63.10it/s] 25%|██▍       | 50/204 [00:01<00:02, 71.22it/s] 29%|██▉       | 60/204 [00:01<00:01, 77.51it/s] 34%|███▍      | 69/204 [00:01<00:01, 80.31it/s] 39%|███▊      | 79/204 [00:01<00:01, 84.16it/s] 43%|████▎     | 88/204 [00:01<00:01, 85.75it/s] 48%|████▊     | 98/204 [00:01<00:01, 88.09it/s] 53%|█████▎    | 108/204 [00:01<00:01, 89.62it/s] 58%|█████▊    | 118/204 [00:01<00:00, 90.96it/s] 63%|██████▎   | 128/204 [00:01<00:00, 91.62it/s] 68%|██████▊   | 138/204 [00:01<00:00, 91.63it/s] 73%|███████▎  | 148/204 [00:02<00:00, 92.63it/s] 77%|███████▋  | 158/204 [00:02<00:00, 93.42it/s] 82%|████████▏ | 168/204 [00:02<00:00, 94.14it/s] 87%|████████▋ | 178/204 [00:02<00:00, 94.26it/s] 92%|█████████▏| 188/204 [00:02<00:00, 95.11it/s] 97%|█████████▋| 198/204 [00:02<00:00, 95.65it/s]100%|██████████| 204/204 [00:02<00:00, 76.93it/s]
26032 images processed, 2.690422773361206 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:08,  1.13it/s] 11%|█▏        | 9/79 [00:00<00:05, 12.01it/s] 24%|██▍       | 19/79 [00:01<00:02, 26.22it/s] 33%|███▎      | 26/79 [00:01<00:01, 34.01it/s] 46%|████▌     | 36/79 [00:01<00:00, 47.31it/s] 58%|█████▊    | 46/79 [00:01<00:00, 57.54it/s] 71%|███████   | 56/79 [00:01<00:00, 66.91it/s] 84%|████████▎ | 66/79 [00:01<00:00, 74.56it/s] 95%|█████████▍| 75/79 [00:01<00:00, 75.70it/s]100%|██████████| 79/79 [00:01<00:00, 44.27it/s]
10000 images processed, 1.8061914443969727 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:37,  2.06it/s] 11%|█▏        | 9/79 [00:00<00:03, 19.75it/s] 24%|██▍       | 19/79 [00:00<00:01, 38.77it/s] 37%|███▋      | 29/79 [00:00<00:00, 53.44it/s] 49%|████▉     | 39/79 [00:00<00:00, 64.78it/s] 62%|██████▏   | 49/79 [00:01<00:00, 73.27it/s] 75%|███████▍  | 59/79 [00:01<00:00, 79.62it/s] 87%|████████▋ | 69/79 [00:01<00:00, 84.61it/s]100%|██████████| 79/79 [00:01<00:00, 60.06it/s]
10000 images processed, 1.3345744609832764 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:33,  2.04it/s] 14%|█▍        | 10/70 [00:00<00:02, 21.77it/s] 29%|██▊       | 20/70 [00:00<00:01, 40.26it/s] 43%|████▎     | 30/70 [00:00<00:00, 54.55it/s] 57%|█████▋    | 40/70 [00:00<00:00, 65.55it/s] 71%|███████▏  | 50/70 [00:01<00:00, 74.29it/s] 86%|████████▌ | 60/70 [00:01<00:00, 80.78it/s]100%|██████████| 70/70 [00:01<00:00, 84.70it/s]100%|██████████| 70/70 [00:01<00:00, 57.24it/s]
8925 images processed, 1.249551773071289 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.06it/s]  4%|▍         | 2/45 [00:01<00:21,  1.97it/s] 16%|█▌        | 7/45 [00:01<00:07,  4.82it/s] 38%|███▊      | 17/45 [00:01<00:01, 14.31it/s] 51%|█████     | 23/45 [00:02<00:01, 13.05it/s] 73%|███████▎  | 33/45 [00:02<00:00, 22.02it/s] 87%|████████▋ | 39/45 [00:02<00:00, 19.21it/s]100%|██████████| 45/45 [00:03<00:00, 14.81it/s]
5640 images processed, 3.0578103065490723 seconds used

18.307180881500244
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.40  99.24  89.58
places365     63.68  84.57  51.60
LSUN          37.71  92.79  78.15
iSUN          41.51  91.33  74.35
dtd           32.36  92.15  78.78
AVG           35.73  92.02  74.49
[incremental] Overall: 0.6847 New: 0.6980 Old: 0.6780
[incremental] Final(Top-1): 0.6847  Average: 0.7556
7.232644557952881
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=15, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/15 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  7%|▋         | 1/15 [00:17<04:09, 17.83s/it] 13%|█▎        | 2/15 [00:28<02:54, 13.42s/it] 20%|██        | 3/15 [00:37<02:21, 11.78s/it] 27%|██▋       | 4/15 [00:47<02:01, 11.03s/it] 33%|███▎      | 5/15 [00:58<01:48, 10.83s/it] 40%|████      | 6/15 [01:08<01:35, 10.65s/it][loss] ep 0 it 0 total=13.6582 mle=2.3632 pcon=9.8395 forget=0.0000 orth=1.4556 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=13.5348 mle=2.2371 pcon=9.8425 forget=0.0000 orth=1.4552 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=13.6171 mle=2.3168 pcon=9.8458 forget=0.0000 orth=1.4546 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=13.5631 mle=2.2618 pcon=9.8477 forget=0.0000 orth=1.4535 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=13.2355 mle=1.9335 pcon=9.8500 forget=0.0000 orth=1.4520 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.3784 mle=2.0766 pcon=9.8517 forget=0.0000 orth=1.4501 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.8220 mle=2.5216 pcon=9.8526 forget=0.0000 orth=1.4478 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.4212 mle=2.1233 pcon=9.8528 forget=0.0000 orth=1.4450 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.3807 mle=2.0858 pcon=9.8531 forget=0.0000 orth=1.4418 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.3719 mle=2.0804 pcon=9.8533 forget=0.0000 orth=1.4382 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.5316 mle=2.2439 pcon=9.8535 forget=0.0000 orth=1.4342 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=13.6842 mle=2.4008 pcon=9.8537 forget=0.0000 orth=1.4297 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.6465 mle=2.3686 pcon=9.8530 forget=0.0000 orth=1.4248 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.3055 mle=2.0340 pcon=9.8520 forget=0.0000 orth=1.4195 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.5232 mle=2.2578 pcon=9.8517 forget=0.0000 orth=1.4137 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.4824 mle=2.2244 pcon=9.8505 forget=0.0000 orth=1.4075 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.3524 mle=2.1008 pcon=9.8506 forget=0.0000 orth=1.4009 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.4842 mle=2.2396 pcon=9.8507 forget=0.0000 orth=1.3939 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.2496 mle=2.0128 pcon=9.8504 forget=0.0000 orth=1.3864 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.3589 mle=2.1301 pcon=9.8503 forget=0.0000 orth=1.3784 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.0125 mle=1.7930 pcon=9.8495 forget=0.0000 orth=1.3700 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.4338 mle=2.2243 pcon=9.8483 forget=0.0000 orth=1.3611 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.4985 mle=2.2988 pcon=9.8480 forget=0.0000 orth=1.3518 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.0077 mle=1.8180 pcon=9.8477 forget=0.0000 orth=1.3420 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.3761 mle=2.1972 pcon=9.8472 forget=0.0000 orth=1.3318 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.4709 mle=2.3031 pcon=9.8467 forget=0.0000 orth=1.3211 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.3566 mle=2.2008 pcon=9.8459 forget=0.0000 orth=1.3100 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.2395 mle=2.0961 pcon=9.8450 forget=0.0000 orth=1.2984 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.1574 mle=2.0266 pcon=9.8444 forget=0.0000 orth=1.2864 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.2146 mle=2.0967 pcon=9.8440 forget=0.0000 orth=1.2739 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.1816 mle=2.0775 pcon=9.8431 forget=0.0000 orth=1.2610 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.1876 mle=2.0974 pcon=9.8426 forget=0.0000 orth=1.2477 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.2380 mle=2.1624 pcon=9.8417 forget=0.0000 orth=1.2339 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.2055 mle=2.1448 pcon=9.8409 forget=0.0000 orth=1.2198 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.2468 mle=2.2012 pcon=9.8403 forget=0.0000 orth=1.2053 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.9734 mle=1.9432 pcon=9.8398 forget=0.0000 orth=1.1905 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=13.0281 mle=2.0138 pcon=9.8391 forget=0.0000 orth=1.1752 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.9748 mle=1.9762 pcon=9.8390 forget=0.0000 orth=1.1596 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.2193 mle=2.2370 pcon=9.8385 forget=0.0000 orth=1.1438 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.9233 mle=1.9573 pcon=9.8383 forget=0.0000 orth=1.1277 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 5 it 45 total=13.0647 mle=2.1157 pcon=9.8375 forget=0.0000 orth=1.1114 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.9797 mle=2.0479 pcon=9.8369 forget=0.0000 orth=1.0949 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.9499 mle=2.0355 pcon=9.8360 forget=0.0000 orth=1.0783 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.9819 mle=2.0846 pcon=9.8356 forget=0.0000 orth=1.0616 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=13.0188 mle=2.1387 pcon=9.8353 forget=0.0000 orth=1.0449 favg=0.0000 nr=97 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.7035 mle=1.8402 pcon=9.8352 forget=0.0000 orth=1.0281 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=13.0782 mle=2.2316 pcon=9.8353 forget=0.0000 orth=1.0113 favg=0.0000 nr=95 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 6 it 4 total=12.9135 mle=2.0845 pcon=9.8344 forget=0.0000 orth=0.9946 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.9585 mle=2.1464 pcon=9.8341 forget=0.0000 orth=0.9780 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.7441 mle=1.9488 pcon=9.8338 forget=0.0000 orth=0.9615 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.5775 mle=1.7992 pcon=9.8332 forget=0.0000 orth=0.9451 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=12.7692 mle=2.0080 pcon=9.8322 forget=0.0000 orth=0.9290 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
 47%|████▋     | 7/15 [01:19<01:25, 10.64s/it] 53%|█████▎    | 8/15 [01:29<01:12, 10.41s/it] 60%|██████    | 9/15 [01:39<01:02, 10.34s/it] 67%|██████▋   | 10/15 [01:49<00:51, 10.27s/it] 73%|███████▎  | 11/15 [01:59<00:40, 10.25s/it] 80%|████████  | 12/15 [02:09<00:30, 10.13s/it] 87%|████████▋ | 13/15 [02:19<00:20, 10.10s/it][loss] ep 6 it 254 total=12.8286 mle=2.0841 pcon=9.8316 forget=0.0000 orth=0.9129 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=13.0106 mle=2.2821 pcon=9.8314 forget=0.0000 orth=0.8971 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.6382 mle=1.9262 pcon=9.8305 forget=0.0000 orth=0.8815 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 7 it 13 total=12.9324 mle=2.2361 pcon=9.8302 forget=0.0000 orth=0.8662 favg=0.0000 nr=98 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=13.0037 mle=2.3229 pcon=9.8297 forget=0.0000 orth=0.8511 favg=0.0000 nr=94 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.8797 mle=2.2142 pcon=9.8292 forget=0.0000 orth=0.8363 favg=0.0000 nr=93 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.8765 mle=2.2260 pcon=9.8287 forget=0.0000 orth=0.8218 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.6629 mle=2.0272 pcon=9.8281 forget=0.0000 orth=0.8077 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.7877 mle=2.1664 pcon=9.8275 forget=0.0000 orth=0.7939 favg=0.0000 nr=102 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.6136 mle=2.0058 pcon=9.8274 forget=0.0000 orth=0.7804 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.7339 mle=2.1401 pcon=9.8267 forget=0.0000 orth=0.7671 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 8 it 22 total=12.6402 mle=2.0604 pcon=9.8259 forget=0.0000 orth=0.7540 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.4724 mle=1.9060 pcon=9.8251 forget=0.0000 orth=0.7413 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.4411 mle=1.8881 pcon=9.8241 forget=0.0000 orth=0.7288 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=12.3069 mle=1.7671 pcon=9.8232 forget=0.0000 orth=0.7165 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=12.2778 mle=1.7507 pcon=9.8225 forget=0.0000 orth=0.7046 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.4509 mle=1.9364 pcon=9.8215 forget=0.0000 orth=0.6931 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.5050 mle=2.0023 pcon=9.8209 forget=0.0000 orth=0.6818 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.6241 mle=2.1337 pcon=9.8196 forget=0.0000 orth=0.6708 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 9 it 31 total=12.7585 mle=2.2802 pcon=9.8183 forget=0.0000 orth=0.6600 favg=0.0000 nr=92 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=12.4960 mle=2.0292 pcon=9.8173 forget=0.0000 orth=0.6495 favg=0.0000 nr=97 nf=13 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=12.3556 mle=1.9004 pcon=9.8159 forget=0.0000 orth=0.6393 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=12.4256 mle=1.9817 pcon=9.8147 forget=0.0000 orth=0.6292 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=12.2968 mle=1.8635 pcon=9.8138 forget=0.0000 orth=0.6194 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=12.4318 mle=2.0097 pcon=9.8124 forget=0.0000 orth=0.6097 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.5145 mle=2.1035 pcon=9.8107 forget=0.0000 orth=0.6003 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=12.2948 mle=1.8942 pcon=9.8092 forget=0.0000 orth=0.5913 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 10 it 40 total=12.2352 mle=1.8451 pcon=9.8075 forget=0.0000 orth=0.5825 favg=0.0000 nr=109 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.6526 mle=2.2730 pcon=9.8055 forget=0.0000 orth=0.5741 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=12.3229 mle=1.9525 pcon=9.8044 forget=0.0000 orth=0.5659 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=12.3083 mle=1.9480 pcon=9.8021 forget=0.0000 orth=0.5581 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=12.1644 mle=1.8134 pcon=9.8002 forget=0.0000 orth=0.5508 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.6025 mle=2.2599 pcon=9.7988 forget=0.0000 orth=0.5438 favg=0.0000 nr=93 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=12.2841 mle=1.9496 pcon=9.7975 forget=0.0000 orth=0.5370 favg=0.0000 nr=100 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.5560 mle=2.2300 pcon=9.7954 forget=0.0000 orth=0.5307 favg=0.0000 nr=65 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 11 it 49 total=12.2547 mle=1.9364 pcon=9.7936 forget=0.0000 orth=0.5246 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.4809 mle=2.1709 pcon=9.7910 forget=0.0000 orth=0.5190 favg=0.0000 nr=93 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=12.4021 mle=2.0990 pcon=9.7894 forget=0.0000 orth=0.5137 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=12.2881 mle=1.9926 pcon=9.7868 forget=0.0000 orth=0.5087 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=12.0517 mle=1.7632 pcon=9.7845 forget=0.0000 orth=0.5040 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=12.3598 mle=2.0779 pcon=9.7823 forget=0.0000 orth=0.4996 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=12.1378 mle=1.8620 pcon=9.7802 forget=0.0000 orth=0.4956 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 12 it 8 total=12.3744 mle=2.1043 pcon=9.7782 forget=0.0000 orth=0.4919 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=12.2281 mle=1.9644 pcon=9.7753 forget=0.0000 orth=0.4884 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=12.3791 mle=2.1209 pcon=9.7731 forget=0.0000 orth=0.4852 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=12.2295 mle=1.9765 pcon=9.7708 forget=0.0000 orth=0.4823 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=12.1788 mle=1.9312 pcon=9.7681 forget=0.0000 orth=0.4796 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.4916 mle=2.2485 pcon=9.7660 forget=0.0000 orth=0.4771 favg=0.0000 nr=97 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=12.3580 mle=2.1190 pcon=9.7641 forget=0.0000 orth=0.4749 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=12.3315 mle=2.0961 pcon=9.7625 forget=0.0000 orth=0.4729 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
 93%|█████████▎| 14/15 [02:29<00:10, 10.12s/it]100%|██████████| 15/15 [02:39<00:00, 10.07s/it]100%|██████████| 15/15 [02:39<00:00, 10.64s/it]
[loss] ep 13 it 17 total=12.3794 mle=2.1481 pcon=9.7602 forget=0.0000 orth=0.4712 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=12.1448 mle=1.9171 pcon=9.7581 forget=0.0000 orth=0.4696 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.4406 mle=2.2161 pcon=9.7564 forget=0.0000 orth=0.4682 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=12.3386 mle=2.1184 pcon=9.7531 forget=0.0000 orth=0.4670 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.4020 mle=2.1846 pcon=9.7514 forget=0.0000 orth=0.4660 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=12.3718 mle=2.1572 pcon=9.7495 forget=0.0000 orth=0.4651 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=12.2621 mle=2.0503 pcon=9.7474 forget=0.0000 orth=0.4644 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=12.3092 mle=2.1008 pcon=9.7446 forget=0.0000 orth=0.4638 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 14 it 26 total=12.4721 mle=2.2657 pcon=9.7431 forget=0.0000 orth=0.4633 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=12.1597 mle=1.9554 pcon=9.7413 forget=0.0000 orth=0.4630 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=12.2529 mle=2.0509 pcon=9.7392 forget=0.0000 orth=0.4627 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=12.3691 mle=2.1701 pcon=9.7365 forget=0.0000 orth=0.4625 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=12.1246 mle=1.9277 pcon=9.7344 forget=0.0000 orth=0.4624 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=12.3581 mle=2.1637 pcon=9.7320 forget=0.0000 orth=0.4623 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=12.2470 mle=2.0535 pcon=9.7312 forget=0.0000 orth=0.4623 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=12.0793 mle=1.8876 pcon=9.7294 forget=0.0000 orth=0.4623 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e15-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:34,  1.82it/s]  3%|▎         | 11/391 [00:00<00:17, 21.71it/s]  5%|▌         | 21/391 [00:00<00:09, 38.49it/s]  8%|▊         | 31/391 [00:00<00:06, 52.45it/s] 10%|█         | 41/391 [00:00<00:05, 63.55it/s] 13%|█▎        | 51/391 [00:01<00:04, 71.76it/s] 16%|█▌        | 61/391 [00:01<00:04, 77.78it/s] 18%|█▊        | 70/391 [00:01<00:03, 80.38it/s] 20%|██        | 80/391 [00:01<00:03, 84.51it/s] 23%|██▎       | 90/391 [00:01<00:03, 87.56it/s] 26%|██▌       | 100/391 [00:01<00:03, 87.92it/s] 28%|██▊       | 110/391 [00:01<00:03, 89.70it/s] 31%|███       | 120/391 [00:01<00:02, 90.59it/s] 33%|███▎      | 130/391 [00:01<00:02, 91.15it/s] 36%|███▌      | 140/391 [00:02<00:02, 92.35it/s] 38%|███▊      | 150/391 [00:02<00:02, 92.53it/s] 41%|████      | 160/391 [00:02<00:02, 90.75it/s] 43%|████▎     | 170/391 [00:02<00:02, 92.12it/s] 46%|████▌     | 180/391 [00:02<00:02, 90.50it/s] 49%|████▊     | 190/391 [00:02<00:02, 90.53it/s] 51%|█████     | 200/391 [00:02<00:02, 91.56it/s] 54%|█████▎    | 210/391 [00:02<00:01, 92.17it/s] 56%|█████▋    | 220/391 [00:02<00:01, 92.73it/s] 59%|█████▉    | 230/391 [00:03<00:01, 92.20it/s] 61%|██████▏   | 240/391 [00:03<00:01, 92.54it/s] 64%|██████▍   | 250/391 [00:03<00:01, 91.85it/s] 66%|██████▋   | 260/391 [00:03<00:01, 92.13it/s] 69%|██████▉   | 270/391 [00:03<00:01, 92.82it/s] 72%|███████▏  | 280/391 [00:03<00:01, 92.58it/s] 74%|███████▍  | 290/391 [00:03<00:01, 92.59it/s] 77%|███████▋  | 300/391 [00:03<00:00, 93.20it/s] 79%|███████▉  | 310/391 [00:03<00:00, 93.55it/s] 82%|████████▏ | 320/391 [00:03<00:00, 93.49it/s] 84%|████████▍ | 330/391 [00:04<00:00, 88.26it/s] 87%|████████▋ | 339/391 [00:04<00:00, 80.94it/s] 89%|████████▉ | 349/391 [00:04<00:00, 84.25it/s] 92%|█████████▏| 359/391 [00:04<00:00, 86.30it/s] 94%|█████████▍| 369/391 [00:04<00:00, 88.14it/s] 97%|█████████▋| 379/391 [00:04<00:00, 90.57it/s] 99%|█████████▉| 389/391 [00:04<00:00, 92.28it/s]100%|██████████| 391/391 [00:04<00:00, 80.98it/s]
50000 images processed, 4.92699122428894 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:01,  1.27it/s] 11%|█▏        | 9/79 [00:00<00:05, 13.12it/s] 20%|██        | 16/79 [00:01<00:02, 22.56it/s] 30%|███       | 24/79 [00:01<00:01, 33.90it/s] 43%|████▎     | 34/79 [00:01<00:00, 47.69it/s] 54%|█████▍    | 43/79 [00:01<00:00, 55.66it/s] 66%|██████▌   | 52/79 [00:01<00:00, 62.53it/s] 78%|███████▊  | 62/79 [00:01<00:00, 71.45it/s] 91%|█████████ | 72/79 [00:01<00:00, 78.21it/s]100%|██████████| 79/79 [00:01<00:00, 43.53it/s]
10000 images processed, 1.8699772357940674 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:33,  1.32it/s]  5%|▌         | 11/204 [00:00<00:11, 16.78it/s] 10%|█         | 21/204 [00:00<00:05, 31.48it/s] 15%|█▌        | 31/204 [00:01<00:03, 44.70it/s] 20%|██        | 41/204 [00:01<00:02, 56.00it/s] 25%|██▌       | 51/204 [00:01<00:02, 65.44it/s] 30%|██▉       | 61/204 [00:01<00:01, 72.36it/s] 35%|███▍      | 71/204 [00:01<00:01, 78.21it/s] 40%|███▉      | 81/204 [00:01<00:01, 82.64it/s] 45%|████▍     | 91/204 [00:01<00:01, 85.66it/s] 50%|████▉     | 101/204 [00:01<00:01, 88.16it/s] 54%|█████▍    | 111/204 [00:01<00:01, 89.31it/s] 59%|█████▉    | 121/204 [00:02<00:00, 89.40it/s] 64%|██████▍   | 131/204 [00:02<00:00, 89.97it/s] 69%|██████▉   | 141/204 [00:02<00:00, 90.87it/s] 74%|███████▍  | 151/204 [00:02<00:00, 91.77it/s] 79%|███████▉  | 161/204 [00:02<00:00, 92.27it/s] 84%|████████▍ | 171/204 [00:02<00:00, 92.64it/s] 89%|████████▊ | 181/204 [00:02<00:00, 93.43it/s] 94%|█████████▎| 191/204 [00:02<00:00, 94.19it/s] 99%|█████████▊| 201/204 [00:02<00:00, 94.68it/s]100%|██████████| 204/204 [00:02<00:00, 69.32it/s]
26032 images processed, 3.0008058547973633 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:13,  1.06it/s] 13%|█▎        | 10/79 [00:01<00:05, 12.69it/s] 25%|██▌       | 20/79 [00:01<00:02, 26.16it/s] 38%|███▊      | 30/79 [00:01<00:01, 39.14it/s] 51%|█████     | 40/79 [00:01<00:00, 51.02it/s] 63%|██████▎   | 50/79 [00:01<00:00, 61.15it/s] 76%|███████▌  | 60/79 [00:01<00:00, 69.64it/s] 89%|████████▊ | 70/79 [00:01<00:00, 76.51it/s]100%|██████████| 79/79 [00:01<00:00, 44.65it/s]
10000 images processed, 1.805988073348999 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:51,  1.52it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.86it/s] 27%|██▋       | 21/79 [00:00<00:01, 34.83it/s] 39%|███▉      | 31/79 [00:00<00:00, 48.73it/s] 52%|█████▏    | 41/79 [00:01<00:00, 60.25it/s] 63%|██████▎   | 50/79 [00:01<00:00, 63.77it/s] 75%|███████▍  | 59/79 [00:01<00:00, 62.33it/s] 87%|████████▋ | 69/79 [00:01<00:00, 70.90it/s]100%|██████████| 79/79 [00:01<00:00, 50.81it/s]
10000 images processed, 1.575155258178711 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:50,  1.36it/s] 13%|█▎        | 9/70 [00:00<00:04, 14.06it/s] 26%|██▌       | 18/70 [00:00<00:01, 28.22it/s] 39%|███▊      | 27/70 [00:01<00:01, 40.60it/s] 53%|█████▎    | 37/70 [00:01<00:00, 53.46it/s] 67%|██████▋   | 47/70 [00:01<00:00, 64.15it/s] 81%|████████▏ | 57/70 [00:01<00:00, 72.63it/s] 96%|█████████▌| 67/70 [00:01<00:00, 79.09it/s]100%|██████████| 70/70 [00:01<00:00, 46.56it/s]
8925 images processed, 1.5351219177246094 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:56,  1.28s/it]  4%|▍         | 2/45 [00:01<00:26,  1.62it/s] 13%|█▎        | 6/45 [00:01<00:06,  6.10it/s] 36%|███▌      | 16/45 [00:01<00:01, 19.41it/s] 47%|████▋     | 21/45 [00:02<00:01, 16.07it/s] 56%|█████▌    | 25/45 [00:02<00:01, 15.62it/s] 73%|███████▎  | 33/45 [00:02<00:00, 21.18it/s] 82%|████████▏ | 37/45 [00:02<00:00, 21.26it/s] 93%|█████████▎| 42/45 [00:02<00:00, 22.70it/s]100%|██████████| 45/45 [00:02<00:00, 15.19it/s]
5640 images processed, 2.980623960494995 seconds used

19.689220905303955
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.58  99.24  91.30
places365     75.20  80.55  50.02
LSUN          33.82  94.13  84.67
iSUN          54.46  88.78  74.33
dtd           30.27  92.84  83.35
AVG           39.47  91.11  76.74
[incremental] Overall: 0.6190 New: 0.6220 Old: 0.6180
[incremental] Final(Top-1): 0.6190  Average: 0.7214
6.196797847747803
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.90it/s] 14%|█▍        | 11/79 [00:00<00:03, 22.57it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.03it/s] 39%|███▉      | 31/79 [00:00<00:00, 53.85it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.48it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.09it/s] 77%|███████▋  | 61/79 [00:01<00:00, 79.66it/s] 90%|████████▉ | 71/79 [00:01<00:00, 84.53it/s]100%|██████████| 79/79 [00:01<00:00, 59.04it/s]
10000 images processed, 1.3577682971954346 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:42,  1.63it/s] 16%|█▌        | 11/70 [00:00<00:02, 19.88it/s] 30%|███       | 21/70 [00:00<00:01, 35.94it/s] 43%|████▎     | 30/70 [00:00<00:00, 46.56it/s] 54%|█████▍    | 38/70 [00:01<00:00, 46.81it/s] 69%|██████▊   | 48/70 [00:01<00:00, 58.36it/s] 83%|████████▎ | 58/70 [00:01<00:00, 67.92it/s] 97%|█████████▋| 68/70 [00:01<00:00, 75.51it/s]100%|██████████| 70/70 [00:01<00:00, 48.21it/s]
8925 images processed, 1.4805314540863037 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:43,  1.00it/s]  4%|▍         | 2/45 [00:01<00:20,  2.07it/s] 16%|█▌        | 7/45 [00:01<00:04,  8.42it/s] 36%|███▌      | 16/45 [00:01<00:01, 21.48it/s] 47%|████▋     | 21/45 [00:01<00:01, 18.51it/s] 56%|█████▌    | 25/45 [00:02<00:01, 16.76it/s] 73%|███████▎  | 33/45 [00:02<00:00, 25.12it/s] 87%|████████▋ | 39/45 [00:02<00:00, 20.63it/s]100%|██████████| 45/45 [00:02<00:00, 17.22it/s]
5640 images processed, 2.6393067836761475 seconds used

18.554006099700928
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.58  99.24  91.30
places365     75.20  80.55  50.02
LSUN          33.82  94.13  84.67
iSUN          54.46  88.78  74.33
dtd           30.27  92.84  83.35
AVG           39.47  91.11  76.74
[incremental] Overall: 0.6190 New: 0.6220 Old: 0.6180
[incremental] Final(Top-1): 0.6190  Average: 0.7214
4.184012174606323
[DEBUG] Parsed: avg_fpr=39.47 avg_auroc=91.11 final_top1=0.6190 average=0.7214
[Result] AVG-AUROC=91.11 AVG-FPR=39.47 Final-Top1=0.6190 Average=0.7214 Score=71.42

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=20 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=20, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/20 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  5%|▌         | 1/20 [00:17<05:38, 17.80s/it] 10%|█         | 2/20 [00:25<03:37, 12.08s/it] 15%|█▌        | 3/20 [00:33<02:50, 10.03s/it] 20%|██        | 4/20 [00:41<02:28,  9.30s/it] 25%|██▌       | 5/20 [00:49<02:13,  8.88s/it] 30%|███       | 6/20 [00:57<02:00,  8.63s/it][loss] ep 0 it 0 total=8.5895 mle=3.2130 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6441 mle=3.2647 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0878 mle=3.7057 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6783 mle=3.2935 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9792 mle=2.5920 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9918 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4733 mle=4.0810 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4955 mle=3.1007 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5369 mle=3.1399 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2412 mle=2.8416 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7242 mle=3.3223 pcon=5.4019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0962 mle=3.6917 pcon=5.4045 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4460 mle=4.0388 pcon=5.4072 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3582 mle=2.9488 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0700 mle=3.6581 pcon=5.4119 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5544 mle=3.1403 pcon=5.4141 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5078 mle=3.0909 pcon=5.4169 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6320 mle=3.2131 pcon=5.4189 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2432 mle=2.8212 pcon=5.4220 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4328 mle=3.0084 pcon=5.4244 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7375 mle=2.3105 pcon=5.4269 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6785 mle=3.2491 pcon=5.4293 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8374 mle=3.4055 pcon=5.4319 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7150 mle=2.2805 pcon=5.4345 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.2999 mle=2.8637 pcon=5.4362 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4256 mle=2.9875 pcon=5.4381 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1014 mle=2.6615 pcon=5.4399 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9325 mle=2.4909 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6431 mle=2.2004 pcon=5.4427 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6507 mle=2.2065 pcon=5.4442 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6232 mle=2.1785 pcon=5.4447 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6687 mle=2.2232 pcon=5.4455 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6919 mle=2.2452 pcon=5.4467 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6984 mle=2.2506 pcon=5.4478 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7880 mle=2.3396 pcon=5.4484 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4444 mle=1.9941 pcon=5.4503 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4890 mle=2.0370 pcon=5.4521 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4847 mle=2.0300 pcon=5.4547 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9107 mle=2.4539 pcon=5.4568 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4957 mle=2.0364 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 5 it 45 total=7.5990 mle=2.1381 pcon=5.4609 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.5305 mle=2.0673 pcon=5.4632 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.5470 mle=2.0819 pcon=5.4651 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.6396 mle=2.1721 pcon=5.4675 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.6794 mle=2.2099 pcon=5.4695 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.3912 mle=1.9188 pcon=5.4724 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7724 mle=2.2973 pcon=5.4751 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 6 it 4 total=7.6267 mle=2.1492 pcon=5.4775 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.7450 mle=2.2646 pcon=5.4803 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.5334 mle=2.0506 pcon=5.4828 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.3494 mle=1.8648 pcon=5.4846 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.5079 mle=2.0201 pcon=5.4878 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
 35%|███▌      | 7/20 [01:06<01:49,  8.45s/it] 40%|████      | 8/20 [01:13<01:38,  8.21s/it] 45%|████▌     | 9/20 [01:21<01:28,  8.09s/it] 50%|█████     | 10/20 [01:29<01:21,  8.15s/it] 55%|█████▌    | 11/20 [01:38<01:13,  8.19s/it] 60%|██████    | 12/20 [01:46<01:05,  8.18s/it] 65%|██████▌   | 13/20 [01:54<00:57,  8.19s/it] 70%|███████   | 14/20 [02:02<00:49,  8.18s/it][loss] ep 6 it 254 total=7.5029 mle=2.0120 pcon=5.4908 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.9122 mle=2.4183 pcon=5.4939 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.4513 mle=1.9541 pcon=5.4972 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 13 total=7.7897 mle=2.2890 pcon=5.5007 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.9125 mle=2.4083 pcon=5.5042 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.7382 mle=2.2306 pcon=5.5076 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.8008 mle=2.2896 pcon=5.5112 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.5630 mle=2.0488 pcon=5.5142 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.6842 mle=2.1657 pcon=5.5185 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.5468 mle=2.0250 pcon=5.5218 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.6892 mle=2.1634 pcon=5.5258 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 22 total=7.6968 mle=2.1675 pcon=5.5293 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.5196 mle=1.9873 pcon=5.5323 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.3987 mle=1.8633 pcon=5.5354 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=7.3098 mle=1.7706 pcon=5.5392 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=7.3353 mle=1.7921 pcon=5.5431 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.5150 mle=1.9685 pcon=5.5465 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=7.5381 mle=1.9883 pcon=5.5499 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=7.7813 mle=2.2277 pcon=5.5536 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 31 total=7.9270 mle=2.3705 pcon=5.5565 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=7.6421 mle=2.0821 pcon=5.5600 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=7.4834 mle=1.9206 pcon=5.5628 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=7.6007 mle=2.0348 pcon=5.5659 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=7.5366 mle=1.9670 pcon=5.5695 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=7.5923 mle=2.0192 pcon=5.5731 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=7.6972 mle=2.1211 pcon=5.5761 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=7.5190 mle=1.9397 pcon=5.5793 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 40 total=7.4384 mle=1.8566 pcon=5.5818 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=7.9047 mle=2.3206 pcon=5.5841 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=7.5868 mle=1.9997 pcon=5.5870 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=7.5868 mle=1.9969 pcon=5.5899 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=7.4324 mle=1.8402 pcon=5.5922 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=7.8544 mle=2.2591 pcon=5.5953 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=7.5763 mle=1.9788 pcon=5.5975 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=7.8367 mle=2.2362 pcon=5.6005 forget=0.0000 orth=0.0000 favg=0.0000 nr=77 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 49 total=7.5663 mle=1.9626 pcon=5.6037 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=7.9002 mle=2.2936 pcon=5.6066 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=7.7699 mle=2.1605 pcon=5.6094 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=7.6113 mle=1.9988 pcon=5.6125 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=7.4140 mle=1.7983 pcon=5.6157 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=7.7316 mle=2.1134 pcon=5.6182 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=7.4544 mle=1.8340 pcon=5.6205 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 8 total=7.8478 mle=2.2248 pcon=5.6230 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=7.6102 mle=1.9849 pcon=5.6253 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=7.8282 mle=2.2001 pcon=5.6281 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=7.5994 mle=1.9685 pcon=5.6310 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=7.6267 mle=1.9933 pcon=5.6334 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=7.9023 mle=2.2662 pcon=5.6361 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=7.7431 mle=2.1049 pcon=5.6381 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=7.7911 mle=2.1503 pcon=5.6407 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 17 total=7.8743 mle=2.2311 pcon=5.6432 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=7.6748 mle=2.0292 pcon=5.6457 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=7.9270 mle=2.2796 pcon=5.6474 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=7.7543 mle=2.1050 pcon=5.6493 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=7.9485 mle=2.2979 pcon=5.6506 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=7.8505 mle=2.1977 pcon=5.6528 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=7.7406 mle=2.0856 pcon=5.6549 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=7.7608 mle=2.1033 pcon=5.6575 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 26 total=7.9680 mle=2.3088 pcon=5.6592 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=7.7031 mle=2.0423 pcon=5.6608 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=7.7293 mle=2.0671 pcon=5.6622 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=7.8699 mle=2.2063 pcon=5.6636 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
 75%|███████▌  | 15/20 [02:11<00:41,  8.32s/it] 80%|████████  | 16/20 [02:19<00:33,  8.33s/it] 85%|████████▌ | 17/20 [02:27<00:24,  8.20s/it] 90%|█████████ | 18/20 [02:35<00:16,  8.26s/it] 95%|█████████▌| 19/20 [02:44<00:08,  8.32s/it]100%|██████████| 20/20 [02:52<00:00,  8.40s/it]100%|██████████| 20/20 [02:52<00:00,  8.65s/it]
[loss] ep 14 it 226 total=7.6137 mle=1.9482 pcon=5.6655 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=7.8326 mle=2.1650 pcon=5.6676 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=7.7784 mle=2.1092 pcon=5.6692 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=7.5929 mle=1.9220 pcon=5.6709 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 15 it 35 total=7.8075 mle=2.1348 pcon=5.6727 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=7.7889 mle=2.1142 pcon=5.6748 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=7.6465 mle=1.9702 pcon=5.6763 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=7.6482 mle=1.9708 pcon=5.6774 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=7.8576 mle=2.1793 pcon=5.6784 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=7.7285 mle=2.0486 pcon=5.6799 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=7.9106 mle=2.2295 pcon=5.6811 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=7.6819 mle=1.9993 pcon=5.6826 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 44 total=7.8883 mle=2.2046 pcon=5.6837 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=7.8322 mle=2.1469 pcon=5.6853 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=7.7451 mle=2.0588 pcon=5.6863 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=7.7436 mle=2.0562 pcon=5.6875 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=7.6710 mle=1.9822 pcon=5.6888 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=7.5898 mle=1.9001 pcon=5.6898 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=7.7566 mle=2.0663 pcon=5.6902 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 3 total=7.4753 mle=1.7837 pcon=5.6916 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=7.5459 mle=1.8531 pcon=5.6928 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=7.7351 mle=2.0412 pcon=5.6939 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=7.5288 mle=1.8336 pcon=5.6952 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=7.6463 mle=1.9500 pcon=5.6963 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=7.7632 mle=2.0665 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=7.6431 mle=1.9458 pcon=5.6973 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=7.6536 mle=1.9554 pcon=5.6982 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 12 total=7.6887 mle=1.9898 pcon=5.6989 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=7.9841 mle=2.2849 pcon=5.6992 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=7.6407 mle=1.9408 pcon=5.6998 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=7.7844 mle=2.0839 pcon=5.7005 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=7.8656 mle=2.1646 pcon=5.7010 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=7.7002 mle=1.9989 pcon=5.7014 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=7.6300 mle=1.9279 pcon=5.7022 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=7.5094 mle=1.8068 pcon=5.7025 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 21 total=7.6858 mle=1.9827 pcon=5.7031 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=7.7596 mle=2.0558 pcon=5.7038 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=7.6648 mle=1.9610 pcon=5.7039 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=7.7524 mle=2.0479 pcon=5.7045 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=7.7664 mle=2.0612 pcon=5.7052 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=7.9516 mle=2.2460 pcon=5.7056 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=7.8701 mle=2.1638 pcon=5.7064 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=7.7666 mle=2.0599 pcon=5.7067 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:08,  2.07it/s]  3%|▎         | 11/391 [00:00<00:15, 24.04it/s]  5%|▌         | 21/391 [00:00<00:08, 41.85it/s]  8%|▊         | 31/391 [00:00<00:06, 55.61it/s] 10%|█         | 41/391 [00:00<00:05, 66.15it/s] 13%|█▎        | 51/391 [00:01<00:04, 74.21it/s] 16%|█▌        | 61/391 [00:01<00:04, 80.09it/s] 18%|█▊        | 71/391 [00:01<00:03, 84.52it/s] 21%|██        | 81/391 [00:01<00:03, 85.79it/s] 23%|██▎       | 91/391 [00:01<00:03, 87.69it/s] 26%|██▌       | 101/391 [00:01<00:03, 89.97it/s] 28%|██▊       | 111/391 [00:01<00:03, 91.70it/s] 31%|███       | 121/391 [00:01<00:02, 92.86it/s] 34%|███▎      | 131/391 [00:01<00:02, 93.80it/s] 36%|███▌      | 141/391 [00:01<00:02, 94.23it/s] 39%|███▊      | 151/391 [00:02<00:02, 94.63it/s] 41%|████      | 161/391 [00:02<00:02, 94.83it/s] 44%|████▎     | 171/391 [00:02<00:02, 95.16it/s] 46%|████▋     | 181/391 [00:02<00:02, 95.10it/s] 49%|████▉     | 191/391 [00:02<00:02, 95.36it/s] 51%|█████▏    | 201/391 [00:02<00:01, 95.06it/s] 54%|█████▍    | 211/391 [00:02<00:01, 94.51it/s] 57%|█████▋    | 221/391 [00:02<00:01, 92.56it/s] 59%|█████▉    | 231/391 [00:02<00:01, 80.26it/s] 61%|██████▏   | 240/391 [00:03<00:01, 78.54it/s] 64%|██████▎   | 249/391 [00:03<00:01, 80.55it/s] 66%|██████▌   | 258/391 [00:03<00:01, 75.29it/s] 69%|██████▊   | 268/391 [00:03<00:01, 80.78it/s] 71%|███████   | 278/391 [00:03<00:01, 84.46it/s] 74%|███████▎  | 288/391 [00:03<00:01, 87.28it/s] 76%|███████▌  | 298/391 [00:03<00:01, 88.91it/s] 79%|███████▉  | 308/391 [00:03<00:00, 90.87it/s] 81%|████████▏ | 318/391 [00:03<00:00, 92.41it/s] 84%|████████▍ | 328/391 [00:04<00:00, 92.71it/s] 86%|████████▋ | 338/391 [00:04<00:00, 71.59it/s] 88%|████████▊ | 346/391 [00:04<00:00, 70.49it/s] 91%|█████████ | 356/391 [00:04<00:00, 75.99it/s] 93%|█████████▎| 365/391 [00:04<00:00, 79.54it/s] 96%|█████████▌| 375/391 [00:04<00:00, 84.44it/s] 98%|█████████▊| 385/391 [00:04<00:00, 87.80it/s]100%|██████████| 391/391 [00:04<00:00, 79.34it/s]
50000 images processed, 5.03648567199707 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:01<01:23,  1.07s/it] 13%|█▎        | 10/79 [00:01<00:06, 11.30it/s] 25%|██▌       | 20/79 [00:01<00:02, 23.72it/s] 34%|███▍      | 27/79 [00:01<00:01, 30.28it/s] 46%|████▌     | 36/79 [00:01<00:01, 41.14it/s] 58%|█████▊    | 46/79 [00:01<00:00, 52.80it/s] 71%|███████   | 56/79 [00:01<00:00, 63.03it/s] 84%|████████▎ | 66/79 [00:01<00:00, 71.51it/s] 96%|█████████▌| 76/79 [00:01<00:00, 78.25it/s]100%|██████████| 79/79 [00:01<00:00, 40.08it/s]
10000 images processed, 1.9924399852752686 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:44,  1.24it/s]  5%|▍         | 10/204 [00:00<00:13, 14.47it/s] 10%|▉         | 20/204 [00:01<00:06, 29.22it/s] 15%|█▍        | 30/204 [00:01<00:04, 42.62it/s] 20%|█▉        | 40/204 [00:01<00:03, 54.03it/s] 25%|██▍       | 50/204 [00:01<00:02, 63.65it/s] 29%|██▉       | 60/204 [00:01<00:02, 71.64it/s] 34%|███▍      | 70/204 [00:01<00:01, 77.88it/s] 39%|███▉      | 80/204 [00:01<00:01, 82.55it/s] 44%|████▍     | 90/204 [00:01<00:01, 83.51it/s] 49%|████▉     | 100/204 [00:01<00:01, 86.56it/s] 54%|█████▍    | 110/204 [00:01<00:01, 87.94it/s] 59%|█████▉    | 120/204 [00:02<00:00, 89.58it/s] 64%|██████▎   | 130/204 [00:02<00:00, 89.86it/s] 69%|██████▊   | 140/204 [00:02<00:00, 91.36it/s] 74%|███████▎  | 150/204 [00:02<00:00, 92.24it/s] 78%|███████▊  | 160/204 [00:02<00:00, 89.97it/s] 83%|████████▎ | 170/204 [00:02<00:00, 85.36it/s] 88%|████████▊ | 179/204 [00:02<00:00, 82.72it/s] 92%|█████████▏| 188/204 [00:02<00:00, 82.91it/s] 97%|█████████▋| 198/204 [00:03<00:00, 85.98it/s]100%|██████████| 204/204 [00:03<00:00, 65.91it/s]
26032 images processed, 3.220759630203247 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:05,  1.19it/s]  8%|▊         | 6/79 [00:00<00:08,  8.16it/s] 20%|██        | 16/79 [00:01<00:02, 23.46it/s] 28%|██▊       | 22/79 [00:01<00:02, 27.34it/s] 41%|████      | 32/79 [00:01<00:01, 41.04it/s] 53%|█████▎    | 42/79 [00:01<00:00, 53.22it/s] 66%|██████▌   | 52/79 [00:01<00:00, 62.95it/s] 77%|███████▋  | 61/79 [00:01<00:00, 68.11it/s] 90%|████████▉ | 71/79 [00:01<00:00, 75.71it/s]100%|██████████| 79/79 [00:01<00:00, 43.19it/s]
10000 images processed, 1.8480703830718994 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.74it/s] 13%|█▎        | 10/79 [00:00<00:03, 18.28it/s] 22%|██▏       | 17/79 [00:00<00:02, 28.59it/s] 34%|███▍      | 27/79 [00:00<00:01, 44.27it/s] 47%|████▋     | 37/79 [00:01<00:00, 57.01it/s] 58%|█████▊    | 46/79 [00:01<00:00, 65.28it/s] 70%|██████▉   | 55/79 [00:01<00:00, 70.33it/s] 81%|████████  | 64/79 [00:01<00:00, 70.90it/s] 91%|█████████ | 72/79 [00:01<00:00, 69.59it/s]100%|██████████| 79/79 [00:01<00:00, 50.87it/s]
10000 images processed, 1.5810132026672363 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:37,  1.84it/s] 13%|█▎        | 9/70 [00:00<00:03, 17.69it/s] 26%|██▌       | 18/70 [00:00<00:01, 33.51it/s] 40%|████      | 28/70 [00:00<00:00, 48.72it/s] 54%|█████▍    | 38/70 [00:00<00:00, 60.72it/s] 69%|██████▊   | 48/70 [00:01<00:00, 70.43it/s] 83%|████████▎ | 58/70 [00:01<00:00, 77.73it/s] 97%|█████████▋| 68/70 [00:01<00:00, 83.17it/s]100%|██████████| 70/70 [00:01<00:00, 53.50it/s]
8925 images processed, 1.3366479873657227 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:57,  1.31s/it]  4%|▍         | 2/45 [00:01<00:28,  1.49it/s] 27%|██▋       | 12/45 [00:01<00:02, 12.39it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.10it/s] 47%|████▋     | 21/45 [00:02<00:01, 13.73it/s] 67%|██████▋   | 30/45 [00:02<00:00, 23.45it/s] 78%|███████▊  | 35/45 [00:02<00:00, 19.88it/s] 87%|████████▋ | 39/45 [00:02<00:00, 22.64it/s] 96%|█████████▌| 43/45 [00:03<00:00, 20.20it/s]100%|██████████| 45/45 [00:03<00:00, 14.74it/s]
5640 images processed, 3.0799241065979004 seconds used

20.085233688354492
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.60
places365     49.95  89.49  51.36
LSUN          25.94  95.19  76.04
iSUN          26.01  95.03  73.73
dtd           24.68  94.43  71.73
AVG           26.03  94.63  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
3.644185781478882
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=20, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/20 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  5%|▌         | 1/20 [00:20<06:30, 20.56s/it] 10%|█         | 2/20 [00:32<04:35, 15.32s/it] 15%|█▌        | 3/20 [00:43<03:48, 13.44s/it] 20%|██        | 4/20 [00:54<03:23, 12.70s/it] 25%|██▌       | 5/20 [01:05<02:59, 11.99s/it] 30%|███       | 6/20 [01:17<02:45, 11.84s/it][loss] ep 0 it 0 total=12.0910 mle=2.3147 pcon=8.7277 forget=0.0000 orth=1.0486 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0665 mle=2.2861 pcon=8.7318 forget=0.0000 orth=1.0485 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2135 mle=2.4298 pcon=8.7353 forget=0.0000 orth=1.0484 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1216 mle=2.3346 pcon=8.7388 forget=0.0000 orth=1.0482 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7748 mle=1.9851 pcon=8.7417 forget=0.0000 orth=1.0480 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=11.9870 mle=2.1950 pcon=8.7444 forget=0.0000 orth=1.0477 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4181 mle=2.6241 pcon=8.7466 forget=0.0000 orth=1.0474 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9926 mle=2.1972 pcon=8.7482 forget=0.0000 orth=1.0471 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9501 mle=2.1530 pcon=8.7504 forget=0.0000 orth=1.0467 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9380 mle=2.1394 pcon=8.7523 forget=0.0000 orth=1.0463 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0894 mle=2.2896 pcon=8.7539 forget=0.0000 orth=1.0459 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3273 mle=2.5262 pcon=8.7556 forget=0.0000 orth=1.0454 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2574 mle=2.4557 pcon=8.7567 forget=0.0000 orth=1.0450 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.8904 mle=2.0880 pcon=8.7580 forget=0.0000 orth=1.0445 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.1923 mle=2.3892 pcon=8.7592 forget=0.0000 orth=1.0439 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0808 mle=2.2773 pcon=8.7603 forget=0.0000 orth=1.0433 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0150 mle=2.2114 pcon=8.7610 forget=0.0000 orth=1.0425 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0751 mle=2.2712 pcon=8.7622 forget=0.0000 orth=1.0418 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9125 mle=2.1078 pcon=8.7636 forget=0.0000 orth=1.0411 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9620 mle=2.1570 pcon=8.7647 forget=0.0000 orth=1.0403 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5836 mle=1.7781 pcon=8.7659 forget=0.0000 orth=1.0396 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1268 mle=2.3214 pcon=8.7666 forget=0.0000 orth=1.0388 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1814 mle=2.3761 pcon=8.7674 forget=0.0000 orth=1.0379 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6931 mle=1.8874 pcon=8.7687 forget=0.0000 orth=1.0370 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0741 mle=2.2689 pcon=8.7692 forget=0.0000 orth=1.0360 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1938 mle=2.3887 pcon=8.7702 forget=0.0000 orth=1.0349 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1311 mle=2.3261 pcon=8.7711 forget=0.0000 orth=1.0339 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0206 mle=2.2156 pcon=8.7722 forget=0.0000 orth=1.0329 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9359 mle=2.1307 pcon=8.7734 forget=0.0000 orth=1.0318 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9651 mle=2.1600 pcon=8.7744 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9501 mle=2.1455 pcon=8.7753 forget=0.0000 orth=1.0293 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.0058 mle=2.2018 pcon=8.7759 forget=0.0000 orth=1.0281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0139 mle=2.2096 pcon=8.7775 forget=0.0000 orth=1.0268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0259 mle=2.2215 pcon=8.7786 forget=0.0000 orth=1.0259 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1450 mle=2.3408 pcon=8.7796 forget=0.0000 orth=1.0247 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8308 mle=2.0270 pcon=8.7803 forget=0.0000 orth=1.0234 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8794 mle=2.0764 pcon=8.7811 forget=0.0000 orth=1.0219 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8368 mle=2.0336 pcon=8.7827 forget=0.0000 orth=1.0206 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1788 mle=2.3755 pcon=8.7836 forget=0.0000 orth=1.0196 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.8035 mle=2.0003 pcon=8.7849 forget=0.0000 orth=1.0184 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 5 it 45 total=11.9765 mle=2.1739 pcon=8.7855 forget=0.0000 orth=1.0170 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=11.8750 mle=2.0727 pcon=8.7869 forget=0.0000 orth=1.0154 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=11.9058 mle=2.1041 pcon=8.7876 forget=0.0000 orth=1.0142 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=11.9913 mle=2.1896 pcon=8.7890 forget=0.0000 orth=1.0127 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.0463 mle=2.2447 pcon=8.7902 forget=0.0000 orth=1.0114 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=11.7280 mle=1.9259 pcon=8.7922 forget=0.0000 orth=1.0100 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.1238 mle=2.3214 pcon=8.7938 forget=0.0000 orth=1.0086 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 6 it 4 total=11.9789 mle=2.1771 pcon=8.7945 forget=0.0000 orth=1.0074 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.0673 mle=2.2650 pcon=8.7962 forget=0.0000 orth=1.0061 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.8458 mle=2.0432 pcon=8.7980 forget=0.0000 orth=1.0046 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.6712 mle=1.8692 pcon=8.7988 forget=0.0000 orth=1.0032 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
 35%|███▌      | 7/20 [01:28<02:31, 11.65s/it] 40%|████      | 8/20 [01:39<02:17, 11.46s/it] 45%|████▌     | 9/20 [01:50<02:03, 11.21s/it] 50%|█████     | 10/20 [02:01<01:52, 11.23s/it] 55%|█████▌    | 11/20 [02:12<01:41, 11.23s/it] 60%|██████    | 12/20 [02:24<01:30, 11.25s/it][loss] ep 6 it 204 total=11.8448 mle=2.0433 pcon=8.7998 forget=0.0000 orth=1.0016 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.8539 mle=2.0527 pcon=8.8009 forget=0.0000 orth=1.0003 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2115 mle=2.4098 pcon=8.8026 forget=0.0000 orth=0.9991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.7712 mle=1.9695 pcon=8.8040 forget=0.0000 orth=0.9977 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 7 it 13 total=12.1377 mle=2.3355 pcon=8.8057 forget=0.0000 orth=0.9965 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2207 mle=2.4182 pcon=8.8073 forget=0.0000 orth=0.9952 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0892 mle=2.2866 pcon=8.8088 forget=0.0000 orth=0.9937 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1136 mle=2.3103 pcon=8.8109 forget=0.0000 orth=0.9924 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9125 mle=2.1099 pcon=8.8115 forget=0.0000 orth=0.9911 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9890 mle=2.1855 pcon=8.8138 forget=0.0000 orth=0.9898 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8659 mle=2.0619 pcon=8.8155 forget=0.0000 orth=0.9885 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0133 mle=2.2089 pcon=8.8174 forget=0.0000 orth=0.9870 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 8 it 22 total=11.9795 mle=2.1751 pcon=8.8184 forget=0.0000 orth=0.9860 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8129 mle=2.0086 pcon=8.8198 forget=0.0000 orth=0.9845 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7030 mle=1.8988 pcon=8.8211 forget=0.0000 orth=0.9831 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5991 mle=1.7946 pcon=8.8227 forget=0.0000 orth=0.9818 favg=0.0000 nr=124 nf=1 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6305 mle=1.8259 pcon=8.8243 forget=0.0000 orth=0.9803 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.7920 mle=1.9879 pcon=8.8251 forget=0.0000 orth=0.9791 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8224 mle=2.0181 pcon=8.8266 forget=0.0000 orth=0.9777 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0350 mle=2.2300 pcon=8.8287 forget=0.0000 orth=0.9763 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 9 it 31 total=12.1878 mle=2.3828 pcon=8.8302 forget=0.0000 orth=0.9748 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9306 mle=2.1260 pcon=8.8310 forget=0.0000 orth=0.9736 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7378 mle=1.9341 pcon=8.8318 forget=0.0000 orth=0.9719 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8461 mle=2.0426 pcon=8.8326 forget=0.0000 orth=0.9709 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7755 mle=1.9711 pcon=8.8353 forget=0.0000 orth=0.9691 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8324 mle=2.0281 pcon=8.8369 forget=0.0000 orth=0.9674 favg=0.0000 nr=122 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9328 mle=2.1282 pcon=8.8389 forget=0.0000 orth=0.9656 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7590 mle=1.9543 pcon=8.8405 forget=0.0000 orth=0.9642 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 10 it 40 total=11.6747 mle=1.8698 pcon=8.8422 forget=0.0000 orth=0.9627 favg=0.0000 nr=123 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.1516 mle=2.3475 pcon=8.8430 forget=0.0000 orth=0.9611 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.8342 mle=2.0299 pcon=8.8450 forget=0.0000 orth=0.9593 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.8001 mle=1.9960 pcon=8.8467 forget=0.0000 orth=0.9574 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6463 mle=1.8433 pcon=8.8472 forget=0.0000 orth=0.9559 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0890 mle=2.2858 pcon=8.8495 forget=0.0000 orth=0.9538 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.7923 mle=1.9905 pcon=8.8501 forget=0.0000 orth=0.9518 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.0294 mle=2.2286 pcon=8.8512 forget=0.0000 orth=0.9497 favg=0.0000 nr=74 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 11 it 49 total=11.7761 mle=1.9755 pcon=8.8530 forget=0.0000 orth=0.9475 favg=0.0000 nr=117 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.0831 mle=2.2833 pcon=8.8542 forget=0.0000 orth=0.9456 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.9663 mle=2.1681 pcon=8.8549 forget=0.0000 orth=0.9433 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.8138 mle=2.0167 pcon=8.8560 forget=0.0000 orth=0.9411 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.6024 mle=1.8063 pcon=8.8573 forget=0.0000 orth=0.9388 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.9113 mle=2.1169 pcon=8.8581 forget=0.0000 orth=0.9363 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.6441 mle=1.8509 pcon=8.8594 forget=0.0000 orth=0.9338 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 12 it 8 total=11.9902 mle=2.1978 pcon=8.8609 forget=0.0000 orth=0.9314 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.7816 mle=1.9915 pcon=8.8616 forget=0.0000 orth=0.9285 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.9829 mle=2.1945 pcon=8.8626 forget=0.0000 orth=0.9258 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.7530 mle=1.9664 pcon=8.8636 forget=0.0000 orth=0.9230 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.7829 mle=1.9983 pcon=8.8647 forget=0.0000 orth=0.9199 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.0723 mle=2.2891 pcon=8.8663 forget=0.0000 orth=0.9169 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8827 mle=2.1024 pcon=8.8666 forget=0.0000 orth=0.9138 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9433 mle=2.1647 pcon=8.8679 forget=0.0000 orth=0.9107 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
 65%|██████▌   | 13/20 [02:35<01:19, 11.38s/it] 70%|███████   | 14/20 [02:48<01:10, 11.75s/it] 75%|███████▌  | 15/20 [03:00<00:59, 11.89s/it] 80%|████████  | 16/20 [03:11<00:45, 11.48s/it] 85%|████████▌ | 17/20 [03:21<00:33, 11.23s/it] 90%|█████████ | 18/20 [03:32<00:21, 10.99s/it] 95%|█████████▌| 19/20 [03:42<00:10, 10.74s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 13 it 17 total=12.0059 mle=2.2290 pcon=8.8696 forget=0.0000 orth=0.9073 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.7886 mle=2.0140 pcon=8.8705 forget=0.0000 orth=0.9041 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.0412 mle=2.2691 pcon=8.8713 forget=0.0000 orth=0.9008 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.8789 mle=2.1104 pcon=8.8710 forget=0.0000 orth=0.8975 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.0600 mle=2.2945 pcon=8.8714 forget=0.0000 orth=0.8940 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.9631 mle=2.2009 pcon=8.8717 forget=0.0000 orth=0.8906 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.8538 mle=2.0939 pcon=8.8728 forget=0.0000 orth=0.8871 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.8738 mle=2.1174 pcon=8.8729 forget=0.0000 orth=0.8836 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 14 it 26 total=12.0493 mle=2.2961 pcon=8.8732 forget=0.0000 orth=0.8800 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.7621 mle=2.0121 pcon=8.8734 forget=0.0000 orth=0.8766 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.8102 mle=2.0630 pcon=8.8741 forget=0.0000 orth=0.8731 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.9566 mle=2.2150 pcon=8.8719 forget=0.0000 orth=0.8697 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.6693 mle=1.9312 pcon=8.8719 forget=0.0000 orth=0.8662 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.8896 mle=2.1549 pcon=8.8718 forget=0.0000 orth=0.8630 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.8276 mle=2.0963 pcon=8.8717 forget=0.0000 orth=0.8596 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.6382 mle=1.9107 pcon=8.8712 forget=0.0000 orth=0.8563 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 15 it 35 total=11.8280 mle=2.1040 pcon=8.8710 forget=0.0000 orth=0.8531 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.8114 mle=2.0911 pcon=8.8704 forget=0.0000 orth=0.8499 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.6828 mle=1.9655 pcon=8.8703 forget=0.0000 orth=0.8470 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.6812 mle=1.9677 pcon=8.8696 forget=0.0000 orth=0.8439 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.9062 mle=2.1965 pcon=8.8687 forget=0.0000 orth=0.8411 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.7464 mle=2.0392 pcon=8.8689 forget=0.0000 orth=0.8383 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.9041 mle=2.2012 pcon=8.8673 forget=0.0000 orth=0.8357 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.7000 mle=2.0000 pcon=8.8669 forget=0.0000 orth=0.8331 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 16 it 44 total=11.8466 mle=2.1499 pcon=8.8661 forget=0.0000 orth=0.8306 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.8519 mle=2.1578 pcon=8.8659 forget=0.0000 orth=0.8282 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.7044 mle=2.0132 pcon=8.8652 forget=0.0000 orth=0.8260 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.7157 mle=2.0275 pcon=8.8643 forget=0.0000 orth=0.8239 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.6489 mle=1.9637 pcon=8.8634 forget=0.0000 orth=0.8219 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.5689 mle=1.8866 pcon=8.8622 forget=0.0000 orth=0.8201 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.7307 mle=2.0508 pcon=8.8615 forget=0.0000 orth=0.8183 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 17 it 3 total=11.4652 mle=1.7873 pcon=8.8612 forget=0.0000 orth=0.8167 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.5067 mle=1.8312 pcon=8.8603 forget=0.0000 orth=0.8151 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.6833 mle=2.0093 pcon=8.8603 forget=0.0000 orth=0.8137 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.5265 mle=1.8533 pcon=8.8608 forget=0.0000 orth=0.8124 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.5972 mle=1.9260 pcon=8.8600 forget=0.0000 orth=0.8112 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.7089 mle=2.0389 pcon=8.8599 forget=0.0000 orth=0.8101 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.5925 mle=1.9248 pcon=8.8585 forget=0.0000 orth=0.8092 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.6410 mle=1.9761 pcon=8.8566 forget=0.0000 orth=0.8083 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 18 it 12 total=11.6207 mle=1.9573 pcon=8.8559 forget=0.0000 orth=0.8075 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.9280 mle=2.2670 pcon=8.8543 forget=0.0000 orth=0.8068 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.5986 mle=1.9387 pcon=8.8537 forget=0.0000 orth=0.8062 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.7562 mle=2.0985 pcon=8.8520 forget=0.0000 orth=0.8056 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.7828 mle=2.1262 pcon=8.8514 forget=0.0000 orth=0.8052 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.6289 mle=1.9741 pcon=8.8500 forget=0.0000 orth=0.8048 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.5850 mle=1.9319 pcon=8.8487 forget=0.0000 orth=0.8045 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.4971 mle=1.8455 pcon=8.8474 forget=0.0000 orth=0.8042 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 19 it 21 total=11.6092 mle=1.9579 pcon=8.8474 forget=0.0000 orth=0.8040 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.6709 mle=2.0210 pcon=8.8461 forget=0.0000 orth=0.8038 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
100%|██████████| 20/20 [03:53<00:00, 10.80s/it]100%|██████████| 20/20 [03:53<00:00, 11.66s/it]
[loss] ep 19 it 121 total=11.6183 mle=1.9689 pcon=8.8457 forget=0.0000 orth=0.8037 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.6676 mle=2.0181 pcon=8.8459 forget=0.0000 orth=0.8036 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.6914 mle=2.0417 pcon=8.8461 forget=0.0000 orth=0.8036 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.8072 mle=2.1585 pcon=8.8451 forget=0.0000 orth=0.8035 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.7523 mle=2.1036 pcon=8.8452 forget=0.0000 orth=0.8035 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.7219 mle=2.0736 pcon=8.8448 forget=0.0000 orth=0.8035 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<05:10,  1.26it/s]  3%|▎         | 11/391 [00:00<00:23, 16.08it/s]  5%|▌         | 21/391 [00:01<00:12, 30.51it/s]  8%|▊         | 31/391 [00:01<00:08, 44.01it/s] 10%|█         | 41/391 [00:01<00:06, 55.61it/s] 13%|█▎        | 51/391 [00:01<00:05, 65.33it/s] 15%|█▌        | 60/391 [00:01<00:04, 68.65it/s] 18%|█▊        | 69/391 [00:01<00:04, 65.79it/s] 20%|█▉        | 77/391 [00:01<00:04, 66.58it/s] 22%|██▏       | 85/391 [00:01<00:04, 66.57it/s] 24%|██▍       | 94/391 [00:01<00:04, 71.38it/s] 27%|██▋       | 104/391 [00:02<00:03, 78.09it/s] 29%|██▉       | 114/391 [00:02<00:03, 83.04it/s] 32%|███▏      | 124/391 [00:02<00:03, 86.61it/s] 34%|███▍      | 134/391 [00:02<00:02, 89.06it/s] 37%|███▋      | 144/391 [00:02<00:02, 89.76it/s] 39%|███▉      | 154/391 [00:02<00:02, 88.71it/s] 42%|████▏     | 164/391 [00:02<00:02, 90.59it/s] 45%|████▍     | 174/391 [00:02<00:02, 92.02it/s] 47%|████▋     | 184/391 [00:02<00:02, 93.10it/s] 50%|████▉     | 194/391 [00:02<00:02, 93.73it/s] 52%|█████▏    | 204/391 [00:03<00:01, 93.88it/s] 55%|█████▍    | 214/391 [00:03<00:01, 92.55it/s] 57%|█████▋    | 224/391 [00:03<00:01, 93.27it/s] 60%|█████▉    | 234/391 [00:03<00:01, 93.65it/s] 62%|██████▏   | 244/391 [00:03<00:01, 93.68it/s] 65%|██████▍   | 254/391 [00:03<00:01, 93.50it/s] 68%|██████▊   | 264/391 [00:03<00:01, 93.07it/s] 70%|███████   | 274/391 [00:03<00:01, 92.89it/s] 73%|███████▎  | 284/391 [00:03<00:01, 93.49it/s] 75%|███████▌  | 294/391 [00:04<00:01, 94.03it/s] 78%|███████▊  | 304/391 [00:04<00:00, 94.55it/s] 80%|████████  | 314/391 [00:04<00:00, 94.38it/s] 83%|████████▎ | 324/391 [00:04<00:00, 93.75it/s] 85%|████████▌ | 334/391 [00:04<00:00, 94.05it/s] 88%|████████▊ | 344/391 [00:04<00:00, 94.02it/s] 91%|█████████ | 354/391 [00:04<00:00, 94.61it/s] 93%|█████████▎| 364/391 [00:04<00:00, 94.11it/s] 96%|█████████▌| 374/391 [00:04<00:00, 95.17it/s] 98%|█████████▊| 384/391 [00:05<00:00, 95.93it/s]100%|██████████| 391/391 [00:05<00:00, 76.70it/s]
50000 images processed, 5.303000211715698 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.01it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.34it/s] 25%|██▌       | 20/79 [00:00<00:01, 39.68it/s] 38%|███▊      | 30/79 [00:00<00:00, 54.10it/s] 51%|█████     | 40/79 [00:00<00:00, 65.11it/s] 63%|██████▎   | 50/79 [00:01<00:00, 73.55it/s] 76%|███████▌  | 60/79 [00:01<00:00, 80.11it/s] 89%|████████▊ | 70/79 [00:01<00:00, 84.93it/s]100%|██████████| 79/79 [00:01<00:00, 59.19it/s]
10000 images processed, 1.3812782764434814 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:09,  1.56it/s]  5%|▌         | 11/204 [00:00<00:10, 19.27it/s] 10%|█         | 21/204 [00:00<00:05, 35.34it/s] 15%|█▍        | 30/204 [00:00<00:03, 47.57it/s] 20%|█▉        | 40/204 [00:01<00:02, 58.91it/s] 25%|██▍       | 50/204 [00:01<00:02, 67.53it/s] 29%|██▉       | 60/204 [00:01<00:01, 74.29it/s] 34%|███▍      | 70/204 [00:01<00:01, 79.10it/s] 39%|███▉      | 80/204 [00:01<00:01, 83.25it/s] 44%|████▍     | 90/204 [00:01<00:01, 85.35it/s] 49%|████▉     | 100/204 [00:01<00:01, 87.09it/s] 54%|█████▍    | 110/204 [00:01<00:01, 88.57it/s] 59%|█████▉    | 120/204 [00:01<00:00, 89.10it/s] 64%|██████▎   | 130/204 [00:02<00:00, 82.33it/s] 68%|██████▊   | 139/204 [00:02<00:00, 70.46it/s] 73%|███████▎  | 149/204 [00:02<00:00, 76.37it/s] 78%|███████▊  | 159/204 [00:02<00:00, 80.61it/s] 83%|████████▎ | 169/204 [00:02<00:00, 83.67it/s] 88%|████████▊ | 179/204 [00:02<00:00, 86.73it/s] 93%|█████████▎| 189/204 [00:02<00:00, 88.05it/s] 97%|█████████▋| 198/204 [00:02<00:00, 87.85it/s]100%|██████████| 204/204 [00:02<00:00, 68.77it/s]
26032 images processed, 3.080254554748535 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:57,  1.36it/s] 13%|█▎        | 10/79 [00:00<00:04, 15.55it/s] 25%|██▌       | 20/79 [00:00<00:01, 30.92it/s] 38%|███▊      | 30/79 [00:01<00:01, 44.77it/s] 51%|█████     | 40/79 [00:01<00:00, 56.17it/s] 63%|██████▎   | 50/79 [00:01<00:00, 65.65it/s] 75%|███████▍  | 59/79 [00:01<00:00, 67.03it/s] 86%|████████▌ | 68/79 [00:01<00:00, 72.32it/s] 99%|█████████▊| 78/79 [00:01<00:00, 78.75it/s]100%|██████████| 79/79 [00:01<00:00, 49.01it/s]
10000 images processed, 1.6694920063018799 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.56it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.34it/s] 27%|██▋       | 21/79 [00:00<00:01, 35.51it/s] 39%|███▉      | 31/79 [00:00<00:00, 48.87it/s] 51%|█████     | 40/79 [00:01<00:00, 57.96it/s] 63%|██████▎   | 50/79 [00:01<00:00, 67.02it/s] 76%|███████▌  | 60/79 [00:01<00:00, 73.70it/s] 89%|████████▊ | 70/79 [00:01<00:00, 79.91it/s]100%|██████████| 79/79 [00:01<00:00, 53.55it/s]
10000 images processed, 1.4942145347595215 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:45,  1.52it/s] 10%|█         | 7/70 [00:00<00:05, 11.94it/s] 24%|██▍       | 17/70 [00:00<00:01, 29.42it/s] 39%|███▊      | 27/70 [00:00<00:00, 44.45it/s] 53%|█████▎    | 37/70 [00:01<00:00, 56.92it/s] 67%|██████▋   | 47/70 [00:01<00:00, 67.11it/s] 81%|████████▏ | 57/70 [00:01<00:00, 75.10it/s] 96%|█████████▌| 67/70 [00:01<00:00, 81.11it/s]100%|██████████| 70/70 [00:01<00:00, 49.18it/s]
8925 images processed, 1.459995985031128 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:47,  1.07s/it]  4%|▍         | 2/45 [00:01<00:23,  1.80it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.55it/s] 38%|███▊      | 17/45 [00:01<00:02, 12.55it/s] 51%|█████     | 23/45 [00:01<00:01, 17.68it/s] 73%|███████▎  | 33/45 [00:02<00:00, 18.66it/s] 82%|████████▏ | 37/45 [00:02<00:00, 20.84it/s]100%|██████████| 45/45 [00:02<00:00, 16.69it/s]
5640 images processed, 2.714329957962036 seconds used

18.971291542053223
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.62  99.14  84.56
places365     53.35  86.46  52.06
LSUN          40.92  91.55  69.65
iSUN          35.75  91.96  68.85
dtd           31.10  92.75  75.27
AVG           32.95  92.37  70.08
[incremental] Overall: 0.7200 New: 0.6980 Old: 0.7420
[incremental] Final(Top-1): 0.7200  Average: 0.7840
5.799335479736328
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=20, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/20 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  5%|▌         | 1/20 [00:21<06:39, 21.05s/it] 10%|█         | 2/20 [00:31<04:24, 14.68s/it] 15%|█▌        | 3/20 [00:40<03:29, 12.34s/it] 20%|██        | 4/20 [00:51<03:04, 11.55s/it] 25%|██▌       | 5/20 [01:01<02:45, 11.04s/it] 30%|███       | 6/20 [01:12<02:33, 10.93s/it][loss] ep 0 it 0 total=13.2001 mle=2.3471 pcon=9.4393 forget=0.0000 orth=1.4137 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=13.1191 mle=2.2625 pcon=9.4433 forget=0.0000 orth=1.4133 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=13.2489 mle=2.3891 pcon=9.4474 forget=0.0000 orth=1.4124 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=13.1238 mle=2.2618 pcon=9.4511 forget=0.0000 orth=1.4108 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=12.8031 mle=1.9396 pcon=9.4548 forget=0.0000 orth=1.4087 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=12.9198 mle=2.0561 pcon=9.4577 forget=0.0000 orth=1.4059 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.3948 mle=2.5312 pcon=9.4612 forget=0.0000 orth=1.4025 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.0069 mle=2.1445 pcon=9.4640 forget=0.0000 orth=1.3984 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=12.9915 mle=2.1310 pcon=9.4667 forget=0.0000 orth=1.3938 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=12.9724 mle=2.1149 pcon=9.4689 forget=0.0000 orth=1.3886 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.1172 mle=2.2631 pcon=9.4713 forget=0.0000 orth=1.3827 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=13.2761 mle=2.4270 pcon=9.4729 forget=0.0000 orth=1.3762 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.2288 mle=2.3856 pcon=9.4741 forget=0.0000 orth=1.3691 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=12.8894 mle=2.0529 pcon=9.4750 forget=0.0000 orth=1.3615 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.1249 mle=2.2950 pcon=9.4767 forget=0.0000 orth=1.3532 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.0404 mle=2.2177 pcon=9.4783 forget=0.0000 orth=1.3444 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=12.9401 mle=2.1255 pcon=9.4797 forget=0.0000 orth=1.3349 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.0718 mle=2.2659 pcon=9.4810 forget=0.0000 orth=1.3250 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=12.8340 mle=2.0373 pcon=9.4824 forget=0.0000 orth=1.3143 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=12.9491 mle=2.1623 pcon=9.4838 forget=0.0000 orth=1.3031 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=12.5410 mle=1.7642 pcon=9.4854 forget=0.0000 orth=1.2913 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.0301 mle=2.2651 pcon=9.4859 forget=0.0000 orth=1.2791 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.0642 mle=2.3107 pcon=9.4872 forget=0.0000 orth=1.2664 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=12.6023 mle=1.8606 pcon=9.4886 forget=0.0000 orth=1.2530 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=12.9249 mle=2.1958 pcon=9.4899 forget=0.0000 orth=1.2393 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.0055 mle=2.2890 pcon=9.4913 forget=0.0000 orth=1.2253 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.9428 mle=2.2402 pcon=9.4920 forget=0.0000 orth=1.2107 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.7938 mle=2.1052 pcon=9.4927 forget=0.0000 orth=1.1959 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=12.7518 mle=2.0777 pcon=9.4933 forget=0.0000 orth=1.1809 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=12.8054 mle=2.1449 pcon=9.4946 forget=0.0000 orth=1.1658 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=12.7357 mle=2.0899 pcon=9.4951 forget=0.0000 orth=1.1508 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.7893 mle=2.1576 pcon=9.4962 forget=0.0000 orth=1.1355 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=12.7695 mle=2.1521 pcon=9.4971 forget=0.0000 orth=1.1203 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.7757 mle=2.1726 pcon=9.4980 forget=0.0000 orth=1.1051 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.8389 mle=2.2501 pcon=9.4986 forget=0.0000 orth=1.0902 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.5585 mle=1.9838 pcon=9.4993 forget=0.0000 orth=1.0755 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.5877 mle=2.0268 pcon=9.4999 forget=0.0000 orth=1.0610 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.5366 mle=1.9892 pcon=9.5006 forget=0.0000 orth=1.0468 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.8226 mle=2.2884 pcon=9.5014 forget=0.0000 orth=1.0328 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.5057 mle=1.9841 pcon=9.5020 forget=0.0000 orth=1.0195 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 5 it 45 total=12.6483 mle=2.1397 pcon=9.5024 forget=0.0000 orth=1.0062 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.5461 mle=2.0495 pcon=9.5030 forget=0.0000 orth=0.9935 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.5416 mle=2.0565 pcon=9.5039 forget=0.0000 orth=0.9812 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.5850 mle=2.1110 pcon=9.5045 forget=0.0000 orth=0.9694 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.6493 mle=2.1860 pcon=9.5053 forget=0.0000 orth=0.9580 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.3222 mle=1.8688 pcon=9.5061 forget=0.0000 orth=0.9472 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.7045 mle=2.2611 pcon=9.5069 forget=0.0000 orth=0.9365 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 6 it 4 total=12.5607 mle=2.1269 pcon=9.5077 forget=0.0000 orth=0.9262 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.6345 mle=2.2100 pcon=9.5081 forget=0.0000 orth=0.9164 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.4113 mle=1.9954 pcon=9.5090 forget=0.0000 orth=0.9070 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.2269 mle=1.8199 pcon=9.5092 forget=0.0000 orth=0.8978 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
 35%|███▌      | 7/20 [01:23<02:22, 10.99s/it] 40%|████      | 8/20 [01:33<02:09, 10.77s/it] 45%|████▌     | 9/20 [01:44<01:58, 10.73s/it] 50%|█████     | 10/20 [01:54<01:45, 10.56s/it] 55%|█████▌    | 11/20 [02:04<01:34, 10.47s/it] 60%|██████    | 12/20 [02:14<01:23, 10.44s/it][loss] ep 6 it 204 total=12.4118 mle=2.0134 pcon=9.5094 forget=0.0000 orth=0.8890 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=12.4336 mle=2.0438 pcon=9.5096 forget=0.0000 orth=0.8803 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.7320 mle=2.3497 pcon=9.5102 forget=0.0000 orth=0.8720 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.3074 mle=1.9324 pcon=9.5109 forget=0.0000 orth=0.8641 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 7 it 13 total=12.6270 mle=2.2596 pcon=9.5110 forget=0.0000 orth=0.8564 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.7192 mle=2.3592 pcon=9.5110 forget=0.0000 orth=0.8490 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.5988 mle=2.2454 pcon=9.5116 forget=0.0000 orth=0.8417 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.6082 mle=2.2613 pcon=9.5122 forget=0.0000 orth=0.8347 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.4093 mle=2.0685 pcon=9.5128 forget=0.0000 orth=0.8280 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.5005 mle=2.1656 pcon=9.5134 forget=0.0000 orth=0.8215 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.3621 mle=2.0331 pcon=9.5138 forget=0.0000 orth=0.8152 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.4984 mle=2.1749 pcon=9.5143 forget=0.0000 orth=0.8092 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 8 it 22 total=12.4451 mle=2.1279 pcon=9.5142 forget=0.0000 orth=0.8030 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.2700 mle=1.9586 pcon=9.5143 forget=0.0000 orth=0.7971 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.1958 mle=1.8901 pcon=9.5144 forget=0.0000 orth=0.7913 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=12.0762 mle=1.7760 pcon=9.5146 forget=0.0000 orth=0.7856 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=12.0728 mle=1.7777 pcon=9.5149 forget=0.0000 orth=0.7802 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.2531 mle=1.9639 pcon=9.5145 forget=0.0000 orth=0.7747 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.3021 mle=2.0180 pcon=9.5148 forget=0.0000 orth=0.7694 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.4511 mle=2.1725 pcon=9.5145 forget=0.0000 orth=0.7641 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 9 it 31 total=12.5942 mle=2.3210 pcon=9.5143 forget=0.0000 orth=0.7590 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=12.3340 mle=2.0663 pcon=9.5139 forget=0.0000 orth=0.7538 favg=0.0000 nr=110 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=12.1992 mle=1.9369 pcon=9.5135 forget=0.0000 orth=0.7488 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=12.2655 mle=2.0089 pcon=9.5129 forget=0.0000 orth=0.7436 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=12.1719 mle=1.9201 pcon=9.5128 forget=0.0000 orth=0.7389 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=12.2658 mle=2.0194 pcon=9.5124 forget=0.0000 orth=0.7340 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.3605 mle=2.1198 pcon=9.5115 forget=0.0000 orth=0.7292 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=12.1515 mle=1.9166 pcon=9.5107 forget=0.0000 orth=0.7243 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 10 it 40 total=12.0989 mle=1.8691 pcon=9.5103 forget=0.0000 orth=0.7195 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.5343 mle=2.3102 pcon=9.5095 forget=0.0000 orth=0.7146 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=12.1943 mle=1.9748 pcon=9.5096 forget=0.0000 orth=0.7098 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=12.1777 mle=1.9636 pcon=9.5090 forget=0.0000 orth=0.7051 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=12.0365 mle=1.8280 pcon=9.5082 forget=0.0000 orth=0.7003 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.4630 mle=2.2588 pcon=9.5083 forget=0.0000 orth=0.6958 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=12.1662 mle=1.9680 pcon=9.5070 forget=0.0000 orth=0.6912 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.4248 mle=2.2322 pcon=9.5059 forget=0.0000 orth=0.6867 favg=0.0000 nr=68 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 11 it 49 total=12.1422 mle=1.9552 pcon=9.5048 forget=0.0000 orth=0.6821 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.3584 mle=2.1775 pcon=9.5034 forget=0.0000 orth=0.6775 favg=0.0000 nr=102 nf=11 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=12.2946 mle=2.1192 pcon=9.5025 forget=0.0000 orth=0.6729 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=12.1601 mle=1.9909 pcon=9.5008 forget=0.0000 orth=0.6684 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.9362 mle=1.7739 pcon=9.4986 forget=0.0000 orth=0.6638 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=12.2418 mle=2.0860 pcon=9.4965 forget=0.0000 orth=0.6592 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=12.0111 mle=1.8612 pcon=9.4951 forget=0.0000 orth=0.6548 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 12 it 8 total=12.2602 mle=2.1163 pcon=9.4936 forget=0.0000 orth=0.6504 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=12.0973 mle=1.9603 pcon=9.4911 forget=0.0000 orth=0.6460 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=12.2821 mle=2.1512 pcon=9.4893 forget=0.0000 orth=0.6416 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=12.1182 mle=1.9940 pcon=9.4870 forget=0.0000 orth=0.6372 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=12.0426 mle=1.9254 pcon=9.4843 forget=0.0000 orth=0.6329 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.3859 mle=2.2745 pcon=9.4828 forget=0.0000 orth=0.6286 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=12.2065 mle=2.1016 pcon=9.4806 forget=0.0000 orth=0.6243 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=12.2013 mle=2.1027 pcon=9.4785 forget=0.0000 orth=0.6201 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
 65%|██████▌   | 13/20 [02:25<01:13, 10.47s/it] 70%|███████   | 14/20 [02:36<01:04, 10.68s/it] 75%|███████▌  | 15/20 [02:47<00:53, 10.73s/it] 80%|████████  | 16/20 [02:57<00:42, 10.55s/it] 85%|████████▌ | 17/20 [03:08<00:32, 10.73s/it] 90%|█████████ | 18/20 [03:19<00:21, 10.77s/it] 95%|█████████▌| 19/20 [03:30<00:10, 10.74s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 13 it 17 total=12.2600 mle=2.1675 pcon=9.4766 forget=0.0000 orth=0.6159 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.9960 mle=1.9100 pcon=9.4742 forget=0.0000 orth=0.6118 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.3150 mle=2.2349 pcon=9.4724 forget=0.0000 orth=0.6076 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=12.1837 mle=2.1110 pcon=9.4691 forget=0.0000 orth=0.6036 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.2731 mle=2.2062 pcon=9.4674 forget=0.0000 orth=0.5996 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=12.2209 mle=2.1603 pcon=9.4650 forget=0.0000 orth=0.5956 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=12.1149 mle=2.0604 pcon=9.4629 forget=0.0000 orth=0.5917 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=12.1407 mle=2.0926 pcon=9.4602 forget=0.0000 orth=0.5878 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 14 it 26 total=12.2991 mle=2.2569 pcon=9.4581 forget=0.0000 orth=0.5841 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=12.0048 mle=1.9689 pcon=9.4556 forget=0.0000 orth=0.5804 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=12.0836 mle=2.0541 pcon=9.4526 forget=0.0000 orth=0.5768 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=12.1809 mle=2.1587 pcon=9.4489 forget=0.0000 orth=0.5733 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.9507 mle=1.9348 pcon=9.4460 forget=0.0000 orth=0.5699 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=12.1610 mle=2.1512 pcon=9.4433 forget=0.0000 orth=0.5666 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=12.0420 mle=2.0377 pcon=9.4410 forget=0.0000 orth=0.5633 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.8608 mle=1.8624 pcon=9.4382 forget=0.0000 orth=0.5602 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 15 it 35 total=12.0260 mle=2.0339 pcon=9.4349 forget=0.0000 orth=0.5572 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=12.0196 mle=2.0330 pcon=9.4323 forget=0.0000 orth=0.5543 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.9197 mle=1.9386 pcon=9.4296 forget=0.0000 orth=0.5514 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.9163 mle=1.9411 pcon=9.4264 forget=0.0000 orth=0.5488 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=12.1342 mle=2.1645 pcon=9.4236 forget=0.0000 orth=0.5462 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.9807 mle=2.0164 pcon=9.4206 forget=0.0000 orth=0.5437 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=12.1288 mle=2.1701 pcon=9.4174 forget=0.0000 orth=0.5413 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.9239 mle=1.9702 pcon=9.4146 forget=0.0000 orth=0.5391 favg=0.0000 nr=111 nf=1 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 16 it 44 total=12.1031 mle=2.1539 pcon=9.4122 forget=0.0000 orth=0.5369 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=12.0834 mle=2.1389 pcon=9.4095 forget=0.0000 orth=0.5349 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.9191 mle=1.9801 pcon=9.4060 forget=0.0000 orth=0.5330 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.8922 mle=1.9582 pcon=9.4029 forget=0.0000 orth=0.5311 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.8506 mle=1.9210 pcon=9.4001 forget=0.0000 orth=0.5294 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.7833 mle=1.8582 pcon=9.3973 forget=0.0000 orth=0.5278 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.9192 mle=1.9982 pcon=9.3947 forget=0.0000 orth=0.5263 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 17 it 3 total=11.6748 mle=1.7575 pcon=9.3924 forget=0.0000 orth=0.5249 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.7193 mle=1.8056 pcon=9.3901 forget=0.0000 orth=0.5236 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.8520 mle=1.9419 pcon=9.3877 forget=0.0000 orth=0.5224 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.7646 mle=1.8582 pcon=9.3851 forget=0.0000 orth=0.5213 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.8192 mle=1.9173 pcon=9.3816 forget=0.0000 orth=0.5203 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.8689 mle=1.9700 pcon=9.3795 forget=0.0000 orth=0.5194 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.7897 mle=1.8939 pcon=9.3773 forget=0.0000 orth=0.5185 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.8606 mle=1.9692 pcon=9.3736 forget=0.0000 orth=0.5178 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 18 it 12 total=11.8465 mle=1.9582 pcon=9.3711 forget=0.0000 orth=0.5171 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=12.1075 mle=2.2228 pcon=9.3681 forget=0.0000 orth=0.5165 favg=0.0000 nr=110 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.7686 mle=1.8864 pcon=9.3661 forget=0.0000 orth=0.5160 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.9652 mle=2.0870 pcon=9.3626 forget=0.0000 orth=0.5156 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.9847 mle=2.1096 pcon=9.3599 forget=0.0000 orth=0.5152 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.8295 mle=1.9575 pcon=9.3571 forget=0.0000 orth=0.5149 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.8007 mle=1.9314 pcon=9.3547 forget=0.0000 orth=0.5146 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.7097 mle=1.8431 pcon=9.3522 forget=0.0000 orth=0.5144 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 19 it 21 total=11.7909 mle=1.9265 pcon=9.3502 forget=0.0000 orth=0.5142 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.8860 mle=2.0240 pcon=9.3479 forget=0.0000 orth=0.5141 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
100%|██████████| 20/20 [03:41<00:00, 10.84s/it]100%|██████████| 20/20 [03:41<00:00, 11.07s/it]
[loss] ep 19 it 121 total=11.7723 mle=1.9120 pcon=9.3463 forget=0.0000 orth=0.5140 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.8587 mle=2.0009 pcon=9.3438 forget=0.0000 orth=0.5139 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.8579 mle=2.0015 pcon=9.3424 forget=0.0000 orth=0.5139 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.9425 mle=2.0878 pcon=9.3409 forget=0.0000 orth=0.5138 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.8906 mle=2.0374 pcon=9.3394 forget=0.0000 orth=0.5138 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.8926 mle=2.0404 pcon=9.3383 forget=0.0000 orth=0.5138 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:56,  1.65it/s]  3%|▎         | 11/391 [00:00<00:18, 20.22it/s]  5%|▌         | 21/391 [00:00<00:10, 36.83it/s]  8%|▊         | 31/391 [00:00<00:07, 50.34it/s] 10%|█         | 41/391 [00:01<00:05, 61.71it/s] 13%|█▎        | 51/391 [00:01<00:04, 70.53it/s] 16%|█▌        | 61/391 [00:01<00:04, 77.33it/s] 18%|█▊        | 71/391 [00:01<00:03, 82.49it/s] 21%|██        | 81/391 [00:01<00:03, 86.18it/s] 23%|██▎       | 91/391 [00:01<00:03, 75.00it/s] 26%|██▌       | 100/391 [00:01<00:03, 75.81it/s] 28%|██▊       | 109/391 [00:01<00:03, 76.94it/s] 30%|███       | 119/391 [00:01<00:03, 81.95it/s] 33%|███▎      | 129/391 [00:02<00:03, 85.66it/s] 36%|███▌      | 139/391 [00:02<00:02, 88.32it/s] 38%|███▊      | 149/391 [00:02<00:02, 85.83it/s] 41%|████      | 159/391 [00:02<00:02, 88.39it/s] 43%|████▎     | 169/391 [00:02<00:02, 90.58it/s] 46%|████▌     | 179/391 [00:02<00:02, 90.64it/s] 48%|████▊     | 189/391 [00:02<00:02, 90.55it/s] 51%|█████     | 199/391 [00:02<00:02, 92.03it/s] 53%|█████▎    | 209/391 [00:02<00:02, 88.05it/s] 56%|█████▌    | 219/391 [00:03<00:01, 88.97it/s] 59%|█████▊    | 229/391 [00:03<00:01, 90.66it/s] 61%|██████    | 239/391 [00:03<00:01, 92.12it/s] 64%|██████▎   | 249/391 [00:03<00:01, 91.50it/s] 66%|██████▌   | 259/391 [00:03<00:01, 91.12it/s] 69%|██████▉   | 269/391 [00:03<00:01, 92.15it/s] 71%|███████▏  | 279/391 [00:03<00:01, 83.52it/s] 74%|███████▍  | 289/391 [00:03<00:01, 86.51it/s] 76%|███████▋  | 299/391 [00:03<00:01, 88.82it/s] 79%|███████▉  | 308/391 [00:04<00:00, 88.60it/s] 81%|████████▏ | 318/391 [00:04<00:00, 90.40it/s] 84%|████████▍ | 328/391 [00:04<00:00, 91.11it/s] 86%|████████▋ | 338/391 [00:04<00:00, 92.53it/s] 89%|████████▉ | 348/391 [00:04<00:00, 93.29it/s] 92%|█████████▏| 358/391 [00:04<00:00, 93.78it/s] 94%|█████████▍| 368/391 [00:04<00:00, 94.02it/s] 97%|█████████▋| 378/391 [00:04<00:00, 94.95it/s] 99%|█████████▉| 388/391 [00:04<00:00, 95.62it/s]100%|██████████| 391/391 [00:04<00:00, 79.16it/s]
50000 images processed, 5.073261022567749 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:51,  1.52it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.82it/s] 27%|██▋       | 21/79 [00:00<00:01, 34.70it/s] 39%|███▉      | 31/79 [00:00<00:00, 48.21it/s] 51%|█████     | 40/79 [00:01<00:00, 57.95it/s] 63%|██████▎   | 50/79 [00:01<00:00, 67.04it/s] 76%|███████▌  | 60/79 [00:01<00:00, 74.92it/s] 89%|████████▊ | 70/79 [00:01<00:00, 80.97it/s]100%|██████████| 79/79 [00:01<00:00, 47.95it/s]
10000 images processed, 1.6815636157989502 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:43,  1.24it/s]  4%|▍         | 9/204 [00:00<00:14, 13.07it/s]  9%|▉         | 18/204 [00:01<00:06, 26.63it/s] 14%|█▎        | 28/204 [00:01<00:04, 40.68it/s] 18%|█▊        | 36/204 [00:01<00:03, 49.26it/s] 22%|██▏       | 44/204 [00:01<00:02, 54.95it/s] 26%|██▋       | 54/204 [00:01<00:02, 65.09it/s] 31%|███       | 63/204 [00:01<00:01, 71.34it/s] 35%|███▌      | 72/204 [00:01<00:01, 76.36it/s] 40%|███▉      | 81/204 [00:01<00:01, 79.92it/s] 45%|████▍     | 91/204 [00:01<00:01, 83.39it/s] 49%|████▉     | 100/204 [00:01<00:01, 84.69it/s] 53%|█████▎    | 109/204 [00:02<00:01, 83.70it/s] 58%|█████▊    | 118/204 [00:02<00:01, 80.13it/s] 63%|██████▎   | 128/204 [00:02<00:00, 83.66it/s] 68%|██████▊   | 138/204 [00:02<00:00, 86.63it/s] 72%|███████▏  | 147/204 [00:02<00:00, 86.24it/s] 77%|███████▋  | 157/204 [00:02<00:00, 88.48it/s] 81%|████████▏ | 166/204 [00:02<00:00, 86.68it/s] 86%|████████▋ | 176/204 [00:02<00:00, 88.52it/s] 91%|█████████ | 185/204 [00:02<00:00, 80.23it/s] 95%|█████████▌| 194/204 [00:03<00:00, 81.16it/s]100%|█████████▉| 203/204 [00:03<00:00, 81.41it/s]100%|██████████| 204/204 [00:03<00:00, 63.77it/s]
26032 images processed, 3.268087148666382 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:54,  1.42it/s] 13%|█▎        | 10/79 [00:00<00:04, 16.15it/s] 24%|██▍       | 19/79 [00:00<00:02, 29.84it/s] 37%|███▋      | 29/79 [00:01<00:01, 44.01it/s] 49%|████▉     | 39/79 [00:01<00:00, 56.12it/s] 61%|██████    | 48/79 [00:01<00:00, 64.20it/s] 72%|███████▏  | 57/79 [00:01<00:00, 66.21it/s] 84%|████████▎ | 66/79 [00:01<00:00, 68.77it/s] 96%|█████████▌| 76/79 [00:01<00:00, 76.09it/s]100%|██████████| 79/79 [00:01<00:00, 48.95it/s]
10000 images processed, 1.6885695457458496 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:54,  1.44it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.02it/s] 27%|██▋       | 21/79 [00:00<00:01, 33.55it/s] 37%|███▋      | 29/79 [00:01<00:01, 41.45it/s] 49%|████▉     | 39/79 [00:01<00:00, 53.88it/s] 62%|██████▏   | 49/79 [00:01<00:00, 63.98it/s] 75%|███████▍  | 59/79 [00:01<00:00, 72.48it/s] 87%|████████▋ | 69/79 [00:01<00:00, 78.73it/s]100%|██████████| 79/79 [00:01<00:00, 50.97it/s]
10000 images processed, 1.568748950958252 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:49,  1.38it/s] 16%|█▌        | 11/70 [00:00<00:03, 17.33it/s] 29%|██▊       | 20/70 [00:00<00:01, 30.98it/s] 43%|████▎     | 30/70 [00:01<00:00, 44.63it/s] 57%|█████▋    | 40/70 [00:01<00:00, 56.45it/s] 71%|███████▏  | 50/70 [00:01<00:00, 66.49it/s] 84%|████████▍ | 59/70 [00:01<00:00, 65.75it/s] 99%|█████████▊| 69/70 [00:01<00:00, 73.46it/s]100%|██████████| 70/70 [00:01<00:00, 46.13it/s]
8925 images processed, 1.559652328491211 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:57,  1.31s/it]  7%|▋         | 3/45 [00:01<00:15,  2.63it/s] 29%|██▉       | 13/45 [00:01<00:02, 14.38it/s] 40%|████      | 18/45 [00:02<00:02, 12.16it/s] 51%|█████     | 23/45 [00:02<00:01, 15.92it/s] 73%|███████▎  | 33/45 [00:02<00:00, 14.74it/s] 96%|█████████▌| 43/45 [00:03<00:00, 22.78it/s]100%|██████████| 45/45 [00:03<00:00, 14.82it/s]
5640 images processed, 3.059027671813965 seconds used

19.832857370376587
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.36  99.36  91.63
places365     66.86  84.47  50.20
LSUN          32.13  94.61  83.62
iSUN          45.74  91.31  75.42
dtd           29.45  93.31  81.47
AVG           35.51  92.61  76.47
[incremental] Overall: 0.6827 New: 0.7140 Old: 0.6670
[incremental] Final(Top-1): 0.6827  Average: 0.7502
6.030313968658447
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=20, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/20 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  5%|▌         | 1/20 [00:17<05:37, 17.74s/it] 10%|█         | 2/20 [00:28<04:07, 13.73s/it] 15%|█▌        | 3/20 [00:39<03:29, 12.33s/it] 20%|██        | 4/20 [00:49<03:04, 11.53s/it] 25%|██▌       | 5/20 [01:00<02:50, 11.36s/it] 30%|███       | 6/20 [01:11<02:38, 11.30s/it][loss] ep 0 it 0 total=13.8763 mle=2.4124 pcon=9.8394 forget=0.0000 orth=1.6245 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=13.7357 mle=2.2705 pcon=9.8412 forget=0.0000 orth=1.6241 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=13.8188 mle=2.3525 pcon=9.8431 forget=0.0000 orth=1.6233 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=13.7359 mle=2.2707 pcon=9.8433 forget=0.0000 orth=1.6219 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=13.4080 mle=1.9440 pcon=9.8439 forget=0.0000 orth=1.6201 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.5776 mle=2.1161 pcon=9.8438 forget=0.0000 orth=1.6177 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.9694 mle=2.5119 pcon=9.8428 forget=0.0000 orth=1.6147 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.5608 mle=2.1086 pcon=9.8410 forget=0.0000 orth=1.6112 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.5267 mle=2.0804 pcon=9.8391 forget=0.0000 orth=1.6072 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.5309 mle=2.0910 pcon=9.8373 forget=0.0000 orth=1.6026 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.6776 mle=2.2451 pcon=9.8351 forget=0.0000 orth=1.5974 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=13.8262 mle=2.4014 pcon=9.8330 forget=0.0000 orth=1.5917 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.7557 mle=2.3405 pcon=9.8299 forget=0.0000 orth=1.5854 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.4391 mle=2.0342 pcon=9.8264 forget=0.0000 orth=1.5785 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.6371 mle=2.2424 pcon=9.8236 forget=0.0000 orth=1.5710 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.6363 mle=2.2535 pcon=9.8199 forget=0.0000 orth=1.5630 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.4810 mle=2.1092 pcon=9.8174 forget=0.0000 orth=1.5544 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.5618 mle=2.2015 pcon=9.8150 forget=0.0000 orth=1.5452 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.3366 mle=1.9891 pcon=9.8122 forget=0.0000 orth=1.5354 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.4906 mle=2.1560 pcon=9.8096 forget=0.0000 orth=1.5250 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.1362 mle=1.8162 pcon=9.8060 forget=0.0000 orth=1.5140 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.5206 mle=2.2162 pcon=9.8021 forget=0.0000 orth=1.5023 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.5712 mle=2.2818 pcon=9.7993 forget=0.0000 orth=1.4901 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.0700 mle=1.7962 pcon=9.7965 forget=0.0000 orth=1.4773 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.4505 mle=2.1934 pcon=9.7933 forget=0.0000 orth=1.4639 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.5503 mle=2.3102 pcon=9.7902 forget=0.0000 orth=1.4499 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.3838 mle=2.1618 pcon=9.7867 forget=0.0000 orth=1.4353 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.2920 mle=2.0888 pcon=9.7831 forget=0.0000 orth=1.4201 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.1805 mle=1.9964 pcon=9.7798 forget=0.0000 orth=1.4043 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.2243 mle=2.0596 pcon=9.7767 forget=0.0000 orth=1.3881 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.1997 mle=2.0554 pcon=9.7731 forget=0.0000 orth=1.3712 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.1922 mle=2.0683 pcon=9.7701 forget=0.0000 orth=1.3539 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.2462 mle=2.1437 pcon=9.7665 forget=0.0000 orth=1.3360 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.2000 mle=2.1193 pcon=9.7630 forget=0.0000 orth=1.3177 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.2002 mle=2.1417 pcon=9.7596 forget=0.0000 orth=1.2989 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.9662 mle=1.9301 pcon=9.7564 forget=0.0000 orth=1.2797 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.9975 mle=1.9841 pcon=9.7532 forget=0.0000 orth=1.2602 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.9377 mle=1.9471 pcon=9.7504 forget=0.0000 orth=1.2402 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.1939 mle=2.2264 pcon=9.7475 forget=0.0000 orth=1.2200 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.8804 mle=1.9363 pcon=9.7447 forget=0.0000 orth=1.1995 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 5 it 45 total=13.0230 mle=2.1027 pcon=9.7414 forget=0.0000 orth=1.1788 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.9413 mle=2.0450 pcon=9.7384 forget=0.0000 orth=1.1580 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.8847 mle=2.0129 pcon=9.7346 forget=0.0000 orth=1.1371 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.9335 mle=2.0856 pcon=9.7317 forget=0.0000 orth=1.1162 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.9078 mle=2.0836 pcon=9.7289 forget=0.0000 orth=1.0952 favg=0.0000 nr=97 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.6386 mle=1.8380 pcon=9.7262 forget=0.0000 orth=1.0744 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.9952 mle=2.2178 pcon=9.7237 forget=0.0000 orth=1.0537 favg=0.0000 nr=95 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 6 it 4 total=12.8211 mle=2.0679 pcon=9.7200 forget=0.0000 orth=1.0332 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.8508 mle=2.1207 pcon=9.7171 forget=0.0000 orth=1.0130 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.6116 mle=1.9045 pcon=9.7142 forget=0.0000 orth=0.9930 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.4758 mle=1.7915 pcon=9.7109 forget=0.0000 orth=0.9734 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=12.6538 mle=1.9922 pcon=9.7073 forget=0.0000 orth=0.9543 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
 35%|███▌      | 7/20 [01:22<02:22, 10.93s/it] 40%|████      | 8/20 [01:31<02:07, 10.59s/it] 45%|████▌     | 9/20 [01:42<01:55, 10.50s/it] 50%|█████     | 10/20 [01:52<01:44, 10.42s/it] 55%|█████▌    | 11/20 [02:02<01:33, 10.37s/it] 60%|██████    | 12/20 [02:12<01:21, 10.15s/it] 65%|██████▌   | 13/20 [02:23<01:12, 10.32s/it][loss] ep 6 it 254 total=12.7248 mle=2.0852 pcon=9.7041 forget=0.0000 orth=0.9355 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.8564 mle=2.2381 pcon=9.7012 forget=0.0000 orth=0.9171 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.5345 mle=1.9373 pcon=9.6981 forget=0.0000 orth=0.8991 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 7 it 13 total=12.7848 mle=2.2078 pcon=9.6954 forget=0.0000 orth=0.8816 favg=0.0000 nr=98 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.8532 mle=2.2962 pcon=9.6923 forget=0.0000 orth=0.8646 favg=0.0000 nr=94 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.7292 mle=2.1917 pcon=9.6895 forget=0.0000 orth=0.8480 favg=0.0000 nr=93 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.7466 mle=2.2280 pcon=9.6867 forget=0.0000 orth=0.8319 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.5040 mle=2.0041 pcon=9.6837 forget=0.0000 orth=0.8162 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.6411 mle=2.1594 pcon=9.6806 forget=0.0000 orth=0.8010 favg=0.0000 nr=102 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.4497 mle=1.9848 pcon=9.6787 forget=0.0000 orth=0.7863 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.5674 mle=2.1199 pcon=9.6755 forget=0.0000 orth=0.7720 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 8 it 22 total=12.4595 mle=2.0292 pcon=9.6723 forget=0.0000 orth=0.7580 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.3017 mle=1.8875 pcon=9.6697 forget=0.0000 orth=0.7444 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.2781 mle=1.8805 pcon=9.6665 forget=0.0000 orth=0.7312 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=12.1508 mle=1.7692 pcon=9.6633 forget=0.0000 orth=0.7183 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=12.0972 mle=1.7306 pcon=9.6609 forget=0.0000 orth=0.7058 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.2747 mle=1.9234 pcon=9.6577 forget=0.0000 orth=0.6936 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.3669 mle=2.0303 pcon=9.6549 forget=0.0000 orth=0.6817 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.4428 mle=2.1212 pcon=9.6515 forget=0.0000 orth=0.6701 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 9 it 31 total=12.5387 mle=2.2317 pcon=9.6483 forget=0.0000 orth=0.6587 favg=0.0000 nr=92 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=12.3010 mle=2.0079 pcon=9.6455 forget=0.0000 orth=0.6477 favg=0.0000 nr=97 nf=13 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=12.1559 mle=1.8766 pcon=9.6424 forget=0.0000 orth=0.6368 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=12.2644 mle=1.9984 pcon=9.6397 forget=0.0000 orth=0.6263 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=12.1277 mle=1.8745 pcon=9.6373 forget=0.0000 orth=0.6160 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=12.2529 mle=2.0129 pcon=9.6342 forget=0.0000 orth=0.6059 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.3494 mle=2.1224 pcon=9.6310 forget=0.0000 orth=0.5959 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=12.1193 mle=1.9051 pcon=9.6279 forget=0.0000 orth=0.5863 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 10 it 40 total=12.0685 mle=1.8671 pcon=9.6245 forget=0.0000 orth=0.5769 favg=0.0000 nr=109 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.4302 mle=2.2415 pcon=9.6209 forget=0.0000 orth=0.5678 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=12.1224 mle=1.9453 pcon=9.6180 forget=0.0000 orth=0.5591 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=12.1053 mle=1.9405 pcon=9.6142 forget=0.0000 orth=0.5506 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.9785 mle=1.8252 pcon=9.6107 forget=0.0000 orth=0.5426 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.3939 mle=2.2515 pcon=9.6077 forget=0.0000 orth=0.5348 favg=0.0000 nr=93 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=12.0518 mle=1.9194 pcon=9.6053 forget=0.0000 orth=0.5271 favg=0.0000 nr=100 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.3441 mle=2.2224 pcon=9.6019 forget=0.0000 orth=0.5198 favg=0.0000 nr=65 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 11 it 49 total=12.0525 mle=1.9411 pcon=9.5988 forget=0.0000 orth=0.5126 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.2774 mle=2.1768 pcon=9.5949 forget=0.0000 orth=0.5058 favg=0.0000 nr=93 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=12.1723 mle=2.0812 pcon=9.5918 forget=0.0000 orth=0.4992 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=12.0826 mle=2.0018 pcon=9.5880 forget=0.0000 orth=0.4929 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.8236 mle=1.7521 pcon=9.5846 forget=0.0000 orth=0.4868 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=12.1694 mle=2.1073 pcon=9.5812 forget=0.0000 orth=0.4809 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.9325 mle=1.8796 pcon=9.5776 forget=0.0000 orth=0.4752 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 12 it 8 total=12.1514 mle=2.1074 pcon=9.5742 forget=0.0000 orth=0.4698 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=12.0100 mle=1.9754 pcon=9.5701 forget=0.0000 orth=0.4645 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=12.0940 mle=2.0680 pcon=9.5666 forget=0.0000 orth=0.4594 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=12.0019 mle=1.9844 pcon=9.5631 forget=0.0000 orth=0.4545 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.9305 mle=1.9214 pcon=9.5593 forget=0.0000 orth=0.4497 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.2432 mle=2.2420 pcon=9.5561 forget=0.0000 orth=0.4452 favg=0.0000 nr=97 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=12.1373 mle=2.1435 pcon=9.5530 forget=0.0000 orth=0.4408 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=12.0577 mle=2.0709 pcon=9.5502 forget=0.0000 orth=0.4366 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
 70%|███████   | 14/20 [02:33<01:01, 10.32s/it] 75%|███████▌  | 15/20 [02:44<00:52, 10.45s/it] 80%|████████  | 16/20 [02:54<00:41, 10.41s/it] 85%|████████▌ | 17/20 [03:06<00:32, 10.80s/it] 90%|█████████ | 18/20 [03:17<00:21, 10.82s/it] 95%|█████████▌| 19/20 [03:28<00:10, 10.93s/it][loss] ep 13 it 17 total=12.0990 mle=2.1197 pcon=9.5468 forget=0.0000 orth=0.4326 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.9017 mle=1.9295 pcon=9.5435 forget=0.0000 orth=0.4287 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.1758 mle=2.2105 pcon=9.5403 forget=0.0000 orth=0.4249 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=12.0840 mle=2.1263 pcon=9.5364 forget=0.0000 orth=0.4214 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.1303 mle=2.1788 pcon=9.5337 forget=0.0000 orth=0.4179 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=12.0946 mle=2.1495 pcon=9.5305 forget=0.0000 orth=0.4146 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.9527 mle=2.0142 pcon=9.5271 forget=0.0000 orth=0.4115 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=12.0258 mle=2.0944 pcon=9.5229 forget=0.0000 orth=0.4085 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 14 it 26 total=12.1532 mle=2.2275 pcon=9.5201 forget=0.0000 orth=0.4056 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.8660 mle=1.9463 pcon=9.5169 forget=0.0000 orth=0.4028 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.9713 mle=2.0575 pcon=9.5136 forget=0.0000 orth=0.4001 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=12.0688 mle=2.1617 pcon=9.5094 forget=0.0000 orth=0.3976 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.8295 mle=1.9285 pcon=9.5059 forget=0.0000 orth=0.3952 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=12.0633 mle=2.1685 pcon=9.5019 forget=0.0000 orth=0.3929 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.9560 mle=2.0655 pcon=9.4999 forget=0.0000 orth=0.3907 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.7509 mle=1.8656 pcon=9.4968 forget=0.0000 orth=0.3885 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 15 it 35 total=11.9062 mle=2.0261 pcon=9.4935 forget=0.0000 orth=0.3865 favg=0.0000 nr=99 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.9379 mle=2.0628 pcon=9.4905 forget=0.0000 orth=0.3846 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.8260 mle=1.9562 pcon=9.4869 forget=0.0000 orth=0.3828 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.8353 mle=1.9707 pcon=9.4835 forget=0.0000 orth=0.3811 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.9999 mle=2.1401 pcon=9.4803 forget=0.0000 orth=0.3795 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.8636 mle=2.0084 pcon=9.4772 forget=0.0000 orth=0.3780 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=12.0363 mle=2.1858 pcon=9.4740 forget=0.0000 orth=0.3765 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.8264 mle=1.9805 pcon=9.4707 forget=0.0000 orth=0.3751 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 16 it 44 total=12.0408 mle=2.1984 pcon=9.4685 forget=0.0000 orth=0.3739 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.9958 mle=2.1577 pcon=9.4654 forget=0.0000 orth=0.3727 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.8585 mle=2.0246 pcon=9.4623 forget=0.0000 orth=0.3716 favg=0.0000 nr=100 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.7988 mle=1.9696 pcon=9.4587 forget=0.0000 orth=0.3705 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.7888 mle=1.9624 pcon=9.4568 forget=0.0000 orth=0.3696 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.6931 mle=1.8704 pcon=9.4540 forget=0.0000 orth=0.3686 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.8567 mle=2.0382 pcon=9.4507 forget=0.0000 orth=0.3678 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 17 it 3 total=11.6148 mle=1.8003 pcon=9.4475 forget=0.0000 orth=0.3670 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.6210 mle=1.8099 pcon=9.4448 forget=0.0000 orth=0.3663 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.8234 mle=2.0164 pcon=9.4414 forget=0.0000 orth=0.3656 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.6969 mle=1.8926 pcon=9.4393 forget=0.0000 orth=0.3650 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.7438 mle=1.9426 pcon=9.4368 forget=0.0000 orth=0.3644 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.8101 mle=2.0115 pcon=9.4346 forget=0.0000 orth=0.3639 favg=0.0000 nr=101 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.6841 mle=1.8879 pcon=9.4326 forget=0.0000 orth=0.3635 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.7521 mle=1.9596 pcon=9.4294 forget=0.0000 orth=0.3631 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 18 it 12 total=11.8190 mle=2.0299 pcon=9.4264 forget=0.0000 orth=0.3627 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=12.0005 mle=2.2145 pcon=9.4236 forget=0.0000 orth=0.3624 favg=0.0000 nr=98 nf=12 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.6792 mle=1.8951 pcon=9.4220 forget=0.0000 orth=0.3621 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.8889 mle=2.1080 pcon=9.4190 forget=0.0000 orth=0.3619 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.8719 mle=2.0941 pcon=9.4161 forget=0.0000 orth=0.3617 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.7377 mle=1.9626 pcon=9.4136 forget=0.0000 orth=0.3615 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.7465 mle=1.9741 pcon=9.4110 forget=0.0000 orth=0.3614 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.6112 mle=1.8411 pcon=9.4088 forget=0.0000 orth=0.3613 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 19 it 21 total=11.7125 mle=1.9452 pcon=9.4061 forget=0.0000 orth=0.3612 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.8236 mle=2.0585 pcon=9.4040 forget=0.0000 orth=0.3611 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=11.6462 mle=1.8828 pcon=9.4024 forget=0.0000 orth=0.3610 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.7872 mle=2.0259 pcon=9.4003 forget=0.0000 orth=0.3610 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
100%|██████████| 20/20 [03:38<00:00, 10.79s/it]100%|██████████| 20/20 [03:38<00:00, 10.93s/it]
[loss] ep 19 it 221 total=11.7834 mle=2.0239 pcon=9.3985 forget=0.0000 orth=0.3610 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.8593 mle=2.1015 pcon=9.3969 forget=0.0000 orth=0.3610 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.8086 mle=2.0520 pcon=9.3956 forget=0.0000 orth=0.3610 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.7907 mle=2.0357 pcon=9.3941 forget=0.0000 orth=0.3609 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e20-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:46,  2.34it/s]  3%|▎         | 11/391 [00:00<00:14, 26.12it/s]  5%|▌         | 21/391 [00:00<00:08, 44.57it/s]  7%|▋         | 29/391 [00:00<00:06, 52.01it/s]  9%|▉         | 37/391 [00:00<00:06, 52.44it/s] 11%|█▏        | 44/391 [00:01<00:06, 53.83it/s] 13%|█▎        | 52/391 [00:01<00:05, 59.06it/s] 16%|█▌        | 62/391 [00:01<00:04, 68.32it/s] 18%|█▊        | 72/391 [00:01<00:04, 75.64it/s] 21%|██        | 82/391 [00:01<00:03, 81.41it/s] 24%|██▎       | 92/391 [00:01<00:03, 85.57it/s] 26%|██▌       | 102/391 [00:01<00:03, 87.97it/s] 29%|██▊       | 112/391 [00:01<00:03, 86.68it/s] 31%|███       | 121/391 [00:01<00:03, 72.24it/s] 33%|███▎      | 130/391 [00:02<00:03, 74.99it/s] 36%|███▌      | 140/391 [00:02<00:03, 77.14it/s] 38%|███▊      | 148/391 [00:02<00:03, 72.80it/s] 40%|███▉      | 156/391 [00:02<00:03, 65.38it/s] 42%|████▏     | 163/391 [00:02<00:03, 59.25it/s] 43%|████▎     | 170/391 [00:02<00:03, 56.18it/s] 45%|████▌     | 176/391 [00:02<00:04, 51.80it/s] 47%|████▋     | 184/391 [00:03<00:03, 56.98it/s] 49%|████▉     | 191/391 [00:03<00:03, 59.41it/s] 51%|█████▏    | 201/391 [00:03<00:02, 68.62it/s] 54%|█████▍    | 211/391 [00:03<00:02, 75.88it/s] 57%|█████▋    | 221/391 [00:03<00:02, 81.17it/s] 59%|█████▉    | 231/391 [00:03<00:01, 85.24it/s] 62%|██████▏   | 241/391 [00:03<00:01, 88.35it/s] 64%|██████▍   | 251/391 [00:03<00:01, 89.34it/s] 67%|██████▋   | 261/391 [00:03<00:01, 90.57it/s] 69%|██████▉   | 271/391 [00:03<00:01, 91.68it/s] 72%|███████▏  | 281/391 [00:04<00:01, 92.34it/s] 74%|███████▍  | 291/391 [00:04<00:01, 93.18it/s] 77%|███████▋  | 301/391 [00:04<00:00, 93.05it/s] 80%|███████▉  | 311/391 [00:04<00:00, 93.17it/s] 82%|████████▏ | 321/391 [00:04<00:00, 93.58it/s] 85%|████████▍ | 331/391 [00:04<00:00, 94.53it/s] 87%|████████▋ | 341/391 [00:04<00:00, 95.07it/s] 90%|████████▉ | 351/391 [00:04<00:00, 82.22it/s] 92%|█████████▏| 360/391 [00:05<00:00, 75.83it/s] 95%|█████████▍| 370/391 [00:05<00:00, 81.47it/s] 97%|█████████▋| 380/391 [00:05<00:00, 85.86it/s]100%|█████████▉| 390/391 [00:05<00:00, 89.09it/s]100%|██████████| 391/391 [00:05<00:00, 73.14it/s]
50000 images processed, 5.388394355773926 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:07,  1.16it/s] 13%|█▎        | 10/79 [00:00<00:05, 13.66it/s] 25%|██▌       | 20/79 [00:01<00:02, 27.54it/s] 38%|███▊      | 30/79 [00:01<00:01, 40.79it/s] 51%|█████     | 40/79 [00:01<00:00, 52.48it/s] 63%|██████▎   | 50/79 [00:01<00:00, 62.55it/s] 76%|███████▌  | 60/79 [00:01<00:00, 71.21it/s] 89%|████████▊ | 70/79 [00:01<00:00, 77.99it/s]100%|██████████| 79/79 [00:01<00:00, 46.12it/s]
10000 images processed, 1.731126070022583 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:38,  2.05it/s]  5%|▌         | 11/204 [00:00<00:08, 23.85it/s] 10%|█         | 21/204 [00:00<00:04, 41.34it/s] 15%|█▌        | 31/204 [00:00<00:03, 55.24it/s] 20%|██        | 41/204 [00:00<00:02, 64.15it/s] 25%|██▍       | 50/204 [00:01<00:02, 65.68it/s] 28%|██▊       | 58/204 [00:01<00:02, 62.58it/s] 33%|███▎      | 67/204 [00:01<00:01, 69.37it/s] 38%|███▊      | 77/204 [00:01<00:01, 75.94it/s] 43%|████▎     | 87/204 [00:01<00:01, 80.67it/s] 47%|████▋     | 96/204 [00:01<00:01, 69.37it/s] 52%|█████▏    | 106/204 [00:01<00:01, 75.47it/s] 57%|█████▋    | 116/204 [00:01<00:01, 79.93it/s] 62%|██████▏   | 126/204 [00:02<00:00, 83.70it/s] 67%|██████▋   | 136/204 [00:02<00:00, 86.68it/s] 71%|███████   | 145/204 [00:02<00:00, 62.82it/s] 75%|███████▌  | 153/204 [00:02<00:00, 62.31it/s] 80%|███████▉  | 163/204 [00:02<00:00, 69.36it/s] 84%|████████▍ | 171/204 [00:02<00:00, 65.74it/s] 88%|████████▊ | 180/204 [00:02<00:00, 70.95it/s] 93%|█████████▎| 190/204 [00:02<00:00, 77.73it/s] 98%|█████████▊| 199/204 [00:03<00:00, 78.27it/s]100%|██████████| 204/204 [00:03<00:00, 63.97it/s]
26032 images processed, 3.230524778366089 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:02,  1.26it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.14it/s] 27%|██▋       | 21/79 [00:01<00:01, 30.52it/s] 38%|███▊      | 30/79 [00:01<00:01, 42.33it/s] 51%|█████     | 40/79 [00:01<00:00, 54.27it/s] 63%|██████▎   | 50/79 [00:01<00:00, 64.18it/s] 76%|███████▌  | 60/79 [00:01<00:00, 72.44it/s] 89%|████████▊ | 70/79 [00:01<00:00, 77.51it/s]100%|██████████| 79/79 [00:01<00:00, 48.24it/s]
10000 images processed, 1.695871114730835 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.67it/s]  5%|▌         | 4/79 [00:00<00:10,  7.02it/s] 18%|█▊        | 14/79 [00:00<00:02, 26.60it/s] 30%|███       | 24/79 [00:00<00:01, 43.06it/s] 43%|████▎     | 34/79 [00:01<00:00, 56.36it/s] 56%|█████▌    | 44/79 [00:01<00:00, 66.54it/s] 68%|██████▊   | 54/79 [00:01<00:00, 74.67it/s] 81%|████████  | 64/79 [00:01<00:00, 80.80it/s] 94%|█████████▎| 74/79 [00:01<00:00, 85.46it/s]100%|██████████| 79/79 [00:01<00:00, 53.27it/s]
10000 images processed, 1.5053987503051758 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:54,  1.27it/s] 14%|█▍        | 10/70 [00:00<00:04, 14.76it/s] 24%|██▍       | 17/70 [00:00<00:02, 24.60it/s] 34%|███▍      | 24/70 [00:01<00:01, 33.12it/s] 46%|████▌     | 32/70 [00:01<00:00, 42.98it/s] 56%|█████▌    | 39/70 [00:01<00:00, 47.66it/s] 66%|██████▌   | 46/70 [00:01<00:00, 51.52it/s] 77%|███████▋  | 54/70 [00:01<00:00, 57.41it/s] 90%|█████████ | 63/70 [00:01<00:00, 63.71it/s]100%|██████████| 70/70 [00:01<00:00, 39.53it/s]
8925 images processed, 1.8667290210723877 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:43,  1.02it/s]  7%|▋         | 3/45 [00:01<00:13,  3.22it/s] 29%|██▉       | 13/45 [00:01<00:01, 17.15it/s] 40%|████      | 18/45 [00:01<00:01, 16.19it/s] 49%|████▉     | 22/45 [00:01<00:01, 14.79it/s] 71%|███████   | 32/45 [00:02<00:00, 25.83it/s] 82%|████████▏ | 37/45 [00:02<00:00, 19.47it/s]100%|██████████| 45/45 [00:02<00:00, 17.76it/s]
5640 images processed, 2.555241346359253 seconds used

20.354199171066284
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.59  99.03  90.11
places365     69.06  82.20  52.73
LSUN          34.96  92.68  78.83
iSUN          48.18  90.23  75.95
dtd           23.37  94.61  87.28
AVG           36.03  91.75  76.98
[incremental] Overall: 0.6280 New: 0.6380 Old: 0.6247
[incremental] Final(Top-1): 0.6280  Average: 0.7197
10.686207056045532
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:41,  1.89it/s] 14%|█▍        | 11/79 [00:00<00:03, 22.45it/s] 27%|██▋       | 21/79 [00:00<00:01, 39.73it/s] 39%|███▉      | 31/79 [00:00<00:00, 53.66it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.08it/s] 65%|██████▍   | 51/79 [00:01<00:00, 72.24it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.97it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.58it/s]100%|██████████| 79/79 [00:01<00:00, 58.58it/s]
10000 images processed, 1.3690557479858398 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.76it/s] 13%|█▎        | 9/70 [00:00<00:03, 17.42it/s] 27%|██▋       | 19/70 [00:00<00:01, 35.08it/s] 40%|████      | 28/70 [00:00<00:00, 47.91it/s] 51%|█████▏    | 36/70 [00:00<00:00, 54.90it/s] 66%|██████▌   | 46/70 [00:01<00:00, 66.00it/s] 80%|████████  | 56/70 [00:01<00:00, 74.46it/s] 94%|█████████▍| 66/70 [00:01<00:00, 80.78it/s]100%|██████████| 70/70 [00:01<00:00, 51.74it/s]
8925 images processed, 1.3914594650268555 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:49,  1.13s/it]  4%|▍         | 2/45 [00:01<00:25,  1.69it/s] 22%|██▏       | 10/45 [00:01<00:03, 11.39it/s] 38%|███▊      | 17/45 [00:01<00:01, 16.85it/s] 47%|████▋     | 21/45 [00:02<00:01, 14.42it/s] 69%|██████▉   | 31/45 [00:02<00:00, 25.74it/s] 82%|████████▏ | 37/45 [00:02<00:00, 16.89it/s]100%|██████████| 45/45 [00:02<00:00, 15.66it/s]
5640 images processed, 2.895551919937134 seconds used

19.459333419799805
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.59  99.03  90.11
places365     69.06  82.20  52.73
LSUN          34.96  92.68  78.83
iSUN          48.18  90.23  75.95
dtd           23.37  94.61  87.28
AVG           36.03  91.75  76.98
[incremental] Overall: 0.6280 New: 0.6380 Old: 0.6247
[incremental] Final(Top-1): 0.6280  Average: 0.7197
6.773887395858765
[DEBUG] Parsed: avg_fpr=36.03 avg_auroc=91.75 final_top1=0.6280 average=0.7197
[Result] AVG-AUROC=91.75 AVG-FPR=36.03 Final-Top1=0.6280 Average=0.7197 Score=72.62

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=25 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=25, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/25 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  4%|▍         | 1/25 [00:16<06:35, 16.46s/it]  8%|▊         | 2/25 [00:24<04:18, 11.22s/it] 12%|█▏        | 3/25 [00:31<03:30,  9.58s/it] 16%|█▌        | 4/25 [00:39<03:05,  8.83s/it] 20%|██        | 5/25 [00:46<02:46,  8.35s/it] 24%|██▍       | 6/25 [00:54<02:33,  8.05s/it][loss] ep 0 it 0 total=8.5896 mle=3.2130 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6440 mle=3.2647 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0878 mle=3.7056 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6781 mle=3.2933 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9793 mle=2.5921 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9918 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4733 mle=4.0810 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4954 mle=3.1006 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5368 mle=3.1398 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2412 mle=2.8416 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7243 mle=3.3224 pcon=5.4018 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0962 mle=3.6917 pcon=5.4045 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4461 mle=4.0389 pcon=5.4072 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3581 mle=2.9487 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0700 mle=3.6581 pcon=5.4119 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5543 mle=3.1402 pcon=5.4141 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5076 mle=3.0907 pcon=5.4169 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6318 mle=3.2130 pcon=5.4188 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2431 mle=2.8212 pcon=5.4219 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4327 mle=3.0084 pcon=5.4243 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7374 mle=2.3105 pcon=5.4269 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6784 mle=3.2491 pcon=5.4293 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8372 mle=3.4054 pcon=5.4318 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7150 mle=2.2805 pcon=5.4344 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.2999 mle=2.8637 pcon=5.4362 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4255 mle=2.9875 pcon=5.4380 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1014 mle=2.6615 pcon=5.4399 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9326 mle=2.4910 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6430 mle=2.2004 pcon=5.4426 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6505 mle=2.2064 pcon=5.4441 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6233 mle=2.1786 pcon=5.4447 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6685 mle=2.2230 pcon=5.4455 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6921 mle=2.2453 pcon=5.4467 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6982 mle=2.2504 pcon=5.4478 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7878 mle=2.3394 pcon=5.4484 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4444 mle=1.9941 pcon=5.4503 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4890 mle=2.0369 pcon=5.4521 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4848 mle=2.0301 pcon=5.4547 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9107 mle=2.4539 pcon=5.4568 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4956 mle=2.0363 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 5 it 45 total=7.5989 mle=2.1381 pcon=5.4608 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.5304 mle=2.0672 pcon=5.4632 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.5471 mle=2.0820 pcon=5.4651 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.6396 mle=2.1721 pcon=5.4675 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.6794 mle=2.2099 pcon=5.4696 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.3913 mle=1.9190 pcon=5.4723 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7725 mle=2.2974 pcon=5.4751 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 6 it 4 total=7.6266 mle=2.1491 pcon=5.4775 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.7450 mle=2.2648 pcon=5.4803 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.5335 mle=2.0507 pcon=5.4829 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.3493 mle=1.8648 pcon=5.4845 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.5080 mle=2.0202 pcon=5.4878 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
 28%|██▊       | 7/25 [01:01<02:21,  7.88s/it] 32%|███▏      | 8/25 [01:09<02:12,  7.78s/it] 36%|███▌      | 9/25 [01:16<02:02,  7.68s/it] 40%|████      | 10/25 [01:24<01:54,  7.61s/it] 44%|████▍     | 11/25 [01:31<01:45,  7.55s/it] 48%|████▊     | 12/25 [01:39<01:38,  7.60s/it] 52%|█████▏    | 13/25 [01:47<01:31,  7.61s/it] 56%|█████▌    | 14/25 [01:54<01:23,  7.62s/it][loss] ep 6 it 254 total=7.5028 mle=2.0120 pcon=5.4908 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.9122 mle=2.4184 pcon=5.4938 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.4512 mle=1.9541 pcon=5.4971 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 13 total=7.7897 mle=2.2891 pcon=5.5007 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.9124 mle=2.4083 pcon=5.5041 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.7382 mle=2.2307 pcon=5.5075 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.8009 mle=2.2897 pcon=5.5112 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.5635 mle=2.0493 pcon=5.5142 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.6841 mle=2.1656 pcon=5.5184 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.5467 mle=2.0250 pcon=5.5217 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.6895 mle=2.1638 pcon=5.5257 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 22 total=7.6966 mle=2.1675 pcon=5.5292 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.5198 mle=1.9874 pcon=5.5323 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.3987 mle=1.8634 pcon=5.5353 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=7.3096 mle=1.7705 pcon=5.5391 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=7.3353 mle=1.7922 pcon=5.5431 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.5151 mle=1.9686 pcon=5.5465 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=7.5380 mle=1.9882 pcon=5.5498 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=7.7814 mle=2.2278 pcon=5.5536 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 31 total=7.9267 mle=2.3703 pcon=5.5564 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=7.6420 mle=2.0821 pcon=5.5599 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=7.4833 mle=1.9206 pcon=5.5627 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=7.6007 mle=2.0348 pcon=5.5659 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=7.5364 mle=1.9669 pcon=5.5695 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=7.5923 mle=2.0192 pcon=5.5730 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=7.6971 mle=2.1210 pcon=5.5761 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=7.5188 mle=1.9395 pcon=5.5792 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 40 total=7.4384 mle=1.8567 pcon=5.5817 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=7.9046 mle=2.3205 pcon=5.5841 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=7.5870 mle=2.0000 pcon=5.5870 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=7.5867 mle=1.9968 pcon=5.5899 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=7.4325 mle=1.8404 pcon=5.5921 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=7.8546 mle=2.2593 pcon=5.5953 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=7.5766 mle=1.9792 pcon=5.5974 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=7.8366 mle=2.2362 pcon=5.6005 forget=0.0000 orth=0.0000 favg=0.0000 nr=77 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 49 total=7.5662 mle=1.9626 pcon=5.6037 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=7.9000 mle=2.2934 pcon=5.6066 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=7.7697 mle=2.1603 pcon=5.6094 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=7.6113 mle=1.9988 pcon=5.6125 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=7.4135 mle=1.7979 pcon=5.6156 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=7.7318 mle=2.1136 pcon=5.6183 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=7.4547 mle=1.8342 pcon=5.6205 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 8 total=7.8478 mle=2.2249 pcon=5.6229 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=7.6101 mle=1.9848 pcon=5.6253 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=7.8280 mle=2.2000 pcon=5.6280 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=7.5992 mle=1.9683 pcon=5.6309 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=7.6265 mle=1.9931 pcon=5.6334 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=7.9021 mle=2.2661 pcon=5.6361 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=7.7431 mle=2.1050 pcon=5.6381 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=7.7907 mle=2.1501 pcon=5.6406 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 17 total=7.8738 mle=2.2307 pcon=5.6432 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=7.6741 mle=2.0285 pcon=5.6456 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=7.9262 mle=2.2790 pcon=5.6473 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=7.7542 mle=2.1051 pcon=5.6492 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=7.9477 mle=2.2971 pcon=5.6506 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=7.8503 mle=2.1975 pcon=5.6528 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=7.7402 mle=2.0854 pcon=5.6548 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=7.7598 mle=2.1023 pcon=5.6575 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 26 total=7.9678 mle=2.3087 pcon=5.6591 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=7.7013 mle=2.0405 pcon=5.6607 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=7.7290 mle=2.0669 pcon=5.6621 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=7.8701 mle=2.2066 pcon=5.6635 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
 60%|██████    | 15/25 [02:02<01:15,  7.58s/it] 64%|██████▍   | 16/25 [02:09<01:08,  7.56s/it] 68%|██████▊   | 17/25 [02:17<01:00,  7.54s/it] 72%|███████▏  | 18/25 [02:24<00:53,  7.59s/it] 76%|███████▌  | 19/25 [02:32<00:45,  7.58s/it] 80%|████████  | 20/25 [02:40<00:38,  7.76s/it] 84%|████████▍ | 21/25 [02:48<00:30,  7.65s/it] 88%|████████▊ | 22/25 [02:55<00:22,  7.58s/it][loss] ep 14 it 226 total=7.6124 mle=1.9470 pcon=5.6654 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=7.8316 mle=2.1639 pcon=5.6676 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=7.7767 mle=2.1075 pcon=5.6692 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=7.5915 mle=1.9207 pcon=5.6708 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 15 it 35 total=7.8063 mle=2.1338 pcon=5.6726 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=7.7876 mle=2.1130 pcon=5.6747 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=7.6458 mle=1.9696 pcon=5.6762 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=7.6461 mle=1.9688 pcon=5.6773 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=7.8565 mle=2.1783 pcon=5.6782 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=7.7268 mle=2.0471 pcon=5.6796 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=7.9088 mle=2.2280 pcon=5.6808 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=7.6826 mle=2.0002 pcon=5.6824 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 44 total=7.8808 mle=2.1974 pcon=5.6834 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=7.8317 mle=2.1467 pcon=5.6850 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=7.7399 mle=2.0539 pcon=5.6860 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=7.7389 mle=2.0519 pcon=5.6871 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=7.6686 mle=1.9802 pcon=5.6884 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=7.5885 mle=1.8992 pcon=5.6894 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=7.7540 mle=2.0642 pcon=5.6898 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 3 total=7.4747 mle=1.7836 pcon=5.6911 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=7.5405 mle=1.8484 pcon=5.6922 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=7.7285 mle=2.0352 pcon=5.6933 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=7.5298 mle=1.8353 pcon=5.6945 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=7.6405 mle=1.9451 pcon=5.6954 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=7.7576 mle=2.0618 pcon=5.6957 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=7.6411 mle=1.9447 pcon=5.6963 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=7.6502 mle=1.9532 pcon=5.6970 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 12 total=7.6845 mle=1.9868 pcon=5.6977 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=7.9831 mle=2.2852 pcon=5.6979 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=7.6376 mle=1.9393 pcon=5.6983 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=7.7798 mle=2.0811 pcon=5.6987 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=7.8532 mle=2.1540 pcon=5.6992 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=7.6937 mle=1.9944 pcon=5.6993 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=7.6248 mle=1.9249 pcon=5.6999 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=7.5046 mle=1.8043 pcon=5.7003 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 21 total=7.6789 mle=1.9781 pcon=5.7008 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=7.7467 mle=2.0453 pcon=5.7014 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=7.6618 mle=1.9605 pcon=5.7013 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=7.7416 mle=2.0398 pcon=5.7018 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=7.7538 mle=2.0514 pcon=5.7024 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=7.9300 mle=2.2273 pcon=5.7026 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=7.8501 mle=2.1469 pcon=5.7031 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=7.7639 mle=2.0607 pcon=5.7032 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 30 total=7.8589 mle=2.1552 pcon=5.7038 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=7.6196 mle=1.9152 pcon=5.7044 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=7.7832 mle=2.0788 pcon=5.7044 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=7.8450 mle=2.1394 pcon=5.7056 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=7.5456 mle=1.8398 pcon=5.7058 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=7.7856 mle=2.0806 pcon=5.7050 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=8.0195 mle=2.3138 pcon=5.7057 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=7.9887 mle=2.2822 pcon=5.7064 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 39 total=7.7993 mle=2.0934 pcon=5.7059 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=7.6040 mle=1.8974 pcon=5.7066 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=7.7217 mle=2.0151 pcon=5.7066 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=7.5565 mle=1.8495 pcon=5.7070 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=7.8915 mle=2.1848 pcon=5.7067 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=7.6439 mle=1.9370 pcon=5.7069 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=7.6733 mle=1.9659 pcon=5.7075 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=7.9114 mle=2.2037 pcon=5.7077 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 48 total=7.8679 mle=2.1596 pcon=5.7084 forget=0.0000 orth=0.0000 favg=0.0000 nr=115 nf=13 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=7.7639 mle=2.0554 pcon=5.7085 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=7.7572 mle=2.0484 pcon=5.7088 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
 92%|█████████▏| 23/25 [03:03<00:15,  7.69s/it] 96%|█████████▌| 24/25 [03:10<00:07,  7.59s/it]100%|██████████| 25/25 [03:18<00:00,  7.53s/it]100%|██████████| 25/25 [03:18<00:00,  7.93s/it]
[loss] ep 22 it 198 total=7.6590 mle=1.9495 pcon=5.7095 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=7.8129 mle=2.1029 pcon=5.7101 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=7.8242 mle=2.1145 pcon=5.7096 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=7.8950 mle=2.1854 pcon=5.7096 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 7 total=7.7798 mle=2.0705 pcon=5.7093 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=7.8079 mle=2.0981 pcon=5.7098 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=7.5010 mle=1.7909 pcon=5.7101 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=8.0711 mle=2.3615 pcon=5.7096 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=7.8499 mle=2.1398 pcon=5.7101 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=7.7933 mle=2.0827 pcon=5.7106 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=7.8204 mle=2.1095 pcon=5.7110 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=7.6570 mle=1.9465 pcon=5.7104 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 16 total=7.8836 mle=2.1738 pcon=5.7098 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=7.6940 mle=1.9843 pcon=5.7097 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=7.8702 mle=2.1601 pcon=5.7101 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=7.8660 mle=2.1561 pcon=5.7099 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=7.6129 mle=1.9035 pcon=5.7095 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=7.7639 mle=2.0545 pcon=5.7094 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=7.7350 mle=2.0250 pcon=5.7100 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=8.1029 mle=2.3924 pcon=5.7105 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:01<09:14,  1.42s/it]  1%|          | 3/391 [00:01<02:45,  2.34it/s]  2%|▏         | 6/391 [00:01<01:14,  5.14it/s]  3%|▎         | 12/391 [00:01<00:31, 12.16it/s]  4%|▍         | 17/391 [00:01<00:21, 17.48it/s]  6%|▌         | 23/391 [00:02<00:15, 24.33it/s]  8%|▊         | 30/391 [00:02<00:11, 32.63it/s] 10%|▉         | 38/391 [00:02<00:08, 42.69it/s] 12%|█▏        | 48/391 [00:02<00:06, 55.52it/s] 15%|█▍        | 58/391 [00:02<00:05, 65.12it/s] 17%|█▋        | 68/391 [00:02<00:04, 72.25it/s] 20%|█▉        | 78/391 [00:02<00:04, 77.59it/s] 22%|██▏       | 87/391 [00:02<00:03, 80.78it/s] 25%|██▍       | 97/391 [00:02<00:03, 84.69it/s] 27%|██▋       | 107/391 [00:03<00:03, 87.63it/s] 30%|██▉       | 117/391 [00:03<00:03, 89.26it/s] 32%|███▏      | 127/391 [00:03<00:02, 90.27it/s] 35%|███▌      | 137/391 [00:03<00:02, 91.26it/s] 38%|███▊      | 147/391 [00:03<00:02, 92.08it/s] 40%|████      | 157/391 [00:03<00:02, 93.05it/s] 43%|████▎     | 167/391 [00:03<00:02, 93.61it/s] 45%|████▌     | 177/391 [00:03<00:02, 93.60it/s] 48%|████▊     | 187/391 [00:03<00:02, 93.54it/s] 50%|█████     | 197/391 [00:03<00:02, 93.85it/s] 53%|█████▎    | 207/391 [00:04<00:01, 93.72it/s] 55%|█████▌    | 217/391 [00:04<00:01, 94.07it/s] 58%|█████▊    | 227/391 [00:04<00:01, 94.01it/s] 61%|██████    | 237/391 [00:04<00:01, 94.10it/s] 63%|██████▎   | 247/391 [00:04<00:01, 94.62it/s] 66%|██████▌   | 257/391 [00:04<00:01, 94.92it/s] 68%|██████▊   | 267/391 [00:04<00:01, 95.18it/s] 71%|███████   | 277/391 [00:04<00:01, 94.87it/s] 73%|███████▎  | 287/391 [00:04<00:01, 95.27it/s] 76%|███████▌  | 297/391 [00:05<00:00, 95.24it/s] 79%|███████▊  | 307/391 [00:05<00:00, 95.31it/s] 81%|████████  | 317/391 [00:05<00:00, 95.19it/s] 84%|████████▎ | 327/391 [00:05<00:00, 95.66it/s] 86%|████████▌ | 337/391 [00:05<00:00, 95.22it/s] 89%|████████▊ | 347/391 [00:05<00:00, 94.77it/s] 91%|█████████▏| 357/391 [00:05<00:00, 93.58it/s] 94%|█████████▍| 367/391 [00:05<00:00, 94.18it/s] 96%|█████████▋| 377/391 [00:05<00:00, 95.16it/s] 99%|█████████▉| 387/391 [00:05<00:00, 95.84it/s]100%|██████████| 391/391 [00:06<00:00, 64.73it/s]
50000 images processed, 6.093323469161987 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.01it/s]  9%|▉         | 7/79 [00:00<00:05, 14.20it/s] 15%|█▌        | 12/79 [00:00<00:03, 22.21it/s] 27%|██▋       | 21/79 [00:00<00:01, 38.92it/s] 37%|███▋      | 29/79 [00:00<00:01, 49.36it/s] 46%|████▌     | 36/79 [00:01<00:00, 51.65it/s] 56%|█████▌    | 44/79 [00:01<00:00, 57.63it/s] 65%|██████▍   | 51/79 [00:01<00:00, 58.13it/s] 73%|███████▎  | 58/79 [00:01<00:00, 56.71it/s] 82%|████████▏ | 65/79 [00:01<00:00, 53.93it/s] 92%|█████████▏| 73/79 [00:01<00:00, 60.34it/s]100%|██████████| 79/79 [00:02<00:00, 36.76it/s]
10000 images processed, 2.1631975173950195 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:33,  2.17it/s]  5%|▌         | 11/204 [00:00<00:07, 24.82it/s] 10%|█         | 21/204 [00:00<00:04, 42.95it/s] 15%|█▌        | 31/204 [00:00<00:03, 56.41it/s] 20%|█▉        | 40/204 [00:00<00:02, 60.64it/s] 24%|██▎       | 48/204 [00:01<00:02, 56.35it/s] 27%|██▋       | 55/204 [00:01<00:02, 59.62it/s] 32%|███▏      | 65/204 [00:01<00:02, 68.33it/s] 37%|███▋      | 75/204 [00:01<00:01, 75.37it/s] 42%|████▏     | 85/204 [00:01<00:01, 81.00it/s] 47%|████▋     | 95/204 [00:01<00:01, 84.89it/s] 51%|█████▏    | 105/204 [00:01<00:01, 87.66it/s] 56%|█████▋    | 115/204 [00:01<00:00, 89.51it/s] 61%|██████▏   | 125/204 [00:01<00:00, 82.19it/s] 66%|██████▌   | 134/204 [00:02<00:00, 70.47it/s] 70%|██████▉   | 142/204 [00:02<00:00, 66.65it/s] 73%|███████▎  | 149/204 [00:02<00:00, 55.99it/s] 76%|███████▋  | 156/204 [00:02<00:00, 59.02it/s] 80%|███████▉  | 163/204 [00:02<00:00, 55.05it/s] 83%|████████▎ | 169/204 [00:02<00:00, 51.52it/s] 86%|████████▌ | 175/204 [00:02<00:00, 51.31it/s] 91%|█████████ | 185/204 [00:03<00:00, 62.64it/s] 96%|█████████▌| 195/204 [00:03<00:00, 71.56it/s]100%|██████████| 204/204 [00:03<00:00, 62.40it/s]
26032 images processed, 3.3061254024505615 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.57it/s] 10%|█         | 8/79 [00:00<00:06, 11.48it/s] 23%|██▎       | 18/79 [00:00<00:02, 26.70it/s] 35%|███▌      | 28/79 [00:01<00:01, 40.84it/s] 47%|████▋     | 37/79 [00:01<00:00, 51.40it/s] 57%|█████▋    | 45/79 [00:01<00:00, 43.91it/s] 70%|██████▉   | 55/79 [00:01<00:00, 54.88it/s] 80%|███████▉  | 63/79 [00:01<00:00, 60.35it/s] 91%|█████████ | 72/79 [00:01<00:00, 66.10it/s]100%|██████████| 79/79 [00:01<00:00, 43.02it/s]
10000 images processed, 2.010366201400757 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.77it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.36it/s] 27%|██▋       | 21/79 [00:00<00:01, 38.45it/s] 37%|███▋      | 29/79 [00:00<00:01, 48.08it/s] 47%|████▋     | 37/79 [00:01<00:00, 43.10it/s] 58%|█████▊    | 46/79 [00:01<00:00, 53.22it/s] 71%|███████   | 56/79 [00:01<00:00, 62.81it/s] 84%|████████▎ | 66/79 [00:01<00:00, 71.48it/s] 96%|█████████▌| 76/79 [00:01<00:00, 78.28it/s]100%|██████████| 79/79 [00:01<00:00, 51.37it/s]
10000 images processed, 1.5547471046447754 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<01:08,  1.01it/s] 10%|█         | 7/70 [00:01<00:07,  8.47it/s] 24%|██▍       | 17/70 [00:01<00:02, 22.28it/s] 39%|███▊      | 27/70 [00:01<00:01, 35.78it/s] 53%|█████▎    | 37/70 [00:01<00:00, 48.24it/s] 67%|██████▋   | 47/70 [00:01<00:00, 59.13it/s] 81%|████████▏ | 57/70 [00:01<00:00, 68.41it/s] 96%|█████████▌| 67/70 [00:01<00:00, 75.72it/s]100%|██████████| 70/70 [00:01<00:00, 39.97it/s]
8925 images processed, 1.7822160720825195 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.07it/s]  4%|▍         | 2/45 [00:01<00:21,  2.03it/s] 18%|█▊        | 8/45 [00:01<00:03, 10.46it/s] 31%|███       | 14/45 [00:01<00:01, 18.25it/s] 40%|████      | 18/45 [00:01<00:01, 17.02it/s] 47%|████▋     | 21/45 [00:01<00:01, 14.38it/s] 69%|██████▉   | 31/45 [00:02<00:00, 27.50it/s] 80%|████████  | 36/45 [00:02<00:00, 22.26it/s]100%|██████████| 45/45 [00:02<00:00, 18.46it/s]
5640 images processed, 2.454554319381714 seconds used

21.043789863586426
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.60
places365     49.91  89.49  51.36
LSUN          25.93  95.19  76.04
iSUN          26.01  95.03  73.73
dtd           24.68  94.43  71.73
AVG           26.02  94.64  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
4.973032236099243
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=25, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/25 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  4%|▍         | 1/25 [00:17<07:08, 17.84s/it]  8%|▊         | 2/25 [00:28<05:19, 13.88s/it] 12%|█▏        | 3/25 [00:39<04:34, 12.49s/it] 16%|█▌        | 4/25 [00:51<04:12, 12.05s/it] 20%|██        | 5/25 [01:02<03:55, 11.76s/it] 24%|██▍       | 6/25 [01:13<03:39, 11.53s/it][loss] ep 0 it 0 total=12.0912 mle=2.3149 pcon=8.7277 forget=0.0000 orth=1.0486 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0666 mle=2.2863 pcon=8.7318 forget=0.0000 orth=1.0485 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2136 mle=2.4299 pcon=8.7353 forget=0.0000 orth=1.0484 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1215 mle=2.3346 pcon=8.7388 forget=0.0000 orth=1.0482 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7749 mle=1.9852 pcon=8.7417 forget=0.0000 orth=1.0479 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=11.9872 mle=2.1952 pcon=8.7444 forget=0.0000 orth=1.0477 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4181 mle=2.6241 pcon=8.7466 forget=0.0000 orth=1.0474 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9928 mle=2.1974 pcon=8.7483 forget=0.0000 orth=1.0471 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9502 mle=2.1530 pcon=8.7504 forget=0.0000 orth=1.0467 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9382 mle=2.1395 pcon=8.7524 forget=0.0000 orth=1.0463 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0896 mle=2.2897 pcon=8.7539 forget=0.0000 orth=1.0459 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3273 mle=2.5262 pcon=8.7557 forget=0.0000 orth=1.0454 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2575 mle=2.4556 pcon=8.7568 forget=0.0000 orth=1.0450 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.8904 mle=2.0880 pcon=8.7580 forget=0.0000 orth=1.0445 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.1923 mle=2.3892 pcon=8.7592 forget=0.0000 orth=1.0439 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0807 mle=2.2771 pcon=8.7603 forget=0.0000 orth=1.0433 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0151 mle=2.2115 pcon=8.7610 forget=0.0000 orth=1.0425 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0754 mle=2.2714 pcon=8.7622 forget=0.0000 orth=1.0418 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9125 mle=2.1077 pcon=8.7637 forget=0.0000 orth=1.0411 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9621 mle=2.1571 pcon=8.7647 forget=0.0000 orth=1.0403 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5838 mle=1.7782 pcon=8.7659 forget=0.0000 orth=1.0396 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1267 mle=2.3214 pcon=8.7665 forget=0.0000 orth=1.0388 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1813 mle=2.3760 pcon=8.7674 forget=0.0000 orth=1.0379 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6932 mle=1.8874 pcon=8.7688 forget=0.0000 orth=1.0370 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0743 mle=2.2691 pcon=8.7691 forget=0.0000 orth=1.0360 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1935 mle=2.3885 pcon=8.7702 forget=0.0000 orth=1.0349 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1311 mle=2.3261 pcon=8.7710 forget=0.0000 orth=1.0339 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0203 mle=2.2152 pcon=8.7722 forget=0.0000 orth=1.0329 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9361 mle=2.1308 pcon=8.7734 forget=0.0000 orth=1.0318 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9650 mle=2.1600 pcon=8.7744 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9502 mle=2.1456 pcon=8.7752 forget=0.0000 orth=1.0293 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.0057 mle=2.2017 pcon=8.7759 forget=0.0000 orth=1.0281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0138 mle=2.2096 pcon=8.7774 forget=0.0000 orth=1.0268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0256 mle=2.2212 pcon=8.7786 forget=0.0000 orth=1.0259 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1450 mle=2.3407 pcon=8.7796 forget=0.0000 orth=1.0247 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8310 mle=2.0272 pcon=8.7803 forget=0.0000 orth=1.0234 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8796 mle=2.0765 pcon=8.7811 forget=0.0000 orth=1.0219 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8366 mle=2.0334 pcon=8.7826 forget=0.0000 orth=1.0206 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1785 mle=2.3752 pcon=8.7837 forget=0.0000 orth=1.0196 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.8034 mle=2.0002 pcon=8.7849 forget=0.0000 orth=1.0184 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 5 it 45 total=11.9762 mle=2.1737 pcon=8.7855 forget=0.0000 orth=1.0170 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=11.8751 mle=2.0728 pcon=8.7868 forget=0.0000 orth=1.0154 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=11.9057 mle=2.1040 pcon=8.7875 forget=0.0000 orth=1.0142 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=11.9913 mle=2.1897 pcon=8.7889 forget=0.0000 orth=1.0127 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.0462 mle=2.2446 pcon=8.7902 forget=0.0000 orth=1.0114 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=11.7277 mle=1.9258 pcon=8.7920 forget=0.0000 orth=1.0100 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.1235 mle=2.3212 pcon=8.7937 forget=0.0000 orth=1.0086 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 6 it 4 total=11.9787 mle=2.1770 pcon=8.7944 forget=0.0000 orth=1.0074 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.0672 mle=2.2650 pcon=8.7961 forget=0.0000 orth=1.0061 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.8460 mle=2.0435 pcon=8.7979 forget=0.0000 orth=1.0046 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.6711 mle=1.8691 pcon=8.7987 forget=0.0000 orth=1.0032 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
 28%|██▊       | 7/25 [01:24<03:25, 11.44s/it] 32%|███▏      | 8/25 [01:36<03:15, 11.51s/it] 36%|███▌      | 9/25 [01:47<03:02, 11.42s/it] 40%|████      | 10/25 [01:58<02:47, 11.16s/it] 44%|████▍     | 11/25 [02:09<02:34, 11.05s/it] 48%|████▊     | 12/25 [02:19<02:23, 11.02s/it][loss] ep 6 it 204 total=11.8446 mle=2.0433 pcon=8.7997 forget=0.0000 orth=1.0016 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.8536 mle=2.0525 pcon=8.8008 forget=0.0000 orth=1.0003 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2112 mle=2.4096 pcon=8.8025 forget=0.0000 orth=0.9991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.7708 mle=1.9692 pcon=8.8039 forget=0.0000 orth=0.9977 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 7 it 13 total=12.1378 mle=2.3356 pcon=8.8057 forget=0.0000 orth=0.9965 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2206 mle=2.4182 pcon=8.8072 forget=0.0000 orth=0.9952 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0887 mle=2.2862 pcon=8.8087 forget=0.0000 orth=0.9937 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1133 mle=2.3102 pcon=8.8107 forget=0.0000 orth=0.9924 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9123 mle=2.1098 pcon=8.8114 forget=0.0000 orth=0.9911 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9888 mle=2.1854 pcon=8.8136 forget=0.0000 orth=0.9898 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8655 mle=2.0616 pcon=8.8154 forget=0.0000 orth=0.9885 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0133 mle=2.2090 pcon=8.8172 forget=0.0000 orth=0.9870 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 8 it 22 total=11.9791 mle=2.1748 pcon=8.8183 forget=0.0000 orth=0.9860 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8126 mle=2.0083 pcon=8.8198 forget=0.0000 orth=0.9845 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7031 mle=1.8991 pcon=8.8210 forget=0.0000 orth=0.9831 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5987 mle=1.7944 pcon=8.8225 forget=0.0000 orth=0.9818 favg=0.0000 nr=124 nf=1 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6304 mle=1.8260 pcon=8.8241 forget=0.0000 orth=0.9803 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.7915 mle=1.9875 pcon=8.8249 forget=0.0000 orth=0.9791 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8222 mle=2.0181 pcon=8.8264 forget=0.0000 orth=0.9777 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0348 mle=2.2300 pcon=8.8285 forget=0.0000 orth=0.9763 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 9 it 31 total=12.1873 mle=2.3826 pcon=8.8300 forget=0.0000 orth=0.9748 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9306 mle=2.1262 pcon=8.8308 forget=0.0000 orth=0.9736 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7376 mle=1.9341 pcon=8.8316 forget=0.0000 orth=0.9719 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8460 mle=2.0426 pcon=8.8324 forget=0.0000 orth=0.9709 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7752 mle=1.9710 pcon=8.8352 forget=0.0000 orth=0.9691 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8321 mle=2.0280 pcon=8.8367 forget=0.0000 orth=0.9674 favg=0.0000 nr=122 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9322 mle=2.1280 pcon=8.8387 forget=0.0000 orth=0.9656 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7590 mle=1.9546 pcon=8.8402 forget=0.0000 orth=0.9642 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 10 it 40 total=11.6747 mle=1.8701 pcon=8.8419 forget=0.0000 orth=0.9627 favg=0.0000 nr=123 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.1514 mle=2.3476 pcon=8.8427 forget=0.0000 orth=0.9611 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.8338 mle=2.0297 pcon=8.8449 forget=0.0000 orth=0.9593 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.7999 mle=1.9960 pcon=8.8465 forget=0.0000 orth=0.9574 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6461 mle=1.8433 pcon=8.8470 forget=0.0000 orth=0.9559 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0892 mle=2.2863 pcon=8.8492 forget=0.0000 orth=0.9537 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.7919 mle=1.9902 pcon=8.8499 forget=0.0000 orth=0.9517 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.0292 mle=2.2286 pcon=8.8510 forget=0.0000 orth=0.9496 favg=0.0000 nr=74 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 11 it 49 total=11.7755 mle=1.9753 pcon=8.8527 forget=0.0000 orth=0.9474 favg=0.0000 nr=117 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.0824 mle=2.2830 pcon=8.8540 forget=0.0000 orth=0.9455 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.9661 mle=2.1684 pcon=8.8547 forget=0.0000 orth=0.9431 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.8134 mle=2.0168 pcon=8.8558 forget=0.0000 orth=0.9409 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.6018 mle=1.8063 pcon=8.8571 forget=0.0000 orth=0.9384 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.9105 mle=2.1167 pcon=8.8579 forget=0.0000 orth=0.9358 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.6433 mle=1.8510 pcon=8.8591 forget=0.0000 orth=0.9332 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 12 it 8 total=11.9889 mle=2.1976 pcon=8.8607 forget=0.0000 orth=0.9306 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.7802 mle=1.9913 pcon=8.8614 forget=0.0000 orth=0.9275 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.9814 mle=2.1946 pcon=8.8623 forget=0.0000 orth=0.9245 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.7500 mle=1.9654 pcon=8.8632 forget=0.0000 orth=0.9214 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.7794 mle=1.9971 pcon=8.8645 forget=0.0000 orth=0.9179 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.0696 mle=2.2890 pcon=8.8660 forget=0.0000 orth=0.9146 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8791 mle=2.1018 pcon=8.8663 forget=0.0000 orth=0.9109 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9389 mle=2.1640 pcon=8.8675 forget=0.0000 orth=0.9073 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
 52%|█████▏    | 13/25 [02:30<02:11, 10.95s/it] 56%|█████▌    | 14/25 [02:42<02:01, 11.05s/it] 60%|██████    | 15/25 [02:52<01:49, 10.99s/it] 64%|██████▍   | 16/25 [03:03<01:39, 11.00s/it] 68%|██████▊   | 17/25 [03:15<01:28, 11.10s/it] 72%|███████▏  | 18/25 [03:25<01:16, 10.99s/it] 76%|███████▌  | 19/25 [03:37<01:06, 11.08s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 13 it 17 total=11.9997 mle=2.2271 pcon=8.8692 forget=0.0000 orth=0.9034 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.7813 mle=2.0117 pcon=8.8702 forget=0.0000 orth=0.8995 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.0338 mle=2.2675 pcon=8.8709 forget=0.0000 orth=0.8954 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.8727 mle=2.1109 pcon=8.8705 forget=0.0000 orth=0.8913 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.0494 mle=2.2918 pcon=8.8707 forget=0.0000 orth=0.8869 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.9534 mle=2.2001 pcon=8.8709 forget=0.0000 orth=0.8824 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.8414 mle=2.0918 pcon=8.8718 forget=0.0000 orth=0.8777 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.8609 mle=2.1160 pcon=8.8718 forget=0.0000 orth=0.8730 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 14 it 26 total=12.0309 mle=2.2908 pcon=8.8720 forget=0.0000 orth=0.8681 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.7424 mle=2.0071 pcon=8.8720 forget=0.0000 orth=0.8633 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.7922 mle=2.0615 pcon=8.8725 forget=0.0000 orth=0.8582 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.9378 mle=2.2146 pcon=8.8701 forget=0.0000 orth=0.8531 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.6457 mle=1.9280 pcon=8.8699 forget=0.0000 orth=0.8478 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.8634 mle=2.1512 pcon=8.8695 forget=0.0000 orth=0.8427 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.7949 mle=2.0883 pcon=8.8693 forget=0.0000 orth=0.8373 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.6061 mle=1.9058 pcon=8.8684 forget=0.0000 orth=0.8319 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 15 it 35 total=11.7883 mle=2.0941 pcon=8.8679 forget=0.0000 orth=0.8264 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.7723 mle=2.0844 pcon=8.8671 forget=0.0000 orth=0.8209 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.6446 mle=1.9625 pcon=8.8664 forget=0.0000 orth=0.8156 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.6419 mle=1.9667 pcon=8.8652 forget=0.0000 orth=0.8100 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.8580 mle=2.1896 pcon=8.8639 forget=0.0000 orth=0.8045 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.6986 mle=2.0359 pcon=8.8637 forget=0.0000 orth=0.7990 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.8533 mle=2.1984 pcon=8.8614 forget=0.0000 orth=0.7934 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.6463 mle=1.9979 pcon=8.8607 forget=0.0000 orth=0.7878 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 16 it 44 total=11.7725 mle=2.1310 pcon=8.8591 forget=0.0000 orth=0.7823 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.7984 mle=2.1634 pcon=8.8582 forget=0.0000 orth=0.7768 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.6265 mle=1.9983 pcon=8.8569 forget=0.0000 orth=0.7714 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.6435 mle=2.0224 pcon=8.8552 forget=0.0000 orth=0.7660 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.5656 mle=1.9514 pcon=8.8536 forget=0.0000 orth=0.7606 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.4821 mle=1.8750 pcon=8.8518 forget=0.0000 orth=0.7553 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.6366 mle=2.0363 pcon=8.8503 forget=0.0000 orth=0.7500 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 17 it 3 total=11.3792 mle=1.7852 pcon=8.8493 forget=0.0000 orth=0.7447 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.4117 mle=1.8247 pcon=8.8474 forget=0.0000 orth=0.7396 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.5791 mle=1.9981 pcon=8.8465 forget=0.0000 orth=0.7345 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.4345 mle=1.8588 pcon=8.8463 forget=0.0000 orth=0.7294 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.4891 mle=1.9199 pcon=8.8445 forget=0.0000 orth=0.7246 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.5820 mle=2.0188 pcon=8.8434 forget=0.0000 orth=0.7198 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.4743 mle=1.9182 pcon=8.8411 forget=0.0000 orth=0.7150 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.5408 mle=1.9923 pcon=8.8382 forget=0.0000 orth=0.7103 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 18 it 12 total=11.4841 mle=1.9419 pcon=8.8365 forget=0.0000 orth=0.7057 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.7828 mle=2.2478 pcon=8.8338 forget=0.0000 orth=0.7012 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.4539 mle=1.9247 pcon=8.8324 forget=0.0000 orth=0.6968 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.6476 mle=2.1255 pcon=8.8296 forget=0.0000 orth=0.6925 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.6342 mle=2.1181 pcon=8.8277 forget=0.0000 orth=0.6883 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.4775 mle=1.9680 pcon=8.8252 forget=0.0000 orth=0.6843 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.4383 mle=1.9352 pcon=8.8227 forget=0.0000 orth=0.6804 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.3502 mle=1.8531 pcon=8.8206 forget=0.0000 orth=0.6765 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 19 it 21 total=11.4366 mle=1.9442 pcon=8.8196 forget=0.0000 orth=0.6728 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.5149 mle=2.0285 pcon=8.8173 forget=0.0000 orth=0.6691 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
 80%|████████  | 20/25 [03:48<00:55, 11.09s/it] 84%|████████▍ | 21/25 [04:00<00:45, 11.40s/it] 88%|████████▊ | 22/25 [04:11<00:33, 11.19s/it] 92%|█████████▏| 23/25 [04:21<00:22, 11.01s/it] 96%|█████████▌| 24/25 [04:32<00:11, 11.03s/it]100%|██████████| 25/25 [04:44<00:00, 11.09s/it]100%|██████████| 25/25 [04:44<00:00, 11.36s/it]
[loss] ep 19 it 121 total=11.4314 mle=1.9498 pcon=8.8160 forget=0.0000 orth=0.6656 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.4886 mle=2.0114 pcon=8.8150 forget=0.0000 orth=0.6622 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.4975 mle=2.0245 pcon=8.8140 forget=0.0000 orth=0.6589 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.5878 mle=2.1202 pcon=8.8119 forget=0.0000 orth=0.6557 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.5367 mle=2.0735 pcon=8.8106 forget=0.0000 orth=0.6527 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.5261 mle=2.0674 pcon=8.8089 forget=0.0000 orth=0.6498 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 20 it 30 total=11.5755 mle=2.1216 pcon=8.8070 forget=0.0000 orth=0.6470 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.3804 mle=1.9313 pcon=8.8048 forget=0.0000 orth=0.6443 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.5089 mle=2.0643 pcon=8.8028 forget=0.0000 orth=0.6418 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.5406 mle=2.0997 pcon=8.8016 forget=0.0000 orth=0.6393 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.2533 mle=1.8170 pcon=8.7994 forget=0.0000 orth=0.6369 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.4777 mle=2.0458 pcon=8.7971 forget=0.0000 orth=0.6347 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.7092 mle=2.2811 pcon=8.7956 forget=0.0000 orth=0.6326 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.5869 mle=2.1615 pcon=8.7948 forget=0.0000 orth=0.6306 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 21 it 39 total=11.4763 mle=2.0558 pcon=8.7917 forget=0.0000 orth=0.6288 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.2654 mle=1.8483 pcon=8.7901 forget=0.0000 orth=0.6270 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.4354 mle=2.0214 pcon=8.7886 forget=0.0000 orth=0.6253 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.2724 mle=1.8621 pcon=8.7865 forget=0.0000 orth=0.6238 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.5753 mle=2.1682 pcon=8.7848 forget=0.0000 orth=0.6223 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.3158 mle=1.9113 pcon=8.7836 forget=0.0000 orth=0.6210 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.3442 mle=1.9428 pcon=8.7817 forget=0.0000 orth=0.6197 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.5245 mle=2.1260 pcon=8.7800 forget=0.0000 orth=0.6185 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 22 it 48 total=11.5259 mle=2.1297 pcon=8.7787 forget=0.0000 orth=0.6175 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.3897 mle=1.9964 pcon=8.7769 forget=0.0000 orth=0.6165 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.3951 mle=2.0035 pcon=8.7761 forget=0.0000 orth=0.6156 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.3207 mle=1.9299 pcon=8.7761 forget=0.0000 orth=0.6147 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.4707 mle=2.0814 pcon=8.7754 forget=0.0000 orth=0.6140 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.4463 mle=2.0591 pcon=8.7739 forget=0.0000 orth=0.6133 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.5686 mle=2.1831 pcon=8.7728 forget=0.0000 orth=0.6127 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 23 it 7 total=11.4374 mle=2.0546 pcon=8.7707 forget=0.0000 orth=0.6121 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.4334 mle=2.0522 pcon=8.7696 forget=0.0000 orth=0.6116 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=11.1502 mle=1.7712 pcon=8.7677 forget=0.0000 orth=0.6112 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.6834 mle=2.3061 pcon=8.7665 forget=0.0000 orth=0.6108 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.4840 mle=2.1081 pcon=8.7654 forget=0.0000 orth=0.6105 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.4214 mle=2.0472 pcon=8.7640 forget=0.0000 orth=0.6102 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.4482 mle=2.0756 pcon=8.7625 forget=0.0000 orth=0.6100 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.3218 mle=1.9510 pcon=8.7610 forget=0.0000 orth=0.6098 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 24 it 16 total=11.5062 mle=2.1372 pcon=8.7593 forget=0.0000 orth=0.6097 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.2965 mle=1.9285 pcon=8.7584 forget=0.0000 orth=0.6096 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.5449 mle=2.1788 pcon=8.7566 forget=0.0000 orth=0.6095 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.4609 mle=2.0964 pcon=8.7551 forget=0.0000 orth=0.6094 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.2506 mle=1.8875 pcon=8.7538 forget=0.0000 orth=0.6094 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.3307 mle=1.9679 pcon=8.7535 forget=0.0000 orth=0.6093 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.3588 mle=1.9968 pcon=8.7527 forget=0.0000 orth=0.6093 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.6673 mle=2.3060 pcon=8.7520 forget=0.0000 orth=0.6093 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:37,  1.40it/s]  3%|▎         | 11/391 [00:00<00:21, 17.59it/s]  5%|▌         | 21/391 [00:00<00:11, 32.90it/s]  8%|▊         | 31/391 [00:01<00:07, 46.50it/s] 10%|█         | 41/391 [00:01<00:06, 57.89it/s] 13%|█▎        | 51/391 [00:01<00:05, 67.20it/s] 16%|█▌        | 61/391 [00:01<00:04, 74.27it/s] 18%|█▊        | 71/391 [00:01<00:04, 79.60it/s] 21%|██        | 81/391 [00:01<00:03, 83.41it/s] 23%|██▎       | 91/391 [00:01<00:03, 86.76it/s] 26%|██▌       | 101/391 [00:01<00:03, 89.22it/s] 28%|██▊       | 111/391 [00:01<00:03, 90.65it/s] 31%|███       | 121/391 [00:01<00:02, 90.51it/s] 34%|███▎      | 131/391 [00:02<00:02, 91.42it/s] 36%|███▌      | 141/391 [00:02<00:02, 92.56it/s] 39%|███▊      | 151/391 [00:02<00:02, 93.18it/s] 41%|████      | 161/391 [00:02<00:02, 93.22it/s] 44%|████▎     | 171/391 [00:02<00:02, 91.80it/s] 46%|████▋     | 181/391 [00:02<00:02, 92.12it/s] 49%|████▉     | 191/391 [00:02<00:02, 92.56it/s] 51%|█████▏    | 201/391 [00:02<00:02, 92.86it/s] 54%|█████▍    | 211/391 [00:02<00:01, 93.11it/s] 57%|█████▋    | 221/391 [00:03<00:01, 92.49it/s] 59%|█████▉    | 231/391 [00:03<00:01, 92.91it/s] 62%|██████▏   | 241/391 [00:03<00:01, 93.50it/s] 64%|██████▍   | 251/391 [00:03<00:01, 93.40it/s] 67%|██████▋   | 261/391 [00:03<00:01, 93.01it/s] 69%|██████▉   | 271/391 [00:03<00:01, 93.28it/s] 72%|███████▏  | 281/391 [00:03<00:01, 93.25it/s] 74%|███████▍  | 291/391 [00:03<00:01, 93.35it/s] 77%|███████▋  | 301/391 [00:03<00:00, 92.74it/s] 80%|███████▉  | 311/391 [00:04<00:00, 92.31it/s] 82%|████████▏ | 321/391 [00:04<00:00, 92.80it/s] 85%|████████▍ | 331/391 [00:04<00:00, 93.56it/s] 87%|████████▋ | 341/391 [00:04<00:00, 92.40it/s] 90%|████████▉ | 351/391 [00:04<00:00, 74.10it/s] 92%|█████████▏| 360/391 [00:04<00:00, 76.58it/s] 95%|█████████▍| 370/391 [00:04<00:00, 81.90it/s] 97%|█████████▋| 380/391 [00:04<00:00, 85.97it/s]100%|█████████▉| 390/391 [00:04<00:00, 89.06it/s]100%|██████████| 391/391 [00:04<00:00, 78.23it/s]
50000 images processed, 5.071681976318359 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:53,  1.46it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.27it/s] 24%|██▍       | 19/79 [00:00<00:02, 29.91it/s] 33%|███▎      | 26/79 [00:01<00:01, 34.95it/s] 41%|████      | 32/79 [00:01<00:01, 39.22it/s] 48%|████▊     | 38/79 [00:01<00:01, 40.24it/s] 56%|█████▌    | 44/79 [00:01<00:00, 42.49it/s] 68%|██████▊   | 54/79 [00:01<00:00, 55.68it/s] 80%|███████▉  | 63/79 [00:01<00:00, 63.57it/s] 90%|████████▉ | 71/79 [00:01<00:00, 63.22it/s] 99%|█████████▊| 78/79 [00:01<00:00, 62.02it/s]100%|██████████| 79/79 [00:01<00:00, 41.10it/s]
10000 images processed, 1.9387435913085938 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:45,  1.92it/s]  5%|▍         | 10/204 [00:00<00:09, 20.79it/s]  8%|▊         | 17/204 [00:00<00:05, 31.85it/s] 13%|█▎        | 27/204 [00:00<00:03, 47.95it/s] 18%|█▊        | 36/204 [00:00<00:02, 58.75it/s] 23%|██▎       | 46/204 [00:01<00:02, 68.33it/s] 27%|██▋       | 56/204 [00:01<00:01, 75.68it/s] 32%|███▏      | 66/204 [00:01<00:01, 80.45it/s] 37%|███▋      | 76/204 [00:01<00:01, 83.64it/s] 42%|████▏     | 85/204 [00:01<00:01, 83.65it/s] 47%|████▋     | 95/204 [00:01<00:01, 86.19it/s] 51%|█████▏    | 105/204 [00:01<00:01, 87.75it/s] 56%|█████▋    | 115/204 [00:01<00:01, 88.27it/s] 61%|██████▏   | 125/204 [00:01<00:00, 89.80it/s] 66%|██████▌   | 135/204 [00:02<00:00, 90.92it/s] 71%|███████   | 145/204 [00:02<00:00, 91.69it/s] 76%|███████▌  | 155/204 [00:02<00:00, 92.44it/s] 81%|████████  | 165/204 [00:02<00:00, 92.85it/s] 86%|████████▌ | 175/204 [00:02<00:00, 93.20it/s] 91%|█████████ | 185/204 [00:02<00:00, 94.16it/s] 96%|█████████▌| 195/204 [00:02<00:00, 94.90it/s]100%|██████████| 204/204 [00:02<00:00, 71.01it/s]
26032 images processed, 2.989191770553589 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:09,  1.12it/s] 13%|█▎        | 10/79 [00:01<00:05, 13.22it/s] 25%|██▌       | 20/79 [00:01<00:02, 26.96it/s] 35%|███▌      | 28/79 [00:01<00:01, 36.17it/s] 46%|████▌     | 36/79 [00:01<00:01, 42.72it/s] 58%|█████▊    | 46/79 [00:01<00:00, 51.24it/s] 71%|███████   | 56/79 [00:01<00:00, 60.94it/s] 84%|████████▎ | 66/79 [00:01<00:00, 69.53it/s] 96%|█████████▌| 76/79 [00:01<00:00, 76.47it/s]100%|██████████| 79/79 [00:01<00:00, 43.22it/s]
10000 images processed, 1.8505334854125977 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:56,  1.39it/s] 13%|█▎        | 10/79 [00:00<00:04, 15.80it/s] 25%|██▌       | 20/79 [00:00<00:01, 31.31it/s] 38%|███▊      | 30/79 [00:01<00:01, 45.12it/s] 51%|█████     | 40/79 [00:01<00:00, 56.83it/s] 63%|██████▎   | 50/79 [00:01<00:00, 66.27it/s] 76%|███████▌  | 60/79 [00:01<00:00, 74.17it/s] 89%|████████▊ | 70/79 [00:01<00:00, 80.26it/s]100%|██████████| 79/79 [00:01<00:00, 50.95it/s]
10000 images processed, 1.5748546123504639 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:51,  1.34it/s] 16%|█▌        | 11/70 [00:00<00:03, 17.07it/s] 30%|███       | 21/70 [00:00<00:01, 32.11it/s] 44%|████▍     | 31/70 [00:01<00:00, 45.53it/s] 59%|█████▊    | 41/70 [00:01<00:00, 56.88it/s] 73%|███████▎  | 51/70 [00:01<00:00, 66.65it/s] 87%|████████▋ | 61/70 [00:01<00:00, 74.42it/s]100%|██████████| 70/70 [00:01<00:00, 47.33it/s]
8925 images processed, 1.5097017288208008 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<01:12,  1.65s/it] 24%|██▍       | 11/45 [00:01<00:04,  8.48it/s] 38%|███▊      | 17/45 [00:02<00:03,  9.32it/s] 60%|██████    | 27/45 [00:02<00:01, 17.41it/s] 73%|███████▎  | 33/45 [00:02<00:00, 14.65it/s] 96%|█████████▌| 43/45 [00:03<00:00, 22.75it/s]100%|██████████| 45/45 [00:03<00:00, 14.45it/s]
5640 images processed, 3.1327059268951416 seconds used

19.998467206954956
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.17  99.33  88.66
places365     53.72  87.21  54.34
LSUN          34.97  93.50  76.73
iSUN          36.45  92.16  70.46
dtd           28.92  93.58  78.23
AVG           31.45  93.16  73.69
[incremental] Overall: 0.7170 New: 0.6840 Old: 0.7500
[incremental] Final(Top-1): 0.7170  Average: 0.7825
4.750526428222656
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=25, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/25 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  4%|▍         | 1/25 [00:19<07:55, 19.83s/it]  8%|▊         | 2/25 [00:30<05:31, 14.41s/it] 12%|█▏        | 3/25 [00:41<04:40, 12.73s/it] 16%|█▌        | 4/25 [00:52<04:18, 12.29s/it] 20%|██        | 5/25 [01:03<03:54, 11.75s/it] 24%|██▍       | 6/25 [01:14<03:35, 11.34s/it][loss] ep 0 it 0 total=13.8079 mle=2.3969 pcon=9.4392 forget=0.0000 orth=1.9717 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=13.6790 mle=2.2657 pcon=9.4425 forget=0.0000 orth=1.9707 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=13.8036 mle=2.3889 pcon=9.4460 forget=0.0000 orth=1.9687 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=13.6722 mle=2.2582 pcon=9.4486 forget=0.0000 orth=1.9653 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=13.3740 mle=1.9622 pcon=9.4513 forget=0.0000 orth=1.9605 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.4992 mle=2.0917 pcon=9.4531 forget=0.0000 orth=1.9544 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.9242 mle=2.5222 pcon=9.4552 forget=0.0000 orth=1.9468 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.5516 mle=2.1568 pcon=9.4569 forget=0.0000 orth=1.9379 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=13.5433 mle=2.1573 pcon=9.4584 forget=0.0000 orth=1.9276 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.4844 mle=2.1093 pcon=9.4593 forget=0.0000 orth=1.9159 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.6223 mle=2.2594 pcon=9.4603 forget=0.0000 orth=1.9027 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=13.7643 mle=2.4158 pcon=9.4604 forget=0.0000 orth=1.8881 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.7134 mle=2.3812 pcon=9.4603 forget=0.0000 orth=1.8720 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.3631 mle=2.0489 pcon=9.4597 forget=0.0000 orth=1.8545 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.5827 mle=2.2874 pcon=9.4599 forget=0.0000 orth=1.8354 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.5094 mle=2.2345 pcon=9.4601 forget=0.0000 orth=1.8148 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=13.3668 mle=2.1141 pcon=9.4600 forget=0.0000 orth=1.7926 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.4845 mle=2.2558 pcon=9.4597 forget=0.0000 orth=1.7691 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.2133 mle=2.0096 pcon=9.4599 forget=0.0000 orth=1.7438 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.3381 mle=2.1612 pcon=9.4600 forget=0.0000 orth=1.7170 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=12.9456 mle=1.7970 pcon=9.4601 forget=0.0000 orth=1.6886 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.3657 mle=2.2476 pcon=9.4593 forget=0.0000 orth=1.6588 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.4035 mle=2.3167 pcon=9.4593 forget=0.0000 orth=1.6274 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=12.9066 mle=1.8527 pcon=9.4594 forget=0.0000 orth=1.5945 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=13.2082 mle=2.1884 pcon=9.4593 forget=0.0000 orth=1.5604 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.2719 mle=2.2872 pcon=9.4594 forget=0.0000 orth=1.5253 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.1706 mle=2.2230 pcon=9.4588 forget=0.0000 orth=1.4888 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.0012 mle=2.0914 pcon=9.4582 forget=0.0000 orth=1.4516 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=12.9242 mle=2.0531 pcon=9.4574 forget=0.0000 orth=1.4136 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=12.9535 mle=2.1205 pcon=9.4576 forget=0.0000 orth=1.3754 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=12.8670 mle=2.0732 pcon=9.4568 forget=0.0000 orth=1.3369 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.8799 mle=2.1246 pcon=9.4568 forget=0.0000 orth=1.2985 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=12.8782 mle=2.1611 pcon=9.4566 forget=0.0000 orth=1.2604 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.8366 mle=2.1577 pcon=9.4563 forget=0.0000 orth=1.2226 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.8510 mle=2.2091 pcon=9.4559 forget=0.0000 orth=1.1860 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.5637 mle=1.9580 pcon=9.4555 forget=0.0000 orth=1.1502 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.5682 mle=1.9975 pcon=9.4550 forget=0.0000 orth=1.1157 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.5198 mle=1.9823 pcon=9.4550 forget=0.0000 orth=1.0825 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.7734 mle=2.2680 pcon=9.4548 forget=0.0000 orth=1.0506 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.4479 mle=1.9728 pcon=9.4543 forget=0.0000 orth=1.0208 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 5 it 45 total=12.5775 mle=2.1317 pcon=9.4537 forget=0.0000 orth=0.9922 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.4700 mle=2.0510 pcon=9.4535 forget=0.0000 orth=0.9654 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.4306 mle=2.0370 pcon=9.4534 forget=0.0000 orth=0.9402 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.4685 mle=2.0981 pcon=9.4534 forget=0.0000 orth=0.9170 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.5139 mle=2.1656 pcon=9.4534 forget=0.0000 orth=0.8950 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.1970 mle=1.8689 pcon=9.4534 forget=0.0000 orth=0.8747 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.5617 mle=2.2525 pcon=9.4536 forget=0.0000 orth=0.8557 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 6 it 4 total=12.4103 mle=2.1191 pcon=9.4534 forget=0.0000 orth=0.8378 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.4692 mle=2.1946 pcon=9.4532 forget=0.0000 orth=0.8215 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.2410 mle=1.9814 pcon=9.4534 forget=0.0000 orth=0.8062 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.0691 mle=1.8244 pcon=9.4530 forget=0.0000 orth=0.7917 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
 28%|██▊       | 7/25 [01:24<03:16, 10.92s/it] 32%|███▏      | 8/25 [01:34<03:03, 10.82s/it] 36%|███▌      | 9/25 [01:46<02:55, 11.00s/it] 40%|████      | 10/25 [01:56<02:43, 10.91s/it] 44%|████▍     | 11/25 [02:07<02:29, 10.71s/it] 48%|████▊     | 12/25 [02:17<02:17, 10.55s/it][loss] ep 6 it 204 total=12.2454 mle=2.0147 pcon=9.4523 forget=0.0000 orth=0.7784 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=12.2728 mle=2.0552 pcon=9.4519 forget=0.0000 orth=0.7657 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.5393 mle=2.3334 pcon=9.4519 forget=0.0000 orth=0.7540 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.1344 mle=1.9394 pcon=9.4520 forget=0.0000 orth=0.7430 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 7 it 13 total=12.4405 mle=2.2563 pcon=9.4515 forget=0.0000 orth=0.7327 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.5466 mle=2.3726 pcon=9.4509 forget=0.0000 orth=0.7231 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.4038 mle=2.2390 pcon=9.4510 forget=0.0000 orth=0.7138 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.4225 mle=2.2664 pcon=9.4509 forget=0.0000 orth=0.7051 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.1946 mle=2.0467 pcon=9.4509 forget=0.0000 orth=0.6970 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.3106 mle=2.1705 pcon=9.4509 forget=0.0000 orth=0.6893 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.1589 mle=2.0263 pcon=9.4506 forget=0.0000 orth=0.6819 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.3032 mle=2.1775 pcon=9.4505 forget=0.0000 orth=0.6752 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 8 it 22 total=12.2339 mle=2.1159 pcon=9.4498 forget=0.0000 orth=0.6683 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.0696 mle=1.9583 pcon=9.4494 forget=0.0000 orth=0.6618 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.9951 mle=1.8906 pcon=9.4490 forget=0.0000 orth=0.6556 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.8691 mle=1.7708 pcon=9.4486 forget=0.0000 orth=0.6496 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.8540 mle=1.7617 pcon=9.4484 forget=0.0000 orth=0.6439 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.0518 mle=1.9659 pcon=9.4477 forget=0.0000 orth=0.6382 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.1056 mle=2.0255 pcon=9.4471 forget=0.0000 orth=0.6330 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.2418 mle=2.1677 pcon=9.4464 forget=0.0000 orth=0.6277 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 9 it 31 total=12.3706 mle=2.3022 pcon=9.4457 forget=0.0000 orth=0.6227 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=12.1234 mle=2.0610 pcon=9.4447 forget=0.0000 orth=0.6177 favg=0.0000 nr=110 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.9793 mle=1.9224 pcon=9.4438 forget=0.0000 orth=0.6131 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=12.0687 mle=2.0175 pcon=9.4429 forget=0.0000 orth=0.6082 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.9485 mle=1.9022 pcon=9.4422 forget=0.0000 orth=0.6040 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=12.0620 mle=2.0212 pcon=9.4411 forget=0.0000 orth=0.5996 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.1643 mle=2.1292 pcon=9.4397 forget=0.0000 orth=0.5954 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.9563 mle=1.9270 pcon=9.4384 forget=0.0000 orth=0.5910 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 10 it 40 total=11.8926 mle=1.8685 pcon=9.4373 forget=0.0000 orth=0.5869 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.3090 mle=2.2907 pcon=9.4356 forget=0.0000 orth=0.5827 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.9715 mle=1.9576 pcon=9.4351 forget=0.0000 orth=0.5787 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.9687 mle=1.9601 pcon=9.4338 forget=0.0000 orth=0.5748 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.8352 mle=1.8317 pcon=9.4325 forget=0.0000 orth=0.5710 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.2755 mle=2.2762 pcon=9.4319 forget=0.0000 orth=0.5674 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.9508 mle=1.9569 pcon=9.4301 forget=0.0000 orth=0.5637 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.2241 mle=2.2355 pcon=9.4284 forget=0.0000 orth=0.5602 favg=0.0000 nr=68 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 11 it 49 total=11.9324 mle=1.9490 pcon=9.4268 forget=0.0000 orth=0.5566 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.1552 mle=2.1771 pcon=9.4250 forget=0.0000 orth=0.5531 favg=0.0000 nr=102 nf=11 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=12.0987 mle=2.1258 pcon=9.4234 forget=0.0000 orth=0.5496 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.9560 mle=1.9887 pcon=9.4211 forget=0.0000 orth=0.5462 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.7356 mle=1.7744 pcon=9.4184 forget=0.0000 orth=0.5429 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=12.0299 mle=2.0747 pcon=9.4157 forget=0.0000 orth=0.5395 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.8174 mle=1.8671 pcon=9.4140 forget=0.0000 orth=0.5363 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 12 it 8 total=12.0785 mle=2.1334 pcon=9.4119 forget=0.0000 orth=0.5331 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.8986 mle=1.9597 pcon=9.4089 forget=0.0000 orth=0.5300 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=12.0654 mle=2.1320 pcon=9.4067 forget=0.0000 orth=0.5268 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.9183 mle=1.9909 pcon=9.4037 forget=0.0000 orth=0.5237 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.8600 mle=1.9387 pcon=9.4007 forget=0.0000 orth=0.5206 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.1806 mle=2.2645 pcon=9.3986 forget=0.0000 orth=0.5175 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=12.0275 mle=2.1176 pcon=9.3955 forget=0.0000 orth=0.5144 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9982 mle=2.0938 pcon=9.3931 forget=0.0000 orth=0.5113 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
 52%|█████▏    | 13/25 [02:27<02:05, 10.49s/it] 56%|█████▌    | 14/25 [02:38<01:54, 10.45s/it] 60%|██████    | 15/25 [02:50<01:49, 10.98s/it] 64%|██████▍   | 16/25 [03:02<01:41, 11.28s/it] 68%|██████▊   | 17/25 [03:13<01:29, 11.24s/it] 72%|███████▏  | 18/25 [03:24<01:17, 11.11s/it] 76%|███████▌  | 19/25 [03:34<01:06, 11.01s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 13 it 17 total=12.0875 mle=2.1883 pcon=9.3907 forget=0.0000 orth=0.5084 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.8133 mle=1.9202 pcon=9.3877 forget=0.0000 orth=0.5054 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.1216 mle=2.2339 pcon=9.3853 forget=0.0000 orth=0.5024 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=12.0021 mle=2.1209 pcon=9.3818 forget=0.0000 orth=0.4995 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.0741 mle=2.1979 pcon=9.3796 forget=0.0000 orth=0.4965 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=12.0256 mle=2.1554 pcon=9.3766 forget=0.0000 orth=0.4936 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.9052 mle=2.0405 pcon=9.3740 forget=0.0000 orth=0.4908 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.9498 mle=2.0915 pcon=9.3704 forget=0.0000 orth=0.4879 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 14 it 26 total=12.1189 mle=2.2659 pcon=9.3680 forget=0.0000 orth=0.4850 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.8023 mle=1.9554 pcon=9.3649 forget=0.0000 orth=0.4821 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.8949 mle=2.0543 pcon=9.3614 forget=0.0000 orth=0.4793 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.9705 mle=2.1368 pcon=9.3572 forget=0.0000 orth=0.4764 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.7556 mle=1.9281 pcon=9.3538 forget=0.0000 orth=0.4737 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.9820 mle=2.1606 pcon=9.3505 forget=0.0000 orth=0.4709 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.8537 mle=2.0381 pcon=9.3474 forget=0.0000 orth=0.4682 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.6804 mle=1.8707 pcon=9.3442 forget=0.0000 orth=0.4655 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 15 it 35 total=11.8443 mle=2.0412 pcon=9.3403 forget=0.0000 orth=0.4628 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.8409 mle=2.0433 pcon=9.3374 forget=0.0000 orth=0.4602 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.7302 mle=1.9387 pcon=9.3339 forget=0.0000 orth=0.4575 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.7437 mle=1.9586 pcon=9.3302 forget=0.0000 orth=0.4549 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.9446 mle=2.1654 pcon=9.3268 forget=0.0000 orth=0.4524 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.7868 mle=2.0137 pcon=9.3232 forget=0.0000 orth=0.4499 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.9384 mle=2.1718 pcon=9.3192 forget=0.0000 orth=0.4474 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.7317 mle=1.9709 pcon=9.3158 forget=0.0000 orth=0.4449 favg=0.0000 nr=111 nf=1 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 16 it 44 total=11.9190 mle=2.1636 pcon=9.3129 forget=0.0000 orth=0.4425 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.8798 mle=2.1300 pcon=9.3096 forget=0.0000 orth=0.4402 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.7414 mle=1.9980 pcon=9.3057 forget=0.0000 orth=0.4377 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.6963 mle=1.9588 pcon=9.3020 forget=0.0000 orth=0.4354 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.6391 mle=1.9075 pcon=9.2985 forget=0.0000 orth=0.4331 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.5978 mle=1.8721 pcon=9.2950 forget=0.0000 orth=0.4307 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.7349 mle=2.0145 pcon=9.2919 forget=0.0000 orth=0.4285 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 17 it 3 total=11.4657 mle=1.7506 pcon=9.2888 forget=0.0000 orth=0.4263 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.5186 mle=1.8091 pcon=9.2854 forget=0.0000 orth=0.4241 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.6672 mle=1.9629 pcon=9.2823 forget=0.0000 orth=0.4220 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.5381 mle=1.8392 pcon=9.2790 forget=0.0000 orth=0.4199 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.6068 mle=1.9142 pcon=9.2748 forget=0.0000 orth=0.4178 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.6667 mle=1.9790 pcon=9.2719 forget=0.0000 orth=0.4158 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.5778 mle=1.8952 pcon=9.2687 forget=0.0000 orth=0.4138 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.6252 mle=1.9488 pcon=9.2645 forget=0.0000 orth=0.4119 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 18 it 12 total=11.6305 mle=1.9593 pcon=9.2612 forget=0.0000 orth=0.4100 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.9031 mle=2.2375 pcon=9.2574 forget=0.0000 orth=0.4082 favg=0.0000 nr=110 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.5372 mle=1.8761 pcon=9.2546 forget=0.0000 orth=0.4065 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.7381 mle=2.0831 pcon=9.2502 forget=0.0000 orth=0.4048 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.7573 mle=2.1078 pcon=9.2465 forget=0.0000 orth=0.4031 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.5881 mle=1.9438 pcon=9.2428 forget=0.0000 orth=0.4015 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.5688 mle=1.9296 pcon=9.2393 forget=0.0000 orth=0.3999 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.4610 mle=1.8266 pcon=9.2360 forget=0.0000 orth=0.3983 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 19 it 21 total=11.5688 mle=1.9387 pcon=9.2332 forget=0.0000 orth=0.3969 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.6718 mle=2.0466 pcon=9.2297 forget=0.0000 orth=0.3954 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
 80%|████████  | 20/25 [03:45<00:53, 10.78s/it] 84%|████████▍ | 21/25 [03:57<00:44, 11.10s/it] 88%|████████▊ | 22/25 [04:07<00:33, 11.02s/it] 92%|█████████▏| 23/25 [04:18<00:22, 11.03s/it] 96%|█████████▌| 24/25 [04:29<00:10, 10.84s/it]100%|██████████| 25/25 [04:39<00:00, 10.77s/it]100%|██████████| 25/25 [04:39<00:00, 11.20s/it]
[loss] ep 19 it 121 total=11.5157 mle=1.8944 pcon=9.2272 forget=0.0000 orth=0.3940 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.6082 mle=1.9917 pcon=9.2237 forget=0.0000 orth=0.3927 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.6174 mle=2.0045 pcon=9.2215 forget=0.0000 orth=0.3915 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.6757 mle=2.0668 pcon=9.2187 forget=0.0000 orth=0.3903 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.6409 mle=2.0358 pcon=9.2160 forget=0.0000 orth=0.3891 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.6253 mle=2.0235 pcon=9.2139 forget=0.0000 orth=0.3879 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 20 it 30 total=11.7341 mle=2.1355 pcon=9.2118 forget=0.0000 orth=0.3869 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.5070 mle=1.9126 pcon=9.2086 forget=0.0000 orth=0.3858 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.6277 mle=2.0376 pcon=9.2052 forget=0.0000 orth=0.3849 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.6732 mle=2.0863 pcon=9.2029 forget=0.0000 orth=0.3839 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.3905 mle=1.8077 pcon=9.1997 forget=0.0000 orth=0.3831 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.5560 mle=1.9773 pcon=9.1964 forget=0.0000 orth=0.3822 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.8205 mle=2.2453 pcon=9.1938 forget=0.0000 orth=0.3814 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.6920 mle=2.1189 pcon=9.1924 forget=0.0000 orth=0.3807 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 21 it 39 total=11.5636 mle=1.9951 pcon=9.1886 forget=0.0000 orth=0.3800 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.4296 mle=1.8640 pcon=9.1863 forget=0.0000 orth=0.3793 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.6212 mle=2.0592 pcon=9.1833 forget=0.0000 orth=0.3786 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.4442 mle=1.8858 pcon=9.1804 forget=0.0000 orth=0.3781 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.6486 mle=2.0929 pcon=9.1782 forget=0.0000 orth=0.3775 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.4387 mle=1.8859 pcon=9.1759 forget=0.0000 orth=0.3770 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.5052 mle=1.9544 pcon=9.1743 forget=0.0000 orth=0.3765 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.6680 mle=2.1202 pcon=9.1717 forget=0.0000 orth=0.3761 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 22 it 48 total=11.6427 mle=2.0971 pcon=9.1699 forget=0.0000 orth=0.3757 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.5197 mle=1.9768 pcon=9.1676 forget=0.0000 orth=0.3753 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.5417 mle=2.0013 pcon=9.1655 forget=0.0000 orth=0.3750 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.4750 mle=1.9354 pcon=9.1649 forget=0.0000 orth=0.3746 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.5891 mle=2.0514 pcon=9.1633 forget=0.0000 orth=0.3744 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.5762 mle=2.0409 pcon=9.1613 forget=0.0000 orth=0.3741 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.6706 mle=2.1379 pcon=9.1588 forget=0.0000 orth=0.3739 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 23 it 7 total=11.4987 mle=1.9682 pcon=9.1568 forget=0.0000 orth=0.3737 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.6240 mle=2.0962 pcon=9.1544 forget=0.0000 orth=0.3735 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=11.2778 mle=1.7523 pcon=9.1522 forget=0.0000 orth=0.3733 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.8145 mle=2.2902 pcon=9.1511 forget=0.0000 orth=0.3732 favg=0.0000 nr=107 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.6072 mle=2.0842 pcon=9.1498 forget=0.0000 orth=0.3731 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.5591 mle=2.0381 pcon=9.1479 forget=0.0000 orth=0.3730 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.5772 mle=2.0588 pcon=9.1455 forget=0.0000 orth=0.3729 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.4118 mle=1.8952 pcon=9.1438 forget=0.0000 orth=0.3728 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 24 it 16 total=11.6395 mle=2.1252 pcon=9.1415 forget=0.0000 orth=0.3728 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.4154 mle=1.9019 pcon=9.1408 forget=0.0000 orth=0.3727 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.6797 mle=2.1683 pcon=9.1388 forget=0.0000 orth=0.3727 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.6355 mle=2.1262 pcon=9.1366 forget=0.0000 orth=0.3727 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.3769 mle=1.8696 pcon=9.1346 forget=0.0000 orth=0.3727 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.4577 mle=1.9524 pcon=9.1327 forget=0.0000 orth=0.3727 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.4837 mle=1.9799 pcon=9.1312 forget=0.0000 orth=0.3726 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.7887 mle=2.2858 pcon=9.1302 forget=0.0000 orth=0.3726 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:02,  1.61it/s]  3%|▎         | 11/391 [00:00<00:19, 19.60it/s]  5%|▌         | 21/391 [00:00<00:10, 35.73it/s]  8%|▊         | 31/391 [00:00<00:07, 49.73it/s] 10%|█         | 41/391 [00:01<00:05, 60.87it/s] 13%|█▎        | 51/391 [00:01<00:04, 69.86it/s] 16%|█▌        | 61/391 [00:01<00:04, 76.69it/s] 18%|█▊        | 71/391 [00:01<00:03, 82.04it/s] 21%|██        | 81/391 [00:01<00:03, 84.98it/s] 23%|██▎       | 91/391 [00:01<00:03, 87.11it/s] 26%|██▌       | 101/391 [00:01<00:03, 88.89it/s] 28%|██▊       | 111/391 [00:01<00:03, 90.65it/s] 31%|███       | 121/391 [00:01<00:03, 87.43it/s] 34%|███▎      | 131/391 [00:02<00:02, 88.75it/s] 36%|███▌      | 141/391 [00:02<00:03, 77.78it/s] 39%|███▊      | 151/391 [00:02<00:02, 82.22it/s] 41%|████      | 161/391 [00:02<00:02, 85.85it/s] 44%|████▎     | 171/391 [00:02<00:02, 88.54it/s] 46%|████▋     | 181/391 [00:02<00:02, 89.14it/s] 49%|████▉     | 191/391 [00:02<00:02, 90.45it/s] 51%|█████▏    | 201/391 [00:02<00:02, 91.70it/s] 54%|█████▍    | 211/391 [00:02<00:01, 91.92it/s] 57%|█████▋    | 221/391 [00:03<00:01, 92.67it/s] 59%|█████▉    | 231/391 [00:03<00:01, 92.99it/s] 62%|██████▏   | 241/391 [00:03<00:01, 92.03it/s] 64%|██████▍   | 251/391 [00:03<00:01, 92.86it/s] 67%|██████▋   | 261/391 [00:03<00:01, 93.57it/s] 69%|██████▉   | 271/391 [00:03<00:01, 93.40it/s] 72%|███████▏  | 281/391 [00:03<00:01, 93.16it/s] 74%|███████▍  | 291/391 [00:03<00:01, 93.62it/s] 77%|███████▋  | 301/391 [00:03<00:00, 93.18it/s] 80%|███████▉  | 311/391 [00:04<00:00, 92.70it/s] 82%|████████▏ | 321/391 [00:04<00:00, 93.13it/s] 85%|████████▍ | 331/391 [00:04<00:00, 91.73it/s] 87%|████████▋ | 341/391 [00:04<00:00, 92.65it/s] 90%|████████▉ | 351/391 [00:04<00:00, 92.87it/s] 92%|█████████▏| 361/391 [00:04<00:00, 90.06it/s] 95%|█████████▍| 371/391 [00:04<00:00, 92.16it/s] 97%|█████████▋| 381/391 [00:04<00:00, 93.72it/s]100%|██████████| 391/391 [00:04<00:00, 91.90it/s]100%|██████████| 391/391 [00:04<00:00, 80.08it/s]
50000 images processed, 4.960224390029907 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:51,  1.52it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.80it/s] 27%|██▋       | 21/79 [00:00<00:01, 34.66it/s] 39%|███▉      | 31/79 [00:00<00:00, 48.25it/s] 52%|█████▏    | 41/79 [00:01<00:00, 59.71it/s] 65%|██████▍   | 51/79 [00:01<00:00, 68.38it/s] 77%|███████▋  | 61/79 [00:01<00:00, 75.91it/s] 90%|████████▉ | 71/79 [00:01<00:00, 81.59it/s]100%|██████████| 79/79 [00:01<00:00, 52.88it/s]
10000 images processed, 1.5173277854919434 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<03:02,  1.11it/s]  5%|▌         | 11/204 [00:01<00:13, 14.51it/s] 10%|▉         | 20/204 [00:01<00:06, 26.71it/s] 14%|█▎        | 28/204 [00:01<00:04, 36.29it/s] 19%|█▊        | 38/204 [00:01<00:03, 49.08it/s] 24%|██▎       | 48/204 [00:01<00:02, 59.76it/s] 28%|██▊       | 58/204 [00:01<00:02, 67.92it/s] 33%|███▎      | 67/204 [00:01<00:01, 73.25it/s] 38%|███▊      | 77/204 [00:01<00:01, 78.55it/s] 42%|████▏     | 86/204 [00:01<00:01, 81.38it/s] 47%|████▋     | 95/204 [00:01<00:01, 82.81it/s] 51%|█████▏    | 105/204 [00:02<00:01, 86.31it/s] 56%|█████▋    | 115/204 [00:02<00:01, 87.59it/s] 61%|██████▏   | 125/204 [00:02<00:00, 88.59it/s] 66%|██████▌   | 135/204 [00:02<00:00, 88.94it/s] 71%|███████   | 145/204 [00:02<00:00, 90.50it/s] 76%|███████▌  | 155/204 [00:02<00:00, 91.11it/s] 81%|████████  | 165/204 [00:02<00:00, 91.87it/s] 86%|████████▌ | 175/204 [00:02<00:00, 92.42it/s] 91%|█████████ | 185/204 [00:02<00:00, 93.70it/s] 96%|█████████▌| 195/204 [00:03<00:00, 94.65it/s]100%|██████████| 204/204 [00:03<00:00, 65.37it/s]
26032 images processed, 3.157822847366333 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:50,  1.54it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.01it/s] 27%|██▋       | 21/79 [00:00<00:01, 34.58it/s] 37%|███▋      | 29/79 [00:00<00:01, 43.63it/s] 49%|████▉     | 39/79 [00:01<00:00, 54.35it/s] 62%|██████▏   | 49/79 [00:01<00:00, 64.05it/s] 75%|███████▍  | 59/79 [00:01<00:00, 72.11it/s] 86%|████████▌ | 68/79 [00:01<00:00, 75.79it/s] 99%|█████████▊| 78/79 [00:01<00:00, 81.51it/s]100%|██████████| 79/79 [00:01<00:00, 51.74it/s]
10000 images processed, 1.5505070686340332 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:02,  1.25it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.02it/s] 25%|██▌       | 20/79 [00:01<00:02, 28.84it/s] 38%|███▊      | 30/79 [00:01<00:01, 42.37it/s] 51%|█████     | 40/79 [00:01<00:00, 53.50it/s] 62%|██████▏   | 49/79 [00:01<00:00, 52.90it/s] 75%|███████▍  | 59/79 [00:01<00:00, 62.86it/s] 87%|████████▋ | 69/79 [00:01<00:00, 71.19it/s]100%|██████████| 79/79 [00:01<00:00, 46.17it/s]
10000 images processed, 1.7370426654815674 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:51,  1.35it/s]  6%|▌         | 4/70 [00:00<00:11,  5.95it/s] 20%|██        | 14/70 [00:00<00:02, 23.22it/s] 34%|███▍      | 24/70 [00:01<00:01, 38.59it/s] 49%|████▊     | 34/70 [00:01<00:00, 51.85it/s] 63%|██████▎   | 44/70 [00:01<00:00, 62.76it/s] 77%|███████▋  | 54/70 [00:01<00:00, 71.55it/s] 91%|█████████▏| 64/70 [00:01<00:00, 78.26it/s]100%|██████████| 70/70 [00:01<00:00, 45.26it/s]
8925 images processed, 1.580012321472168 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:58,  1.33s/it] 11%|█         | 5/45 [00:01<00:09,  4.09it/s] 31%|███       | 14/45 [00:01<00:02, 12.20it/s] 38%|███▊      | 17/45 [00:01<00:02, 13.03it/s] 47%|████▋     | 21/45 [00:02<00:02, 11.91it/s] 69%|██████▉   | 31/45 [00:02<00:00, 22.67it/s] 80%|████████  | 36/45 [00:02<00:00, 20.63it/s] 93%|█████████▎| 42/45 [00:02<00:00, 25.93it/s]100%|██████████| 45/45 [00:02<00:00, 15.64it/s]
5640 images processed, 2.9038164615631104 seconds used

19.205864667892456
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.01  99.07  88.73
places365     65.35  84.07  47.80
LSUN          41.68  92.32  75.95
iSUN          46.64  91.56  74.82
dtd           27.96  93.91  82.89
AVG           37.33  92.19  74.04
[incremental] Overall: 0.7087 New: 0.7240 Old: 0.7010
[incremental] Final(Top-1): 0.7087  Average: 0.7579
7.99848484992981
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=25, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/25 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  4%|▍         | 1/25 [00:21<08:36, 21.53s/it]  8%|▊         | 2/25 [00:32<05:58, 15.60s/it] 12%|█▏        | 3/25 [00:43<04:50, 13.20s/it] 16%|█▌        | 4/25 [00:53<04:16, 12.20s/it] 20%|██        | 5/25 [01:04<03:55, 11.76s/it] 24%|██▍       | 6/25 [01:16<03:43, 11.74s/it][loss] ep 0 it 0 total=13.9822 mle=2.5052 pcon=9.8394 forget=0.0000 orth=1.6376 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=13.7988 mle=2.3210 pcon=9.8406 forget=0.0000 orth=1.6372 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=13.9013 mle=2.4233 pcon=9.8414 forget=0.0000 orth=1.6365 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=13.7903 mle=2.3144 pcon=9.8406 forget=0.0000 orth=1.6353 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=13.4402 mle=1.9667 pcon=9.8399 forget=0.0000 orth=1.6336 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.6451 mle=2.1753 pcon=9.8383 forget=0.0000 orth=1.6314 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=13.9816 mle=2.5172 pcon=9.8357 forget=0.0000 orth=1.6287 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.6077 mle=2.1503 pcon=9.8319 forget=0.0000 orth=1.6255 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.5425 mle=2.0925 pcon=9.8282 forget=0.0000 orth=1.6218 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.5716 mle=2.1297 pcon=9.8243 forget=0.0000 orth=1.6176 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.6911 mle=2.2583 pcon=9.8200 forget=0.0000 orth=1.6128 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=13.8619 mle=2.4387 pcon=9.8156 forget=0.0000 orth=1.6076 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.7338 mle=2.3220 pcon=9.8101 forget=0.0000 orth=1.6018 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.4239 mle=2.0242 pcon=9.8042 forget=0.0000 orth=1.5955 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.6385 mle=2.2510 pcon=9.7989 forget=0.0000 orth=1.5886 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.6339 mle=2.2602 pcon=9.7925 forget=0.0000 orth=1.5812 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.5065 mle=2.1457 pcon=9.7876 forget=0.0000 orth=1.5732 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.5275 mle=2.1803 pcon=9.7826 forget=0.0000 orth=1.5647 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.3043 mle=1.9717 pcon=9.7770 forget=0.0000 orth=1.5556 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.4810 mle=2.1633 pcon=9.7718 forget=0.0000 orth=1.5459 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.1290 mle=1.8278 pcon=9.7656 forget=0.0000 orth=1.5357 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.5093 mle=2.2257 pcon=9.7589 forget=0.0000 orth=1.5248 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.5116 mle=2.2451 pcon=9.7532 forget=0.0000 orth=1.5133 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.0286 mle=1.7795 pcon=9.7478 forget=0.0000 orth=1.5013 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.4050 mle=2.1749 pcon=9.7414 forget=0.0000 orth=1.4886 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.4999 mle=2.2888 pcon=9.7357 forget=0.0000 orth=1.4754 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.3329 mle=2.1420 pcon=9.7294 forget=0.0000 orth=1.4615 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.2616 mle=2.0918 pcon=9.7229 forget=0.0000 orth=1.4470 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.1417 mle=1.9928 pcon=9.7170 forget=0.0000 orth=1.4318 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.1554 mle=2.0284 pcon=9.7110 forget=0.0000 orth=1.4161 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.1512 mle=2.0467 pcon=9.7048 forget=0.0000 orth=1.3998 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.1182 mle=2.0365 pcon=9.6989 forget=0.0000 orth=1.3828 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.1715 mle=2.1139 pcon=9.6923 forget=0.0000 orth=1.3653 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.1196 mle=2.0864 pcon=9.6860 forget=0.0000 orth=1.3472 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.1091 mle=2.1007 pcon=9.6798 forget=0.0000 orth=1.3286 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.9020 mle=1.9185 pcon=9.6740 forget=0.0000 orth=1.3094 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.9295 mle=1.9714 pcon=9.6683 forget=0.0000 orth=1.2898 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.8535 mle=1.9209 pcon=9.6629 forget=0.0000 orth=1.2697 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.1555 mle=2.2492 pcon=9.6572 forget=0.0000 orth=1.2492 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.8198 mle=1.9395 pcon=9.6520 forget=0.0000 orth=1.2283 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 5 it 45 total=12.9473 mle=2.0940 pcon=9.6461 forget=0.0000 orth=1.2072 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.8505 mle=2.0238 pcon=9.6408 forget=0.0000 orth=1.1858 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.8091 mle=2.0104 pcon=9.6345 forget=0.0000 orth=1.1643 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.8485 mle=2.0765 pcon=9.6294 forget=0.0000 orth=1.1427 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.7917 mle=2.0467 pcon=9.6240 forget=0.0000 orth=1.1210 favg=0.0000 nr=97 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.5688 mle=1.8507 pcon=9.6187 forget=0.0000 orth=1.0994 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.8624 mle=2.1703 pcon=9.6141 forget=0.0000 orth=1.0780 favg=0.0000 nr=95 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 6 it 4 total=12.7439 mle=2.0789 pcon=9.6082 forget=0.0000 orth=1.0568 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.7386 mle=2.0999 pcon=9.6030 forget=0.0000 orth=1.0358 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.5009 mle=1.8883 pcon=9.5975 forget=0.0000 orth=1.0151 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.3793 mle=1.7925 pcon=9.5919 forget=0.0000 orth=0.9948 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=12.5354 mle=1.9739 pcon=9.5866 forget=0.0000 orth=0.9750 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
 28%|██▊       | 7/25 [01:27<03:26, 11.49s/it] 32%|███▏      | 8/25 [01:38<03:12, 11.32s/it] 36%|███▌      | 9/25 [01:49<02:57, 11.10s/it] 40%|████      | 10/25 [02:00<02:48, 11.23s/it] 44%|████▍     | 11/25 [02:11<02:35, 11.10s/it] 48%|████▊     | 12/25 [02:22<02:21, 10.91s/it] 52%|█████▏    | 13/25 [02:32<02:09, 10.82s/it][loss] ep 6 it 254 total=12.6130 mle=2.0760 pcon=9.5814 forget=0.0000 orth=0.9556 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.7426 mle=2.2297 pcon=9.5763 forget=0.0000 orth=0.9367 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.4316 mle=1.9422 pcon=9.5713 forget=0.0000 orth=0.9181 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 7 it 13 total=12.6512 mle=2.1844 pcon=9.5665 forget=0.0000 orth=0.9002 favg=0.0000 nr=98 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.7106 mle=2.2662 pcon=9.5617 forget=0.0000 orth=0.8827 favg=0.0000 nr=94 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.5930 mle=2.1703 pcon=9.5569 forget=0.0000 orth=0.8658 favg=0.0000 nr=93 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.6331 mle=2.2314 pcon=9.5524 forget=0.0000 orth=0.8493 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.3757 mle=1.9948 pcon=9.5477 forget=0.0000 orth=0.8333 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.4953 mle=2.1350 pcon=9.5426 forget=0.0000 orth=0.8177 favg=0.0000 nr=102 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.3093 mle=1.9676 pcon=9.5390 forget=0.0000 orth=0.8027 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.4337 mle=2.1112 pcon=9.5344 forget=0.0000 orth=0.7881 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 8 it 22 total=12.3290 mle=2.0255 pcon=9.5295 forget=0.0000 orth=0.7740 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.1647 mle=1.8790 pcon=9.5255 forget=0.0000 orth=0.7602 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.1571 mle=1.8892 pcon=9.5211 forget=0.0000 orth=0.7468 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=12.0244 mle=1.7736 pcon=9.5169 forget=0.0000 orth=0.7339 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.9649 mle=1.7304 pcon=9.5133 forget=0.0000 orth=0.7212 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.1416 mle=1.9239 pcon=9.5088 forget=0.0000 orth=0.7090 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.2374 mle=2.0354 pcon=9.5049 forget=0.0000 orth=0.6971 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.3080 mle=2.1220 pcon=9.5006 forget=0.0000 orth=0.6854 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 9 it 31 total=12.3654 mle=2.1948 pcon=9.4965 forget=0.0000 orth=0.6741 favg=0.0000 nr=92 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=12.1517 mle=1.9956 pcon=9.4930 forget=0.0000 orth=0.6631 favg=0.0000 nr=97 nf=13 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=12.0125 mle=1.8707 pcon=9.4894 forget=0.0000 orth=0.6524 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=12.1404 mle=2.0129 pcon=9.4855 forget=0.0000 orth=0.6421 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.9494 mle=1.8348 pcon=9.4827 forget=0.0000 orth=0.6319 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=12.1159 mle=2.0151 pcon=9.4787 forget=0.0000 orth=0.6222 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.2145 mle=2.1269 pcon=9.4750 forget=0.0000 orth=0.6126 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.9962 mle=1.9217 pcon=9.4712 forget=0.0000 orth=0.6033 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 10 it 40 total=11.9546 mle=1.8932 pcon=9.4672 forget=0.0000 orth=0.5942 favg=0.0000 nr=109 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.2773 mle=2.2288 pcon=9.4630 forget=0.0000 orth=0.5855 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.9952 mle=1.9585 pcon=9.4595 forget=0.0000 orth=0.5771 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.9698 mle=1.9453 pcon=9.4555 forget=0.0000 orth=0.5691 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.8445 mle=1.8319 pcon=9.4509 forget=0.0000 orth=0.5616 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.2426 mle=2.2405 pcon=9.4479 forget=0.0000 orth=0.5541 favg=0.0000 nr=93 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.9014 mle=1.9096 pcon=9.4449 forget=0.0000 orth=0.5468 favg=0.0000 nr=100 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.2048 mle=2.2238 pcon=9.4412 forget=0.0000 orth=0.5399 favg=0.0000 nr=65 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 11 it 49 total=11.9238 mle=1.9530 pcon=9.4377 forget=0.0000 orth=0.5331 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.1307 mle=2.1708 pcon=9.4333 forget=0.0000 orth=0.5266 favg=0.0000 nr=93 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=12.0339 mle=2.0839 pcon=9.4297 forget=0.0000 orth=0.5203 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.9442 mle=2.0045 pcon=9.4256 forget=0.0000 orth=0.5142 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.6936 mle=1.7632 pcon=9.4221 forget=0.0000 orth=0.5083 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=12.0393 mle=2.1186 pcon=9.4181 forget=0.0000 orth=0.5027 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.8010 mle=1.8895 pcon=9.4143 forget=0.0000 orth=0.4972 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 12 it 8 total=12.0225 mle=2.1198 pcon=9.4109 forget=0.0000 orth=0.4918 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.8750 mle=1.9816 pcon=9.4068 forget=0.0000 orth=0.4866 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.9478 mle=2.0633 pcon=9.4030 forget=0.0000 orth=0.4815 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.8793 mle=2.0031 pcon=9.3996 forget=0.0000 orth=0.4766 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.7969 mle=1.9290 pcon=9.3960 forget=0.0000 orth=0.4719 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.0847 mle=2.2247 pcon=9.3927 forget=0.0000 orth=0.4673 favg=0.0000 nr=97 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=12.0191 mle=2.1668 pcon=9.3895 forget=0.0000 orth=0.4629 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9228 mle=2.0780 pcon=9.3864 forget=0.0000 orth=0.4585 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
 56%|█████▌    | 14/25 [02:44<02:01, 11.00s/it] 60%|██████    | 15/25 [02:55<01:50, 11.04s/it] 64%|██████▍   | 16/25 [03:05<01:37, 10.87s/it] 68%|██████▊   | 17/25 [03:15<01:25, 10.71s/it] 72%|███████▏  | 18/25 [03:26<01:13, 10.52s/it] 76%|███████▌  | 19/25 [03:37<01:05, 10.84s/it][loss] ep 13 it 17 total=11.9490 mle=2.1115 pcon=9.3832 forget=0.0000 orth=0.4543 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.7480 mle=1.9178 pcon=9.3799 forget=0.0000 orth=0.4502 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.9914 mle=2.1685 pcon=9.3766 forget=0.0000 orth=0.4462 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.9437 mle=2.1283 pcon=9.3732 forget=0.0000 orth=0.4423 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.9893 mle=2.1802 pcon=9.3706 forget=0.0000 orth=0.4385 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.9524 mle=2.1499 pcon=9.3677 forget=0.0000 orth=0.4349 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.7958 mle=2.0001 pcon=9.3644 forget=0.0000 orth=0.4313 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.8912 mle=2.1031 pcon=9.3602 forget=0.0000 orth=0.4279 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 14 it 26 total=11.9947 mle=2.2127 pcon=9.3574 forget=0.0000 orth=0.4246 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.7200 mle=1.9445 pcon=9.3542 forget=0.0000 orth=0.4213 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.8169 mle=2.0478 pcon=9.3511 forget=0.0000 orth=0.4181 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.9403 mle=2.1782 pcon=9.3471 forget=0.0000 orth=0.4150 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.6867 mle=1.9313 pcon=9.3434 forget=0.0000 orth=0.4119 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.9344 mle=2.1860 pcon=9.3393 forget=0.0000 orth=0.4090 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.8272 mle=2.0842 pcon=9.3369 forget=0.0000 orth=0.4062 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.5934 mle=1.8562 pcon=9.3338 forget=0.0000 orth=0.4034 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 15 it 35 total=11.7488 mle=2.0175 pcon=9.3306 forget=0.0000 orth=0.4007 favg=0.0000 nr=99 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.7917 mle=2.0659 pcon=9.3277 forget=0.0000 orth=0.3981 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.6643 mle=1.9446 pcon=9.3241 forget=0.0000 orth=0.3955 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.6892 mle=1.9751 pcon=9.3211 forget=0.0000 orth=0.3930 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.8554 mle=2.1468 pcon=9.3179 forget=0.0000 orth=0.3906 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.6980 mle=1.9948 pcon=9.3149 forget=0.0000 orth=0.3883 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.8838 mle=2.1862 pcon=9.3115 forget=0.0000 orth=0.3860 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.6795 mle=1.9874 pcon=9.3083 forget=0.0000 orth=0.3838 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 16 it 44 total=11.8892 mle=2.2014 pcon=9.3061 forget=0.0000 orth=0.3817 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.8630 mle=2.1803 pcon=9.3031 forget=0.0000 orth=0.3796 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.7213 mle=2.0433 pcon=9.3004 forget=0.0000 orth=0.3776 favg=0.0000 nr=100 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.6547 mle=1.9827 pcon=9.2964 forget=0.0000 orth=0.3757 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.6495 mle=1.9815 pcon=9.2942 forget=0.0000 orth=0.3738 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.5454 mle=1.8822 pcon=9.2914 forget=0.0000 orth=0.3719 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.7028 mle=2.0446 pcon=9.2880 forget=0.0000 orth=0.3701 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 17 it 3 total=11.4692 mle=1.8161 pcon=9.2847 forget=0.0000 orth=0.3684 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.4841 mle=1.8357 pcon=9.2817 forget=0.0000 orth=0.3667 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.6967 mle=2.0536 pcon=9.2780 forget=0.0000 orth=0.3651 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.5508 mle=1.9121 pcon=9.2753 forget=0.0000 orth=0.3635 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.5881 mle=1.9538 pcon=9.2723 forget=0.0000 orth=0.3620 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.6486 mle=2.0184 pcon=9.2697 forget=0.0000 orth=0.3605 favg=0.0000 nr=101 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.5344 mle=1.9079 pcon=9.2674 forget=0.0000 orth=0.3591 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.6018 mle=1.9800 pcon=9.2641 forget=0.0000 orth=0.3577 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 18 it 12 total=11.6643 mle=2.0469 pcon=9.2610 forget=0.0000 orth=0.3564 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.8221 mle=2.2090 pcon=9.2580 forget=0.0000 orth=0.3551 favg=0.0000 nr=98 nf=12 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.5052 mle=1.8952 pcon=9.2562 forget=0.0000 orth=0.3539 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.7074 mle=2.1015 pcon=9.2532 forget=0.0000 orth=0.3527 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.6806 mle=2.0793 pcon=9.2498 forget=0.0000 orth=0.3516 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.5763 mle=1.9792 pcon=9.2467 forget=0.0000 orth=0.3505 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.5808 mle=1.9873 pcon=9.2441 forget=0.0000 orth=0.3494 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.4415 mle=1.8516 pcon=9.2415 forget=0.0000 orth=0.3484 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 19 it 21 total=11.5205 mle=1.9344 pcon=9.2386 forget=0.0000 orth=0.3474 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.6665 mle=2.0840 pcon=9.2360 forget=0.0000 orth=0.3465 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=11.4692 mle=1.8900 pcon=9.2336 forget=0.0000 orth=0.3456 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.6170 mle=2.0411 pcon=9.2312 forget=0.0000 orth=0.3447 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
 80%|████████  | 20/25 [03:48<00:54, 10.80s/it] 84%|████████▍ | 21/25 [03:59<00:43, 10.84s/it] 88%|████████▊ | 22/25 [04:09<00:31, 10.53s/it] 92%|█████████▏| 23/25 [04:19<00:21, 10.62s/it] 96%|█████████▌| 24/25 [04:30<00:10, 10.55s/it]100%|██████████| 25/25 [04:40<00:00, 10.43s/it]100%|██████████| 25/25 [04:40<00:00, 11.22s/it]
[loss] ep 19 it 221 total=11.6198 mle=2.0468 pcon=9.2291 forget=0.0000 orth=0.3439 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.6765 mle=2.1066 pcon=9.2268 forget=0.0000 orth=0.3431 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.6446 mle=2.0771 pcon=9.2252 forget=0.0000 orth=0.3423 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.6033 mle=2.0382 pcon=9.2234 forget=0.0000 orth=0.3416 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 20 it 30 total=11.7323 mle=2.1695 pcon=9.2218 forget=0.0000 orth=0.3410 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.4901 mle=1.9309 pcon=9.2189 forget=0.0000 orth=0.3403 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.6226 mle=2.0669 pcon=9.2160 forget=0.0000 orth=0.3397 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.6476 mle=2.0944 pcon=9.2141 forget=0.0000 orth=0.3391 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.4559 mle=1.9054 pcon=9.2119 forget=0.0000 orth=0.3386 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.5439 mle=1.9967 pcon=9.2091 forget=0.0000 orth=0.3380 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.7817 mle=2.2375 pcon=9.2067 forget=0.0000 orth=0.3375 favg=0.0000 nr=92 nf=13 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.6544 mle=2.1118 pcon=9.2055 forget=0.0000 orth=0.3371 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 21 it 39 total=11.5370 mle=1.9978 pcon=9.2026 forget=0.0000 orth=0.3366 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.4714 mle=1.9355 pcon=9.1997 forget=0.0000 orth=0.3362 favg=0.0000 nr=106 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.5986 mle=2.0650 pcon=9.1977 forget=0.0000 orth=0.3359 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.4575 mle=1.9260 pcon=9.1960 forget=0.0000 orth=0.3355 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.6578 mle=2.1286 pcon=9.1941 forget=0.0000 orth=0.3352 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.4467 mle=1.9190 pcon=9.1928 forget=0.0000 orth=0.3348 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.4694 mle=1.9439 pcon=9.1910 forget=0.0000 orth=0.3345 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.6591 mle=2.1359 pcon=9.1889 forget=0.0000 orth=0.3343 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 22 it 48 total=11.6474 mle=2.1265 pcon=9.1870 forget=0.0000 orth=0.3340 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.4672 mle=1.9481 pcon=9.1853 forget=0.0000 orth=0.3338 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.5589 mle=2.0415 pcon=9.1839 forget=0.0000 orth=0.3336 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.4738 mle=1.9582 pcon=9.1822 forget=0.0000 orth=0.3334 favg=0.0000 nr=102 nf=2 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.5569 mle=2.0434 pcon=9.1802 forget=0.0000 orth=0.3332 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.5735 mle=2.0611 pcon=9.1793 forget=0.0000 orth=0.3331 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.6829 mle=2.1726 pcon=9.1774 forget=0.0000 orth=0.3330 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 23 it 7 total=11.4937 mle=1.9852 pcon=9.1756 forget=0.0000 orth=0.3328 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.6814 mle=2.1745 pcon=9.1742 forget=0.0000 orth=0.3327 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=11.3143 mle=1.8099 pcon=9.1718 forget=0.0000 orth=0.3326 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.8095 mle=2.3061 pcon=9.1708 forget=0.0000 orth=0.3325 favg=0.0000 nr=94 nf=13 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.5984 mle=2.0963 pcon=9.1696 forget=0.0000 orth=0.3325 favg=0.0000 nr=96 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.5099 mle=2.0088 pcon=9.1687 forget=0.0000 orth=0.3324 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.5728 mle=2.0740 pcon=9.1664 forget=0.0000 orth=0.3324 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.4218 mle=1.9245 pcon=9.1650 forget=0.0000 orth=0.3323 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 24 it 16 total=11.6091 mle=2.1134 pcon=9.1635 forget=0.0000 orth=0.3323 favg=0.0000 nr=100 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.4348 mle=1.9397 pcon=9.1629 forget=0.0000 orth=0.3323 favg=0.0000 nr=105 nf=2 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.6902 mle=2.1966 pcon=9.1613 forget=0.0000 orth=0.3322 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.6386 mle=2.1470 pcon=9.1593 forget=0.0000 orth=0.3322 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.3893 mle=1.8992 pcon=9.1579 forget=0.0000 orth=0.3322 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.4740 mle=1.9860 pcon=9.1557 forget=0.0000 orth=0.3322 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.4529 mle=1.9662 pcon=9.1545 forget=0.0000 orth=0.3322 favg=0.0000 nr=103 nf=12 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.7483 mle=2.2634 pcon=9.1527 forget=0.0000 orth=0.3322 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e25-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:06,  2.09it/s]  3%|▎         | 11/391 [00:00<00:15, 24.34it/s]  5%|▌         | 21/391 [00:00<00:08, 42.45it/s]  8%|▊         | 31/391 [00:00<00:06, 56.62it/s] 10%|█         | 41/391 [00:00<00:05, 67.24it/s] 13%|█▎        | 51/391 [00:01<00:04, 75.09it/s] 16%|█▌        | 61/391 [00:01<00:04, 80.91it/s] 18%|█▊        | 71/391 [00:01<00:03, 84.65it/s] 21%|██        | 81/391 [00:01<00:03, 87.31it/s] 23%|██▎       | 91/391 [00:01<00:03, 89.81it/s] 26%|██▌       | 101/391 [00:01<00:03, 91.47it/s] 28%|██▊       | 111/391 [00:01<00:03, 92.77it/s] 31%|███       | 121/391 [00:01<00:02, 93.48it/s] 34%|███▎      | 131/391 [00:01<00:03, 80.10it/s] 36%|███▌      | 141/391 [00:02<00:02, 83.74it/s] 39%|███▊      | 151/391 [00:02<00:02, 86.02it/s] 41%|████      | 161/391 [00:02<00:02, 88.01it/s] 44%|████▎     | 171/391 [00:02<00:02, 89.24it/s] 46%|████▋     | 181/391 [00:02<00:02, 91.09it/s] 49%|████▉     | 191/391 [00:02<00:02, 92.53it/s] 51%|█████▏    | 201/391 [00:02<00:02, 93.42it/s] 54%|█████▍    | 211/391 [00:02<00:01, 94.13it/s] 57%|█████▋    | 221/391 [00:02<00:01, 94.55it/s] 59%|█████▉    | 231/391 [00:02<00:01, 94.46it/s] 62%|██████▏   | 241/391 [00:03<00:01, 94.47it/s] 64%|██████▍   | 251/391 [00:03<00:01, 94.71it/s] 67%|██████▋   | 261/391 [00:03<00:01, 93.99it/s] 69%|██████▉   | 271/391 [00:03<00:01, 94.05it/s] 72%|███████▏  | 281/391 [00:03<00:01, 94.13it/s] 74%|███████▍  | 291/391 [00:03<00:01, 94.55it/s] 77%|███████▋  | 301/391 [00:03<00:00, 93.30it/s] 80%|███████▉  | 311/391 [00:03<00:00, 92.02it/s] 82%|████████▏ | 321/391 [00:03<00:00, 92.83it/s] 85%|████████▍ | 331/391 [00:04<00:00, 93.64it/s] 87%|████████▋ | 341/391 [00:04<00:00, 93.58it/s] 90%|████████▉ | 351/391 [00:04<00:00, 94.11it/s] 92%|█████████▏| 361/391 [00:04<00:00, 93.53it/s] 95%|█████████▍| 371/391 [00:04<00:00, 94.84it/s] 97%|█████████▋| 381/391 [00:04<00:00, 92.73it/s]100%|██████████| 391/391 [00:04<00:00, 76.32it/s]100%|██████████| 391/391 [00:04<00:00, 82.22it/s]
50000 images processed, 4.93637228012085 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.05it/s] 10%|█         | 8/79 [00:00<00:04, 17.31it/s] 23%|██▎       | 18/79 [00:00<00:01, 36.51it/s] 35%|███▌      | 28/79 [00:00<00:00, 51.32it/s] 48%|████▊     | 38/79 [00:00<00:00, 62.80it/s] 59%|█████▉    | 47/79 [00:01<00:00, 69.98it/s] 72%|███████▏  | 57/79 [00:01<00:00, 77.57it/s] 85%|████████▍ | 67/79 [00:01<00:00, 83.14it/s] 97%|█████████▋| 77/79 [00:01<00:00, 87.25it/s]100%|██████████| 79/79 [00:01<00:00, 46.12it/s]
10000 images processed, 1.7411119937896729 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:03,  1.64it/s]  5%|▌         | 11/204 [00:00<00:09, 20.09it/s] 10%|▉         | 20/204 [00:00<00:05, 34.33it/s] 14%|█▍        | 29/204 [00:00<00:03, 47.08it/s] 19%|█▉        | 39/204 [00:01<00:02, 59.15it/s] 24%|██▍       | 49/204 [00:01<00:02, 68.45it/s] 29%|██▉       | 59/204 [00:01<00:01, 75.28it/s] 34%|███▍      | 69/204 [00:01<00:01, 80.44it/s] 39%|███▊      | 79/204 [00:01<00:01, 84.42it/s] 44%|████▎     | 89/204 [00:01<00:01, 87.17it/s] 49%|████▊     | 99/204 [00:01<00:01, 86.68it/s] 53%|█████▎    | 109/204 [00:02<00:02, 37.35it/s] 58%|█████▊    | 119/204 [00:02<00:01, 45.77it/s] 63%|██████▎   | 128/204 [00:02<00:01, 52.70it/s] 67%|██████▋   | 136/204 [00:02<00:01, 52.09it/s] 71%|███████   | 145/204 [00:02<00:01, 58.57it/s] 75%|███████▌  | 154/204 [00:02<00:00, 64.31it/s] 80%|███████▉  | 163/204 [00:02<00:00, 70.20it/s] 84%|████████▍ | 172/204 [00:03<00:00, 71.77it/s] 89%|████████▉ | 182/204 [00:03<00:00, 77.38it/s] 94%|█████████▍| 192/204 [00:03<00:00, 82.63it/s] 99%|█████████▉| 202/204 [00:03<00:00, 86.58it/s]100%|██████████| 204/204 [00:03<00:00, 59.37it/s]
26032 images processed, 3.5511770248413086 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:57,  1.35it/s]  6%|▋         | 5/79 [00:00<00:09,  7.59it/s] 19%|█▉        | 15/79 [00:00<00:02, 24.68it/s] 27%|██▋       | 21/79 [00:01<00:02, 28.88it/s] 34%|███▍      | 27/79 [00:01<00:01, 35.23it/s] 47%|████▋     | 37/79 [00:01<00:00, 49.41it/s] 59%|█████▉    | 47/79 [00:01<00:00, 60.97it/s] 72%|███████▏  | 57/79 [00:01<00:00, 68.75it/s] 85%|████████▍ | 67/79 [00:01<00:00, 74.03it/s] 97%|█████████▋| 77/79 [00:01<00:00, 80.23it/s]100%|██████████| 79/79 [00:01<00:00, 44.87it/s]
10000 images processed, 1.793306827545166 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:53,  1.45it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.11it/s] 27%|██▋       | 21/79 [00:00<00:01, 33.60it/s] 39%|███▉      | 31/79 [00:01<00:01, 47.37it/s] 52%|█████▏    | 41/79 [00:01<00:00, 58.57it/s] 65%|██████▍   | 51/79 [00:01<00:00, 67.75it/s] 77%|███████▋  | 61/79 [00:01<00:00, 75.55it/s] 90%|████████▉ | 71/79 [00:01<00:00, 81.50it/s]100%|██████████| 79/79 [00:01<00:00, 52.49it/s]
10000 images processed, 1.5639410018920898 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.74it/s] 16%|█▌        | 11/70 [00:00<00:02, 20.93it/s] 30%|███       | 21/70 [00:00<00:01, 37.55it/s] 44%|████▍     | 31/70 [00:00<00:00, 51.50it/s] 59%|█████▊    | 41/70 [00:01<00:00, 62.29it/s] 73%|███████▎  | 51/70 [00:01<00:00, 71.44it/s] 87%|████████▋ | 61/70 [00:01<00:00, 78.41it/s]100%|██████████| 70/70 [00:01<00:00, 52.45it/s]
8925 images processed, 1.4537453651428223 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:56,  1.28s/it]  4%|▍         | 2/45 [00:01<00:26,  1.64it/s] 20%|██        | 9/45 [00:01<00:03,  9.54it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.18it/s] 47%|████▋     | 21/45 [00:01<00:01, 18.37it/s] 56%|█████▌    | 25/45 [00:02<00:01, 16.99it/s] 73%|███████▎  | 33/45 [00:02<00:00, 17.86it/s] 87%|████████▋ | 39/45 [00:02<00:00, 22.62it/s] 96%|█████████▌| 43/45 [00:02<00:00, 23.52it/s]100%|██████████| 45/45 [00:02<00:00, 15.20it/s]
5640 images processed, 2.986574411392212 seconds used

19.81094002723694
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.30  99.11  91.07
places365     71.47  80.64  51.07
LSUN          34.99  92.46  77.30
iSUN          53.29  88.61  73.11
dtd           19.26  95.71  89.75
AVG           36.66  91.31  76.46
[incremental] Overall: 0.6410 New: 0.6700 Old: 0.6313
[incremental] Final(Top-1): 0.6410  Average: 0.7287
8.123934745788574
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.16it/s] 10%|█         | 8/79 [00:00<00:03, 17.92it/s] 19%|█▉        | 15/79 [00:00<00:02, 29.44it/s] 25%|██▌       | 20/79 [00:00<00:01, 31.56it/s] 32%|███▏      | 25/79 [00:00<00:01, 35.75it/s] 39%|███▉      | 31/79 [00:01<00:01, 41.48it/s] 46%|████▌     | 36/79 [00:01<00:01, 41.66it/s] 57%|█████▋    | 45/79 [00:01<00:00, 54.26it/s] 70%|██████▉   | 55/79 [00:01<00:00, 65.68it/s] 82%|████████▏ | 65/79 [00:01<00:00, 74.61it/s] 95%|█████████▍| 75/79 [00:01<00:00, 81.16it/s]100%|██████████| 79/79 [00:01<00:00, 49.24it/s]
10000 images processed, 1.6599857807159424 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  1.98it/s] 11%|█▏        | 8/70 [00:00<00:03, 16.90it/s] 19%|█▊        | 13/70 [00:00<00:02, 24.61it/s] 33%|███▎      | 23/70 [00:00<00:01, 43.05it/s] 47%|████▋     | 33/70 [00:00<00:00, 56.99it/s] 61%|██████▏   | 43/70 [00:01<00:00, 67.96it/s] 76%|███████▌  | 53/70 [00:01<00:00, 76.16it/s] 90%|█████████ | 63/70 [00:01<00:00, 82.20it/s]100%|██████████| 70/70 [00:01<00:00, 53.52it/s]
8925 images processed, 1.3351831436157227 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:44,  1.01s/it] 16%|█▌        | 7/45 [00:01<00:06,  6.01it/s] 36%|███▌      | 16/45 [00:01<00:01, 15.54it/s] 47%|████▋     | 21/45 [00:01<00:01, 16.83it/s] 56%|█████▌    | 25/45 [00:02<00:01, 13.45it/s] 73%|███████▎  | 33/45 [00:02<00:00, 20.63it/s] 87%|████████▋ | 39/45 [00:02<00:00, 19.27it/s]100%|██████████| 45/45 [00:02<00:00, 16.23it/s]
5640 images processed, 2.7959859371185303 seconds used

19.288480758666992
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.30  99.11  91.07
places365     71.47  80.64  51.07
LSUN          34.99  92.46  77.30
iSUN          53.29  88.61  73.11
dtd           19.26  95.71  89.75
AVG           36.66  91.31  76.46
[incremental] Overall: 0.6410 New: 0.6700 Old: 0.6313
[incremental] Final(Top-1): 0.6410  Average: 0.7287
8.073458433151245
[DEBUG] Parsed: avg_fpr=36.66 avg_auroc=91.31 final_top1=0.6410 average=0.7287
[Result] AVG-AUROC=91.31 AVG-FPR=36.66 Final-Top1=0.6410 Average=0.7287 Score=72.91

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=30 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=30, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/30 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  3%|▎         | 1/30 [00:16<07:58, 16.51s/it]  7%|▋         | 2/30 [00:25<05:32, 11.87s/it] 10%|█         | 3/30 [00:33<04:34, 10.16s/it] 13%|█▎        | 4/30 [00:41<04:01,  9.28s/it] 17%|█▋        | 5/30 [00:49<03:42,  8.91s/it] 20%|██        | 6/30 [00:57<03:28,  8.68s/it][loss] ep 0 it 0 total=8.5895 mle=3.2130 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6441 mle=3.2647 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0878 mle=3.7057 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6783 mle=3.2935 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9792 mle=2.5920 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9918 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4733 mle=4.0810 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4955 mle=3.1007 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5369 mle=3.1399 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2413 mle=2.8417 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7242 mle=3.3223 pcon=5.4019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0962 mle=3.6917 pcon=5.4045 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4460 mle=4.0388 pcon=5.4072 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3584 mle=2.9489 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0700 mle=3.6581 pcon=5.4119 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5544 mle=3.1402 pcon=5.4141 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5077 mle=3.0908 pcon=5.4169 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6320 mle=3.2131 pcon=5.4189 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2432 mle=2.8212 pcon=5.4220 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4330 mle=3.0086 pcon=5.4244 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7380 mle=2.3111 pcon=5.4269 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6783 mle=3.2490 pcon=5.4294 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8373 mle=3.4054 pcon=5.4319 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7150 mle=2.2805 pcon=5.4345 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.2998 mle=2.8636 pcon=5.4362 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4256 mle=2.9875 pcon=5.4381 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1017 mle=2.6617 pcon=5.4400 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9324 mle=2.4908 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6431 mle=2.2004 pcon=5.4427 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6507 mle=2.2065 pcon=5.4442 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6233 mle=2.1786 pcon=5.4447 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6686 mle=2.2231 pcon=5.4456 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6921 mle=2.2454 pcon=5.4467 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6984 mle=2.2506 pcon=5.4478 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7880 mle=2.3396 pcon=5.4484 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4444 mle=1.9941 pcon=5.4503 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4891 mle=2.0371 pcon=5.4520 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4847 mle=2.0299 pcon=5.4548 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9108 mle=2.4540 pcon=5.4568 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4956 mle=2.0363 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 5 it 45 total=7.5990 mle=2.1381 pcon=5.4609 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.5303 mle=2.0671 pcon=5.4632 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.5469 mle=2.0818 pcon=5.4652 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.6397 mle=2.1722 pcon=5.4675 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.6795 mle=2.2099 pcon=5.4696 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.3913 mle=1.9189 pcon=5.4724 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7726 mle=2.2975 pcon=5.4751 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 6 it 4 total=7.6269 mle=2.1494 pcon=5.4775 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.7450 mle=2.2647 pcon=5.4803 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.5335 mle=2.0505 pcon=5.4829 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.3492 mle=1.8647 pcon=5.4845 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.5079 mle=2.0202 pcon=5.4878 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
 23%|██▎       | 7/30 [01:05<03:16,  8.55s/it] 27%|██▋       | 8/30 [01:13<03:01,  8.23s/it] 30%|███       | 9/30 [01:21<02:50,  8.13s/it] 33%|███▎      | 10/30 [01:29<02:41,  8.08s/it] 37%|███▋      | 11/30 [01:37<02:33,  8.10s/it] 40%|████      | 12/30 [01:45<02:26,  8.11s/it] 43%|████▎     | 13/30 [01:53<02:18,  8.14s/it] 47%|████▋     | 14/30 [02:02<02:10,  8.16s/it][loss] ep 6 it 254 total=7.5030 mle=2.0122 pcon=5.4908 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.9121 mle=2.4183 pcon=5.4938 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.4511 mle=1.9539 pcon=5.4972 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 13 total=7.7897 mle=2.2890 pcon=5.5007 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.9123 mle=2.4082 pcon=5.5041 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.7384 mle=2.2307 pcon=5.5077 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.8010 mle=2.2897 pcon=5.5113 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.5631 mle=2.0489 pcon=5.5142 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.6840 mle=2.1656 pcon=5.5184 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.5469 mle=2.0251 pcon=5.5218 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.6893 mle=2.1635 pcon=5.5258 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 22 total=7.6969 mle=2.1677 pcon=5.5292 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.5196 mle=1.9873 pcon=5.5323 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.3986 mle=1.8632 pcon=5.5354 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=7.3096 mle=1.7705 pcon=5.5392 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=7.3353 mle=1.7921 pcon=5.5431 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.5152 mle=1.9686 pcon=5.5465 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=7.5384 mle=1.9885 pcon=5.5499 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=7.7812 mle=2.2276 pcon=5.5536 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 31 total=7.9270 mle=2.3706 pcon=5.5565 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=7.6419 mle=2.0820 pcon=5.5599 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=7.4834 mle=1.9207 pcon=5.5627 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=7.6008 mle=2.0349 pcon=5.5659 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=7.5367 mle=1.9672 pcon=5.5695 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=7.5926 mle=2.0194 pcon=5.5731 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=7.6972 mle=2.1211 pcon=5.5761 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=7.5189 mle=1.9396 pcon=5.5793 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 40 total=7.4385 mle=1.8567 pcon=5.5818 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=7.9047 mle=2.3206 pcon=5.5841 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=7.5866 mle=1.9996 pcon=5.5870 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=7.5870 mle=1.9971 pcon=5.5899 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=7.4325 mle=1.8403 pcon=5.5922 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=7.8545 mle=2.2592 pcon=5.5953 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=7.5762 mle=1.9787 pcon=5.5974 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=7.8368 mle=2.2363 pcon=5.6005 forget=0.0000 orth=0.0000 favg=0.0000 nr=77 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 49 total=7.5663 mle=1.9626 pcon=5.6037 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=7.9002 mle=2.2935 pcon=5.6067 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=7.7698 mle=2.1604 pcon=5.6094 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=7.6113 mle=1.9989 pcon=5.6125 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=7.4137 mle=1.7980 pcon=5.6157 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=7.7318 mle=2.1135 pcon=5.6182 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=7.4544 mle=1.8339 pcon=5.6205 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 8 total=7.8479 mle=2.2249 pcon=5.6230 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=7.6099 mle=1.9846 pcon=5.6254 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=7.8280 mle=2.1998 pcon=5.6281 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=7.5991 mle=1.9682 pcon=5.6309 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=7.6265 mle=1.9931 pcon=5.6335 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=7.9020 mle=2.2659 pcon=5.6361 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=7.7430 mle=2.1049 pcon=5.6381 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=7.7905 mle=2.1498 pcon=5.6407 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 17 total=7.8737 mle=2.2305 pcon=5.6432 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=7.6740 mle=2.0283 pcon=5.6457 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=7.9258 mle=2.2784 pcon=5.6474 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=7.7543 mle=2.1050 pcon=5.6493 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=7.9475 mle=2.2968 pcon=5.6506 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=7.8503 mle=2.1974 pcon=5.6530 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=7.7401 mle=2.0853 pcon=5.6549 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=7.7595 mle=2.1020 pcon=5.6575 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 26 total=7.9677 mle=2.3085 pcon=5.6593 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=7.7013 mle=2.0404 pcon=5.6609 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=7.7289 mle=2.0667 pcon=5.6622 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=7.8703 mle=2.2067 pcon=5.6636 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
 50%|█████     | 15/30 [02:09<02:00,  8.05s/it] 53%|█████▎    | 16/30 [02:17<01:52,  8.04s/it] 57%|█████▋    | 17/30 [02:25<01:43,  7.99s/it] 60%|██████    | 18/30 [02:33<01:36,  8.04s/it] 63%|██████▎   | 19/30 [02:42<01:29,  8.10s/it] 67%|██████▋   | 20/30 [02:50<01:20,  8.06s/it] 70%|███████   | 21/30 [02:58<01:13,  8.15s/it] 73%|███████▎  | 22/30 [03:06<01:05,  8.19s/it][loss] ep 14 it 226 total=7.6120 mle=1.9465 pcon=5.6654 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=7.8310 mle=2.1633 pcon=5.6677 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=7.7759 mle=2.1067 pcon=5.6692 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=7.5915 mle=1.9205 pcon=5.6709 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 15 it 35 total=7.8057 mle=2.1331 pcon=5.6727 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=7.7872 mle=2.1125 pcon=5.6747 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=7.6457 mle=1.9694 pcon=5.6763 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=7.6457 mle=1.9684 pcon=5.6773 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=7.8562 mle=2.1780 pcon=5.6782 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=7.7262 mle=2.0466 pcon=5.6796 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=7.9084 mle=2.2276 pcon=5.6808 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=7.6826 mle=2.0002 pcon=5.6824 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 44 total=7.8772 mle=2.1939 pcon=5.6833 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=7.8321 mle=2.1473 pcon=5.6848 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=7.7374 mle=2.0515 pcon=5.6859 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=7.7368 mle=2.0499 pcon=5.6869 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=7.6673 mle=1.9792 pcon=5.6881 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=7.5880 mle=1.8988 pcon=5.6892 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=7.7529 mle=2.0634 pcon=5.6896 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 3 total=7.4743 mle=1.7835 pcon=5.6908 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=7.5377 mle=1.8459 pcon=5.6918 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=7.7251 mle=2.0322 pcon=5.6929 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=7.5302 mle=1.8361 pcon=5.6941 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=7.6390 mle=1.9440 pcon=5.6950 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=7.7548 mle=2.0597 pcon=5.6951 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=7.6399 mle=1.9442 pcon=5.6957 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=7.6493 mle=1.9530 pcon=5.6963 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 12 total=7.6814 mle=1.9846 pcon=5.6968 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=7.9814 mle=2.2845 pcon=5.6969 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=7.6357 mle=1.9385 pcon=5.6971 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=7.7765 mle=2.0790 pcon=5.6975 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=7.8470 mle=2.1490 pcon=5.6980 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=7.6911 mle=1.9931 pcon=5.6980 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=7.6223 mle=1.9238 pcon=5.6985 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=7.5029 mle=1.8041 pcon=5.6988 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 21 total=7.6738 mle=1.9745 pcon=5.6993 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=7.7390 mle=2.0394 pcon=5.6996 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=7.6611 mle=1.9616 pcon=5.6995 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=7.7335 mle=2.0336 pcon=5.6999 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=7.7463 mle=2.0460 pcon=5.7003 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=7.9177 mle=2.2172 pcon=5.7005 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=7.8381 mle=2.1373 pcon=5.7009 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=7.7606 mle=2.0598 pcon=5.7007 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 30 total=7.8538 mle=2.1526 pcon=5.7012 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=7.6154 mle=1.9137 pcon=5.7017 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=7.7764 mle=2.0748 pcon=5.7016 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=7.8374 mle=2.1348 pcon=5.7026 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=7.5367 mle=1.8341 pcon=5.7027 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=7.7819 mle=2.0803 pcon=5.7016 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=8.0170 mle=2.3149 pcon=5.7021 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=7.9690 mle=2.2663 pcon=5.7027 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 39 total=7.7890 mle=2.0871 pcon=5.7019 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=7.5887 mle=1.8863 pcon=5.7024 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=7.7174 mle=2.0153 pcon=5.7022 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=7.5519 mle=1.8495 pcon=5.7024 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=7.8847 mle=2.1828 pcon=5.7018 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=7.6385 mle=1.9366 pcon=5.7019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=7.6627 mle=1.9605 pcon=5.7022 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=7.9019 mle=2.1996 pcon=5.7022 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 48 total=7.8594 mle=2.1570 pcon=5.7025 forget=0.0000 orth=0.0000 favg=0.0000 nr=115 nf=13 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=7.7476 mle=2.0453 pcon=5.7023 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=7.7399 mle=2.0375 pcon=5.7025 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
 77%|███████▋  | 23/30 [03:14<00:56,  8.01s/it] 80%|████████  | 24/30 [03:22<00:47,  7.99s/it] 83%|████████▎ | 25/30 [03:30<00:40,  8.01s/it] 87%|████████▋ | 26/30 [03:38<00:31,  7.99s/it] 90%|█████████ | 27/30 [03:47<00:24,  8.24s/it] 93%|█████████▎| 28/30 [03:54<00:16,  8.11s/it] 97%|█████████▋| 29/30 [04:02<00:08,  8.10s/it]100%|██████████| 30/30 [04:10<00:00,  8.03s/it]100%|██████████| 30/30 [04:10<00:00,  8.36s/it]
[loss] ep 22 it 198 total=7.6477 mle=1.9446 pcon=5.7031 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=7.8042 mle=2.1009 pcon=5.7034 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=7.8044 mle=2.1017 pcon=5.7026 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=7.8870 mle=2.1846 pcon=5.7024 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 7 total=7.7712 mle=2.0692 pcon=5.7020 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=7.7949 mle=2.0927 pcon=5.7022 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=7.4887 mle=1.7864 pcon=5.7023 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=8.0641 mle=2.3625 pcon=5.7016 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=7.8316 mle=2.1297 pcon=5.7019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=7.7913 mle=2.0892 pcon=5.7021 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=7.7973 mle=2.0951 pcon=5.7022 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=7.6461 mle=1.9446 pcon=5.7015 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 16 total=7.8739 mle=2.1734 pcon=5.7005 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=7.6752 mle=1.9748 pcon=5.7004 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=7.8604 mle=2.1599 pcon=5.7005 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=7.8390 mle=2.1391 pcon=5.6999 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=7.5971 mle=1.8978 pcon=5.6993 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=7.7383 mle=2.0394 pcon=5.6989 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=7.7245 mle=2.0254 pcon=5.6992 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=8.0635 mle=2.3640 pcon=5.6995 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 25 it 25 total=7.5628 mle=1.8638 pcon=5.6990 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=7.6871 mle=1.9874 pcon=5.6997 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=7.9671 mle=2.2681 pcon=5.6991 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=7.7605 mle=2.0615 pcon=5.6990 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=7.5509 mle=1.8524 pcon=5.6986 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=7.9042 mle=2.2060 pcon=5.6981 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=7.6708 mle=1.9726 pcon=5.6982 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=7.8027 mle=2.1056 pcon=5.6971 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 34 total=7.5959 mle=1.8986 pcon=5.6973 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=7.8418 mle=2.1451 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=7.7628 mle=2.0659 pcon=5.6970 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=7.7986 mle=2.1022 pcon=5.6964 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=7.6505 mle=1.9538 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=7.8481 mle=2.1514 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=7.7692 mle=2.0730 pcon=5.6962 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=7.6446 mle=1.9483 pcon=5.6964 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 43 total=7.9234 mle=2.2267 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=7.7934 mle=2.0965 pcon=5.6968 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=7.8562 mle=2.1593 pcon=5.6970 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=7.7658 mle=2.0691 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=7.7874 mle=2.0907 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=7.6663 mle=1.9695 pcon=5.6968 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=7.4787 mle=1.7821 pcon=5.6966 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 2 total=7.6099 mle=1.9143 pcon=5.6957 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=7.9205 mle=2.2251 pcon=5.6953 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=7.7131 mle=2.0187 pcon=5.6944 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=7.9598 mle=2.2654 pcon=5.6944 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=7.7737 mle=2.0799 pcon=5.6938 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=7.8073 mle=2.1138 pcon=5.6936 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=7.4608 mle=1.7672 pcon=5.6936 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=7.5903 mle=1.8974 pcon=5.6928 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 11 total=7.5949 mle=1.9022 pcon=5.6927 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=7.8066 mle=2.1139 pcon=5.6928 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=8.0058 mle=2.3133 pcon=5.6925 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=7.5533 mle=1.8611 pcon=5.6922 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=7.8430 mle=2.1509 pcon=5.6921 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=7.7384 mle=2.0460 pcon=5.6924 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=7.6841 mle=1.9917 pcon=5.6924 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=8.0151 mle=2.3229 pcon=5.6921 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:56,  1.32it/s]  3%|▎         | 11/391 [00:00<00:22, 16.76it/s]  5%|▌         | 21/391 [00:00<00:11, 31.64it/s]  8%|▊         | 31/391 [00:01<00:07, 45.22it/s] 10%|█         | 41/391 [00:01<00:06, 56.88it/s] 13%|█▎        | 51/391 [00:01<00:05, 66.35it/s] 16%|█▌        | 61/391 [00:01<00:04, 73.28it/s] 18%|█▊        | 71/391 [00:01<00:04, 79.16it/s] 21%|██        | 81/391 [00:01<00:03, 83.58it/s] 23%|██▎       | 91/391 [00:01<00:03, 86.86it/s] 26%|██▌       | 101/391 [00:01<00:03, 88.80it/s] 28%|██▊       | 111/391 [00:01<00:03, 88.50it/s] 31%|███       | 121/391 [00:02<00:03, 86.34it/s] 34%|███▎      | 131/391 [00:02<00:02, 88.88it/s] 36%|███▌      | 141/391 [00:02<00:02, 90.88it/s] 39%|███▊      | 151/391 [00:02<00:02, 91.99it/s] 41%|████      | 161/391 [00:02<00:02, 92.32it/s] 44%|████▎     | 171/391 [00:02<00:02, 93.28it/s] 46%|████▋     | 181/391 [00:02<00:02, 93.87it/s] 49%|████▉     | 191/391 [00:02<00:02, 94.31it/s] 51%|█████▏    | 201/391 [00:02<00:02, 94.58it/s] 54%|█████▍    | 211/391 [00:03<00:01, 93.99it/s] 57%|█████▋    | 221/391 [00:03<00:01, 94.07it/s] 59%|█████▉    | 231/391 [00:03<00:01, 94.03it/s] 62%|██████▏   | 241/391 [00:03<00:01, 94.40it/s] 64%|██████▍   | 251/391 [00:03<00:01, 93.89it/s] 67%|██████▋   | 261/391 [00:03<00:01, 94.10it/s] 69%|██████▉   | 271/391 [00:03<00:01, 94.07it/s] 72%|███████▏  | 281/391 [00:03<00:01, 93.94it/s] 74%|███████▍  | 291/391 [00:03<00:01, 94.39it/s] 77%|███████▋  | 301/391 [00:03<00:00, 93.79it/s] 80%|███████▉  | 311/391 [00:04<00:00, 89.08it/s] 82%|████████▏ | 321/391 [00:04<00:00, 90.65it/s] 85%|████████▍ | 331/391 [00:04<00:00, 91.20it/s] 87%|████████▋ | 341/391 [00:04<00:00, 91.89it/s] 90%|████████▉ | 351/391 [00:04<00:00, 92.87it/s] 92%|█████████▏| 361/391 [00:04<00:00, 91.86it/s] 95%|█████████▍| 371/391 [00:04<00:00, 93.40it/s] 97%|█████████▋| 381/391 [00:04<00:00, 94.48it/s]100%|██████████| 391/391 [00:04<00:00, 92.02it/s]100%|██████████| 391/391 [00:04<00:00, 79.04it/s]
50000 images processed, 4.992246866226196 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:57,  1.35it/s] 11%|█▏        | 9/79 [00:00<00:05, 13.87it/s] 24%|██▍       | 19/79 [00:00<00:02, 29.54it/s] 37%|███▋      | 29/79 [00:01<00:01, 43.39it/s] 49%|████▉     | 39/79 [00:01<00:00, 55.21it/s] 62%|██████▏   | 49/79 [00:01<00:00, 65.17it/s] 75%|███████▍  | 59/79 [00:01<00:00, 73.37it/s] 87%|████████▋ | 69/79 [00:01<00:00, 79.68it/s]100%|██████████| 79/79 [00:01<00:00, 78.02it/s]100%|██████████| 79/79 [00:01<00:00, 48.84it/s]
10000 images processed, 1.6318931579589844 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:31,  1.34it/s]  5%|▌         | 11/204 [00:00<00:11, 16.98it/s] 10%|█         | 21/204 [00:00<00:05, 32.01it/s] 15%|█▍        | 30/204 [00:01<00:04, 43.48it/s] 20%|█▉        | 40/204 [00:01<00:02, 55.31it/s] 24%|██▍       | 49/204 [00:01<00:02, 63.22it/s] 29%|██▉       | 59/204 [00:01<00:02, 70.97it/s] 33%|███▎      | 68/204 [00:01<00:01, 70.00it/s] 38%|███▊      | 77/204 [00:01<00:01, 74.34it/s] 43%|████▎     | 87/204 [00:01<00:01, 79.07it/s] 47%|████▋     | 96/204 [00:01<00:01, 81.38it/s] 52%|█████▏    | 106/204 [00:01<00:01, 84.67it/s] 57%|█████▋    | 116/204 [00:02<00:01, 86.73it/s] 61%|██████▏   | 125/204 [00:02<00:00, 86.76it/s] 66%|██████▌   | 135/204 [00:02<00:00, 88.33it/s] 71%|███████   | 145/204 [00:02<00:00, 90.13it/s] 76%|███████▌  | 155/204 [00:02<00:00, 91.43it/s] 81%|████████  | 165/204 [00:02<00:00, 92.25it/s] 86%|████████▌ | 175/204 [00:02<00:00, 93.27it/s] 91%|█████████ | 185/204 [00:02<00:00, 94.25it/s] 96%|█████████▌| 195/204 [00:02<00:00, 94.91it/s]100%|██████████| 204/204 [00:02<00:00, 68.22it/s]
26032 images processed, 3.0264811515808105 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:07,  1.15it/s] 11%|█▏        | 9/79 [00:00<00:05, 12.25it/s] 19%|█▉        | 15/79 [00:01<00:03, 20.03it/s] 30%|███       | 24/79 [00:01<00:01, 33.39it/s] 43%|████▎     | 34/79 [00:01<00:00, 46.95it/s] 56%|█████▌    | 44/79 [00:01<00:00, 58.19it/s] 68%|██████▊   | 54/79 [00:01<00:00, 67.34it/s] 81%|████████  | 64/79 [00:01<00:00, 74.79it/s] 94%|█████████▎| 74/79 [00:01<00:00, 80.58it/s]100%|██████████| 79/79 [00:01<00:00, 44.44it/s]
10000 images processed, 1.803466558456421 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.71it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.60it/s] 25%|██▌       | 20/79 [00:00<00:01, 35.24it/s] 38%|███▊      | 30/79 [00:00<00:00, 49.39it/s] 51%|█████     | 40/79 [00:01<00:00, 61.01it/s] 63%|██████▎   | 50/79 [00:01<00:00, 70.13it/s] 76%|███████▌  | 60/79 [00:01<00:00, 77.34it/s] 89%|████████▊ | 70/79 [00:01<00:00, 82.75it/s]100%|██████████| 79/79 [00:01<00:00, 55.94it/s]
10000 images processed, 1.4315123558044434 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:51,  1.34it/s] 13%|█▎        | 9/70 [00:00<00:04, 13.90it/s] 23%|██▎       | 16/70 [00:00<00:02, 23.93it/s] 37%|███▋      | 26/70 [00:01<00:01, 38.72it/s] 51%|█████▏    | 36/70 [00:01<00:00, 51.82it/s] 66%|██████▌   | 46/70 [00:01<00:00, 62.72it/s] 79%|███████▊  | 55/70 [00:01<00:00, 67.24it/s] 93%|█████████▎| 65/70 [00:01<00:00, 74.91it/s]100%|██████████| 70/70 [00:01<00:00, 45.01it/s]
8925 images processed, 1.5869076251983643 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.03it/s]  4%|▍         | 2/45 [00:01<00:22,  1.91it/s] 27%|██▋       | 12/45 [00:01<00:02, 15.30it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.92it/s] 47%|████▋     | 21/45 [00:01<00:01, 15.91it/s] 62%|██████▏   | 28/45 [00:01<00:00, 23.89it/s] 73%|███████▎  | 33/45 [00:02<00:00, 18.59it/s] 82%|████████▏ | 37/45 [00:02<00:00, 21.41it/s] 98%|█████████▊| 44/45 [00:02<00:00, 29.31it/s]100%|██████████| 45/45 [00:02<00:00, 17.52it/s]
5640 images processed, 2.5882349014282227 seconds used

18.828310251235962
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.60
places365     49.92  89.49  51.36
LSUN          25.93  95.19  76.04
iSUN          26.01  95.03  73.73
dtd           24.68  94.43  71.73
AVG           26.02  94.63  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
3.2606751918792725
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=30, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/30 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  3%|▎         | 1/30 [00:17<08:23, 17.36s/it]  7%|▋         | 2/30 [00:29<06:36, 14.16s/it] 10%|█         | 3/30 [00:40<05:41, 12.66s/it] 13%|█▎        | 4/30 [00:51<05:20, 12.33s/it] 17%|█▋        | 5/30 [01:04<05:12, 12.49s/it] 20%|██        | 6/30 [01:15<04:45, 11.88s/it][loss] ep 0 it 0 total=12.0911 mle=2.3148 pcon=8.7277 forget=0.0000 orth=1.0486 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0666 mle=2.2863 pcon=8.7318 forget=0.0000 orth=1.0485 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2136 mle=2.4299 pcon=8.7353 forget=0.0000 orth=1.0484 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1215 mle=2.3345 pcon=8.7388 forget=0.0000 orth=1.0482 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7747 mle=1.9850 pcon=8.7417 forget=0.0000 orth=1.0480 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=11.9871 mle=2.1951 pcon=8.7443 forget=0.0000 orth=1.0477 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4180 mle=2.6241 pcon=8.7466 forget=0.0000 orth=1.0474 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9928 mle=2.1974 pcon=8.7483 forget=0.0000 orth=1.0471 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9500 mle=2.1529 pcon=8.7504 forget=0.0000 orth=1.0467 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9381 mle=2.1394 pcon=8.7524 forget=0.0000 orth=1.0463 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0896 mle=2.2897 pcon=8.7540 forget=0.0000 orth=1.0459 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3273 mle=2.5262 pcon=8.7557 forget=0.0000 orth=1.0454 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2573 mle=2.4555 pcon=8.7568 forget=0.0000 orth=1.0450 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.8904 mle=2.0880 pcon=8.7580 forget=0.0000 orth=1.0445 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.1924 mle=2.3893 pcon=8.7592 forget=0.0000 orth=1.0439 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0807 mle=2.2771 pcon=8.7603 forget=0.0000 orth=1.0433 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0150 mle=2.2114 pcon=8.7611 forget=0.0000 orth=1.0425 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0753 mle=2.2714 pcon=8.7622 forget=0.0000 orth=1.0418 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9127 mle=2.1079 pcon=8.7636 forget=0.0000 orth=1.0411 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9621 mle=2.1570 pcon=8.7647 forget=0.0000 orth=1.0403 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5837 mle=1.7782 pcon=8.7660 forget=0.0000 orth=1.0396 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1267 mle=2.3213 pcon=8.7666 forget=0.0000 orth=1.0388 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1813 mle=2.3761 pcon=8.7674 forget=0.0000 orth=1.0379 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6933 mle=1.8875 pcon=8.7688 forget=0.0000 orth=1.0370 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0750 mle=2.2698 pcon=8.7692 forget=0.0000 orth=1.0360 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1937 mle=2.3885 pcon=8.7703 forget=0.0000 orth=1.0349 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1310 mle=2.3260 pcon=8.7711 forget=0.0000 orth=1.0339 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0205 mle=2.2154 pcon=8.7722 forget=0.0000 orth=1.0329 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9360 mle=2.1308 pcon=8.7735 forget=0.0000 orth=1.0318 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9652 mle=2.1601 pcon=8.7745 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9501 mle=2.1455 pcon=8.7752 forget=0.0000 orth=1.0293 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.0058 mle=2.2017 pcon=8.7760 forget=0.0000 orth=1.0281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0140 mle=2.2097 pcon=8.7775 forget=0.0000 orth=1.0268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0257 mle=2.2213 pcon=8.7786 forget=0.0000 orth=1.0259 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1449 mle=2.3406 pcon=8.7795 forget=0.0000 orth=1.0247 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8311 mle=2.0274 pcon=8.7803 forget=0.0000 orth=1.0234 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8796 mle=2.0765 pcon=8.7811 forget=0.0000 orth=1.0219 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8366 mle=2.0335 pcon=8.7825 forget=0.0000 orth=1.0206 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1785 mle=2.3753 pcon=8.7836 forget=0.0000 orth=1.0196 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.8035 mle=2.0002 pcon=8.7849 forget=0.0000 orth=1.0184 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 5 it 45 total=11.9766 mle=2.1740 pcon=8.7856 forget=0.0000 orth=1.0170 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=11.8751 mle=2.0728 pcon=8.7868 forget=0.0000 orth=1.0154 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=11.9058 mle=2.1041 pcon=8.7875 forget=0.0000 orth=1.0142 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=11.9911 mle=2.1895 pcon=8.7889 forget=0.0000 orth=1.0127 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.0464 mle=2.2448 pcon=8.7903 forget=0.0000 orth=1.0114 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=11.7280 mle=1.9260 pcon=8.7921 forget=0.0000 orth=1.0100 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.1236 mle=2.3213 pcon=8.7937 forget=0.0000 orth=1.0086 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 6 it 4 total=11.9789 mle=2.1771 pcon=8.7944 forget=0.0000 orth=1.0074 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.0673 mle=2.2651 pcon=8.7962 forget=0.0000 orth=1.0061 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.8459 mle=2.0434 pcon=8.7980 forget=0.0000 orth=1.0046 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.6709 mle=1.8691 pcon=8.7986 forget=0.0000 orth=1.0032 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
 23%|██▎       | 7/30 [01:26<04:28, 11.67s/it] 27%|██▋       | 8/30 [01:38<04:18, 11.75s/it] 30%|███       | 9/30 [01:50<04:05, 11.68s/it] 33%|███▎      | 10/30 [02:01<03:49, 11.45s/it] 37%|███▋      | 11/30 [02:12<03:35, 11.35s/it] 40%|████      | 12/30 [02:22<03:20, 11.13s/it][loss] ep 6 it 204 total=11.8447 mle=2.0433 pcon=8.7997 forget=0.0000 orth=1.0016 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.8537 mle=2.0525 pcon=8.8008 forget=0.0000 orth=1.0003 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2115 mle=2.4099 pcon=8.8026 forget=0.0000 orth=0.9991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.7712 mle=1.9695 pcon=8.8040 forget=0.0000 orth=0.9977 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 7 it 13 total=12.1377 mle=2.3356 pcon=8.8056 forget=0.0000 orth=0.9965 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2207 mle=2.4183 pcon=8.8072 forget=0.0000 orth=0.9952 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0887 mle=2.2862 pcon=8.8088 forget=0.0000 orth=0.9937 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1134 mle=2.3103 pcon=8.8107 forget=0.0000 orth=0.9924 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9123 mle=2.1098 pcon=8.8114 forget=0.0000 orth=0.9911 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9888 mle=2.1854 pcon=8.8136 forget=0.0000 orth=0.9898 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8657 mle=2.0618 pcon=8.8155 forget=0.0000 orth=0.9885 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0131 mle=2.2089 pcon=8.8172 forget=0.0000 orth=0.9870 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 8 it 22 total=11.9795 mle=2.1751 pcon=8.8184 forget=0.0000 orth=0.9860 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8127 mle=2.0083 pcon=8.8198 forget=0.0000 orth=0.9845 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7030 mle=1.8989 pcon=8.8210 forget=0.0000 orth=0.9831 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5988 mle=1.7945 pcon=8.8225 forget=0.0000 orth=0.9818 favg=0.0000 nr=124 nf=1 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6306 mle=1.8261 pcon=8.8242 forget=0.0000 orth=0.9803 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.7918 mle=1.9876 pcon=8.8250 forget=0.0000 orth=0.9791 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8223 mle=2.0181 pcon=8.8265 forget=0.0000 orth=0.9777 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0349 mle=2.2300 pcon=8.8286 forget=0.0000 orth=0.9763 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 9 it 31 total=12.1878 mle=2.3830 pcon=8.8301 forget=0.0000 orth=0.9748 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9305 mle=2.1259 pcon=8.8310 forget=0.0000 orth=0.9736 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7379 mle=1.9342 pcon=8.8317 forget=0.0000 orth=0.9719 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8460 mle=2.0426 pcon=8.8325 forget=0.0000 orth=0.9709 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7758 mle=1.9714 pcon=8.8353 forget=0.0000 orth=0.9691 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8326 mle=2.0283 pcon=8.8369 forget=0.0000 orth=0.9674 favg=0.0000 nr=122 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9326 mle=2.1282 pcon=8.8389 forget=0.0000 orth=0.9656 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7591 mle=1.9546 pcon=8.8403 forget=0.0000 orth=0.9642 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 10 it 40 total=11.6744 mle=1.8697 pcon=8.8420 forget=0.0000 orth=0.9627 favg=0.0000 nr=123 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.1513 mle=2.3473 pcon=8.8429 forget=0.0000 orth=0.9611 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.8340 mle=2.0297 pcon=8.8450 forget=0.0000 orth=0.9593 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.8001 mle=1.9960 pcon=8.8467 forget=0.0000 orth=0.9574 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6463 mle=1.8433 pcon=8.8471 forget=0.0000 orth=0.9559 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0893 mle=2.2862 pcon=8.8494 forget=0.0000 orth=0.9537 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.7923 mle=1.9905 pcon=8.8500 forget=0.0000 orth=0.9517 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.0292 mle=2.2285 pcon=8.8511 forget=0.0000 orth=0.9496 favg=0.0000 nr=74 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 11 it 49 total=11.7755 mle=1.9753 pcon=8.8528 forget=0.0000 orth=0.9474 favg=0.0000 nr=117 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.0826 mle=2.2831 pcon=8.8540 forget=0.0000 orth=0.9454 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.9662 mle=2.1683 pcon=8.8549 forget=0.0000 orth=0.9430 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.8133 mle=2.0166 pcon=8.8560 forget=0.0000 orth=0.9408 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.6016 mle=1.8060 pcon=8.8572 forget=0.0000 orth=0.9383 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.9104 mle=2.1167 pcon=8.8580 forget=0.0000 orth=0.9356 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.6431 mle=1.8509 pcon=8.8593 forget=0.0000 orth=0.9329 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 12 it 8 total=11.9886 mle=2.1974 pcon=8.8609 forget=0.0000 orth=0.9303 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.7800 mle=1.9914 pcon=8.8615 forget=0.0000 orth=0.9271 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.9809 mle=2.1944 pcon=8.8624 forget=0.0000 orth=0.9240 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.7493 mle=1.9651 pcon=8.8634 forget=0.0000 orth=0.9208 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.7786 mle=1.9970 pcon=8.8644 forget=0.0000 orth=0.9172 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.0687 mle=2.2889 pcon=8.8661 forget=0.0000 orth=0.9137 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8776 mle=2.1013 pcon=8.8663 forget=0.0000 orth=0.9099 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9366 mle=2.1629 pcon=8.8676 forget=0.0000 orth=0.9061 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
 43%|████▎     | 13/30 [02:33<03:05, 10.89s/it] 47%|████▋     | 14/30 [02:43<02:51, 10.72s/it] 50%|█████     | 15/30 [02:54<02:42, 10.86s/it] 53%|█████▎    | 16/30 [03:05<02:31, 10.83s/it] 57%|█████▋    | 17/30 [03:16<02:21, 10.87s/it] 60%|██████    | 18/30 [03:27<02:11, 10.98s/it] 63%|██████▎   | 19/30 [03:38<01:59, 10.88s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 13 it 17 total=11.9978 mle=2.2267 pcon=8.8692 forget=0.0000 orth=0.9019 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.7788 mle=2.0109 pcon=8.8701 forget=0.0000 orth=0.8978 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.0314 mle=2.2672 pcon=8.8708 forget=0.0000 orth=0.8934 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.8704 mle=2.1111 pcon=8.8704 forget=0.0000 orth=0.8889 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.0454 mle=2.2906 pcon=8.8707 forget=0.0000 orth=0.8842 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.9495 mle=2.1995 pcon=8.8707 forget=0.0000 orth=0.8793 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.8370 mle=2.0912 pcon=8.8716 forget=0.0000 orth=0.8741 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.8557 mle=2.1151 pcon=8.8717 forget=0.0000 orth=0.8689 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 14 it 26 total=12.0248 mle=2.2897 pcon=8.8717 forget=0.0000 orth=0.8634 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.7350 mle=2.0054 pcon=8.8716 forget=0.0000 orth=0.8580 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.7849 mle=2.0606 pcon=8.8720 forget=0.0000 orth=0.8523 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.9302 mle=2.2142 pcon=8.8696 forget=0.0000 orth=0.8464 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.6361 mle=1.9264 pcon=8.8693 forget=0.0000 orth=0.8404 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.8532 mle=2.1500 pcon=8.8687 forget=0.0000 orth=0.8344 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.7819 mle=2.0854 pcon=8.8684 forget=0.0000 orth=0.8282 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.5933 mle=1.9041 pcon=8.8673 forget=0.0000 orth=0.8218 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 15 it 35 total=11.7727 mle=2.0907 pcon=8.8668 forget=0.0000 orth=0.8153 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.7563 mle=2.0817 pcon=8.8659 forget=0.0000 orth=0.8087 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.6279 mle=1.9607 pcon=8.8650 forget=0.0000 orth=0.8022 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.6253 mle=1.9663 pcon=8.8636 forget=0.0000 orth=0.7954 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.8363 mle=2.1856 pcon=8.8621 forget=0.0000 orth=0.7886 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.6772 mle=2.0340 pcon=8.8615 forget=0.0000 orth=0.7817 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.8326 mle=2.1985 pcon=8.8593 forget=0.0000 orth=0.7748 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.6221 mle=1.9962 pcon=8.8583 forget=0.0000 orth=0.7677 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 16 it 44 total=11.7423 mle=2.1254 pcon=8.8563 forget=0.0000 orth=0.7606 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.7752 mle=2.1665 pcon=8.8553 forget=0.0000 orth=0.7534 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.5933 mle=1.9933 pcon=8.8537 forget=0.0000 orth=0.7463 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.6103 mle=2.0195 pcon=8.8517 forget=0.0000 orth=0.7391 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.5281 mle=1.9463 pcon=8.8499 forget=0.0000 orth=0.7318 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.4392 mle=1.8670 pcon=8.8477 forget=0.0000 orth=0.7245 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.5935 mle=2.0303 pcon=8.8459 forget=0.0000 orth=0.7172 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 17 it 3 total=11.3374 mle=1.7831 pcon=8.8444 forget=0.0000 orth=0.7099 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.3664 mle=1.8214 pcon=8.8424 forget=0.0000 orth=0.7026 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.5310 mle=1.9946 pcon=8.8412 forget=0.0000 orth=0.6952 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.3853 mle=1.8570 pcon=8.8405 forget=0.0000 orth=0.6878 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.4365 mle=1.9175 pcon=8.8384 forget=0.0000 orth=0.6806 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.5271 mle=2.0167 pcon=8.8371 forget=0.0000 orth=0.6733 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.4177 mle=1.9173 pcon=8.8344 forget=0.0000 orth=0.6660 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.4846 mle=1.9948 pcon=8.8311 forget=0.0000 orth=0.6587 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 18 it 12 total=11.4173 mle=1.9369 pcon=8.8290 forget=0.0000 orth=0.6514 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.7112 mle=2.2412 pcon=8.8259 forget=0.0000 orth=0.6441 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.3783 mle=1.9174 pcon=8.8240 forget=0.0000 orth=0.6369 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.5771 mle=2.1266 pcon=8.8207 forget=0.0000 orth=0.6298 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.5527 mle=2.1116 pcon=8.8184 forget=0.0000 orth=0.6227 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.3976 mle=1.9665 pcon=8.8155 forget=0.0000 orth=0.6157 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.3561 mle=1.9348 pcon=8.8125 forget=0.0000 orth=0.6088 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.2638 mle=1.8519 pcon=8.8100 forget=0.0000 orth=0.6019 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 19 it 21 total=11.3433 mle=1.9398 pcon=8.8084 forget=0.0000 orth=0.5951 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.4270 mle=2.0332 pcon=8.8056 forget=0.0000 orth=0.5882 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
 67%|██████▋   | 20/30 [03:48<01:47, 10.76s/it] 70%|███████   | 21/30 [03:58<01:35, 10.60s/it] 73%|███████▎  | 22/30 [04:10<01:26, 10.77s/it] 77%|███████▋  | 23/30 [04:20<01:15, 10.76s/it] 80%|████████  | 24/30 [04:32<01:05, 10.88s/it] 83%|████████▎ | 25/30 [04:42<00:54, 10.90s/it][loss] ep 19 it 121 total=11.3189 mle=1.9337 pcon=8.8038 forget=0.0000 orth=0.5815 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.3866 mle=2.0097 pcon=8.8020 forget=0.0000 orth=0.5749 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.3811 mle=2.0120 pcon=8.8006 forget=0.0000 orth=0.5684 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.4633 mle=2.1036 pcon=8.7977 forget=0.0000 orth=0.5620 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.4209 mle=2.0695 pcon=8.7957 forget=0.0000 orth=0.5557 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.4009 mle=2.0582 pcon=8.7932 forget=0.0000 orth=0.5495 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 20 it 30 total=11.4598 mle=2.1255 pcon=8.7909 forget=0.0000 orth=0.5433 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.2582 mle=1.9328 pcon=8.7881 forget=0.0000 orth=0.5373 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.3816 mle=2.0645 pcon=8.7856 forget=0.0000 orth=0.5315 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.4088 mle=2.0996 pcon=8.7836 forget=0.0000 orth=0.5256 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.1095 mle=1.8089 pcon=8.7807 forget=0.0000 orth=0.5199 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.3220 mle=2.0301 pcon=8.7776 forget=0.0000 orth=0.5143 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.5527 mle=2.2687 pcon=8.7751 forget=0.0000 orth=0.5088 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.4143 mle=2.1371 pcon=8.7737 forget=0.0000 orth=0.5035 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 21 it 39 total=11.3174 mle=2.0493 pcon=8.7698 forget=0.0000 orth=0.4983 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.1021 mle=1.8414 pcon=8.7674 forget=0.0000 orth=0.4932 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.2758 mle=2.0225 pcon=8.7651 forget=0.0000 orth=0.4882 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.1054 mle=1.8598 pcon=8.7623 forget=0.0000 orth=0.4833 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.3967 mle=2.1585 pcon=8.7597 forget=0.0000 orth=0.4785 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.1297 mle=1.8983 pcon=8.7575 forget=0.0000 orth=0.4739 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.1639 mle=1.9395 pcon=8.7550 forget=0.0000 orth=0.4694 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.3258 mle=2.1086 pcon=8.7522 forget=0.0000 orth=0.4650 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 22 it 48 total=11.3260 mle=2.1154 pcon=8.7498 forget=0.0000 orth=0.4608 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.1765 mle=1.9725 pcon=8.7473 forget=0.0000 orth=0.4567 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.1948 mle=1.9965 pcon=8.7457 forget=0.0000 orth=0.4526 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.1059 mle=1.9124 pcon=8.7448 forget=0.0000 orth=0.4487 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.2546 mle=2.0668 pcon=8.7429 forget=0.0000 orth=0.4448 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.2195 mle=2.0378 pcon=8.7405 forget=0.0000 orth=0.4411 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.3685 mle=2.1927 pcon=8.7383 forget=0.0000 orth=0.4375 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 23 it 7 total=11.2028 mle=2.0341 pcon=8.7347 forget=0.0000 orth=0.4340 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.2029 mle=2.0399 pcon=8.7324 forget=0.0000 orth=0.4307 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.9204 mle=1.7634 pcon=8.7294 forget=0.0000 orth=0.4275 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.4487 mle=2.2971 pcon=8.7273 forget=0.0000 orth=0.4244 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.2304 mle=2.0840 pcon=8.7251 forget=0.0000 orth=0.4214 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.1741 mle=2.0330 pcon=8.7227 forget=0.0000 orth=0.4185 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.2116 mle=2.0760 pcon=8.7198 forget=0.0000 orth=0.4157 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.0717 mle=1.9413 pcon=8.7173 forget=0.0000 orth=0.4130 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 24 it 16 total=11.2372 mle=2.1119 pcon=8.7148 forget=0.0000 orth=0.4105 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.0447 mle=1.9236 pcon=8.7130 forget=0.0000 orth=0.4080 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.2853 mle=2.1693 pcon=8.7104 forget=0.0000 orth=0.4056 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.2166 mle=2.1056 pcon=8.7076 forget=0.0000 orth=0.4033 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.0049 mle=1.8985 pcon=8.7052 forget=0.0000 orth=0.4012 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.0668 mle=1.9639 pcon=8.7037 forget=0.0000 orth=0.3991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.0897 mle=1.9910 pcon=8.7016 forget=0.0000 orth=0.3971 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.3892 mle=2.2943 pcon=8.6997 forget=0.0000 orth=0.3952 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 25 it 25 total=10.9566 mle=1.8660 pcon=8.6972 forget=0.0000 orth=0.3934 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=11.0560 mle=1.9689 pcon=8.6954 forget=0.0000 orth=0.3917 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.3637 mle=2.2810 pcon=8.6927 forget=0.0000 orth=0.3900 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=11.1176 mle=2.0391 pcon=8.6900 forget=0.0000 orth=0.3885 favg=0.0000 nr=112 nf=10 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=10.8720 mle=1.7964 pcon=8.6885 forget=0.0000 orth=0.3871 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.1884 mle=2.1162 pcon=8.6865 forget=0.0000 orth=0.3857 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
 87%|████████▋ | 26/30 [04:53<00:43, 10.75s/it] 90%|█████████ | 27/30 [05:04<00:32, 10.74s/it] 93%|█████████▎| 28/30 [05:15<00:21, 10.81s/it] 97%|█████████▋| 29/30 [05:25<00:10, 10.73s/it]100%|██████████| 30/30 [05:36<00:00, 10.65s/it]100%|██████████| 30/30 [05:36<00:00, 11.20s/it]
[loss] ep 25 it 325 total=10.9704 mle=1.9010 pcon=8.6851 forget=0.0000 orth=0.3843 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=11.1614 mle=2.0964 pcon=8.6819 forget=0.0000 orth=0.3831 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 26 it 34 total=10.9159 mle=1.8542 pcon=8.6798 forget=0.0000 orth=0.3819 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.1599 mle=2.1013 pcon=8.6777 forget=0.0000 orth=0.3808 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=11.0631 mle=2.0067 pcon=8.6766 forget=0.0000 orth=0.3798 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=11.1174 mle=2.0643 pcon=8.6742 forget=0.0000 orth=0.3789 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=10.9616 mle=1.9112 pcon=8.6725 forget=0.0000 orth=0.3780 favg=0.0000 nr=124 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=11.1756 mle=2.1279 pcon=8.6706 forget=0.0000 orth=0.3771 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=11.1043 mle=2.0589 pcon=8.6691 forget=0.0000 orth=0.3764 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=10.9447 mle=1.9015 pcon=8.6676 forget=0.0000 orth=0.3757 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 27 it 43 total=11.1952 mle=2.1546 pcon=8.6656 forget=0.0000 orth=0.3750 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=11.0702 mle=2.0316 pcon=8.6642 forget=0.0000 orth=0.3744 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=11.1628 mle=2.1253 pcon=8.6636 forget=0.0000 orth=0.3739 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=11.0642 mle=2.0292 pcon=8.6617 forget=0.0000 orth=0.3734 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=11.0464 mle=2.0133 pcon=8.6602 forget=0.0000 orth=0.3729 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=10.9959 mle=1.9657 pcon=8.6577 forget=0.0000 orth=0.3725 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.8149 mle=1.7870 pcon=8.6558 forget=0.0000 orth=0.3721 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 28 it 2 total=10.8822 mle=1.8564 pcon=8.6539 forget=0.0000 orth=0.3718 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=11.1698 mle=2.1463 pcon=8.6520 forget=0.0000 orth=0.3715 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=10.9948 mle=1.9732 pcon=8.6503 forget=0.0000 orth=0.3713 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.2529 mle=2.2324 pcon=8.6495 forget=0.0000 orth=0.3710 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=11.0949 mle=2.0765 pcon=8.6476 forget=0.0000 orth=0.3709 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=11.0773 mle=2.0605 pcon=8.6462 forget=0.0000 orth=0.3707 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.7692 mle=1.7539 pcon=8.6448 forget=0.0000 orth=0.3705 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=10.9335 mle=1.9200 pcon=8.6431 forget=0.0000 orth=0.3704 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 29 it 11 total=10.8790 mle=1.8681 pcon=8.6406 forget=0.0000 orth=0.3703 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=11.0972 mle=2.0864 pcon=8.6405 forget=0.0000 orth=0.3703 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=11.2521 mle=2.2422 pcon=8.6397 forget=0.0000 orth=0.3702 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.9278 mle=1.9188 pcon=8.6389 forget=0.0000 orth=0.3702 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.1926 mle=2.1856 pcon=8.6368 forget=0.0000 orth=0.3701 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=11.0787 mle=2.0720 pcon=8.6366 forget=0.0000 orth=0.3701 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=10.9545 mle=1.9492 pcon=8.6351 forget=0.0000 orth=0.3701 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.3043 mle=2.3009 pcon=8.6334 forget=0.0000 orth=0.3701 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:08,  2.07it/s]  3%|▎         | 11/391 [00:00<00:15, 24.08it/s]  5%|▌         | 21/391 [00:00<00:08, 42.09it/s]  8%|▊         | 31/391 [00:00<00:06, 56.21it/s] 10%|█         | 41/391 [00:00<00:05, 66.34it/s] 13%|█▎        | 50/391 [00:01<00:04, 70.19it/s] 15%|█▌        | 60/391 [00:01<00:04, 77.40it/s] 18%|█▊        | 70/391 [00:01<00:03, 82.59it/s] 20%|██        | 80/391 [00:01<00:03, 86.37it/s] 23%|██▎       | 90/391 [00:01<00:03, 88.82it/s] 26%|██▌       | 100/391 [00:01<00:03, 90.80it/s] 28%|██▊       | 110/391 [00:01<00:03, 92.37it/s] 31%|███       | 120/391 [00:01<00:02, 93.17it/s] 33%|███▎      | 130/391 [00:01<00:02, 93.87it/s] 36%|███▌      | 140/391 [00:01<00:02, 93.50it/s] 38%|███▊      | 150/391 [00:02<00:02, 94.17it/s] 41%|████      | 160/391 [00:02<00:02, 94.41it/s] 43%|████▎     | 170/391 [00:02<00:02, 94.39it/s] 46%|████▌     | 180/391 [00:02<00:02, 93.85it/s] 49%|████▊     | 190/391 [00:02<00:02, 92.45it/s] 51%|█████     | 200/391 [00:02<00:02, 93.34it/s] 54%|█████▎    | 210/391 [00:02<00:01, 93.69it/s] 56%|█████▋    | 220/391 [00:02<00:01, 93.43it/s] 59%|█████▉    | 230/391 [00:02<00:01, 93.47it/s] 61%|██████▏   | 240/391 [00:03<00:01, 94.13it/s] 64%|██████▍   | 250/391 [00:03<00:01, 94.30it/s] 66%|██████▋   | 260/391 [00:03<00:01, 94.80it/s] 69%|██████▉   | 270/391 [00:03<00:01, 94.32it/s] 72%|███████▏  | 280/391 [00:03<00:01, 92.22it/s] 74%|███████▍  | 290/391 [00:03<00:01, 93.19it/s] 77%|███████▋  | 300/391 [00:03<00:00, 93.83it/s] 79%|███████▉  | 310/391 [00:03<00:00, 91.71it/s] 82%|████████▏ | 320/391 [00:03<00:00, 92.24it/s] 84%|████████▍ | 330/391 [00:03<00:00, 92.92it/s] 87%|████████▋ | 340/391 [00:04<00:00, 93.44it/s] 90%|████████▉ | 350/391 [00:04<00:00, 94.16it/s] 92%|█████████▏| 360/391 [00:04<00:00, 94.12it/s] 95%|█████████▍| 370/391 [00:04<00:00, 92.93it/s] 97%|█████████▋| 380/391 [00:04<00:00, 76.77it/s] 99%|█████████▉| 389/391 [00:04<00:00, 77.79it/s]100%|██████████| 391/391 [00:04<00:00, 82.29it/s]
50000 images processed, 4.788556814193726 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.80it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.51it/s] 27%|██▋       | 21/79 [00:00<00:01, 38.55it/s] 39%|███▉      | 31/79 [00:00<00:00, 52.65it/s] 52%|█████▏    | 41/79 [00:00<00:00, 63.23it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.40it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.50it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.72it/s]100%|██████████| 79/79 [00:02<00:00, 37.28it/s]
10000 images processed, 2.159252405166626 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:50,  1.83it/s]  5%|▍         | 10/204 [00:00<00:09, 19.97it/s]  8%|▊         | 16/204 [00:00<00:06, 28.70it/s] 11%|█         | 22/204 [00:00<00:05, 33.41it/s] 14%|█▎        | 28/204 [00:00<00:04, 39.42it/s] 19%|█▊        | 38/204 [00:01<00:03, 53.80it/s] 24%|██▎       | 48/204 [00:01<00:02, 65.16it/s] 28%|██▊       | 58/204 [00:01<00:02, 71.83it/s] 33%|███▎      | 68/204 [00:01<00:01, 76.44it/s] 38%|███▊      | 77/204 [00:01<00:01, 67.06it/s] 43%|████▎     | 87/204 [00:01<00:01, 73.63it/s] 48%|████▊     | 97/204 [00:01<00:01, 79.24it/s] 52%|█████▏    | 107/204 [00:01<00:01, 83.66it/s] 57%|█████▋    | 117/204 [00:02<00:01, 86.14it/s] 62%|██████▏   | 127/204 [00:02<00:00, 87.58it/s] 67%|██████▋   | 137/204 [00:02<00:00, 89.43it/s] 72%|███████▏  | 147/204 [00:02<00:00, 90.04it/s] 77%|███████▋  | 157/204 [00:02<00:00, 91.59it/s] 82%|████████▏ | 167/204 [00:02<00:00, 91.28it/s] 87%|████████▋ | 177/204 [00:02<00:00, 92.32it/s] 92%|█████████▏| 187/204 [00:02<00:00, 93.33it/s] 97%|█████████▋| 197/204 [00:02<00:00, 93.96it/s]100%|██████████| 204/204 [00:02<00:00, 68.73it/s]
26032 images processed, 3.096536874771118 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:50,  1.56it/s]  3%|▎         | 2/79 [00:00<00:24,  3.08it/s] 15%|█▌        | 12/79 [00:00<00:02, 22.78it/s] 28%|██▊       | 22/79 [00:00<00:01, 39.44it/s] 41%|████      | 32/79 [00:01<00:00, 53.17it/s] 53%|█████▎    | 42/79 [00:01<00:00, 63.94it/s] 66%|██████▌   | 52/79 [00:01<00:00, 72.25it/s] 78%|███████▊  | 62/79 [00:01<00:00, 77.53it/s] 91%|█████████ | 72/79 [00:01<00:00, 82.63it/s]100%|██████████| 79/79 [00:01<00:00, 50.70it/s]
10000 images processed, 1.6290156841278076 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.66it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.31it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.61it/s] 39%|███▉      | 31/79 [00:00<00:00, 50.44it/s] 52%|█████▏    | 41/79 [00:01<00:00, 61.39it/s] 65%|██████▍   | 51/79 [00:01<00:00, 70.19it/s] 77%|███████▋  | 61/79 [00:01<00:00, 77.36it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.73it/s]100%|██████████| 79/79 [00:01<00:00, 55.61it/s]
10000 images processed, 1.46535062789917 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.87it/s] 14%|█▍        | 10/70 [00:00<00:02, 20.27it/s] 29%|██▊       | 20/70 [00:00<00:01, 38.00it/s] 40%|████      | 28/70 [00:00<00:00, 47.40it/s] 54%|█████▍    | 38/70 [00:00<00:00, 59.96it/s] 69%|██████▊   | 48/70 [00:01<00:00, 69.77it/s] 83%|████████▎ | 58/70 [00:01<00:00, 77.31it/s] 97%|█████████▋| 68/70 [00:01<00:00, 82.88it/s]100%|██████████| 70/70 [00:01<00:00, 53.99it/s]
8925 images processed, 1.329298734664917 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:46,  1.05s/it]  4%|▍         | 2/45 [00:01<00:24,  1.78it/s] 18%|█▊        | 8/45 [00:01<00:03,  9.30it/s] 38%|███▊      | 17/45 [00:01<00:01, 14.86it/s] 44%|████▍     | 20/45 [00:01<00:01, 15.41it/s] 56%|█████▌    | 25/45 [00:02<00:00, 20.25it/s] 73%|███████▎  | 33/45 [00:02<00:00, 14.92it/s] 87%|████████▋ | 39/45 [00:02<00:00, 19.53it/s]100%|██████████| 45/45 [00:02<00:00, 15.27it/s]
5640 images processed, 2.9691390991210938 seconds used

19.565362453460693
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.74  99.32  89.65
places365     60.61  87.25  56.18
LSUN          32.72  94.86  82.00
iSUN          42.41  92.28  72.59
dtd           28.33  94.52  81.33
AVG           33.56  93.65  76.35
[incremental] Overall: 0.7320 New: 0.6980 Old: 0.7660
[incremental] Final(Top-1): 0.7320  Average: 0.7900
4.582441329956055
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=30, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/30 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  3%|▎         | 1/30 [00:19<09:28, 19.59s/it]  7%|▋         | 2/30 [00:30<06:44, 14.45s/it] 10%|█         | 3/30 [00:40<05:39, 12.56s/it] 13%|█▎        | 4/30 [00:51<05:07, 11.83s/it] 17%|█▋        | 5/30 [01:02<04:51, 11.66s/it] 20%|██        | 6/30 [01:13<04:30, 11.28s/it][loss] ep 0 it 0 total=14.4836 mle=2.4356 pcon=9.4393 forget=0.0000 orth=2.6087 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=14.3873 mle=2.3381 pcon=9.4420 forget=0.0000 orth=2.6073 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=14.4917 mle=2.4426 pcon=9.4447 forget=0.0000 orth=2.6044 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=14.3162 mle=2.2703 pcon=9.4464 forget=0.0000 orth=2.5996 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=14.0300 mle=1.9892 pcon=9.4481 forget=0.0000 orth=2.5927 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=14.1914 mle=2.1587 pcon=9.4489 forget=0.0000 orth=2.5838 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=14.5596 mle=2.5365 pcon=9.4500 forget=0.0000 orth=2.5730 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=14.1881 mle=2.1775 pcon=9.4505 forget=0.0000 orth=2.5601 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=14.1845 mle=2.1885 pcon=9.4508 forget=0.0000 orth=2.5452 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=14.0999 mle=2.1213 pcon=9.4504 forget=0.0000 orth=2.5281 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=14.2221 mle=2.2632 pcon=9.4501 forget=0.0000 orth=2.5088 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=14.3446 mle=2.4085 pcon=9.4490 forget=0.0000 orth=2.4872 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=14.2945 mle=2.3839 pcon=9.4473 forget=0.0000 orth=2.4633 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.9235 mle=2.0408 pcon=9.4455 forget=0.0000 orth=2.4371 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=14.1405 mle=2.2878 pcon=9.4443 forget=0.0000 orth=2.4084 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=14.0796 mle=2.2595 pcon=9.4430 forget=0.0000 orth=2.3771 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=13.8993 mle=2.1144 pcon=9.4415 forget=0.0000 orth=2.3433 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.9844 mle=2.2376 pcon=9.4399 forget=0.0000 orth=2.3070 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.6954 mle=1.9890 pcon=9.4385 forget=0.0000 orth=2.2679 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.8237 mle=2.1605 pcon=9.4372 forget=0.0000 orth=2.2260 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.4168 mle=1.8000 pcon=9.4356 forget=0.0000 orth=2.1812 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.8038 mle=2.2364 pcon=9.4335 forget=0.0000 orth=2.1339 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.8176 mle=2.3018 pcon=9.4321 forget=0.0000 orth=2.0838 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.2964 mle=1.8349 pcon=9.4307 forget=0.0000 orth=2.0308 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=13.5817 mle=2.1774 pcon=9.4288 forget=0.0000 orth=1.9755 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.6179 mle=2.2726 pcon=9.4274 forget=0.0000 orth=1.9179 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.4822 mle=2.1988 pcon=9.4253 forget=0.0000 orth=1.8580 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.3048 mle=2.0851 pcon=9.4233 forget=0.0000 orth=1.7965 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.1787 mle=2.0245 pcon=9.4209 forget=0.0000 orth=1.7333 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.1805 mle=2.0918 pcon=9.4194 forget=0.0000 orth=1.6694 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.0780 mle=2.0562 pcon=9.4170 forget=0.0000 orth=1.6049 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.0574 mle=2.1016 pcon=9.4157 forget=0.0000 orth=1.5401 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=13.0442 mle=2.1544 pcon=9.4141 forget=0.0000 orth=1.4757 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.9662 mle=2.1424 pcon=9.4120 forget=0.0000 orth=1.4118 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.9257 mle=2.1662 pcon=9.4100 forget=0.0000 orth=1.3494 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.6412 mle=1.9442 pcon=9.4081 forget=0.0000 orth=1.2889 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.6099 mle=1.9734 pcon=9.4062 forget=0.0000 orth=1.2303 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.5532 mle=1.9741 pcon=9.4048 forget=0.0000 orth=1.1743 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.7836 mle=2.2595 pcon=9.4033 forget=0.0000 orth=1.1208 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.4335 mle=1.9610 pcon=9.4017 forget=0.0000 orth=1.0708 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 5 it 45 total=12.5303 mle=2.1073 pcon=9.3998 forget=0.0000 orth=1.0232 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.4275 mle=2.0501 pcon=9.3985 forget=0.0000 orth=0.9789 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.3489 mle=2.0144 pcon=9.3968 forget=0.0000 orth=0.9377 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.3822 mle=2.0865 pcon=9.3956 forget=0.0000 orth=0.9001 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.3977 mle=2.1381 pcon=9.3944 forget=0.0000 orth=0.8651 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.0985 mle=1.8724 pcon=9.3931 forget=0.0000 orth=0.8329 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.4258 mle=2.2304 pcon=9.3921 forget=0.0000 orth=0.8032 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 6 it 4 total=12.2725 mle=2.1058 pcon=9.3908 forget=0.0000 orth=0.7759 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.3121 mle=2.1715 pcon=9.3896 forget=0.0000 orth=0.7511 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.0728 mle=1.9558 pcon=9.3886 forget=0.0000 orth=0.7284 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.9062 mle=1.8120 pcon=9.3870 forget=0.0000 orth=0.7073 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
 23%|██▎       | 7/30 [01:24<04:21, 11.38s/it] 27%|██▋       | 8/30 [01:35<04:07, 11.24s/it] 30%|███       | 9/30 [01:46<03:50, 11.00s/it] 33%|███▎      | 10/30 [01:56<03:34, 10.72s/it] 37%|███▋      | 11/30 [02:07<03:28, 10.95s/it] 40%|████      | 12/30 [02:19<03:18, 11.01s/it][loss] ep 6 it 204 total=12.0870 mle=2.0138 pcon=9.3850 forget=0.0000 orth=0.6881 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=12.1090 mle=2.0552 pcon=9.3835 forget=0.0000 orth=0.6702 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.3573 mle=2.3209 pcon=9.3823 forget=0.0000 orth=0.6541 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.9664 mle=1.9459 pcon=9.3813 forget=0.0000 orth=0.6392 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 7 it 13 total=12.2545 mle=2.2493 pcon=9.3799 forget=0.0000 orth=0.6253 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.3591 mle=2.3682 pcon=9.3783 forget=0.0000 orth=0.6126 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.2085 mle=2.2309 pcon=9.3771 forget=0.0000 orth=0.6005 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.2265 mle=2.2611 pcon=9.3760 forget=0.0000 orth=0.5894 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9769 mle=2.0228 pcon=9.3750 forget=0.0000 orth=0.5791 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.1236 mle=2.1804 pcon=9.3738 forget=0.0000 orth=0.5694 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.9484 mle=2.0154 pcon=9.3726 forget=0.0000 orth=0.5604 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0956 mle=2.1721 pcon=9.3715 forget=0.0000 orth=0.5521 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 8 it 22 total=12.0134 mle=2.0998 pcon=9.3698 forget=0.0000 orth=0.5438 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8528 mle=1.9481 pcon=9.3685 forget=0.0000 orth=0.5362 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7860 mle=1.8900 pcon=9.3671 forget=0.0000 orth=0.5289 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.6480 mle=1.7605 pcon=9.3656 forget=0.0000 orth=0.5219 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6248 mle=1.7449 pcon=9.3646 forget=0.0000 orth=0.5153 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.8352 mle=1.9631 pcon=9.3631 forget=0.0000 orth=0.5089 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8989 mle=2.0343 pcon=9.3616 forget=0.0000 orth=0.5030 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0117 mle=2.1545 pcon=9.3598 forget=0.0000 orth=0.4973 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 9 it 31 total=12.1298 mle=2.2799 pcon=9.3582 forget=0.0000 orth=0.4918 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9009 mle=2.0580 pcon=9.3564 forget=0.0000 orth=0.4864 favg=0.0000 nr=110 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7463 mle=1.9103 pcon=9.3546 forget=0.0000 orth=0.4814 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8532 mle=2.0238 pcon=9.3530 forget=0.0000 orth=0.4764 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7253 mle=1.9018 pcon=9.3514 forget=0.0000 orth=0.4720 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8458 mle=2.0288 pcon=9.3495 forget=0.0000 orth=0.4676 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9477 mle=2.1373 pcon=9.3472 forget=0.0000 orth=0.4632 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7203 mle=1.9165 pcon=9.3450 forget=0.0000 orth=0.4587 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 10 it 40 total=11.6681 mle=1.8703 pcon=9.3431 forget=0.0000 orth=0.4547 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.0624 mle=2.2715 pcon=9.3402 forget=0.0000 orth=0.4507 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.7293 mle=1.9438 pcon=9.3387 forget=0.0000 orth=0.4468 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.7442 mle=1.9644 pcon=9.3367 forget=0.0000 orth=0.4431 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6039 mle=1.8301 pcon=9.3344 forget=0.0000 orth=0.4394 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0474 mle=2.2785 pcon=9.3327 forget=0.0000 orth=0.4361 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.6941 mle=1.9309 pcon=9.3304 forget=0.0000 orth=0.4327 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=11.9842 mle=2.2268 pcon=9.3279 forget=0.0000 orth=0.4294 favg=0.0000 nr=68 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 11 it 49 total=11.6924 mle=1.9405 pcon=9.3256 forget=0.0000 orth=0.4263 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.9346 mle=2.1885 pcon=9.3228 forget=0.0000 orth=0.4232 favg=0.0000 nr=102 nf=11 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.8604 mle=2.1198 pcon=9.3204 forget=0.0000 orth=0.4202 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.7189 mle=1.9843 pcon=9.3173 forget=0.0000 orth=0.4174 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.4905 mle=1.7621 pcon=9.3139 forget=0.0000 orth=0.4145 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.8015 mle=2.0791 pcon=9.3107 forget=0.0000 orth=0.4117 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.5881 mle=1.8709 pcon=9.3082 forget=0.0000 orth=0.4091 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 12 it 8 total=11.8602 mle=2.1483 pcon=9.3055 forget=0.0000 orth=0.4064 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.6713 mle=1.9655 pcon=9.3019 forget=0.0000 orth=0.4039 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.8059 mle=2.1053 pcon=9.2993 forget=0.0000 orth=0.4013 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.6901 mle=1.9954 pcon=9.2959 forget=0.0000 orth=0.3988 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.6192 mle=1.9304 pcon=9.2924 forget=0.0000 orth=0.3964 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.9508 mle=2.2667 pcon=9.2901 forget=0.0000 orth=0.3941 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.7998 mle=2.1214 pcon=9.2868 forget=0.0000 orth=0.3916 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.7527 mle=2.0796 pcon=9.2839 forget=0.0000 orth=0.3892 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
 43%|████▎     | 13/30 [02:29<03:04, 10.85s/it] 47%|████▋     | 14/30 [02:41<02:56, 11.06s/it] 50%|█████     | 15/30 [02:51<02:43, 10.93s/it] 53%|█████▎    | 16/30 [03:02<02:32, 10.87s/it] 57%|█████▋    | 17/30 [03:13<02:21, 10.88s/it] 60%|██████    | 18/30 [03:23<02:08, 10.70s/it] 63%|██████▎   | 19/30 [03:34<01:59, 10.83s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 13 it 17 total=11.8454 mle=2.1771 pcon=9.2812 forget=0.0000 orth=0.3872 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.5916 mle=1.9289 pcon=9.2777 forget=0.0000 orth=0.3849 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.8910 mle=2.2334 pcon=9.2749 forget=0.0000 orth=0.3827 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.7762 mle=2.1244 pcon=9.2711 forget=0.0000 orth=0.3806 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.8460 mle=2.1986 pcon=9.2688 forget=0.0000 orth=0.3786 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.7829 mle=2.1408 pcon=9.2655 forget=0.0000 orth=0.3766 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.6632 mle=2.0263 pcon=9.2623 forget=0.0000 orth=0.3746 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.7330 mle=2.1017 pcon=9.2587 forget=0.0000 orth=0.3726 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 14 it 26 total=11.8802 mle=2.2535 pcon=9.2559 forget=0.0000 orth=0.3708 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.5703 mle=1.9492 pcon=9.2524 forget=0.0000 orth=0.3687 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.6681 mle=2.0524 pcon=9.2490 forget=0.0000 orth=0.3668 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.7357 mle=2.1260 pcon=9.2448 forget=0.0000 orth=0.3649 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.5293 mle=1.9254 pcon=9.2409 forget=0.0000 orth=0.3630 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.7664 mle=2.1680 pcon=9.2372 forget=0.0000 orth=0.3612 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.6334 mle=2.0398 pcon=9.2342 forget=0.0000 orth=0.3595 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.4638 mle=1.8752 pcon=9.2308 forget=0.0000 orth=0.3578 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 15 it 35 total=11.6223 mle=2.0393 pcon=9.2270 forget=0.0000 orth=0.3560 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.6346 mle=2.0562 pcon=9.2240 forget=0.0000 orth=0.3544 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.5109 mle=1.9377 pcon=9.2205 forget=0.0000 orth=0.3526 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.5456 mle=1.9779 pcon=9.2168 forget=0.0000 orth=0.3510 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.7287 mle=2.1657 pcon=9.2136 forget=0.0000 orth=0.3493 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.5648 mle=2.0068 pcon=9.2101 forget=0.0000 orth=0.3478 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.7228 mle=2.1704 pcon=9.2062 forget=0.0000 orth=0.3462 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.5199 mle=1.9724 pcon=9.2028 forget=0.0000 orth=0.3447 favg=0.0000 nr=111 nf=1 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 16 it 44 total=11.7134 mle=2.1700 pcon=9.2001 forget=0.0000 orth=0.3433 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.6736 mle=2.1349 pcon=9.1968 forget=0.0000 orth=0.3419 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.5537 mle=2.0203 pcon=9.1931 forget=0.0000 orth=0.3403 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.5039 mle=1.9755 pcon=9.1895 forget=0.0000 orth=0.3389 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.4323 mle=1.9087 pcon=9.1862 forget=0.0000 orth=0.3375 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.3979 mle=1.8792 pcon=9.1828 forget=0.0000 orth=0.3359 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.5559 mle=2.0414 pcon=9.1798 forget=0.0000 orth=0.3346 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 17 it 3 total=11.2659 mle=1.7557 pcon=9.1770 forget=0.0000 orth=0.3332 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.3144 mle=1.8091 pcon=9.1734 forget=0.0000 orth=0.3318 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.4961 mle=1.9951 pcon=9.1704 forget=0.0000 orth=0.3305 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.3435 mle=1.8470 pcon=9.1673 forget=0.0000 orth=0.3291 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.4089 mle=1.9180 pcon=9.1631 forget=0.0000 orth=0.3278 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.4729 mle=1.9860 pcon=9.1604 forget=0.0000 orth=0.3265 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.3781 mle=1.8954 pcon=9.1575 forget=0.0000 orth=0.3252 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.4245 mle=1.9470 pcon=9.1535 forget=0.0000 orth=0.3239 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 18 it 12 total=11.4403 mle=1.9676 pcon=9.1500 forget=0.0000 orth=0.3226 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.6959 mle=2.2283 pcon=9.1462 forget=0.0000 orth=0.3214 favg=0.0000 nr=110 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.3312 mle=1.8672 pcon=9.1437 forget=0.0000 orth=0.3203 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.5444 mle=2.0857 pcon=9.1395 forget=0.0000 orth=0.3192 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.5607 mle=2.1071 pcon=9.1356 forget=0.0000 orth=0.3180 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.3892 mle=1.9403 pcon=9.1320 forget=0.0000 orth=0.3169 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.3793 mle=1.9348 pcon=9.1288 forget=0.0000 orth=0.3156 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.2636 mle=1.8236 pcon=9.1255 forget=0.0000 orth=0.3145 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 19 it 21 total=11.3820 mle=1.9459 pcon=9.1227 forget=0.0000 orth=0.3134 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.4901 mle=2.0586 pcon=9.1192 forget=0.0000 orth=0.3123 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
 67%|██████▋   | 20/30 [03:44<01:45, 10.54s/it] 70%|███████   | 21/30 [03:55<01:36, 10.71s/it] 73%|███████▎  | 22/30 [04:07<01:27, 10.94s/it] 77%|███████▋  | 23/30 [04:18<01:16, 10.93s/it] 80%|████████  | 24/30 [04:29<01:05, 11.00s/it] 83%|████████▎ | 25/30 [04:40<00:54, 10.94s/it][loss] ep 19 it 121 total=11.3146 mle=1.8867 pcon=9.1166 forget=0.0000 orth=0.3112 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.4172 mle=1.9940 pcon=9.1129 forget=0.0000 orth=0.3102 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.4459 mle=2.0260 pcon=9.1108 forget=0.0000 orth=0.3092 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.4980 mle=2.0820 pcon=9.1078 forget=0.0000 orth=0.3082 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.4478 mle=2.0356 pcon=9.1051 forget=0.0000 orth=0.3072 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.4266 mle=2.0178 pcon=9.1027 forget=0.0000 orth=0.3062 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 20 it 30 total=11.5601 mle=2.1544 pcon=9.1005 forget=0.0000 orth=0.3052 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.3022 mle=1.9005 pcon=9.0974 forget=0.0000 orth=0.3043 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.4421 mle=2.0446 pcon=9.0941 forget=0.0000 orth=0.3034 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.4780 mle=2.0838 pcon=9.0916 forget=0.0000 orth=0.3025 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.2051 mle=1.8149 pcon=9.0884 forget=0.0000 orth=0.3017 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.3684 mle=1.9825 pcon=9.0850 forget=0.0000 orth=0.3009 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.6213 mle=2.2390 pcon=9.0822 forget=0.0000 orth=0.3000 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.5024 mle=2.1226 pcon=9.0806 forget=0.0000 orth=0.2992 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 21 it 39 total=11.3599 mle=1.9848 pcon=9.0767 forget=0.0000 orth=0.2984 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.2417 mle=1.8699 pcon=9.0742 forget=0.0000 orth=0.2976 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.4472 mle=2.0791 pcon=9.0713 forget=0.0000 orth=0.2968 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.2631 mle=1.8986 pcon=9.0685 forget=0.0000 orth=0.2960 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.4499 mle=2.0885 pcon=9.0661 forget=0.0000 orth=0.2953 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.2460 mle=1.8878 pcon=9.0637 forget=0.0000 orth=0.2946 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.3072 mle=1.9514 pcon=9.0618 forget=0.0000 orth=0.2939 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.4930 mle=2.1410 pcon=9.0587 forget=0.0000 orth=0.2933 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 22 it 48 total=11.4439 mle=2.0947 pcon=9.0566 forget=0.0000 orth=0.2926 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.3207 mle=1.9748 pcon=9.0540 forget=0.0000 orth=0.2920 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.3548 mle=2.0120 pcon=9.0515 forget=0.0000 orth=0.2913 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.2818 mle=1.9405 pcon=9.0506 forget=0.0000 orth=0.2907 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.3927 mle=2.0537 pcon=9.0488 forget=0.0000 orth=0.2901 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.3827 mle=2.0464 pcon=9.0467 forget=0.0000 orth=0.2896 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.4441 mle=2.1110 pcon=9.0441 forget=0.0000 orth=0.2890 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 23 it 7 total=11.2789 mle=1.9487 pcon=9.0417 forget=0.0000 orth=0.2885 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.4393 mle=2.1126 pcon=9.0387 forget=0.0000 orth=0.2880 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=11.0921 mle=1.7685 pcon=9.0361 forget=0.0000 orth=0.2875 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.6050 mle=2.2834 pcon=9.0346 forget=0.0000 orth=0.2870 favg=0.0000 nr=107 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.4111 mle=2.0918 pcon=9.0328 forget=0.0000 orth=0.2866 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.3387 mle=2.0222 pcon=9.0305 forget=0.0000 orth=0.2861 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.3726 mle=2.0596 pcon=9.0274 forget=0.0000 orth=0.2857 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.2210 mle=1.9105 pcon=9.0253 forget=0.0000 orth=0.2853 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 24 it 16 total=11.4201 mle=2.1125 pcon=9.0227 forget=0.0000 orth=0.2849 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.2118 mle=1.9053 pcon=9.0220 forget=0.0000 orth=0.2845 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.4618 mle=2.1580 pcon=9.0197 forget=0.0000 orth=0.2841 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.4317 mle=2.1307 pcon=9.0173 forget=0.0000 orth=0.2837 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.1673 mle=1.8690 pcon=9.0149 forget=0.0000 orth=0.2834 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.2474 mle=1.9517 pcon=9.0126 forget=0.0000 orth=0.2830 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.2572 mle=1.9640 pcon=9.0105 forget=0.0000 orth=0.2827 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.5596 mle=2.2684 pcon=9.0088 forget=0.0000 orth=0.2824 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 25 it 25 total=11.1956 mle=1.9068 pcon=9.0067 forget=0.0000 orth=0.2821 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=11.3071 mle=2.0198 pcon=9.0054 forget=0.0000 orth=0.2818 favg=0.0000 nr=115 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.5804 mle=2.2961 pcon=9.0027 forget=0.0000 orth=0.2816 favg=0.0000 nr=104 nf=12 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=11.2828 mle=2.0008 pcon=9.0007 forget=0.0000 orth=0.2813 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=11.1341 mle=1.8538 pcon=8.9992 forget=0.0000 orth=0.2811 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.4193 mle=2.1406 pcon=8.9978 forget=0.0000 orth=0.2808 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
 87%|████████▋ | 26/30 [04:51<00:44, 11.03s/it] 90%|█████████ | 27/30 [05:01<00:32, 10.75s/it] 93%|█████████▎| 28/30 [05:11<00:21, 10.58s/it] 97%|█████████▋| 29/30 [05:21<00:10, 10.52s/it]100%|██████████| 30/30 [05:32<00:00, 10.56s/it]100%|██████████| 30/30 [05:32<00:00, 11.09s/it]
[loss] ep 25 it 325 total=11.2386 mle=1.9615 pcon=8.9965 forget=0.0000 orth=0.2806 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=11.3646 mle=2.0894 pcon=8.9947 forget=0.0000 orth=0.2804 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 26 it 34 total=11.1681 mle=1.8949 pcon=8.9929 forget=0.0000 orth=0.2802 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.4025 mle=2.1322 pcon=8.9902 forget=0.0000 orth=0.2801 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=11.3020 mle=2.0329 pcon=8.9892 forget=0.0000 orth=0.2799 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=11.3201 mle=2.0525 pcon=8.9878 forget=0.0000 orth=0.2798 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=11.1950 mle=1.9291 pcon=8.9863 forget=0.0000 orth=0.2796 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=11.3892 mle=2.1260 pcon=8.9837 forget=0.0000 orth=0.2795 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=11.2752 mle=2.0139 pcon=8.9819 forget=0.0000 orth=0.2794 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=11.1780 mle=1.9178 pcon=8.9809 forget=0.0000 orth=0.2793 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 27 it 43 total=11.3923 mle=2.1339 pcon=8.9793 forget=0.0000 orth=0.2791 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=11.3081 mle=2.0507 pcon=8.9784 forget=0.0000 orth=0.2790 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=11.3816 mle=2.1249 pcon=8.9777 forget=0.0000 orth=0.2790 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=11.2815 mle=2.0259 pcon=8.9768 forget=0.0000 orth=0.2789 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=11.1960 mle=1.9415 pcon=8.9757 forget=0.0000 orth=0.2788 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=11.2359 mle=1.9825 pcon=8.9746 forget=0.0000 orth=0.2787 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=11.0315 mle=1.7801 pcon=8.9727 forget=0.0000 orth=0.2787 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 28 it 2 total=11.0992 mle=1.8493 pcon=8.9713 forget=0.0000 orth=0.2786 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=11.3800 mle=2.1316 pcon=8.9698 forget=0.0000 orth=0.2786 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=11.2926 mle=2.0456 pcon=8.9684 forget=0.0000 orth=0.2785 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.4356 mle=2.1896 pcon=8.9675 forget=0.0000 orth=0.2785 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=11.3606 mle=2.1163 pcon=8.9659 forget=0.0000 orth=0.2785 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=11.3210 mle=2.0778 pcon=8.9647 forget=0.0000 orth=0.2785 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=11.0041 mle=1.7611 pcon=8.9645 forget=0.0000 orth=0.2784 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=11.2125 mle=1.9710 pcon=8.9631 forget=0.0000 orth=0.2784 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 29 it 11 total=11.0967 mle=1.8574 pcon=8.9608 forget=0.0000 orth=0.2784 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=11.3253 mle=2.0860 pcon=8.9609 forget=0.0000 orth=0.2784 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=11.4090 mle=2.1704 pcon=8.9603 forget=0.0000 orth=0.2784 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=11.1350 mle=1.8978 pcon=8.9588 forget=0.0000 orth=0.2784 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.4423 mle=2.2066 pcon=8.9573 forget=0.0000 orth=0.2784 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=11.2648 mle=2.0302 pcon=8.9563 forget=0.0000 orth=0.2784 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=11.1848 mle=1.9508 pcon=8.9556 forget=0.0000 orth=0.2784 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.5097 mle=2.2766 pcon=8.9547 forget=0.0000 orth=0.2784 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:24,  2.69it/s]  3%|▎         | 11/391 [00:00<00:12, 29.23it/s]  5%|▌         | 20/391 [00:00<00:08, 44.29it/s]  8%|▊         | 30/391 [00:00<00:06, 58.34it/s] 10%|█         | 40/391 [00:00<00:05, 68.92it/s] 13%|█▎        | 50/391 [00:00<00:04, 76.74it/s] 15%|█▌        | 60/391 [00:01<00:04, 82.00it/s] 18%|█▊        | 69/391 [00:01<00:03, 82.37it/s] 20%|█▉        | 78/391 [00:01<00:03, 83.10it/s] 22%|██▏       | 87/391 [00:01<00:03, 84.94it/s] 25%|██▍       | 96/391 [00:01<00:03, 83.34it/s] 27%|██▋       | 106/391 [00:01<00:03, 86.67it/s] 30%|██▉       | 116/391 [00:01<00:03, 88.88it/s] 32%|███▏      | 126/391 [00:01<00:02, 89.82it/s] 35%|███▍      | 136/391 [00:01<00:02, 88.89it/s] 37%|███▋      | 146/391 [00:01<00:02, 90.35it/s] 40%|███▉      | 156/391 [00:02<00:02, 91.94it/s] 42%|████▏     | 166/391 [00:02<00:02, 91.68it/s] 45%|████▌     | 176/391 [00:02<00:02, 92.61it/s] 48%|████▊     | 186/391 [00:02<00:02, 92.56it/s] 50%|█████     | 196/391 [00:02<00:02, 92.48it/s] 53%|█████▎    | 206/391 [00:02<00:01, 92.91it/s] 55%|█████▌    | 216/391 [00:02<00:01, 93.10it/s] 58%|█████▊    | 226/391 [00:02<00:01, 93.21it/s] 60%|██████    | 236/391 [00:02<00:01, 93.13it/s] 63%|██████▎   | 246/391 [00:03<00:01, 93.83it/s] 65%|██████▌   | 256/391 [00:03<00:01, 94.33it/s] 68%|██████▊   | 266/391 [00:03<00:01, 94.65it/s] 71%|███████   | 276/391 [00:03<00:01, 94.58it/s] 73%|███████▎  | 286/391 [00:03<00:01, 94.95it/s] 76%|███████▌  | 296/391 [00:03<00:00, 95.24it/s] 78%|███████▊  | 306/391 [00:03<00:00, 95.60it/s] 81%|████████  | 316/391 [00:03<00:00, 95.32it/s] 83%|████████▎ | 326/391 [00:03<00:00, 95.15it/s] 86%|████████▌ | 336/391 [00:04<00:00, 94.63it/s] 88%|████████▊ | 346/391 [00:04<00:00, 94.98it/s] 91%|█████████ | 356/391 [00:04<00:00, 95.13it/s] 94%|█████████▎| 366/391 [00:04<00:00, 95.03it/s] 96%|█████████▌| 376/391 [00:04<00:00, 91.55it/s] 99%|█████████▊| 386/391 [00:04<00:00, 93.11it/s]100%|██████████| 391/391 [00:04<00:00, 84.93it/s]
50000 images processed, 4.7023608684539795 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:55,  1.41it/s] 14%|█▍        | 11/79 [00:00<00:03, 17.78it/s] 27%|██▋       | 21/79 [00:00<00:01, 33.17it/s] 39%|███▉      | 31/79 [00:01<00:01, 46.86it/s] 52%|█████▏    | 41/79 [00:01<00:00, 58.33it/s] 65%|██████▍   | 51/79 [00:01<00:00, 67.60it/s] 77%|███████▋  | 61/79 [00:01<00:00, 75.37it/s] 90%|████████▉ | 71/79 [00:01<00:00, 81.29it/s]100%|██████████| 79/79 [00:02<00:00, 39.14it/s]
10000 images processed, 2.0450198650360107 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:57,  1.73it/s]  5%|▌         | 11/204 [00:00<00:09, 20.82it/s] 10%|▉         | 20/204 [00:00<00:05, 35.25it/s] 15%|█▍        | 30/204 [00:00<00:03, 49.69it/s] 20%|█▉        | 40/204 [00:01<00:02, 61.42it/s] 24%|██▍       | 49/204 [00:01<00:02, 67.59it/s] 29%|██▉       | 59/204 [00:01<00:01, 75.01it/s] 34%|███▍      | 69/204 [00:01<00:01, 78.59it/s] 38%|███▊      | 78/204 [00:01<00:01, 64.24it/s] 43%|████▎     | 87/204 [00:01<00:01, 68.79it/s] 48%|████▊     | 97/204 [00:01<00:01, 75.11it/s] 52%|█████▏    | 107/204 [00:01<00:01, 79.93it/s] 57%|█████▋    | 117/204 [00:01<00:01, 83.82it/s] 62%|██████▏   | 127/204 [00:02<00:00, 86.87it/s] 67%|██████▋   | 137/204 [00:02<00:00, 89.02it/s] 72%|███████▏  | 147/204 [00:02<00:00, 90.86it/s] 77%|███████▋  | 157/204 [00:02<00:00, 92.04it/s] 82%|████████▏ | 167/204 [00:02<00:00, 91.90it/s] 87%|████████▋ | 177/204 [00:02<00:00, 92.53it/s] 92%|█████████▏| 187/204 [00:02<00:00, 84.70it/s] 97%|█████████▋| 197/204 [00:02<00:00, 86.81it/s]100%|██████████| 204/204 [00:02<00:00, 69.65it/s]
26032 images processed, 3.0439352989196777 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:56,  1.38it/s] 11%|█▏        | 9/79 [00:00<00:04, 14.26it/s] 22%|██▏       | 17/79 [00:00<00:02, 26.64it/s] 34%|███▍      | 27/79 [00:01<00:01, 41.78it/s] 47%|████▋     | 37/79 [00:01<00:00, 54.38it/s] 59%|█████▉    | 47/79 [00:01<00:00, 64.02it/s] 71%|███████   | 56/79 [00:01<00:00, 68.08it/s] 82%|████████▏ | 65/79 [00:01<00:00, 73.69it/s] 95%|█████████▍| 75/79 [00:01<00:00, 80.09it/s]100%|██████████| 79/79 [00:01<00:00, 49.24it/s]
10000 images processed, 1.6502125263214111 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:50,  1.55it/s] 10%|█         | 8/79 [00:00<00:05, 13.83it/s] 23%|██▎       | 18/79 [00:00<00:01, 31.12it/s] 35%|███▌      | 28/79 [00:00<00:01, 46.03it/s] 48%|████▊     | 38/79 [00:01<00:00, 58.04it/s] 61%|██████    | 48/79 [00:01<00:00, 67.68it/s] 73%|███████▎  | 58/79 [00:01<00:00, 75.42it/s] 86%|████████▌ | 68/79 [00:01<00:00, 80.90it/s] 99%|█████████▊| 78/79 [00:01<00:00, 82.27it/s]100%|██████████| 79/79 [00:01<00:00, 52.57it/s]
10000 images processed, 1.5431950092315674 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.88it/s] 14%|█▍        | 10/70 [00:00<00:02, 20.48it/s] 29%|██▊       | 20/70 [00:00<00:01, 38.45it/s] 43%|████▎     | 30/70 [00:00<00:00, 52.52it/s] 57%|█████▋    | 40/70 [00:00<00:00, 63.25it/s] 71%|███████▏  | 50/70 [00:01<00:00, 71.79it/s] 86%|████████▌ | 60/70 [00:01<00:00, 78.72it/s]100%|██████████| 70/70 [00:01<00:00, 80.55it/s]100%|██████████| 70/70 [00:01<00:00, 54.54it/s]
8925 images processed, 1.327690601348877 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:53,  1.22s/it] 16%|█▌        | 7/45 [00:01<00:05,  6.85it/s] 38%|███▊      | 17/45 [00:01<00:02, 13.23it/s] 47%|████▋     | 21/45 [00:01<00:01, 15.42it/s] 53%|█████▎    | 24/45 [00:02<00:01, 15.63it/s] 73%|███████▎  | 33/45 [00:02<00:00, 16.13it/s] 93%|█████████▎| 42/45 [00:02<00:00, 24.41it/s]100%|██████████| 45/45 [00:02<00:00, 16.19it/s]
5640 images processed, 2.800053596496582 seconds used

19.168984174728394
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           6.18  98.58  83.39
places365     56.41  83.08  45.12
LSUN          50.37  85.98  57.31
iSUN          42.78  89.97  67.19
dtd           24.08  93.96  82.30
AVG           35.96  90.31  67.06
[incremental] Overall: 0.7153 New: 0.7300 Old: 0.7080
[incremental] Final(Top-1): 0.7153  Average: 0.7651
8.85232162475586
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=30, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/30 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  3%|▎         | 1/30 [00:17<08:25, 17.43s/it]  7%|▋         | 2/30 [00:27<06:07, 13.14s/it] 10%|█         | 3/30 [00:37<05:16, 11.71s/it] 13%|█▎        | 4/30 [00:47<04:45, 10.99s/it] 17%|█▋        | 5/30 [00:57<04:24, 10.56s/it] 20%|██        | 6/30 [01:07<04:09, 10.38s/it][loss] ep 0 it 0 total=14.2144 mle=2.5822 pcon=9.8394 forget=0.0000 orth=1.7928 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=14.0275 mle=2.3949 pcon=9.8402 forget=0.0000 orth=1.7924 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=14.1465 mle=2.5142 pcon=9.8407 forget=0.0000 orth=1.7915 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=13.9697 mle=2.3405 pcon=9.8392 forget=0.0000 orth=1.7900 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=13.6366 mle=2.0113 pcon=9.8375 forget=0.0000 orth=1.7879 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.8207 mle=2.2008 pcon=9.8348 forget=0.0000 orth=1.7852 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=14.1775 mle=2.5648 pcon=9.8309 forget=0.0000 orth=1.7818 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.8009 mle=2.1978 pcon=9.8254 forget=0.0000 orth=1.7777 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.7214 mle=2.1283 pcon=9.8200 forget=0.0000 orth=1.7730 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.7639 mle=2.1817 pcon=9.8146 forget=0.0000 orth=1.7677 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.8394 mle=2.2692 pcon=9.8086 forget=0.0000 orth=1.7616 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=14.0215 mle=2.4644 pcon=9.8023 forget=0.0000 orth=1.7548 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.8554 mle=2.3135 pcon=9.7945 forget=0.0000 orth=1.7473 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.5549 mle=2.0290 pcon=9.7868 forget=0.0000 orth=1.7391 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.7735 mle=2.2641 pcon=9.7793 forget=0.0000 orth=1.7300 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.7674 mle=2.2765 pcon=9.7707 forget=0.0000 orth=1.7202 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.6301 mle=2.1569 pcon=9.7637 forget=0.0000 orth=1.7095 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.6202 mle=2.1659 pcon=9.7563 forget=0.0000 orth=1.6980 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.4221 mle=1.9878 pcon=9.7487 forget=0.0000 orth=1.6856 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.5785 mle=2.1649 pcon=9.7413 forget=0.0000 orth=1.6723 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.2308 mle=1.8400 pcon=9.7327 forget=0.0000 orth=1.6581 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.5912 mle=2.2247 pcon=9.7235 forget=0.0000 orth=1.6430 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.5528 mle=2.2100 pcon=9.7158 forget=0.0000 orth=1.6270 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.0838 mle=1.7659 pcon=9.7078 forget=0.0000 orth=1.6101 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.4594 mle=2.1678 pcon=9.6994 forget=0.0000 orth=1.5922 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.5314 mle=2.2666 pcon=9.6913 forget=0.0000 orth=1.5735 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.3793 mle=2.1429 pcon=9.6826 forget=0.0000 orth=1.5538 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.3047 mle=2.0973 pcon=9.6741 forget=0.0000 orth=1.5334 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.1810 mle=2.0026 pcon=9.6661 forget=0.0000 orth=1.5122 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.1451 mle=1.9968 pcon=9.6579 forget=0.0000 orth=1.4903 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.1895 mle=2.0720 pcon=9.6496 forget=0.0000 orth=1.4679 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.0916 mle=2.0050 pcon=9.6416 forget=0.0000 orth=1.4449 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.1433 mle=2.0887 pcon=9.6330 forget=0.0000 orth=1.4216 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.0891 mle=2.0663 pcon=9.6248 forget=0.0000 orth=1.3980 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.0642 mle=2.0732 pcon=9.6167 forget=0.0000 orth=1.3743 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.8533 mle=1.8938 pcon=9.6090 forget=0.0000 orth=1.3505 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.8944 mle=1.9665 pcon=9.6011 forget=0.0000 orth=1.3268 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.8175 mle=1.9202 pcon=9.5941 forget=0.0000 orth=1.3032 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.1126 mle=2.2464 pcon=9.5865 forget=0.0000 orth=1.2797 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.7891 mle=1.9535 pcon=9.5792 forget=0.0000 orth=1.2565 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 5 it 45 total=12.8803 mle=2.0751 pcon=9.5717 forget=0.0000 orth=1.2335 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.7772 mle=2.0017 pcon=9.5646 forget=0.0000 orth=1.2109 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.7514 mle=2.0065 pcon=9.5564 forget=0.0000 orth=1.1886 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.7755 mle=2.0596 pcon=9.5494 forget=0.0000 orth=1.1664 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.7164 mle=2.0292 pcon=9.5426 forget=0.0000 orth=1.1446 favg=0.0000 nr=97 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.5195 mle=1.8610 pcon=9.5354 forget=0.0000 orth=1.1230 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.7564 mle=2.1255 pcon=9.5293 forget=0.0000 orth=1.1016 favg=0.0000 nr=95 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 6 it 4 total=12.6941 mle=2.0915 pcon=9.5220 forget=0.0000 orth=1.0806 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.6593 mle=2.0843 pcon=9.5152 forget=0.0000 orth=1.0598 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.4231 mle=1.8757 pcon=9.5083 forget=0.0000 orth=1.0392 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.3201 mle=1.8000 pcon=9.5012 forget=0.0000 orth=1.0189 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=12.4523 mle=1.9587 pcon=9.4946 forget=0.0000 orth=0.9991 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
 23%|██▎       | 7/30 [01:17<03:53, 10.17s/it] 27%|██▋       | 8/30 [01:27<03:43, 10.16s/it] 30%|███       | 9/30 [01:37<03:31, 10.09s/it] 33%|███▎      | 10/30 [01:46<03:20, 10.03s/it] 37%|███▋      | 11/30 [01:57<03:11, 10.08s/it] 40%|████      | 12/30 [02:07<03:02, 10.12s/it] 43%|████▎     | 13/30 [02:18<02:55, 10.30s/it][loss] ep 6 it 254 total=12.5469 mle=2.0794 pcon=9.4880 forget=0.0000 orth=0.9796 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.6624 mle=2.2209 pcon=9.4811 forget=0.0000 orth=0.9603 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.3512 mle=1.9351 pcon=9.4748 forget=0.0000 orth=0.9414 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 7 it 13 total=12.5453 mle=2.1534 pcon=9.4690 forget=0.0000 orth=0.9230 favg=0.0000 nr=98 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.6322 mle=2.2647 pcon=9.4625 forget=0.0000 orth=0.9050 favg=0.0000 nr=94 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.4749 mle=2.1310 pcon=9.4565 forget=0.0000 orth=0.8874 favg=0.0000 nr=93 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.5490 mle=2.2280 pcon=9.4508 forget=0.0000 orth=0.8703 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.2809 mle=1.9826 pcon=9.4446 forget=0.0000 orth=0.8537 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.3998 mle=2.1242 pcon=9.4382 forget=0.0000 orth=0.8374 favg=0.0000 nr=102 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.2244 mle=1.9692 pcon=9.4335 forget=0.0000 orth=0.8217 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.3343 mle=2.1003 pcon=9.4278 forget=0.0000 orth=0.8063 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 8 it 22 total=12.2206 mle=2.0076 pcon=9.4217 forget=0.0000 orth=0.7913 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.0683 mle=1.8750 pcon=9.4166 forget=0.0000 orth=0.7767 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.0707 mle=1.8973 pcon=9.4109 forget=0.0000 orth=0.7625 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.9270 mle=1.7728 pcon=9.4054 forget=0.0000 orth=0.7488 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.8731 mle=1.7368 pcon=9.4009 forget=0.0000 orth=0.7354 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.0657 mle=1.9479 pcon=9.3955 forget=0.0000 orth=0.7223 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.1292 mle=2.0290 pcon=9.3906 forget=0.0000 orth=0.7096 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.1963 mle=2.1138 pcon=9.3854 forget=0.0000 orth=0.6971 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 9 it 31 total=12.2413 mle=2.1758 pcon=9.3805 forget=0.0000 orth=0.6850 favg=0.0000 nr=92 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=12.0279 mle=1.9788 pcon=9.3757 forget=0.0000 orth=0.6733 favg=0.0000 nr=97 nf=13 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.8969 mle=1.8637 pcon=9.3713 forget=0.0000 orth=0.6619 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=12.0177 mle=2.0007 pcon=9.3662 forget=0.0000 orth=0.6508 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.8106 mle=1.8079 pcon=9.3628 forget=0.0000 orth=0.6400 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.9966 mle=2.0093 pcon=9.3578 forget=0.0000 orth=0.6295 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.0969 mle=2.1245 pcon=9.3533 forget=0.0000 orth=0.6192 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.8876 mle=1.9299 pcon=9.3487 forget=0.0000 orth=0.6090 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 10 it 40 total=11.8553 mle=1.9121 pcon=9.3441 forget=0.0000 orth=0.5991 favg=0.0000 nr=109 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.1542 mle=2.2255 pcon=9.3391 forget=0.0000 orth=0.5897 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.8607 mle=1.9453 pcon=9.3349 forget=0.0000 orth=0.5806 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.8376 mle=1.9355 pcon=9.3303 forget=0.0000 orth=0.5718 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.7371 mle=1.8482 pcon=9.3252 forget=0.0000 orth=0.5637 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0753 mle=2.1985 pcon=9.3213 forget=0.0000 orth=0.5555 favg=0.0000 nr=93 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.7585 mle=1.8932 pcon=9.3177 forget=0.0000 orth=0.5475 favg=0.0000 nr=100 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.0834 mle=2.2301 pcon=9.3134 forget=0.0000 orth=0.5399 favg=0.0000 nr=65 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 11 it 49 total=11.8017 mle=1.9598 pcon=9.3095 forget=0.0000 orth=0.5325 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.9961 mle=2.1662 pcon=9.3046 forget=0.0000 orth=0.5253 favg=0.0000 nr=93 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.9096 mle=2.0908 pcon=9.3004 forget=0.0000 orth=0.5184 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.8099 mle=2.0024 pcon=9.2958 forget=0.0000 orth=0.5117 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.5841 mle=1.7869 pcon=9.2919 forget=0.0000 orth=0.5052 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.8958 mle=2.1092 pcon=9.2876 forget=0.0000 orth=0.4990 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.6544 mle=1.8780 pcon=9.2835 forget=0.0000 orth=0.4929 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 12 it 8 total=11.8592 mle=2.0924 pcon=9.2798 forget=0.0000 orth=0.4870 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.7362 mle=1.9796 pcon=9.2754 forget=0.0000 orth=0.4812 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.8071 mle=2.0602 pcon=9.2714 forget=0.0000 orth=0.4755 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.7515 mle=2.0139 pcon=9.2675 forget=0.0000 orth=0.4701 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.6714 mle=1.9425 pcon=9.2639 forget=0.0000 orth=0.4649 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.9505 mle=2.2304 pcon=9.2604 forget=0.0000 orth=0.4597 favg=0.0000 nr=97 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8952 mle=2.1837 pcon=9.2568 forget=0.0000 orth=0.4548 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.7859 mle=2.0827 pcon=9.2533 forget=0.0000 orth=0.4499 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
 47%|████▋     | 14/30 [02:28<02:47, 10.46s/it] 50%|█████     | 15/30 [02:38<02:34, 10.29s/it] 53%|█████▎    | 16/30 [02:48<02:22, 10.17s/it] 57%|█████▋    | 17/30 [02:58<02:11, 10.12s/it] 60%|██████    | 18/30 [03:09<02:02, 10.18s/it] 63%|██████▎   | 19/30 [03:19<01:51, 10.14s/it][loss] ep 13 it 17 total=11.8047 mle=2.1094 pcon=9.2501 forget=0.0000 orth=0.4452 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.6044 mle=1.9171 pcon=9.2467 forget=0.0000 orth=0.4406 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.8314 mle=2.1519 pcon=9.2433 forget=0.0000 orth=0.4362 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.7990 mle=2.1273 pcon=9.2399 forget=0.0000 orth=0.4318 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.8365 mle=2.1718 pcon=9.2372 forget=0.0000 orth=0.4275 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.8001 mle=2.1423 pcon=9.2344 forget=0.0000 orth=0.4234 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.6518 mle=2.0017 pcon=9.2306 forget=0.0000 orth=0.4195 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.7435 mle=2.1012 pcon=9.2267 forget=0.0000 orth=0.4156 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 14 it 26 total=11.8293 mle=2.1936 pcon=9.2239 forget=0.0000 orth=0.4118 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.5611 mle=1.9322 pcon=9.2208 forget=0.0000 orth=0.4082 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.6559 mle=2.0336 pcon=9.2178 forget=0.0000 orth=0.4045 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.7955 mle=2.1812 pcon=9.2134 forget=0.0000 orth=0.4010 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.5538 mle=1.9464 pcon=9.2100 forget=0.0000 orth=0.3975 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.7844 mle=2.1842 pcon=9.2060 forget=0.0000 orth=0.3941 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.6819 mle=2.0876 pcon=9.2034 forget=0.0000 orth=0.3909 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.4472 mle=1.8591 pcon=9.2004 forget=0.0000 orth=0.3877 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 15 it 35 total=11.6065 mle=2.0249 pcon=9.1970 forget=0.0000 orth=0.3846 favg=0.0000 nr=99 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.6293 mle=2.0534 pcon=9.1943 forget=0.0000 orth=0.3816 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.5026 mle=1.9332 pcon=9.1908 forget=0.0000 orth=0.3786 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.5277 mle=1.9638 pcon=9.1881 forget=0.0000 orth=0.3757 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.6901 mle=2.1324 pcon=9.1848 forget=0.0000 orth=0.3729 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.5358 mle=1.9834 pcon=9.1821 forget=0.0000 orth=0.3703 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.7324 mle=2.1858 pcon=9.1790 forget=0.0000 orth=0.3676 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.5295 mle=1.9882 pcon=9.1763 forget=0.0000 orth=0.3650 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 16 it 44 total=11.7263 mle=2.1895 pcon=9.1744 forget=0.0000 orth=0.3625 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.7148 mle=2.1828 pcon=9.1720 forget=0.0000 orth=0.3600 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.5733 mle=2.0459 pcon=9.1698 forget=0.0000 orth=0.3575 favg=0.0000 nr=100 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.5194 mle=1.9981 pcon=9.1661 forget=0.0000 orth=0.3552 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.4969 mle=1.9799 pcon=9.1641 forget=0.0000 orth=0.3529 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.4115 mle=1.8992 pcon=9.1617 forget=0.0000 orth=0.3506 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.5434 mle=2.0364 pcon=9.1586 forget=0.0000 orth=0.3484 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 17 it 3 total=11.3202 mle=1.8185 pcon=9.1554 forget=0.0000 orth=0.3463 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.3311 mle=1.8344 pcon=9.1525 forget=0.0000 orth=0.3442 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.5638 mle=2.0723 pcon=9.1493 forget=0.0000 orth=0.3422 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.4194 mle=1.9329 pcon=9.1464 forget=0.0000 orth=0.3402 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.4504 mle=1.9687 pcon=9.1435 forget=0.0000 orth=0.3383 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.5204 mle=2.0427 pcon=9.1413 forget=0.0000 orth=0.3364 favg=0.0000 nr=101 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.3926 mle=1.9186 pcon=9.1394 forget=0.0000 orth=0.3345 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.4526 mle=1.9833 pcon=9.1365 forget=0.0000 orth=0.3327 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 18 it 12 total=11.5193 mle=2.0546 pcon=9.1337 forget=0.0000 orth=0.3310 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.6735 mle=2.2133 pcon=9.1308 forget=0.0000 orth=0.3293 favg=0.0000 nr=98 nf=12 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.3544 mle=1.8972 pcon=9.1296 forget=0.0000 orth=0.3277 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.5294 mle=2.0767 pcon=9.1267 forget=0.0000 orth=0.3260 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.5052 mle=2.0573 pcon=9.1234 forget=0.0000 orth=0.3245 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.4221 mle=1.9787 pcon=9.1204 forget=0.0000 orth=0.3230 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.4310 mle=1.9914 pcon=9.1181 forget=0.0000 orth=0.3215 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.3055 mle=1.8694 pcon=9.1160 forget=0.0000 orth=0.3200 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 19 it 21 total=11.3409 mle=1.9087 pcon=9.1136 forget=0.0000 orth=0.3186 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.5169 mle=2.0885 pcon=9.1112 forget=0.0000 orth=0.3172 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=11.3284 mle=1.9037 pcon=9.1089 forget=0.0000 orth=0.3158 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.4472 mle=2.0259 pcon=9.1068 forget=0.0000 orth=0.3145 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
 67%|██████▋   | 20/30 [03:28<01:40, 10.06s/it] 70%|███████   | 21/30 [03:38<01:30, 10.04s/it] 73%|███████▎  | 22/30 [03:48<01:20, 10.04s/it] 77%|███████▋  | 23/30 [03:59<01:10, 10.10s/it] 80%|████████  | 24/30 [04:09<01:00, 10.06s/it] 83%|████████▎ | 25/30 [04:19<00:50, 10.01s/it][loss] ep 19 it 221 total=11.4655 mle=2.0476 pcon=9.1047 forget=0.0000 orth=0.3132 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.5198 mle=2.1052 pcon=9.1026 forget=0.0000 orth=0.3119 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.5074 mle=2.0958 pcon=9.1009 forget=0.0000 orth=0.3107 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.4506 mle=2.0421 pcon=9.0989 forget=0.0000 orth=0.3095 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 20 it 30 total=11.5526 mle=2.1464 pcon=9.0977 forget=0.0000 orth=0.3084 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.3317 mle=1.9293 pcon=9.0952 forget=0.0000 orth=0.3073 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.4606 mle=2.0617 pcon=9.0927 forget=0.0000 orth=0.3062 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.4685 mle=2.0726 pcon=9.0908 forget=0.0000 orth=0.3051 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.3026 mle=1.9095 pcon=9.0891 forget=0.0000 orth=0.3041 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.4048 mle=2.0150 pcon=9.0867 forget=0.0000 orth=0.3031 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.6055 mle=2.2186 pcon=9.0848 forget=0.0000 orth=0.3021 favg=0.0000 nr=92 nf=13 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.4877 mle=2.1029 pcon=9.0837 forget=0.0000 orth=0.3011 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 21 it 39 total=11.3845 mle=2.0034 pcon=9.0809 forget=0.0000 orth=0.3002 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.3194 mle=1.9417 pcon=9.0784 forget=0.0000 orth=0.2993 favg=0.0000 nr=106 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.4448 mle=2.0696 pcon=9.0767 forget=0.0000 orth=0.2985 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.2969 mle=1.9244 pcon=9.0748 forget=0.0000 orth=0.2976 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.5038 mle=2.1342 pcon=9.0728 forget=0.0000 orth=0.2968 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.2754 mle=1.9080 pcon=9.0715 forget=0.0000 orth=0.2960 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.3107 mle=1.9460 pcon=9.0696 forget=0.0000 orth=0.2952 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.4815 mle=2.1198 pcon=9.0673 forget=0.0000 orth=0.2944 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 22 it 48 total=11.4844 mle=2.1253 pcon=9.0654 forget=0.0000 orth=0.2937 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.3026 mle=1.9460 pcon=9.0636 forget=0.0000 orth=0.2930 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.3974 mle=2.0431 pcon=9.0620 forget=0.0000 orth=0.2923 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.3047 mle=1.9528 pcon=9.0603 forget=0.0000 orth=0.2917 favg=0.0000 nr=102 nf=2 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.3854 mle=2.0358 pcon=9.0585 forget=0.0000 orth=0.2910 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.3659 mle=2.0182 pcon=9.0573 forget=0.0000 orth=0.2904 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.5230 mle=2.1779 pcon=9.0553 forget=0.0000 orth=0.2898 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 23 it 7 total=11.3125 mle=1.9698 pcon=9.0534 forget=0.0000 orth=0.2893 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.5138 mle=2.1731 pcon=9.0520 forget=0.0000 orth=0.2887 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=11.1489 mle=1.8109 pcon=9.0498 forget=0.0000 orth=0.2882 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.6489 mle=2.3126 pcon=9.0486 forget=0.0000 orth=0.2877 favg=0.0000 nr=94 nf=13 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.4349 mle=2.1006 pcon=9.0471 forget=0.0000 orth=0.2872 favg=0.0000 nr=96 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.3330 mle=2.0006 pcon=9.0457 forget=0.0000 orth=0.2867 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.4023 mle=2.0728 pcon=9.0432 forget=0.0000 orth=0.2863 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.2317 mle=1.9044 pcon=9.0415 forget=0.0000 orth=0.2858 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 24 it 16 total=11.4387 mle=2.1133 pcon=9.0399 forget=0.0000 orth=0.2854 favg=0.0000 nr=100 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.2708 mle=1.9469 pcon=9.0388 forget=0.0000 orth=0.2850 favg=0.0000 nr=105 nf=2 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.5107 mle=2.1887 pcon=9.0374 forget=0.0000 orth=0.2846 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.4860 mle=2.1665 pcon=9.0353 forget=0.0000 orth=0.2843 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.2208 mle=1.9034 pcon=9.0335 forget=0.0000 orth=0.2839 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.3042 mle=1.9895 pcon=9.0312 forget=0.0000 orth=0.2836 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.2678 mle=1.9549 pcon=9.0296 forget=0.0000 orth=0.2832 favg=0.0000 nr=103 nf=12 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.5533 mle=2.2427 pcon=9.0277 forget=0.0000 orth=0.2829 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 25 it 25 total=11.2333 mle=1.9251 pcon=9.0256 forget=0.0000 orth=0.2827 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=11.3673 mle=2.0604 pcon=9.0246 forget=0.0000 orth=0.2824 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.6548 mle=2.3503 pcon=9.0224 forget=0.0000 orth=0.2821 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=11.2975 mle=1.9944 pcon=9.0212 forget=0.0000 orth=0.2819 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=11.1908 mle=1.8899 pcon=9.0192 forget=0.0000 orth=0.2816 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.4349 mle=2.1354 pcon=9.0180 forget=0.0000 orth=0.2814 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=11.2403 mle=1.9426 pcon=9.0165 forget=0.0000 orth=0.2812 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=11.3624 mle=2.0658 pcon=9.0156 forget=0.0000 orth=0.2810 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
 87%|████████▋ | 26/30 [04:28<00:39,  9.97s/it] 90%|█████████ | 27/30 [04:38<00:29,  9.88s/it] 93%|█████████▎| 28/30 [04:48<00:19,  9.87s/it] 97%|█████████▋| 29/30 [04:58<00:09,  9.92s/it]100%|██████████| 30/30 [05:08<00:00,  9.79s/it]100%|██████████| 30/30 [05:08<00:00, 10.27s/it]
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 26 it 34 total=11.2059 mle=1.9108 pcon=9.0143 forget=0.0000 orth=0.2808 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.4384 mle=2.1454 pcon=9.0123 forget=0.0000 orth=0.2806 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=11.3761 mle=2.0837 pcon=9.0119 forget=0.0000 orth=0.2805 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=11.3821 mle=2.0908 pcon=9.0110 forget=0.0000 orth=0.2803 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=11.2177 mle=1.9278 pcon=9.0097 forget=0.0000 orth=0.2802 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=11.4034 mle=2.1151 pcon=9.0082 forget=0.0000 orth=0.2801 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=11.3209 mle=2.0339 pcon=9.0071 forget=0.0000 orth=0.2799 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=11.2210 mle=1.9355 pcon=9.0056 forget=0.0000 orth=0.2798 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 27 it 43 total=11.4858 mle=2.2015 pcon=9.0046 forget=0.0000 orth=0.2797 favg=0.0000 nr=97 nf=3 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=11.2961 mle=2.0125 pcon=9.0040 forget=0.0000 orth=0.2796 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=11.4317 mle=2.1493 pcon=9.0028 forget=0.0000 orth=0.2795 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=11.2959 mle=2.0152 pcon=9.0012 forget=0.0000 orth=0.2794 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=11.2953 mle=2.0157 pcon=9.0002 forget=0.0000 orth=0.2794 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=11.3080 mle=2.0299 pcon=8.9988 forget=0.0000 orth=0.2793 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=11.1070 mle=1.8306 pcon=8.9972 forget=0.0000 orth=0.2792 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 28 it 2 total=11.1289 mle=1.8534 pcon=8.9963 forget=0.0000 orth=0.2792 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=11.4461 mle=2.1722 pcon=8.9948 forget=0.0000 orth=0.2791 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=11.3237 mle=2.0507 pcon=8.9939 forget=0.0000 orth=0.2791 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.4785 mle=2.2058 pcon=8.9936 forget=0.0000 orth=0.2791 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=11.3941 mle=2.1227 pcon=8.9924 forget=0.0000 orth=0.2790 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=11.3307 mle=2.0603 pcon=8.9913 forget=0.0000 orth=0.2790 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=11.0871 mle=1.8170 pcon=8.9911 forget=0.0000 orth=0.2790 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=11.3029 mle=2.0342 pcon=8.9898 forget=0.0000 orth=0.2790 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 29 it 11 total=11.1218 mle=1.8545 pcon=8.9883 forget=0.0000 orth=0.2790 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=11.3206 mle=2.0538 pcon=8.9878 forget=0.0000 orth=0.2789 favg=0.0000 nr=99 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=11.4455 mle=2.1798 pcon=8.9868 forget=0.0000 orth=0.2789 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=11.2143 mle=1.9494 pcon=8.9860 forget=0.0000 orth=0.2789 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.4308 mle=2.1674 pcon=8.9845 forget=0.0000 orth=0.2789 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=11.3352 mle=2.0726 pcon=8.9837 forget=0.0000 orth=0.2789 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=11.2204 mle=1.9583 pcon=8.9831 forget=0.0000 orth=0.2789 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.5628 mle=2.3013 pcon=8.9826 forget=0.0000 orth=0.2789 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e30-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:48,  2.32it/s]  3%|▎         | 11/391 [00:00<00:14, 26.27it/s]  5%|▌         | 21/391 [00:00<00:08, 44.89it/s]  8%|▊         | 31/391 [00:00<00:06, 59.00it/s] 10%|█         | 41/391 [00:00<00:05, 69.34it/s] 13%|█▎        | 51/391 [00:00<00:04, 76.98it/s] 16%|█▌        | 61/391 [00:01<00:04, 81.66it/s] 18%|█▊        | 71/391 [00:01<00:04, 78.80it/s] 21%|██        | 81/391 [00:01<00:03, 83.67it/s] 23%|██▎       | 91/391 [00:01<00:03, 86.59it/s] 26%|██▌       | 101/391 [00:01<00:03, 88.72it/s] 28%|██▊       | 111/391 [00:01<00:03, 90.42it/s] 31%|███       | 121/391 [00:01<00:02, 90.67it/s] 34%|███▎      | 131/391 [00:01<00:02, 91.51it/s] 36%|███▌      | 141/391 [00:01<00:02, 92.80it/s] 39%|███▊      | 151/391 [00:02<00:02, 93.84it/s] 41%|████      | 161/391 [00:02<00:02, 94.26it/s] 44%|████▎     | 171/391 [00:02<00:02, 94.94it/s] 46%|████▋     | 181/391 [00:02<00:02, 91.41it/s] 49%|████▉     | 191/391 [00:02<00:02, 92.83it/s] 51%|█████▏    | 201/391 [00:02<00:02, 93.70it/s] 54%|█████▍    | 211/391 [00:02<00:01, 94.47it/s] 57%|█████▋    | 221/391 [00:02<00:01, 94.56it/s] 59%|█████▉    | 231/391 [00:02<00:01, 95.13it/s] 62%|██████▏   | 241/391 [00:03<00:01, 94.36it/s] 64%|██████▍   | 251/391 [00:03<00:01, 94.27it/s] 67%|██████▋   | 261/391 [00:03<00:01, 92.85it/s] 69%|██████▉   | 271/391 [00:03<00:01, 92.70it/s] 72%|███████▏  | 281/391 [00:03<00:01, 88.52it/s] 74%|███████▍  | 291/391 [00:03<00:01, 90.43it/s] 77%|███████▋  | 301/391 [00:03<00:00, 91.99it/s] 80%|███████▉  | 311/391 [00:03<00:00, 93.20it/s] 82%|████████▏ | 321/391 [00:03<00:00, 93.31it/s] 85%|████████▍ | 331/391 [00:03<00:00, 93.69it/s] 87%|████████▋ | 341/391 [00:04<00:00, 94.53it/s] 90%|████████▉ | 351/391 [00:04<00:00, 92.17it/s] 92%|█████████▏| 361/391 [00:04<00:00, 87.23it/s] 95%|█████████▍| 371/391 [00:04<00:00, 90.20it/s] 97%|█████████▋| 381/391 [00:04<00:00, 92.46it/s]100%|██████████| 391/391 [00:04<00:00, 91.93it/s]100%|██████████| 391/391 [00:04<00:00, 84.25it/s]
50000 images processed, 4.841540813446045 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:32,  2.37it/s] 14%|█▍        | 11/79 [00:00<00:02, 26.57it/s] 27%|██▋       | 21/79 [00:00<00:01, 44.89it/s] 39%|███▉      | 31/79 [00:00<00:00, 58.62it/s] 52%|█████▏    | 41/79 [00:00<00:00, 68.88it/s] 65%|██████▍   | 51/79 [00:00<00:00, 76.56it/s] 77%|███████▋  | 61/79 [00:01<00:00, 82.50it/s] 90%|████████▉ | 71/79 [00:01<00:00, 86.79it/s]100%|██████████| 79/79 [00:01<00:00, 43.11it/s]
10000 images processed, 1.8772802352905273 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:38,  2.07it/s]  5%|▌         | 11/204 [00:00<00:08, 23.87it/s] 10%|█         | 21/204 [00:00<00:04, 41.62it/s] 15%|█▌        | 31/204 [00:00<00:03, 55.29it/s] 20%|█▉        | 40/204 [00:00<00:02, 63.81it/s] 24%|██▍       | 49/204 [00:01<00:02, 61.07it/s] 29%|██▉       | 59/204 [00:01<00:02, 70.00it/s] 34%|███▍      | 69/204 [00:01<00:01, 76.55it/s] 39%|███▊      | 79/204 [00:01<00:01, 81.17it/s] 43%|████▎     | 88/204 [00:01<00:01, 81.05it/s] 48%|████▊     | 97/204 [00:01<00:01, 83.48it/s] 52%|█████▏    | 107/204 [00:01<00:01, 86.81it/s] 57%|█████▋    | 117/204 [00:01<00:00, 89.20it/s] 62%|██████▏   | 127/204 [00:01<00:00, 89.83it/s] 67%|██████▋   | 137/204 [00:02<00:00, 86.61it/s] 72%|███████▏  | 146/204 [00:02<00:00, 69.28it/s] 76%|███████▋  | 156/204 [00:02<00:00, 75.51it/s] 81%|████████▏ | 166/204 [00:02<00:00, 80.53it/s] 86%|████████▋ | 176/204 [00:02<00:00, 84.40it/s] 91%|█████████ | 186/204 [00:02<00:00, 87.84it/s] 96%|█████████▌| 196/204 [00:02<00:00, 78.13it/s]100%|██████████| 204/204 [00:02<00:00, 68.90it/s]
26032 images processed, 3.0920522212982178 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:59,  1.32it/s]  9%|▉         | 7/79 [00:00<00:06, 10.59it/s] 16%|█▋        | 13/79 [00:00<00:03, 19.62it/s] 29%|██▉       | 23/79 [00:01<00:01, 35.92it/s] 42%|████▏     | 33/79 [00:01<00:00, 49.93it/s] 52%|█████▏    | 41/79 [00:01<00:00, 52.30it/s] 62%|██████▏   | 49/79 [00:01<00:00, 58.58it/s] 72%|███████▏  | 57/79 [00:01<00:00, 62.46it/s] 82%|████████▏ | 65/79 [00:01<00:00, 62.27it/s] 94%|█████████▎| 74/79 [00:01<00:00, 67.71it/s]100%|██████████| 79/79 [00:01<00:00, 43.70it/s]
10000 images processed, 1.8448865413665771 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.22it/s]  9%|▉         | 7/79 [00:00<00:04, 16.13it/s] 15%|█▌        | 12/79 [00:00<00:02, 23.59it/s] 24%|██▍       | 19/79 [00:00<00:01, 35.33it/s] 37%|███▋      | 29/79 [00:00<00:00, 52.00it/s] 48%|████▊     | 38/79 [00:00<00:00, 62.28it/s] 58%|█████▊    | 46/79 [00:01<00:00, 57.09it/s] 67%|██████▋   | 53/79 [00:01<00:00, 54.63it/s] 76%|███████▌  | 60/79 [00:01<00:00, 58.40it/s] 89%|████████▊ | 70/79 [00:01<00:00, 68.73it/s]100%|██████████| 79/79 [00:01<00:00, 50.23it/s]
10000 images processed, 1.6083178520202637 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:55,  1.25it/s] 14%|█▍        | 10/70 [00:00<00:04, 14.63it/s] 29%|██▊       | 20/70 [00:01<00:01, 29.47it/s] 43%|████▎     | 30/70 [00:01<00:00, 42.95it/s] 57%|█████▋    | 40/70 [00:01<00:00, 54.78it/s] 71%|███████▏  | 50/70 [00:01<00:00, 64.91it/s] 86%|████████▌ | 60/70 [00:01<00:00, 73.11it/s]100%|██████████| 70/70 [00:01<00:00, 78.15it/s]100%|██████████| 70/70 [00:01<00:00, 45.47it/s]
8925 images processed, 1.5702769756317139 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.05it/s]  4%|▍         | 2/45 [00:01<00:22,  1.94it/s] 27%|██▋       | 12/45 [00:01<00:02, 13.70it/s] 38%|███▊      | 17/45 [00:01<00:01, 16.41it/s] 44%|████▍     | 20/45 [00:01<00:01, 16.77it/s] 53%|█████▎    | 24/45 [00:01<00:01, 17.43it/s] 73%|███████▎  | 33/45 [00:02<00:00, 22.23it/s] 80%|████████  | 36/45 [00:02<00:00, 20.43it/s] 89%|████████▉ | 40/45 [00:02<00:00, 18.35it/s]100%|██████████| 45/45 [00:02<00:00, 16.16it/s]
5640 images processed, 2.802910327911377 seconds used

19.333221197128296
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.80  98.98  90.02
places365     71.69  79.44  49.95
LSUN          40.39  91.03  74.44
iSUN          58.81  86.43  69.00
dtd           19.45  95.70  89.90
AVG           39.03  90.32  74.66
[incremental] Overall: 0.6515 New: 0.6640 Old: 0.6473
[incremental] Final(Top-1): 0.6515  Average: 0.7367
8.841610193252563
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:50,  1.54it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.08it/s] 27%|██▋       | 21/79 [00:00<00:01, 35.10it/s] 39%|███▉      | 31/79 [00:00<00:00, 48.97it/s] 52%|█████▏    | 41/79 [00:01<00:00, 60.41it/s] 65%|██████▍   | 51/79 [00:01<00:00, 69.56it/s] 77%|███████▋  | 61/79 [00:01<00:00, 76.84it/s] 90%|████████▉ | 71/79 [00:01<00:00, 65.84it/s]100%|██████████| 79/79 [00:01<00:00, 59.67it/s]100%|██████████| 79/79 [00:01<00:00, 48.03it/s]
10000 images processed, 1.6669108867645264 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.97it/s] 11%|█▏        | 8/70 [00:00<00:03, 15.59it/s] 24%|██▍       | 17/70 [00:00<00:01, 31.91it/s] 39%|███▊      | 27/70 [00:00<00:00, 47.60it/s] 53%|█████▎    | 37/70 [00:00<00:00, 60.08it/s] 67%|██████▋   | 47/70 [00:01<00:00, 69.76it/s] 81%|████████▏ | 57/70 [00:01<00:00, 77.10it/s] 96%|█████████▌| 67/70 [00:01<00:00, 82.60it/s]100%|██████████| 70/70 [00:01<00:00, 53.28it/s]
8925 images processed, 1.3543322086334229 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<01:05,  1.49s/it] 22%|██▏       | 10/45 [00:01<00:04,  8.48it/s] 38%|███▊      | 17/45 [00:02<00:02, 10.30it/s] 60%|██████    | 27/45 [00:02<00:00, 18.87it/s] 73%|███████▎  | 33/45 [00:02<00:00, 14.42it/s] 93%|█████████▎| 42/45 [00:02<00:00, 21.54it/s]100%|██████████| 45/45 [00:03<00:00, 14.94it/s]
5640 images processed, 3.0316646099090576 seconds used

19.174112558364868
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.80  98.98  90.02
places365     71.69  79.44  49.95
LSUN          40.39  91.03  74.44
iSUN          58.81  86.43  69.00
dtd           19.45  95.70  89.90
AVG           39.03  90.32  74.66
[incremental] Overall: 0.6515 New: 0.6640 Old: 0.6473
[incremental] Final(Top-1): 0.6515  Average: 0.7367
8.64116096496582
[DEBUG] Parsed: avg_fpr=39.03 avg_auroc=90.32 final_top1=0.6515 average=0.7367
[Result] AVG-AUROC=90.32 AVG-FPR=39.03 Final-Top1=0.6515 Average=0.7367 Score=72.53

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=35 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=35, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/35 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  3%|▎         | 1/35 [00:16<09:21, 16.51s/it]  6%|▌         | 2/35 [00:25<06:29, 11.81s/it]  9%|▊         | 3/35 [00:32<05:19,  9.99s/it] 11%|█▏        | 4/35 [00:41<04:51,  9.41s/it] 14%|█▍        | 5/35 [00:49<04:30,  9.01s/it] 17%|█▋        | 6/35 [00:58<04:15,  8.82s/it][loss] ep 0 it 0 total=8.5895 mle=3.2130 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6441 mle=3.2647 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0878 mle=3.7056 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6781 mle=3.2933 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9792 mle=2.5920 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9919 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4732 mle=4.0809 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4955 mle=3.1007 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5367 mle=3.1398 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2410 mle=2.8415 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7241 mle=3.3223 pcon=5.4019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0962 mle=3.6916 pcon=5.4046 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4461 mle=4.0389 pcon=5.4072 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3582 mle=2.9487 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0700 mle=3.6581 pcon=5.4119 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5544 mle=3.1403 pcon=5.4142 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5078 mle=3.0908 pcon=5.4169 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6320 mle=3.2130 pcon=5.4189 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2432 mle=2.8212 pcon=5.4220 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4327 mle=3.0083 pcon=5.4244 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7379 mle=2.3109 pcon=5.4269 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6784 mle=3.2490 pcon=5.4294 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8375 mle=3.4056 pcon=5.4319 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7150 mle=2.2805 pcon=5.4345 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.2999 mle=2.8637 pcon=5.4362 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4256 mle=2.9875 pcon=5.4381 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1016 mle=2.6616 pcon=5.4400 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9323 mle=2.4907 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6432 mle=2.2004 pcon=5.4427 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6505 mle=2.2063 pcon=5.4442 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6230 mle=2.1783 pcon=5.4447 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6687 mle=2.2231 pcon=5.4456 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6920 mle=2.2452 pcon=5.4468 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6985 mle=2.2507 pcon=5.4478 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7880 mle=2.3395 pcon=5.4485 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4443 mle=1.9939 pcon=5.4504 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4894 mle=2.0372 pcon=5.4521 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4850 mle=2.0301 pcon=5.4549 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9109 mle=2.4541 pcon=5.4568 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4957 mle=2.0364 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 5 it 45 total=7.5991 mle=2.1381 pcon=5.4610 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.5302 mle=2.0670 pcon=5.4632 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.5469 mle=2.0817 pcon=5.4652 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.6398 mle=2.1721 pcon=5.4676 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.6796 mle=2.2100 pcon=5.4696 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.3914 mle=1.9190 pcon=5.4724 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7726 mle=2.2975 pcon=5.4751 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 6 it 4 total=7.6267 mle=2.1492 pcon=5.4775 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.7451 mle=2.2648 pcon=5.4803 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.5334 mle=2.0505 pcon=5.4829 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.3493 mle=1.8647 pcon=5.4846 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.5081 mle=2.0203 pcon=5.4878 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
 20%|██        | 7/35 [01:06<04:02,  8.67s/it] 23%|██▎       | 8/35 [01:14<03:50,  8.56s/it] 26%|██▌       | 9/35 [01:23<03:42,  8.55s/it] 29%|██▊       | 10/35 [01:31<03:30,  8.40s/it] 31%|███▏      | 11/35 [01:39<03:17,  8.23s/it] 34%|███▍      | 12/35 [01:47<03:07,  8.17s/it] 37%|███▋      | 13/35 [01:55<03:01,  8.26s/it] 40%|████      | 14/35 [02:03<02:51,  8.19s/it][loss] ep 6 it 254 total=7.5030 mle=2.0122 pcon=5.4908 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.9122 mle=2.4183 pcon=5.4939 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.4513 mle=1.9541 pcon=5.4972 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 13 total=7.7897 mle=2.2891 pcon=5.5007 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.9125 mle=2.4083 pcon=5.5042 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.7383 mle=2.2307 pcon=5.5076 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.8007 mle=2.2895 pcon=5.5112 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.5632 mle=2.0490 pcon=5.5142 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.6841 mle=2.1657 pcon=5.5184 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.5471 mle=2.0253 pcon=5.5218 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.6893 mle=2.1635 pcon=5.5258 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 22 total=7.6969 mle=2.1677 pcon=5.5292 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.5196 mle=1.9873 pcon=5.5323 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.3988 mle=1.8634 pcon=5.5354 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=7.3099 mle=1.7706 pcon=5.5392 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=7.3353 mle=1.7921 pcon=5.5432 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.5152 mle=1.9687 pcon=5.5466 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=7.5382 mle=1.9884 pcon=5.5498 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=7.7830 mle=2.2293 pcon=5.5537 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 31 total=7.9270 mle=2.3705 pcon=5.5565 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=7.6421 mle=2.0821 pcon=5.5600 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=7.4835 mle=1.9207 pcon=5.5628 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=7.6008 mle=2.0348 pcon=5.5660 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=7.5367 mle=1.9671 pcon=5.5695 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=7.5924 mle=2.0193 pcon=5.5731 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=7.6972 mle=2.1211 pcon=5.5761 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=7.5190 mle=1.9397 pcon=5.5793 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 40 total=7.4386 mle=1.8568 pcon=5.5817 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=7.9047 mle=2.3206 pcon=5.5842 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=7.5866 mle=1.9996 pcon=5.5870 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=7.5869 mle=1.9970 pcon=5.5899 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=7.4325 mle=1.8403 pcon=5.5922 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=7.8543 mle=2.2590 pcon=5.5953 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=7.5764 mle=1.9789 pcon=5.5975 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=7.8366 mle=2.2361 pcon=5.6005 forget=0.0000 orth=0.0000 favg=0.0000 nr=77 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 49 total=7.5664 mle=1.9627 pcon=5.6037 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=7.9003 mle=2.2936 pcon=5.6067 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=7.7698 mle=2.1603 pcon=5.6095 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=7.6114 mle=1.9989 pcon=5.6125 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=7.4137 mle=1.7979 pcon=5.6158 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=7.7316 mle=2.1134 pcon=5.6182 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=7.4544 mle=1.8338 pcon=5.6205 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 8 total=7.8479 mle=2.2249 pcon=5.6230 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=7.6099 mle=1.9845 pcon=5.6253 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=7.8279 mle=2.1999 pcon=5.6280 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=7.5989 mle=1.9680 pcon=5.6309 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=7.6265 mle=1.9930 pcon=5.6335 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=7.9019 mle=2.2658 pcon=5.6361 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=7.7429 mle=2.1047 pcon=5.6382 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=7.7905 mle=2.1498 pcon=5.6408 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 17 total=7.8737 mle=2.2306 pcon=5.6431 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=7.6738 mle=2.0281 pcon=5.6457 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=7.9257 mle=2.2783 pcon=5.6474 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=7.7541 mle=2.1049 pcon=5.6492 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=7.9475 mle=2.2969 pcon=5.6506 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=7.8502 mle=2.1973 pcon=5.6529 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=7.7401 mle=2.0852 pcon=5.6549 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=7.7595 mle=2.1019 pcon=5.6575 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 26 total=7.9676 mle=2.3083 pcon=5.6592 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=7.7010 mle=2.0402 pcon=5.6608 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=7.7289 mle=2.0667 pcon=5.6622 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=7.8704 mle=2.2068 pcon=5.6636 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
 43%|████▎     | 15/35 [02:11<02:42,  8.13s/it] 46%|████▌     | 16/35 [02:19<02:31,  7.95s/it] 49%|████▊     | 17/35 [02:26<02:21,  7.85s/it] 51%|█████▏    | 18/35 [02:34<02:13,  7.85s/it] 54%|█████▍    | 19/35 [02:42<02:06,  7.92s/it] 57%|█████▋    | 20/35 [02:50<01:59,  7.96s/it] 60%|██████    | 21/35 [02:59<01:52,  8.07s/it] 63%|██████▎   | 22/35 [03:07<01:45,  8.11s/it][loss] ep 14 it 226 total=7.6117 mle=1.9463 pcon=5.6654 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=7.8305 mle=2.1629 pcon=5.6677 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=7.7759 mle=2.1066 pcon=5.6693 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=7.5912 mle=1.9203 pcon=5.6709 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 15 it 35 total=7.8054 mle=2.1328 pcon=5.6726 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=7.7870 mle=2.1123 pcon=5.6747 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=7.6453 mle=1.9691 pcon=5.6762 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=7.6454 mle=1.9681 pcon=5.6772 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=7.8561 mle=2.1780 pcon=5.6781 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=7.7258 mle=2.0463 pcon=5.6796 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=7.9079 mle=2.2272 pcon=5.6808 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=7.6825 mle=2.0002 pcon=5.6823 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 44 total=7.8756 mle=2.1923 pcon=5.6833 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=7.8322 mle=2.1474 pcon=5.6848 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=7.7360 mle=2.0502 pcon=5.6858 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=7.7357 mle=2.0490 pcon=5.6867 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=7.6668 mle=1.9788 pcon=5.6880 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=7.5873 mle=1.8983 pcon=5.6890 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=7.7523 mle=2.0629 pcon=5.6894 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 3 total=7.4743 mle=1.7837 pcon=5.6906 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=7.5364 mle=1.8448 pcon=5.6916 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=7.7233 mle=2.0307 pcon=5.6926 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=7.5304 mle=1.8365 pcon=5.6939 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=7.6376 mle=1.9430 pcon=5.6946 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=7.7530 mle=2.0581 pcon=5.6948 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=7.6387 mle=1.9435 pcon=5.6952 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=7.6483 mle=1.9524 pcon=5.6959 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 12 total=7.6795 mle=1.9832 pcon=5.6963 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=7.9798 mle=2.2834 pcon=5.6964 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=7.6344 mle=1.9378 pcon=5.6966 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=7.7755 mle=2.0786 pcon=5.6969 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=7.8436 mle=2.1463 pcon=5.6973 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=7.6899 mle=1.9926 pcon=5.6973 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=7.6204 mle=1.9226 pcon=5.6977 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=7.5022 mle=1.8043 pcon=5.6979 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 21 total=7.6711 mle=1.9728 pcon=5.6982 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=7.7348 mle=2.0362 pcon=5.6986 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=7.6605 mle=1.9621 pcon=5.6984 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=7.7290 mle=2.0303 pcon=5.6987 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=7.7426 mle=2.0435 pcon=5.6991 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=7.9104 mle=2.2112 pcon=5.6992 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=7.8309 mle=2.1314 pcon=5.6995 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=7.7586 mle=2.0593 pcon=5.6994 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 30 total=7.8485 mle=2.1489 pcon=5.6996 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=7.6132 mle=1.9132 pcon=5.7000 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=7.7719 mle=2.0720 pcon=5.6999 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=7.8326 mle=2.1318 pcon=5.7008 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=7.5315 mle=1.8308 pcon=5.7007 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=7.7786 mle=2.0791 pcon=5.6995 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=8.0128 mle=2.3130 pcon=5.6998 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=7.9530 mle=2.2527 pcon=5.7003 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 39 total=7.7813 mle=2.0820 pcon=5.6993 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=7.5781 mle=1.8784 pcon=5.6997 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=7.7158 mle=2.0164 pcon=5.6994 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=7.5491 mle=1.8496 pcon=5.6995 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=7.8814 mle=2.1826 pcon=5.6987 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=7.6340 mle=1.9353 pcon=5.6987 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=7.6557 mle=1.9568 pcon=5.6988 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=7.8945 mle=2.1959 pcon=5.6987 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 48 total=7.8535 mle=2.1547 pcon=5.6988 forget=0.0000 orth=0.0000 favg=0.0000 nr=115 nf=13 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=7.7368 mle=2.0384 pcon=5.6983 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=7.7292 mle=2.0307 pcon=5.6985 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
 66%|██████▌   | 23/35 [03:15<01:38,  8.23s/it] 69%|██████▊   | 24/35 [03:23<01:28,  8.07s/it] 71%|███████▏  | 25/35 [03:31<01:20,  8.04s/it] 74%|███████▍  | 26/35 [03:39<01:11,  7.94s/it] 77%|███████▋  | 27/35 [03:47<01:04,  8.05s/it] 80%|████████  | 28/35 [03:55<00:55,  7.99s/it] 83%|████████▎ | 29/35 [04:02<00:47,  7.84s/it] 86%|████████▌ | 30/35 [04:10<00:39,  7.87s/it][loss] ep 22 it 198 total=7.6402 mle=1.9413 pcon=5.6989 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=7.7968 mle=2.0978 pcon=5.6990 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=7.7908 mle=2.0927 pcon=5.6981 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=7.8809 mle=2.1831 pcon=5.6978 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 7 total=7.7635 mle=2.0665 pcon=5.6971 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=7.7880 mle=2.0908 pcon=5.6972 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=7.4810 mle=1.7839 pcon=5.6971 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=8.0512 mle=2.3550 pcon=5.6962 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=7.8219 mle=2.1258 pcon=5.6962 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=7.7879 mle=2.0917 pcon=5.6962 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=7.7815 mle=2.0855 pcon=5.6960 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=7.6383 mle=1.9432 pcon=5.6950 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 16 total=7.8631 mle=2.1691 pcon=5.6939 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=7.6616 mle=1.9679 pcon=5.6937 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=7.8682 mle=2.1746 pcon=5.6937 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=7.8207 mle=2.1279 pcon=5.6928 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=7.5772 mle=1.8852 pcon=5.6920 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=7.7179 mle=2.0267 pcon=5.6912 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=7.7147 mle=2.0233 pcon=5.6914 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=8.0372 mle=2.3458 pcon=5.6914 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 25 it 25 total=7.5498 mle=1.8591 pcon=5.6907 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=7.6819 mle=1.9908 pcon=5.6911 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=7.9634 mle=2.2731 pcon=5.6903 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=7.7388 mle=2.0489 pcon=5.6899 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=7.5323 mle=1.8431 pcon=5.6892 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=7.8893 mle=2.2007 pcon=5.6886 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=7.6559 mle=1.9674 pcon=5.6885 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=7.7912 mle=2.1041 pcon=5.6871 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 34 total=7.5774 mle=1.8902 pcon=5.6872 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=7.8192 mle=2.1331 pcon=5.6861 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=7.7449 mle=2.0587 pcon=5.6862 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=7.7807 mle=2.0952 pcon=5.6855 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=7.6240 mle=1.9385 pcon=5.6855 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=7.8264 mle=2.1412 pcon=5.6851 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=7.7464 mle=2.0620 pcon=5.6844 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=7.6265 mle=1.9422 pcon=5.6843 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 43 total=7.9038 mle=2.2194 pcon=5.6844 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=7.7756 mle=2.0914 pcon=5.6842 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=7.8312 mle=2.1471 pcon=5.6840 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=7.7320 mle=2.0484 pcon=5.6836 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=7.7709 mle=2.0876 pcon=5.6833 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=7.6464 mle=1.9633 pcon=5.6831 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=7.4604 mle=1.7778 pcon=5.6826 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 2 total=7.5830 mle=1.9016 pcon=5.6814 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=7.8979 mle=2.2169 pcon=5.6810 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=7.6848 mle=2.0049 pcon=5.6798 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=7.9223 mle=2.2425 pcon=5.6797 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=7.7683 mle=2.0895 pcon=5.6789 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=7.7757 mle=2.0973 pcon=5.6784 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=7.4406 mle=1.7623 pcon=5.6783 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=7.5664 mle=1.8890 pcon=5.6774 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 11 total=7.5779 mle=1.9008 pcon=5.6772 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=7.7884 mle=2.1114 pcon=5.6770 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=7.9713 mle=2.2948 pcon=5.6765 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=7.5506 mle=1.8745 pcon=5.6761 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=7.8090 mle=2.1333 pcon=5.6757 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=7.7164 mle=2.0406 pcon=5.6758 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=7.6649 mle=1.9892 pcon=5.6756 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=7.9861 mle=2.3110 pcon=5.6751 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 20 total=7.6658 mle=1.9911 pcon=5.6747 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=7.8334 mle=2.1593 pcon=5.6741 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=7.5691 mle=1.8958 pcon=5.6733 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
 89%|████████▊ | 31/35 [04:18<00:31,  7.82s/it] 91%|█████████▏| 32/35 [04:26<00:23,  7.83s/it] 94%|█████████▍| 33/35 [04:34<00:16,  8.02s/it] 97%|█████████▋| 34/35 [04:42<00:07,  7.85s/it]100%|██████████| 35/35 [04:50<00:00,  8.01s/it]100%|██████████| 35/35 [04:50<00:00,  8.31s/it]
[loss] ep 30 it 170 total=7.9687 mle=2.2957 pcon=5.6730 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=7.8390 mle=2.1659 pcon=5.6730 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=7.5139 mle=1.8413 pcon=5.6726 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=7.7191 mle=2.0466 pcon=5.6725 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=7.7961 mle=2.1241 pcon=5.6720 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 29 total=7.5340 mle=1.8617 pcon=5.6723 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=7.8529 mle=2.1807 pcon=5.6721 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=7.6803 mle=2.0086 pcon=5.6716 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=7.8009 mle=2.1288 pcon=5.6721 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=7.7517 mle=2.0805 pcon=5.6713 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=7.5576 mle=1.8872 pcon=5.6703 forget=0.0000 orth=0.0000 favg=0.0000 nr=127 nf=1 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=7.8047 mle=2.1348 pcon=5.6699 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=7.9174 mle=2.2486 pcon=5.6688 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 32 it 38 total=7.7095 mle=2.0412 pcon=5.6684 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=7.6322 mle=1.9643 pcon=5.6679 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=7.6587 mle=1.9910 pcon=5.6677 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=7.7995 mle=2.1320 pcon=5.6675 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=7.5424 mle=1.8754 pcon=5.6670 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=7.6282 mle=1.9615 pcon=5.6667 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=7.8289 mle=2.1616 pcon=5.6673 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=7.5238 mle=1.8565 pcon=5.6673 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 33 it 47 total=7.9220 mle=2.2552 pcon=5.6667 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=7.8403 mle=2.1743 pcon=5.6661 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=7.6861 mle=2.0200 pcon=5.6661 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=7.4634 mle=1.7978 pcon=5.6656 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=7.6277 mle=1.9620 pcon=5.6657 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=7.7932 mle=2.1280 pcon=5.6653 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=7.9776 mle=2.3129 pcon=5.6647 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 6 total=7.8912 mle=2.2262 pcon=5.6650 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=7.5683 mle=1.9036 pcon=5.6648 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=7.5619 mle=1.8971 pcon=5.6648 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=7.7209 mle=2.0564 pcon=5.6645 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=7.5881 mle=1.9234 pcon=5.6647 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=7.6150 mle=1.9504 pcon=5.6647 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=7.6460 mle=1.9820 pcon=5.6639 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=7.8477 mle=2.1844 pcon=5.6633 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:42,  1.76it/s]  3%|▎         | 11/391 [00:00<00:17, 21.20it/s]  5%|▌         | 21/391 [00:00<00:09, 38.15it/s]  8%|▊         | 31/391 [00:00<00:06, 52.26it/s] 10%|█         | 41/391 [00:00<00:05, 63.56it/s] 13%|█▎        | 51/391 [00:01<00:04, 72.26it/s] 16%|█▌        | 61/391 [00:01<00:04, 78.72it/s] 18%|█▊        | 71/391 [00:01<00:07, 42.89it/s] 20%|██        | 80/391 [00:01<00:06, 49.91it/s] 23%|██▎       | 90/391 [00:01<00:05, 58.48it/s] 26%|██▌       | 100/391 [00:01<00:04, 65.80it/s] 28%|██▊       | 109/391 [00:02<00:04, 63.42it/s] 30%|██▉       | 117/391 [00:02<00:04, 62.39it/s] 32%|███▏      | 125/391 [00:02<00:04, 63.15it/s] 34%|███▍      | 132/391 [00:02<00:04, 63.68it/s] 36%|███▌      | 139/391 [00:02<00:03, 63.16it/s] 38%|███▊      | 149/391 [00:02<00:03, 71.33it/s] 41%|████      | 159/391 [00:02<00:03, 77.00it/s] 43%|████▎     | 169/391 [00:02<00:02, 81.96it/s] 46%|████▌     | 179/391 [00:03<00:02, 85.44it/s] 48%|████▊     | 189/391 [00:03<00:02, 87.66it/s] 51%|█████     | 198/391 [00:03<00:02, 87.37it/s] 53%|█████▎    | 207/391 [00:03<00:02, 76.81it/s] 55%|█████▍    | 215/391 [00:03<00:02, 65.64it/s] 57%|█████▋    | 222/391 [00:03<00:02, 63.45it/s] 59%|█████▊    | 229/391 [00:03<00:02, 61.38it/s] 60%|██████    | 236/391 [00:03<00:02, 60.28it/s] 63%|██████▎   | 246/391 [00:04<00:02, 69.31it/s] 65%|██████▌   | 256/391 [00:04<00:01, 75.79it/s] 68%|██████▊   | 265/391 [00:04<00:01, 79.53it/s] 70%|███████   | 275/391 [00:04<00:01, 84.02it/s] 73%|███████▎  | 284/391 [00:04<00:01, 78.70it/s] 75%|███████▍  | 293/391 [00:04<00:01, 71.41it/s] 77%|███████▋  | 301/391 [00:04<00:01, 64.75it/s] 79%|███████▉  | 308/391 [00:04<00:01, 57.19it/s] 80%|████████  | 314/391 [00:05<00:01, 53.74it/s] 83%|████████▎ | 324/391 [00:05<00:01, 63.79it/s] 85%|████████▌ | 334/391 [00:05<00:00, 71.95it/s] 88%|████████▊ | 343/391 [00:05<00:00, 74.00it/s] 90%|████████▉ | 351/391 [00:05<00:00, 62.91it/s] 92%|█████████▏| 358/391 [00:05<00:00, 60.10it/s] 94%|█████████▎| 366/391 [00:05<00:00, 63.44it/s] 96%|█████████▌| 374/391 [00:05<00:00, 65.03it/s] 98%|█████████▊| 384/391 [00:06<00:00, 72.32it/s]100%|██████████| 391/391 [00:06<00:00, 63.65it/s]
50000 images processed, 6.262903928756714 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:31,  2.51it/s] 14%|█▍        | 11/79 [00:00<00:02, 27.72it/s] 27%|██▋       | 21/79 [00:00<00:01, 46.14it/s] 37%|███▋      | 29/79 [00:00<00:00, 51.85it/s] 46%|████▌     | 36/79 [00:00<00:00, 56.57it/s] 58%|█████▊    | 46/79 [00:00<00:00, 67.53it/s] 68%|██████▊   | 54/79 [00:01<00:00, 67.63it/s] 78%|███████▊  | 62/79 [00:01<00:00, 64.53it/s] 87%|████████▋ | 69/79 [00:01<00:00, 61.37it/s] 96%|█████████▌| 76/79 [00:01<00:00, 61.86it/s]100%|██████████| 79/79 [00:01<00:00, 52.23it/s]
10000 images processed, 1.552342414855957 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:36,  2.10it/s]  5%|▌         | 11/204 [00:00<00:07, 24.37it/s] 10%|█         | 21/204 [00:00<00:04, 42.20it/s] 15%|█▌        | 31/204 [00:00<00:03, 56.21it/s] 20%|██        | 41/204 [00:00<00:02, 66.15it/s] 25%|██▌       | 51/204 [00:01<00:02, 73.53it/s] 29%|██▉       | 60/204 [00:01<00:01, 77.54it/s] 34%|███▍      | 70/204 [00:01<00:01, 81.95it/s] 39%|███▊      | 79/204 [00:01<00:01, 84.09it/s] 43%|████▎     | 88/204 [00:01<00:01, 85.75it/s] 48%|████▊     | 98/204 [00:01<00:01, 87.97it/s] 53%|█████▎    | 108/204 [00:01<00:01, 89.19it/s] 58%|█████▊    | 118/204 [00:01<00:00, 87.92it/s] 63%|██████▎   | 128/204 [00:01<00:00, 88.78it/s] 68%|██████▊   | 138/204 [00:01<00:00, 88.36it/s] 72%|███████▏  | 147/204 [00:02<00:00, 88.47it/s] 77%|███████▋  | 157/204 [00:02<00:00, 88.91it/s] 82%|████████▏ | 167/204 [00:02<00:00, 89.68it/s] 87%|████████▋ | 177/204 [00:02<00:00, 90.57it/s] 92%|█████████▏| 187/204 [00:02<00:00, 92.40it/s] 97%|█████████▋| 197/204 [00:02<00:00, 93.67it/s]100%|██████████| 204/204 [00:02<00:00, 75.66it/s]
26032 images processed, 2.8225784301757812 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:58,  1.32it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.90it/s] 27%|██▋       | 21/79 [00:00<00:01, 31.84it/s] 39%|███▉      | 31/79 [00:01<00:01, 45.32it/s] 52%|█████▏    | 41/79 [00:01<00:00, 56.93it/s] 65%|██████▍   | 51/79 [00:01<00:00, 66.08it/s] 76%|███████▌  | 60/79 [00:01<00:00, 66.43it/s] 87%|████████▋ | 69/79 [00:01<00:00, 49.84it/s]100%|██████████| 79/79 [00:01<00:00, 43.95it/s]
10000 images processed, 1.8246445655822754 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.33it/s] 13%|█▎        | 10/79 [00:00<00:02, 24.20it/s] 25%|██▌       | 20/79 [00:00<00:01, 43.42it/s] 38%|███▊      | 30/79 [00:00<00:00, 57.81it/s] 51%|█████     | 40/79 [00:00<00:00, 68.15it/s] 63%|██████▎   | 50/79 [00:00<00:00, 75.66it/s] 76%|███████▌  | 60/79 [00:01<00:00, 81.82it/s] 89%|████████▊ | 70/79 [00:01<00:00, 86.24it/s]100%|██████████| 79/79 [00:01<00:00, 63.38it/s]
10000 images processed, 1.355799913406372 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:38,  1.81it/s] 14%|█▍        | 10/70 [00:00<00:03, 19.68it/s] 23%|██▎       | 16/70 [00:00<00:01, 27.05it/s] 37%|███▋      | 26/70 [00:00<00:01, 43.13it/s] 51%|█████▏    | 36/70 [00:01<00:00, 55.91it/s] 66%|██████▌   | 46/70 [00:01<00:00, 66.64it/s] 80%|████████  | 56/70 [00:01<00:00, 74.92it/s] 94%|█████████▍| 66/70 [00:01<00:00, 81.15it/s]100%|██████████| 70/70 [00:01<00:00, 51.55it/s]
8925 images processed, 1.3850843906402588 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:47,  1.07s/it] 13%|█▎        | 6/45 [00:01<00:05,  6.69it/s] 20%|██        | 9/45 [00:01<00:04,  8.51it/s] 36%|███▌      | 16/45 [00:01<00:01, 17.39it/s] 44%|████▍     | 20/45 [00:01<00:01, 14.28it/s] 51%|█████     | 23/45 [00:02<00:01, 14.96it/s] 67%|██████▋   | 30/45 [00:02<00:00, 21.59it/s] 76%|███████▌  | 34/45 [00:02<00:00, 16.09it/s] 98%|█████████▊| 44/45 [00:02<00:00, 27.38it/s]100%|██████████| 45/45 [00:02<00:00, 16.31it/s]
5640 images processed, 2.778705358505249 seconds used

19.787196159362793
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.60
places365     49.92  89.49  51.36
LSUN          25.93  95.19  76.04
iSUN          26.01  95.03  73.73
dtd           24.68  94.43  71.73
AVG           26.02  94.64  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
4.0944178104400635
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=35, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/35 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  3%|▎         | 1/35 [00:17<10:09, 17.93s/it]  6%|▌         | 2/35 [00:29<07:40, 13.96s/it]  9%|▊         | 3/35 [00:41<07:01, 13.17s/it] 11%|█▏        | 4/35 [00:51<06:13, 12.04s/it] 14%|█▍        | 5/35 [01:02<05:51, 11.73s/it] 17%|█▋        | 6/35 [01:12<05:21, 11.10s/it][loss] ep 0 it 0 total=12.0909 mle=2.3146 pcon=8.7277 forget=0.0000 orth=1.0486 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0667 mle=2.2863 pcon=8.7318 forget=0.0000 orth=1.0485 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2136 mle=2.4300 pcon=8.7353 forget=0.0000 orth=1.0484 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1215 mle=2.3345 pcon=8.7388 forget=0.0000 orth=1.0482 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7748 mle=1.9851 pcon=8.7417 forget=0.0000 orth=1.0480 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=11.9871 mle=2.1950 pcon=8.7444 forget=0.0000 orth=1.0477 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4179 mle=2.6239 pcon=8.7466 forget=0.0000 orth=1.0474 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9926 mle=2.1972 pcon=8.7483 forget=0.0000 orth=1.0471 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9501 mle=2.1529 pcon=8.7504 forget=0.0000 orth=1.0467 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9380 mle=2.1393 pcon=8.7524 forget=0.0000 orth=1.0463 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0896 mle=2.2897 pcon=8.7540 forget=0.0000 orth=1.0459 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3274 mle=2.5262 pcon=8.7557 forget=0.0000 orth=1.0454 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2573 mle=2.4555 pcon=8.7567 forget=0.0000 orth=1.0450 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.8903 mle=2.0879 pcon=8.7580 forget=0.0000 orth=1.0445 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.1922 mle=2.3891 pcon=8.7591 forget=0.0000 orth=1.0439 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0805 mle=2.2770 pcon=8.7603 forget=0.0000 orth=1.0433 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0149 mle=2.2114 pcon=8.7610 forget=0.0000 orth=1.0425 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0753 mle=2.2715 pcon=8.7621 forget=0.0000 orth=1.0418 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9126 mle=2.1078 pcon=8.7637 forget=0.0000 orth=1.0411 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9621 mle=2.1571 pcon=8.7647 forget=0.0000 orth=1.0403 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5838 mle=1.7782 pcon=8.7659 forget=0.0000 orth=1.0396 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1267 mle=2.3214 pcon=8.7665 forget=0.0000 orth=1.0388 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1815 mle=2.3762 pcon=8.7674 forget=0.0000 orth=1.0379 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6932 mle=1.8874 pcon=8.7687 forget=0.0000 orth=1.0370 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0742 mle=2.2690 pcon=8.7692 forget=0.0000 orth=1.0360 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1937 mle=2.3885 pcon=8.7703 forget=0.0000 orth=1.0349 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1311 mle=2.3261 pcon=8.7711 forget=0.0000 orth=1.0339 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0206 mle=2.2155 pcon=8.7722 forget=0.0000 orth=1.0329 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9360 mle=2.1307 pcon=8.7734 forget=0.0000 orth=1.0318 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9651 mle=2.1600 pcon=8.7745 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9501 mle=2.1455 pcon=8.7753 forget=0.0000 orth=1.0293 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.0057 mle=2.2016 pcon=8.7760 forget=0.0000 orth=1.0281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0140 mle=2.2097 pcon=8.7775 forget=0.0000 orth=1.0268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0258 mle=2.2213 pcon=8.7786 forget=0.0000 orth=1.0259 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1450 mle=2.3408 pcon=8.7796 forget=0.0000 orth=1.0247 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8307 mle=2.0270 pcon=8.7803 forget=0.0000 orth=1.0234 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8797 mle=2.0766 pcon=8.7812 forget=0.0000 orth=1.0219 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8366 mle=2.0334 pcon=8.7825 forget=0.0000 orth=1.0206 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1786 mle=2.3753 pcon=8.7836 forget=0.0000 orth=1.0196 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.8034 mle=2.0001 pcon=8.7849 forget=0.0000 orth=1.0184 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 5 it 45 total=11.9766 mle=2.1739 pcon=8.7856 forget=0.0000 orth=1.0170 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=11.8750 mle=2.0728 pcon=8.7868 forget=0.0000 orth=1.0154 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=11.9059 mle=2.1042 pcon=8.7875 forget=0.0000 orth=1.0142 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=11.9913 mle=2.1897 pcon=8.7889 forget=0.0000 orth=1.0127 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.0463 mle=2.2447 pcon=8.7902 forget=0.0000 orth=1.0114 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=11.7279 mle=1.9259 pcon=8.7920 forget=0.0000 orth=1.0100 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.1237 mle=2.3214 pcon=8.7937 forget=0.0000 orth=1.0086 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 6 it 4 total=11.9785 mle=2.1768 pcon=8.7944 forget=0.0000 orth=1.0074 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.0672 mle=2.2649 pcon=8.7962 forget=0.0000 orth=1.0061 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.8458 mle=2.0433 pcon=8.7980 forget=0.0000 orth=1.0046 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.6711 mle=1.8692 pcon=8.7987 forget=0.0000 orth=1.0032 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
 20%|██        | 7/35 [01:24<05:13, 11.21s/it] 23%|██▎       | 8/35 [01:36<05:15, 11.67s/it] 26%|██▌       | 9/35 [01:48<05:03, 11.66s/it] 29%|██▊       | 10/35 [01:59<04:49, 11.59s/it] 31%|███▏      | 11/35 [02:10<04:34, 11.44s/it] 34%|███▍      | 12/35 [02:22<04:23, 11.45s/it][loss] ep 6 it 204 total=11.8448 mle=2.0433 pcon=8.7999 forget=0.0000 orth=1.0016 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.8534 mle=2.0523 pcon=8.8009 forget=0.0000 orth=1.0003 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2115 mle=2.4099 pcon=8.8026 forget=0.0000 orth=0.9991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.7711 mle=1.9693 pcon=8.8041 forget=0.0000 orth=0.9977 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 7 it 13 total=12.1377 mle=2.3354 pcon=8.8057 forget=0.0000 orth=0.9965 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2208 mle=2.4183 pcon=8.8073 forget=0.0000 orth=0.9952 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0891 mle=2.2865 pcon=8.8088 forget=0.0000 orth=0.9937 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1134 mle=2.3103 pcon=8.8107 forget=0.0000 orth=0.9924 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9122 mle=2.1096 pcon=8.8114 forget=0.0000 orth=0.9911 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9889 mle=2.1854 pcon=8.8137 forget=0.0000 orth=0.9898 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8657 mle=2.0618 pcon=8.8154 forget=0.0000 orth=0.9885 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0134 mle=2.2091 pcon=8.8172 forget=0.0000 orth=0.9870 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 8 it 22 total=11.9795 mle=2.1752 pcon=8.8183 forget=0.0000 orth=0.9860 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8128 mle=2.0085 pcon=8.8198 forget=0.0000 orth=0.9845 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7031 mle=1.8990 pcon=8.8209 forget=0.0000 orth=0.9831 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5989 mle=1.7947 pcon=8.8225 forget=0.0000 orth=0.9818 favg=0.0000 nr=124 nf=1 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6303 mle=1.8259 pcon=8.8241 forget=0.0000 orth=0.9803 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.7919 mle=1.9879 pcon=8.8249 forget=0.0000 orth=0.9791 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8222 mle=2.0181 pcon=8.8265 forget=0.0000 orth=0.9777 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0347 mle=2.2299 pcon=8.8285 forget=0.0000 orth=0.9763 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 9 it 31 total=12.1877 mle=2.3829 pcon=8.8300 forget=0.0000 orth=0.9748 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9304 mle=2.1259 pcon=8.8309 forget=0.0000 orth=0.9736 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7378 mle=1.9341 pcon=8.8317 forget=0.0000 orth=0.9719 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8459 mle=2.0425 pcon=8.8326 forget=0.0000 orth=0.9709 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7760 mle=1.9716 pcon=8.8353 forget=0.0000 orth=0.9691 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8323 mle=2.0281 pcon=8.8369 forget=0.0000 orth=0.9674 favg=0.0000 nr=122 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9325 mle=2.1281 pcon=8.8389 forget=0.0000 orth=0.9656 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7590 mle=1.9545 pcon=8.8403 forget=0.0000 orth=0.9642 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 10 it 40 total=11.6746 mle=1.8700 pcon=8.8420 forget=0.0000 orth=0.9627 favg=0.0000 nr=123 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.1514 mle=2.3475 pcon=8.8429 forget=0.0000 orth=0.9611 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.8338 mle=2.0296 pcon=8.8449 forget=0.0000 orth=0.9593 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.8000 mle=1.9961 pcon=8.8466 forget=0.0000 orth=0.9574 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6464 mle=1.8435 pcon=8.8471 forget=0.0000 orth=0.9559 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0891 mle=2.2862 pcon=8.8492 forget=0.0000 orth=0.9537 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.7919 mle=1.9901 pcon=8.8501 forget=0.0000 orth=0.9517 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.0291 mle=2.2285 pcon=8.8510 forget=0.0000 orth=0.9495 favg=0.0000 nr=74 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 11 it 49 total=11.7757 mle=1.9755 pcon=8.8528 forget=0.0000 orth=0.9474 favg=0.0000 nr=117 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.0826 mle=2.2832 pcon=8.8540 forget=0.0000 orth=0.9454 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.9659 mle=2.1682 pcon=8.8548 forget=0.0000 orth=0.9430 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.8132 mle=2.0167 pcon=8.8559 forget=0.0000 orth=0.9407 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.6014 mle=1.8060 pcon=8.8572 forget=0.0000 orth=0.9382 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.9102 mle=2.1166 pcon=8.8580 forget=0.0000 orth=0.9355 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.6428 mle=1.8507 pcon=8.8592 forget=0.0000 orth=0.9328 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 12 it 8 total=11.9886 mle=2.1976 pcon=8.8608 forget=0.0000 orth=0.9302 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.7795 mle=1.9911 pcon=8.8615 forget=0.0000 orth=0.9269 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.9807 mle=2.1945 pcon=8.8624 forget=0.0000 orth=0.9238 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.7486 mle=1.9648 pcon=8.8633 forget=0.0000 orth=0.9205 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.7781 mle=1.9968 pcon=8.8644 forget=0.0000 orth=0.9169 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.0683 mle=2.2889 pcon=8.8661 forget=0.0000 orth=0.9133 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8771 mle=2.1015 pcon=8.8663 forget=0.0000 orth=0.9094 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9361 mle=2.1629 pcon=8.8676 forget=0.0000 orth=0.9055 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
 37%|███▋      | 13/35 [02:32<04:04, 11.10s/it] 40%|████      | 14/35 [02:44<03:56, 11.25s/it] 43%|████▎     | 15/35 [02:55<03:46, 11.34s/it] 46%|████▌     | 16/35 [03:06<03:30, 11.06s/it] 49%|████▊     | 17/35 [03:17<03:18, 11.00s/it] 51%|█████▏    | 18/35 [03:27<03:05, 10.91s/it] 54%|█████▍    | 19/35 [03:39<02:58, 11.18s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 13 it 17 total=11.9968 mle=2.2264 pcon=8.8692 forget=0.0000 orth=0.9012 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.7773 mle=2.0104 pcon=8.8700 forget=0.0000 orth=0.8969 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.0301 mle=2.2669 pcon=8.8708 forget=0.0000 orth=0.8924 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.8693 mle=2.1112 pcon=8.8703 forget=0.0000 orth=0.8878 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.0437 mle=2.2902 pcon=8.8707 forget=0.0000 orth=0.8828 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.9477 mle=2.1993 pcon=8.8707 forget=0.0000 orth=0.8777 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.8347 mle=2.0908 pcon=8.8715 forget=0.0000 orth=0.8724 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.8531 mle=2.1148 pcon=8.8714 forget=0.0000 orth=0.8669 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 14 it 26 total=12.0215 mle=2.2888 pcon=8.8716 forget=0.0000 orth=0.8611 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.7315 mle=2.0047 pcon=8.8714 forget=0.0000 orth=0.8554 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.7812 mle=2.0601 pcon=8.8718 forget=0.0000 orth=0.8493 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.9265 mle=2.2141 pcon=8.8692 forget=0.0000 orth=0.8431 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.6315 mle=1.9259 pcon=8.8689 forget=0.0000 orth=0.8368 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.8480 mle=2.1493 pcon=8.8684 forget=0.0000 orth=0.8304 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.7757 mle=2.0841 pcon=8.8680 forget=0.0000 orth=0.8236 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.5868 mle=1.9031 pcon=8.8669 forget=0.0000 orth=0.8168 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 15 it 35 total=11.7646 mle=2.0888 pcon=8.8661 forget=0.0000 orth=0.8097 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.7487 mle=2.0809 pcon=8.8652 forget=0.0000 orth=0.8026 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.6194 mle=1.9597 pcon=8.8642 forget=0.0000 orth=0.7955 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.6173 mle=1.9664 pcon=8.8629 forget=0.0000 orth=0.7881 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.8262 mle=2.1845 pcon=8.8612 forget=0.0000 orth=0.7806 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.6665 mle=2.0330 pcon=8.8605 forget=0.0000 orth=0.7730 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.8220 mle=2.1985 pcon=8.8581 forget=0.0000 orth=0.7653 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.6095 mle=1.9952 pcon=8.8570 forget=0.0000 orth=0.7574 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 16 it 44 total=11.7271 mle=2.1228 pcon=8.8549 forget=0.0000 orth=0.7495 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.7613 mle=2.1660 pcon=8.8539 forget=0.0000 orth=0.7414 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.5766 mle=1.9912 pcon=8.8519 forget=0.0000 orth=0.7334 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.5925 mle=2.0174 pcon=8.8498 forget=0.0000 orth=0.7252 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.5089 mle=1.9440 pcon=8.8480 forget=0.0000 orth=0.7169 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.4172 mle=1.8631 pcon=8.8455 forget=0.0000 orth=0.7086 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.5714 mle=2.0276 pcon=8.8437 forget=0.0000 orth=0.7001 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 17 it 3 total=11.3167 mle=1.7829 pcon=8.8422 forget=0.0000 orth=0.6916 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.3425 mle=1.8195 pcon=8.8400 forget=0.0000 orth=0.6831 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.5061 mle=1.9931 pcon=8.8386 forget=0.0000 orth=0.6744 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.3586 mle=1.8551 pcon=8.8377 forget=0.0000 orth=0.6657 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.4090 mle=1.9164 pcon=8.8355 forget=0.0000 orth=0.6572 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.4982 mle=2.0159 pcon=8.8339 forget=0.0000 orth=0.6484 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.3870 mle=1.9161 pcon=8.8312 forget=0.0000 orth=0.6397 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.4535 mle=1.9951 pcon=8.8276 forget=0.0000 orth=0.6308 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 18 it 12 total=11.3830 mle=1.9357 pcon=8.8253 forget=0.0000 orth=0.6220 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.6723 mle=2.2372 pcon=8.8220 forget=0.0000 orth=0.6131 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.3381 mle=1.9138 pcon=8.8201 forget=0.0000 orth=0.6043 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.5348 mle=2.1228 pcon=8.8165 forget=0.0000 orth=0.5955 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.5110 mle=2.1103 pcon=8.8139 forget=0.0000 orth=0.5867 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.3549 mle=1.9663 pcon=8.8108 forget=0.0000 orth=0.5779 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.3107 mle=1.9339 pcon=8.8076 forget=0.0000 orth=0.5693 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.2155 mle=1.8503 pcon=8.8047 forget=0.0000 orth=0.5605 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 19 it 21 total=11.2928 mle=1.9379 pcon=8.8030 forget=0.0000 orth=0.5519 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.3758 mle=2.0328 pcon=8.7999 forget=0.0000 orth=0.5431 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
 57%|█████▋    | 20/35 [03:51<02:48, 11.26s/it] 60%|██████    | 21/35 [04:02<02:37, 11.25s/it] 63%|██████▎   | 22/35 [04:13<02:27, 11.31s/it] 66%|██████▌   | 23/35 [04:24<02:14, 11.22s/it] 69%|██████▊   | 24/35 [04:36<02:06, 11.51s/it] 71%|███████▏  | 25/35 [04:48<01:54, 11.42s/it][loss] ep 19 it 121 total=11.2560 mle=1.9238 pcon=8.7977 forget=0.0000 orth=0.5345 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.3325 mle=2.0107 pcon=8.7958 forget=0.0000 orth=0.5260 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.3143 mle=2.0029 pcon=8.7939 forget=0.0000 orth=0.5175 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.3943 mle=2.0944 pcon=8.7907 forget=0.0000 orth=0.5091 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.3549 mle=2.0658 pcon=8.7883 forget=0.0000 orth=0.5008 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.3310 mle=2.0530 pcon=8.7855 forget=0.0000 orth=0.4925 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 20 it 30 total=11.3941 mle=2.1266 pcon=8.7831 forget=0.0000 orth=0.4844 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.1879 mle=1.9317 pcon=8.7798 forget=0.0000 orth=0.4763 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.3090 mle=2.0636 pcon=8.7770 forget=0.0000 orth=0.4684 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.3338 mle=2.0985 pcon=8.7747 forget=0.0000 orth=0.4605 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.0281 mle=1.8043 pcon=8.7712 forget=0.0000 orth=0.4526 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.2337 mle=2.0209 pcon=8.7678 forget=0.0000 orth=0.4450 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.4662 mle=2.2640 pcon=8.7648 forget=0.0000 orth=0.4374 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.3181 mle=2.1251 pcon=8.7631 forget=0.0000 orth=0.4300 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 21 it 39 total=11.2271 mle=2.0455 pcon=8.7589 forget=0.0000 orth=0.4227 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.0138 mle=1.8423 pcon=8.7561 forget=0.0000 orth=0.4154 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.1852 mle=2.0237 pcon=8.7532 forget=0.0000 orth=0.4083 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.0097 mle=1.8583 pcon=8.7501 forget=0.0000 orth=0.4013 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.2931 mle=2.1516 pcon=8.7471 forget=0.0000 orth=0.3945 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.0214 mle=1.8894 pcon=8.7443 forget=0.0000 orth=0.3877 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.0621 mle=1.9395 pcon=8.7415 forget=0.0000 orth=0.3811 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.2157 mle=2.1027 pcon=8.7382 forget=0.0000 orth=0.3747 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 22 it 48 total=11.2094 mle=2.1055 pcon=8.7354 forget=0.0000 orth=0.3684 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.0610 mle=1.9663 pcon=8.7325 forget=0.0000 orth=0.3622 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.0825 mle=1.9961 pcon=8.7303 forget=0.0000 orth=0.3561 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=10.9804 mle=1.9017 pcon=8.7286 forget=0.0000 orth=0.3501 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.1241 mle=2.0536 pcon=8.7264 forget=0.0000 orth=0.3442 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.0904 mle=2.0284 pcon=8.7235 forget=0.0000 orth=0.3384 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.2422 mle=2.1889 pcon=8.7205 forget=0.0000 orth=0.3328 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 23 it 7 total=11.0678 mle=2.0242 pcon=8.7164 forget=0.0000 orth=0.3273 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.0791 mle=2.0438 pcon=8.7133 forget=0.0000 orth=0.3220 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.7872 mle=1.7606 pcon=8.7097 forget=0.0000 orth=0.3168 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.3099 mle=2.2912 pcon=8.7070 forget=0.0000 orth=0.3117 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.0756 mle=2.0647 pcon=8.7042 forget=0.0000 orth=0.3067 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.0346 mle=2.0314 pcon=8.7013 forget=0.0000 orth=0.3018 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.0640 mle=2.0692 pcon=8.6977 forget=0.0000 orth=0.2972 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=10.9222 mle=1.9350 pcon=8.6946 forget=0.0000 orth=0.2926 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 24 it 16 total=11.0834 mle=2.1036 pcon=8.6916 forget=0.0000 orth=0.2881 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=10.9005 mle=1.9273 pcon=8.6894 forget=0.0000 orth=0.2838 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.1315 mle=2.1658 pcon=8.6862 forget=0.0000 orth=0.2796 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.0718 mle=2.1137 pcon=8.6827 forget=0.0000 orth=0.2754 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=10.8483 mle=1.8976 pcon=8.6792 forget=0.0000 orth=0.2714 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=10.9094 mle=1.9648 pcon=8.6770 forget=0.0000 orth=0.2676 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=10.9154 mle=1.9774 pcon=8.6743 forget=0.0000 orth=0.2638 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.2158 mle=2.2843 pcon=8.6714 forget=0.0000 orth=0.2601 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 25 it 25 total=10.7966 mle=1.8720 pcon=8.6681 forget=0.0000 orth=0.2565 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=10.8813 mle=1.9629 pcon=8.6654 forget=0.0000 orth=0.2530 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.1861 mle=2.2748 pcon=8.6617 forget=0.0000 orth=0.2496 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=10.9352 mle=2.0305 pcon=8.6583 forget=0.0000 orth=0.2464 favg=0.0000 nr=112 nf=10 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=10.6959 mle=1.7967 pcon=8.6559 forget=0.0000 orth=0.2432 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=10.9939 mle=2.1007 pcon=8.6530 forget=0.0000 orth=0.2401 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
 74%|███████▍  | 26/35 [04:59<01:41, 11.33s/it] 77%|███████▋  | 27/35 [05:10<01:30, 11.27s/it] 80%|████████  | 28/35 [05:22<01:19, 11.37s/it] 83%|████████▎ | 29/35 [05:32<01:07, 11.21s/it] 86%|████████▌ | 30/35 [05:43<00:55, 11.15s/it] 89%|████████▊ | 31/35 [05:54<00:44, 11.12s/it] 91%|█████████▏| 32/35 [06:06<00:33, 11.32s/it][loss] ep 25 it 325 total=10.7783 mle=1.8905 pcon=8.6506 forget=0.0000 orth=0.2371 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=10.9755 mle=2.0945 pcon=8.6467 forget=0.0000 orth=0.2342 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 26 it 34 total=10.7189 mle=1.8440 pcon=8.6435 forget=0.0000 orth=0.2314 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=10.9629 mle=2.0937 pcon=8.6405 forget=0.0000 orth=0.2287 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=10.8714 mle=2.0069 pcon=8.6384 forget=0.0000 orth=0.2261 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=10.9204 mle=2.0618 pcon=8.6350 forget=0.0000 orth=0.2236 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=10.7650 mle=1.9116 pcon=8.6323 forget=0.0000 orth=0.2211 favg=0.0000 nr=124 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=10.9881 mle=2.1399 pcon=8.6295 forget=0.0000 orth=0.2187 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=10.8907 mle=2.0475 pcon=8.6267 forget=0.0000 orth=0.2165 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=10.7268 mle=1.8881 pcon=8.6245 forget=0.0000 orth=0.2143 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 27 it 43 total=10.9683 mle=2.1345 pcon=8.6216 forget=0.0000 orth=0.2122 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=10.8594 mle=2.0301 pcon=8.6192 forget=0.0000 orth=0.2101 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=10.9566 mle=2.1311 pcon=8.6174 forget=0.0000 orth=0.2081 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=10.8453 mle=2.0245 pcon=8.6146 forget=0.0000 orth=0.2062 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=10.7889 mle=1.9728 pcon=8.6118 forget=0.0000 orth=0.2044 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=10.7828 mle=1.9718 pcon=8.6083 forget=0.0000 orth=0.2026 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.6027 mle=1.7964 pcon=8.6054 forget=0.0000 orth=0.2009 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 28 it 2 total=10.6591 mle=1.8572 pcon=8.6027 forget=0.0000 orth=0.1993 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=10.9478 mle=2.1504 pcon=8.5997 forget=0.0000 orth=0.1977 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=10.7774 mle=1.9844 pcon=8.5968 forget=0.0000 orth=0.1962 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.0090 mle=2.2194 pcon=8.5949 forget=0.0000 orth=0.1947 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=10.8626 mle=2.0772 pcon=8.5921 forget=0.0000 orth=0.1933 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=10.8409 mle=2.0592 pcon=8.5897 forget=0.0000 orth=0.1920 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.5388 mle=1.7607 pcon=8.5873 forget=0.0000 orth=0.1907 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=10.7171 mle=1.9434 pcon=8.5842 forget=0.0000 orth=0.1895 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 29 it 11 total=10.6264 mle=1.8575 pcon=8.5806 forget=0.0000 orth=0.1883 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=10.8456 mle=2.0789 pcon=8.5795 forget=0.0000 orth=0.1872 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=10.9958 mle=2.2321 pcon=8.5777 forget=0.0000 orth=0.1861 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.7046 mle=1.9437 pcon=8.5758 forget=0.0000 orth=0.1851 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=10.9360 mle=2.1790 pcon=8.5729 forget=0.0000 orth=0.1841 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=10.8242 mle=2.0693 pcon=8.5717 forget=0.0000 orth=0.1832 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=10.6923 mle=1.9408 pcon=8.5692 forget=0.0000 orth=0.1823 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.0465 mle=2.2983 pcon=8.5667 forget=0.0000 orth=0.1814 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 30 it 20 total=10.6703 mle=1.9255 pcon=8.5642 forget=0.0000 orth=0.1806 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=10.8560 mle=2.1145 pcon=8.5616 forget=0.0000 orth=0.1799 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.6027 mle=1.8639 pcon=8.5597 forget=0.0000 orth=0.1791 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=11.0583 mle=2.3219 pcon=8.5580 forget=0.0000 orth=0.1785 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=10.7938 mle=2.0602 pcon=8.5558 forget=0.0000 orth=0.1778 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.5611 mle=1.8302 pcon=8.5538 forget=0.0000 orth=0.1772 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=10.7677 mle=2.0393 pcon=8.5518 forget=0.0000 orth=0.1766 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=10.8261 mle=2.1003 pcon=8.5497 forget=0.0000 orth=0.1761 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 31 it 29 total=10.6251 mle=1.9014 pcon=8.5481 forget=0.0000 orth=0.1756 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=10.8483 mle=2.1279 pcon=8.5453 forget=0.0000 orth=0.1751 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=10.6888 mle=1.9704 pcon=8.5437 forget=0.0000 orth=0.1747 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=10.8807 mle=2.1648 pcon=8.5416 forget=0.0000 orth=0.1742 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=10.8038 mle=2.0909 pcon=8.5390 forget=0.0000 orth=0.1739 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.5402 mle=1.8297 pcon=8.5369 forget=0.0000 orth=0.1735 favg=0.0000 nr=118 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=10.8159 mle=2.1074 pcon=8.5353 forget=0.0000 orth=0.1732 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=10.8947 mle=2.1888 pcon=8.5331 forget=0.0000 orth=0.1729 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
 94%|█████████▍| 33/35 [06:17<00:22, 11.26s/it] 97%|█████████▋| 34/35 [06:28<00:11, 11.04s/it]100%|██████████| 35/35 [06:39<00:00, 11.18s/it]100%|██████████| 35/35 [06:39<00:00, 11.43s/it]
[loss] ep 32 it 38 total=10.6958 mle=1.9918 pcon=8.5315 forget=0.0000 orth=0.1726 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.6652 mle=1.9634 pcon=8.5295 forget=0.0000 orth=0.1723 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=10.6791 mle=1.9793 pcon=8.5278 forget=0.0000 orth=0.1721 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=10.8188 mle=2.1208 pcon=8.5261 forget=0.0000 orth=0.1719 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.5019 mle=1.8063 pcon=8.5239 forget=0.0000 orth=0.1717 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=10.6378 mle=1.9434 pcon=8.5229 forget=0.0000 orth=0.1715 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=10.8853 mle=2.1920 pcon=8.5219 forget=0.0000 orth=0.1713 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.4937 mle=1.8026 pcon=8.5199 forget=0.0000 orth=0.1712 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 33 it 47 total=10.8424 mle=2.1537 pcon=8.5176 forget=0.0000 orth=0.1711 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=10.8160 mle=2.1291 pcon=8.5159 forget=0.0000 orth=0.1709 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=10.7770 mle=2.0921 pcon=8.5140 forget=0.0000 orth=0.1708 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.4670 mle=1.7840 pcon=8.5122 forget=0.0000 orth=0.1708 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.5983 mle=1.9174 pcon=8.5102 forget=0.0000 orth=0.1707 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=10.7815 mle=2.1026 pcon=8.5083 forget=0.0000 orth=0.1706 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=10.9103 mle=2.2317 pcon=8.5080 forget=0.0000 orth=0.1706 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 34 it 6 total=10.8932 mle=2.2160 pcon=8.5067 forget=0.0000 orth=0.1705 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.5483 mle=1.8725 pcon=8.5053 forget=0.0000 orth=0.1705 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.5501 mle=1.8753 pcon=8.5043 forget=0.0000 orth=0.1705 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=10.7135 mle=2.0408 pcon=8.5022 forget=0.0000 orth=0.1705 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.5262 mle=1.8543 pcon=8.5015 forget=0.0000 orth=0.1704 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=10.6321 mle=1.9619 pcon=8.4999 forget=0.0000 orth=0.1704 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.6319 mle=1.9629 pcon=8.4986 forget=0.0000 orth=0.1704 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=10.7862 mle=2.1190 pcon=8.4967 forget=0.0000 orth=0.1704 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:23,  1.92it/s]  3%|▎         | 11/391 [00:00<00:16, 22.68it/s]  5%|▌         | 21/391 [00:00<00:09, 40.20it/s]  8%|▊         | 31/391 [00:00<00:06, 54.46it/s] 10%|█         | 41/391 [00:00<00:05, 65.46it/s] 13%|█▎        | 51/391 [00:01<00:04, 73.74it/s] 16%|█▌        | 61/391 [00:01<00:04, 79.79it/s] 18%|█▊        | 71/391 [00:01<00:03, 84.09it/s] 21%|██        | 81/391 [00:01<00:04, 74.38it/s] 23%|██▎       | 90/391 [00:01<00:04, 66.36it/s] 25%|██▌       | 98/391 [00:01<00:04, 69.48it/s] 28%|██▊       | 108/391 [00:01<00:03, 76.12it/s] 30%|███       | 118/391 [00:01<00:03, 81.44it/s] 33%|███▎      | 128/391 [00:02<00:03, 85.13it/s] 35%|███▌      | 138/391 [00:02<00:02, 88.40it/s] 38%|███▊      | 148/391 [00:02<00:02, 90.77it/s] 40%|████      | 158/391 [00:02<00:02, 79.59it/s] 43%|████▎     | 167/391 [00:02<00:02, 82.14it/s] 45%|████▌     | 177/391 [00:02<00:02, 85.26it/s] 48%|████▊     | 187/391 [00:02<00:02, 87.60it/s] 50%|█████     | 197/391 [00:02<00:02, 89.65it/s] 53%|█████▎    | 207/391 [00:02<00:02, 91.48it/s] 55%|█████▌    | 217/391 [00:03<00:01, 91.99it/s] 58%|█████▊    | 227/391 [00:03<00:01, 86.67it/s] 61%|██████    | 237/391 [00:03<00:01, 89.22it/s] 63%|██████▎   | 247/391 [00:03<00:01, 90.87it/s] 66%|██████▌   | 257/391 [00:03<00:01, 78.36it/s] 68%|██████▊   | 267/391 [00:03<00:01, 82.56it/s] 71%|███████   | 277/391 [00:03<00:01, 86.13it/s] 73%|███████▎  | 287/391 [00:03<00:01, 87.84it/s] 76%|███████▌  | 296/391 [00:03<00:01, 85.01it/s] 78%|███████▊  | 305/391 [00:04<00:01, 83.56it/s] 81%|████████  | 315/391 [00:04<00:00, 86.67it/s] 83%|████████▎ | 324/391 [00:04<00:00, 83.98it/s] 85%|████████▌ | 333/391 [00:04<00:00, 80.04it/s] 87%|████████▋ | 342/391 [00:04<00:00, 80.04it/s] 90%|████████▉ | 351/391 [00:04<00:00, 78.13it/s] 92%|█████████▏| 359/391 [00:04<00:00, 72.56it/s] 94%|█████████▍| 367/391 [00:04<00:00, 65.59it/s] 96%|█████████▌| 376/391 [00:05<00:00, 69.07it/s] 98%|█████████▊| 385/391 [00:05<00:00, 73.99it/s]100%|██████████| 391/391 [00:05<00:00, 74.87it/s]
50000 images processed, 5.2850775718688965 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:52,  1.49it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.56it/s] 27%|██▋       | 21/79 [00:00<00:01, 34.25it/s] 39%|███▉      | 31/79 [00:00<00:01, 47.35it/s] 52%|█████▏    | 41/79 [00:01<00:00, 58.07it/s] 65%|██████▍   | 51/79 [00:01<00:00, 67.42it/s] 77%|███████▋  | 61/79 [00:01<00:00, 75.16it/s] 90%|████████▉ | 71/79 [00:01<00:00, 81.05it/s]100%|██████████| 79/79 [00:01<00:00, 49.32it/s]
10000 images processed, 1.6186211109161377 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:40,  2.02it/s]  4%|▍         | 9/204 [00:00<00:10, 19.28it/s]  9%|▉         | 19/204 [00:00<00:04, 38.00it/s] 14%|█▍        | 29/204 [00:00<00:03, 52.49it/s] 19%|█▉        | 39/204 [00:00<00:02, 63.17it/s] 24%|██▍       | 49/204 [00:01<00:02, 71.43it/s] 29%|██▉       | 59/204 [00:01<00:01, 77.25it/s] 33%|███▎      | 68/204 [00:01<00:01, 77.68it/s] 38%|███▊      | 78/204 [00:01<00:01, 82.10it/s] 43%|████▎     | 88/204 [00:01<00:01, 85.17it/s] 48%|████▊     | 98/204 [00:01<00:01, 87.48it/s] 53%|█████▎    | 108/204 [00:01<00:01, 82.32it/s] 58%|█████▊    | 118/204 [00:01<00:01, 85.08it/s] 63%|██████▎   | 128/204 [00:01<00:00, 87.83it/s] 68%|██████▊   | 138/204 [00:02<00:00, 88.51it/s] 72%|███████▏  | 147/204 [00:02<00:00, 86.85it/s] 77%|███████▋  | 157/204 [00:02<00:00, 88.76it/s] 82%|████████▏ | 167/204 [00:02<00:00, 90.13it/s] 87%|████████▋ | 177/204 [00:02<00:00, 91.51it/s] 92%|█████████▏| 187/204 [00:02<00:00, 93.07it/s] 97%|█████████▋| 197/204 [00:02<00:00, 94.08it/s]100%|██████████| 204/204 [00:02<00:00, 74.06it/s]
26032 images processed, 2.8036108016967773 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:56,  1.37it/s] 11%|█▏        | 9/79 [00:00<00:04, 14.19it/s] 20%|██        | 16/79 [00:00<00:02, 24.41it/s] 33%|███▎      | 26/79 [00:01<00:01, 39.80it/s] 46%|████▌     | 36/79 [00:01<00:00, 52.70it/s] 58%|█████▊    | 46/79 [00:01<00:00, 63.25it/s] 71%|███████   | 56/79 [00:01<00:00, 71.76it/s] 84%|████████▎ | 66/79 [00:01<00:00, 78.21it/s] 96%|█████████▌| 76/79 [00:01<00:00, 83.35it/s]100%|██████████| 79/79 [00:01<00:00, 49.50it/s]
10000 images processed, 1.6178176403045654 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:52,  1.49it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.53it/s] 27%|██▋       | 21/79 [00:00<00:01, 34.10it/s] 37%|███▋      | 29/79 [00:01<00:01, 42.59it/s] 49%|████▉     | 39/79 [00:01<00:00, 55.23it/s] 62%|██████▏   | 49/79 [00:01<00:00, 64.95it/s] 75%|███████▍  | 59/79 [00:01<00:00, 73.29it/s] 86%|████████▌ | 68/79 [00:01<00:00, 76.87it/s] 99%|█████████▊| 78/79 [00:01<00:00, 82.45it/s]100%|██████████| 79/79 [00:01<00:00, 51.55it/s]
10000 images processed, 1.5529897212982178 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:45,  1.53it/s] 14%|█▍        | 10/70 [00:00<00:03, 17.16it/s] 29%|██▊       | 20/70 [00:00<00:01, 33.47it/s] 43%|████▎     | 30/70 [00:00<00:00, 47.70it/s] 57%|█████▋    | 40/70 [00:01<00:00, 59.57it/s] 71%|███████▏  | 50/70 [00:01<00:00, 69.22it/s] 86%|████████▌ | 60/70 [00:01<00:00, 76.72it/s]100%|██████████| 70/70 [00:01<00:00, 81.47it/s]100%|██████████| 70/70 [00:01<00:00, 50.37it/s]
8925 images processed, 1.422337532043457 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:57,  1.31s/it]  4%|▍         | 2/45 [00:01<00:26,  1.61it/s] 18%|█▊        | 8/45 [00:01<00:04,  8.44it/s] 31%|███       | 14/45 [00:01<00:02, 13.50it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.01it/s] 44%|████▍     | 20/45 [00:02<00:01, 17.45it/s] 51%|█████     | 23/45 [00:02<00:01, 17.18it/s] 64%|██████▍   | 29/45 [00:02<00:00, 25.26it/s] 73%|███████▎  | 33/45 [00:02<00:00, 18.55it/s] 80%|████████  | 36/45 [00:03<00:00, 14.11it/s]100%|██████████| 45/45 [00:03<00:00, 23.37it/s]100%|██████████| 45/45 [00:03<00:00, 14.17it/s]
5640 images processed, 3.2558445930480957 seconds used

19.33373785018921
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.60  99.04  86.92
places365     59.32  87.02  55.35
LSUN          28.26  95.26  80.82
iSUN          43.69  92.36  73.04
dtd           24.36  95.40  83.46
AVG           32.24  93.82  75.92
[incremental] Overall: 0.7410 New: 0.7040 Old: 0.7780
[incremental] Final(Top-1): 0.7410  Average: 0.7945
4.885479688644409
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=35, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/35 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  3%|▎         | 1/35 [00:16<09:19, 16.46s/it]  6%|▌         | 2/35 [00:26<07:04, 12.85s/it]  9%|▊         | 3/35 [00:36<06:09, 11.55s/it] 11%|█▏        | 4/35 [00:46<05:33, 10.77s/it] 14%|█▍        | 5/35 [00:56<05:12, 10.40s/it] 17%|█▋        | 6/35 [01:05<04:55, 10.19s/it][loss] ep 0 it 0 total=14.9510 mle=2.4751 pcon=9.4392 forget=0.0000 orth=3.0367 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=14.8877 mle=2.4110 pcon=9.4416 forget=0.0000 orth=3.0351 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=14.9564 mle=2.4806 pcon=9.4439 forget=0.0000 orth=3.0318 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=14.7792 mle=2.3077 pcon=9.4450 forget=0.0000 orth=3.0264 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=14.5067 mle=2.0419 pcon=9.4460 forget=0.0000 orth=3.0188 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=14.6620 mle=2.2071 pcon=9.4460 forget=0.0000 orth=3.0089 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=14.9993 mle=2.5561 pcon=9.4464 forget=0.0000 orth=2.9967 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=14.6480 mle=2.2199 pcon=9.4459 forget=0.0000 orth=2.9822 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=14.6194 mle=2.2087 pcon=9.4454 forget=0.0000 orth=2.9654 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=14.5528 mle=2.1627 pcon=9.4440 forget=0.0000 orth=2.9461 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=14.6483 mle=2.2814 pcon=9.4428 forget=0.0000 orth=2.9241 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=14.7566 mle=2.4166 pcon=9.4405 forget=0.0000 orth=2.8995 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=14.6913 mle=2.3814 pcon=9.4378 forget=0.0000 orth=2.8721 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=14.3186 mle=2.0417 pcon=9.4349 forget=0.0000 orth=2.8420 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=14.5437 mle=2.3024 pcon=9.4325 forget=0.0000 orth=2.8089 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=14.4896 mle=2.2871 pcon=9.4300 forget=0.0000 orth=2.7725 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=14.2824 mle=2.1217 pcon=9.4276 forget=0.0000 orth=2.7332 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=14.3490 mle=2.2336 pcon=9.4249 forget=0.0000 orth=2.6905 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=14.0536 mle=1.9872 pcon=9.4220 forget=0.0000 orth=2.6445 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=14.1730 mle=2.1588 pcon=9.4194 forget=0.0000 orth=2.5948 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.7748 mle=1.8164 pcon=9.4167 forget=0.0000 orth=2.5416 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=14.1453 mle=2.2469 pcon=9.4133 forget=0.0000 orth=2.4851 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=14.1152 mle=2.2799 pcon=9.4106 forget=0.0000 orth=2.4248 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.5894 mle=1.8206 pcon=9.4080 forget=0.0000 orth=2.3609 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=13.8602 mle=2.1615 pcon=9.4049 forget=0.0000 orth=2.2938 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.8937 mle=2.2679 pcon=9.4022 forget=0.0000 orth=2.2237 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.7315 mle=2.1819 pcon=9.3990 forget=0.0000 orth=2.1506 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.5557 mle=2.0847 pcon=9.3959 forget=0.0000 orth=2.0750 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.3962 mle=2.0068 pcon=9.3921 forget=0.0000 orth=1.9974 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.3744 mle=2.0666 pcon=9.3892 forget=0.0000 orth=1.9185 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.2680 mle=2.0439 pcon=9.3854 forget=0.0000 orth=1.8388 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.2284 mle=2.0869 pcon=9.3830 forget=0.0000 orth=1.7585 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=13.1961 mle=2.1377 pcon=9.3798 forget=0.0000 orth=1.6785 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.1003 mle=2.1247 pcon=9.3763 forget=0.0000 orth=1.5993 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.0246 mle=2.1301 pcon=9.3730 forget=0.0000 orth=1.5215 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.7583 mle=1.9424 pcon=9.3699 forget=0.0000 orth=1.4459 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.6902 mle=1.9507 pcon=9.3668 forget=0.0000 orth=1.3727 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.6280 mle=1.9611 pcon=9.3642 forget=0.0000 orth=1.3027 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.8617 mle=2.2644 pcon=9.3614 forget=0.0000 orth=1.2358 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.4876 mle=1.9560 pcon=9.3586 forget=0.0000 orth=1.1730 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 5 it 45 total=12.5541 mle=2.0855 pcon=9.3555 forget=0.0000 orth=1.1131 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.4410 mle=2.0311 pcon=9.3530 forget=0.0000 orth=1.0570 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.3571 mle=2.0025 pcon=9.3499 forget=0.0000 orth=1.0047 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.3725 mle=2.0682 pcon=9.3477 forget=0.0000 orth=0.9565 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.3659 mle=2.1089 pcon=9.3454 forget=0.0000 orth=0.9116 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.0882 mle=1.8755 pcon=9.3427 forget=0.0000 orth=0.8700 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.3792 mle=2.2074 pcon=9.3404 forget=0.0000 orth=0.8314 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 6 it 4 total=12.2222 mle=2.0883 pcon=9.3380 forget=0.0000 orth=0.7959 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.2472 mle=2.1481 pcon=9.3356 forget=0.0000 orth=0.7635 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.9952 mle=1.9283 pcon=9.3333 forget=0.0000 orth=0.7336 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.8339 mle=1.7980 pcon=9.3301 forget=0.0000 orth=0.7058 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
 20%|██        | 7/35 [01:15<04:42, 10.08s/it] 23%|██▎       | 8/35 [01:25<04:30, 10.01s/it] 26%|██▌       | 9/35 [01:35<04:19,  9.98s/it] 29%|██▊       | 10/35 [01:45<04:09,  9.97s/it] 31%|███▏      | 11/35 [01:55<04:00, 10.00s/it] 34%|███▍      | 12/35 [02:05<03:48,  9.95s/it][loss] ep 6 it 204 total=12.0220 mle=2.0145 pcon=9.3272 forget=0.0000 orth=0.6804 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=12.0315 mle=2.0503 pcon=9.3244 forget=0.0000 orth=0.6569 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2625 mle=2.3052 pcon=9.3217 forget=0.0000 orth=0.6356 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.8841 mle=1.9485 pcon=9.3196 forget=0.0000 orth=0.6160 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 7 it 13 total=12.1425 mle=2.2280 pcon=9.3168 forget=0.0000 orth=0.5977 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2390 mle=2.3439 pcon=9.3141 forget=0.0000 orth=0.5810 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0851 mle=2.2084 pcon=9.3116 forget=0.0000 orth=0.5651 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1112 mle=2.2513 pcon=9.3093 forget=0.0000 orth=0.5506 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.8457 mle=2.0014 pcon=9.3070 forget=0.0000 orth=0.5372 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.0246 mle=2.1957 pcon=9.3043 forget=0.0000 orth=0.5246 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8203 mle=2.0050 pcon=9.3023 forget=0.0000 orth=0.5130 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=11.9626 mle=2.1603 pcon=9.3001 forget=0.0000 orth=0.5023 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 8 it 22 total=11.8757 mle=2.0866 pcon=9.2972 forget=0.0000 orth=0.4918 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.7166 mle=1.9396 pcon=9.2949 forget=0.0000 orth=0.4821 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.6527 mle=1.8874 pcon=9.2924 forget=0.0000 orth=0.4729 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5096 mle=1.7560 pcon=9.2894 forget=0.0000 orth=0.4642 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.4790 mle=1.7358 pcon=9.2872 forget=0.0000 orth=0.4560 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.6914 mle=1.9589 pcon=9.2844 forget=0.0000 orth=0.4480 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.7540 mle=2.0318 pcon=9.2816 forget=0.0000 orth=0.4406 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=11.8571 mle=2.1446 pcon=9.2788 forget=0.0000 orth=0.4337 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 9 it 31 total=11.9693 mle=2.2663 pcon=9.2760 forget=0.0000 orth=0.4269 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.7446 mle=2.0507 pcon=9.2734 forget=0.0000 orth=0.4205 favg=0.0000 nr=110 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.5851 mle=1.9000 pcon=9.2708 forget=0.0000 orth=0.4144 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.7115 mle=2.0354 pcon=9.2678 forget=0.0000 orth=0.4084 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.5804 mle=1.9114 pcon=9.2658 forget=0.0000 orth=0.4032 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.6998 mle=2.0394 pcon=9.2624 forget=0.0000 orth=0.3979 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.7960 mle=2.1440 pcon=9.2593 forget=0.0000 orth=0.3926 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.5674 mle=1.9238 pcon=9.2562 forget=0.0000 orth=0.3874 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 10 it 40 total=11.5106 mle=1.8744 pcon=9.2535 forget=0.0000 orth=0.3827 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=11.8826 mle=2.2549 pcon=9.2494 forget=0.0000 orth=0.3782 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.5640 mle=1.9433 pcon=9.2470 forget=0.0000 orth=0.3737 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.5777 mle=1.9642 pcon=9.2440 forget=0.0000 orth=0.3695 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.4412 mle=1.8352 pcon=9.2406 forget=0.0000 orth=0.3654 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=11.8802 mle=2.2803 pcon=9.2383 forget=0.0000 orth=0.3616 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.5098 mle=1.9169 pcon=9.2352 forget=0.0000 orth=0.3578 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=11.8064 mle=2.2205 pcon=9.2317 forget=0.0000 orth=0.3542 favg=0.0000 nr=68 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 11 it 49 total=11.5092 mle=1.9301 pcon=9.2284 forget=0.0000 orth=0.3506 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.7610 mle=2.1888 pcon=9.2249 forget=0.0000 orth=0.3473 favg=0.0000 nr=102 nf=11 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.6745 mle=2.1084 pcon=9.2220 forget=0.0000 orth=0.3441 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.5480 mle=1.9888 pcon=9.2183 forget=0.0000 orth=0.3410 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.3109 mle=1.7590 pcon=9.2141 forget=0.0000 orth=0.3379 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.6374 mle=2.0923 pcon=9.2101 forget=0.0000 orth=0.3350 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.4270 mle=1.8877 pcon=9.2071 forget=0.0000 orth=0.3322 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 12 it 8 total=11.6837 mle=2.1507 pcon=9.2037 forget=0.0000 orth=0.3293 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.4996 mle=1.9734 pcon=9.1995 forget=0.0000 orth=0.3268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.6090 mle=2.0888 pcon=9.1962 forget=0.0000 orth=0.3240 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.4929 mle=1.9791 pcon=9.1923 forget=0.0000 orth=0.3215 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.4290 mle=1.9215 pcon=9.1885 forget=0.0000 orth=0.3190 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.7612 mle=2.2587 pcon=9.1859 forget=0.0000 orth=0.3166 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.6362 mle=2.1400 pcon=9.1822 forget=0.0000 orth=0.3140 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.5617 mle=2.0713 pcon=9.1787 forget=0.0000 orth=0.3117 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
 37%|███▋      | 13/35 [02:15<03:38,  9.95s/it] 40%|████      | 14/35 [02:25<03:31, 10.06s/it] 43%|████▎     | 15/35 [02:35<03:19,  9.96s/it] 46%|████▌     | 16/35 [02:45<03:12, 10.13s/it] 49%|████▊     | 17/35 [02:55<03:00, 10.05s/it] 51%|█████▏    | 18/35 [03:05<02:50, 10.03s/it] 54%|█████▍    | 19/35 [03:16<02:42, 10.19s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 13 it 17 total=11.6547 mle=2.1695 pcon=9.1757 forget=0.0000 orth=0.3096 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.4049 mle=1.9257 pcon=9.1717 forget=0.0000 orth=0.3074 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.7040 mle=2.2302 pcon=9.1686 forget=0.0000 orth=0.3052 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.5933 mle=2.1252 pcon=9.1648 forget=0.0000 orth=0.3033 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.6600 mle=2.1968 pcon=9.1619 forget=0.0000 orth=0.3012 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.5982 mle=2.1408 pcon=9.1581 forget=0.0000 orth=0.2993 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.4806 mle=2.0288 pcon=9.1544 forget=0.0000 orth=0.2974 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.5590 mle=2.1130 pcon=9.1505 forget=0.0000 orth=0.2955 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 14 it 26 total=11.6810 mle=2.2398 pcon=9.1475 forget=0.0000 orth=0.2937 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.3831 mle=1.9472 pcon=9.1441 forget=0.0000 orth=0.2918 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.4701 mle=2.0398 pcon=9.1403 forget=0.0000 orth=0.2900 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.5577 mle=2.1336 pcon=9.1359 forget=0.0000 orth=0.2882 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.3439 mle=1.9257 pcon=9.1316 forget=0.0000 orth=0.2865 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.5920 mle=2.1795 pcon=9.1277 forget=0.0000 orth=0.2848 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.4602 mle=2.0523 pcon=9.1246 forget=0.0000 orth=0.2832 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.2716 mle=1.8686 pcon=9.1212 forget=0.0000 orth=0.2817 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 15 it 35 total=11.4300 mle=2.0323 pcon=9.1176 forget=0.0000 orth=0.2801 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.4615 mle=2.0681 pcon=9.1148 forget=0.0000 orth=0.2787 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.3276 mle=1.9395 pcon=9.1110 forget=0.0000 orth=0.2771 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.3734 mle=1.9903 pcon=9.1076 forget=0.0000 orth=0.2755 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.5372 mle=2.1588 pcon=9.1042 forget=0.0000 orth=0.2741 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.3728 mle=1.9992 pcon=9.1009 forget=0.0000 orth=0.2728 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.5337 mle=2.1653 pcon=9.0970 forget=0.0000 orth=0.2714 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.3398 mle=1.9763 pcon=9.0934 forget=0.0000 orth=0.2701 favg=0.0000 nr=111 nf=1 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 16 it 44 total=11.5459 mle=2.1866 pcon=9.0905 forget=0.0000 orth=0.2689 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.4979 mle=2.1431 pcon=9.0870 forget=0.0000 orth=0.2677 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.3903 mle=2.0401 pcon=9.0837 forget=0.0000 orth=0.2664 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.3364 mle=1.9910 pcon=9.0802 forget=0.0000 orth=0.2652 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.2570 mle=1.9163 pcon=9.0767 forget=0.0000 orth=0.2639 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.2171 mle=1.8810 pcon=9.0734 forget=0.0000 orth=0.2626 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.3964 mle=2.0647 pcon=9.0702 forget=0.0000 orth=0.2615 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 17 it 3 total=11.0931 mle=1.7655 pcon=9.0673 forget=0.0000 orth=0.2603 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.1362 mle=1.8132 pcon=9.0638 forget=0.0000 orth=0.2592 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.3392 mle=2.0205 pcon=9.0607 forget=0.0000 orth=0.2580 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.1658 mle=1.8510 pcon=9.0578 forget=0.0000 orth=0.2569 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.2283 mle=1.9187 pcon=9.0538 forget=0.0000 orth=0.2558 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.2932 mle=1.9873 pcon=9.0513 forget=0.0000 orth=0.2547 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.2006 mle=1.8983 pcon=9.0487 forget=0.0000 orth=0.2536 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.2637 mle=1.9663 pcon=9.0448 forget=0.0000 orth=0.2526 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 18 it 12 total=11.2842 mle=1.9914 pcon=9.0412 forget=0.0000 orth=0.2516 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.5104 mle=2.2222 pcon=9.0376 forget=0.0000 orth=0.2506 favg=0.0000 nr=110 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.1540 mle=1.8692 pcon=9.0351 forget=0.0000 orth=0.2497 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.3580 mle=2.0782 pcon=9.0310 forget=0.0000 orth=0.2488 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.3713 mle=2.0964 pcon=9.0271 forget=0.0000 orth=0.2478 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.2287 mle=1.9584 pcon=9.0234 forget=0.0000 orth=0.2469 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.2096 mle=1.9434 pcon=9.0203 forget=0.0000 orth=0.2459 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.0870 mle=1.8251 pcon=9.0169 forget=0.0000 orth=0.2450 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 19 it 21 total=11.2111 mle=1.9529 pcon=9.0141 forget=0.0000 orth=0.2441 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.3293 mle=2.0757 pcon=9.0104 forget=0.0000 orth=0.2432 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
 57%|█████▋    | 20/35 [03:26<02:33, 10.24s/it] 60%|██████    | 21/35 [03:36<02:22, 10.20s/it] 63%|██████▎   | 22/35 [03:46<02:12, 10.17s/it] 66%|██████▌   | 23/35 [03:57<02:03, 10.32s/it] 69%|██████▊   | 24/35 [04:08<01:55, 10.52s/it] 71%|███████▏  | 25/35 [04:18<01:44, 10.42s/it][loss] ep 19 it 121 total=11.1348 mle=1.8847 pcon=9.0078 forget=0.0000 orth=0.2424 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.2379 mle=1.9922 pcon=9.0041 forget=0.0000 orth=0.2416 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.2797 mle=2.0374 pcon=9.0016 forget=0.0000 orth=0.2407 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.3261 mle=2.0879 pcon=8.9984 forget=0.0000 orth=0.2399 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.2680 mle=2.0332 pcon=8.9958 forget=0.0000 orth=0.2391 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.2498 mle=2.0181 pcon=8.9935 forget=0.0000 orth=0.2383 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 20 it 30 total=11.4025 mle=2.1739 pcon=8.9911 forget=0.0000 orth=0.2375 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.1188 mle=1.8939 pcon=8.9881 forget=0.0000 orth=0.2368 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.2827 mle=2.0615 pcon=8.9851 forget=0.0000 orth=0.2361 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.2920 mle=2.0742 pcon=8.9824 forget=0.0000 orth=0.2354 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.0391 mle=1.8250 pcon=8.9793 forget=0.0000 orth=0.2348 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.2053 mle=1.9952 pcon=8.9760 forget=0.0000 orth=0.2341 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.4512 mle=2.2447 pcon=8.9731 forget=0.0000 orth=0.2334 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.3273 mle=2.1235 pcon=8.9711 forget=0.0000 orth=0.2327 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 21 it 39 total=11.1864 mle=1.9874 pcon=8.9670 forget=0.0000 orth=0.2320 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.0732 mle=1.8778 pcon=8.9640 forget=0.0000 orth=0.2313 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.2785 mle=2.0865 pcon=8.9613 forget=0.0000 orth=0.2307 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.0999 mle=1.9116 pcon=8.9583 forget=0.0000 orth=0.2300 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.2726 mle=2.0871 pcon=8.9559 forget=0.0000 orth=0.2295 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.0665 mle=1.8842 pcon=8.9534 forget=0.0000 orth=0.2289 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.1277 mle=1.9479 pcon=8.9514 forget=0.0000 orth=0.2283 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.3228 mle=2.1471 pcon=8.9480 forget=0.0000 orth=0.2277 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 22 it 48 total=11.2802 mle=2.1074 pcon=8.9456 forget=0.0000 orth=0.2272 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.1435 mle=1.9740 pcon=8.9429 forget=0.0000 orth=0.2266 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.1984 mle=2.0320 pcon=8.9404 forget=0.0000 orth=0.2260 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.1027 mle=1.9382 pcon=8.9390 forget=0.0000 orth=0.2255 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.2083 mle=2.0464 pcon=8.9369 forget=0.0000 orth=0.2250 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.1980 mle=2.0386 pcon=8.9349 forget=0.0000 orth=0.2245 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.2793 mle=2.1236 pcon=8.9317 forget=0.0000 orth=0.2240 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 23 it 7 total=11.1032 mle=1.9506 pcon=8.9291 forget=0.0000 orth=0.2235 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.2875 mle=2.1387 pcon=8.9258 forget=0.0000 orth=0.2230 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.9233 mle=1.7779 pcon=8.9228 forget=0.0000 orth=0.2226 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.4217 mle=2.2783 pcon=8.9212 forget=0.0000 orth=0.2222 favg=0.0000 nr=107 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.2359 mle=2.0952 pcon=8.9189 forget=0.0000 orth=0.2218 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.1487 mle=2.0111 pcon=8.9163 forget=0.0000 orth=0.2213 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.2112 mle=2.0772 pcon=8.9131 forget=0.0000 orth=0.2209 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.0478 mle=1.9170 pcon=8.9104 forget=0.0000 orth=0.2205 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 24 it 16 total=11.2257 mle=2.0978 pcon=8.9079 forget=0.0000 orth=0.2201 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.0494 mle=1.9229 pcon=8.9069 forget=0.0000 orth=0.2196 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.2785 mle=2.1545 pcon=8.9048 forget=0.0000 orth=0.2192 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.2648 mle=2.1441 pcon=8.9020 forget=0.0000 orth=0.2188 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=10.9989 mle=1.8812 pcon=8.8993 forget=0.0000 orth=0.2184 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.0800 mle=1.9654 pcon=8.8966 forget=0.0000 orth=0.2180 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.0555 mle=1.9434 pcon=8.8944 forget=0.0000 orth=0.2177 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.3621 mle=2.2525 pcon=8.8923 forget=0.0000 orth=0.2173 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 25 it 25 total=11.0444 mle=1.9376 pcon=8.8899 forget=0.0000 orth=0.2169 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=11.1334 mle=2.0287 pcon=8.8881 forget=0.0000 orth=0.2166 favg=0.0000 nr=115 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.4035 mle=2.3024 pcon=8.8850 forget=0.0000 orth=0.2162 favg=0.0000 nr=104 nf=12 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=11.1039 mle=2.0051 pcon=8.8829 forget=0.0000 orth=0.2159 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=10.9667 mle=1.8702 pcon=8.8809 forget=0.0000 orth=0.2156 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.2475 mle=2.1530 pcon=8.8792 forget=0.0000 orth=0.2153 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
 74%|███████▍  | 26/35 [04:28<01:32, 10.32s/it] 77%|███████▋  | 27/35 [04:39<01:22, 10.31s/it] 80%|████████  | 28/35 [04:49<01:12, 10.33s/it] 83%|████████▎ | 29/35 [04:59<01:01, 10.30s/it] 86%|████████▌ | 30/35 [05:09<00:51, 10.28s/it] 89%|████████▊ | 31/35 [05:21<00:42, 10.55s/it] 91%|█████████▏| 32/35 [05:31<00:31, 10.42s/it][loss] ep 25 it 325 total=11.0519 mle=1.9596 pcon=8.8773 forget=0.0000 orth=0.2150 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=11.1733 mle=2.0832 pcon=8.8754 forget=0.0000 orth=0.2147 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 26 it 34 total=10.9849 mle=1.8971 pcon=8.8734 forget=0.0000 orth=0.2144 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.2373 mle=2.1529 pcon=8.8702 forget=0.0000 orth=0.2142 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=11.1469 mle=2.0642 pcon=8.8688 forget=0.0000 orth=0.2139 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=11.1252 mle=2.0443 pcon=8.8673 forget=0.0000 orth=0.2137 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=11.0180 mle=1.9395 pcon=8.8651 forget=0.0000 orth=0.2134 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=11.1944 mle=2.1189 pcon=8.8623 forget=0.0000 orth=0.2132 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=11.0860 mle=2.0128 pcon=8.8603 forget=0.0000 orth=0.2129 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=10.9962 mle=1.9247 pcon=8.8588 forget=0.0000 orth=0.2127 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 27 it 43 total=11.2232 mle=2.1536 pcon=8.8571 forget=0.0000 orth=0.2125 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=11.1216 mle=2.0534 pcon=8.8559 forget=0.0000 orth=0.2122 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=11.1982 mle=2.1314 pcon=8.8547 forget=0.0000 orth=0.2121 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=11.0754 mle=2.0103 pcon=8.8532 forget=0.0000 orth=0.2119 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=11.0205 mle=1.9573 pcon=8.8515 forget=0.0000 orth=0.2117 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=11.0638 mle=2.0024 pcon=8.8499 forget=0.0000 orth=0.2115 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.8503 mle=1.7915 pcon=8.8475 forget=0.0000 orth=0.2113 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 28 it 2 total=10.9090 mle=1.8517 pcon=8.8461 forget=0.0000 orth=0.2111 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=11.1795 mle=2.1242 pcon=8.8443 forget=0.0000 orth=0.2110 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=11.1212 mle=2.0677 pcon=8.8427 forget=0.0000 orth=0.2108 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.2385 mle=2.1862 pcon=8.8417 forget=0.0000 orth=0.2107 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=11.1854 mle=2.1351 pcon=8.8398 forget=0.0000 orth=0.2105 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=11.1318 mle=2.0833 pcon=8.8382 forget=0.0000 orth=0.2104 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.8227 mle=1.7746 pcon=8.8379 forget=0.0000 orth=0.2102 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=11.0459 mle=1.9997 pcon=8.8361 forget=0.0000 orth=0.2101 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 29 it 11 total=10.8835 mle=1.8399 pcon=8.8337 forget=0.0000 orth=0.2099 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=11.1307 mle=2.0877 pcon=8.8332 forget=0.0000 orth=0.2098 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=11.2157 mle=2.1740 pcon=8.8321 forget=0.0000 orth=0.2097 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.9343 mle=1.8943 pcon=8.8304 forget=0.0000 orth=0.2096 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.2456 mle=2.2077 pcon=8.8284 forget=0.0000 orth=0.2095 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=11.0798 mle=2.0435 pcon=8.8270 forget=0.0000 orth=0.2094 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=10.9828 mle=1.9474 pcon=8.8261 forget=0.0000 orth=0.2093 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.3188 mle=2.2847 pcon=8.8250 forget=0.0000 orth=0.2092 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 30 it 20 total=10.9143 mle=1.8818 pcon=8.8234 forget=0.0000 orth=0.2091 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=11.1947 mle=2.1630 pcon=8.8226 forget=0.0000 orth=0.2090 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.9763 mle=1.9463 pcon=8.8211 forget=0.0000 orth=0.2089 favg=0.0000 nr=116 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=11.3513 mle=2.3226 pcon=8.8199 forget=0.0000 orth=0.2088 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=11.1112 mle=2.0840 pcon=8.8185 forget=0.0000 orth=0.2088 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.8844 mle=1.8582 pcon=8.8175 forget=0.0000 orth=0.2087 favg=0.0000 nr=117 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=11.0602 mle=2.0352 pcon=8.8164 forget=0.0000 orth=0.2086 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=11.1327 mle=2.1088 pcon=8.8153 forget=0.0000 orth=0.2086 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 31 it 29 total=10.9471 mle=1.9244 pcon=8.8142 forget=0.0000 orth=0.2085 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=11.1708 mle=2.1499 pcon=8.8125 forget=0.0000 orth=0.2085 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=11.0251 mle=2.0049 pcon=8.8118 forget=0.0000 orth=0.2084 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=11.1807 mle=2.1618 pcon=8.8106 forget=0.0000 orth=0.2084 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=11.1386 mle=2.1217 pcon=8.8085 forget=0.0000 orth=0.2083 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.8749 mle=1.8591 pcon=8.8075 forget=0.0000 orth=0.2083 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=11.1374 mle=2.1218 pcon=8.8073 forget=0.0000 orth=0.2082 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=11.1638 mle=2.1501 pcon=8.8055 forget=0.0000 orth=0.2082 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
 94%|█████████▍| 33/35 [05:41<00:20, 10.38s/it] 97%|█████████▋| 34/35 [05:51<00:10, 10.37s/it]100%|██████████| 35/35 [06:02<00:00, 10.40s/it]100%|██████████| 35/35 [06:02<00:00, 10.35s/it]
[loss] ep 32 it 38 total=11.0123 mle=1.9997 pcon=8.8045 forget=0.0000 orth=0.2082 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.9730 mle=1.9618 pcon=8.8031 forget=0.0000 orth=0.2081 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=11.0195 mle=2.0087 pcon=8.8027 forget=0.0000 orth=0.2081 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=11.1735 mle=2.1643 pcon=8.8012 forget=0.0000 orth=0.2081 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.8690 mle=1.8607 pcon=8.8002 forget=0.0000 orth=0.2081 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=10.9804 mle=1.9729 pcon=8.7995 forget=0.0000 orth=0.2080 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=11.1679 mle=2.1609 pcon=8.7990 forget=0.0000 orth=0.2080 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.8565 mle=1.8507 pcon=8.7979 forget=0.0000 orth=0.2080 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 33 it 47 total=11.2034 mle=2.1984 pcon=8.7970 forget=0.0000 orth=0.2080 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=11.1794 mle=2.1750 pcon=8.7965 forget=0.0000 orth=0.2080 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=11.0696 mle=2.0660 pcon=8.7956 forget=0.0000 orth=0.2080 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.8134 mle=1.8108 pcon=8.7947 forget=0.0000 orth=0.2079 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.8997 mle=1.8980 pcon=8.7937 forget=0.0000 orth=0.2079 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=11.1332 mle=2.1331 pcon=8.7922 forget=0.0000 orth=0.2079 favg=0.0000 nr=112 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=11.2617 mle=2.2617 pcon=8.7921 forget=0.0000 orth=0.2079 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 34 it 6 total=11.2460 mle=2.2466 pcon=8.7915 forget=0.0000 orth=0.2079 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.8978 mle=1.8995 pcon=8.7903 forget=0.0000 orth=0.2079 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.8874 mle=1.8900 pcon=8.7895 forget=0.0000 orth=0.2079 favg=0.0000 nr=112 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=11.0248 mle=2.0289 pcon=8.7879 forget=0.0000 orth=0.2079 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.8590 mle=1.8634 pcon=8.7877 forget=0.0000 orth=0.2079 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=10.9962 mle=2.0020 pcon=8.7863 forget=0.0000 orth=0.2079 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.9902 mle=1.9960 pcon=8.7864 forget=0.0000 orth=0.2079 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=11.1632 mle=2.1697 pcon=8.7856 forget=0.0000 orth=0.2079 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:29,  1.86it/s]  3%|▎         | 11/391 [00:00<00:17, 22.21it/s]  5%|▌         | 21/391 [00:00<00:09, 39.61it/s]  8%|▊         | 31/391 [00:00<00:06, 53.53it/s] 10%|█         | 41/391 [00:00<00:05, 64.30it/s] 13%|█▎        | 51/391 [00:01<00:04, 72.87it/s] 16%|█▌        | 61/391 [00:01<00:04, 78.84it/s] 18%|█▊        | 71/391 [00:01<00:03, 83.42it/s] 21%|██        | 81/391 [00:01<00:03, 86.57it/s] 23%|██▎       | 91/391 [00:01<00:03, 89.21it/s] 26%|██▌       | 101/391 [00:01<00:03, 91.13it/s] 28%|██▊       | 111/391 [00:01<00:04, 56.45it/s] 31%|███       | 120/391 [00:02<00:04, 62.84it/s] 33%|███▎      | 129/391 [00:02<00:03, 67.37it/s] 36%|███▌      | 139/391 [00:02<00:03, 73.53it/s] 38%|███▊      | 148/391 [00:02<00:03, 66.06it/s] 40%|███▉      | 156/391 [00:02<00:03, 61.42it/s] 42%|████▏     | 163/391 [00:02<00:03, 57.93it/s] 44%|████▍     | 173/391 [00:02<00:03, 66.76it/s] 47%|████▋     | 183/391 [00:02<00:02, 74.06it/s] 49%|████▉     | 193/391 [00:03<00:02, 79.89it/s] 52%|█████▏    | 203/391 [00:03<00:02, 83.69it/s] 54%|█████▍    | 212/391 [00:03<00:02, 82.67it/s] 57%|█████▋    | 221/391 [00:03<00:02, 81.46it/s] 59%|█████▉    | 230/391 [00:03<00:02, 78.82it/s] 61%|██████    | 239/391 [00:03<00:01, 79.66it/s] 63%|██████▎   | 248/391 [00:03<00:01, 80.27it/s] 66%|██████▌   | 257/391 [00:03<00:01, 72.56it/s] 68%|██████▊   | 266/391 [00:03<00:01, 75.42it/s] 71%|███████   | 276/391 [00:04<00:01, 80.62it/s] 73%|███████▎  | 286/391 [00:04<00:01, 84.17it/s] 76%|███████▌  | 296/391 [00:04<00:01, 86.80it/s] 78%|███████▊  | 306/391 [00:04<00:00, 88.71it/s] 81%|████████  | 316/391 [00:04<00:00, 90.57it/s] 83%|████████▎ | 326/391 [00:04<00:00, 92.20it/s] 86%|████████▌ | 336/391 [00:04<00:00, 92.80it/s] 88%|████████▊ | 346/391 [00:04<00:00, 93.82it/s] 91%|█████████ | 356/391 [00:04<00:00, 94.35it/s] 94%|█████████▎| 366/391 [00:05<00:00, 94.02it/s] 96%|█████████▌| 376/391 [00:05<00:00, 95.02it/s] 99%|█████████▊| 386/391 [00:05<00:00, 95.81it/s]100%|██████████| 391/391 [00:05<00:00, 73.99it/s]
50000 images processed, 5.341092348098755 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:34,  2.27it/s] 14%|█▍        | 11/79 [00:00<00:02, 25.68it/s] 22%|██▏       | 17/79 [00:00<00:01, 33.43it/s] 30%|███       | 24/79 [00:00<00:01, 42.16it/s] 43%|████▎     | 34/79 [00:00<00:00, 56.66it/s] 56%|█████▌    | 44/79 [00:00<00:00, 66.96it/s] 67%|██████▋   | 53/79 [00:01<00:00, 73.27it/s] 78%|███████▊  | 62/79 [00:01<00:00, 64.07it/s] 89%|████████▊ | 70/79 [00:01<00:00, 63.60it/s]100%|██████████| 79/79 [00:01<00:00, 69.98it/s]100%|██████████| 79/79 [00:01<00:00, 53.01it/s]
10000 images processed, 1.505666971206665 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:52,  1.80it/s]  3%|▎         | 7/204 [00:00<00:14, 13.58it/s]  6%|▌         | 12/204 [00:00<00:08, 21.49it/s] 11%|█         | 22/204 [00:00<00:04, 39.76it/s] 14%|█▍        | 29/204 [00:00<00:03, 46.39it/s] 18%|█▊        | 36/204 [00:01<00:03, 44.93it/s] 21%|██        | 42/204 [00:01<00:03, 47.98it/s] 25%|██▌       | 52/204 [00:01<00:02, 59.76it/s] 30%|███       | 62/204 [00:01<00:02, 68.92it/s] 35%|███▌      | 72/204 [00:01<00:01, 75.13it/s] 40%|████      | 82/204 [00:01<00:01, 80.19it/s] 45%|████▌     | 92/204 [00:01<00:01, 83.25it/s] 50%|█████     | 102/204 [00:01<00:01, 86.41it/s] 55%|█████▍    | 112/204 [00:02<00:01, 88.99it/s] 60%|█████▉    | 122/204 [00:02<00:00, 89.52it/s] 65%|██████▍   | 132/204 [00:02<00:00, 90.88it/s] 70%|██████▉   | 142/204 [00:02<00:00, 92.15it/s] 75%|███████▍  | 152/204 [00:02<00:00, 93.19it/s] 79%|███████▉  | 162/204 [00:02<00:00, 93.69it/s] 84%|████████▍ | 172/204 [00:02<00:00, 94.13it/s] 89%|████████▉ | 182/204 [00:02<00:00, 94.82it/s] 94%|█████████▍| 192/204 [00:02<00:00, 95.43it/s] 99%|█████████▉| 202/204 [00:02<00:00, 95.83it/s]100%|██████████| 204/204 [00:02<00:00, 68.49it/s]
26032 images processed, 3.0163238048553467 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:55,  1.42it/s] 14%|█▍        | 11/79 [00:00<00:03, 17.86it/s] 27%|██▋       | 21/79 [00:01<00:02, 27.94it/s] 38%|███▊      | 30/79 [00:01<00:01, 39.46it/s] 47%|████▋     | 37/79 [00:01<00:00, 44.72it/s] 59%|█████▉    | 47/79 [00:01<00:00, 55.98it/s] 70%|██████▉   | 55/79 [00:01<00:00, 59.37it/s] 80%|███████▉  | 63/79 [00:01<00:00, 63.36it/s] 92%|█████████▏| 73/79 [00:01<00:00, 72.11it/s]100%|██████████| 79/79 [00:01<00:00, 45.84it/s]
10000 images processed, 1.7448217868804932 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:00,  1.30it/s] 13%|█▎        | 10/79 [00:00<00:04, 15.18it/s] 25%|██▌       | 20/79 [00:00<00:01, 30.20it/s] 38%|███▊      | 30/79 [00:01<00:01, 43.83it/s] 48%|████▊     | 38/79 [00:01<00:00, 51.33it/s] 61%|██████    | 48/79 [00:01<00:00, 62.08it/s] 73%|███████▎  | 58/79 [00:01<00:00, 70.98it/s] 86%|████████▌ | 68/79 [00:01<00:00, 77.81it/s] 99%|█████████▊| 78/79 [00:01<00:00, 82.99it/s]100%|██████████| 79/79 [00:01<00:00, 48.99it/s]
10000 images processed, 1.6446444988250732 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:42,  1.64it/s] 14%|█▍        | 10/70 [00:00<00:03, 18.17it/s] 29%|██▊       | 20/70 [00:00<00:01, 34.75it/s] 43%|████▎     | 30/70 [00:00<00:00, 49.09it/s] 57%|█████▋    | 40/70 [00:01<00:00, 60.82it/s] 71%|███████▏  | 50/70 [00:01<00:00, 70.15it/s] 84%|████████▍ | 59/70 [00:01<00:00, 65.75it/s] 96%|█████████▌| 67/70 [00:01<00:00, 60.16it/s]100%|██████████| 70/70 [00:01<00:00, 45.71it/s]
8925 images processed, 1.6123628616333008 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:53,  1.20s/it]  4%|▍         | 2/45 [00:01<00:24,  1.75it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.22it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.18it/s] 47%|████▋     | 21/45 [00:01<00:01, 16.51it/s] 62%|██████▏   | 28/45 [00:02<00:00, 20.34it/s] 73%|███████▎  | 33/45 [00:02<00:00, 16.96it/s] 89%|████████▉ | 40/45 [00:02<00:00, 23.61it/s] 98%|█████████▊| 44/45 [00:02<00:00, 20.13it/s]100%|██████████| 45/45 [00:02<00:00, 15.04it/s]
5640 images processed, 3.0149495601654053 seconds used

19.695842742919922
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           8.04  98.21  80.86
places365     59.66  82.17  44.29
LSUN          59.82  83.10  51.56
iSUN          52.78  87.64  61.85
dtd           25.60  94.04  82.52
AVG           41.18  89.03  64.22
[incremental] Overall: 0.7180 New: 0.7300 Old: 0.7120
[incremental] Final(Top-1): 0.7180  Average: 0.7690
5.921145915985107
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=35, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/35 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  3%|▎         | 1/35 [00:19<11:11, 19.75s/it]  6%|▌         | 2/35 [00:31<08:09, 14.84s/it]  9%|▊         | 3/35 [00:41<06:45, 12.66s/it] 11%|█▏        | 4/35 [00:52<06:10, 11.95s/it] 14%|█▍        | 5/35 [01:02<05:43, 11.44s/it] 17%|█▋        | 6/35 [01:13<05:24, 11.18s/it][loss] ep 0 it 0 total=14.3871 mle=2.6218 pcon=9.8394 forget=0.0000 orth=1.9259 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=14.2232 mle=2.4578 pcon=9.8399 forget=0.0000 orth=1.9255 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=14.3465 mle=2.5818 pcon=9.8400 forget=0.0000 orth=1.9247 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=14.1455 mle=2.3842 pcon=9.8380 forget=0.0000 orth=1.9233 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=13.8352 mle=2.0783 pcon=9.8355 forget=0.0000 orth=1.9214 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.9783 mle=2.2273 pcon=9.8321 forget=0.0000 orth=1.9189 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=14.3396 mle=2.5967 pcon=9.8271 forget=0.0000 orth=1.9158 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.9662 mle=2.2333 pcon=9.8207 forget=0.0000 orth=1.9122 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.8846 mle=2.1627 pcon=9.8140 forget=0.0000 orth=1.9079 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.9344 mle=2.2241 pcon=9.8074 forget=0.0000 orth=1.9029 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=14.0011 mle=2.3038 pcon=9.7999 forget=0.0000 orth=1.8973 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=14.1634 mle=2.4801 pcon=9.7922 forget=0.0000 orth=1.8911 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.9769 mle=2.3098 pcon=9.7830 forget=0.0000 orth=1.8841 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.7000 mle=2.0497 pcon=9.7740 forget=0.0000 orth=1.8764 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.8994 mle=2.2666 pcon=9.7650 forget=0.0000 orth=1.8678 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.9075 mle=2.2943 pcon=9.7548 forget=0.0000 orth=1.8585 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.7279 mle=2.1332 pcon=9.7463 forget=0.0000 orth=1.8484 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.7279 mle=2.1533 pcon=9.7374 forget=0.0000 orth=1.8373 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.5867 mle=2.0335 pcon=9.7279 forget=0.0000 orth=1.8253 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.7049 mle=2.1737 pcon=9.7189 forget=0.0000 orth=1.8123 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.3464 mle=1.8394 pcon=9.7087 forget=0.0000 orth=1.7983 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.7135 mle=2.2327 pcon=9.6977 forget=0.0000 orth=1.7832 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.6558 mle=2.2005 pcon=9.6883 forget=0.0000 orth=1.7670 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.1937 mle=1.7652 pcon=9.6788 forget=0.0000 orth=1.7497 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.5441 mle=2.1441 pcon=9.6688 forget=0.0000 orth=1.7312 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.6225 mle=2.2520 pcon=9.6590 forget=0.0000 orth=1.7115 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.4739 mle=2.1342 pcon=9.6490 forget=0.0000 orth=1.6906 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.3942 mle=2.0867 pcon=9.6390 forget=0.0000 orth=1.6685 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.2747 mle=2.0001 pcon=9.6293 forget=0.0000 orth=1.6453 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.2233 mle=1.9828 pcon=9.6196 forget=0.0000 orth=1.6209 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.3098 mle=2.1043 pcon=9.6100 forget=0.0000 orth=1.5956 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.1622 mle=1.9923 pcon=9.6007 forget=0.0000 orth=1.5692 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.1981 mle=2.0651 pcon=9.5910 forget=0.0000 orth=1.5421 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.1615 mle=2.0659 pcon=9.5814 forget=0.0000 orth=1.5143 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.1369 mle=2.0790 pcon=9.5719 forget=0.0000 orth=1.4861 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.8974 mle=1.8771 pcon=9.5628 forget=0.0000 orth=1.4575 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.9483 mle=1.9659 pcon=9.5536 forget=0.0000 orth=1.4288 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.8683 mle=1.9228 pcon=9.5453 forget=0.0000 orth=1.4001 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.1588 mle=2.2510 pcon=9.5362 forget=0.0000 orth=1.3716 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.8007 mle=1.9299 pcon=9.5275 forget=0.0000 orth=1.3433 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 5 it 45 total=12.8960 mle=2.0616 pcon=9.5188 forget=0.0000 orth=1.3155 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.7811 mle=1.9823 pcon=9.5106 forget=0.0000 orth=1.2881 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.7749 mle=2.0127 pcon=9.5009 forget=0.0000 orth=1.2612 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.7607 mle=2.0331 pcon=9.4927 forget=0.0000 orth=1.2349 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.7320 mle=2.0383 pcon=9.4846 forget=0.0000 orth=1.2090 favg=0.0000 nr=97 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.5347 mle=1.8746 pcon=9.4764 forget=0.0000 orth=1.1837 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.7239 mle=2.0963 pcon=9.4687 forget=0.0000 orth=1.1589 favg=0.0000 nr=95 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 6 it 4 total=12.6827 mle=2.0875 pcon=9.4605 forget=0.0000 orth=1.1347 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.6390 mle=2.0752 pcon=9.4529 forget=0.0000 orth=1.1109 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.4167 mle=1.8843 pcon=9.4448 forget=0.0000 orth=1.0877 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.3120 mle=1.8104 pcon=9.4366 forget=0.0000 orth=1.0650 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=12.4268 mle=1.9548 pcon=9.4291 forget=0.0000 orth=1.0429 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
 20%|██        | 7/35 [01:23<05:05, 10.90s/it] 23%|██▎       | 8/35 [01:33<04:45, 10.58s/it] 26%|██▌       | 9/35 [01:43<04:31, 10.44s/it] 29%|██▊       | 10/35 [01:54<04:21, 10.47s/it] 31%|███▏      | 11/35 [02:04<04:10, 10.42s/it] 34%|███▍      | 12/35 [02:15<04:00, 10.45s/it] 37%|███▋      | 13/35 [02:25<03:48, 10.40s/it][loss] ep 6 it 254 total=12.5300 mle=2.0874 pcon=9.4213 forget=0.0000 orth=1.0213 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.6160 mle=2.2026 pcon=9.4133 forget=0.0000 orth=1.0002 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.3303 mle=1.9446 pcon=9.4063 forget=0.0000 orth=0.9794 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 7 it 13 total=12.4931 mle=2.1343 pcon=9.3994 forget=0.0000 orth=0.9594 favg=0.0000 nr=98 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.6014 mle=2.2696 pcon=9.3920 forget=0.0000 orth=0.9398 favg=0.0000 nr=94 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.4218 mle=2.1157 pcon=9.3852 forget=0.0000 orth=0.9208 favg=0.0000 nr=93 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.4909 mle=2.2103 pcon=9.3783 forget=0.0000 orth=0.9023 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.2390 mle=1.9834 pcon=9.3713 forget=0.0000 orth=0.8844 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.3678 mle=2.1369 pcon=9.3640 forget=0.0000 orth=0.8670 favg=0.0000 nr=102 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.1788 mle=1.9702 pcon=9.3585 forget=0.0000 orth=0.8501 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.2694 mle=2.0839 pcon=9.3519 forget=0.0000 orth=0.8336 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 8 it 22 total=12.1624 mle=1.9999 pcon=9.3449 forget=0.0000 orth=0.8177 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.0198 mle=1.8788 pcon=9.3389 forget=0.0000 orth=0.8021 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.0152 mle=1.8957 pcon=9.3325 forget=0.0000 orth=0.7870 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.8721 mle=1.7735 pcon=9.3262 forget=0.0000 orth=0.7723 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.8307 mle=1.7517 pcon=9.3210 forget=0.0000 orth=0.7580 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.0195 mle=1.9609 pcon=9.3147 forget=0.0000 orth=0.7440 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.0442 mle=2.0047 pcon=9.3092 forget=0.0000 orth=0.7303 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.1394 mle=2.1193 pcon=9.3033 forget=0.0000 orth=0.7169 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 9 it 31 total=12.1753 mle=2.1739 pcon=9.2975 forget=0.0000 orth=0.7038 favg=0.0000 nr=92 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9530 mle=1.9702 pcon=9.2917 forget=0.0000 orth=0.6911 favg=0.0000 nr=97 nf=13 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.8278 mle=1.8625 pcon=9.2866 forget=0.0000 orth=0.6787 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.9456 mle=1.9989 pcon=9.2803 forget=0.0000 orth=0.6664 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7369 mle=1.8061 pcon=9.2764 forget=0.0000 orth=0.6544 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.9127 mle=1.9992 pcon=9.2707 forget=0.0000 orth=0.6428 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.0198 mle=2.1232 pcon=9.2654 forget=0.0000 orth=0.6312 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.8163 mle=1.9362 pcon=9.2601 forget=0.0000 orth=0.6199 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 10 it 40 total=11.7769 mle=1.9129 pcon=9.2552 forget=0.0000 orth=0.6088 favg=0.0000 nr=109 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.0679 mle=2.2201 pcon=9.2497 forget=0.0000 orth=0.5981 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.7698 mle=1.9369 pcon=9.2450 forget=0.0000 orth=0.5878 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.7545 mle=1.9365 pcon=9.2401 forget=0.0000 orth=0.5779 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6714 mle=1.8683 pcon=9.2346 forget=0.0000 orth=0.5684 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=11.9706 mle=2.1810 pcon=9.2305 forget=0.0000 orth=0.5591 favg=0.0000 nr=93 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.6696 mle=1.8932 pcon=9.2265 forget=0.0000 orth=0.5499 favg=0.0000 nr=100 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=11.9785 mle=2.2159 pcon=9.2214 forget=0.0000 orth=0.5412 favg=0.0000 nr=65 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 11 it 49 total=11.7280 mle=1.9782 pcon=9.2172 forget=0.0000 orth=0.5327 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.9197 mle=2.1832 pcon=9.2120 forget=0.0000 orth=0.5245 favg=0.0000 nr=93 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.8074 mle=2.0832 pcon=9.2077 forget=0.0000 orth=0.5166 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.7080 mle=1.9965 pcon=9.2026 forget=0.0000 orth=0.5089 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.5092 mle=1.8090 pcon=9.1987 forget=0.0000 orth=0.5015 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.7858 mle=2.0974 pcon=9.1940 forget=0.0000 orth=0.4944 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.5612 mle=1.8839 pcon=9.1899 forget=0.0000 orth=0.4875 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 12 it 8 total=11.7482 mle=2.0813 pcon=9.1861 forget=0.0000 orth=0.4808 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.6404 mle=1.9847 pcon=9.1814 forget=0.0000 orth=0.4743 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.7083 mle=2.0632 pcon=9.1771 forget=0.0000 orth=0.4679 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.6557 mle=2.0203 pcon=9.1734 forget=0.0000 orth=0.4620 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.5897 mle=1.9638 pcon=9.1698 forget=0.0000 orth=0.4561 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.8429 mle=2.2263 pcon=9.1662 forget=0.0000 orth=0.4504 favg=0.0000 nr=97 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8155 mle=2.2082 pcon=9.1625 forget=0.0000 orth=0.4448 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.6823 mle=2.0839 pcon=9.1589 forget=0.0000 orth=0.4394 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
 40%|████      | 14/35 [02:34<03:33, 10.17s/it] 43%|████▎     | 15/35 [02:44<03:22, 10.10s/it] 46%|████▌     | 16/35 [02:55<03:16, 10.35s/it] 49%|████▊     | 17/35 [03:07<03:15, 10.86s/it] 51%|█████▏    | 18/35 [03:17<03:00, 10.64s/it] 54%|█████▍    | 19/35 [03:28<02:48, 10.52s/it][loss] ep 13 it 17 total=11.6946 mle=2.1045 pcon=9.1558 forget=0.0000 orth=0.4343 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.5051 mle=1.9239 pcon=9.1520 forget=0.0000 orth=0.4292 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.7248 mle=2.1520 pcon=9.1485 forget=0.0000 orth=0.4243 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.6967 mle=2.1321 pcon=9.1451 forget=0.0000 orth=0.4195 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.7280 mle=2.1710 pcon=9.1421 forget=0.0000 orth=0.4149 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.6958 mle=2.1461 pcon=9.1393 forget=0.0000 orth=0.4104 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.5722 mle=2.0304 pcon=9.1357 forget=0.0000 orth=0.4061 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.6479 mle=2.1141 pcon=9.1318 forget=0.0000 orth=0.4019 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 14 it 26 total=11.7050 mle=2.1783 pcon=9.1289 forget=0.0000 orth=0.3978 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.4552 mle=1.9357 pcon=9.1257 forget=0.0000 orth=0.3938 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.5324 mle=2.0195 pcon=9.1230 forget=0.0000 orth=0.3899 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.6962 mle=2.1920 pcon=9.1182 forget=0.0000 orth=0.3860 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.4558 mle=1.9588 pcon=9.1148 forget=0.0000 orth=0.3823 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.6770 mle=2.1873 pcon=9.1111 forget=0.0000 orth=0.3787 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.5753 mle=2.0918 pcon=9.1084 forget=0.0000 orth=0.3752 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.3200 mle=1.8427 pcon=9.1056 forget=0.0000 orth=0.3718 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 15 it 35 total=11.4942 mle=2.0236 pcon=9.1022 forget=0.0000 orth=0.3685 favg=0.0000 nr=99 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.5177 mle=2.0531 pcon=9.0994 forget=0.0000 orth=0.3652 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.3949 mle=1.9369 pcon=9.0960 forget=0.0000 orth=0.3620 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.4206 mle=1.9680 pcon=9.0937 forget=0.0000 orth=0.3589 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.5622 mle=2.1161 pcon=9.0903 forget=0.0000 orth=0.3559 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.4220 mle=1.9810 pcon=9.0880 forget=0.0000 orth=0.3529 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.6127 mle=2.1776 pcon=9.0851 forget=0.0000 orth=0.3501 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.4331 mle=2.0034 pcon=9.0825 forget=0.0000 orth=0.3472 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 16 it 44 total=11.6092 mle=2.1836 pcon=9.0810 forget=0.0000 orth=0.3446 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.5972 mle=2.1766 pcon=9.0788 forget=0.0000 orth=0.3418 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.4496 mle=2.0338 pcon=9.0767 forget=0.0000 orth=0.3392 favg=0.0000 nr=100 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.4369 mle=2.0272 pcon=9.0731 forget=0.0000 orth=0.3366 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.3754 mle=1.9702 pcon=9.0711 forget=0.0000 orth=0.3340 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.3261 mle=1.9259 pcon=9.0686 forget=0.0000 orth=0.3316 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.4367 mle=2.0419 pcon=9.0655 forget=0.0000 orth=0.3292 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 17 it 3 total=11.2264 mle=1.8368 pcon=9.0626 forget=0.0000 orth=0.3269 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.2206 mle=1.8362 pcon=9.0598 forget=0.0000 orth=0.3246 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.4590 mle=2.0799 pcon=9.0567 forget=0.0000 orth=0.3224 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.3142 mle=1.9399 pcon=9.0541 forget=0.0000 orth=0.3202 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.3351 mle=1.9653 pcon=9.0516 forget=0.0000 orth=0.3181 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.4258 mle=2.0600 pcon=9.0497 forget=0.0000 orth=0.3161 favg=0.0000 nr=101 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.2870 mle=1.9253 pcon=9.0477 forget=0.0000 orth=0.3140 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.3503 mle=1.9931 pcon=9.0451 forget=0.0000 orth=0.3120 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 18 it 12 total=11.4032 mle=2.0508 pcon=9.0422 forget=0.0000 orth=0.3101 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.5366 mle=2.1887 pcon=9.0397 forget=0.0000 orth=0.3083 favg=0.0000 nr=98 nf=12 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.2676 mle=1.9230 pcon=9.0381 forget=0.0000 orth=0.3064 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.4056 mle=2.0654 pcon=9.0356 forget=0.0000 orth=0.3046 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.3871 mle=2.0515 pcon=9.0328 forget=0.0000 orth=0.3028 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.3128 mle=1.9819 pcon=9.0299 forget=0.0000 orth=0.3010 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.3197 mle=1.9927 pcon=9.0276 forget=0.0000 orth=0.2993 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.1938 mle=1.8708 pcon=9.0254 forget=0.0000 orth=0.2976 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 19 it 21 total=11.2120 mle=1.8927 pcon=9.0233 forget=0.0000 orth=0.2960 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.3838 mle=2.0687 pcon=9.0207 forget=0.0000 orth=0.2944 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=11.2174 mle=1.9061 pcon=9.0184 forget=0.0000 orth=0.2928 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.3363 mle=2.0287 pcon=9.0163 forget=0.0000 orth=0.2913 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
 57%|█████▋    | 20/35 [03:38<02:37, 10.52s/it] 60%|██████    | 21/35 [03:49<02:26, 10.48s/it] 63%|██████▎   | 22/35 [03:59<02:17, 10.55s/it] 66%|██████▌   | 23/35 [04:10<02:06, 10.51s/it] 69%|██████▊   | 24/35 [04:20<01:54, 10.44s/it] 71%|███████▏  | 25/35 [04:31<01:44, 10.49s/it][loss] ep 19 it 221 total=11.3433 mle=2.0391 pcon=9.0144 forget=0.0000 orth=0.2898 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.4150 mle=2.1141 pcon=9.0126 forget=0.0000 orth=0.2883 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.4047 mle=2.1069 pcon=9.0109 forget=0.0000 orth=0.2869 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.3427 mle=2.0481 pcon=9.0092 forget=0.0000 orth=0.2855 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 20 it 30 total=11.4275 mle=2.1353 pcon=9.0082 forget=0.0000 orth=0.2841 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.2089 mle=1.9204 pcon=9.0057 forget=0.0000 orth=0.2827 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.3416 mle=2.0568 pcon=9.0034 forget=0.0000 orth=0.2814 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.3371 mle=2.0554 pcon=9.0015 forget=0.0000 orth=0.2802 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.2006 mle=1.9216 pcon=9.0000 forget=0.0000 orth=0.2789 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.2944 mle=2.0192 pcon=8.9976 forget=0.0000 orth=0.2777 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.5002 mle=2.2282 pcon=8.9956 forget=0.0000 orth=0.2765 favg=0.0000 nr=92 nf=13 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.3726 mle=2.1027 pcon=8.9946 forget=0.0000 orth=0.2753 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 21 it 39 total=11.2766 mle=2.0104 pcon=8.9921 forget=0.0000 orth=0.2741 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.1929 mle=1.9300 pcon=8.9899 forget=0.0000 orth=0.2729 favg=0.0000 nr=106 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.3273 mle=2.0669 pcon=8.9885 forget=0.0000 orth=0.2719 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.1899 mle=1.9324 pcon=8.9868 forget=0.0000 orth=0.2708 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.3856 mle=2.1311 pcon=8.9848 forget=0.0000 orth=0.2697 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.1490 mle=1.8972 pcon=8.9832 forget=0.0000 orth=0.2686 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.1942 mle=1.9454 pcon=8.9812 forget=0.0000 orth=0.2676 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.3550 mle=2.1095 pcon=8.9790 forget=0.0000 orth=0.2666 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 22 it 48 total=11.3525 mle=2.1097 pcon=8.9773 forget=0.0000 orth=0.2656 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.1830 mle=1.9428 pcon=8.9756 forget=0.0000 orth=0.2646 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.2871 mle=2.0495 pcon=8.9740 forget=0.0000 orth=0.2637 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.1975 mle=1.9626 pcon=8.9722 forget=0.0000 orth=0.2628 favg=0.0000 nr=102 nf=2 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.2636 mle=2.0311 pcon=8.9707 forget=0.0000 orth=0.2618 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.2211 mle=1.9906 pcon=8.9695 forget=0.0000 orth=0.2610 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.3939 mle=2.1662 pcon=8.9675 forget=0.0000 orth=0.2601 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 23 it 7 total=11.1867 mle=1.9618 pcon=8.9656 forget=0.0000 orth=0.2593 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.3950 mle=2.1721 pcon=8.9644 forget=0.0000 orth=0.2585 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=11.0349 mle=1.8148 pcon=8.9623 forget=0.0000 orth=0.2577 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.5265 mle=2.3086 pcon=8.9609 forget=0.0000 orth=0.2569 favg=0.0000 nr=94 nf=13 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.3336 mle=2.1184 pcon=8.9591 forget=0.0000 orth=0.2562 favg=0.0000 nr=96 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.2348 mle=2.0218 pcon=8.9576 forget=0.0000 orth=0.2554 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.2896 mle=2.0799 pcon=8.9549 forget=0.0000 orth=0.2547 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.1056 mle=1.8983 pcon=8.9532 forget=0.0000 orth=0.2540 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 24 it 16 total=11.3035 mle=2.0982 pcon=8.9519 forget=0.0000 orth=0.2533 favg=0.0000 nr=100 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.1374 mle=1.9338 pcon=8.9509 forget=0.0000 orth=0.2527 favg=0.0000 nr=105 nf=2 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.3941 mle=2.1927 pcon=8.9493 forget=0.0000 orth=0.2520 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.3774 mle=2.1789 pcon=8.9471 forget=0.0000 orth=0.2514 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.1223 mle=1.9262 pcon=8.9454 forget=0.0000 orth=0.2507 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.1850 mle=1.9917 pcon=8.9431 forget=0.0000 orth=0.2501 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.1283 mle=1.9373 pcon=8.9414 forget=0.0000 orth=0.2496 favg=0.0000 nr=103 nf=12 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.4487 mle=2.2599 pcon=8.9398 forget=0.0000 orth=0.2490 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 25 it 25 total=11.0963 mle=1.9101 pcon=8.9377 forget=0.0000 orth=0.2484 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=11.2586 mle=2.0742 pcon=8.9365 forget=0.0000 orth=0.2479 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.5175 mle=2.3362 pcon=8.9340 forget=0.0000 orth=0.2473 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=11.1668 mle=1.9872 pcon=8.9327 forget=0.0000 orth=0.2468 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=11.0735 mle=1.8963 pcon=8.9309 forget=0.0000 orth=0.2463 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.2992 mle=2.1237 pcon=8.9297 forget=0.0000 orth=0.2459 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=11.1185 mle=1.9449 pcon=8.9281 forget=0.0000 orth=0.2454 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=11.2520 mle=2.0797 pcon=8.9274 forget=0.0000 orth=0.2449 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
 74%|███████▍  | 26/35 [04:41<01:34, 10.51s/it] 77%|███████▋  | 27/35 [04:52<01:25, 10.67s/it] 80%|████████  | 28/35 [05:03<01:15, 10.81s/it] 83%|████████▎ | 29/35 [05:14<01:03, 10.64s/it] 86%|████████▌ | 30/35 [05:25<00:54, 10.91s/it] 89%|████████▊ | 31/35 [05:36<00:43, 10.89s/it] 91%|█████████▏| 32/35 [05:47<00:32, 10.82s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 26 it 34 total=11.0714 mle=1.9012 pcon=8.9258 forget=0.0000 orth=0.2445 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.3153 mle=2.1477 pcon=8.9235 forget=0.0000 orth=0.2440 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=11.2484 mle=2.0817 pcon=8.9230 forget=0.0000 orth=0.2436 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=11.2654 mle=2.1005 pcon=8.9217 forget=0.0000 orth=0.2432 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=11.1137 mle=1.9504 pcon=8.9205 forget=0.0000 orth=0.2428 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=11.2678 mle=2.1066 pcon=8.9188 forget=0.0000 orth=0.2424 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=11.1907 mle=2.0313 pcon=8.9174 forget=0.0000 orth=0.2420 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=11.1042 mle=1.9469 pcon=8.9158 forget=0.0000 orth=0.2416 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 27 it 43 total=11.3479 mle=2.1923 pcon=8.9144 forget=0.0000 orth=0.2413 favg=0.0000 nr=97 nf=3 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=11.1525 mle=1.9977 pcon=8.9138 forget=0.0000 orth=0.2409 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=11.2931 mle=2.1402 pcon=8.9123 forget=0.0000 orth=0.2406 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=11.1753 mle=2.0246 pcon=8.9105 forget=0.0000 orth=0.2402 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=11.1657 mle=2.0164 pcon=8.9094 forget=0.0000 orth=0.2399 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=11.1955 mle=2.0480 pcon=8.9079 forget=0.0000 orth=0.2396 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.9922 mle=1.8467 pcon=8.9062 forget=0.0000 orth=0.2393 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 28 it 2 total=10.9929 mle=1.8488 pcon=8.9050 forget=0.0000 orth=0.2390 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=11.3109 mle=2.1685 pcon=8.9036 forget=0.0000 orth=0.2388 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=11.1890 mle=2.0480 pcon=8.9025 forget=0.0000 orth=0.2385 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.3503 mle=2.2099 pcon=8.9021 forget=0.0000 orth=0.2383 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=11.2614 mle=2.1225 pcon=8.9010 forget=0.0000 orth=0.2380 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=11.2186 mle=2.0815 pcon=8.8994 forget=0.0000 orth=0.2378 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.9432 mle=1.8067 pcon=8.8990 forget=0.0000 orth=0.2375 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=11.1501 mle=2.0151 pcon=8.8977 forget=0.0000 orth=0.2373 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 29 it 11 total=10.9760 mle=1.8429 pcon=8.8960 forget=0.0000 orth=0.2371 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=11.1748 mle=2.0424 pcon=8.8954 forget=0.0000 orth=0.2369 favg=0.0000 nr=99 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=11.2931 mle=2.1621 pcon=8.8942 forget=0.0000 orth=0.2367 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=11.0680 mle=1.9384 pcon=8.8931 forget=0.0000 orth=0.2365 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.3004 mle=2.1726 pcon=8.8914 forget=0.0000 orth=0.2364 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=11.1814 mle=2.0549 pcon=8.8903 forget=0.0000 orth=0.2362 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=11.0940 mle=1.9684 pcon=8.8896 forget=0.0000 orth=0.2361 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.4359 mle=2.3111 pcon=8.8888 forget=0.0000 orth=0.2359 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 30 it 20 total=10.9739 mle=1.8500 pcon=8.8882 forget=0.0000 orth=0.2358 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=11.2572 mle=2.1338 pcon=8.8878 forget=0.0000 orth=0.2356 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=11.0651 mle=1.9432 pcon=8.8863 forget=0.0000 orth=0.2355 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=11.4392 mle=2.3187 pcon=8.8851 forget=0.0000 orth=0.2354 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=11.1762 mle=2.0561 pcon=8.8848 forget=0.0000 orth=0.2353 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.9602 mle=1.8410 pcon=8.8840 forget=0.0000 orth=0.2351 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=11.1998 mle=2.0815 pcon=8.8834 forget=0.0000 orth=0.2350 favg=0.0000 nr=98 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=11.2458 mle=2.1286 pcon=8.8823 forget=0.0000 orth=0.2349 favg=0.0000 nr=96 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 31 it 29 total=11.0389 mle=1.9232 pcon=8.8808 forget=0.0000 orth=0.2349 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=11.2886 mle=2.1748 pcon=8.8790 forget=0.0000 orth=0.2348 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=11.1384 mle=2.0253 pcon=8.8785 forget=0.0000 orth=0.2347 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=11.3074 mle=2.1946 pcon=8.8782 forget=0.0000 orth=0.2346 favg=0.0000 nr=101 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=11.2695 mle=2.1584 pcon=8.8765 forget=0.0000 orth=0.2345 favg=0.0000 nr=101 nf=3 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.9585 mle=1.8479 pcon=8.8761 forget=0.0000 orth=0.2345 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=11.2583 mle=2.1481 pcon=8.8758 forget=0.0000 orth=0.2344 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=11.2680 mle=2.1592 pcon=8.8745 forget=0.0000 orth=0.2344 favg=0.0000 nr=92 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 32 it 38 total=11.1322 mle=2.0250 pcon=8.8729 forget=0.0000 orth=0.2343 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=11.0703 mle=1.9641 pcon=8.8720 forget=0.0000 orth=0.2343 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
 94%|█████████▍| 33/35 [05:57<00:21, 10.61s/it] 97%|█████████▋| 34/35 [06:07<00:10, 10.53s/it]100%|██████████| 35/35 [06:18<00:00, 10.65s/it]100%|██████████| 35/35 [06:18<00:00, 10.82s/it]
[loss] ep 32 it 138 total=11.0956 mle=1.9902 pcon=8.8713 forget=0.0000 orth=0.2342 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=11.2528 mle=2.1485 pcon=8.8702 forget=0.0000 orth=0.2342 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.9632 mle=1.8600 pcon=8.8692 forget=0.0000 orth=0.2341 favg=0.0000 nr=107 nf=1 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=11.0776 mle=1.9749 pcon=8.8686 forget=0.0000 orth=0.2341 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=11.3174 mle=2.2147 pcon=8.8686 forget=0.0000 orth=0.2341 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.9802 mle=1.8782 pcon=8.8679 forget=0.0000 orth=0.2340 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 33 it 47 total=11.2805 mle=2.1790 pcon=8.8674 forget=0.0000 orth=0.2340 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=11.2811 mle=2.1800 pcon=8.8671 forget=0.0000 orth=0.2340 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=11.1678 mle=2.0675 pcon=8.8664 forget=0.0000 orth=0.2340 favg=0.0000 nr=105 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.9457 mle=1.8461 pcon=8.8656 forget=0.0000 orth=0.2340 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=11.0494 mle=1.9507 pcon=8.8647 forget=0.0000 orth=0.2339 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=11.2108 mle=2.1135 pcon=8.8634 forget=0.0000 orth=0.2339 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=11.2962 mle=2.1987 pcon=8.8636 forget=0.0000 orth=0.2339 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 34 it 6 total=11.3150 mle=2.2184 pcon=8.8626 forget=0.0000 orth=0.2339 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=11.0298 mle=1.9338 pcon=8.8620 forget=0.0000 orth=0.2339 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=11.0349 mle=1.9401 pcon=8.8609 forget=0.0000 orth=0.2339 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=11.1169 mle=2.0237 pcon=8.8593 forget=0.0000 orth=0.2339 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.9763 mle=1.8833 pcon=8.8591 forget=0.0000 orth=0.2339 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=11.1427 mle=2.0503 pcon=8.8585 forget=0.0000 orth=0.2339 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=11.0987 mle=2.0068 pcon=8.8579 forget=0.0000 orth=0.2339 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=11.2540 mle=2.1627 pcon=8.8574 forget=0.0000 orth=0.2339 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e35-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:38,  1.78it/s]  2%|▏         | 7/391 [00:00<00:28, 13.43it/s]  4%|▍         | 17/391 [00:00<00:11, 32.19it/s]  7%|▋         | 27/391 [00:00<00:07, 47.49it/s]  9%|▉         | 37/391 [00:00<00:05, 59.69it/s] 12%|█▏        | 47/391 [00:01<00:04, 69.34it/s] 15%|█▍        | 57/391 [00:01<00:04, 75.71it/s] 17%|█▋        | 67/391 [00:01<00:03, 81.28it/s] 20%|█▉        | 77/391 [00:01<00:03, 85.49it/s] 22%|██▏       | 87/391 [00:01<00:03, 88.61it/s] 25%|██▍       | 97/391 [00:01<00:03, 90.24it/s] 27%|██▋       | 107/391 [00:01<00:03, 91.88it/s] 30%|██▉       | 117/391 [00:01<00:02, 93.22it/s] 32%|███▏      | 127/391 [00:01<00:02, 93.99it/s] 35%|███▌      | 137/391 [00:02<00:02, 94.51it/s] 38%|███▊      | 147/391 [00:02<00:02, 94.71it/s] 40%|████      | 157/391 [00:02<00:02, 94.09it/s] 43%|████▎     | 167/391 [00:02<00:02, 94.62it/s] 45%|████▌     | 177/391 [00:02<00:02, 94.64it/s] 48%|████▊     | 187/391 [00:02<00:02, 94.07it/s] 50%|█████     | 197/391 [00:02<00:02, 94.38it/s] 53%|█████▎    | 207/391 [00:02<00:01, 94.69it/s] 55%|█████▌    | 217/391 [00:02<00:01, 92.64it/s] 58%|█████▊    | 227/391 [00:02<00:01, 93.08it/s] 61%|██████    | 237/391 [00:03<00:01, 93.84it/s] 63%|██████▎   | 247/391 [00:03<00:01, 94.33it/s] 66%|██████▌   | 257/391 [00:03<00:01, 93.03it/s] 68%|██████▊   | 267/391 [00:03<00:01, 92.81it/s] 71%|███████   | 277/391 [00:03<00:01, 88.06it/s] 73%|███████▎  | 287/391 [00:03<00:01, 89.41it/s] 76%|███████▌  | 297/391 [00:03<00:01, 91.13it/s] 79%|███████▊  | 307/391 [00:03<00:00, 92.45it/s] 81%|████████  | 317/391 [00:03<00:00, 88.33it/s] 84%|████████▎ | 327/391 [00:04<00:00, 90.64it/s] 86%|████████▌ | 337/391 [00:04<00:00, 92.12it/s] 89%|████████▊ | 347/391 [00:04<00:00, 93.01it/s] 91%|█████████▏| 357/391 [00:04<00:00, 93.40it/s] 94%|█████████▍| 367/391 [00:04<00:00, 94.07it/s] 96%|█████████▋| 377/391 [00:04<00:00, 94.45it/s] 99%|█████████▉| 387/391 [00:04<00:00, 95.33it/s]100%|██████████| 391/391 [00:04<00:00, 81.78it/s]
50000 images processed, 4.847104787826538 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.80it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.56it/s] 27%|██▋       | 21/79 [00:00<00:01, 38.55it/s] 39%|███▉      | 31/79 [00:00<00:00, 52.60it/s] 52%|█████▏    | 41/79 [00:00<00:00, 63.69it/s] 65%|██████▍   | 51/79 [00:01<00:00, 72.24it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.58it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.72it/s]100%|██████████| 79/79 [00:01<00:00, 51.26it/s]
10000 images processed, 1.5620639324188232 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:13,  1.52it/s]  5%|▌         | 11/204 [00:00<00:10, 18.70it/s] 10%|█         | 21/204 [00:00<00:05, 34.47it/s] 15%|█▌        | 31/204 [00:00<00:03, 48.04it/s] 20%|██        | 41/204 [00:01<00:02, 59.21it/s] 25%|██▌       | 51/204 [00:01<00:02, 67.87it/s] 30%|██▉       | 61/204 [00:01<00:01, 74.96it/s] 35%|███▍      | 71/204 [00:01<00:01, 79.86it/s] 40%|███▉      | 81/204 [00:01<00:01, 83.70it/s] 45%|████▍     | 91/204 [00:01<00:01, 86.43it/s] 50%|████▉     | 101/204 [00:01<00:01, 88.43it/s] 54%|█████▍    | 111/204 [00:01<00:01, 88.11it/s] 59%|█████▉    | 121/204 [00:01<00:00, 90.00it/s] 64%|██████▍   | 131/204 [00:02<00:00, 91.09it/s] 69%|██████▉   | 141/204 [00:02<00:00, 91.39it/s] 74%|███████▍  | 151/204 [00:02<00:00, 92.21it/s] 79%|███████▉  | 161/204 [00:02<00:00, 92.36it/s] 84%|████████▍ | 171/204 [00:02<00:00, 92.99it/s] 89%|████████▊ | 181/204 [00:02<00:00, 94.06it/s] 94%|█████████▎| 191/204 [00:02<00:00, 94.89it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.47it/s]100%|██████████| 204/204 [00:02<00:00, 71.89it/s]
26032 images processed, 2.8796238899230957 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:54,  1.44it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.09it/s] 22%|██▏       | 17/79 [00:00<00:02, 25.05it/s] 32%|███▏      | 25/79 [00:01<00:01, 36.15it/s] 43%|████▎     | 34/79 [00:01<00:01, 44.58it/s] 56%|█████▌    | 44/79 [00:01<00:00, 56.03it/s] 68%|██████▊   | 54/79 [00:01<00:00, 65.70it/s] 81%|████████  | 64/79 [00:01<00:00, 73.65it/s] 92%|█████████▏| 73/79 [00:01<00:00, 68.39it/s]100%|██████████| 79/79 [00:01<00:00, 46.55it/s]
10000 images processed, 1.726679801940918 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:12,  1.07it/s]  5%|▌         | 4/79 [00:01<00:15,  4.91it/s] 18%|█▊        | 14/79 [00:01<00:03, 19.89it/s] 30%|███       | 24/79 [00:01<00:01, 34.31it/s] 43%|████▎     | 34/79 [00:01<00:00, 47.31it/s] 56%|█████▌    | 44/79 [00:01<00:00, 58.36it/s] 68%|██████▊   | 54/79 [00:01<00:00, 67.59it/s] 81%|████████  | 64/79 [00:01<00:00, 75.11it/s] 94%|█████████▎| 74/79 [00:01<00:00, 80.88it/s]100%|██████████| 79/79 [00:01<00:00, 43.55it/s]
10000 images processed, 1.8364980220794678 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:42,  1.61it/s] 10%|█         | 7/70 [00:00<00:05, 12.37it/s] 19%|█▊        | 13/70 [00:00<00:02, 21.47it/s] 33%|███▎      | 23/70 [00:00<00:01, 38.30it/s] 47%|████▋     | 33/70 [00:01<00:00, 51.74it/s] 61%|██████▏   | 43/70 [00:01<00:00, 63.06it/s] 76%|███████▌  | 53/70 [00:01<00:00, 72.06it/s] 90%|█████████ | 63/70 [00:01<00:00, 78.89it/s]100%|██████████| 70/70 [00:01<00:00, 48.11it/s]
8925 images processed, 1.485769271850586 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:53,  1.22s/it]  4%|▍         | 2/45 [00:01<00:28,  1.49it/s] 27%|██▋       | 12/45 [00:01<00:02, 12.36it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.54it/s] 47%|████▋     | 21/45 [00:02<00:01, 16.04it/s] 60%|██████    | 27/45 [00:02<00:00, 22.61it/s] 69%|██████▉   | 31/45 [00:02<00:00, 24.74it/s] 78%|███████▊  | 35/45 [00:02<00:00, 15.89it/s]100%|██████████| 45/45 [00:02<00:00, 26.26it/s]100%|██████████| 45/45 [00:02<00:00, 15.66it/s]
5640 images processed, 2.924391746520996 seconds used

19.068931102752686
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           6.19  98.57  86.26
places365     67.68  81.28  53.49
LSUN          40.67  89.75  69.25
iSUN          51.43  88.36  71.46
dtd           18.53  95.68  89.64
AVG           36.90  90.73  74.02
[incremental] Overall: 0.6600 New: 0.6580 Old: 0.6607
[incremental] Final(Top-1): 0.6600  Average: 0.7418
5.867152214050293
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:02,  1.25it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.01it/s] 27%|██▋       | 21/79 [00:01<00:01, 30.48it/s] 39%|███▉      | 31/79 [00:01<00:01, 43.66it/s] 52%|█████▏    | 41/79 [00:01<00:00, 55.19it/s] 65%|██████▍   | 51/79 [00:01<00:00, 64.87it/s] 77%|███████▋  | 61/79 [00:01<00:00, 72.94it/s] 90%|████████▉ | 71/79 [00:01<00:00, 79.15it/s]100%|██████████| 79/79 [00:01<00:00, 48.81it/s]
10000 images processed, 1.6421716213226318 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:01<01:24,  1.23s/it] 13%|█▎        | 9/70 [00:01<00:06,  8.99it/s] 27%|██▋       | 19/70 [00:01<00:02, 20.52it/s] 41%|████▏     | 29/70 [00:01<00:01, 32.50it/s] 56%|█████▌    | 39/70 [00:01<00:00, 44.14it/s] 70%|███████   | 49/70 [00:01<00:00, 54.87it/s] 84%|████████▍ | 59/70 [00:01<00:00, 64.34it/s] 99%|█████████▊| 69/70 [00:01<00:00, 72.23it/s]100%|██████████| 70/70 [00:01<00:00, 35.28it/s]
8925 images processed, 2.0173559188842773 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:58,  1.34s/it]  4%|▍         | 2/45 [00:01<00:29,  1.48it/s] 27%|██▋       | 12/45 [00:01<00:02, 12.21it/s] 38%|███▊      | 17/45 [00:01<00:01, 14.20it/s] 47%|████▋     | 21/45 [00:02<00:01, 15.32it/s] 53%|█████▎    | 24/45 [00:02<00:01, 17.11it/s] 73%|███████▎  | 33/45 [00:02<00:00, 18.68it/s] 80%|████████  | 36/45 [00:02<00:00, 18.95it/s] 93%|█████████▎| 42/45 [00:03<00:00, 18.74it/s]100%|██████████| 45/45 [00:03<00:00, 14.03it/s]
5640 images processed, 3.2335147857666016 seconds used

21.143580436706543
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           6.19  98.57  86.26
places365     67.68  81.28  53.49
LSUN          40.67  89.75  69.25
iSUN          51.43  88.36  71.46
dtd           18.53  95.68  89.64
AVG           36.90  90.73  74.02
[incremental] Overall: 0.6600 New: 0.6580 Old: 0.6607
[incremental] Final(Top-1): 0.6600  Average: 0.7418
7.473029851913452
[DEBUG] Parsed: avg_fpr=36.90 avg_auroc=90.73 final_top1=0.6600 average=0.7418
[Result] AVG-AUROC=90.73 AVG-FPR=36.90 Final-Top1=0.6600 Average=0.7418 Score=73.50

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=40 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=40, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/40 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▎         | 1/40 [00:14<09:40, 14.89s/it]  5%|▌         | 2/40 [00:22<06:53, 10.88s/it]  8%|▊         | 3/40 [00:32<06:22, 10.34s/it] 10%|█         | 4/40 [00:41<05:47,  9.65s/it] 12%|█▎        | 5/40 [00:49<05:15,  9.02s/it] 15%|█▌        | 6/40 [00:56<04:48,  8.48s/it][loss] ep 0 it 0 total=8.5895 mle=3.2130 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6441 mle=3.2647 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0878 mle=3.7057 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6783 mle=3.2935 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9792 mle=2.5920 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9918 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4733 mle=4.0810 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4955 mle=3.1007 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5369 mle=3.1399 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2412 mle=2.8416 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7242 mle=3.3223 pcon=5.4019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0962 mle=3.6917 pcon=5.4045 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4460 mle=4.0388 pcon=5.4072 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3582 mle=2.9488 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0700 mle=3.6581 pcon=5.4119 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5544 mle=3.1403 pcon=5.4141 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5078 mle=3.0909 pcon=5.4169 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6320 mle=3.2131 pcon=5.4189 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2432 mle=2.8212 pcon=5.4220 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4328 mle=3.0084 pcon=5.4244 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7379 mle=2.3110 pcon=5.4269 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6783 mle=3.2489 pcon=5.4293 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8372 mle=3.4053 pcon=5.4319 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7151 mle=2.2806 pcon=5.4345 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.3000 mle=2.8638 pcon=5.4362 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4255 mle=2.9875 pcon=5.4380 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1014 mle=2.6614 pcon=5.4399 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9325 mle=2.4909 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6432 mle=2.2006 pcon=5.4427 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6507 mle=2.2065 pcon=5.4442 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6233 mle=2.1786 pcon=5.4447 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6688 mle=2.2232 pcon=5.4456 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6921 mle=2.2454 pcon=5.4467 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6985 mle=2.2507 pcon=5.4478 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7879 mle=2.3395 pcon=5.4484 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4443 mle=1.9940 pcon=5.4503 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4891 mle=2.0371 pcon=5.4521 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4847 mle=2.0300 pcon=5.4548 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9106 mle=2.4538 pcon=5.4568 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4957 mle=2.0364 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 5 it 45 total=7.5991 mle=2.1382 pcon=5.4609 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.5302 mle=2.0670 pcon=5.4632 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.5469 mle=2.0818 pcon=5.4651 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.6397 mle=2.1721 pcon=5.4676 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.6793 mle=2.2098 pcon=5.4696 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.3913 mle=1.9189 pcon=5.4724 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7725 mle=2.2974 pcon=5.4751 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 6 it 4 total=7.6268 mle=2.1494 pcon=5.4775 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.7450 mle=2.2648 pcon=5.4803 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.5333 mle=2.0505 pcon=5.4828 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.3493 mle=1.8647 pcon=5.4845 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.5080 mle=2.0203 pcon=5.4878 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
 18%|█▊        | 7/40 [01:04<04:30,  8.19s/it] 20%|██        | 8/40 [01:12<04:20,  8.14s/it] 22%|██▎       | 9/40 [01:20<04:18,  8.33s/it] 25%|██▌       | 10/40 [01:29<04:09,  8.32s/it] 28%|██▊       | 11/40 [01:37<03:57,  8.18s/it] 30%|███       | 12/40 [01:45<03:49,  8.21s/it] 32%|███▎      | 13/40 [01:52<03:35,  7.99s/it] 35%|███▌      | 14/40 [02:01<03:29,  8.07s/it][loss] ep 6 it 254 total=7.5029 mle=2.0122 pcon=5.4907 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.9122 mle=2.4184 pcon=5.4938 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.4513 mle=1.9542 pcon=5.4972 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 13 total=7.7897 mle=2.2891 pcon=5.5007 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.9125 mle=2.4083 pcon=5.5041 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.7380 mle=2.2304 pcon=5.5076 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.8008 mle=2.2896 pcon=5.5112 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.5631 mle=2.0489 pcon=5.5142 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.6839 mle=2.1655 pcon=5.5184 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.5469 mle=2.0251 pcon=5.5218 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.6892 mle=2.1634 pcon=5.5258 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 22 total=7.6968 mle=2.1676 pcon=5.5292 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.5198 mle=1.9875 pcon=5.5323 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.3988 mle=1.8634 pcon=5.5354 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=7.3097 mle=1.7705 pcon=5.5392 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=7.3353 mle=1.7922 pcon=5.5431 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.5152 mle=1.9686 pcon=5.5466 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=7.5382 mle=1.9884 pcon=5.5498 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=7.7812 mle=2.2276 pcon=5.5536 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 31 total=7.9269 mle=2.3705 pcon=5.5565 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=7.6420 mle=2.0821 pcon=5.5599 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=7.4834 mle=1.9207 pcon=5.5628 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=7.6009 mle=2.0349 pcon=5.5659 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=7.5366 mle=1.9670 pcon=5.5695 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=7.5924 mle=2.0194 pcon=5.5731 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=7.6972 mle=2.1212 pcon=5.5760 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=7.5188 mle=1.9396 pcon=5.5793 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 40 total=7.4385 mle=1.8567 pcon=5.5818 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=7.9046 mle=2.3205 pcon=5.5841 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=7.5866 mle=1.9997 pcon=5.5869 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=7.5869 mle=1.9970 pcon=5.5899 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=7.4324 mle=1.8403 pcon=5.5921 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=7.8545 mle=2.2592 pcon=5.5953 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=7.5763 mle=1.9788 pcon=5.5975 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=7.8366 mle=2.2361 pcon=5.6005 forget=0.0000 orth=0.0000 favg=0.0000 nr=77 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 49 total=7.5662 mle=1.9625 pcon=5.6037 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=7.9001 mle=2.2935 pcon=5.6066 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=7.7699 mle=2.1604 pcon=5.6094 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=7.6115 mle=1.9990 pcon=5.6125 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=7.4136 mle=1.7979 pcon=5.6157 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=7.7317 mle=2.1135 pcon=5.6182 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=7.4544 mle=1.8339 pcon=5.6205 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 8 total=7.8479 mle=2.2249 pcon=5.6230 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=7.6098 mle=1.9844 pcon=5.6254 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=7.8281 mle=2.2000 pcon=5.6281 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=7.5989 mle=1.9680 pcon=5.6309 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=7.6264 mle=1.9930 pcon=5.6334 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=7.9017 mle=2.2656 pcon=5.6361 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=7.7428 mle=2.1047 pcon=5.6381 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=7.7905 mle=2.1498 pcon=5.6407 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 17 total=7.8734 mle=2.2303 pcon=5.6432 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=7.6739 mle=2.0281 pcon=5.6457 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=7.9255 mle=2.2781 pcon=5.6474 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=7.7541 mle=2.1049 pcon=5.6492 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=7.9471 mle=2.2965 pcon=5.6507 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=7.8501 mle=2.1973 pcon=5.6528 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=7.7401 mle=2.0852 pcon=5.6549 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=7.7593 mle=2.1019 pcon=5.6575 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 26 total=7.9674 mle=2.3083 pcon=5.6592 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=7.7010 mle=2.0402 pcon=5.6609 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=7.7289 mle=2.0668 pcon=5.6621 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=7.8704 mle=2.2069 pcon=5.6636 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
 38%|███▊      | 15/40 [02:08<03:20,  8.00s/it] 40%|████      | 16/40 [02:16<03:10,  7.96s/it] 42%|████▎     | 17/40 [02:24<03:03,  7.98s/it] 45%|████▌     | 18/40 [02:32<02:55,  7.98s/it] 48%|████▊     | 19/40 [02:40<02:46,  7.92s/it] 50%|█████     | 20/40 [02:48<02:40,  8.03s/it] 52%|█████▎    | 21/40 [02:57<02:35,  8.18s/it] 55%|█████▌    | 22/40 [03:06<02:32,  8.46s/it][loss] ep 14 it 226 total=7.6117 mle=1.9462 pcon=5.6655 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=7.8308 mle=2.1631 pcon=5.6677 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=7.7754 mle=2.1061 pcon=5.6693 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=7.5911 mle=1.9202 pcon=5.6709 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 15 it 35 total=7.8053 mle=2.1326 pcon=5.6727 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=7.7868 mle=2.1121 pcon=5.6747 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=7.6455 mle=1.9693 pcon=5.6762 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=7.6453 mle=1.9680 pcon=5.6773 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=7.8559 mle=2.1778 pcon=5.6781 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=7.7256 mle=2.0460 pcon=5.6796 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=7.9076 mle=2.2269 pcon=5.6807 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=7.6825 mle=2.0002 pcon=5.6823 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 44 total=7.8749 mle=2.1916 pcon=5.6832 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=7.8324 mle=2.1477 pcon=5.6847 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=7.7353 mle=2.0496 pcon=5.6857 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=7.7350 mle=2.0483 pcon=5.6867 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=7.6663 mle=1.9783 pcon=5.6880 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=7.5871 mle=1.8982 pcon=5.6889 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=7.7515 mle=2.0623 pcon=5.6892 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 3 total=7.4740 mle=1.7835 pcon=5.6905 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=7.5356 mle=1.8441 pcon=5.6914 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=7.7223 mle=2.0299 pcon=5.6924 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=7.5305 mle=1.8369 pcon=5.6936 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=7.6364 mle=1.9421 pcon=5.6943 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=7.7521 mle=2.0575 pcon=5.6946 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=7.6386 mle=1.9436 pcon=5.6950 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=7.6482 mle=1.9527 pcon=5.6955 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 12 total=7.6781 mle=1.9821 pcon=5.6960 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=7.9786 mle=2.2826 pcon=5.6959 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=7.6336 mle=1.9374 pcon=5.6962 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=7.7747 mle=2.0783 pcon=5.6964 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=7.8413 mle=2.1446 pcon=5.6968 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=7.6892 mle=1.9924 pcon=5.6968 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=7.6193 mle=1.9222 pcon=5.6971 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=7.5018 mle=1.8045 pcon=5.6973 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 21 total=7.6692 mle=1.9715 pcon=5.6977 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=7.7324 mle=2.0345 pcon=5.6979 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=7.6601 mle=1.9625 pcon=5.6976 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=7.7262 mle=2.0283 pcon=5.6979 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=7.7402 mle=2.0420 pcon=5.6982 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=7.9062 mle=2.2080 pcon=5.6983 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=7.8266 mle=2.1281 pcon=5.6985 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=7.7577 mle=2.0594 pcon=5.6983 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 30 total=7.8461 mle=2.1476 pcon=5.6985 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=7.6118 mle=1.9129 pcon=5.6989 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=7.7698 mle=2.0711 pcon=5.6987 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=7.8298 mle=2.1302 pcon=5.6996 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=7.5284 mle=1.8290 pcon=5.6993 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=7.7758 mle=2.0777 pcon=5.6980 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=8.0103 mle=2.3120 pcon=5.6983 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=7.9463 mle=2.2476 pcon=5.6987 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 39 total=7.7768 mle=2.0792 pcon=5.6976 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=7.5723 mle=1.8745 pcon=5.6978 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=7.7144 mle=2.0169 pcon=5.6974 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=7.5478 mle=1.8504 pcon=5.6974 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=7.8787 mle=2.1821 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=7.6305 mle=1.9341 pcon=5.6964 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=7.6513 mle=1.9548 pcon=5.6965 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=7.8896 mle=2.1934 pcon=5.6962 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 48 total=7.8491 mle=2.1530 pcon=5.6961 forget=0.0000 orth=0.0000 favg=0.0000 nr=115 nf=13 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=7.7294 mle=2.0337 pcon=5.6957 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=7.7224 mle=2.0267 pcon=5.6957 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
 57%|█████▊    | 23/40 [03:14<02:19,  8.18s/it] 60%|██████    | 24/40 [03:22<02:12,  8.29s/it] 62%|██████▎   | 25/40 [03:30<02:04,  8.31s/it] 65%|██████▌   | 26/40 [03:39<01:55,  8.28s/it] 68%|██████▊   | 27/40 [03:47<01:49,  8.41s/it] 70%|███████   | 28/40 [03:56<01:41,  8.42s/it] 72%|███████▎  | 29/40 [04:04<01:31,  8.31s/it] 75%|███████▌  | 30/40 [04:12<01:23,  8.33s/it][loss] ep 22 it 198 total=7.6355 mle=1.9394 pcon=5.6961 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=7.7928 mle=2.0967 pcon=5.6961 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=7.7827 mle=2.0876 pcon=5.6951 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=7.8759 mle=2.1812 pcon=5.6946 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 7 total=7.7590 mle=2.0651 pcon=5.6939 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=7.7823 mle=2.0885 pcon=5.6938 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=7.4757 mle=1.7820 pcon=5.6937 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=8.0425 mle=2.3500 pcon=5.6925 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=7.8162 mle=2.1237 pcon=5.6925 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=7.7850 mle=2.0927 pcon=5.6923 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=7.7741 mle=2.0821 pcon=5.6920 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=7.6338 mle=1.9429 pcon=5.6910 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 16 total=7.8570 mle=2.1674 pcon=5.6897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=7.6531 mle=1.9638 pcon=5.6893 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=7.8737 mle=2.1846 pcon=5.6892 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=7.8092 mle=2.1211 pcon=5.6881 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=7.5688 mle=1.8816 pcon=5.6871 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=7.7040 mle=2.0178 pcon=5.6862 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=7.7072 mle=2.0210 pcon=5.6862 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=8.0214 mle=2.3355 pcon=5.6859 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 25 it 25 total=7.5414 mle=1.8563 pcon=5.6852 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=7.6793 mle=1.9938 pcon=5.6855 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=7.9613 mle=2.2768 pcon=5.6844 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=7.7258 mle=2.0420 pcon=5.6839 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=7.5218 mle=1.8388 pcon=5.6830 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=7.8820 mle=2.1997 pcon=5.6823 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=7.6452 mle=1.9632 pcon=5.6819 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=7.7838 mle=2.1034 pcon=5.6804 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 34 total=7.5660 mle=1.8857 pcon=5.6803 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=7.8032 mle=2.1240 pcon=5.6792 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=7.7319 mle=2.0528 pcon=5.6791 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=7.7681 mle=2.0900 pcon=5.6781 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=7.6063 mle=1.9284 pcon=5.6780 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=7.8095 mle=2.1320 pcon=5.6775 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=7.7334 mle=2.0570 pcon=5.6764 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=7.6132 mle=1.9369 pcon=5.6763 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 43 total=7.8874 mle=2.2114 pcon=5.6761 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=7.7607 mle=2.0852 pcon=5.6756 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=7.8130 mle=2.1377 pcon=5.6753 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=7.7087 mle=2.0341 pcon=5.6745 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=7.7582 mle=2.0842 pcon=5.6740 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=7.6337 mle=1.9601 pcon=5.6736 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=7.4491 mle=1.7764 pcon=5.6727 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 2 total=7.5643 mle=1.8929 pcon=5.6714 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=7.8773 mle=2.2065 pcon=5.6708 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=7.6659 mle=1.9963 pcon=5.6696 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=7.8971 mle=2.2279 pcon=5.6692 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=7.7648 mle=2.0967 pcon=5.6681 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=7.7524 mle=2.0850 pcon=5.6675 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=7.4239 mle=1.7566 pcon=5.6673 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=7.5539 mle=1.8877 pcon=5.6662 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 11 total=7.5610 mle=1.8953 pcon=5.6657 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=7.7783 mle=2.1129 pcon=5.6653 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=7.9504 mle=2.2859 pcon=5.6645 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=7.5450 mle=1.8811 pcon=5.6639 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=7.7926 mle=2.1294 pcon=5.6632 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=7.7019 mle=2.0388 pcon=5.6631 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=7.6514 mle=1.9888 pcon=5.6626 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=7.9709 mle=2.3088 pcon=5.6621 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 20 total=7.6435 mle=1.9820 pcon=5.6615 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=7.8180 mle=2.1574 pcon=5.6606 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=7.5510 mle=1.8914 pcon=5.6596 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
 78%|███████▊  | 31/40 [04:20<01:14,  8.23s/it] 80%|████████  | 32/40 [04:29<01:08,  8.50s/it] 82%|████████▎ | 33/40 [04:38<00:59,  8.53s/it] 85%|████████▌ | 34/40 [04:46<00:50,  8.44s/it] 88%|████████▊ | 35/40 [04:55<00:43,  8.60s/it] 90%|█████████ | 36/40 [05:03<00:33,  8.48s/it] 92%|█████████▎| 37/40 [05:12<00:25,  8.40s/it] 95%|█████████▌| 38/40 [05:20<00:17,  8.53s/it][loss] ep 30 it 170 total=7.9491 mle=2.2903 pcon=5.6588 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=7.8075 mle=2.1488 pcon=5.6587 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=7.5046 mle=1.8465 pcon=5.6580 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=7.7113 mle=2.0536 pcon=5.6577 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=7.7809 mle=2.1239 pcon=5.6570 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 29 total=7.5196 mle=1.8626 pcon=5.6570 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=7.8233 mle=2.1669 pcon=5.6565 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=7.6515 mle=1.9957 pcon=5.6558 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=7.7921 mle=2.1361 pcon=5.6560 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=7.7285 mle=2.0735 pcon=5.6550 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=7.5284 mle=1.8747 pcon=5.6536 forget=0.0000 orth=0.0000 favg=0.0000 nr=127 nf=1 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=7.7792 mle=2.1262 pcon=5.6530 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=7.8920 mle=2.2404 pcon=5.6516 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 32 it 38 total=7.6916 mle=2.0408 pcon=5.6508 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=7.6152 mle=1.9651 pcon=5.6502 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=7.6397 mle=1.9900 pcon=5.6497 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=7.7732 mle=2.1241 pcon=5.6491 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=7.5291 mle=1.8806 pcon=5.6484 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=7.6098 mle=1.9620 pcon=5.6477 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=7.8165 mle=2.1685 pcon=5.6480 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=7.4835 mle=1.8357 pcon=5.6478 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 33 it 47 total=7.8866 mle=2.2396 pcon=5.6470 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=7.8138 mle=2.1676 pcon=5.6462 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=7.6753 mle=2.0294 pcon=5.6459 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=7.4422 mle=1.7970 pcon=5.6452 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=7.5972 mle=1.9522 pcon=5.6450 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=7.7784 mle=2.1340 pcon=5.6444 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=7.9273 mle=2.2838 pcon=5.6436 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 6 total=7.8545 mle=2.2109 pcon=5.6436 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=7.5356 mle=1.8924 pcon=5.6433 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=7.5281 mle=1.8849 pcon=5.6432 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=7.6957 mle=2.0531 pcon=5.6425 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=7.5624 mle=1.9199 pcon=5.6425 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=7.5989 mle=1.9568 pcon=5.6421 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=7.6209 mle=1.9798 pcon=5.6411 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=7.8070 mle=2.1669 pcon=5.6401 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 15 total=7.5612 mle=1.9221 pcon=5.6392 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=7.6827 mle=2.0435 pcon=5.6393 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=7.7388 mle=2.0993 pcon=5.6396 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=7.8696 mle=2.2301 pcon=5.6394 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=7.7891 mle=2.1500 pcon=5.6390 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=7.7013 mle=2.0621 pcon=5.6392 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=7.7407 mle=2.1021 pcon=5.6386 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=7.7903 mle=2.1520 pcon=5.6382 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 24 total=7.8391 mle=2.2011 pcon=5.6380 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=7.5876 mle=1.9505 pcon=5.6371 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=7.2892 mle=1.6527 pcon=5.6365 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=7.6859 mle=2.0504 pcon=5.6355 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=7.5536 mle=1.9190 pcon=5.6346 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=7.6842 mle=2.0493 pcon=5.6350 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=7.7727 mle=2.1378 pcon=5.6349 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=7.7088 mle=2.0737 pcon=5.6351 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=7.6669 mle=2.0315 pcon=5.6354 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=7.7637 mle=2.1284 pcon=5.6353 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=7.6029 mle=1.9678 pcon=5.6351 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=7.6480 mle=2.0135 pcon=5.6344 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=7.4032 mle=1.7689 pcon=5.6343 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=7.9535 mle=2.3201 pcon=5.6334 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=7.9179 mle=2.2845 pcon=5.6334 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=7.5802 mle=1.9474 pcon=5.6328 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 42 total=7.7758 mle=2.1437 pcon=5.6321 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=7.9426 mle=2.3111 pcon=5.6315 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
 98%|█████████▊| 39/40 [05:29<00:08,  8.56s/it]100%|██████████| 40/40 [05:38<00:00,  8.73s/it]100%|██████████| 40/40 [05:38<00:00,  8.47s/it]
[loss] ep 38 it 142 total=7.4891 mle=1.8586 pcon=5.6305 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=7.4650 mle=1.8343 pcon=5.6308 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=7.7260 mle=2.0956 pcon=5.6304 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=7.7693 mle=2.1394 pcon=5.6299 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=7.4508 mle=1.8214 pcon=5.6294 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 1 total=7.8792 mle=2.2497 pcon=5.6295 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=7.5473 mle=1.9178 pcon=5.6295 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=7.7820 mle=2.1514 pcon=5.6306 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=7.6653 mle=2.0351 pcon=5.6303 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=7.7602 mle=2.1301 pcon=5.6301 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=7.5639 mle=1.9339 pcon=5.6300 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=7.6039 mle=1.9739 pcon=5.6301 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=7.7260 mle=2.0962 pcon=5.6298 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<05:19,  1.22it/s]  3%|▎         | 11/391 [00:00<00:24, 15.65it/s]  5%|▌         | 21/391 [00:01<00:12, 29.82it/s]  8%|▊         | 31/391 [00:01<00:08, 43.04it/s] 10%|█         | 41/391 [00:01<00:06, 54.74it/s] 13%|█▎        | 51/391 [00:01<00:05, 64.60it/s] 16%|█▌        | 61/391 [00:01<00:04, 72.47it/s] 18%|█▊        | 71/391 [00:01<00:04, 78.69it/s] 21%|██        | 81/391 [00:01<00:03, 82.80it/s] 23%|██▎       | 91/391 [00:01<00:03, 86.38it/s] 26%|██▌       | 101/391 [00:01<00:03, 89.00it/s] 28%|██▊       | 111/391 [00:01<00:03, 90.88it/s] 31%|███       | 121/391 [00:02<00:02, 91.70it/s] 34%|███▎      | 131/391 [00:02<00:02, 92.69it/s] 36%|███▌      | 141/391 [00:02<00:02, 93.43it/s] 39%|███▊      | 151/391 [00:02<00:02, 93.68it/s] 41%|████      | 161/391 [00:02<00:02, 94.16it/s] 44%|████▎     | 171/391 [00:02<00:02, 94.37it/s] 46%|████▋     | 181/391 [00:02<00:02, 94.45it/s] 49%|████▉     | 191/391 [00:02<00:02, 94.46it/s] 51%|█████▏    | 201/391 [00:02<00:02, 94.51it/s] 54%|█████▍    | 211/391 [00:03<00:01, 94.11it/s] 57%|█████▋    | 221/391 [00:03<00:01, 94.26it/s] 59%|█████▉    | 231/391 [00:03<00:01, 94.79it/s] 62%|██████▏   | 241/391 [00:03<00:01, 94.45it/s] 64%|██████▍   | 251/391 [00:03<00:01, 94.68it/s] 67%|██████▋   | 261/391 [00:03<00:01, 94.46it/s] 69%|██████▉   | 271/391 [00:03<00:01, 91.58it/s] 72%|███████▏  | 281/391 [00:03<00:01, 87.88it/s] 74%|███████▍  | 291/391 [00:03<00:01, 90.13it/s] 77%|███████▋  | 301/391 [00:04<00:00, 90.96it/s] 80%|███████▉  | 311/391 [00:04<00:00, 91.55it/s] 82%|████████▏ | 321/391 [00:04<00:00, 92.72it/s] 85%|████████▍ | 331/391 [00:04<00:00, 92.18it/s] 87%|████████▋ | 341/391 [00:04<00:00, 93.13it/s] 90%|████████▉ | 351/391 [00:04<00:00, 93.76it/s] 92%|█████████▏| 361/391 [00:04<00:00, 93.41it/s] 95%|█████████▍| 371/391 [00:04<00:00, 94.59it/s] 97%|█████████▋| 381/391 [00:04<00:00, 95.48it/s]100%|██████████| 391/391 [00:04<00:00, 93.84it/s]100%|██████████| 391/391 [00:04<00:00, 78.50it/s]
50000 images processed, 5.017596960067749 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.91it/s] 14%|█▍        | 11/79 [00:00<00:03, 22.60it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.07it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.01it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.17it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.87it/s] 76%|███████▌  | 60/79 [00:01<00:00, 72.12it/s] 87%|████████▋ | 69/79 [00:01<00:00, 70.92it/s]100%|██████████| 79/79 [00:01<00:00, 74.68it/s]100%|██████████| 79/79 [00:01<00:00, 54.98it/s]
10000 images processed, 1.4498710632324219 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:49,  1.86it/s]  3%|▎         | 7/204 [00:00<00:14, 13.86it/s]  8%|▊         | 17/204 [00:00<00:05, 32.56it/s] 13%|█▎        | 27/204 [00:00<00:03, 47.75it/s] 18%|█▊        | 37/204 [00:00<00:02, 59.82it/s] 22%|██▏       | 45/204 [00:01<00:02, 64.04it/s] 27%|██▋       | 55/204 [00:01<00:02, 72.09it/s] 32%|███▏      | 65/204 [00:01<00:01, 77.64it/s] 37%|███▋      | 75/204 [00:01<00:01, 82.06it/s] 42%|████▏     | 85/204 [00:01<00:01, 85.26it/s] 47%|████▋     | 95/204 [00:01<00:01, 87.90it/s] 51%|█████▏    | 105/204 [00:01<00:01, 89.52it/s] 56%|█████▋    | 115/204 [00:01<00:00, 90.74it/s] 61%|██████▏   | 125/204 [00:01<00:00, 91.65it/s] 66%|██████▌   | 135/204 [00:02<00:00, 92.27it/s] 71%|███████   | 145/204 [00:02<00:00, 92.91it/s] 76%|███████▌  | 155/204 [00:02<00:00, 93.50it/s] 81%|████████  | 165/204 [00:02<00:00, 93.95it/s] 86%|████████▌ | 175/204 [00:02<00:00, 92.37it/s] 91%|█████████ | 185/204 [00:02<00:00, 93.64it/s] 96%|█████████▌| 195/204 [00:02<00:00, 90.59it/s]100%|██████████| 204/204 [00:02<00:00, 73.00it/s]
26032 images processed, 2.8407437801361084 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:05,  1.20it/s] 14%|█▍        | 11/79 [00:00<00:04, 15.49it/s] 25%|██▌       | 20/79 [00:01<00:02, 28.17it/s] 38%|███▊      | 30/79 [00:01<00:01, 41.46it/s] 51%|█████     | 40/79 [00:01<00:00, 53.36it/s] 62%|██████▏   | 49/79 [00:01<00:00, 53.70it/s] 75%|███████▍  | 59/79 [00:01<00:00, 63.49it/s] 86%|████████▌ | 68/79 [00:01<00:00, 58.41it/s] 99%|█████████▊| 78/79 [00:01<00:00, 67.10it/s]100%|██████████| 79/79 [00:01<00:00, 43.43it/s]
10000 images processed, 1.839604377746582 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:01,  1.27it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.17it/s] 27%|██▋       | 21/79 [00:01<00:01, 30.75it/s] 39%|███▉      | 31/79 [00:01<00:01, 44.16it/s] 52%|█████▏    | 41/79 [00:01<00:00, 55.53it/s] 65%|██████▍   | 51/79 [00:01<00:00, 65.04it/s] 77%|███████▋  | 61/79 [00:01<00:00, 73.13it/s] 90%|████████▉ | 71/79 [00:01<00:00, 79.43it/s]100%|██████████| 79/79 [00:01<00:00, 49.13it/s]
10000 images processed, 1.631019115447998 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:46,  1.49it/s]  7%|▋         | 5/70 [00:00<00:07,  8.22it/s] 19%|█▊        | 13/70 [00:00<00:02, 22.30it/s] 33%|███▎      | 23/70 [00:00<00:01, 38.80it/s] 47%|████▋     | 33/70 [00:01<00:00, 52.61it/s] 61%|██████▏   | 43/70 [00:01<00:00, 63.69it/s] 76%|███████▌  | 53/70 [00:01<00:00, 72.46it/s] 90%|█████████ | 63/70 [00:01<00:00, 79.10it/s]100%|██████████| 70/70 [00:01<00:00, 47.17it/s]
8925 images processed, 1.5181872844696045 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:58,  1.33s/it]  7%|▋         | 3/45 [00:01<00:16,  2.62it/s] 22%|██▏       | 10/45 [00:01<00:03, 10.71it/s] 31%|███       | 14/45 [00:01<00:02, 14.59it/s] 40%|████      | 18/45 [00:02<00:02, 13.17it/s] 51%|█████     | 23/45 [00:02<00:01, 16.62it/s] 67%|██████▋   | 30/45 [00:02<00:00, 19.69it/s] 73%|███████▎  | 33/45 [00:02<00:00, 15.31it/s] 80%|████████  | 36/45 [00:03<00:00, 14.10it/s]100%|██████████| 45/45 [00:03<00:00, 24.31it/s]100%|██████████| 45/45 [00:03<00:00, 14.10it/s]
5640 images processed, 3.220104932785034 seconds used

19.345120429992676
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.60
places365     49.95  89.49  51.36
LSUN          25.94  95.19  76.04
iSUN          26.01  95.03  73.73
dtd           24.68  94.43  71.73
AVG           26.03  94.63  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
3.1114649772644043
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=40, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/40 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▎         | 1/40 [00:18<11:54, 18.33s/it]  5%|▌         | 2/40 [00:29<08:47, 13.88s/it]  8%|▊         | 3/40 [00:40<07:47, 12.65s/it] 10%|█         | 4/40 [00:51<07:18, 12.19s/it] 12%|█▎        | 5/40 [01:03<07:01, 12.03s/it] 15%|█▌        | 6/40 [01:14<06:36, 11.66s/it][loss] ep 0 it 0 total=12.0912 mle=2.3149 pcon=8.7277 forget=0.0000 orth=1.0486 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0669 mle=2.2865 pcon=8.7319 forget=0.0000 orth=1.0485 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2134 mle=2.4297 pcon=8.7353 forget=0.0000 orth=1.0484 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1216 mle=2.3347 pcon=8.7388 forget=0.0000 orth=1.0482 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7748 mle=1.9851 pcon=8.7418 forget=0.0000 orth=1.0480 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=11.9869 mle=2.1949 pcon=8.7444 forget=0.0000 orth=1.0477 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4181 mle=2.6241 pcon=8.7466 forget=0.0000 orth=1.0474 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9927 mle=2.1973 pcon=8.7483 forget=0.0000 orth=1.0471 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9501 mle=2.1530 pcon=8.7504 forget=0.0000 orth=1.0467 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9376 mle=2.1390 pcon=8.7523 forget=0.0000 orth=1.0463 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0894 mle=2.2895 pcon=8.7540 forget=0.0000 orth=1.0459 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3273 mle=2.5262 pcon=8.7557 forget=0.0000 orth=1.0454 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2576 mle=2.4557 pcon=8.7568 forget=0.0000 orth=1.0450 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.8904 mle=2.0880 pcon=8.7579 forget=0.0000 orth=1.0445 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.1924 mle=2.3894 pcon=8.7591 forget=0.0000 orth=1.0439 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0806 mle=2.2770 pcon=8.7603 forget=0.0000 orth=1.0433 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0149 mle=2.2114 pcon=8.7609 forget=0.0000 orth=1.0425 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0751 mle=2.2712 pcon=8.7622 forget=0.0000 orth=1.0418 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9127 mle=2.1079 pcon=8.7636 forget=0.0000 orth=1.0411 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9621 mle=2.1571 pcon=8.7647 forget=0.0000 orth=1.0403 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5837 mle=1.7782 pcon=8.7659 forget=0.0000 orth=1.0396 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1267 mle=2.3213 pcon=8.7666 forget=0.0000 orth=1.0388 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1815 mle=2.3762 pcon=8.7674 forget=0.0000 orth=1.0379 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6933 mle=1.8875 pcon=8.7688 forget=0.0000 orth=1.0370 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0750 mle=2.2698 pcon=8.7692 forget=0.0000 orth=1.0360 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1936 mle=2.3885 pcon=8.7702 forget=0.0000 orth=1.0349 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1312 mle=2.3263 pcon=8.7710 forget=0.0000 orth=1.0339 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0203 mle=2.2152 pcon=8.7722 forget=0.0000 orth=1.0329 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9361 mle=2.1308 pcon=8.7735 forget=0.0000 orth=1.0318 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9652 mle=2.1601 pcon=8.7745 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9500 mle=2.1454 pcon=8.7753 forget=0.0000 orth=1.0293 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.0059 mle=2.2018 pcon=8.7760 forget=0.0000 orth=1.0281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0138 mle=2.2095 pcon=8.7775 forget=0.0000 orth=1.0268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0256 mle=2.2212 pcon=8.7786 forget=0.0000 orth=1.0259 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1450 mle=2.3407 pcon=8.7796 forget=0.0000 orth=1.0247 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8310 mle=2.0272 pcon=8.7804 forget=0.0000 orth=1.0234 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8796 mle=2.0765 pcon=8.7811 forget=0.0000 orth=1.0219 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8366 mle=2.0335 pcon=8.7825 forget=0.0000 orth=1.0206 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1786 mle=2.3754 pcon=8.7836 forget=0.0000 orth=1.0196 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.8034 mle=2.0001 pcon=8.7850 forget=0.0000 orth=1.0184 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 5 it 45 total=11.9764 mle=2.1738 pcon=8.7855 forget=0.0000 orth=1.0170 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=11.8751 mle=2.0729 pcon=8.7868 forget=0.0000 orth=1.0154 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=11.9057 mle=2.1041 pcon=8.7875 forget=0.0000 orth=1.0142 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=11.9911 mle=2.1894 pcon=8.7890 forget=0.0000 orth=1.0127 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.0464 mle=2.2448 pcon=8.7902 forget=0.0000 orth=1.0114 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=11.7279 mle=1.9258 pcon=8.7921 forget=0.0000 orth=1.0100 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.1235 mle=2.3212 pcon=8.7938 forget=0.0000 orth=1.0086 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 6 it 4 total=11.9788 mle=2.1771 pcon=8.7944 forget=0.0000 orth=1.0074 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.0671 mle=2.2649 pcon=8.7961 forget=0.0000 orth=1.0061 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.8458 mle=2.0432 pcon=8.7980 forget=0.0000 orth=1.0046 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.6712 mle=1.8694 pcon=8.7986 forget=0.0000 orth=1.0032 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
 18%|█▊        | 7/40 [01:25<06:17, 11.43s/it] 20%|██        | 8/40 [01:36<05:57, 11.17s/it] 22%|██▎       | 9/40 [01:46<05:41, 11.01s/it] 25%|██▌       | 10/40 [01:57<05:27, 10.92s/it] 28%|██▊       | 11/40 [02:08<05:14, 10.83s/it] 30%|███       | 12/40 [02:18<05:03, 10.85s/it][loss] ep 6 it 204 total=11.8447 mle=2.0434 pcon=8.7997 forget=0.0000 orth=1.0016 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.8536 mle=2.0525 pcon=8.8008 forget=0.0000 orth=1.0003 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2113 mle=2.4096 pcon=8.8026 forget=0.0000 orth=0.9991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.7711 mle=1.9694 pcon=8.8040 forget=0.0000 orth=0.9977 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 7 it 13 total=12.1376 mle=2.3355 pcon=8.8056 forget=0.0000 orth=0.9965 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2205 mle=2.4181 pcon=8.8072 forget=0.0000 orth=0.9952 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0889 mle=2.2864 pcon=8.8088 forget=0.0000 orth=0.9937 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1133 mle=2.3101 pcon=8.8108 forget=0.0000 orth=0.9924 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9121 mle=2.1096 pcon=8.8113 forget=0.0000 orth=0.9911 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9888 mle=2.1854 pcon=8.8136 forget=0.0000 orth=0.9898 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8656 mle=2.0617 pcon=8.8155 forget=0.0000 orth=0.9885 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0132 mle=2.2089 pcon=8.8173 forget=0.0000 orth=0.9870 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 8 it 22 total=11.9794 mle=2.1751 pcon=8.8183 forget=0.0000 orth=0.9860 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8126 mle=2.0083 pcon=8.8198 forget=0.0000 orth=0.9845 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7031 mle=1.8990 pcon=8.8210 forget=0.0000 orth=0.9831 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5988 mle=1.7946 pcon=8.8225 forget=0.0000 orth=0.9818 favg=0.0000 nr=124 nf=1 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6302 mle=1.8258 pcon=8.8241 forget=0.0000 orth=0.9803 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.7915 mle=1.9876 pcon=8.8249 forget=0.0000 orth=0.9791 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8221 mle=2.0181 pcon=8.8263 forget=0.0000 orth=0.9777 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0348 mle=2.2300 pcon=8.8286 forget=0.0000 orth=0.9763 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 9 it 31 total=12.1877 mle=2.3829 pcon=8.8300 forget=0.0000 orth=0.9748 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9306 mle=2.1261 pcon=8.8310 forget=0.0000 orth=0.9736 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7378 mle=1.9342 pcon=8.8317 forget=0.0000 orth=0.9719 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8459 mle=2.0425 pcon=8.8325 forget=0.0000 orth=0.9709 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7760 mle=1.9716 pcon=8.8353 forget=0.0000 orth=0.9691 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8322 mle=2.0280 pcon=8.8368 forget=0.0000 orth=0.9674 favg=0.0000 nr=122 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9323 mle=2.1280 pcon=8.8388 forget=0.0000 orth=0.9656 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7591 mle=1.9545 pcon=8.8403 forget=0.0000 orth=0.9642 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 10 it 40 total=11.6746 mle=1.8699 pcon=8.8420 forget=0.0000 orth=0.9627 favg=0.0000 nr=123 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.1513 mle=2.3474 pcon=8.8428 forget=0.0000 orth=0.9611 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.8340 mle=2.0297 pcon=8.8450 forget=0.0000 orth=0.9593 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.8001 mle=1.9961 pcon=8.8467 forget=0.0000 orth=0.9574 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6463 mle=1.8434 pcon=8.8471 forget=0.0000 orth=0.9559 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0893 mle=2.2863 pcon=8.8493 forget=0.0000 orth=0.9537 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.7920 mle=1.9903 pcon=8.8500 forget=0.0000 orth=0.9517 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.0291 mle=2.2285 pcon=8.8510 forget=0.0000 orth=0.9495 favg=0.0000 nr=74 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 11 it 49 total=11.7758 mle=1.9756 pcon=8.8528 forget=0.0000 orth=0.9474 favg=0.0000 nr=117 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.0825 mle=2.2831 pcon=8.8540 forget=0.0000 orth=0.9454 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.9658 mle=2.1680 pcon=8.8548 forget=0.0000 orth=0.9429 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.8129 mle=2.0165 pcon=8.8558 forget=0.0000 orth=0.9407 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.6012 mle=1.8059 pcon=8.8571 forget=0.0000 orth=0.9382 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.9101 mle=2.1167 pcon=8.8579 forget=0.0000 orth=0.9355 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.6425 mle=1.8506 pcon=8.8591 forget=0.0000 orth=0.9328 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 12 it 8 total=11.9882 mle=2.1974 pcon=8.8607 forget=0.0000 orth=0.9301 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.7793 mle=1.9911 pcon=8.8614 forget=0.0000 orth=0.9268 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.9804 mle=2.1944 pcon=8.8623 forget=0.0000 orth=0.9237 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.7484 mle=1.9647 pcon=8.8633 forget=0.0000 orth=0.9204 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.7780 mle=1.9969 pcon=8.8644 forget=0.0000 orth=0.9167 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.0684 mle=2.2893 pcon=8.8661 forget=0.0000 orth=0.9131 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8769 mle=2.1015 pcon=8.8663 forget=0.0000 orth=0.9092 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9353 mle=2.1626 pcon=8.8675 forget=0.0000 orth=0.9052 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
 32%|███▎      | 13/40 [02:29<04:49, 10.71s/it] 35%|███▌      | 14/40 [02:40<04:39, 10.73s/it] 38%|███▊      | 15/40 [02:50<04:25, 10.63s/it] 40%|████      | 16/40 [03:01<04:14, 10.60s/it] 42%|████▎     | 17/40 [03:11<04:01, 10.49s/it] 45%|████▌     | 18/40 [03:22<03:55, 10.68s/it] 48%|████▊     | 19/40 [03:32<03:40, 10.51s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 13 it 17 total=11.9963 mle=2.2264 pcon=8.8691 forget=0.0000 orth=0.9008 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.7768 mle=2.0103 pcon=8.8700 forget=0.0000 orth=0.8965 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.0293 mle=2.2667 pcon=8.8707 forget=0.0000 orth=0.8919 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.8686 mle=2.1112 pcon=8.8703 forget=0.0000 orth=0.8872 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.0426 mle=2.2898 pcon=8.8706 forget=0.0000 orth=0.8821 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.9467 mle=2.1992 pcon=8.8706 forget=0.0000 orth=0.8769 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.8334 mle=2.0906 pcon=8.8714 forget=0.0000 orth=0.8714 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.8520 mle=2.1148 pcon=8.8713 forget=0.0000 orth=0.8658 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 14 it 26 total=12.0199 mle=2.2885 pcon=8.8714 forget=0.0000 orth=0.8599 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.7293 mle=2.0041 pcon=8.8712 forget=0.0000 orth=0.8540 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.7795 mle=2.0602 pcon=8.8716 forget=0.0000 orth=0.8477 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.9243 mle=2.2139 pcon=8.8690 forget=0.0000 orth=0.8413 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.6289 mle=1.9256 pcon=8.8685 forget=0.0000 orth=0.8348 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.8450 mle=2.1489 pcon=8.8680 forget=0.0000 orth=0.8281 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.7717 mle=2.0829 pcon=8.8677 forget=0.0000 orth=0.8212 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.5834 mle=1.9029 pcon=8.8665 forget=0.0000 orth=0.8140 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 15 it 35 total=11.7604 mle=2.0881 pcon=8.8657 forget=0.0000 orth=0.8066 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.7441 mle=2.0801 pcon=8.8648 forget=0.0000 orth=0.7992 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.6146 mle=1.9591 pcon=8.8637 forget=0.0000 orth=0.7918 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.6124 mle=1.9662 pcon=8.8622 forget=0.0000 orth=0.7840 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.8202 mle=2.1834 pcon=8.8606 forget=0.0000 orth=0.7761 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.6603 mle=2.0323 pcon=8.8598 forget=0.0000 orth=0.7681 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.8162 mle=2.1988 pcon=8.8574 forget=0.0000 orth=0.7600 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.6028 mle=1.9950 pcon=8.8562 forget=0.0000 orth=0.7516 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 16 it 44 total=11.7191 mle=2.1218 pcon=8.8541 forget=0.0000 orth=0.7432 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.7534 mle=2.1658 pcon=8.8530 forget=0.0000 orth=0.7346 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.5671 mle=1.9900 pcon=8.8510 forget=0.0000 orth=0.7261 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.5819 mle=2.0157 pcon=8.8488 forget=0.0000 orth=0.7174 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.4986 mle=1.9433 pcon=8.8469 forget=0.0000 orth=0.7084 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.4050 mle=1.8610 pcon=8.8445 forget=0.0000 orth=0.6994 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.5594 mle=2.0266 pcon=8.8425 forget=0.0000 orth=0.6904 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 17 it 3 total=11.3038 mle=1.7818 pcon=8.8408 forget=0.0000 orth=0.6812 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.3294 mle=1.8191 pcon=8.8385 forget=0.0000 orth=0.6719 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.4920 mle=1.9925 pcon=8.8370 forget=0.0000 orth=0.6625 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.3439 mle=1.8546 pcon=8.8363 forget=0.0000 orth=0.6530 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.3938 mle=1.9164 pcon=8.8338 forget=0.0000 orth=0.6436 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.4812 mle=2.0149 pcon=8.8322 forget=0.0000 orth=0.6340 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.3700 mle=1.9163 pcon=8.8293 forget=0.0000 orth=0.6244 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.4352 mle=1.9948 pcon=8.8257 forget=0.0000 orth=0.6147 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 18 it 12 total=11.3630 mle=1.9348 pcon=8.8232 forget=0.0000 orth=0.6049 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.6511 mle=2.2362 pcon=8.8198 forget=0.0000 orth=0.5951 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.3149 mle=1.9119 pcon=8.8177 forget=0.0000 orth=0.5853 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.5097 mle=2.1202 pcon=8.8139 forget=0.0000 orth=0.5755 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.4857 mle=2.1086 pcon=8.8114 forget=0.0000 orth=0.5657 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.3311 mle=1.9671 pcon=8.8081 forget=0.0000 orth=0.5559 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.2840 mle=1.9331 pcon=8.8048 forget=0.0000 orth=0.5462 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.1881 mle=1.8500 pcon=8.8017 forget=0.0000 orth=0.5363 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 19 it 21 total=11.2620 mle=1.9356 pcon=8.7999 forget=0.0000 orth=0.5266 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.3470 mle=2.0338 pcon=8.7966 forget=0.0000 orth=0.5167 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
 50%|█████     | 20/40 [03:42<03:25, 10.27s/it] 52%|█████▎    | 21/40 [03:53<03:20, 10.58s/it] 55%|█████▌    | 22/40 [04:04<03:11, 10.62s/it] 57%|█████▊    | 23/40 [04:14<02:58, 10.50s/it] 60%|██████    | 24/40 [04:24<02:46, 10.40s/it] 62%|██████▎   | 25/40 [04:34<02:32, 10.20s/it][loss] ep 19 it 121 total=11.2191 mle=1.9180 pcon=8.7942 forget=0.0000 orth=0.5069 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.3009 mle=2.0116 pcon=8.7920 forget=0.0000 orth=0.4973 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.2781 mle=2.0003 pcon=8.7901 forget=0.0000 orth=0.4877 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.3557 mle=2.0910 pcon=8.7866 forget=0.0000 orth=0.4781 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.3171 mle=2.0645 pcon=8.7840 forget=0.0000 orth=0.4686 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.2909 mle=2.0505 pcon=8.7812 forget=0.0000 orth=0.4592 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 20 it 30 total=11.3573 mle=2.1290 pcon=8.7785 forget=0.0000 orth=0.4499 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.1482 mle=1.9324 pcon=8.7752 forget=0.0000 orth=0.4406 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.2656 mle=2.0617 pcon=8.7723 forget=0.0000 orth=0.4315 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.2923 mle=2.1002 pcon=8.7697 forget=0.0000 orth=0.4224 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=10.9819 mle=1.8026 pcon=8.7660 forget=0.0000 orth=0.4133 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.1832 mle=2.0163 pcon=8.7624 forget=0.0000 orth=0.4045 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.4166 mle=2.2618 pcon=8.7591 forget=0.0000 orth=0.3957 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.2635 mle=2.1192 pcon=8.7572 forget=0.0000 orth=0.3871 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 21 it 39 total=11.1752 mle=2.0439 pcon=8.7527 forget=0.0000 orth=0.3786 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=10.9645 mle=1.8446 pcon=8.7497 forget=0.0000 orth=0.3702 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.1322 mle=2.0236 pcon=8.7467 forget=0.0000 orth=0.3619 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=10.9543 mle=1.8572 pcon=8.7434 forget=0.0000 orth=0.3538 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.2346 mle=2.1488 pcon=8.7400 forget=0.0000 orth=0.3458 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=10.9620 mle=1.8872 pcon=8.7369 forget=0.0000 orth=0.3379 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.0017 mle=1.9376 pcon=8.7339 forget=0.0000 orth=0.3302 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.1524 mle=2.0995 pcon=8.7301 forget=0.0000 orth=0.3228 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 22 it 48 total=11.1422 mle=2.0997 pcon=8.7271 forget=0.0000 orth=0.3153 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=10.9946 mle=1.9625 pcon=8.7240 forget=0.0000 orth=0.3081 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.0123 mle=1.9898 pcon=8.7216 forget=0.0000 orth=0.3009 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=10.9096 mle=1.8962 pcon=8.7196 forget=0.0000 orth=0.2938 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.0523 mle=2.0485 pcon=8.7169 forget=0.0000 orth=0.2869 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.0182 mle=2.0245 pcon=8.7134 forget=0.0000 orth=0.2802 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.1693 mle=2.1857 pcon=8.7100 forget=0.0000 orth=0.2736 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 23 it 7 total=10.9905 mle=2.0179 pcon=8.7054 forget=0.0000 orth=0.2672 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.0103 mle=2.0474 pcon=8.7020 forget=0.0000 orth=0.2609 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.7126 mle=1.7596 pcon=8.6981 forget=0.0000 orth=0.2548 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.2329 mle=2.2892 pcon=8.6950 forget=0.0000 orth=0.2488 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=10.9937 mle=2.0589 pcon=8.6919 forget=0.0000 orth=0.2429 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=10.9589 mle=2.0332 pcon=8.6885 forget=0.0000 orth=0.2372 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=10.9813 mle=2.0650 pcon=8.6846 forget=0.0000 orth=0.2318 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=10.8409 mle=1.9333 pcon=8.6811 forget=0.0000 orth=0.2264 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 24 it 16 total=11.0010 mle=2.1021 pcon=8.6778 forget=0.0000 orth=0.2211 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=10.8175 mle=1.9265 pcon=8.6750 forget=0.0000 orth=0.2160 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.0464 mle=2.1637 pcon=8.6717 forget=0.0000 orth=0.2110 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=10.9902 mle=2.1163 pcon=8.6677 forget=0.0000 orth=0.2061 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=10.7629 mle=1.8979 pcon=8.6637 forget=0.0000 orth=0.2014 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=10.8254 mle=1.9675 pcon=8.6610 forget=0.0000 orth=0.1969 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=10.8236 mle=1.9734 pcon=8.6578 forget=0.0000 orth=0.1924 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.1183 mle=2.2760 pcon=8.6542 forget=0.0000 orth=0.1881 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 25 it 25 total=10.7059 mle=1.8717 pcon=8.6504 forget=0.0000 orth=0.1838 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=10.7888 mle=1.9620 pcon=8.6471 forget=0.0000 orth=0.1797 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.0898 mle=2.2714 pcon=8.6427 forget=0.0000 orth=0.1757 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=10.8379 mle=2.0272 pcon=8.6387 forget=0.0000 orth=0.1720 favg=0.0000 nr=112 nf=10 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=10.6024 mle=1.7985 pcon=8.6356 forget=0.0000 orth=0.1683 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=10.8940 mle=2.0969 pcon=8.6325 forget=0.0000 orth=0.1646 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
 65%|██████▌   | 26/40 [04:44<02:22, 10.21s/it] 68%|██████▊   | 27/40 [04:54<02:11, 10.13s/it] 70%|███████   | 28/40 [05:04<02:01, 10.16s/it] 72%|███████▎  | 29/40 [05:15<01:53, 10.36s/it] 75%|███████▌  | 30/40 [05:25<01:43, 10.32s/it] 78%|███████▊  | 31/40 [05:35<01:30, 10.06s/it] 80%|████████  | 32/40 [05:45<01:20, 10.06s/it][loss] ep 25 it 325 total=10.6803 mle=1.8897 pcon=8.6295 forget=0.0000 orth=0.1610 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=10.8727 mle=2.0901 pcon=8.6250 forget=0.0000 orth=0.1577 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 26 it 34 total=10.6215 mle=1.8461 pcon=8.6211 forget=0.0000 orth=0.1543 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=10.8587 mle=2.0899 pcon=8.6177 forget=0.0000 orth=0.1511 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=10.7727 mle=2.0097 pcon=8.6150 forget=0.0000 orth=0.1480 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=10.8149 mle=2.0588 pcon=8.6111 forget=0.0000 orth=0.1450 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=10.6580 mle=1.9086 pcon=8.6074 forget=0.0000 orth=0.1420 favg=0.0000 nr=124 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=10.8856 mle=2.1425 pcon=8.6039 forget=0.0000 orth=0.1392 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=10.7755 mle=2.0383 pcon=8.6007 forget=0.0000 orth=0.1365 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=10.6168 mle=1.8849 pcon=8.5980 forget=0.0000 orth=0.1339 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 27 it 43 total=10.8484 mle=2.1226 pcon=8.5945 forget=0.0000 orth=0.1313 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=10.7488 mle=2.0284 pcon=8.5915 forget=0.0000 orth=0.1288 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=10.8475 mle=2.1320 pcon=8.5890 forget=0.0000 orth=0.1264 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=10.7347 mle=2.0251 pcon=8.5855 forget=0.0000 orth=0.1241 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=10.6614 mle=1.9578 pcon=8.5817 forget=0.0000 orth=0.1218 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=10.6779 mle=1.9804 pcon=8.5778 forget=0.0000 orth=0.1197 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.4932 mle=1.8011 pcon=8.5745 forget=0.0000 orth=0.1176 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 28 it 2 total=10.5432 mle=1.8569 pcon=8.5708 forget=0.0000 orth=0.1155 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=10.8351 mle=2.1546 pcon=8.5669 forget=0.0000 orth=0.1136 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=10.6694 mle=1.9941 pcon=8.5635 forget=0.0000 orth=0.1117 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=10.8817 mle=2.2110 pcon=8.5609 forget=0.0000 orth=0.1099 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=10.7475 mle=2.0821 pcon=8.5573 forget=0.0000 orth=0.1081 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=10.7157 mle=2.0552 pcon=8.5541 forget=0.0000 orth=0.1064 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.4264 mle=1.7705 pcon=8.5511 forget=0.0000 orth=0.1047 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=10.6025 mle=1.9523 pcon=8.5472 forget=0.0000 orth=0.1031 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 29 it 11 total=10.4982 mle=1.8539 pcon=8.5428 forget=0.0000 orth=0.1015 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=10.7165 mle=2.0755 pcon=8.5410 forget=0.0000 orth=0.1000 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=10.8625 mle=2.2255 pcon=8.5384 forget=0.0000 orth=0.0986 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.5856 mle=1.9528 pcon=8.5356 forget=0.0000 orth=0.0972 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=10.8104 mle=2.1824 pcon=8.5321 forget=0.0000 orth=0.0959 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=10.6959 mle=2.0712 pcon=8.5301 forget=0.0000 orth=0.0946 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=10.5596 mle=1.9390 pcon=8.5272 forget=0.0000 orth=0.0933 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=10.9149 mle=2.2991 pcon=8.5237 forget=0.0000 orth=0.0921 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 30 it 20 total=10.5292 mle=1.9179 pcon=8.5204 forget=0.0000 orth=0.0909 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=10.7227 mle=2.1159 pcon=8.5171 forget=0.0000 orth=0.0898 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.4729 mle=1.8701 pcon=8.5141 forget=0.0000 orth=0.0887 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=10.9339 mle=2.3345 pcon=8.5117 forget=0.0000 orth=0.0877 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=10.6517 mle=2.0563 pcon=8.5088 forget=0.0000 orth=0.0866 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.4207 mle=1.8290 pcon=8.5061 forget=0.0000 orth=0.0856 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=10.6143 mle=2.0262 pcon=8.5034 forget=0.0000 orth=0.0847 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=10.6829 mle=2.0987 pcon=8.5004 forget=0.0000 orth=0.0838 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 31 it 29 total=10.4931 mle=1.9123 pcon=8.4979 forget=0.0000 orth=0.0829 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=10.6962 mle=2.1198 pcon=8.4944 forget=0.0000 orth=0.0820 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=10.5488 mle=1.9758 pcon=8.4918 forget=0.0000 orth=0.0812 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=10.7505 mle=2.1810 pcon=8.4891 forget=0.0000 orth=0.0804 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=10.6621 mle=2.0967 pcon=8.4857 forget=0.0000 orth=0.0797 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.3937 mle=1.8317 pcon=8.4831 forget=0.0000 orth=0.0789 favg=0.0000 nr=118 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=10.6651 mle=2.1062 pcon=8.4807 forget=0.0000 orth=0.0782 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=10.7524 mle=2.1974 pcon=8.4775 forget=0.0000 orth=0.0775 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
 82%|████████▎ | 33/40 [05:55<01:10, 10.03s/it] 85%|████████▌ | 34/40 [06:06<01:01, 10.29s/it] 88%|████████▊ | 35/40 [06:17<00:52, 10.53s/it] 90%|█████████ | 36/40 [06:27<00:41, 10.47s/it] 92%|█████████▎| 37/40 [06:37<00:31, 10.35s/it] 95%|█████████▌| 38/40 [06:48<00:21, 10.56s/it][loss] ep 32 it 38 total=10.5317 mle=1.9797 pcon=8.4751 forget=0.0000 orth=0.0769 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.5212 mle=1.9726 pcon=8.4724 forget=0.0000 orth=0.0763 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=10.5280 mle=1.9826 pcon=8.4698 forget=0.0000 orth=0.0757 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=10.6838 mle=2.1417 pcon=8.4671 forget=0.0000 orth=0.0751 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.3486 mle=1.8101 pcon=8.4639 forget=0.0000 orth=0.0745 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=10.4695 mle=1.9336 pcon=8.4620 forget=0.0000 orth=0.0740 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=10.7340 mle=2.2001 pcon=8.4604 forget=0.0000 orth=0.0735 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.3453 mle=1.8147 pcon=8.4577 forget=0.0000 orth=0.0730 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 33 it 47 total=10.6927 mle=2.1658 pcon=8.4544 forget=0.0000 orth=0.0725 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=10.6658 mle=2.1416 pcon=8.4522 forget=0.0000 orth=0.0720 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=10.6128 mle=2.0919 pcon=8.4493 forget=0.0000 orth=0.0716 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.3136 mle=1.7959 pcon=8.4466 forget=0.0000 orth=0.0712 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.4211 mle=1.9064 pcon=8.4439 forget=0.0000 orth=0.0708 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=10.6164 mle=2.1047 pcon=8.4413 forget=0.0000 orth=0.0704 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=10.7458 mle=2.2357 pcon=8.4400 forget=0.0000 orth=0.0700 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 34 it 6 total=10.7072 mle=2.1997 pcon=8.4378 forget=0.0000 orth=0.0697 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.3971 mle=1.8924 pcon=8.4353 forget=0.0000 orth=0.0693 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.3934 mle=1.8911 pcon=8.4332 forget=0.0000 orth=0.0690 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=10.5405 mle=2.0417 pcon=8.4301 forget=0.0000 orth=0.0687 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.3508 mle=1.8540 pcon=8.4284 forget=0.0000 orth=0.0684 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=10.4653 mle=1.9714 pcon=8.4258 forget=0.0000 orth=0.0682 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.4582 mle=1.9665 pcon=8.4237 forget=0.0000 orth=0.0679 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=10.6122 mle=2.1233 pcon=8.4213 forget=0.0000 orth=0.0676 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 35 it 15 total=10.4553 mle=1.9692 pcon=8.4187 forget=0.0000 orth=0.0674 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=10.5402 mle=2.0568 pcon=8.4162 forget=0.0000 orth=0.0672 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=10.6151 mle=2.1331 pcon=8.4150 forget=0.0000 orth=0.0670 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=10.6765 mle=2.1964 pcon=8.4134 forget=0.0000 orth=0.0668 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=10.6071 mle=2.1282 pcon=8.4123 forget=0.0000 orth=0.0666 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=10.5402 mle=2.0636 pcon=8.4102 forget=0.0000 orth=0.0664 favg=0.0000 nr=116 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=10.5599 mle=2.0859 pcon=8.4078 forget=0.0000 orth=0.0662 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=10.5450 mle=2.0725 pcon=8.4064 forget=0.0000 orth=0.0661 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 36 it 24 total=10.6248 mle=2.1535 pcon=8.4054 forget=0.0000 orth=0.0659 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=10.4247 mle=1.9566 pcon=8.4023 forget=0.0000 orth=0.0658 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=10.1585 mle=1.6929 pcon=8.3999 forget=0.0000 orth=0.0657 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=10.4678 mle=2.0053 pcon=8.3970 forget=0.0000 orth=0.0655 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=10.4233 mle=1.9635 pcon=8.3944 forget=0.0000 orth=0.0654 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=10.6028 mle=2.1438 pcon=8.3936 forget=0.0000 orth=0.0653 favg=0.0000 nr=115 nf=11 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=10.5634 mle=2.1057 pcon=8.3925 forget=0.0000 orth=0.0652 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=10.4936 mle=2.0372 pcon=8.3913 forget=0.0000 orth=0.0651 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 37 it 33 total=10.4756 mle=2.0207 pcon=8.3899 forget=0.0000 orth=0.0650 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=10.5709 mle=2.1173 pcon=8.3887 forget=0.0000 orth=0.0650 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=10.4226 mle=1.9706 pcon=8.3871 forget=0.0000 orth=0.0649 favg=0.0000 nr=116 nf=2 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=10.4848 mle=2.0349 pcon=8.3851 forget=0.0000 orth=0.0648 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=10.2554 mle=1.8065 pcon=8.3842 forget=0.0000 orth=0.0648 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=10.6966 mle=2.2507 pcon=8.3811 forget=0.0000 orth=0.0647 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=10.7121 mle=2.2676 pcon=8.3798 forget=0.0000 orth=0.0647 favg=0.0000 nr=110 nf=11 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=10.3774 mle=1.9348 pcon=8.3779 forget=0.0000 orth=0.0646 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 38 it 42 total=10.5342 mle=2.0935 pcon=8.3761 forget=0.0000 orth=0.0646 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=10.7336 mle=2.2951 pcon=8.3740 forget=0.0000 orth=0.0645 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=10.3334 mle=1.8963 pcon=8.3726 forget=0.0000 orth=0.0645 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=10.3004 mle=1.8635 pcon=8.3724 forget=0.0000 orth=0.0645 favg=0.0000 nr=122 nf=3 protos=None fproto_sim=NA
 98%|█████████▊| 39/40 [06:59<00:10, 10.55s/it]100%|██████████| 40/40 [07:09<00:00, 10.48s/it]100%|██████████| 40/40 [07:09<00:00, 10.74s/it]
[loss] ep 38 it 242 total=10.4937 mle=2.0585 pcon=8.3707 forget=0.0000 orth=0.0645 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=10.5524 mle=2.1187 pcon=8.3692 forget=0.0000 orth=0.0645 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=10.2699 mle=1.8382 pcon=8.3672 forget=0.0000 orth=0.0644 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 39 it 1 total=10.6361 mle=2.2047 pcon=8.3670 forget=0.0000 orth=0.0644 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=10.3686 mle=1.9394 pcon=8.3648 forget=0.0000 orth=0.0644 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=10.5398 mle=2.1109 pcon=8.3645 forget=0.0000 orth=0.0644 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=10.4214 mle=1.9939 pcon=8.3631 forget=0.0000 orth=0.0644 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=10.5410 mle=2.1151 pcon=8.3615 forget=0.0000 orth=0.0644 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=10.4016 mle=1.9760 pcon=8.3613 forget=0.0000 orth=0.0644 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=10.4170 mle=1.9928 pcon=8.3598 forget=0.0000 orth=0.0644 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=10.5415 mle=2.1193 pcon=8.3578 forget=0.0000 orth=0.0644 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:01<07:57,  1.22s/it]  3%|▎         | 11/391 [00:01<00:34, 11.11it/s]  5%|▌         | 21/391 [00:01<00:16, 22.49it/s]  8%|▊         | 31/391 [00:01<00:10, 34.26it/s] 10%|█         | 41/391 [00:01<00:07, 45.77it/s] 13%|█▎        | 51/391 [00:01<00:06, 55.93it/s] 16%|█▌        | 61/391 [00:01<00:05, 64.85it/s] 18%|█▊        | 71/391 [00:01<00:04, 71.87it/s] 21%|██        | 81/391 [00:02<00:03, 77.55it/s] 23%|██▎       | 91/391 [00:02<00:03, 81.98it/s] 26%|██▌       | 101/391 [00:02<00:03, 85.72it/s] 28%|██▊       | 111/391 [00:02<00:03, 88.65it/s] 31%|███       | 121/391 [00:02<00:02, 90.41it/s] 34%|███▎      | 131/391 [00:02<00:02, 90.14it/s] 36%|███▌      | 141/391 [00:02<00:02, 86.12it/s] 38%|███▊      | 150/391 [00:02<00:02, 84.81it/s] 41%|████      | 160/391 [00:02<00:02, 87.45it/s] 43%|████▎     | 170/391 [00:03<00:02, 89.69it/s] 46%|████▌     | 180/391 [00:03<00:02, 90.95it/s] 49%|████▊     | 190/391 [00:03<00:02, 92.20it/s] 51%|█████     | 200/391 [00:03<00:02, 92.82it/s] 54%|█████▎    | 210/391 [00:03<00:01, 92.81it/s] 56%|█████▋    | 220/391 [00:03<00:01, 93.31it/s] 59%|█████▉    | 230/391 [00:03<00:01, 92.33it/s] 61%|██████▏   | 240/391 [00:03<00:01, 93.10it/s] 64%|██████▍   | 250/391 [00:03<00:01, 93.98it/s] 66%|██████▋   | 260/391 [00:04<00:01, 93.62it/s] 69%|██████▉   | 270/391 [00:04<00:01, 94.14it/s] 72%|███████▏  | 280/391 [00:04<00:01, 94.43it/s] 74%|███████▍  | 290/391 [00:04<00:01, 93.92it/s] 77%|███████▋  | 300/391 [00:04<00:00, 94.62it/s] 79%|███████▉  | 310/391 [00:04<00:00, 94.33it/s] 82%|████████▏ | 320/391 [00:04<00:00, 94.22it/s] 84%|████████▍ | 330/391 [00:04<00:00, 94.33it/s] 87%|████████▋ | 340/391 [00:04<00:00, 88.94it/s] 90%|████████▉ | 350/391 [00:04<00:00, 91.05it/s] 92%|█████████▏| 360/391 [00:05<00:00, 91.42it/s] 95%|█████████▍| 370/391 [00:05<00:00, 92.98it/s] 97%|█████████▋| 380/391 [00:05<00:00, 94.31it/s]100%|█████████▉| 390/391 [00:05<00:00, 95.37it/s]100%|██████████| 391/391 [00:05<00:00, 72.14it/s]
50000 images processed, 5.456528425216675 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.32it/s] 14%|█▍        | 11/79 [00:00<00:02, 26.13it/s] 27%|██▋       | 21/79 [00:00<00:01, 44.37it/s] 39%|███▉      | 31/79 [00:00<00:00, 57.96it/s] 52%|█████▏    | 41/79 [00:00<00:00, 67.42it/s] 65%|██████▍   | 51/79 [00:00<00:00, 75.05it/s] 77%|███████▋  | 61/79 [00:01<00:00, 81.07it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.49it/s]100%|██████████| 79/79 [00:01<00:00, 61.23it/s]
10000 images processed, 1.3064343929290771 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:01,  1.67it/s]  3%|▎         | 7/204 [00:00<00:15, 12.87it/s]  8%|▊         | 17/204 [00:00<00:06, 31.12it/s] 13%|█▎        | 27/204 [00:00<00:03, 46.36it/s] 18%|█▊        | 36/204 [00:01<00:02, 56.81it/s] 23%|██▎       | 46/204 [00:01<00:02, 66.48it/s] 27%|██▋       | 56/204 [00:01<00:02, 73.83it/s] 32%|███▏      | 65/204 [00:01<00:01, 77.60it/s] 37%|███▋      | 75/204 [00:01<00:01, 82.43it/s] 42%|████▏     | 85/204 [00:01<00:01, 85.48it/s] 47%|████▋     | 95/204 [00:01<00:01, 88.18it/s] 51%|█████▏    | 105/204 [00:01<00:01, 90.23it/s] 56%|█████▋    | 115/204 [00:01<00:00, 91.33it/s] 61%|██████▏   | 125/204 [00:01<00:00, 91.97it/s] 66%|██████▌   | 135/204 [00:02<00:00, 92.05it/s] 71%|███████   | 145/204 [00:02<00:00, 91.49it/s] 76%|███████▌  | 155/204 [00:02<00:00, 92.11it/s] 81%|████████  | 165/204 [00:02<00:00, 92.27it/s] 86%|████████▌ | 175/204 [00:02<00:00, 92.87it/s] 91%|█████████ | 185/204 [00:02<00:00, 91.74it/s] 96%|█████████▌| 195/204 [00:02<00:00, 91.09it/s]100%|██████████| 204/204 [00:02<00:00, 71.01it/s]
26032 images processed, 2.996419906616211 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:01,  1.27it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.27it/s] 27%|██▋       | 21/79 [00:01<00:01, 30.89it/s] 39%|███▉      | 31/79 [00:01<00:01, 44.28it/s] 52%|█████▏    | 41/79 [00:01<00:00, 55.89it/s] 65%|██████▍   | 51/79 [00:01<00:00, 65.49it/s] 76%|███████▌  | 60/79 [00:01<00:00, 70.68it/s] 89%|████████▊ | 70/79 [00:01<00:00, 77.56it/s]100%|██████████| 79/79 [00:01<00:00, 48.98it/s]
10000 images processed, 1.633774757385254 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.11it/s] 14%|█▍        | 11/79 [00:00<00:02, 24.45it/s] 27%|██▋       | 21/79 [00:00<00:01, 42.48it/s] 39%|███▉      | 31/79 [00:00<00:00, 56.51it/s] 52%|█████▏    | 41/79 [00:00<00:00, 67.26it/s] 65%|██████▍   | 51/79 [00:00<00:00, 75.22it/s] 77%|███████▋  | 61/79 [00:01<00:00, 81.20it/s] 90%|████████▉ | 71/79 [00:01<00:00, 85.62it/s]100%|██████████| 79/79 [00:01<00:00, 61.52it/s]
10000 images processed, 1.3121616840362549 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:43,  1.60it/s] 16%|█▌        | 11/70 [00:00<00:03, 19.60it/s] 30%|███       | 21/70 [00:00<00:01, 35.87it/s] 44%|████▍     | 31/70 [00:00<00:00, 49.67it/s] 59%|█████▊    | 41/70 [00:01<00:00, 61.17it/s] 73%|███████▎  | 51/70 [00:01<00:00, 70.40it/s] 87%|████████▋ | 61/70 [00:01<00:00, 77.52it/s]100%|██████████| 70/70 [00:01<00:00, 51.50it/s]
8925 images processed, 1.4014325141906738 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:45,  1.03s/it] 18%|█▊        | 8/45 [00:01<00:03,  9.27it/s] 31%|███       | 14/45 [00:01<00:01, 15.94it/s] 42%|████▏     | 19/45 [00:01<00:01, 14.29it/s] 51%|█████     | 23/45 [00:01<00:01, 16.31it/s] 67%|██████▋   | 30/45 [00:02<00:00, 21.11it/s] 73%|███████▎  | 33/45 [00:02<00:00, 17.57it/s] 96%|█████████▌| 43/45 [00:02<00:00, 29.25it/s]100%|██████████| 45/45 [00:02<00:00, 18.02it/s]
5640 images processed, 2.539247989654541 seconds used

18.322577953338623
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           7.71  98.65  83.06
places365     56.90  86.77  52.89
LSUN          27.03  94.93  76.57
iSUN          45.52  91.97  71.67
dtd           21.65  95.86  84.50
AVG           31.76  93.64  73.74
[incremental] Overall: 0.7520 New: 0.7120 Old: 0.7920
[incremental] Final(Top-1): 0.7520  Average: 0.8000
3.67000150680542
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=40, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/40 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▎         | 1/40 [00:19<12:21, 19.02s/it]  5%|▌         | 2/40 [00:29<08:58, 14.16s/it]  8%|▊         | 3/40 [00:40<07:41, 12.47s/it] 10%|█         | 4/40 [00:50<07:00, 11.68s/it] 12%|█▎        | 5/40 [01:01<06:31, 11.20s/it] 15%|█▌        | 6/40 [01:11<06:15, 11.05s/it][loss] ep 0 it 0 total=15.1622 mle=2.5065 pcon=9.4392 forget=0.0000 orth=3.2165 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=15.1379 mle=2.4815 pcon=9.4415 forget=0.0000 orth=3.2149 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=15.1807 mle=2.5256 pcon=9.4435 forget=0.0000 orth=3.2116 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=14.9885 mle=2.3382 pcon=9.4441 forget=0.0000 orth=3.2062 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=14.7275 mle=2.0845 pcon=9.4445 forget=0.0000 orth=3.1985 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=14.8527 mle=2.2205 pcon=9.4438 forget=0.0000 orth=3.1884 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=15.2003 mle=2.5805 pcon=9.4436 forget=0.0000 orth=3.1762 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=14.8632 mle=2.2595 pcon=9.4422 forget=0.0000 orth=3.1615 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=14.8174 mle=2.2323 pcon=9.4407 forget=0.0000 orth=3.1444 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=14.7820 mle=2.2187 pcon=9.4385 forget=0.0000 orth=3.1248 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=14.8390 mle=2.3000 pcon=9.4363 forget=0.0000 orth=3.1026 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=14.9492 mle=2.4384 pcon=9.4331 forget=0.0000 orth=3.0776 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=14.8547 mle=2.3756 pcon=9.4292 forget=0.0000 orth=3.0498 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=14.4919 mle=2.0472 pcon=9.4254 forget=0.0000 orth=3.0192 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=14.7288 mle=2.3216 pcon=9.4217 forget=0.0000 orth=2.9855 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=14.6724 mle=2.3058 pcon=9.4182 forget=0.0000 orth=2.9484 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=14.4511 mle=2.1282 pcon=9.4146 forget=0.0000 orth=2.9083 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=14.5030 mle=2.2278 pcon=9.4106 forget=0.0000 orth=2.8646 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=14.2263 mle=2.0024 pcon=9.4066 forget=0.0000 orth=2.8174 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=14.3196 mle=2.1503 pcon=9.4028 forget=0.0000 orth=2.7665 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.9461 mle=1.8359 pcon=9.3986 forget=0.0000 orth=2.7117 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=14.3098 mle=2.2626 pcon=9.3939 forget=0.0000 orth=2.6532 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=14.2362 mle=2.2556 pcon=9.3898 forget=0.0000 orth=2.5908 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.7253 mle=1.8147 pcon=9.3861 forget=0.0000 orth=2.5245 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=13.9797 mle=2.1433 pcon=9.3817 forget=0.0000 orth=2.4547 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=14.0096 mle=2.2504 pcon=9.3777 forget=0.0000 orth=2.3815 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.8451 mle=2.1669 pcon=9.3733 forget=0.0000 orth=2.3049 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.6821 mle=2.0876 pcon=9.3689 forget=0.0000 orth=2.2256 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.4976 mle=1.9900 pcon=9.3638 forget=0.0000 orth=2.1438 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.4709 mle=2.0507 pcon=9.3596 forget=0.0000 orth=2.0606 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.3725 mle=2.0420 pcon=9.3544 forget=0.0000 orth=1.9761 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.3176 mle=2.0760 pcon=9.3508 forget=0.0000 orth=1.8908 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=13.2745 mle=2.1224 pcon=9.3464 forget=0.0000 orth=1.8056 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.1764 mle=2.1137 pcon=9.3417 forget=0.0000 orth=1.7211 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.0838 mle=2.1089 pcon=9.3372 forget=0.0000 orth=1.6377 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.8335 mle=1.9439 pcon=9.3329 forget=0.0000 orth=1.5566 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.7430 mle=1.9362 pcon=9.3290 forget=0.0000 orth=1.4778 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.6774 mle=1.9498 pcon=9.3253 forget=0.0000 orth=1.4023 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.9249 mle=2.2734 pcon=9.3216 forget=0.0000 orth=1.3299 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.5320 mle=1.9528 pcon=9.3177 forget=0.0000 orth=1.2615 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 5 it 45 total=12.5818 mle=2.0720 pcon=9.3136 forget=0.0000 orth=1.1962 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.4628 mle=2.0180 pcon=9.3102 forget=0.0000 orth=1.1346 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.3856 mle=2.0027 pcon=9.3058 forget=0.0000 orth=1.0770 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.3840 mle=2.0580 pcon=9.3026 forget=0.0000 orth=1.0234 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.3661 mle=2.0934 pcon=9.2994 forget=0.0000 orth=0.9733 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.0954 mle=1.8730 pcon=9.2958 forget=0.0000 orth=0.9266 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.3637 mle=2.1881 pcon=9.2926 forget=0.0000 orth=0.8830 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 6 it 4 total=12.2051 mle=2.0731 pcon=9.2895 forget=0.0000 orth=0.8426 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.2257 mle=2.1338 pcon=9.2863 forget=0.0000 orth=0.8055 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.9659 mle=1.9116 pcon=9.2832 forget=0.0000 orth=0.7712 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.8112 mle=1.7928 pcon=9.2794 forget=0.0000 orth=0.7390 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
 18%|█▊        | 7/40 [01:22<05:59, 10.89s/it] 20%|██        | 8/40 [01:32<05:43, 10.74s/it] 22%|██▎       | 9/40 [01:43<05:27, 10.58s/it] 25%|██▌       | 10/40 [01:53<05:16, 10.54s/it] 28%|██▊       | 11/40 [02:03<05:02, 10.44s/it] 30%|███       | 12/40 [02:13<04:50, 10.39s/it][loss] ep 6 it 204 total=11.9974 mle=2.0124 pcon=9.2756 forget=0.0000 orth=0.7095 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.9979 mle=2.0438 pcon=9.2720 forget=0.0000 orth=0.6821 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2176 mle=2.2921 pcon=9.2685 forget=0.0000 orth=0.6570 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.8488 mle=1.9496 pcon=9.2654 forget=0.0000 orth=0.6338 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 7 it 13 total=12.0866 mle=2.2122 pcon=9.2623 forget=0.0000 orth=0.6121 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.1821 mle=2.3310 pcon=9.2588 forget=0.0000 orth=0.5923 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0178 mle=2.1890 pcon=9.2554 forget=0.0000 orth=0.5734 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.0498 mle=2.2412 pcon=9.2525 forget=0.0000 orth=0.5562 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.7817 mle=1.9918 pcon=9.2497 forget=0.0000 orth=0.5403 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9645 mle=2.1931 pcon=9.2461 forget=0.0000 orth=0.5253 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.7477 mle=1.9927 pcon=9.2436 forget=0.0000 orth=0.5115 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=11.8871 mle=2.1474 pcon=9.2410 forget=0.0000 orth=0.4987 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 8 it 22 total=11.7950 mle=2.0712 pcon=9.2374 forget=0.0000 orth=0.4864 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.6438 mle=1.9343 pcon=9.2345 forget=0.0000 orth=0.4749 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.5772 mle=1.8816 pcon=9.2314 forget=0.0000 orth=0.4642 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.4326 mle=1.7508 pcon=9.2278 forget=0.0000 orth=0.4540 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.4031 mle=1.7334 pcon=9.2254 forget=0.0000 orth=0.4444 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.6141 mle=1.9570 pcon=9.2219 forget=0.0000 orth=0.4351 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.6750 mle=2.0299 pcon=9.2186 forget=0.0000 orth=0.4265 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=11.7682 mle=2.1345 pcon=9.2152 forget=0.0000 orth=0.4185 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 9 it 31 total=11.8835 mle=2.2609 pcon=9.2118 forget=0.0000 orth=0.4108 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.6533 mle=2.0410 pcon=9.2088 forget=0.0000 orth=0.4034 favg=0.0000 nr=110 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.4979 mle=1.8957 pcon=9.2059 forget=0.0000 orth=0.3963 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.6348 mle=2.0428 pcon=9.2024 forget=0.0000 orth=0.3895 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.4868 mle=1.9030 pcon=9.2003 forget=0.0000 orth=0.3835 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.6128 mle=2.0389 pcon=9.1964 forget=0.0000 orth=0.3776 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.7113 mle=2.1468 pcon=9.1930 forget=0.0000 orth=0.3716 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.4869 mle=1.9314 pcon=9.1898 forget=0.0000 orth=0.3657 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 10 it 40 total=11.4254 mle=1.8781 pcon=9.1868 forget=0.0000 orth=0.3605 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=11.7812 mle=2.2432 pcon=9.1826 forget=0.0000 orth=0.3554 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.4729 mle=1.9426 pcon=9.1798 forget=0.0000 orth=0.3504 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.4862 mle=1.9639 pcon=9.1765 forget=0.0000 orth=0.3458 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.3519 mle=1.8378 pcon=9.1728 forget=0.0000 orth=0.3413 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=11.7871 mle=2.2798 pcon=9.1701 forget=0.0000 orth=0.3372 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.3970 mle=1.8971 pcon=9.1668 forget=0.0000 orth=0.3331 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=11.7081 mle=2.2161 pcon=9.1629 forget=0.0000 orth=0.3291 favg=0.0000 nr=68 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 11 it 49 total=11.4139 mle=1.9292 pcon=9.1595 forget=0.0000 orth=0.3252 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.6582 mle=2.1809 pcon=9.1556 forget=0.0000 orth=0.3217 favg=0.0000 nr=102 nf=11 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.5735 mle=2.1027 pcon=9.1526 forget=0.0000 orth=0.3182 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.4564 mle=1.9930 pcon=9.1486 forget=0.0000 orth=0.3149 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.2181 mle=1.7620 pcon=9.1445 forget=0.0000 orth=0.3116 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.5490 mle=2.1002 pcon=9.1403 forget=0.0000 orth=0.3085 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.3308 mle=1.8883 pcon=9.1369 forget=0.0000 orth=0.3056 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 12 it 8 total=11.5782 mle=2.1424 pcon=9.1333 forget=0.0000 orth=0.3026 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.4007 mle=1.9722 pcon=9.1286 forget=0.0000 orth=0.2999 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.4990 mle=2.0768 pcon=9.1253 forget=0.0000 orth=0.2970 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.3849 mle=1.9690 pcon=9.1215 forget=0.0000 orth=0.2943 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.3301 mle=1.9210 pcon=9.1175 forget=0.0000 orth=0.2917 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.6557 mle=2.2518 pcon=9.1147 forget=0.0000 orth=0.2892 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.5487 mle=2.1514 pcon=9.1107 forget=0.0000 orth=0.2866 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.4594 mle=2.0682 pcon=9.1072 forget=0.0000 orth=0.2841 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
 32%|███▎      | 13/40 [02:24<04:39, 10.37s/it] 35%|███▌      | 14/40 [02:34<04:29, 10.36s/it] 38%|███▊      | 15/40 [02:45<04:21, 10.45s/it] 40%|████      | 16/40 [02:55<04:11, 10.49s/it] 42%|████▎     | 17/40 [03:06<04:00, 10.46s/it] 45%|████▌     | 18/40 [03:16<03:48, 10.40s/it] 48%|████▊     | 19/40 [03:26<03:38, 10.40s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 13 it 17 total=11.5476 mle=2.1618 pcon=9.1038 forget=0.0000 orth=0.2820 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.3022 mle=1.9227 pcon=9.0998 forget=0.0000 orth=0.2797 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.5972 mle=2.2233 pcon=9.0964 forget=0.0000 orth=0.2775 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.4896 mle=2.1215 pcon=9.0925 forget=0.0000 orth=0.2755 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.5562 mle=2.1934 pcon=9.0894 forget=0.0000 orth=0.2734 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.4931 mle=2.1360 pcon=9.0857 forget=0.0000 orth=0.2714 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.3819 mle=2.0312 pcon=9.0813 forget=0.0000 orth=0.2694 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.4603 mle=2.1155 pcon=9.0774 forget=0.0000 orth=0.2674 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 14 it 26 total=11.5714 mle=2.2316 pcon=9.0741 forget=0.0000 orth=0.2656 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.2773 mle=1.9435 pcon=9.0702 forget=0.0000 orth=0.2637 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.3603 mle=2.0319 pcon=9.0664 forget=0.0000 orth=0.2619 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.4627 mle=2.1409 pcon=9.0617 forget=0.0000 orth=0.2602 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.2473 mle=1.9318 pcon=9.0571 forget=0.0000 orth=0.2584 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.4933 mle=2.1837 pcon=9.0528 forget=0.0000 orth=0.2567 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.3641 mle=2.0599 pcon=9.0491 forget=0.0000 orth=0.2552 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.1562 mle=1.8569 pcon=9.0457 forget=0.0000 orth=0.2537 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 15 it 35 total=11.3216 mle=2.0278 pcon=9.0418 forget=0.0000 orth=0.2521 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.3628 mle=2.0736 pcon=9.0386 forget=0.0000 orth=0.2507 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.2255 mle=1.9421 pcon=9.0344 forget=0.0000 orth=0.2491 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.2717 mle=1.9935 pcon=9.0306 forget=0.0000 orth=0.2475 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.4165 mle=2.1434 pcon=9.0270 forget=0.0000 orth=0.2462 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.2623 mle=1.9941 pcon=9.0234 forget=0.0000 orth=0.2448 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.4272 mle=2.1644 pcon=9.0194 forget=0.0000 orth=0.2433 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.2385 mle=1.9807 pcon=9.0157 forget=0.0000 orth=0.2421 favg=0.0000 nr=111 nf=1 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 16 it 44 total=11.4393 mle=2.1854 pcon=9.0129 forget=0.0000 orth=0.2410 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.3991 mle=2.1497 pcon=9.0096 forget=0.0000 orth=0.2398 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.2996 mle=2.0549 pcon=9.0062 forget=0.0000 orth=0.2385 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.2347 mle=1.9951 pcon=9.0023 forget=0.0000 orth=0.2373 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.1617 mle=1.9268 pcon=8.9988 forget=0.0000 orth=0.2361 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.1163 mle=1.8862 pcon=8.9953 forget=0.0000 orth=0.2348 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.2966 mle=2.0709 pcon=8.9920 forget=0.0000 orth=0.2337 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 17 it 3 total=11.0056 mle=1.7841 pcon=8.9889 forget=0.0000 orth=0.2325 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.0297 mle=1.8131 pcon=8.9851 forget=0.0000 orth=0.2315 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.2467 mle=2.0344 pcon=8.9819 forget=0.0000 orth=0.2303 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.0651 mle=1.8572 pcon=8.9787 forget=0.0000 orth=0.2292 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.1278 mle=1.9249 pcon=8.9747 forget=0.0000 orth=0.2282 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.1949 mle=1.9958 pcon=8.9720 forget=0.0000 orth=0.2270 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.0924 mle=1.8973 pcon=8.9691 forget=0.0000 orth=0.2260 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.1639 mle=1.9739 pcon=8.9649 forget=0.0000 orth=0.2250 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 18 it 12 total=11.1836 mle=1.9986 pcon=8.9610 forget=0.0000 orth=0.2240 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.3958 mle=2.2152 pcon=8.9575 forget=0.0000 orth=0.2231 favg=0.0000 nr=110 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.0513 mle=1.8742 pcon=8.9549 forget=0.0000 orth=0.2222 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.2422 mle=2.0702 pcon=8.9507 forget=0.0000 orth=0.2213 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.2521 mle=2.0852 pcon=8.9466 forget=0.0000 orth=0.2203 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.1358 mle=1.9736 pcon=8.9428 forget=0.0000 orth=0.2194 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.1169 mle=1.9588 pcon=8.9396 forget=0.0000 orth=0.2185 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=10.9869 mle=1.8334 pcon=8.9358 forget=0.0000 orth=0.2176 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 19 it 21 total=11.0963 mle=1.9468 pcon=8.9328 forget=0.0000 orth=0.2167 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.2379 mle=2.0931 pcon=8.9289 forget=0.0000 orth=0.2158 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
 50%|█████     | 20/40 [03:37<03:29, 10.45s/it] 52%|█████▎    | 21/40 [03:47<03:16, 10.37s/it] 55%|█████▌    | 22/40 [03:57<03:05, 10.31s/it] 57%|█████▊    | 23/40 [04:07<02:52, 10.16s/it] 60%|██████    | 24/40 [04:18<02:43, 10.24s/it] 62%|██████▎   | 25/40 [04:28<02:32, 10.18s/it][loss] ep 19 it 121 total=11.0235 mle=1.8826 pcon=8.9259 forget=0.0000 orth=0.2150 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.1371 mle=2.0006 pcon=8.9223 forget=0.0000 orth=0.2142 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.1674 mle=2.0345 pcon=8.9195 forget=0.0000 orth=0.2133 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.2092 mle=2.0806 pcon=8.9161 forget=0.0000 orth=0.2126 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.1620 mle=2.0368 pcon=8.9133 forget=0.0000 orth=0.2118 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.1402 mle=2.0184 pcon=8.9108 forget=0.0000 orth=0.2110 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 20 it 30 total=11.2994 mle=2.1810 pcon=8.9082 forget=0.0000 orth=0.2103 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.0084 mle=1.8939 pcon=8.9049 forget=0.0000 orth=0.2096 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.1667 mle=2.0559 pcon=8.9018 forget=0.0000 orth=0.2090 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.1718 mle=2.0647 pcon=8.8989 forget=0.0000 orth=0.2083 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=10.9393 mle=1.8363 pcon=8.8954 forget=0.0000 orth=0.2076 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.0994 mle=2.0007 pcon=8.8918 forget=0.0000 orth=0.2069 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.3415 mle=2.2466 pcon=8.8888 forget=0.0000 orth=0.2061 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.2122 mle=2.1203 pcon=8.8865 forget=0.0000 orth=0.2054 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 21 it 39 total=11.0682 mle=1.9813 pcon=8.8822 forget=0.0000 orth=0.2047 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=10.9752 mle=1.8922 pcon=8.8789 forget=0.0000 orth=0.2041 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.1708 mle=2.0913 pcon=8.8760 forget=0.0000 orth=0.2035 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=10.9973 mle=1.9216 pcon=8.8729 forget=0.0000 orth=0.2028 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.1639 mle=2.0916 pcon=8.8700 forget=0.0000 orth=0.2023 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=10.9441 mle=1.8751 pcon=8.8674 forget=0.0000 orth=0.2016 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.0166 mle=1.9505 pcon=8.8651 forget=0.0000 orth=0.2011 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.2049 mle=2.1434 pcon=8.8611 forget=0.0000 orth=0.2004 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 22 it 48 total=11.1762 mle=2.1178 pcon=8.8585 forget=0.0000 orth=0.1999 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.0255 mle=1.9707 pcon=8.8555 forget=0.0000 orth=0.1993 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.0871 mle=2.0357 pcon=8.8526 forget=0.0000 orth=0.1987 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=10.9804 mle=1.9312 pcon=8.8510 forget=0.0000 orth=0.1982 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.0872 mle=2.0412 pcon=8.8484 forget=0.0000 orth=0.1976 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.0634 mle=2.0205 pcon=8.8458 forget=0.0000 orth=0.1971 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.1699 mle=2.1313 pcon=8.8421 forget=0.0000 orth=0.1966 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 23 it 7 total=10.9815 mle=1.9459 pcon=8.8395 forget=0.0000 orth=0.1960 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.1859 mle=2.1544 pcon=8.8360 forget=0.0000 orth=0.1955 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.8046 mle=1.7765 pcon=8.8331 forget=0.0000 orth=0.1950 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.3045 mle=2.2788 pcon=8.8311 forget=0.0000 orth=0.1946 favg=0.0000 nr=107 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.1183 mle=2.0957 pcon=8.8284 forget=0.0000 orth=0.1941 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.0276 mle=2.0084 pcon=8.8255 forget=0.0000 orth=0.1937 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.1010 mle=2.0857 pcon=8.8220 forget=0.0000 orth=0.1933 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=10.9266 mle=1.9148 pcon=8.8190 forget=0.0000 orth=0.1928 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 24 it 16 total=11.1023 mle=2.0936 pcon=8.8164 forget=0.0000 orth=0.1923 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=10.9384 mle=1.9312 pcon=8.8153 forget=0.0000 orth=0.1919 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.1532 mle=2.1490 pcon=8.8128 forget=0.0000 orth=0.1914 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.1530 mle=2.1523 pcon=8.8098 forget=0.0000 orth=0.1909 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=10.8989 mle=1.9018 pcon=8.8066 forget=0.0000 orth=0.1904 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=10.9705 mle=1.9767 pcon=8.8037 forget=0.0000 orth=0.1901 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=10.9224 mle=1.9313 pcon=8.8014 forget=0.0000 orth=0.1897 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.2380 mle=2.2500 pcon=8.7987 forget=0.0000 orth=0.1892 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 25 it 25 total=10.9409 mle=1.9561 pcon=8.7960 forget=0.0000 orth=0.1888 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=11.0256 mle=2.0434 pcon=8.7938 forget=0.0000 orth=0.1884 favg=0.0000 nr=115 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.2843 mle=2.3062 pcon=8.7902 forget=0.0000 orth=0.1879 favg=0.0000 nr=104 nf=12 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=10.9800 mle=2.0046 pcon=8.7878 forget=0.0000 orth=0.1876 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=10.8515 mle=1.8785 pcon=8.7857 forget=0.0000 orth=0.1872 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.1330 mle=2.1625 pcon=8.7837 forget=0.0000 orth=0.1868 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
 65%|██████▌   | 26/40 [04:39<02:26, 10.44s/it] 68%|██████▊   | 27/40 [04:50<02:18, 10.69s/it] 70%|███████   | 28/40 [05:01<02:09, 10.81s/it] 72%|███████▎  | 29/40 [05:12<01:58, 10.74s/it] 75%|███████▌  | 30/40 [05:22<01:45, 10.59s/it] 78%|███████▊  | 31/40 [05:32<01:34, 10.52s/it] 80%|████████  | 32/40 [05:42<01:22, 10.36s/it][loss] ep 25 it 325 total=10.9138 mle=1.9459 pcon=8.7815 forget=0.0000 orth=0.1865 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=11.0413 mle=2.0758 pcon=8.7793 forget=0.0000 orth=0.1862 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 26 it 34 total=10.8531 mle=1.8903 pcon=8.7770 forget=0.0000 orth=0.1858 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.1168 mle=2.1577 pcon=8.7735 forget=0.0000 orth=0.1855 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=11.0441 mle=2.0870 pcon=8.7719 forget=0.0000 orth=0.1852 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=10.9959 mle=2.0409 pcon=8.7701 forget=0.0000 orth=0.1849 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=10.8981 mle=1.9459 pcon=8.7676 forget=0.0000 orth=0.1845 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=11.0604 mle=2.1115 pcon=8.7646 forget=0.0000 orth=0.1842 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=10.9602 mle=2.0142 pcon=8.7621 forget=0.0000 orth=0.1839 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=10.8672 mle=1.9232 pcon=8.7604 forget=0.0000 orth=0.1836 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 27 it 43 total=11.1040 mle=2.1623 pcon=8.7584 forget=0.0000 orth=0.1833 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=10.9972 mle=2.0572 pcon=8.7570 forget=0.0000 orth=0.1830 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=11.0758 mle=2.1378 pcon=8.7552 forget=0.0000 orth=0.1828 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=10.9395 mle=2.0037 pcon=8.7533 forget=0.0000 orth=0.1825 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=10.9049 mle=1.9714 pcon=8.7513 forget=0.0000 orth=0.1822 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=10.9562 mle=2.0247 pcon=8.7495 forget=0.0000 orth=0.1820 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.7388 mle=1.8103 pcon=8.7468 forget=0.0000 orth=0.1818 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 28 it 2 total=10.7760 mle=1.8495 pcon=8.7450 forget=0.0000 orth=0.1815 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=11.0414 mle=2.1173 pcon=8.7428 forget=0.0000 orth=0.1813 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=10.9908 mle=2.0688 pcon=8.7410 forget=0.0000 orth=0.1810 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.1019 mle=2.1815 pcon=8.7396 forget=0.0000 orth=0.1808 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=11.0566 mle=2.1389 pcon=8.7372 forget=0.0000 orth=0.1805 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=10.9858 mle=2.0702 pcon=8.7353 forget=0.0000 orth=0.1803 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.6942 mle=1.7794 pcon=8.7347 forget=0.0000 orth=0.1801 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=10.9327 mle=2.0201 pcon=8.7328 forget=0.0000 orth=0.1798 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 29 it 11 total=10.7406 mle=1.8311 pcon=8.7300 forget=0.0000 orth=0.1796 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=10.9916 mle=2.0830 pcon=8.7292 forget=0.0000 orth=0.1794 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=11.0762 mle=2.1692 pcon=8.7278 forget=0.0000 orth=0.1792 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.8030 mle=1.8981 pcon=8.7259 forget=0.0000 orth=0.1790 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.1016 mle=2.1993 pcon=8.7235 forget=0.0000 orth=0.1788 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=10.9464 mle=2.0459 pcon=8.7219 forget=0.0000 orth=0.1786 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=10.8475 mle=1.9484 pcon=8.7207 forget=0.0000 orth=0.1784 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.1866 mle=2.2890 pcon=8.7193 forget=0.0000 orth=0.1782 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 30 it 20 total=10.7748 mle=1.8793 pcon=8.7174 forget=0.0000 orth=0.1781 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=11.0653 mle=2.1712 pcon=8.7162 forget=0.0000 orth=0.1779 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.8471 mle=1.9550 pcon=8.7144 forget=0.0000 orth=0.1777 favg=0.0000 nr=116 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=11.2284 mle=2.3379 pcon=8.7129 forget=0.0000 orth=0.1776 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=10.9619 mle=2.0730 pcon=8.7115 forget=0.0000 orth=0.1774 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.7568 mle=1.8693 pcon=8.7102 forget=0.0000 orth=0.1773 favg=0.0000 nr=117 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=10.9307 mle=2.0451 pcon=8.7086 forget=0.0000 orth=0.1771 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=10.9978 mle=2.1137 pcon=8.7071 forget=0.0000 orth=0.1769 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 31 it 29 total=10.8088 mle=1.9265 pcon=8.7055 forget=0.0000 orth=0.1768 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=11.0425 mle=2.1624 pcon=8.7034 forget=0.0000 orth=0.1767 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=10.8830 mle=2.0041 pcon=8.7023 forget=0.0000 orth=0.1765 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=11.0516 mle=2.1744 pcon=8.7008 forget=0.0000 orth=0.1764 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=11.0046 mle=2.1303 pcon=8.6980 forget=0.0000 orth=0.1763 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.7409 mle=1.8680 pcon=8.6968 forget=0.0000 orth=0.1761 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=11.0013 mle=2.1293 pcon=8.6961 forget=0.0000 orth=0.1760 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=10.9913 mle=2.1216 pcon=8.6938 forget=0.0000 orth=0.1759 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
 82%|████████▎ | 33/40 [05:52<01:12, 10.30s/it] 85%|████████▌ | 34/40 [06:03<01:01, 10.27s/it] 88%|████████▊ | 35/40 [06:13<00:51, 10.35s/it] 90%|█████████ | 36/40 [06:23<00:41, 10.28s/it] 92%|█████████▎| 37/40 [06:33<00:30, 10.26s/it] 95%|█████████▌| 38/40 [06:44<00:20, 10.24s/it][loss] ep 32 it 38 total=10.8703 mle=2.0023 pcon=8.6923 forget=0.0000 orth=0.1758 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.8354 mle=1.9695 pcon=8.6903 forget=0.0000 orth=0.1756 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=10.8676 mle=2.0026 pcon=8.6895 forget=0.0000 orth=0.1755 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=11.0314 mle=2.1686 pcon=8.6874 forget=0.0000 orth=0.1754 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.7199 mle=1.8586 pcon=8.6859 forget=0.0000 orth=0.1753 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=10.8445 mle=1.9842 pcon=8.6851 forget=0.0000 orth=0.1752 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=11.0358 mle=2.1765 pcon=8.6842 forget=0.0000 orth=0.1751 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.7261 mle=1.8683 pcon=8.6828 forget=0.0000 orth=0.1750 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 33 it 47 total=11.0556 mle=2.1990 pcon=8.6816 forget=0.0000 orth=0.1750 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=11.0355 mle=2.1799 pcon=8.6807 forget=0.0000 orth=0.1749 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=10.9302 mle=2.0758 pcon=8.6795 forget=0.0000 orth=0.1748 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.6686 mle=1.8158 pcon=8.6781 forget=0.0000 orth=0.1747 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.7709 mle=1.9192 pcon=8.6771 forget=0.0000 orth=0.1746 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=10.9841 mle=2.1345 pcon=8.6751 forget=0.0000 orth=0.1746 favg=0.0000 nr=112 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=11.1075 mle=2.2584 pcon=8.6746 forget=0.0000 orth=0.1745 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 34 it 6 total=11.1149 mle=2.2669 pcon=8.6735 forget=0.0000 orth=0.1744 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.7574 mle=1.9112 pcon=8.6719 forget=0.0000 orth=0.1744 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.7584 mle=1.9133 pcon=8.6708 forget=0.0000 orth=0.1743 favg=0.0000 nr=112 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=10.8568 mle=2.0140 pcon=8.6685 forget=0.0000 orth=0.1743 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.7052 mle=1.8632 pcon=8.6678 forget=0.0000 orth=0.1742 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=10.8653 mle=2.0248 pcon=8.6663 forget=0.0000 orth=0.1742 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.8467 mle=2.0070 pcon=8.6657 forget=0.0000 orth=0.1741 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=11.0162 mle=2.1776 pcon=8.6646 forget=0.0000 orth=0.1740 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 35 it 15 total=10.8913 mle=2.0537 pcon=8.6637 forget=0.0000 orth=0.1740 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=10.9161 mle=2.0799 pcon=8.6622 forget=0.0000 orth=0.1740 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=10.9393 mle=2.1040 pcon=8.6614 forget=0.0000 orth=0.1739 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=11.0066 mle=2.1724 pcon=8.6604 forget=0.0000 orth=0.1739 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=10.9734 mle=2.1396 pcon=8.6599 forget=0.0000 orth=0.1738 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=10.9241 mle=2.0917 pcon=8.6586 forget=0.0000 orth=0.1738 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=10.9235 mle=2.0926 pcon=8.6572 forget=0.0000 orth=0.1738 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=10.8758 mle=2.0450 pcon=8.6570 forget=0.0000 orth=0.1737 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 36 it 24 total=10.9479 mle=2.1173 pcon=8.6570 forget=0.0000 orth=0.1737 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=10.8381 mle=2.0089 pcon=8.6555 forget=0.0000 orth=0.1737 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=10.5898 mle=1.7617 pcon=8.6545 forget=0.0000 orth=0.1736 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=10.8931 mle=2.0658 pcon=8.6537 forget=0.0000 orth=0.1736 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=10.8188 mle=1.9925 pcon=8.6527 forget=0.0000 orth=0.1736 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=10.9803 mle=2.1544 pcon=8.6523 forget=0.0000 orth=0.1736 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=10.9135 mle=2.0880 pcon=8.6519 forget=0.0000 orth=0.1736 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=10.8579 mle=2.0326 pcon=8.6518 forget=0.0000 orth=0.1735 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=10.8365 mle=2.0121 pcon=8.6509 forget=0.0000 orth=0.1735 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=10.9803 mle=2.1565 pcon=8.6503 forget=0.0000 orth=0.1735 favg=0.0000 nr=103 nf=12 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=10.8056 mle=1.9827 pcon=8.6494 forget=0.0000 orth=0.1735 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=10.8881 mle=2.0657 pcon=8.6489 forget=0.0000 orth=0.1735 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=10.6166 mle=1.7939 pcon=8.6493 forget=0.0000 orth=0.1735 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=11.0934 mle=2.2720 pcon=8.6479 forget=0.0000 orth=0.1735 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=11.1433 mle=2.3221 pcon=8.6477 forget=0.0000 orth=0.1734 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=10.7988 mle=1.9789 pcon=8.6465 forget=0.0000 orth=0.1734 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 38 it 42 total=10.8597 mle=2.0405 pcon=8.6458 forget=0.0000 orth=0.1734 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=11.0705 mle=2.2516 pcon=8.6455 forget=0.0000 orth=0.1734 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=10.7555 mle=1.9373 pcon=8.6449 forget=0.0000 orth=0.1734 favg=0.0000 nr=115 nf=2 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=10.6961 mle=1.8786 pcon=8.6441 forget=0.0000 orth=0.1734 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=10.8687 mle=2.0522 pcon=8.6431 forget=0.0000 orth=0.1734 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=10.9170 mle=2.1014 pcon=8.6422 forget=0.0000 orth=0.1734 favg=0.0000 nr=107 nf=3 protos=None fproto_sim=NA
 98%|█████████▊| 39/40 [06:53<00:10, 10.14s/it]100%|██████████| 40/40 [07:04<00:00, 10.16s/it]100%|██████████| 40/40 [07:04<00:00, 10.60s/it]
[loss] ep 38 it 342 total=10.6546 mle=1.8408 pcon=8.6404 forget=0.0000 orth=0.1734 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 39 it 1 total=11.0601 mle=2.2466 pcon=8.6401 forget=0.0000 orth=0.1734 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=10.7556 mle=1.9433 pcon=8.6388 forget=0.0000 orth=0.1734 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=10.9458 mle=2.1333 pcon=8.6391 forget=0.0000 orth=0.1734 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=10.8550 mle=2.0433 pcon=8.6383 forget=0.0000 orth=0.1734 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=10.9289 mle=2.1183 pcon=8.6372 forget=0.0000 orth=0.1734 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=10.8669 mle=2.0563 pcon=8.6372 forget=0.0000 orth=0.1734 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=10.8236 mle=2.0137 pcon=8.6365 forget=0.0000 orth=0.1734 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=10.9785 mle=2.1692 pcon=8.6359 forget=0.0000 orth=0.1734 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:41,  1.39it/s]  3%|▎         | 11/391 [00:00<00:21, 17.54it/s]  5%|▌         | 21/391 [00:00<00:11, 32.88it/s]  8%|▊         | 31/391 [00:01<00:07, 46.37it/s] 10%|█         | 41/391 [00:01<00:06, 57.64it/s] 13%|█▎        | 51/391 [00:01<00:05, 66.57it/s] 16%|█▌        | 61/391 [00:01<00:04, 73.63it/s] 18%|█▊        | 71/391 [00:01<00:04, 79.17it/s] 21%|██        | 81/391 [00:01<00:04, 75.64it/s] 23%|██▎       | 91/391 [00:01<00:03, 80.89it/s] 26%|██▌       | 101/391 [00:01<00:03, 84.74it/s] 28%|██▊       | 111/391 [00:01<00:03, 87.83it/s] 31%|███       | 121/391 [00:02<00:02, 90.23it/s] 34%|███▎      | 131/391 [00:02<00:02, 91.68it/s] 36%|███▌      | 141/391 [00:02<00:02, 92.82it/s] 39%|███▊      | 151/391 [00:02<00:02, 93.58it/s] 41%|████      | 161/391 [00:02<00:02, 94.17it/s] 44%|████▎     | 171/391 [00:02<00:02, 94.59it/s] 46%|████▋     | 181/391 [00:02<00:02, 94.61it/s] 49%|████▉     | 191/391 [00:02<00:02, 94.04it/s] 51%|█████▏    | 201/391 [00:02<00:02, 93.85it/s] 54%|█████▍    | 211/391 [00:02<00:01, 93.89it/s] 57%|█████▋    | 221/391 [00:03<00:01, 94.43it/s] 59%|█████▉    | 231/391 [00:03<00:01, 94.48it/s] 62%|██████▏   | 241/391 [00:03<00:01, 90.78it/s] 64%|██████▍   | 251/391 [00:03<00:01, 92.03it/s] 67%|██████▋   | 261/391 [00:03<00:01, 93.11it/s] 69%|██████▉   | 271/391 [00:03<00:01, 93.96it/s] 72%|███████▏  | 281/391 [00:03<00:01, 94.33it/s] 74%|███████▍  | 291/391 [00:03<00:01, 93.70it/s] 77%|███████▋  | 301/391 [00:03<00:00, 92.19it/s] 80%|███████▉  | 311/391 [00:04<00:00, 86.95it/s] 82%|████████▏ | 321/391 [00:04<00:00, 89.18it/s] 85%|████████▍ | 331/391 [00:04<00:00, 91.06it/s] 87%|████████▋ | 341/391 [00:04<00:00, 92.31it/s] 90%|████████▉ | 351/391 [00:04<00:00, 90.58it/s] 92%|█████████▏| 361/391 [00:04<00:00, 91.69it/s] 95%|█████████▍| 371/391 [00:04<00:00, 93.35it/s] 97%|█████████▋| 381/391 [00:04<00:00, 94.65it/s]100%|██████████| 391/391 [00:04<00:00, 93.29it/s]100%|██████████| 391/391 [00:04<00:00, 79.22it/s]
50000 images processed, 5.010808706283569 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.30it/s] 14%|█▍        | 11/79 [00:00<00:02, 25.80it/s] 27%|██▋       | 21/79 [00:00<00:01, 44.01it/s] 39%|███▉      | 31/79 [00:00<00:00, 57.46it/s] 52%|█████▏    | 41/79 [00:00<00:00, 67.57it/s] 65%|██████▍   | 51/79 [00:00<00:00, 75.39it/s] 77%|███████▋  | 61/79 [00:01<00:00, 81.57it/s] 90%|████████▉ | 71/79 [00:01<00:00, 86.05it/s]100%|██████████| 79/79 [00:01<00:00, 47.42it/s]
10000 images processed, 1.7083420753479004 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:01,  1.68it/s]  4%|▍         | 8/204 [00:00<00:13, 14.81it/s]  8%|▊         | 17/204 [00:00<00:06, 30.90it/s] 13%|█▎        | 27/204 [00:00<00:03, 46.36it/s] 18%|█▊        | 37/204 [00:01<00:02, 58.60it/s] 23%|██▎       | 47/204 [00:01<00:02, 67.55it/s] 27%|██▋       | 56/204 [00:01<00:02, 72.56it/s] 32%|███▏      | 66/204 [00:01<00:01, 78.07it/s] 37%|███▋      | 76/204 [00:01<00:01, 82.44it/s] 42%|████▏     | 85/204 [00:01<00:01, 83.89it/s] 47%|████▋     | 95/204 [00:01<00:01, 86.43it/s] 51%|█████▏    | 105/204 [00:01<00:01, 87.23it/s] 56%|█████▌    | 114/204 [00:01<00:01, 86.01it/s] 60%|██████    | 123/204 [00:01<00:00, 87.00it/s] 65%|██████▌   | 133/204 [00:02<00:00, 89.01it/s] 70%|███████   | 143/204 [00:02<00:00, 90.39it/s] 75%|███████▌  | 153/204 [00:02<00:00, 91.32it/s] 80%|███████▉  | 163/204 [00:02<00:00, 91.87it/s] 85%|████████▍ | 173/204 [00:02<00:00, 86.11it/s] 90%|████████▉ | 183/204 [00:02<00:00, 88.92it/s] 94%|█████████▍| 192/204 [00:02<00:00, 89.00it/s] 99%|█████████▉| 202/204 [00:02<00:00, 91.12it/s]100%|██████████| 204/204 [00:02<00:00, 70.96it/s]
26032 images processed, 2.9217655658721924 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:53,  1.45it/s] 10%|█         | 8/79 [00:00<00:05, 13.15it/s] 23%|██▎       | 18/79 [00:00<00:02, 29.72it/s] 32%|███▏      | 25/79 [00:01<00:01, 34.92it/s] 44%|████▍     | 35/79 [00:01<00:00, 48.52it/s] 54%|█████▍    | 43/79 [00:01<00:00, 54.90it/s] 67%|██████▋   | 53/79 [00:01<00:00, 65.22it/s] 80%|███████▉  | 63/79 [00:01<00:00, 73.15it/s] 92%|█████████▏| 73/79 [00:01<00:00, 79.56it/s]100%|██████████| 79/79 [00:01<00:00, 47.92it/s]
10000 images processed, 1.6728262901306152 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.99it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.41it/s] 27%|██▋       | 21/79 [00:00<00:01, 41.05it/s] 38%|███▊      | 30/79 [00:00<00:00, 52.77it/s] 51%|█████     | 40/79 [00:00<00:00, 64.25it/s] 63%|██████▎   | 50/79 [00:01<00:00, 72.47it/s] 76%|███████▌  | 60/79 [00:01<00:00, 79.30it/s] 89%|████████▊ | 70/79 [00:01<00:00, 78.13it/s]100%|██████████| 79/79 [00:01<00:00, 64.37it/s]100%|██████████| 79/79 [00:01<00:00, 53.94it/s]
10000 images processed, 1.539602279663086 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:47,  1.45it/s] 13%|█▎        | 9/70 [00:00<00:04, 14.69it/s] 27%|██▋       | 19/70 [00:00<00:01, 30.77it/s] 41%|████▏     | 29/70 [00:01<00:00, 44.90it/s] 56%|█████▌    | 39/70 [00:01<00:00, 54.39it/s] 67%|██████▋   | 47/70 [00:01<00:00, 59.88it/s] 81%|████████▏ | 57/70 [00:01<00:00, 69.44it/s] 96%|█████████▌| 67/70 [00:01<00:00, 76.82it/s]100%|██████████| 70/70 [00:01<00:00, 47.08it/s]
8925 images processed, 1.5141942501068115 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:46,  1.05s/it]  4%|▍         | 2/45 [00:01<00:22,  1.91it/s] 24%|██▍       | 11/45 [00:01<00:02, 13.63it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.63it/s] 44%|████▍     | 20/45 [00:01<00:01, 17.30it/s] 56%|█████▌    | 25/45 [00:01<00:00, 22.51it/s] 67%|██████▋   | 30/45 [00:02<00:00, 22.80it/s] 76%|███████▌  | 34/45 [00:02<00:00, 18.59it/s] 98%|█████████▊| 44/45 [00:02<00:00, 25.38it/s]100%|██████████| 45/45 [00:02<00:00, 16.86it/s]
5640 images processed, 2.68927264213562 seconds used

19.08813452720642
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           8.79  98.21  82.35
places365     62.02  82.45  45.79
LSUN          68.75  82.32  51.61
iSUN          58.58  86.78  61.30
dtd           26.10  94.22  83.44
AVG           44.85  88.80  64.90
[incremental] Overall: 0.7227 New: 0.7220 Old: 0.7230
[incremental] Final(Top-1): 0.7227  Average: 0.7742
3.665104627609253
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=40, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/40 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▎         | 1/40 [00:18<11:52, 18.26s/it]  5%|▌         | 2/40 [00:29<08:56, 14.13s/it]  8%|▊         | 3/40 [00:40<07:43, 12.52s/it] 10%|█         | 4/40 [00:50<06:54, 11.52s/it] 12%|█▎        | 5/40 [01:00<06:30, 11.17s/it] 15%|█▌        | 6/40 [01:11<06:14, 11.01s/it][loss] ep 0 it 0 total=14.3118 mle=2.6523 pcon=9.8394 forget=0.0000 orth=1.8202 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=14.1579 mle=2.4981 pcon=9.8400 forget=0.0000 orth=1.8199 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=14.2728 mle=2.6138 pcon=9.8397 forget=0.0000 orth=1.8193 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=14.0760 mle=2.4205 pcon=9.8372 forget=0.0000 orth=1.8182 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=13.8033 mle=2.1523 pcon=9.8342 forget=0.0000 orth=1.8167 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.9157 mle=2.2709 pcon=9.8301 forget=0.0000 orth=1.8148 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=14.2166 mle=2.5797 pcon=9.8245 forget=0.0000 orth=1.8124 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.8829 mle=2.2561 pcon=9.8172 forget=0.0000 orth=1.8096 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.7872 mle=2.1714 pcon=9.8095 forget=0.0000 orth=1.8063 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.8609 mle=2.2566 pcon=9.8017 forget=0.0000 orth=1.8025 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.9119 mle=2.3204 pcon=9.7933 forget=0.0000 orth=1.7982 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=14.0615 mle=2.4836 pcon=9.7845 forget=0.0000 orth=1.7935 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.8730 mle=2.3108 pcon=9.7740 forget=0.0000 orth=1.7882 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.6092 mle=2.0629 pcon=9.7639 forget=0.0000 orth=1.7824 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.7791 mle=2.2496 pcon=9.7535 forget=0.0000 orth=1.7760 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.8050 mle=2.2939 pcon=9.7421 forget=0.0000 orth=1.7690 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.6029 mle=2.1093 pcon=9.7321 forget=0.0000 orth=1.7615 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.6331 mle=2.1581 pcon=9.7215 forget=0.0000 orth=1.7534 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.5127 mle=2.0573 pcon=9.7107 forget=0.0000 orth=1.7447 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.6201 mle=2.1846 pcon=9.7003 forget=0.0000 orth=1.7352 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.2607 mle=1.8470 pcon=9.6885 forget=0.0000 orth=1.7251 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.6035 mle=2.2130 pcon=9.6761 forget=0.0000 orth=1.7144 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.5629 mle=2.1951 pcon=9.6650 forget=0.0000 orth=1.7029 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.0982 mle=1.7536 pcon=9.6540 forget=0.0000 orth=1.6906 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.4427 mle=2.1224 pcon=9.6426 forget=0.0000 orth=1.6776 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.5361 mle=2.2412 pcon=9.6311 forget=0.0000 orth=1.6638 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.4009 mle=2.1323 pcon=9.6195 forget=0.0000 orth=1.6491 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.3192 mle=2.0774 pcon=9.6081 forget=0.0000 orth=1.6337 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.2191 mle=2.0048 pcon=9.5969 forget=0.0000 orth=1.6174 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.1571 mle=1.9714 pcon=9.5855 forget=0.0000 orth=1.6003 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.2603 mle=2.1034 pcon=9.5745 forget=0.0000 orth=1.5824 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.1093 mle=1.9819 pcon=9.5638 forget=0.0000 orth=1.5637 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.1377 mle=2.0411 pcon=9.5525 forget=0.0000 orth=1.5441 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.1234 mle=2.0581 pcon=9.5416 forget=0.0000 orth=1.5238 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.1103 mle=2.0771 pcon=9.5305 forget=0.0000 orth=1.5027 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.8600 mle=1.8592 pcon=9.5199 forget=0.0000 orth=1.4809 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.9519 mle=1.9839 pcon=9.5095 forget=0.0000 orth=1.4586 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.8442 mle=1.9087 pcon=9.4999 forget=0.0000 orth=1.4356 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.1667 mle=2.2650 pcon=9.4897 forget=0.0000 orth=1.4121 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.7782 mle=1.9104 pcon=9.4797 forget=0.0000 orth=1.3881 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 5 it 45 total=12.8939 mle=2.0602 pcon=9.4698 forget=0.0000 orth=1.3639 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.7679 mle=1.9680 pcon=9.4604 forget=0.0000 orth=1.3395 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.7777 mle=2.0132 pcon=9.4496 forget=0.0000 orth=1.3150 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.7580 mle=2.0272 pcon=9.4402 forget=0.0000 orth=1.2906 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.7465 mle=2.0491 pcon=9.4311 forget=0.0000 orth=1.2663 favg=0.0000 nr=97 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.5582 mle=1.8941 pcon=9.4217 forget=0.0000 orth=1.2424 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.7344 mle=2.1025 pcon=9.4132 forget=0.0000 orth=1.2187 favg=0.0000 nr=95 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 6 it 4 total=12.6815 mle=2.0816 pcon=9.4042 forget=0.0000 orth=1.1957 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.6400 mle=2.0713 pcon=9.3956 forget=0.0000 orth=1.1731 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.4295 mle=1.8919 pcon=9.3865 forget=0.0000 orth=1.1511 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.3312 mle=1.8241 pcon=9.3774 forget=0.0000 orth=1.1297 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=12.4247 mle=1.9463 pcon=9.3694 forget=0.0000 orth=1.1089 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
 18%|█▊        | 7/40 [01:21<05:57, 10.84s/it] 20%|██        | 8/40 [01:32<05:43, 10.72s/it] 22%|██▎       | 9/40 [01:42<05:29, 10.63s/it] 25%|██▌       | 10/40 [01:53<05:16, 10.54s/it] 28%|██▊       | 11/40 [02:03<05:02, 10.43s/it] 30%|███       | 12/40 [02:13<04:50, 10.36s/it] 32%|███▎      | 13/40 [02:23<04:40, 10.40s/it][loss] ep 6 it 254 total=12.5395 mle=2.0902 pcon=9.3605 forget=0.0000 orth=1.0887 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.6184 mle=2.1976 pcon=9.3518 forget=0.0000 orth=1.0690 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.3560 mle=1.9625 pcon=9.3439 forget=0.0000 orth=1.0497 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 7 it 13 total=12.4984 mle=2.1311 pcon=9.3363 forget=0.0000 orth=1.0310 favg=0.0000 nr=98 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.5977 mle=2.2569 pcon=9.3282 forget=0.0000 orth=1.0126 favg=0.0000 nr=94 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.4210 mle=2.1057 pcon=9.3205 forget=0.0000 orth=0.9947 favg=0.0000 nr=93 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.5004 mle=2.2103 pcon=9.3130 forget=0.0000 orth=0.9771 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.2455 mle=1.9801 pcon=9.3056 forget=0.0000 orth=0.9597 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.3836 mle=2.1431 pcon=9.2977 forget=0.0000 orth=0.9428 favg=0.0000 nr=102 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.1863 mle=1.9687 pcon=9.2915 forget=0.0000 orth=0.9261 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.2686 mle=2.0745 pcon=9.2846 forget=0.0000 orth=0.9095 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 8 it 22 total=12.1767 mle=2.0065 pcon=9.2770 forget=0.0000 orth=0.8932 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.0360 mle=1.8883 pcon=9.2706 forget=0.0000 orth=0.8771 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=12.0186 mle=1.8938 pcon=9.2636 forget=0.0000 orth=0.8612 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.8780 mle=1.7754 pcon=9.2571 forget=0.0000 orth=0.8455 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.8465 mle=1.7648 pcon=9.2517 forget=0.0000 orth=0.8299 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=12.0101 mle=1.9505 pcon=9.2451 forget=0.0000 orth=0.8145 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=12.0353 mle=1.9970 pcon=9.2390 forget=0.0000 orth=0.7993 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.1372 mle=2.1203 pcon=9.2327 forget=0.0000 orth=0.7842 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 9 it 31 total=12.1558 mle=2.1600 pcon=9.2266 forget=0.0000 orth=0.7693 favg=0.0000 nr=92 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9373 mle=1.9621 pcon=9.2206 forget=0.0000 orth=0.7547 favg=0.0000 nr=97 nf=13 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.8229 mle=1.8672 pcon=9.2154 forget=0.0000 orth=0.7403 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.9246 mle=1.9899 pcon=9.2087 forget=0.0000 orth=0.7260 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7293 mle=1.8128 pcon=9.2046 forget=0.0000 orth=0.7120 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8977 mle=2.0008 pcon=9.1987 forget=0.0000 orth=0.6981 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=12.0072 mle=2.1292 pcon=9.1935 forget=0.0000 orth=0.6845 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7904 mle=1.9314 pcon=9.1879 forget=0.0000 orth=0.6711 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 10 it 40 total=11.7545 mle=1.9139 pcon=9.1827 forget=0.0000 orth=0.6579 favg=0.0000 nr=109 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.0310 mle=2.2088 pcon=9.1769 forget=0.0000 orth=0.6452 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.7422 mle=1.9367 pcon=9.1725 forget=0.0000 orth=0.6329 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.7331 mle=1.9443 pcon=9.1677 forget=0.0000 orth=0.6211 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6542 mle=1.8820 pcon=9.1624 forget=0.0000 orth=0.6098 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=11.9333 mle=2.1763 pcon=9.1582 forget=0.0000 orth=0.5987 favg=0.0000 nr=93 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.6299 mle=1.8877 pcon=9.1543 forget=0.0000 orth=0.5879 favg=0.0000 nr=100 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=11.9391 mle=2.2123 pcon=9.1493 forget=0.0000 orth=0.5775 favg=0.0000 nr=65 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 11 it 49 total=11.7022 mle=1.9895 pcon=9.1452 forget=0.0000 orth=0.5675 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.8795 mle=2.1816 pcon=9.1400 forget=0.0000 orth=0.5578 favg=0.0000 nr=93 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.7676 mle=2.0832 pcon=9.1358 forget=0.0000 orth=0.5486 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.6571 mle=1.9867 pcon=9.1308 forget=0.0000 orth=0.5396 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.4736 mle=1.8158 pcon=9.1267 forget=0.0000 orth=0.5311 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.7415 mle=2.0966 pcon=9.1221 forget=0.0000 orth=0.5228 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.5095 mle=1.8766 pcon=9.1182 forget=0.0000 orth=0.5148 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 12 it 8 total=11.7072 mle=2.0855 pcon=9.1146 forget=0.0000 orth=0.5072 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.5953 mle=1.9857 pcon=9.1098 forget=0.0000 orth=0.4997 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.6543 mle=2.0560 pcon=9.1058 forget=0.0000 orth=0.4924 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.6304 mle=2.0423 pcon=9.1023 forget=0.0000 orth=0.4857 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.5587 mle=1.9808 pcon=9.0988 forget=0.0000 orth=0.4791 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.7821 mle=2.2139 pcon=9.0956 forget=0.0000 orth=0.4726 favg=0.0000 nr=97 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.7719 mle=2.2135 pcon=9.0920 forget=0.0000 orth=0.4664 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.6399 mle=2.0911 pcon=9.0884 forget=0.0000 orth=0.4604 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
 35%|███▌      | 14/40 [02:34<04:31, 10.45s/it] 38%|███▊      | 15/40 [02:44<04:19, 10.40s/it] 40%|████      | 16/40 [02:55<04:13, 10.54s/it] 42%|████▎     | 17/40 [03:05<03:59, 10.41s/it] 45%|████▌     | 18/40 [03:15<03:46, 10.31s/it] 48%|████▊     | 19/40 [03:26<03:37, 10.34s/it][loss] ep 13 it 17 total=11.6402 mle=2.1001 pcon=9.0854 forget=0.0000 orth=0.4547 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.4614 mle=1.9308 pcon=9.0815 forget=0.0000 orth=0.4491 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.6779 mle=2.1561 pcon=9.0781 forget=0.0000 orth=0.4437 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.6575 mle=2.1442 pcon=9.0749 forget=0.0000 orth=0.4384 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.6754 mle=2.1701 pcon=9.0720 forget=0.0000 orth=0.4333 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.6357 mle=2.1381 pcon=9.0692 forget=0.0000 orth=0.4284 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.5343 mle=2.0449 pcon=9.0657 forget=0.0000 orth=0.4237 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.6005 mle=2.1193 pcon=9.0621 forget=0.0000 orth=0.4191 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 14 it 26 total=11.6515 mle=2.1776 pcon=9.0592 forget=0.0000 orth=0.4146 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.3959 mle=1.9295 pcon=9.0562 forget=0.0000 orth=0.4102 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.4723 mle=2.0129 pcon=9.0534 forget=0.0000 orth=0.4060 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.6478 mle=2.1973 pcon=9.0486 forget=0.0000 orth=0.4019 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.4178 mle=1.9745 pcon=9.0455 forget=0.0000 orth=0.3978 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.6282 mle=2.1922 pcon=9.0420 forget=0.0000 orth=0.3939 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.5194 mle=2.0898 pcon=9.0395 forget=0.0000 orth=0.3901 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.2600 mle=1.8370 pcon=9.0366 forget=0.0000 orth=0.3864 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 15 it 35 total=11.4477 mle=2.0315 pcon=9.0333 forget=0.0000 orth=0.3828 favg=0.0000 nr=99 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.4662 mle=2.0562 pcon=9.0306 forget=0.0000 orth=0.3794 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.3361 mle=1.9330 pcon=9.0273 forget=0.0000 orth=0.3759 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.3706 mle=1.9729 pcon=9.0252 forget=0.0000 orth=0.3725 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.5031 mle=2.1119 pcon=9.0220 forget=0.0000 orth=0.3692 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.3797 mle=1.9939 pcon=9.0198 forget=0.0000 orth=0.3660 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.5386 mle=2.1586 pcon=9.0171 forget=0.0000 orth=0.3629 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.3750 mle=2.0006 pcon=9.0146 forget=0.0000 orth=0.3599 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 16 it 44 total=11.5648 mle=2.1948 pcon=9.0131 forget=0.0000 orth=0.3569 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.5424 mle=2.1773 pcon=9.0110 forget=0.0000 orth=0.3540 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.3793 mle=2.0192 pcon=9.0090 forget=0.0000 orth=0.3511 favg=0.0000 nr=100 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.3948 mle=2.0412 pcon=9.0054 forget=0.0000 orth=0.3482 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.3146 mle=1.9656 pcon=9.0035 forget=0.0000 orth=0.3454 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.2788 mle=1.9346 pcon=9.0014 forget=0.0000 orth=0.3428 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.3911 mle=2.0523 pcon=8.9986 forget=0.0000 orth=0.3402 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 17 it 3 total=11.1771 mle=1.8436 pcon=8.9958 forget=0.0000 orth=0.3377 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.1772 mle=1.8490 pcon=8.9931 forget=0.0000 orth=0.3352 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.4110 mle=2.0880 pcon=8.9904 forget=0.0000 orth=0.3326 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.2674 mle=1.9492 pcon=8.9879 forget=0.0000 orth=0.3303 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.2795 mle=1.9659 pcon=8.9856 forget=0.0000 orth=0.3280 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.3764 mle=2.0669 pcon=8.9838 forget=0.0000 orth=0.3257 favg=0.0000 nr=101 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.2325 mle=1.9273 pcon=8.9818 forget=0.0000 orth=0.3234 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.2998 mle=1.9991 pcon=8.9795 forget=0.0000 orth=0.3213 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 18 it 12 total=11.3325 mle=2.0365 pcon=8.9769 forget=0.0000 orth=0.3192 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.4730 mle=2.1815 pcon=8.9744 forget=0.0000 orth=0.3171 favg=0.0000 nr=98 nf=12 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.2269 mle=1.9390 pcon=8.9728 forget=0.0000 orth=0.3150 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.3370 mle=2.0535 pcon=8.9706 forget=0.0000 orth=0.3129 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.3182 mle=2.0396 pcon=8.9676 forget=0.0000 orth=0.3109 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.2628 mle=1.9890 pcon=8.9648 forget=0.0000 orth=0.3089 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.2671 mle=1.9975 pcon=8.9626 forget=0.0000 orth=0.3070 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.1442 mle=1.8790 pcon=8.9602 forget=0.0000 orth=0.3050 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 19 it 21 total=11.1458 mle=1.8846 pcon=8.9580 forget=0.0000 orth=0.3032 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.3181 mle=2.0613 pcon=8.9555 forget=0.0000 orth=0.3013 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=11.1564 mle=1.9034 pcon=8.9535 forget=0.0000 orth=0.2996 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.2767 mle=2.0275 pcon=8.9514 forget=0.0000 orth=0.2978 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
 50%|█████     | 20/40 [03:36<03:25, 10.27s/it] 52%|█████▎    | 21/40 [03:46<03:15, 10.31s/it] 55%|█████▌    | 22/40 [03:57<03:06, 10.36s/it] 57%|█████▊    | 23/40 [04:07<02:56, 10.37s/it] 60%|██████    | 24/40 [04:17<02:45, 10.36s/it] 62%|██████▎   | 25/40 [04:28<02:36, 10.43s/it][loss] ep 19 it 221 total=11.2701 mle=2.0241 pcon=8.9499 forget=0.0000 orth=0.2961 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.3633 mle=2.1207 pcon=8.9481 forget=0.0000 orth=0.2944 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.3571 mle=2.1178 pcon=8.9465 forget=0.0000 orth=0.2928 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.2886 mle=2.0526 pcon=8.9448 forget=0.0000 orth=0.2911 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 20 it 30 total=11.3704 mle=2.1368 pcon=8.9440 forget=0.0000 orth=0.2895 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.1335 mle=1.9038 pcon=8.9418 forget=0.0000 orth=0.2880 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.2789 mle=2.0528 pcon=8.9396 forget=0.0000 orth=0.2865 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.2715 mle=2.0485 pcon=8.9380 forget=0.0000 orth=0.2851 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.1487 mle=1.9286 pcon=8.9366 forget=0.0000 orth=0.2835 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.2325 mle=2.0159 pcon=8.9344 forget=0.0000 orth=0.2821 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.4261 mle=2.2127 pcon=8.9327 forget=0.0000 orth=0.2807 favg=0.0000 nr=92 nf=13 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.3045 mle=2.0935 pcon=8.9317 forget=0.0000 orth=0.2793 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 21 it 39 total=11.2209 mle=2.0135 pcon=8.9295 forget=0.0000 orth=0.2779 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.1273 mle=1.9235 pcon=8.9274 forget=0.0000 orth=0.2765 favg=0.0000 nr=106 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.2680 mle=2.0667 pcon=8.9261 forget=0.0000 orth=0.2752 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.1333 mle=1.9348 pcon=8.9245 forget=0.0000 orth=0.2740 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.3182 mle=2.1231 pcon=8.9225 forget=0.0000 orth=0.2727 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.0914 mle=1.8990 pcon=8.9211 forget=0.0000 orth=0.2713 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.1363 mle=1.9466 pcon=8.9196 forget=0.0000 orth=0.2701 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.2938 mle=2.1076 pcon=8.9173 forget=0.0000 orth=0.2689 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 22 it 48 total=11.2696 mle=2.0864 pcon=8.9155 forget=0.0000 orth=0.2677 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.1229 mle=1.9426 pcon=8.9138 forget=0.0000 orth=0.2665 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.2298 mle=2.0520 pcon=8.9124 forget=0.0000 orth=0.2654 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.1491 mle=1.9740 pcon=8.9108 forget=0.0000 orth=0.2643 favg=0.0000 nr=102 nf=2 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.2014 mle=2.0288 pcon=8.9095 forget=0.0000 orth=0.2631 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.1446 mle=1.9743 pcon=8.9082 forget=0.0000 orth=0.2621 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.3235 mle=2.1562 pcon=8.9063 forget=0.0000 orth=0.2610 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 23 it 7 total=11.1106 mle=1.9462 pcon=8.9044 forget=0.0000 orth=0.2600 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.3163 mle=2.1543 pcon=8.9030 forget=0.0000 orth=0.2590 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.9699 mle=1.8105 pcon=8.9013 forget=0.0000 orth=0.2580 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.4544 mle=2.2977 pcon=8.8998 forget=0.0000 orth=0.2570 favg=0.0000 nr=94 nf=13 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.2801 mle=2.1261 pcon=8.8980 forget=0.0000 orth=0.2560 favg=0.0000 nr=96 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.1844 mle=2.0328 pcon=8.8965 forget=0.0000 orth=0.2551 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.2196 mle=2.0714 pcon=8.8940 forget=0.0000 orth=0.2542 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.0474 mle=1.9017 pcon=8.8925 forget=0.0000 orth=0.2533 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 24 it 16 total=11.2496 mle=2.1062 pcon=8.8911 forget=0.0000 orth=0.2524 favg=0.0000 nr=100 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.0633 mle=1.9216 pcon=8.8902 forget=0.0000 orth=0.2515 favg=0.0000 nr=105 nf=2 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.3404 mle=2.2010 pcon=8.8887 forget=0.0000 orth=0.2507 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.3110 mle=2.1747 pcon=8.8865 forget=0.0000 orth=0.2498 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.0666 mle=1.9329 pcon=8.8847 forget=0.0000 orth=0.2490 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.1211 mle=1.9905 pcon=8.8825 forget=0.0000 orth=0.2481 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.0565 mle=1.9280 pcon=8.8811 forget=0.0000 orth=0.2474 favg=0.0000 nr=103 nf=12 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.3930 mle=2.2667 pcon=8.8796 forget=0.0000 orth=0.2466 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 25 it 25 total=11.0434 mle=1.9198 pcon=8.8778 forget=0.0000 orth=0.2458 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=11.1974 mle=2.0758 pcon=8.8766 forget=0.0000 orth=0.2451 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.4425 mle=2.3242 pcon=8.8740 forget=0.0000 orth=0.2443 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=11.1007 mle=1.9844 pcon=8.8727 forget=0.0000 orth=0.2436 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=11.0186 mle=1.9045 pcon=8.8711 forget=0.0000 orth=0.2429 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.2336 mle=2.1213 pcon=8.8700 forget=0.0000 orth=0.2423 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=11.0633 mle=1.9531 pcon=8.8686 forget=0.0000 orth=0.2416 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=11.1943 mle=2.0854 pcon=8.8680 forget=0.0000 orth=0.2409 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
 65%|██████▌   | 26/40 [04:38<02:25, 10.41s/it] 68%|██████▊   | 27/40 [04:49<02:14, 10.31s/it] 70%|███████   | 28/40 [04:59<02:03, 10.29s/it] 72%|███████▎  | 29/40 [05:09<01:52, 10.27s/it] 75%|███████▌  | 30/40 [05:19<01:42, 10.27s/it] 78%|███████▊  | 31/40 [05:29<01:32, 10.26s/it] 80%|████████  | 32/40 [05:40<01:23, 10.48s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 26 it 34 total=11.0069 mle=1.9006 pcon=8.8661 forget=0.0000 orth=0.2403 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.2586 mle=2.1551 pcon=8.8639 forget=0.0000 orth=0.2396 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=11.1704 mle=2.0679 pcon=8.8635 forget=0.0000 orth=0.2390 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=11.2004 mle=2.0999 pcon=8.8621 forget=0.0000 orth=0.2384 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=11.0676 mle=1.9692 pcon=8.8606 forget=0.0000 orth=0.2377 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=11.1854 mle=2.0893 pcon=8.8589 forget=0.0000 orth=0.2371 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=11.1136 mle=2.0197 pcon=8.8574 forget=0.0000 orth=0.2365 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=11.0581 mle=1.9660 pcon=8.8561 forget=0.0000 orth=0.2359 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 27 it 43 total=11.2710 mle=2.1805 pcon=8.8551 forget=0.0000 orth=0.2354 favg=0.0000 nr=97 nf=3 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=11.0859 mle=1.9967 pcon=8.8544 forget=0.0000 orth=0.2348 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=11.2187 mle=2.1315 pcon=8.8529 forget=0.0000 orth=0.2343 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=11.1055 mle=2.0208 pcon=8.8510 forget=0.0000 orth=0.2337 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=11.1051 mle=2.0216 pcon=8.8502 forget=0.0000 orth=0.2332 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=11.1403 mle=2.0587 pcon=8.8490 forget=0.0000 orth=0.2327 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.9456 mle=1.8661 pcon=8.8473 forget=0.0000 orth=0.2322 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 28 it 2 total=10.9305 mle=1.8525 pcon=8.8463 forget=0.0000 orth=0.2317 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=11.2362 mle=2.1601 pcon=8.8449 forget=0.0000 orth=0.2312 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=11.1290 mle=2.0544 pcon=8.8438 forget=0.0000 orth=0.2308 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.2835 mle=2.2098 pcon=8.8433 forget=0.0000 orth=0.2303 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=11.1960 mle=2.1241 pcon=8.8421 forget=0.0000 orth=0.2299 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=11.1601 mle=2.0899 pcon=8.8408 forget=0.0000 orth=0.2295 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.8702 mle=1.8010 pcon=8.8402 forget=0.0000 orth=0.2290 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=11.0784 mle=2.0110 pcon=8.8388 forget=0.0000 orth=0.2286 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 29 it 11 total=10.9112 mle=1.8458 pcon=8.8372 forget=0.0000 orth=0.2282 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=11.1115 mle=2.0470 pcon=8.8367 forget=0.0000 orth=0.2278 favg=0.0000 nr=99 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=11.2036 mle=2.1406 pcon=8.8355 forget=0.0000 orth=0.2274 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=11.0063 mle=1.9448 pcon=8.8344 forget=0.0000 orth=0.2271 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.2442 mle=2.1846 pcon=8.8329 forget=0.0000 orth=0.2267 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=11.0962 mle=2.0378 pcon=8.8320 forget=0.0000 orth=0.2264 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=11.0483 mle=1.9910 pcon=8.8313 forget=0.0000 orth=0.2260 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.3799 mle=2.3236 pcon=8.8306 forget=0.0000 orth=0.2257 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 30 it 20 total=10.8967 mle=1.8412 pcon=8.8302 forget=0.0000 orth=0.2254 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=11.1746 mle=2.1197 pcon=8.8298 forget=0.0000 orth=0.2250 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.9987 mle=1.9455 pcon=8.8285 forget=0.0000 orth=0.2247 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=11.3602 mle=2.3085 pcon=8.8273 forget=0.0000 orth=0.2244 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=11.1059 mle=2.0546 pcon=8.8271 forget=0.0000 orth=0.2241 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.8931 mle=1.8430 pcon=8.8263 forget=0.0000 orth=0.2238 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=11.1225 mle=2.0734 pcon=8.8255 forget=0.0000 orth=0.2235 favg=0.0000 nr=98 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=11.1751 mle=2.1274 pcon=8.8244 forget=0.0000 orth=0.2233 favg=0.0000 nr=96 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 31 it 29 total=10.9696 mle=1.9233 pcon=8.8233 forget=0.0000 orth=0.2230 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=11.2191 mle=2.1749 pcon=8.8215 forget=0.0000 orth=0.2228 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=11.0657 mle=2.0224 pcon=8.8207 forget=0.0000 orth=0.2225 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=11.2358 mle=2.1930 pcon=8.8205 forget=0.0000 orth=0.2222 favg=0.0000 nr=101 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=11.2029 mle=2.1621 pcon=8.8189 forget=0.0000 orth=0.2220 favg=0.0000 nr=101 nf=3 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.8826 mle=1.8425 pcon=8.8183 forget=0.0000 orth=0.2218 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=11.1898 mle=2.1505 pcon=8.8178 forget=0.0000 orth=0.2215 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=11.1927 mle=2.1549 pcon=8.8165 forget=0.0000 orth=0.2213 favg=0.0000 nr=92 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 32 it 38 total=11.0742 mle=2.0382 pcon=8.8149 forget=0.0000 orth=0.2211 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.9964 mle=1.9617 pcon=8.8138 forget=0.0000 orth=0.2209 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
 82%|████████▎ | 33/40 [05:51<01:13, 10.55s/it] 85%|████████▌ | 34/40 [06:01<01:02, 10.36s/it] 88%|████████▊ | 35/40 [06:11<00:51, 10.32s/it] 90%|█████████ | 36/40 [06:22<00:41, 10.41s/it] 92%|█████████▎| 37/40 [06:32<00:31, 10.37s/it] 95%|█████████▌| 38/40 [06:42<00:20, 10.29s/it][loss] ep 32 it 138 total=11.0236 mle=1.9901 pcon=8.8128 forget=0.0000 orth=0.2207 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=11.1869 mle=2.1548 pcon=8.8117 forget=0.0000 orth=0.2205 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.8881 mle=1.8570 pcon=8.8108 forget=0.0000 orth=0.2203 favg=0.0000 nr=107 nf=1 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=11.0167 mle=1.9869 pcon=8.8097 forget=0.0000 orth=0.2201 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=11.2493 mle=2.2197 pcon=8.8096 forget=0.0000 orth=0.2200 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.9017 mle=1.8730 pcon=8.8089 forget=0.0000 orth=0.2198 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 33 it 47 total=11.1938 mle=2.1657 pcon=8.8084 forget=0.0000 orth=0.2196 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=11.2102 mle=2.1829 pcon=8.8079 forget=0.0000 orth=0.2195 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=11.1027 mle=2.0761 pcon=8.8072 forget=0.0000 orth=0.2193 favg=0.0000 nr=105 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.8688 mle=1.8435 pcon=8.8061 forget=0.0000 orth=0.2192 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.9724 mle=1.9483 pcon=8.8050 forget=0.0000 orth=0.2191 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=11.1302 mle=2.1078 pcon=8.8035 forget=0.0000 orth=0.2189 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=11.1945 mle=2.1722 pcon=8.8035 forget=0.0000 orth=0.2188 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 34 it 6 total=11.2570 mle=2.2358 pcon=8.8025 forget=0.0000 orth=0.2187 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.9566 mle=1.9364 pcon=8.8016 forget=0.0000 orth=0.2186 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.9626 mle=1.9436 pcon=8.8005 forget=0.0000 orth=0.2185 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=11.0371 mle=2.0198 pcon=8.7990 forget=0.0000 orth=0.2183 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.9054 mle=1.8888 pcon=8.7984 forget=0.0000 orth=0.2182 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=11.0607 mle=2.0451 pcon=8.7975 forget=0.0000 orth=0.2181 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=11.0194 mle=2.0043 pcon=8.7970 forget=0.0000 orth=0.2180 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=11.1765 mle=2.1624 pcon=8.7961 forget=0.0000 orth=0.2180 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 35 it 15 total=11.0571 mle=2.0439 pcon=8.7954 forget=0.0000 orth=0.2179 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=11.0623 mle=2.0505 pcon=8.7940 forget=0.0000 orth=0.2178 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=11.1601 mle=2.1494 pcon=8.7930 forget=0.0000 orth=0.2177 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=11.1976 mle=2.1872 pcon=8.7927 forget=0.0000 orth=0.2176 favg=0.0000 nr=94 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=11.1565 mle=2.1468 pcon=8.7921 forget=0.0000 orth=0.2176 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=11.0923 mle=2.0835 pcon=8.7912 forget=0.0000 orth=0.2175 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=11.1093 mle=2.1012 pcon=8.7907 forget=0.0000 orth=0.2175 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=11.0949 mle=2.0873 pcon=8.7901 forget=0.0000 orth=0.2174 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 36 it 24 total=11.1364 mle=2.1288 pcon=8.7902 forget=0.0000 orth=0.2173 favg=0.0000 nr=94 nf=9 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=11.0281 mle=2.0210 pcon=8.7898 forget=0.0000 orth=0.2173 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=10.8308 mle=1.8240 pcon=8.7895 forget=0.0000 orth=0.2172 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=11.0445 mle=2.0385 pcon=8.7888 forget=0.0000 orth=0.2172 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=10.9584 mle=1.9532 pcon=8.7881 forget=0.0000 orth=0.2171 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=11.2000 mle=2.1951 pcon=8.7878 forget=0.0000 orth=0.2171 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=11.0679 mle=2.0632 pcon=8.7876 forget=0.0000 orth=0.2171 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=10.9612 mle=1.9573 pcon=8.7869 forget=0.0000 orth=0.2170 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=11.0052 mle=2.0018 pcon=8.7865 forget=0.0000 orth=0.2170 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=11.1603 mle=2.1579 pcon=8.7855 forget=0.0000 orth=0.2170 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=10.9696 mle=1.9673 pcon=8.7854 forget=0.0000 orth=0.2169 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=11.0934 mle=2.0917 pcon=8.7848 forget=0.0000 orth=0.2169 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=10.8092 mle=1.8076 pcon=8.7848 forget=0.0000 orth=0.2169 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=11.1960 mle=2.1955 pcon=8.7836 forget=0.0000 orth=0.2169 favg=0.0000 nr=99 nf=11 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=11.3094 mle=2.3094 pcon=8.7832 forget=0.0000 orth=0.2169 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=10.9987 mle=1.9995 pcon=8.7824 forget=0.0000 orth=0.2168 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 38 it 42 total=11.0598 mle=2.0609 pcon=8.7821 forget=0.0000 orth=0.2168 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=11.2827 mle=2.2847 pcon=8.7812 forget=0.0000 orth=0.2168 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=10.9765 mle=1.9792 pcon=8.7805 forget=0.0000 orth=0.2168 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=10.8966 mle=1.8999 pcon=8.7799 forget=0.0000 orth=0.2168 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=11.0373 mle=2.0410 pcon=8.7796 forget=0.0000 orth=0.2168 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=11.1103 mle=2.1138 pcon=8.7797 forget=0.0000 orth=0.2168 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=10.8634 mle=1.8679 pcon=8.7787 forget=0.0000 orth=0.2168 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
 98%|█████████▊| 39/40 [06:53<00:10, 10.38s/it]100%|██████████| 40/40 [07:04<00:00, 10.46s/it]100%|██████████| 40/40 [07:04<00:00, 10.60s/it]
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 39 it 1 total=11.2340 mle=2.2383 pcon=8.7789 forget=0.0000 orth=0.2168 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=10.9729 mle=1.9781 pcon=8.7780 forget=0.0000 orth=0.2168 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=11.1214 mle=2.1266 pcon=8.7780 forget=0.0000 orth=0.2168 favg=0.0000 nr=93 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=10.9826 mle=1.9887 pcon=8.7771 forget=0.0000 orth=0.2168 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=11.1534 mle=2.1602 pcon=8.7764 forget=0.0000 orth=0.2168 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=11.0827 mle=2.0891 pcon=8.7769 forget=0.0000 orth=0.2168 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=11.0114 mle=2.0181 pcon=8.7766 forget=0.0000 orth=0.2168 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=11.2217 mle=2.2282 pcon=8.7768 forget=0.0000 orth=0.2168 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e40-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:33,  1.43it/s]  3%|▎         | 11/391 [00:00<00:21, 17.84it/s]  5%|▌         | 21/391 [00:00<00:11, 33.29it/s]  8%|▊         | 31/391 [00:01<00:07, 46.97it/s] 10%|█         | 41/391 [00:01<00:05, 58.59it/s] 13%|█▎        | 51/391 [00:01<00:05, 67.96it/s] 16%|█▌        | 61/391 [00:01<00:04, 75.08it/s] 18%|█▊        | 71/391 [00:01<00:03, 80.28it/s] 21%|██        | 81/391 [00:01<00:03, 84.51it/s] 23%|██▎       | 91/391 [00:01<00:03, 87.57it/s] 26%|██▌       | 101/391 [00:01<00:03, 89.72it/s] 28%|██▊       | 111/391 [00:01<00:03, 91.31it/s] 31%|███       | 121/391 [00:01<00:02, 92.44it/s] 34%|███▎      | 131/391 [00:02<00:02, 93.42it/s] 36%|███▌      | 141/391 [00:02<00:02, 93.97it/s] 39%|███▊      | 151/391 [00:02<00:02, 94.42it/s] 41%|████      | 161/391 [00:02<00:02, 94.67it/s] 44%|████▎     | 171/391 [00:02<00:02, 94.96it/s] 46%|████▋     | 181/391 [00:02<00:02, 95.04it/s] 49%|████▉     | 191/391 [00:02<00:02, 94.71it/s] 51%|█████▏    | 201/391 [00:02<00:02, 94.64it/s] 54%|█████▍    | 211/391 [00:02<00:01, 94.93it/s] 57%|█████▋    | 221/391 [00:03<00:01, 93.65it/s] 59%|█████▉    | 231/391 [00:03<00:01, 93.96it/s] 62%|██████▏   | 241/391 [00:03<00:01, 94.26it/s] 64%|██████▍   | 251/391 [00:03<00:01, 94.32it/s] 67%|██████▋   | 261/391 [00:03<00:01, 94.44it/s] 69%|██████▉   | 271/391 [00:03<00:01, 93.83it/s] 72%|███████▏  | 281/391 [00:03<00:01, 93.63it/s] 74%|███████▍  | 291/391 [00:03<00:01, 93.61it/s] 77%|███████▋  | 301/391 [00:03<00:00, 93.52it/s] 80%|███████▉  | 311/391 [00:03<00:00, 94.10it/s] 82%|████████▏ | 321/391 [00:04<00:00, 94.50it/s] 85%|████████▍ | 331/391 [00:04<00:00, 94.63it/s] 87%|████████▋ | 341/391 [00:04<00:00, 95.06it/s] 90%|████████▉ | 351/391 [00:04<00:00, 95.20it/s] 92%|█████████▏| 361/391 [00:04<00:00, 94.93it/s] 95%|█████████▍| 371/391 [00:04<00:00, 95.82it/s] 97%|█████████▋| 381/391 [00:04<00:00, 96.39it/s]100%|██████████| 391/391 [00:04<00:00, 87.60it/s]100%|██████████| 391/391 [00:04<00:00, 80.61it/s]
50000 images processed, 5.06449818611145 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.97it/s] 11%|█▏        | 9/79 [00:00<00:03, 19.06it/s] 24%|██▍       | 19/79 [00:00<00:01, 37.73it/s] 37%|███▋      | 29/79 [00:00<00:00, 52.50it/s] 49%|████▉     | 39/79 [00:00<00:00, 64.13it/s] 62%|██████▏   | 49/79 [00:01<00:00, 72.60it/s] 75%|███████▍  | 59/79 [00:01<00:00, 79.49it/s] 87%|████████▋ | 69/79 [00:01<00:00, 84.54it/s]100%|██████████| 79/79 [00:01<00:00, 86.27it/s]100%|██████████| 79/79 [00:01<00:00, 58.53it/s]
10000 images processed, 1.367060661315918 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:31,  2.22it/s]  4%|▍         | 9/204 [00:00<00:09, 20.86it/s]  9%|▉         | 19/204 [00:00<00:04, 40.43it/s] 14%|█▍        | 29/204 [00:00<00:03, 55.30it/s] 19%|█▉        | 39/204 [00:00<00:02, 66.05it/s] 24%|██▍       | 49/204 [00:00<00:02, 74.16it/s] 29%|██▉       | 59/204 [00:01<00:01, 79.80it/s] 34%|███▍      | 69/204 [00:01<00:01, 83.84it/s] 39%|███▊      | 79/204 [00:01<00:01, 85.88it/s] 44%|████▎     | 89/204 [00:01<00:01, 88.41it/s] 49%|████▊     | 99/204 [00:01<00:01, 89.64it/s] 53%|█████▎    | 109/204 [00:01<00:01, 90.50it/s] 58%|█████▊    | 119/204 [00:01<00:00, 91.44it/s] 63%|██████▎   | 129/204 [00:01<00:00, 92.07it/s] 68%|██████▊   | 139/204 [00:01<00:00, 84.09it/s] 73%|███████▎  | 148/204 [00:02<00:00, 85.60it/s] 77%|███████▋  | 158/204 [00:02<00:00, 88.10it/s] 82%|████████▏ | 168/204 [00:02<00:00, 89.81it/s] 87%|████████▋ | 178/204 [00:02<00:00, 91.47it/s] 92%|█████████▏| 188/204 [00:02<00:00, 93.10it/s] 97%|█████████▋| 198/204 [00:02<00:00, 94.26it/s]100%|██████████| 204/204 [00:02<00:00, 76.40it/s]
26032 images processed, 2.705228090286255 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:56,  1.39it/s]  8%|▊         | 6/79 [00:00<00:08,  8.59it/s] 20%|██        | 16/79 [00:00<00:02, 24.53it/s] 28%|██▊       | 22/79 [00:01<00:02, 28.30it/s] 41%|████      | 32/79 [00:01<00:01, 42.39it/s] 53%|█████▎    | 42/79 [00:01<00:00, 54.34it/s] 66%|██████▌   | 52/79 [00:01<00:00, 63.37it/s] 77%|███████▋  | 61/79 [00:01<00:00, 69.57it/s] 90%|████████▉ | 71/79 [00:01<00:00, 76.64it/s]100%|██████████| 79/79 [00:01<00:00, 44.70it/s]
10000 images processed, 1.806359052658081 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.05it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.48it/s] 27%|██▋       | 21/79 [00:00<00:01, 41.03it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.98it/s] 52%|█████▏    | 41/79 [00:00<00:00, 65.71it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.18it/s] 77%|███████▋  | 61/79 [00:01<00:00, 79.83it/s] 90%|████████▉ | 71/79 [00:01<00:00, 84.63it/s]100%|██████████| 79/79 [00:01<00:00, 60.14it/s]
10000 images processed, 1.3417999744415283 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.97it/s] 16%|█▌        | 11/70 [00:00<00:02, 22.94it/s] 30%|███       | 21/70 [00:00<00:01, 40.36it/s] 43%|████▎     | 30/70 [00:00<00:00, 52.20it/s] 56%|█████▌    | 39/70 [00:00<00:00, 61.80it/s] 69%|██████▊   | 48/70 [00:01<00:00, 67.60it/s] 83%|████████▎ | 58/70 [00:01<00:00, 74.90it/s] 97%|█████████▋| 68/70 [00:01<00:00, 81.05it/s]100%|██████████| 70/70 [00:01<00:00, 54.70it/s]
8925 images processed, 1.310365915298462 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:50,  1.16s/it]  4%|▍         | 2/45 [00:01<00:23,  1.80it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.51it/s] 38%|███▊      | 17/45 [00:01<00:01, 14.06it/s] 47%|████▋     | 21/45 [00:01<00:01, 17.41it/s] 56%|█████▌    | 25/45 [00:02<00:01, 18.76it/s] 73%|███████▎  | 33/45 [00:02<00:00, 17.86it/s] 80%|████████  | 36/45 [00:02<00:00, 18.59it/s] 98%|█████████▊| 44/45 [00:02<00:00, 27.82it/s]100%|██████████| 45/45 [00:02<00:00, 16.18it/s]
5640 images processed, 2.8059043884277344 seconds used

18.307010889053345
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           7.42  98.37  84.83
places365     67.42  82.40  55.20
LSUN          41.91  89.58  68.06
iSUN          53.05  88.57  71.82
dtd           20.12  95.53  89.36
AVG           37.99  90.89  73.85
[incremental] Overall: 0.6615 New: 0.6760 Old: 0.6567
[incremental] Final(Top-1): 0.6615  Average: 0.7460
3.567336082458496
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:53,  1.47it/s] 13%|█▎        | 10/79 [00:00<00:04, 16.74it/s] 25%|██▌       | 20/79 [00:00<00:01, 32.88it/s] 38%|███▊      | 30/79 [00:00<00:01, 46.61it/s] 51%|█████     | 40/79 [00:01<00:00, 58.41it/s] 63%|██████▎   | 50/79 [00:01<00:00, 67.97it/s] 76%|███████▌  | 60/79 [00:01<00:00, 75.63it/s] 89%|████████▊ | 70/79 [00:01<00:00, 81.41it/s]100%|██████████| 79/79 [00:01<00:00, 52.62it/s]
10000 images processed, 1.5281982421875 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:40,  1.68it/s] 16%|█▌        | 11/70 [00:00<00:02, 20.52it/s] 30%|███       | 21/70 [00:00<00:01, 37.16it/s] 44%|████▍     | 31/70 [00:00<00:00, 50.89it/s] 57%|█████▋    | 40/70 [00:01<00:00, 60.48it/s] 71%|███████▏  | 50/70 [00:01<00:00, 70.15it/s] 86%|████████▌ | 60/70 [00:01<00:00, 77.49it/s]100%|██████████| 70/70 [00:01<00:00, 82.19it/s]100%|██████████| 70/70 [00:01<00:00, 52.76it/s]
8925 images processed, 1.3553729057312012 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:44,  1.00s/it]  4%|▍         | 2/45 [00:01<00:21,  1.99it/s]  9%|▉         | 4/45 [00:01<00:09,  4.45it/s] 22%|██▏       | 10/45 [00:01<00:02, 13.46it/s] 38%|███▊      | 17/45 [00:01<00:01, 23.45it/s] 47%|████▋     | 21/45 [00:02<00:01, 13.75it/s] 69%|██████▉   | 31/45 [00:02<00:00, 25.03it/s] 82%|████████▏ | 37/45 [00:02<00:00, 19.79it/s] 96%|█████████▌| 43/45 [00:02<00:00, 24.81it/s]100%|██████████| 45/45 [00:02<00:00, 16.44it/s]
5640 images processed, 2.75905704498291 seconds used

18.212327241897583
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           7.42  98.37  84.83
places365     67.42  82.40  55.20
LSUN          41.91  89.58  68.06
iSUN          53.05  88.57  71.82
dtd           20.12  95.53  89.36
AVG           37.99  90.89  73.85
[incremental] Overall: 0.6615 New: 0.6760 Old: 0.6567
[incremental] Final(Top-1): 0.6615  Average: 0.7460
7.634303331375122
[DEBUG] Parsed: avg_fpr=37.99 avg_auroc=90.89 final_top1=0.6615 average=0.7460
[Result] AVG-AUROC=90.89 AVG-FPR=37.99 Final-Top1=0.6615 Average=0.7460 Score=73.41

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=45 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=45, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/45 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/45 [00:16<12:15, 16.71s/it]  4%|▍         | 2/45 [00:25<08:27, 11.81s/it]  7%|▋         | 3/45 [00:32<07:00, 10.02s/it]  9%|▉         | 4/45 [00:40<06:14,  9.14s/it] 11%|█         | 5/45 [00:48<05:48,  8.72s/it] 13%|█▎        | 6/45 [00:56<05:31,  8.51s/it][loss] ep 0 it 0 total=8.5896 mle=3.2130 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6440 mle=3.2647 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0878 mle=3.7056 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6781 mle=3.2933 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9793 mle=2.5921 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9918 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4733 mle=4.0810 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4954 mle=3.1006 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5368 mle=3.1398 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2412 mle=2.8416 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7244 mle=3.3225 pcon=5.4019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0960 mle=3.6915 pcon=5.4045 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4459 mle=4.0387 pcon=5.4072 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3583 mle=2.9488 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0698 mle=3.6580 pcon=5.4119 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5545 mle=3.1403 pcon=5.4142 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5078 mle=3.0910 pcon=5.4169 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6318 mle=3.2130 pcon=5.4188 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2431 mle=2.8212 pcon=5.4219 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4329 mle=3.0085 pcon=5.4243 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7375 mle=2.3106 pcon=5.4269 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6784 mle=3.2491 pcon=5.4293 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8371 mle=3.4052 pcon=5.4319 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7150 mle=2.2806 pcon=5.4344 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.2999 mle=2.8637 pcon=5.4362 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4254 mle=2.9874 pcon=5.4380 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1015 mle=2.6616 pcon=5.4399 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9324 mle=2.4908 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6430 mle=2.2004 pcon=5.4426 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6506 mle=2.2065 pcon=5.4441 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6232 mle=2.1785 pcon=5.4447 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6685 mle=2.2229 pcon=5.4455 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6921 mle=2.2454 pcon=5.4467 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6983 mle=2.2505 pcon=5.4478 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7879 mle=2.3395 pcon=5.4484 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4442 mle=1.9939 pcon=5.4503 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4893 mle=2.0371 pcon=5.4521 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4849 mle=2.0302 pcon=5.4547 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9107 mle=2.4539 pcon=5.4568 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4957 mle=2.0364 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 5 it 45 total=7.5989 mle=2.1381 pcon=5.4608 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.5302 mle=2.0670 pcon=5.4632 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.5470 mle=2.0819 pcon=5.4651 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.6398 mle=2.1722 pcon=5.4676 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.6795 mle=2.2099 pcon=5.4696 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.3915 mle=1.9192 pcon=5.4723 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7724 mle=2.2973 pcon=5.4751 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 6 it 4 total=7.6269 mle=2.1494 pcon=5.4775 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.7452 mle=2.2649 pcon=5.4803 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.5336 mle=2.0507 pcon=5.4829 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.3493 mle=1.8648 pcon=5.4845 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.5080 mle=2.0203 pcon=5.4878 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
 16%|█▌        | 7/45 [01:05<05:19,  8.40s/it] 18%|█▊        | 8/45 [01:13<05:05,  8.27s/it] 20%|██        | 9/45 [01:21<04:56,  8.23s/it] 22%|██▏       | 10/45 [01:29<04:45,  8.15s/it] 24%|██▍       | 11/45 [01:38<04:45,  8.41s/it] 27%|██▋       | 12/45 [01:46<04:39,  8.46s/it] 29%|██▉       | 13/45 [01:54<04:26,  8.32s/it] 31%|███       | 14/45 [02:03<04:21,  8.43s/it][loss] ep 6 it 254 total=7.5028 mle=2.0121 pcon=5.4907 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.9121 mle=2.4183 pcon=5.4938 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.4511 mle=1.9540 pcon=5.4971 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 13 total=7.7896 mle=2.2890 pcon=5.5007 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.9126 mle=2.4085 pcon=5.5041 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.7382 mle=2.2306 pcon=5.5076 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.8009 mle=2.2897 pcon=5.5112 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.5634 mle=2.0492 pcon=5.5141 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.6840 mle=2.1656 pcon=5.5184 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.5469 mle=2.0251 pcon=5.5218 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.6895 mle=2.1638 pcon=5.5257 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 22 total=7.6966 mle=2.1675 pcon=5.5291 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.5197 mle=1.9874 pcon=5.5323 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.3988 mle=1.8634 pcon=5.5354 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=7.3097 mle=1.7706 pcon=5.5392 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=7.3353 mle=1.7922 pcon=5.5431 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.5150 mle=1.9686 pcon=5.5464 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=7.5381 mle=1.9883 pcon=5.5498 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=7.7812 mle=2.2276 pcon=5.5536 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 31 total=7.9269 mle=2.3705 pcon=5.5564 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=7.6420 mle=2.0821 pcon=5.5599 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=7.4834 mle=1.9207 pcon=5.5627 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=7.6007 mle=2.0348 pcon=5.5659 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=7.5365 mle=1.9670 pcon=5.5695 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=7.5926 mle=2.0195 pcon=5.5730 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=7.6971 mle=2.1211 pcon=5.5761 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=7.5188 mle=1.9396 pcon=5.5792 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 40 total=7.4384 mle=1.8566 pcon=5.5817 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=7.9045 mle=2.3205 pcon=5.5840 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=7.5869 mle=2.0000 pcon=5.5869 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=7.5867 mle=1.9969 pcon=5.5898 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=7.4326 mle=1.8405 pcon=5.5921 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=7.8545 mle=2.2593 pcon=5.5952 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=7.5766 mle=1.9792 pcon=5.5974 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=7.8366 mle=2.2362 pcon=5.6004 forget=0.0000 orth=0.0000 favg=0.0000 nr=77 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 49 total=7.5663 mle=1.9626 pcon=5.6037 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=7.9003 mle=2.2936 pcon=5.6066 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=7.7697 mle=2.1603 pcon=5.6093 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=7.6113 mle=1.9988 pcon=5.6125 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=7.4134 mle=1.7978 pcon=5.6157 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=7.7316 mle=2.1135 pcon=5.6182 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=7.4544 mle=1.8339 pcon=5.6205 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 8 total=7.8478 mle=2.2249 pcon=5.6229 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=7.6100 mle=1.9846 pcon=5.6254 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=7.8280 mle=2.1999 pcon=5.6280 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=7.5988 mle=1.9680 pcon=5.6308 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=7.6263 mle=1.9929 pcon=5.6334 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=7.9017 mle=2.2657 pcon=5.6360 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=7.7428 mle=2.1047 pcon=5.6382 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=7.7904 mle=2.1497 pcon=5.6407 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 17 total=7.8735 mle=2.2304 pcon=5.6431 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=7.6736 mle=2.0280 pcon=5.6456 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=7.9255 mle=2.2782 pcon=5.6473 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=7.7540 mle=2.1047 pcon=5.6492 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=7.9473 mle=2.2967 pcon=5.6506 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=7.8499 mle=2.1971 pcon=5.6528 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=7.7400 mle=2.0852 pcon=5.6549 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=7.7590 mle=2.1015 pcon=5.6575 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 26 total=7.9674 mle=2.3082 pcon=5.6591 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=7.7004 mle=2.0396 pcon=5.6608 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=7.7287 mle=2.0666 pcon=5.6621 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=7.8706 mle=2.2071 pcon=5.6635 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
 33%|███▎      | 15/45 [02:11<04:05,  8.19s/it] 36%|███▌      | 16/45 [02:18<03:54,  8.09s/it] 38%|███▊      | 17/45 [02:26<03:42,  7.94s/it] 40%|████      | 18/45 [02:34<03:33,  7.89s/it] 42%|████▏     | 19/45 [02:42<03:25,  7.91s/it] 44%|████▍     | 20/45 [02:50<03:19,  7.96s/it] 47%|████▋     | 21/45 [02:58<03:13,  8.05s/it] 49%|████▉     | 22/45 [03:06<03:04,  8.04s/it][loss] ep 14 it 226 total=7.6116 mle=1.9462 pcon=5.6654 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=7.8309 mle=2.1632 pcon=5.6677 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=7.7753 mle=2.1061 pcon=5.6692 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=7.5909 mle=1.9201 pcon=5.6708 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 15 it 35 total=7.8051 mle=2.1325 pcon=5.6726 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=7.7867 mle=2.1120 pcon=5.6746 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=7.6454 mle=1.9693 pcon=5.6762 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=7.6448 mle=1.9677 pcon=5.6772 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=7.8554 mle=2.1774 pcon=5.6780 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=7.7253 mle=2.0458 pcon=5.6795 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=7.9074 mle=2.2268 pcon=5.6807 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=7.6825 mle=2.0004 pcon=5.6822 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 44 total=7.8742 mle=2.1911 pcon=5.6831 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=7.8323 mle=2.1477 pcon=5.6846 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=7.7350 mle=2.0493 pcon=5.6857 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=7.7343 mle=2.0478 pcon=5.6865 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=7.6660 mle=1.9781 pcon=5.6879 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=7.5868 mle=1.8981 pcon=5.6888 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=7.7516 mle=2.0624 pcon=5.6892 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 3 total=7.4739 mle=1.7834 pcon=5.6904 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=7.5349 mle=1.8436 pcon=5.6913 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=7.7217 mle=2.0294 pcon=5.6923 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=7.5305 mle=1.8371 pcon=5.6934 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=7.6356 mle=1.9415 pcon=5.6942 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=7.7512 mle=2.0567 pcon=5.6944 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=7.6381 mle=1.9433 pcon=5.6948 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=7.6479 mle=1.9525 pcon=5.6954 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 12 total=7.6772 mle=1.9814 pcon=5.6958 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=7.9782 mle=2.2824 pcon=5.6957 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=7.6330 mle=1.9371 pcon=5.6959 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=7.7744 mle=2.0781 pcon=5.6962 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=7.8399 mle=2.1434 pcon=5.6965 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=7.6888 mle=1.9924 pcon=5.6964 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=7.6188 mle=1.9220 pcon=5.6968 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=7.5017 mle=1.8048 pcon=5.6969 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 21 total=7.6682 mle=1.9709 pcon=5.6973 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=7.7314 mle=2.0339 pcon=5.6975 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=7.6601 mle=1.9629 pcon=5.6971 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=7.7241 mle=2.0267 pcon=5.6974 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=7.7387 mle=2.0409 pcon=5.6977 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=7.9033 mle=2.2055 pcon=5.6978 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=7.8239 mle=2.1259 pcon=5.6980 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=7.7571 mle=2.0594 pcon=5.6977 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 30 total=7.8446 mle=2.1468 pcon=5.6978 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=7.6112 mle=1.9130 pcon=5.6982 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=7.7683 mle=2.0705 pcon=5.6978 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=7.8268 mle=2.1281 pcon=5.6987 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=7.5265 mle=1.8281 pcon=5.6984 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=7.7739 mle=2.0768 pcon=5.6971 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=8.0090 mle=2.3117 pcon=5.6973 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=7.9423 mle=2.2446 pcon=5.6977 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 39 total=7.7734 mle=2.0768 pcon=5.6966 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=7.5690 mle=1.8723 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=7.7136 mle=2.0174 pcon=5.6962 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=7.5473 mle=1.8511 pcon=5.6962 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=7.8770 mle=2.1818 pcon=5.6953 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=7.6282 mle=1.9333 pcon=5.6950 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=7.6482 mle=1.9533 pcon=5.6949 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=7.8861 mle=2.1915 pcon=5.6946 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 48 total=7.8457 mle=2.1512 pcon=5.6944 forget=0.0000 orth=0.0000 favg=0.0000 nr=115 nf=13 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=7.7248 mle=2.0308 pcon=5.6940 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=7.7180 mle=2.0241 pcon=5.6939 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
 51%|█████     | 23/45 [03:14<02:54,  7.94s/it] 53%|█████▎    | 24/45 [03:21<02:45,  7.87s/it] 56%|█████▌    | 25/45 [03:30<02:38,  7.92s/it] 58%|█████▊    | 26/45 [03:38<02:31,  7.97s/it] 60%|██████    | 27/45 [03:46<02:26,  8.15s/it] 62%|██████▏   | 28/45 [03:54<02:17,  8.07s/it] 64%|██████▍   | 29/45 [04:02<02:07,  7.95s/it] 67%|██████▋   | 30/45 [04:10<01:59,  7.99s/it][loss] ep 22 it 198 total=7.6323 mle=1.9381 pcon=5.6942 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=7.7897 mle=2.0957 pcon=5.6940 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=7.7775 mle=2.0844 pcon=5.6930 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=7.8722 mle=2.1797 pcon=5.6925 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 7 total=7.7558 mle=2.0642 pcon=5.6916 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=7.7776 mle=2.0862 pcon=5.6914 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=7.4718 mle=1.7806 pcon=5.6911 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=8.0365 mle=2.3465 pcon=5.6900 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=7.8121 mle=2.1223 pcon=5.6898 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=7.7820 mle=2.0924 pcon=5.6896 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=7.7695 mle=2.0803 pcon=5.6892 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=7.6306 mle=1.9426 pcon=5.6880 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 16 total=7.8531 mle=2.1664 pcon=5.6867 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=7.6471 mle=1.9608 pcon=5.6863 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=7.8710 mle=2.1848 pcon=5.6861 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=7.8016 mle=2.1167 pcon=5.6849 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=7.5648 mle=1.8810 pcon=5.6838 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=7.6940 mle=2.0113 pcon=5.6828 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=7.7025 mle=2.0199 pcon=5.6826 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=8.0117 mle=2.3293 pcon=5.6823 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 25 it 25 total=7.5356 mle=1.8542 pcon=5.6813 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=7.6767 mle=1.9952 pcon=5.6814 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=7.9594 mle=2.2790 pcon=5.6804 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=7.7192 mle=2.0395 pcon=5.6797 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=7.5148 mle=1.8360 pcon=5.6787 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=7.8780 mle=2.2001 pcon=5.6779 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=7.6371 mle=1.9596 pcon=5.6775 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=7.7787 mle=2.1030 pcon=5.6757 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 34 total=7.5588 mle=1.8832 pcon=5.6755 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=7.7944 mle=2.1203 pcon=5.6741 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=7.7220 mle=2.0480 pcon=5.6740 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=7.7592 mle=2.0864 pcon=5.6728 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=7.5954 mle=1.9229 pcon=5.6726 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=7.7971 mle=2.1250 pcon=5.6721 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=7.7236 mle=2.0528 pcon=5.6708 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=7.6025 mle=1.9319 pcon=5.6706 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 43 total=7.8752 mle=2.2051 pcon=5.6701 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=7.7498 mle=2.0803 pcon=5.6695 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=7.8004 mle=2.1314 pcon=5.6690 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=7.6964 mle=2.0283 pcon=5.6681 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=7.7486 mle=2.0810 pcon=5.6675 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=7.6263 mle=1.9593 pcon=5.6669 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=7.4401 mle=1.7742 pcon=5.6659 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 2 total=7.5513 mle=1.8869 pcon=5.6644 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=7.8622 mle=2.1984 pcon=5.6638 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=7.6544 mle=1.9921 pcon=5.6623 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=7.8838 mle=2.2220 pcon=5.6619 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=7.7592 mle=2.0986 pcon=5.6606 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=7.7365 mle=2.0768 pcon=5.6598 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=7.4127 mle=1.7533 pcon=5.6594 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=7.5477 mle=1.8896 pcon=5.6581 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 11 total=7.5473 mle=1.8899 pcon=5.6575 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=7.7710 mle=2.1141 pcon=5.6569 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=7.9361 mle=2.2802 pcon=5.6559 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=7.5420 mle=1.8869 pcon=5.6550 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=7.7843 mle=2.1301 pcon=5.6542 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=7.6972 mle=2.0431 pcon=5.6541 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=7.6420 mle=1.9886 pcon=5.6534 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=7.9624 mle=2.3096 pcon=5.6528 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 20 total=7.6254 mle=1.9732 pcon=5.6521 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=7.8005 mle=2.1494 pcon=5.6511 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=7.5391 mle=1.8892 pcon=5.6499 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
 69%|██████▉   | 31/45 [04:17<01:50,  7.87s/it] 71%|███████   | 32/45 [04:25<01:42,  7.88s/it] 73%|███████▎  | 33/45 [04:33<01:34,  7.85s/it] 76%|███████▌  | 34/45 [04:41<01:28,  8.00s/it] 78%|███████▊  | 35/45 [04:49<01:18,  7.88s/it] 80%|████████  | 36/45 [04:57<01:10,  7.83s/it] 82%|████████▏ | 37/45 [05:04<01:02,  7.76s/it] 84%|████████▍ | 38/45 [05:12<00:53,  7.65s/it][loss] ep 30 it 170 total=7.9387 mle=2.2896 pcon=5.6491 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=7.7847 mle=2.1361 pcon=5.6486 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=7.4975 mle=1.8497 pcon=5.6478 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=7.7055 mle=2.0581 pcon=5.6474 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=7.7697 mle=2.1234 pcon=5.6464 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 29 total=7.5141 mle=1.8678 pcon=5.6463 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=7.8032 mle=2.1577 pcon=5.6455 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=7.6351 mle=1.9906 pcon=5.6445 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=7.7959 mle=2.1513 pcon=5.6446 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=7.7136 mle=2.0702 pcon=5.6434 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=7.5115 mle=1.8696 pcon=5.6418 forget=0.0000 orth=0.0000 favg=0.0000 nr=127 nf=1 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=7.7600 mle=2.1191 pcon=5.6409 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=7.8715 mle=2.2322 pcon=5.6393 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 32 it 38 total=7.6768 mle=2.0384 pcon=5.6384 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=7.6054 mle=1.9680 pcon=5.6374 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=7.6251 mle=1.9883 pcon=5.6367 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=7.7570 mle=2.1210 pcon=5.6360 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=7.5199 mle=1.8849 pcon=5.6350 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=7.5971 mle=1.9630 pcon=5.6341 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=7.8119 mle=2.1777 pcon=5.6342 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=7.4527 mle=1.8189 pcon=5.6338 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 33 it 47 total=7.8604 mle=2.2275 pcon=5.6329 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=7.7942 mle=2.1626 pcon=5.6317 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=7.6637 mle=2.0323 pcon=5.6314 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=7.4246 mle=1.7941 pcon=5.6304 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=7.5745 mle=1.9445 pcon=5.6300 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=7.7646 mle=2.1354 pcon=5.6292 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=7.8897 mle=2.2615 pcon=5.6282 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 6 total=7.8326 mle=2.2046 pcon=5.6280 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=7.5125 mle=1.8851 pcon=5.6274 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=7.5071 mle=1.8799 pcon=5.6272 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=7.6824 mle=2.0560 pcon=5.6264 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=7.5350 mle=1.9091 pcon=5.6260 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=7.5836 mle=1.9583 pcon=5.6254 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=7.6014 mle=1.9773 pcon=5.6241 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=7.7800 mle=2.1570 pcon=5.6229 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 15 total=7.5480 mle=1.9262 pcon=5.6218 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=7.6646 mle=2.0430 pcon=5.6216 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=7.7202 mle=2.0986 pcon=5.6217 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=7.8484 mle=2.2271 pcon=5.6213 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=7.7677 mle=2.1470 pcon=5.6207 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=7.6852 mle=2.0647 pcon=5.6205 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=7.7138 mle=2.0939 pcon=5.6199 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=7.7602 mle=2.1407 pcon=5.6195 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 24 total=7.8137 mle=2.1947 pcon=5.6190 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=7.5734 mle=1.9556 pcon=5.6178 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=7.2686 mle=1.6516 pcon=5.6170 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=7.6582 mle=2.0424 pcon=5.6158 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=7.5342 mle=1.9195 pcon=5.6147 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=7.6678 mle=2.0530 pcon=5.6148 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=7.7346 mle=2.1201 pcon=5.6145 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=7.6851 mle=2.0706 pcon=5.6145 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=7.6425 mle=2.0281 pcon=5.6145 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=7.7432 mle=2.1289 pcon=5.6143 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=7.5727 mle=1.9589 pcon=5.6139 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=7.6190 mle=2.0059 pcon=5.6130 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=7.3816 mle=1.7690 pcon=5.6127 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=7.9266 mle=2.3150 pcon=5.6117 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=7.8975 mle=2.2862 pcon=5.6113 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=7.5535 mle=1.9431 pcon=5.6105 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 42 total=7.7512 mle=2.1417 pcon=5.6096 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=7.9194 mle=2.3105 pcon=5.6089 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
 87%|████████▋ | 39/45 [05:20<00:46,  7.76s/it] 89%|████████▉ | 40/45 [05:28<00:39,  7.83s/it] 91%|█████████ | 41/45 [05:35<00:30,  7.72s/it] 93%|█████████▎| 42/45 [05:43<00:23,  7.68s/it] 96%|█████████▌| 43/45 [05:51<00:15,  7.71s/it] 98%|█████████▊| 44/45 [05:58<00:07,  7.64s/it]100%|██████████| 45/45 [06:06<00:00,  7.76s/it]100%|██████████| 45/45 [06:06<00:00,  8.15s/it]
[loss] ep 38 it 142 total=7.4597 mle=1.8520 pcon=5.6077 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=7.4405 mle=1.8328 pcon=5.6077 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=7.7003 mle=2.0932 pcon=5.6071 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=7.7516 mle=2.1452 pcon=5.6064 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=7.4371 mle=1.8316 pcon=5.6055 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 1 total=7.8475 mle=2.2420 pcon=5.6056 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=7.5183 mle=1.9133 pcon=5.6050 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=7.7526 mle=2.1466 pcon=5.6060 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=7.6396 mle=2.0342 pcon=5.6054 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=7.7260 mle=2.1210 pcon=5.6050 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=7.5404 mle=1.9357 pcon=5.6047 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=7.5803 mle=1.9757 pcon=5.6046 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=7.6955 mle=2.0916 pcon=5.6039 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 10 total=7.5484 mle=1.9445 pcon=5.6039 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=7.5479 mle=1.9448 pcon=5.6031 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=7.6676 mle=2.0646 pcon=5.6029 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=7.5229 mle=1.9208 pcon=5.6021 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=7.6798 mle=2.0775 pcon=5.6023 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=7.6552 mle=2.0533 pcon=5.6019 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=7.8165 mle=2.2154 pcon=5.6011 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=7.6380 mle=2.0373 pcon=5.6007 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 41 it 19 total=7.7219 mle=2.1214 pcon=5.6005 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=7.7915 mle=2.1910 pcon=5.6004 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=7.8228 mle=2.2223 pcon=5.6005 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=7.7080 mle=2.1089 pcon=5.5992 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=7.4844 mle=1.8857 pcon=5.5987 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=7.3904 mle=1.7921 pcon=5.5984 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=7.8537 mle=2.2557 pcon=5.5979 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=7.7126 mle=2.1143 pcon=5.5984 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 28 total=7.6746 mle=2.0759 pcon=5.5986 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=7.5634 mle=1.9651 pcon=5.5983 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=7.6484 mle=2.0501 pcon=5.5982 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=7.4761 mle=1.8782 pcon=5.5979 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=7.4247 mle=1.8272 pcon=5.5975 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=7.6934 mle=2.0957 pcon=5.5977 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=7.6530 mle=2.0554 pcon=5.5977 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=7.6799 mle=2.0826 pcon=5.5973 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 37 total=7.6154 mle=2.0180 pcon=5.5974 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=7.5175 mle=1.9197 pcon=5.5978 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=7.8255 mle=2.2279 pcon=5.5976 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=7.6053 mle=2.0083 pcon=5.5970 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=7.6400 mle=2.0431 pcon=5.5969 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=7.7407 mle=2.1437 pcon=5.5969 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=7.7013 mle=2.1051 pcon=5.5962 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=7.5264 mle=1.9306 pcon=5.5958 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 46 total=7.7380 mle=2.1430 pcon=5.5950 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=7.5273 mle=1.9326 pcon=5.5947 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=7.9121 mle=2.3173 pcon=5.5948 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=7.9832 mle=2.3892 pcon=5.5941 forget=0.0000 orth=0.0000 favg=0.0000 nr=107 nf=21 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=7.6003 mle=2.0062 pcon=5.5941 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=7.6522 mle=2.0581 pcon=5.5941 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=7.5958 mle=2.0019 pcon=5.5939 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:54,  1.66it/s]  3%|▎         | 10/391 [00:00<00:20, 18.49it/s]  5%|▍         | 19/391 [00:00<00:11, 33.73it/s]  7%|▋         | 29/391 [00:00<00:07, 48.54it/s] 10%|▉         | 39/391 [00:01<00:05, 60.46it/s] 13%|█▎        | 49/391 [00:01<00:04, 69.06it/s] 15%|█▌        | 59/391 [00:01<00:04, 75.68it/s] 18%|█▊        | 69/391 [00:01<00:03, 81.13it/s] 20%|██        | 79/391 [00:01<00:03, 85.35it/s] 23%|██▎       | 89/391 [00:01<00:03, 88.18it/s] 25%|██▌       | 99/391 [00:01<00:03, 89.99it/s] 28%|██▊       | 109/391 [00:02<00:05, 50.18it/s] 30%|███       | 119/391 [00:02<00:04, 58.73it/s] 33%|███▎      | 129/391 [00:02<00:03, 66.39it/s] 36%|███▌      | 139/391 [00:02<00:03, 73.14it/s] 38%|███▊      | 148/391 [00:02<00:03, 76.61it/s] 40%|████      | 158/391 [00:02<00:02, 81.15it/s] 43%|████▎     | 167/391 [00:02<00:02, 82.74it/s] 45%|████▌     | 177/391 [00:02<00:02, 85.96it/s] 48%|████▊     | 187/391 [00:02<00:02, 87.74it/s] 50%|█████     | 197/391 [00:03<00:02, 89.75it/s] 53%|█████▎    | 207/391 [00:03<00:02, 90.29it/s] 55%|█████▌    | 217/391 [00:03<00:01, 89.23it/s] 58%|█████▊    | 227/391 [00:03<00:02, 73.25it/s] 60%|██████    | 235/391 [00:03<00:02, 74.13it/s] 63%|██████▎   | 245/391 [00:03<00:01, 79.77it/s] 65%|██████▌   | 255/391 [00:03<00:01, 84.14it/s] 68%|██████▊   | 265/391 [00:03<00:01, 87.54it/s] 70%|███████   | 275/391 [00:03<00:01, 90.07it/s] 73%|███████▎  | 285/391 [00:04<00:01, 91.27it/s] 75%|███████▌  | 295/391 [00:04<00:01, 92.59it/s] 78%|███████▊  | 305/391 [00:04<00:00, 93.24it/s] 81%|████████  | 315/391 [00:04<00:00, 93.74it/s] 83%|████████▎ | 325/391 [00:04<00:00, 94.57it/s] 86%|████████▌ | 335/391 [00:04<00:00, 94.30it/s] 88%|████████▊ | 345/391 [00:04<00:00, 94.61it/s] 91%|█████████ | 355/391 [00:04<00:00, 94.93it/s] 93%|█████████▎| 365/391 [00:04<00:00, 94.86it/s] 96%|█████████▌| 375/391 [00:04<00:00, 95.74it/s] 98%|█████████▊| 385/391 [00:05<00:00, 96.42it/s]100%|██████████| 391/391 [00:05<00:00, 75.76it/s]
50000 images processed, 5.208724498748779 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:42,  1.86it/s] 11%|█▏        | 9/79 [00:00<00:03, 18.19it/s] 24%|██▍       | 19/79 [00:00<00:01, 36.44it/s] 37%|███▋      | 29/79 [00:00<00:00, 51.27it/s] 49%|████▉     | 39/79 [00:00<00:00, 62.03it/s] 62%|██████▏   | 49/79 [00:01<00:00, 71.05it/s] 75%|███████▍  | 59/79 [00:01<00:00, 78.26it/s] 87%|████████▋ | 69/79 [00:01<00:00, 83.64it/s]100%|██████████| 79/79 [00:01<00:00, 85.92it/s]100%|██████████| 79/79 [00:01<00:00, 57.09it/s]
10000 images processed, 1.395353078842163 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:52,  1.81it/s]  2%|▏         | 5/204 [00:00<00:20,  9.60it/s]  7%|▋         | 15/204 [00:00<00:06, 29.45it/s] 12%|█▏        | 25/204 [00:00<00:03, 45.74it/s] 17%|█▋        | 35/204 [00:00<00:02, 58.19it/s] 22%|██▏       | 45/204 [00:01<00:02, 67.28it/s] 27%|██▋       | 55/204 [00:01<00:01, 74.61it/s] 31%|███▏      | 64/204 [00:01<00:01, 76.64it/s] 36%|███▋      | 74/204 [00:01<00:01, 81.39it/s] 41%|████      | 83/204 [00:01<00:01, 83.42it/s] 46%|████▌     | 93/204 [00:01<00:01, 86.35it/s] 50%|█████     | 102/204 [00:01<00:01, 87.30it/s] 55%|█████▍    | 112/204 [00:01<00:01, 89.24it/s] 60%|█████▉    | 122/204 [00:01<00:00, 88.11it/s] 64%|██████▍   | 131/204 [00:02<00:00, 87.55it/s] 69%|██████▉   | 141/204 [00:02<00:00, 89.68it/s] 74%|███████▍  | 151/204 [00:02<00:00, 90.48it/s] 79%|███████▉  | 161/204 [00:02<00:00, 91.58it/s] 84%|████████▍ | 171/204 [00:02<00:00, 92.23it/s] 89%|████████▊ | 181/204 [00:02<00:00, 93.41it/s] 94%|█████████▎| 191/204 [00:02<00:00, 94.42it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.09it/s]100%|██████████| 204/204 [00:02<00:00, 72.25it/s]
26032 images processed, 2.8707032203674316 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:00,  1.28it/s] 13%|█▎        | 10/79 [00:00<00:04, 14.92it/s] 22%|██▏       | 17/79 [00:01<00:02, 22.70it/s] 34%|███▍      | 27/79 [00:01<00:01, 37.00it/s] 46%|████▌     | 36/79 [00:01<00:00, 47.74it/s] 58%|█████▊    | 46/79 [00:01<00:00, 59.02it/s] 70%|██████▉   | 55/79 [00:01<00:00, 63.10it/s] 82%|████████▏ | 65/79 [00:01<00:00, 71.55it/s] 94%|█████████▎| 74/79 [00:01<00:00, 74.27it/s]100%|██████████| 79/79 [00:01<00:00, 45.14it/s]
10000 images processed, 1.8036057949066162 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:01<01:27,  1.12s/it] 13%|█▎        | 10/79 [00:01<00:06, 10.84it/s] 24%|██▍       | 19/79 [00:01<00:02, 21.67it/s] 37%|███▋      | 29/79 [00:01<00:01, 34.12it/s] 49%|████▉     | 39/79 [00:01<00:00, 46.11it/s] 62%|██████▏   | 49/79 [00:01<00:00, 56.97it/s] 75%|███████▍  | 59/79 [00:01<00:00, 66.33it/s] 87%|████████▋ | 69/79 [00:01<00:00, 74.06it/s]100%|██████████| 79/79 [00:01<00:00, 40.48it/s]
10000 images processed, 1.9739878177642822 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:42,  1.62it/s] 10%|█         | 7/70 [00:00<00:05, 12.51it/s] 24%|██▍       | 17/70 [00:00<00:01, 30.51it/s] 37%|███▋      | 26/70 [00:00<00:01, 43.40it/s] 51%|█████▏    | 36/70 [00:01<00:00, 55.63it/s] 66%|██████▌   | 46/70 [00:01<00:00, 66.25it/s] 80%|████████  | 56/70 [00:01<00:00, 74.52it/s] 94%|█████████▍| 66/70 [00:01<00:00, 80.72it/s]100%|██████████| 70/70 [00:01<00:00, 49.87it/s]
8925 images processed, 1.4368681907653809 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:55,  1.26s/it]  4%|▍         | 2/45 [00:01<00:28,  1.51it/s] 27%|██▋       | 12/45 [00:01<00:02, 12.53it/s] 38%|███▊      | 17/45 [00:02<00:02, 10.06it/s] 51%|█████     | 23/45 [00:02<00:01, 15.03it/s] 73%|███████▎  | 33/45 [00:02<00:00, 15.59it/s] 84%|████████▍ | 38/45 [00:03<00:00, 18.80it/s]100%|██████████| 45/45 [00:03<00:00, 14.22it/s]
5640 images processed, 3.1857478618621826 seconds used

19.615952730178833
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.60
places365     49.92  89.49  51.36
LSUN          25.94  95.19  76.04
iSUN          26.01  95.03  73.73
dtd           24.68  94.43  71.73
AVG           26.02  94.63  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
3.2061049938201904
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=45, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/45 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/45 [00:17<13:03, 17.81s/it]  4%|▍         | 2/45 [00:27<09:31, 13.29s/it]  7%|▋         | 3/45 [00:38<08:23, 12.00s/it]  9%|▉         | 4/45 [00:48<07:46, 11.39s/it] 11%|█         | 5/45 [00:59<07:18, 10.96s/it] 13%|█▎        | 6/45 [01:10<07:18, 11.24s/it][loss] ep 0 it 0 total=12.0911 mle=2.3148 pcon=8.7277 forget=0.0000 orth=1.0486 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0666 mle=2.2863 pcon=8.7319 forget=0.0000 orth=1.0485 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2135 mle=2.4299 pcon=8.7353 forget=0.0000 orth=1.0484 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1215 mle=2.3345 pcon=8.7388 forget=0.0000 orth=1.0482 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7750 mle=1.9852 pcon=8.7418 forget=0.0000 orth=1.0480 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=11.9872 mle=2.1951 pcon=8.7444 forget=0.0000 orth=1.0477 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4180 mle=2.6240 pcon=8.7466 forget=0.0000 orth=1.0474 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9928 mle=2.1974 pcon=8.7483 forget=0.0000 orth=1.0471 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9502 mle=2.1530 pcon=8.7505 forget=0.0000 orth=1.0467 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9380 mle=2.1392 pcon=8.7524 forget=0.0000 orth=1.0463 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0897 mle=2.2898 pcon=8.7540 forget=0.0000 orth=1.0459 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3275 mle=2.5264 pcon=8.7556 forget=0.0000 orth=1.0454 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2572 mle=2.4555 pcon=8.7567 forget=0.0000 orth=1.0450 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.8904 mle=2.0880 pcon=8.7580 forget=0.0000 orth=1.0445 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.1922 mle=2.3892 pcon=8.7592 forget=0.0000 orth=1.0439 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0807 mle=2.2771 pcon=8.7603 forget=0.0000 orth=1.0433 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0150 mle=2.2114 pcon=8.7611 forget=0.0000 orth=1.0425 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0753 mle=2.2714 pcon=8.7621 forget=0.0000 orth=1.0418 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9125 mle=2.1077 pcon=8.7636 forget=0.0000 orth=1.0411 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9621 mle=2.1570 pcon=8.7647 forget=0.0000 orth=1.0403 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5838 mle=1.7783 pcon=8.7660 forget=0.0000 orth=1.0396 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1268 mle=2.3213 pcon=8.7666 forget=0.0000 orth=1.0388 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1814 mle=2.3761 pcon=8.7674 forget=0.0000 orth=1.0379 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6931 mle=1.8873 pcon=8.7688 forget=0.0000 orth=1.0370 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0741 mle=2.2690 pcon=8.7691 forget=0.0000 orth=1.0360 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1937 mle=2.3885 pcon=8.7703 forget=0.0000 orth=1.0349 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1310 mle=2.3260 pcon=8.7710 forget=0.0000 orth=1.0339 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0205 mle=2.2154 pcon=8.7723 forget=0.0000 orth=1.0329 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9361 mle=2.1307 pcon=8.7735 forget=0.0000 orth=1.0318 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9651 mle=2.1600 pcon=8.7745 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9503 mle=2.1456 pcon=8.7753 forget=0.0000 orth=1.0293 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.0060 mle=2.2019 pcon=8.7760 forget=0.0000 orth=1.0281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0141 mle=2.2098 pcon=8.7775 forget=0.0000 orth=1.0268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0258 mle=2.2213 pcon=8.7787 forget=0.0000 orth=1.0259 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1450 mle=2.3407 pcon=8.7796 forget=0.0000 orth=1.0247 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8311 mle=2.0273 pcon=8.7804 forget=0.0000 orth=1.0234 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8796 mle=2.0765 pcon=8.7812 forget=0.0000 orth=1.0219 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8370 mle=2.0337 pcon=8.7826 forget=0.0000 orth=1.0206 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1786 mle=2.3753 pcon=8.7836 forget=0.0000 orth=1.0196 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.8034 mle=2.0001 pcon=8.7849 forget=0.0000 orth=1.0184 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 5 it 45 total=11.9763 mle=2.1737 pcon=8.7855 forget=0.0000 orth=1.0170 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=11.8750 mle=2.0728 pcon=8.7868 forget=0.0000 orth=1.0154 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=11.9056 mle=2.1040 pcon=8.7875 forget=0.0000 orth=1.0142 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=11.9913 mle=2.1897 pcon=8.7890 forget=0.0000 orth=1.0127 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.0462 mle=2.2446 pcon=8.7902 forget=0.0000 orth=1.0114 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=11.7278 mle=1.9258 pcon=8.7920 forget=0.0000 orth=1.0100 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.1235 mle=2.3213 pcon=8.7937 forget=0.0000 orth=1.0086 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 6 it 4 total=11.9786 mle=2.1769 pcon=8.7943 forget=0.0000 orth=1.0074 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.0672 mle=2.2651 pcon=8.7961 forget=0.0000 orth=1.0061 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.8458 mle=2.0433 pcon=8.7979 forget=0.0000 orth=1.0046 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.6710 mle=1.8690 pcon=8.7987 forget=0.0000 orth=1.0032 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
 16%|█▌        | 7/45 [01:21<07:03, 11.16s/it] 18%|█▊        | 8/45 [01:32<06:47, 11.01s/it] 20%|██        | 9/45 [01:43<06:35, 10.98s/it] 22%|██▏       | 10/45 [01:53<06:17, 10.79s/it] 24%|██▍       | 11/45 [02:04<06:08, 10.83s/it] 27%|██▋       | 12/45 [02:15<06:00, 10.92s/it][loss] ep 6 it 204 total=11.8447 mle=2.0432 pcon=8.7998 forget=0.0000 orth=1.0016 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.8536 mle=2.0526 pcon=8.8007 forget=0.0000 orth=1.0003 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2111 mle=2.4095 pcon=8.8026 forget=0.0000 orth=0.9991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.7709 mle=1.9692 pcon=8.8039 forget=0.0000 orth=0.9977 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 7 it 13 total=12.1375 mle=2.3355 pcon=8.8056 forget=0.0000 orth=0.9965 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2205 mle=2.4181 pcon=8.8071 forget=0.0000 orth=0.9952 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0886 mle=2.2862 pcon=8.8087 forget=0.0000 orth=0.9937 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1134 mle=2.3103 pcon=8.8107 forget=0.0000 orth=0.9924 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9123 mle=2.1098 pcon=8.8113 forget=0.0000 orth=0.9911 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9887 mle=2.1854 pcon=8.8135 forget=0.0000 orth=0.9898 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8657 mle=2.0618 pcon=8.8154 forget=0.0000 orth=0.9885 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0132 mle=2.2090 pcon=8.8172 forget=0.0000 orth=0.9870 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 8 it 22 total=11.9792 mle=2.1748 pcon=8.8183 forget=0.0000 orth=0.9860 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8126 mle=2.0084 pcon=8.8197 forget=0.0000 orth=0.9845 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7032 mle=1.8991 pcon=8.8210 forget=0.0000 orth=0.9831 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5986 mle=1.7944 pcon=8.8224 forget=0.0000 orth=0.9818 favg=0.0000 nr=124 nf=1 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6302 mle=1.8259 pcon=8.8240 forget=0.0000 orth=0.9803 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.7917 mle=1.9877 pcon=8.8249 forget=0.0000 orth=0.9791 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8221 mle=2.0181 pcon=8.8263 forget=0.0000 orth=0.9777 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0347 mle=2.2300 pcon=8.8285 forget=0.0000 orth=0.9763 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 9 it 31 total=12.1875 mle=2.3827 pcon=8.8300 forget=0.0000 orth=0.9748 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9305 mle=2.1261 pcon=8.8308 forget=0.0000 orth=0.9736 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7377 mle=1.9342 pcon=8.8315 forget=0.0000 orth=0.9719 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8461 mle=2.0427 pcon=8.8325 forget=0.0000 orth=0.9709 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7755 mle=1.9713 pcon=8.8351 forget=0.0000 orth=0.9691 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8320 mle=2.0279 pcon=8.8367 forget=0.0000 orth=0.9674 favg=0.0000 nr=122 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9325 mle=2.1282 pcon=8.8388 forget=0.0000 orth=0.9656 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7588 mle=1.9544 pcon=8.8402 forget=0.0000 orth=0.9642 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 10 it 40 total=11.6743 mle=1.8699 pcon=8.8418 forget=0.0000 orth=0.9627 favg=0.0000 nr=123 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.1514 mle=2.3476 pcon=8.8427 forget=0.0000 orth=0.9611 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.8338 mle=2.0297 pcon=8.8448 forget=0.0000 orth=0.9593 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.8000 mle=1.9961 pcon=8.8465 forget=0.0000 orth=0.9574 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6463 mle=1.8434 pcon=8.8470 forget=0.0000 orth=0.9559 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0894 mle=2.2865 pcon=8.8492 forget=0.0000 orth=0.9537 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.7918 mle=1.9903 pcon=8.8498 forget=0.0000 orth=0.9517 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.0290 mle=2.2285 pcon=8.8510 forget=0.0000 orth=0.9495 favg=0.0000 nr=74 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 11 it 49 total=11.7756 mle=1.9756 pcon=8.8527 forget=0.0000 orth=0.9474 favg=0.0000 nr=117 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.0824 mle=2.2831 pcon=8.8539 forget=0.0000 orth=0.9454 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.9657 mle=2.1681 pcon=8.8546 forget=0.0000 orth=0.9429 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.8131 mle=2.0166 pcon=8.8558 forget=0.0000 orth=0.9407 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.6014 mle=1.8062 pcon=8.8569 forget=0.0000 orth=0.9382 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.9102 mle=2.1168 pcon=8.8579 forget=0.0000 orth=0.9355 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.6425 mle=1.8507 pcon=8.8590 forget=0.0000 orth=0.9327 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 12 it 8 total=11.9884 mle=2.1977 pcon=8.8607 forget=0.0000 orth=0.9300 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.7793 mle=1.9912 pcon=8.8613 forget=0.0000 orth=0.9268 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.9805 mle=2.1946 pcon=8.8622 forget=0.0000 orth=0.9236 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.7482 mle=1.9648 pcon=8.8632 forget=0.0000 orth=0.9203 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.7774 mle=1.9965 pcon=8.8643 forget=0.0000 orth=0.9166 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.0681 mle=2.2892 pcon=8.8659 forget=0.0000 orth=0.9130 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8763 mle=2.1012 pcon=8.8662 forget=0.0000 orth=0.9090 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9351 mle=2.1628 pcon=8.8673 forget=0.0000 orth=0.9050 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
 29%|██▉       | 13/45 [02:26<05:48, 10.89s/it] 31%|███       | 14/45 [02:37<05:38, 10.93s/it] 33%|███▎      | 15/45 [02:48<05:24, 10.82s/it] 36%|███▌      | 16/45 [02:58<05:11, 10.75s/it] 38%|███▊      | 17/45 [03:10<05:08, 11.01s/it] 40%|████      | 18/45 [03:20<04:51, 10.78s/it] 42%|████▏     | 19/45 [03:32<04:48, 11.10s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 13 it 17 total=11.9955 mle=2.2260 pcon=8.8690 forget=0.0000 orth=0.9006 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.7759 mle=2.0099 pcon=8.8698 forget=0.0000 orth=0.8962 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.0284 mle=2.2663 pcon=8.8705 forget=0.0000 orth=0.8915 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.8681 mle=2.1111 pcon=8.8701 forget=0.0000 orth=0.8868 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.0418 mle=2.2897 pcon=8.8704 forget=0.0000 orth=0.8817 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.9460 mle=2.1991 pcon=8.8705 forget=0.0000 orth=0.8764 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.8327 mle=2.0906 pcon=8.8712 forget=0.0000 orth=0.8708 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.8511 mle=2.1148 pcon=8.8712 forget=0.0000 orth=0.8651 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 14 it 26 total=12.0186 mle=2.2882 pcon=8.8713 forget=0.0000 orth=0.8591 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.7276 mle=2.0035 pcon=8.8710 forget=0.0000 orth=0.8531 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.7783 mle=2.0601 pcon=8.8715 forget=0.0000 orth=0.8467 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.9230 mle=2.2139 pcon=8.8689 forget=0.0000 orth=0.8402 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.6273 mle=1.9254 pcon=8.8685 forget=0.0000 orth=0.8334 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.8432 mle=2.1487 pcon=8.8679 forget=0.0000 orth=0.8267 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.7689 mle=2.0821 pcon=8.8672 forget=0.0000 orth=0.8195 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.5813 mle=1.9029 pcon=8.8662 forget=0.0000 orth=0.8122 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 15 it 35 total=11.7577 mle=2.0876 pcon=8.8655 forget=0.0000 orth=0.8047 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.7413 mle=2.0797 pcon=8.8645 forget=0.0000 orth=0.7970 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.6115 mle=1.9586 pcon=8.8634 forget=0.0000 orth=0.7894 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.6092 mle=1.9659 pcon=8.8619 forget=0.0000 orth=0.7813 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.8173 mle=2.1840 pcon=8.8600 forget=0.0000 orth=0.7733 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.6563 mle=2.0319 pcon=8.8594 forget=0.0000 orth=0.7650 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.8121 mle=2.1986 pcon=8.8569 forget=0.0000 orth=0.7566 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.5980 mle=1.9943 pcon=8.8558 forget=0.0000 orth=0.7479 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 16 it 44 total=11.7133 mle=2.1206 pcon=8.8535 forget=0.0000 orth=0.7392 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.7481 mle=2.1655 pcon=8.8523 forget=0.0000 orth=0.7303 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.5611 mle=1.9893 pcon=8.8504 forget=0.0000 orth=0.7214 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.5751 mle=2.0146 pcon=8.8482 forget=0.0000 orth=0.7123 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.4914 mle=1.9422 pcon=8.8461 forget=0.0000 orth=0.7030 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.3973 mle=1.8601 pcon=8.8436 forget=0.0000 orth=0.6936 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.5513 mle=2.0256 pcon=8.8417 forget=0.0000 orth=0.6841 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 17 it 3 total=11.2952 mle=1.7807 pcon=8.8400 forget=0.0000 orth=0.6745 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.3209 mle=1.8187 pcon=8.8375 forget=0.0000 orth=0.6648 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.4825 mle=1.9915 pcon=8.8360 forget=0.0000 orth=0.6549 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.3347 mle=1.8547 pcon=8.8351 forget=0.0000 orth=0.6449 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.3837 mle=1.9162 pcon=8.8326 forget=0.0000 orth=0.6350 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.4704 mle=2.0145 pcon=8.8310 forget=0.0000 orth=0.6249 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.3586 mle=1.9159 pcon=8.8280 forget=0.0000 orth=0.6147 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.4233 mle=1.9945 pcon=8.8244 forget=0.0000 orth=0.6044 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 18 it 12 total=11.3512 mle=1.9352 pcon=8.8219 forget=0.0000 orth=0.5941 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.6374 mle=2.2353 pcon=8.8185 forget=0.0000 orth=0.5837 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.3005 mle=1.9109 pcon=8.8164 forget=0.0000 orth=0.5732 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.4962 mle=2.1209 pcon=8.8125 forget=0.0000 orth=0.5629 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.4693 mle=2.1073 pcon=8.8097 forget=0.0000 orth=0.5524 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.3172 mle=1.9691 pcon=8.8062 forget=0.0000 orth=0.5419 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.2674 mle=1.9329 pcon=8.8030 forget=0.0000 orth=0.5315 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.1708 mle=1.8499 pcon=8.8000 forget=0.0000 orth=0.5210 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 19 it 21 total=11.2430 mle=1.9345 pcon=8.7980 forget=0.0000 orth=0.5105 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.3284 mle=2.0338 pcon=8.7946 forget=0.0000 orth=0.5000 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
 44%|████▍     | 20/45 [03:43<04:33, 10.93s/it] 47%|████▋     | 21/45 [03:53<04:20, 10.86s/it] 49%|████▉     | 22/45 [04:05<04:17, 11.18s/it] 51%|█████     | 23/45 [04:17<04:07, 11.26s/it] 53%|█████▎    | 24/45 [04:28<03:57, 11.31s/it] 56%|█████▌    | 25/45 [04:39<03:42, 11.14s/it][loss] ep 19 it 121 total=11.1965 mle=1.9150 pcon=8.7920 forget=0.0000 orth=0.4895 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.2806 mle=2.0117 pcon=8.7897 forget=0.0000 orth=0.4791 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.2546 mle=1.9982 pcon=8.7876 forget=0.0000 orth=0.4688 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.3319 mle=2.0891 pcon=8.7842 forget=0.0000 orth=0.4586 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.2936 mle=2.0639 pcon=8.7814 forget=0.0000 orth=0.4483 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.2662 mle=2.0495 pcon=8.7785 forget=0.0000 orth=0.4382 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 20 it 30 total=11.3334 mle=2.1296 pcon=8.7757 forget=0.0000 orth=0.4281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.1240 mle=1.9335 pcon=8.7724 forget=0.0000 orth=0.4182 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.2373 mle=2.0596 pcon=8.7693 forget=0.0000 orth=0.4084 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.2654 mle=2.1003 pcon=8.7666 forget=0.0000 orth=0.3985 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=10.9529 mle=1.8014 pcon=8.7628 forget=0.0000 orth=0.3887 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.1522 mle=2.0140 pcon=8.7590 forget=0.0000 orth=0.3792 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.3876 mle=2.2622 pcon=8.7556 forget=0.0000 orth=0.3698 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.2289 mle=2.1149 pcon=8.7536 forget=0.0000 orth=0.3604 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 21 it 39 total=11.1427 mle=2.0426 pcon=8.7489 forget=0.0000 orth=0.3513 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=10.9344 mle=1.8465 pcon=8.7458 forget=0.0000 orth=0.3422 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.0989 mle=2.0231 pcon=8.7426 forget=0.0000 orth=0.3333 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=10.9197 mle=1.8562 pcon=8.7391 forget=0.0000 orth=0.3245 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.1972 mle=2.1459 pcon=8.7355 forget=0.0000 orth=0.3159 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=10.9260 mle=1.8864 pcon=8.7322 forget=0.0000 orth=0.3074 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=10.9648 mle=1.9367 pcon=8.7290 forget=0.0000 orth=0.2990 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.1143 mle=2.0981 pcon=8.7251 forget=0.0000 orth=0.2911 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 22 it 48 total=11.1003 mle=2.0953 pcon=8.7219 forget=0.0000 orth=0.2831 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=10.9557 mle=1.9619 pcon=8.7185 forget=0.0000 orth=0.2753 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=10.9697 mle=1.9863 pcon=8.7159 forget=0.0000 orth=0.2676 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=10.8673 mle=1.8937 pcon=8.7136 forget=0.0000 orth=0.2600 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.0070 mle=2.0435 pcon=8.7109 forget=0.0000 orth=0.2526 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=10.9760 mle=2.0234 pcon=8.7072 forget=0.0000 orth=0.2454 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.1236 mle=2.1817 pcon=8.7035 forget=0.0000 orth=0.2384 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 23 it 7 total=10.9455 mle=2.0153 pcon=8.6987 forget=0.0000 orth=0.2315 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=10.9688 mle=2.0490 pcon=8.6950 forget=0.0000 orth=0.2249 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.6689 mle=1.7596 pcon=8.6908 forget=0.0000 orth=0.2184 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.1878 mle=2.2881 pcon=8.6876 forget=0.0000 orth=0.2120 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=10.9449 mle=2.0550 pcon=8.6841 forget=0.0000 orth=0.2058 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=10.9147 mle=2.0344 pcon=8.6804 forget=0.0000 orth=0.1998 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=10.9357 mle=2.0653 pcon=8.6763 forget=0.0000 orth=0.1941 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=10.7914 mle=1.9305 pcon=8.6725 forget=0.0000 orth=0.1884 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 24 it 16 total=10.9542 mle=2.1023 pcon=8.6690 forget=0.0000 orth=0.1829 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=10.7696 mle=1.9261 pcon=8.6659 forget=0.0000 orth=0.1776 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=10.9970 mle=2.1623 pcon=8.6623 forget=0.0000 orth=0.1724 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=10.9407 mle=2.1155 pcon=8.6580 forget=0.0000 orth=0.1672 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=10.7146 mle=1.8984 pcon=8.6537 forget=0.0000 orth=0.1624 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=10.7770 mle=1.9684 pcon=8.6508 forget=0.0000 orth=0.1578 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=10.7733 mle=1.9728 pcon=8.6473 forget=0.0000 orth=0.1531 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.0626 mle=2.2704 pcon=8.6435 forget=0.0000 orth=0.1487 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 25 it 25 total=10.6563 mle=1.8729 pcon=8.6391 forget=0.0000 orth=0.1443 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=10.7397 mle=1.9639 pcon=8.6357 forget=0.0000 orth=0.1401 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.0392 mle=2.2721 pcon=8.6309 forget=0.0000 orth=0.1361 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=10.7819 mle=2.0232 pcon=8.6265 forget=0.0000 orth=0.1323 favg=0.0000 nr=112 nf=10 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=10.5525 mle=1.8007 pcon=8.6233 forget=0.0000 orth=0.1285 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=10.8395 mle=2.0950 pcon=8.6197 forget=0.0000 orth=0.1248 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
 58%|█████▊    | 26/45 [04:49<03:28, 10.96s/it] 60%|██████    | 27/45 [05:01<03:20, 11.15s/it] 62%|██████▏   | 28/45 [05:13<03:12, 11.32s/it] 64%|██████▍   | 29/45 [05:23<02:58, 11.17s/it] 67%|██████▋   | 30/45 [05:34<02:43, 10.92s/it] 69%|██████▉   | 31/45 [05:45<02:33, 10.98s/it] 71%|███████   | 32/45 [05:55<02:20, 10.81s/it][loss] ep 25 it 325 total=10.6301 mle=1.8925 pcon=8.6164 forget=0.0000 orth=0.1212 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=10.8191 mle=2.0897 pcon=8.6115 forget=0.0000 orth=0.1179 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 26 it 34 total=10.5711 mle=1.8492 pcon=8.6073 forget=0.0000 orth=0.1146 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=10.8052 mle=2.0904 pcon=8.6035 forget=0.0000 orth=0.1114 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=10.7248 mle=2.0161 pcon=8.6004 forget=0.0000 orth=0.1083 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=10.7584 mle=2.0571 pcon=8.5960 forget=0.0000 orth=0.1053 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=10.6014 mle=1.9070 pcon=8.5920 forget=0.0000 orth=0.1025 favg=0.0000 nr=124 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=10.8294 mle=2.1415 pcon=8.5882 forget=0.0000 orth=0.0997 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=10.7140 mle=2.0325 pcon=8.5844 forget=0.0000 orth=0.0971 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=10.5600 mle=1.8841 pcon=8.5814 forget=0.0000 orth=0.0945 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 27 it 43 total=10.7870 mle=2.1172 pcon=8.5776 forget=0.0000 orth=0.0921 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=10.6930 mle=2.0292 pcon=8.5741 forget=0.0000 orth=0.0897 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=10.7913 mle=2.1329 pcon=8.5710 forget=0.0000 orth=0.0874 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=10.6791 mle=2.0270 pcon=8.5669 forget=0.0000 orth=0.0851 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=10.5984 mle=1.9525 pcon=8.5628 forget=0.0000 orth=0.0830 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=10.6271 mle=1.9875 pcon=8.5586 forget=0.0000 orth=0.0810 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.4378 mle=1.8038 pcon=8.5550 forget=0.0000 orth=0.0790 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 28 it 2 total=10.4855 mle=1.8576 pcon=8.5508 forget=0.0000 orth=0.0771 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=10.7796 mle=2.1578 pcon=8.5466 forget=0.0000 orth=0.0752 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=10.6155 mle=1.9993 pcon=8.5427 forget=0.0000 orth=0.0734 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=10.8196 mle=2.2085 pcon=8.5394 forget=0.0000 orth=0.0717 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=10.6903 mle=2.0847 pcon=8.5356 forget=0.0000 orth=0.0701 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=10.6527 mle=2.0520 pcon=8.5322 forget=0.0000 orth=0.0685 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.3722 mle=1.7765 pcon=8.5288 forget=0.0000 orth=0.0669 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=10.5489 mle=1.9590 pcon=8.5245 forget=0.0000 orth=0.0654 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 29 it 11 total=10.4366 mle=1.8529 pcon=8.5197 forget=0.0000 orth=0.0640 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=10.6539 mle=2.0741 pcon=8.5172 forget=0.0000 orth=0.0626 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=10.7972 mle=2.2216 pcon=8.5143 forget=0.0000 orth=0.0613 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.5280 mle=1.9569 pcon=8.5111 forget=0.0000 orth=0.0600 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=10.7522 mle=2.1862 pcon=8.5072 forget=0.0000 orth=0.0588 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=10.6319 mle=2.0696 pcon=8.5047 forget=0.0000 orth=0.0576 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=10.4992 mle=1.9414 pcon=8.5013 forget=0.0000 orth=0.0564 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=10.8556 mle=2.3027 pcon=8.4975 forget=0.0000 orth=0.0553 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 30 it 20 total=10.4629 mle=1.9149 pcon=8.4937 forget=0.0000 orth=0.0542 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=10.6632 mle=2.1201 pcon=8.4899 forget=0.0000 orth=0.0532 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.4105 mle=1.8716 pcon=8.4866 forget=0.0000 orth=0.0522 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=10.8781 mle=2.3430 pcon=8.4838 forget=0.0000 orth=0.0513 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=10.5831 mle=2.0522 pcon=8.4805 forget=0.0000 orth=0.0503 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.3556 mle=1.8290 pcon=8.4772 forget=0.0000 orth=0.0494 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=10.5452 mle=2.0226 pcon=8.4740 forget=0.0000 orth=0.0485 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=10.6157 mle=2.0972 pcon=8.4708 forget=0.0000 orth=0.0477 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 31 it 29 total=10.4281 mle=1.9137 pcon=8.4675 forget=0.0000 orth=0.0469 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=10.6244 mle=2.1150 pcon=8.4633 forget=0.0000 orth=0.0461 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=10.4795 mle=1.9739 pcon=8.4603 forget=0.0000 orth=0.0453 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=10.6903 mle=2.1887 pcon=8.4570 forget=0.0000 orth=0.0446 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=10.5987 mle=2.1018 pcon=8.4529 forget=0.0000 orth=0.0440 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.3298 mle=1.8365 pcon=8.4500 forget=0.0000 orth=0.0433 favg=0.0000 nr=118 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=10.5966 mle=2.1068 pcon=8.4472 forget=0.0000 orth=0.0426 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=10.6852 mle=2.1999 pcon=8.4434 forget=0.0000 orth=0.0420 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
 73%|███████▎  | 33/45 [06:06<02:08, 10.69s/it] 76%|███████▌  | 34/45 [06:17<01:59, 10.83s/it] 78%|███████▊  | 35/45 [06:28<01:49, 10.97s/it] 80%|████████  | 36/45 [06:39<01:38, 10.92s/it] 82%|████████▏ | 37/45 [06:50<01:28, 11.06s/it] 84%|████████▍ | 38/45 [07:02<01:17, 11.10s/it][loss] ep 32 it 38 total=10.4650 mle=1.9833 pcon=8.4403 forget=0.0000 orth=0.0414 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.4516 mle=1.9739 pcon=8.4369 forget=0.0000 orth=0.0408 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=10.4618 mle=1.9875 pcon=8.4341 forget=0.0000 orth=0.0402 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=10.6162 mle=2.1458 pcon=8.4307 forget=0.0000 orth=0.0397 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.2810 mle=1.8149 pcon=8.4269 forget=0.0000 orth=0.0392 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=10.3882 mle=1.9252 pcon=8.4244 forget=0.0000 orth=0.0387 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=10.6630 mle=2.2024 pcon=8.4224 forget=0.0000 orth=0.0382 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.2816 mle=1.8248 pcon=8.4191 forget=0.0000 orth=0.0377 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 33 it 47 total=10.6242 mle=2.1719 pcon=8.4151 forget=0.0000 orth=0.0372 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=10.6008 mle=2.1515 pcon=8.4124 forget=0.0000 orth=0.0368 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=10.5322 mle=2.0870 pcon=8.4088 forget=0.0000 orth=0.0364 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.2453 mle=1.8036 pcon=8.4058 forget=0.0000 orth=0.0359 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.3410 mle=1.9031 pcon=8.4024 forget=0.0000 orth=0.0356 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=10.5351 mle=2.1007 pcon=8.3993 forget=0.0000 orth=0.0352 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=10.6739 mle=2.2417 pcon=8.3974 forget=0.0000 orth=0.0348 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 34 it 6 total=10.6181 mle=2.1894 pcon=8.3943 forget=0.0000 orth=0.0344 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.3297 mle=1.9044 pcon=8.3912 forget=0.0000 orth=0.0341 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.3272 mle=1.9048 pcon=8.3887 forget=0.0000 orth=0.0338 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=10.4649 mle=2.0466 pcon=8.3849 forget=0.0000 orth=0.0334 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.2660 mle=1.8506 pcon=8.3824 forget=0.0000 orth=0.0331 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=10.3890 mle=1.9771 pcon=8.3791 forget=0.0000 orth=0.0328 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.3748 mle=1.9660 pcon=8.3763 forget=0.0000 orth=0.0325 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=10.5303 mle=2.1245 pcon=8.3735 forget=0.0000 orth=0.0323 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 35 it 15 total=10.3818 mle=1.9793 pcon=8.3704 forget=0.0000 orth=0.0320 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=10.4591 mle=2.0602 pcon=8.3671 forget=0.0000 orth=0.0317 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=10.5304 mle=2.1337 pcon=8.3652 forget=0.0000 orth=0.0315 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=10.5945 mle=2.2002 pcon=8.3631 forget=0.0000 orth=0.0312 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=10.5243 mle=2.1323 pcon=8.3611 forget=0.0000 orth=0.0310 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=10.4530 mle=2.0640 pcon=8.3583 forget=0.0000 orth=0.0308 favg=0.0000 nr=116 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=10.4752 mle=2.0895 pcon=8.3552 forget=0.0000 orth=0.0305 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=10.4534 mle=2.0700 pcon=8.3530 forget=0.0000 orth=0.0303 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 36 it 24 total=10.5415 mle=2.1599 pcon=8.3514 forget=0.0000 orth=0.0301 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=10.3399 mle=1.9620 pcon=8.3479 forget=0.0000 orth=0.0299 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=10.0750 mle=1.7002 pcon=8.3450 forget=0.0000 orth=0.0297 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=10.3796 mle=2.0086 pcon=8.3415 forget=0.0000 orth=0.0295 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=10.3277 mle=1.9601 pcon=8.3382 forget=0.0000 orth=0.0293 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=10.5256 mle=2.1599 pcon=8.3365 forget=0.0000 orth=0.0292 favg=0.0000 nr=115 nf=11 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=10.4764 mle=2.1124 pcon=8.3350 forget=0.0000 orth=0.0290 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=10.3868 mle=2.0251 pcon=8.3328 forget=0.0000 orth=0.0289 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 37 it 33 total=10.3842 mle=2.0247 pcon=8.3308 forget=0.0000 orth=0.0287 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=10.4772 mle=2.1201 pcon=8.3286 forget=0.0000 orth=0.0285 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=10.3301 mle=1.9752 pcon=8.3265 forget=0.0000 orth=0.0284 favg=0.0000 nr=116 nf=2 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=10.3982 mle=2.0460 pcon=8.3239 forget=0.0000 orth=0.0283 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=10.1722 mle=1.8216 pcon=8.3224 forget=0.0000 orth=0.0282 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=10.5858 mle=2.2387 pcon=8.3190 forget=0.0000 orth=0.0280 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=10.6170 mle=2.2722 pcon=8.3169 forget=0.0000 orth=0.0279 favg=0.0000 nr=110 nf=11 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=10.2897 mle=1.9477 pcon=8.3143 forget=0.0000 orth=0.0278 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 38 it 42 total=10.4331 mle=2.0936 pcon=8.3118 forget=0.0000 orth=0.0277 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=10.6413 mle=2.3048 pcon=8.3090 forget=0.0000 orth=0.0276 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=10.2466 mle=1.9121 pcon=8.3071 forget=0.0000 orth=0.0275 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=10.2086 mle=1.8750 pcon=8.3062 forget=0.0000 orth=0.0274 favg=0.0000 nr=122 nf=3 protos=None fproto_sim=NA
 87%|████████▋ | 39/45 [07:12<01:05, 10.99s/it] 89%|████████▉ | 40/45 [07:23<00:55, 11.02s/it] 91%|█████████ | 41/45 [07:33<00:42, 10.71s/it] 93%|█████████▎| 42/45 [07:44<00:31, 10.61s/it] 96%|█████████▌| 43/45 [07:54<00:20, 10.41s/it] 98%|█████████▊| 44/45 [08:05<00:10, 10.54s/it][loss] ep 38 it 242 total=10.3884 mle=2.0572 pcon=8.3039 forget=0.0000 orth=0.0273 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=10.4558 mle=2.1268 pcon=8.3018 forget=0.0000 orth=0.0272 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=10.1727 mle=1.8465 pcon=8.2991 forget=0.0000 orth=0.0271 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 39 it 1 total=10.5323 mle=2.2073 pcon=8.2980 forget=0.0000 orth=0.0270 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=10.2674 mle=1.9454 pcon=8.2951 forget=0.0000 orth=0.0269 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=10.4358 mle=2.1149 pcon=8.2941 forget=0.0000 orth=0.0269 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=10.3147 mle=1.9959 pcon=8.2921 forget=0.0000 orth=0.0268 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=10.4455 mle=2.1291 pcon=8.2897 forget=0.0000 orth=0.0267 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=10.3060 mle=1.9905 pcon=8.2889 forget=0.0000 orth=0.0267 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=10.3083 mle=1.9951 pcon=8.2866 forget=0.0000 orth=0.0266 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=10.4509 mle=2.1404 pcon=8.2839 forget=0.0000 orth=0.0265 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 40 it 10 total=10.2781 mle=1.9694 pcon=8.2823 forget=0.0000 orth=0.0265 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=10.2763 mle=1.9705 pcon=8.2793 forget=0.0000 orth=0.0264 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=10.3465 mle=2.0415 pcon=8.2786 forget=0.0000 orth=0.0264 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=10.2618 mle=1.9591 pcon=8.2764 forget=0.0000 orth=0.0263 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=10.3336 mle=2.0324 pcon=8.2749 forget=0.0000 orth=0.0263 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=10.3109 mle=2.0109 pcon=8.2738 forget=0.0000 orth=0.0262 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=10.5344 mle=2.2359 pcon=8.2723 forget=0.0000 orth=0.0262 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=10.3007 mle=2.0034 pcon=8.2711 forget=0.0000 orth=0.0262 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 41 it 19 total=10.4188 mle=2.1221 pcon=8.2705 forget=0.0000 orth=0.0261 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=10.5209 mle=2.2257 pcon=8.2692 forget=0.0000 orth=0.0261 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=10.5085 mle=2.2140 pcon=8.2684 forget=0.0000 orth=0.0261 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=10.3934 mle=2.1005 pcon=8.2669 forget=0.0000 orth=0.0260 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=10.2302 mle=1.9386 pcon=8.2656 forget=0.0000 orth=0.0260 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=10.0838 mle=1.7930 pcon=8.2648 forget=0.0000 orth=0.0260 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=10.5102 mle=2.2221 pcon=8.2622 forget=0.0000 orth=0.0260 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=10.3871 mle=2.1001 pcon=8.2611 forget=0.0000 orth=0.0259 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 42 it 28 total=10.3648 mle=2.0797 pcon=8.2591 forget=0.0000 orth=0.0259 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=10.3282 mle=2.0451 pcon=8.2572 forget=0.0000 orth=0.0259 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=10.3223 mle=2.0408 pcon=8.2556 forget=0.0000 orth=0.0259 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=10.2391 mle=1.9592 pcon=8.2539 forget=0.0000 orth=0.0259 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=10.1004 mle=1.8222 pcon=8.2524 forget=0.0000 orth=0.0259 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=10.3863 mle=2.1092 pcon=8.2512 forget=0.0000 orth=0.0258 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=10.2623 mle=1.9860 pcon=8.2505 forget=0.0000 orth=0.0258 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=10.3605 mle=2.0859 pcon=8.2488 forget=0.0000 orth=0.0258 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 43 it 37 total=10.3683 mle=2.0950 pcon=8.2475 forget=0.0000 orth=0.0258 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=10.2251 mle=1.9522 pcon=8.2471 forget=0.0000 orth=0.0258 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=10.5286 mle=2.2575 pcon=8.2453 forget=0.0000 orth=0.0258 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=10.2772 mle=2.0083 pcon=8.2431 forget=0.0000 orth=0.0258 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=10.3440 mle=2.0759 pcon=8.2423 forget=0.0000 orth=0.0258 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=10.3841 mle=2.1166 pcon=8.2417 forget=0.0000 orth=0.0258 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=10.3638 mle=2.0983 pcon=8.2397 forget=0.0000 orth=0.0258 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=10.1680 mle=1.9029 pcon=8.2393 forget=0.0000 orth=0.0258 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 44 it 46 total=10.3370 mle=2.0737 pcon=8.2375 forget=0.0000 orth=0.0258 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=10.2628 mle=2.0014 pcon=8.2356 forget=0.0000 orth=0.0258 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=10.5674 mle=2.3060 pcon=8.2356 forget=0.0000 orth=0.0258 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=10.6240 mle=2.3648 pcon=8.2334 forget=0.0000 orth=0.0258 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=10.2359 mle=1.9766 pcon=8.2335 forget=0.0000 orth=0.0258 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=10.3259 mle=2.0674 pcon=8.2328 forget=0.0000 orth=0.0258 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=10.2061 mle=1.9487 pcon=8.2316 forget=0.0000 orth=0.0258 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
100%|██████████| 45/45 [08:15<00:00, 10.39s/it]100%|██████████| 45/45 [08:15<00:00, 11.00s/it]
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:54,  1.67it/s]  3%|▎         | 11/391 [00:00<00:19, 19.70it/s]  5%|▌         | 20/391 [00:00<00:10, 34.04it/s]  8%|▊         | 30/391 [00:00<00:07, 48.45it/s] 10%|█         | 40/391 [00:01<00:05, 60.17it/s] 13%|█▎        | 49/391 [00:01<00:05, 63.94it/s] 15%|█▍        | 57/391 [00:01<00:04, 67.72it/s] 17%|█▋        | 67/391 [00:01<00:04, 75.13it/s] 20%|█▉        | 77/391 [00:01<00:03, 80.77it/s] 22%|██▏       | 87/391 [00:01<00:03, 83.88it/s] 25%|██▍       | 97/391 [00:01<00:03, 86.19it/s] 27%|██▋       | 107/391 [00:01<00:03, 88.68it/s] 30%|██▉       | 117/391 [00:01<00:03, 79.11it/s] 32%|███▏      | 127/391 [00:02<00:03, 82.76it/s] 35%|███▍      | 136/391 [00:02<00:03, 72.52it/s] 37%|███▋      | 144/391 [00:02<00:03, 65.97it/s] 39%|███▊      | 151/391 [00:02<00:03, 64.98it/s] 40%|████      | 158/391 [00:02<00:03, 62.68it/s] 42%|████▏     | 165/391 [00:02<00:03, 62.63it/s] 44%|████▍     | 173/391 [00:02<00:03, 66.08it/s] 46%|████▌     | 180/391 [00:02<00:03, 63.62it/s] 48%|████▊     | 187/391 [00:03<00:03, 59.27it/s] 50%|████▉     | 194/391 [00:03<00:03, 55.11it/s] 52%|█████▏    | 203/391 [00:03<00:03, 62.41it/s] 54%|█████▍    | 212/391 [00:03<00:02, 69.22it/s] 57%|█████▋    | 222/391 [00:03<00:02, 76.21it/s] 59%|█████▉    | 232/391 [00:03<00:01, 81.05it/s] 62%|██████▏   | 242/391 [00:03<00:01, 84.99it/s] 64%|██████▍   | 251/391 [00:03<00:01, 83.80it/s] 66%|██████▋   | 260/391 [00:04<00:01, 79.22it/s] 69%|██████▉   | 270/391 [00:04<00:01, 83.63it/s] 72%|███████▏  | 280/391 [00:04<00:01, 86.51it/s] 74%|███████▍  | 290/391 [00:04<00:01, 88.70it/s] 77%|███████▋  | 300/391 [00:04<00:01, 90.46it/s] 79%|███████▉  | 310/391 [00:04<00:00, 91.94it/s] 82%|████████▏ | 320/391 [00:04<00:00, 92.06it/s] 84%|████████▍ | 330/391 [00:04<00:00, 93.16it/s] 87%|████████▋ | 340/391 [00:04<00:00, 93.88it/s] 90%|████████▉ | 350/391 [00:04<00:00, 93.70it/s] 92%|█████████▏| 360/391 [00:05<00:00, 93.57it/s] 95%|█████████▍| 370/391 [00:05<00:00, 94.68it/s] 97%|█████████▋| 380/391 [00:05<00:00, 95.62it/s]100%|█████████▉| 390/391 [00:05<00:00, 96.30it/s]100%|██████████| 391/391 [00:05<00:00, 72.44it/s]
50000 images processed, 5.459766149520874 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.97it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.07it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.69it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.60it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.52it/s] 65%|██████▍   | 51/79 [00:01<00:00, 72.42it/s] 77%|███████▋  | 61/79 [00:01<00:00, 79.18it/s] 90%|████████▉ | 71/79 [00:01<00:00, 84.21it/s]100%|██████████| 79/79 [00:01<00:00, 58.73it/s]
10000 images processed, 1.3613865375518799 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:37,  1.29it/s]  5%|▌         | 11/204 [00:00<00:11, 16.46it/s] 10%|█         | 21/204 [00:00<00:05, 31.23it/s] 15%|█▌        | 31/204 [00:01<00:03, 44.41it/s] 20%|██        | 41/204 [00:01<00:02, 56.06it/s] 25%|██▌       | 51/204 [00:01<00:02, 64.95it/s] 30%|██▉       | 61/204 [00:01<00:01, 72.60it/s] 35%|███▍      | 71/204 [00:01<00:01, 78.28it/s] 40%|███▉      | 81/204 [00:01<00:01, 78.65it/s] 45%|████▍     | 91/204 [00:01<00:01, 82.80it/s] 50%|████▉     | 101/204 [00:01<00:01, 86.03it/s] 54%|█████▍    | 111/204 [00:01<00:01, 87.71it/s] 59%|█████▉    | 121/204 [00:02<00:00, 89.68it/s] 64%|██████▍   | 131/204 [00:02<00:00, 91.12it/s] 69%|██████▉   | 141/204 [00:02<00:00, 92.07it/s] 74%|███████▍  | 151/204 [00:02<00:00, 92.74it/s] 79%|███████▉  | 161/204 [00:02<00:00, 93.19it/s] 84%|████████▍ | 171/204 [00:02<00:00, 93.75it/s] 89%|████████▊ | 181/204 [00:02<00:00, 92.72it/s] 94%|█████████▎| 191/204 [00:02<00:00, 77.50it/s] 99%|█████████▊| 201/204 [00:03<00:00, 82.32it/s]100%|██████████| 204/204 [00:03<00:00, 66.36it/s]
26032 images processed, 3.227050304412842 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.58it/s]  3%|▎         | 2/79 [00:00<00:26,  2.96it/s] 15%|█▌        | 12/79 [00:00<00:03, 22.00it/s] 23%|██▎       | 18/79 [00:00<00:02, 29.77it/s] 35%|███▌      | 28/79 [00:01<00:01, 45.71it/s] 48%|████▊     | 38/79 [00:01<00:00, 58.02it/s] 58%|█████▊    | 46/79 [00:01<00:00, 61.52it/s] 68%|██████▊   | 54/79 [00:01<00:00, 57.87it/s] 77%|███████▋  | 61/79 [00:01<00:00, 56.84it/s] 89%|████████▊ | 70/79 [00:01<00:00, 65.01it/s]100%|██████████| 79/79 [00:01<00:00, 44.44it/s]
10000 images processed, 1.796462059020996 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.03it/s]  9%|▉         | 7/79 [00:00<00:04, 15.06it/s] 22%|██▏       | 17/79 [00:00<00:01, 35.21it/s] 34%|███▍      | 27/79 [00:00<00:01, 51.02it/s] 47%|████▋     | 37/79 [00:00<00:00, 63.12it/s] 59%|█████▉    | 47/79 [00:01<00:00, 72.06it/s] 71%|███████   | 56/79 [00:01<00:00, 67.66it/s] 81%|████████  | 64/79 [00:01<00:00, 58.81it/s] 90%|████████▉ | 71/79 [00:01<00:00, 58.83it/s]100%|██████████| 79/79 [00:01<00:00, 51.36it/s]
10000 images processed, 1.5605974197387695 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:42,  1.61it/s] 11%|█▏        | 8/70 [00:00<00:04, 14.27it/s] 24%|██▍       | 17/70 [00:00<00:01, 29.56it/s] 37%|███▋      | 26/70 [00:00<00:01, 43.19it/s] 50%|█████     | 35/70 [00:01<00:00, 54.40it/s] 64%|██████▍   | 45/70 [00:01<00:00, 65.41it/s] 79%|███████▊  | 55/70 [00:01<00:00, 73.97it/s] 91%|█████████▏| 64/70 [00:01<00:00, 78.24it/s]100%|██████████| 70/70 [00:01<00:00, 49.53it/s]
8925 images processed, 1.4434220790863037 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:45,  1.03s/it]  4%|▍         | 2/45 [00:01<00:25,  1.70it/s] 24%|██▍       | 11/45 [00:01<00:02, 12.54it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.00it/s] 47%|████▋     | 21/45 [00:01<00:01, 17.80it/s] 58%|█████▊    | 26/45 [00:01<00:00, 22.95it/s] 71%|███████   | 32/45 [00:02<00:00, 29.56it/s] 82%|████████▏ | 37/45 [00:02<00:00, 18.04it/s]100%|██████████| 45/45 [00:02<00:00, 17.11it/s]
5640 images processed, 2.650024652481079 seconds used

19.449174880981445
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           9.22  98.41  81.13
places365     57.17  86.66  52.33
LSUN          27.82  94.47  73.66
iSUN          47.23  91.59  70.50
dtd           21.67  95.96  84.77
AVG           32.62  93.42  72.48
[incremental] Overall: 0.7640 New: 0.7340 Old: 0.7940
[incremental] Final(Top-1): 0.7640  Average: 0.8060
3.3016459941864014
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=45, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/45 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/45 [00:18<13:22, 18.23s/it]  4%|▍         | 2/45 [00:28<09:54, 13.82s/it]  7%|▋         | 3/45 [00:39<08:42, 12.44s/it]  9%|▉         | 4/45 [00:50<07:58, 11.67s/it] 11%|█         | 5/45 [01:02<07:55, 11.89s/it] 13%|█▎        | 6/45 [01:12<07:18, 11.24s/it][loss] ep 0 it 0 total=15.2470 mle=2.5474 pcon=9.4393 forget=0.0000 orth=3.2604 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=15.2517 mle=2.5516 pcon=9.4413 forget=0.0000 orth=3.2588 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=15.2686 mle=2.5699 pcon=9.4431 forget=0.0000 orth=3.2556 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=15.0684 mle=2.3748 pcon=9.4433 forget=0.0000 orth=3.2502 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=14.8134 mle=2.1275 pcon=9.4433 forget=0.0000 orth=3.2427 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=14.9131 mle=2.2382 pcon=9.4421 forget=0.0000 orth=3.2328 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=15.2600 mle=2.5982 pcon=9.4411 forget=0.0000 orth=3.2207 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=14.9432 mle=2.2979 pcon=9.4391 forget=0.0000 orth=3.2062 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=14.8777 mle=2.2513 pcon=9.4369 forget=0.0000 orth=3.1894 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=14.8794 mle=2.2753 pcon=9.4340 forget=0.0000 orth=3.1701 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=14.8897 mle=2.3106 pcon=9.4309 forget=0.0000 orth=3.1482 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=15.0081 mle=2.4577 pcon=9.4268 forget=0.0000 orth=3.1236 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=14.9060 mle=2.3879 pcon=9.4219 forget=0.0000 orth=3.0962 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=14.5461 mle=2.0630 pcon=9.4171 forget=0.0000 orth=3.0660 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=14.7766 mle=2.3313 pcon=9.4124 forget=0.0000 orth=3.0328 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=14.7164 mle=2.3125 pcon=9.4076 forget=0.0000 orth=2.9963 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=14.4917 mle=2.1320 pcon=9.4029 forget=0.0000 orth=2.9568 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=14.5312 mle=2.2196 pcon=9.3978 forget=0.0000 orth=2.9137 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=14.2876 mle=2.0278 pcon=9.3926 forget=0.0000 orth=2.8673 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=14.3531 mle=2.1482 pcon=9.3878 forget=0.0000 orth=2.8171 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=14.0018 mle=1.8560 pcon=9.3826 forget=0.0000 orth=2.7631 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=14.3549 mle=2.2726 pcon=9.3768 forget=0.0000 orth=2.7055 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=14.2499 mle=2.2342 pcon=9.3717 forget=0.0000 orth=2.6440 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.7586 mle=1.8129 pcon=9.3669 forget=0.0000 orth=2.5787 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=13.9991 mle=2.1279 pcon=9.3614 forget=0.0000 orth=2.5098 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=14.0348 mle=2.2409 pcon=9.3563 forget=0.0000 orth=2.4375 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.8700 mle=2.1574 pcon=9.3507 forget=0.0000 orth=2.3619 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.7157 mle=2.0869 pcon=9.3453 forget=0.0000 orth=2.2834 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.5155 mle=1.9741 pcon=9.3390 forget=0.0000 orth=2.2024 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.4947 mle=2.0412 pcon=9.3337 forget=0.0000 orth=2.1199 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.4131 mle=2.0495 pcon=9.3275 forget=0.0000 orth=2.0361 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.3427 mle=2.0688 pcon=9.3227 forget=0.0000 orth=1.9512 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=13.2919 mle=2.1080 pcon=9.3175 forget=0.0000 orth=1.8664 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.2012 mle=2.1078 pcon=9.3115 forget=0.0000 orth=1.7819 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.1022 mle=2.0976 pcon=9.3060 forget=0.0000 orth=1.6986 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.8641 mle=1.9463 pcon=9.3005 forget=0.0000 orth=1.6173 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.7622 mle=1.9286 pcon=9.2955 forget=0.0000 orth=1.5380 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.6949 mle=1.9422 pcon=9.2909 forget=0.0000 orth=1.4618 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.9497 mle=2.2752 pcon=9.2861 forget=0.0000 orth=1.3884 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.5464 mle=1.9459 pcon=9.2815 forget=0.0000 orth=1.3189 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 5 it 45 total=12.5917 mle=2.0630 pcon=9.2764 forget=0.0000 orth=1.2523 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.4682 mle=2.0068 pcon=9.2721 forget=0.0000 orth=1.1892 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.4052 mle=2.0084 pcon=9.2667 forget=0.0000 orth=1.1301 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.3845 mle=2.0473 pcon=9.2626 forget=0.0000 orth=1.0746 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.3654 mle=2.0843 pcon=9.2585 forget=0.0000 orth=1.0226 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.1015 mle=1.8736 pcon=9.2540 forget=0.0000 orth=0.9739 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.3512 mle=2.1729 pcon=9.2500 forget=0.0000 orth=0.9283 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 6 it 4 total=12.1915 mle=2.0595 pcon=9.2462 forget=0.0000 orth=0.8858 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.2137 mle=2.1250 pcon=9.2421 forget=0.0000 orth=0.8466 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.9507 mle=1.9025 pcon=9.2382 forget=0.0000 orth=0.8100 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.7976 mle=1.7885 pcon=9.2335 forget=0.0000 orth=0.7757 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
 16%|█▌        | 7/45 [01:22<06:55, 10.94s/it] 18%|█▊        | 8/45 [01:32<06:33, 10.63s/it] 20%|██        | 9/45 [01:43<06:18, 10.50s/it] 22%|██▏       | 10/45 [01:53<06:05, 10.45s/it] 24%|██▍       | 11/45 [02:05<06:11, 10.91s/it] 27%|██▋       | 12/45 [02:16<06:04, 11.06s/it][loss] ep 6 it 204 total=11.9803 mle=2.0073 pcon=9.2291 forget=0.0000 orth=0.7439 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.9804 mle=2.0410 pcon=9.2249 forget=0.0000 orth=0.7145 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.1955 mle=2.2875 pcon=9.2207 forget=0.0000 orth=0.6873 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.8311 mle=1.9519 pcon=9.2172 forget=0.0000 orth=0.6620 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 7 it 13 total=12.0542 mle=2.2023 pcon=9.2135 forget=0.0000 orth=0.6384 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.1533 mle=2.3272 pcon=9.2094 forget=0.0000 orth=0.6167 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=11.9763 mle=2.1748 pcon=9.2055 forget=0.0000 orth=0.5961 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.0155 mle=2.2365 pcon=9.2020 forget=0.0000 orth=0.5770 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.7429 mle=1.9848 pcon=9.1986 forget=0.0000 orth=0.5595 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9238 mle=2.1861 pcon=9.1947 forget=0.0000 orth=0.5430 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.7047 mle=1.9852 pcon=9.1918 forget=0.0000 orth=0.5277 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=11.8421 mle=2.1397 pcon=9.1888 forget=0.0000 orth=0.5136 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 8 it 22 total=11.7441 mle=2.0593 pcon=9.1848 forget=0.0000 orth=0.5000 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.6015 mle=1.9325 pcon=9.1817 forget=0.0000 orth=0.4873 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.5343 mle=1.8807 pcon=9.1783 forget=0.0000 orth=0.4754 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.3898 mle=1.7511 pcon=9.1745 forget=0.0000 orth=0.4642 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.3596 mle=1.7343 pcon=9.1718 forget=0.0000 orth=0.4536 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.5647 mle=1.9531 pcon=9.1681 forget=0.0000 orth=0.4434 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.6270 mle=2.0287 pcon=9.1645 forget=0.0000 orth=0.4339 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=11.7143 mle=2.1285 pcon=9.1607 forget=0.0000 orth=0.4251 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 9 it 31 total=11.8303 mle=2.2566 pcon=9.1570 forget=0.0000 orth=0.4166 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.5929 mle=2.0302 pcon=9.1540 forget=0.0000 orth=0.4086 favg=0.0000 nr=110 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.4473 mle=1.8954 pcon=9.1511 forget=0.0000 orth=0.4008 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.5880 mle=2.0473 pcon=9.1474 forget=0.0000 orth=0.3933 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.4294 mle=1.8973 pcon=9.1453 forget=0.0000 orth=0.3868 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.5585 mle=2.0370 pcon=9.1412 forget=0.0000 orth=0.3803 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.6584 mle=2.1471 pcon=9.1375 forget=0.0000 orth=0.3737 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.4377 mle=1.9360 pcon=9.1345 forget=0.0000 orth=0.3673 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 10 it 40 total=11.3752 mle=1.8823 pcon=9.1312 forget=0.0000 orth=0.3616 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=11.7221 mle=2.2391 pcon=9.1269 forget=0.0000 orth=0.3561 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.4136 mle=1.9390 pcon=9.1240 forget=0.0000 orth=0.3507 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.4301 mle=1.9640 pcon=9.1205 forget=0.0000 orth=0.3457 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.2962 mle=1.8388 pcon=9.1167 forget=0.0000 orth=0.3407 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=11.7265 mle=2.2765 pcon=9.1137 forget=0.0000 orth=0.3363 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.3316 mle=1.8894 pcon=9.1104 forget=0.0000 orth=0.3317 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=11.6451 mle=2.2113 pcon=9.1065 forget=0.0000 orth=0.3274 favg=0.0000 nr=68 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 11 it 49 total=11.3585 mle=1.9321 pcon=9.1032 forget=0.0000 orth=0.3232 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.5962 mle=2.1777 pcon=9.0991 forget=0.0000 orth=0.3194 favg=0.0000 nr=102 nf=11 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.5105 mle=2.0990 pcon=9.0959 forget=0.0000 orth=0.3156 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.3977 mle=1.9937 pcon=9.0920 forget=0.0000 orth=0.3119 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.1634 mle=1.7669 pcon=9.0881 forget=0.0000 orth=0.3084 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.4927 mle=2.1041 pcon=9.0836 forget=0.0000 orth=0.3050 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.2691 mle=1.8871 pcon=9.0803 forget=0.0000 orth=0.3018 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 12 it 8 total=11.5157 mle=2.1405 pcon=9.0766 forget=0.0000 orth=0.2986 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.3359 mle=1.9683 pcon=9.0720 forget=0.0000 orth=0.2956 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.4310 mle=2.0701 pcon=9.0685 forget=0.0000 orth=0.2924 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.3251 mle=1.9710 pcon=9.0645 forget=0.0000 orth=0.2896 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.2718 mle=1.9246 pcon=9.0605 forget=0.0000 orth=0.2867 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.5903 mle=2.2486 pcon=9.0579 forget=0.0000 orth=0.2839 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.4942 mle=2.1592 pcon=9.0540 forget=0.0000 orth=0.2810 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.3961 mle=2.0675 pcon=9.0503 forget=0.0000 orth=0.2783 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
 29%|██▉       | 13/45 [02:28<05:59, 11.24s/it] 31%|███       | 14/45 [02:39<05:49, 11.28s/it] 33%|███▎      | 15/45 [02:51<05:44, 11.47s/it] 36%|███▌      | 16/45 [03:02<05:30, 11.40s/it] 38%|███▊      | 17/45 [03:13<05:11, 11.11s/it] 40%|████      | 18/45 [03:24<04:56, 11.00s/it] 42%|████▏     | 19/45 [03:34<04:43, 10.91s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 13 it 17 total=11.4799 mle=2.1568 pcon=9.0471 forget=0.0000 orth=0.2760 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.2382 mle=1.9216 pcon=9.0431 forget=0.0000 orth=0.2735 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.5312 mle=2.2203 pcon=9.0398 forget=0.0000 orth=0.2711 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.4345 mle=2.1296 pcon=9.0360 forget=0.0000 orth=0.2689 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.4944 mle=2.1949 pcon=9.0330 forget=0.0000 orth=0.2666 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.4224 mle=2.1290 pcon=9.0290 forget=0.0000 orth=0.2644 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.3145 mle=2.0276 pcon=9.0247 forget=0.0000 orth=0.2622 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.4033 mle=2.1225 pcon=9.0206 forget=0.0000 orth=0.2601 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 14 it 26 total=11.5037 mle=2.2281 pcon=9.0174 forget=0.0000 orth=0.2582 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.2108 mle=1.9412 pcon=9.0136 forget=0.0000 orth=0.2560 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.2901 mle=2.0265 pcon=9.0096 forget=0.0000 orth=0.2541 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.4038 mle=2.1469 pcon=9.0047 forget=0.0000 orth=0.2522 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.1824 mle=1.9322 pcon=9.0000 forget=0.0000 orth=0.2503 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.4286 mle=2.1846 pcon=8.9955 forget=0.0000 orth=0.2485 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.3093 mle=2.0709 pcon=8.9916 forget=0.0000 orth=0.2468 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.0848 mle=1.8517 pcon=8.9879 forget=0.0000 orth=0.2451 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 15 it 35 total=11.2562 mle=2.0287 pcon=8.9840 forget=0.0000 orth=0.2435 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.2968 mle=2.0740 pcon=8.9809 forget=0.0000 orth=0.2419 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.1609 mle=1.9443 pcon=8.9764 forget=0.0000 orth=0.2402 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.2056 mle=1.9946 pcon=8.9725 forget=0.0000 orth=0.2385 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.3399 mle=2.1342 pcon=8.9687 forget=0.0000 orth=0.2370 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.1928 mle=1.9923 pcon=8.9650 forget=0.0000 orth=0.2355 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.3623 mle=2.1673 pcon=8.9612 forget=0.0000 orth=0.2339 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.1733 mle=1.9833 pcon=8.9574 forget=0.0000 orth=0.2325 favg=0.0000 nr=111 nf=1 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 16 it 44 total=11.3801 mle=2.1942 pcon=8.9546 forget=0.0000 orth=0.2313 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.3362 mle=2.1549 pcon=8.9511 forget=0.0000 orth=0.2301 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.2334 mle=2.0571 pcon=8.9476 forget=0.0000 orth=0.2287 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.1738 mle=2.0031 pcon=8.9432 forget=0.0000 orth=0.2274 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.1048 mle=1.9390 pcon=8.9397 forget=0.0000 orth=0.2260 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.0569 mle=1.8962 pcon=8.9361 forget=0.0000 orth=0.2246 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.2182 mle=2.0621 pcon=8.9326 forget=0.0000 orth=0.2235 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 17 it 3 total=10.9497 mle=1.7983 pcon=8.9292 forget=0.0000 orth=0.2222 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=10.9595 mle=1.8132 pcon=8.9252 forget=0.0000 orth=0.2211 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.1956 mle=2.0539 pcon=8.9219 forget=0.0000 orth=0.2198 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.0033 mle=1.8664 pcon=8.9183 forget=0.0000 orth=0.2186 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.0670 mle=1.9354 pcon=8.9142 forget=0.0000 orth=0.2175 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.1283 mle=2.0005 pcon=8.9115 forget=0.0000 orth=0.2163 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.0241 mle=1.9005 pcon=8.9084 forget=0.0000 orth=0.2152 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.0963 mle=1.9780 pcon=8.9042 forget=0.0000 orth=0.2141 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 18 it 12 total=11.1163 mle=2.0031 pcon=8.9002 forget=0.0000 orth=0.2131 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.3181 mle=2.2094 pcon=8.8966 forget=0.0000 orth=0.2121 favg=0.0000 nr=110 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=10.9823 mle=1.8773 pcon=8.8938 forget=0.0000 orth=0.2111 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.1671 mle=2.0674 pcon=8.8896 forget=0.0000 orth=0.2102 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.1762 mle=2.0816 pcon=8.8855 forget=0.0000 orth=0.2091 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.0691 mle=1.9797 pcon=8.8814 forget=0.0000 orth=0.2081 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.0560 mle=1.9707 pcon=8.8781 forget=0.0000 orth=0.2071 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=10.9253 mle=1.8448 pcon=8.8743 forget=0.0000 orth=0.2062 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 19 it 21 total=11.0180 mle=1.9415 pcon=8.8713 forget=0.0000 orth=0.2052 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.1776 mle=2.1060 pcon=8.8673 forget=0.0000 orth=0.2043 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
 44%|████▍     | 20/45 [03:44<04:27, 10.69s/it] 47%|████▋     | 21/45 [03:56<04:25, 11.05s/it] 49%|████▉     | 22/45 [04:07<04:10, 10.88s/it] 51%|█████     | 23/45 [04:17<03:57, 10.82s/it] 53%|█████▎    | 24/45 [04:29<03:53, 11.10s/it] 56%|█████▌    | 25/45 [04:40<03:37, 10.89s/it][loss] ep 19 it 121 total=10.9498 mle=1.8824 pcon=8.8640 forget=0.0000 orth=0.2034 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.0705 mle=2.0078 pcon=8.8602 forget=0.0000 orth=0.2026 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.0991 mle=2.0403 pcon=8.8572 forget=0.0000 orth=0.2016 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.1346 mle=2.0803 pcon=8.8536 forget=0.0000 orth=0.2007 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.0909 mle=2.0402 pcon=8.8509 forget=0.0000 orth=0.1999 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.0730 mle=2.0258 pcon=8.8482 forget=0.0000 orth=0.1990 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 20 it 30 total=11.2239 mle=2.1802 pcon=8.8454 forget=0.0000 orth=0.1983 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=10.9400 mle=1.9004 pcon=8.8420 forget=0.0000 orth=0.1976 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.0841 mle=2.0483 pcon=8.8389 forget=0.0000 orth=0.1968 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.0898 mle=2.0582 pcon=8.8356 forget=0.0000 orth=0.1960 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=10.8757 mle=1.8482 pcon=8.8322 forget=0.0000 orth=0.1953 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.0323 mle=2.0092 pcon=8.8286 forget=0.0000 orth=0.1945 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.2778 mle=2.2586 pcon=8.8255 forget=0.0000 orth=0.1937 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.1350 mle=2.1190 pcon=8.8231 forget=0.0000 orth=0.1929 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 21 it 39 total=10.9887 mle=1.9778 pcon=8.8188 forget=0.0000 orth=0.1921 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=10.9131 mle=1.9066 pcon=8.8150 forget=0.0000 orth=0.1914 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.0957 mle=2.0929 pcon=8.8121 forget=0.0000 orth=0.1908 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=10.9389 mle=1.9400 pcon=8.8089 forget=0.0000 orth=0.1900 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.0945 mle=2.0993 pcon=8.8057 forget=0.0000 orth=0.1895 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=10.8665 mle=1.8749 pcon=8.8029 forget=0.0000 orth=0.1887 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=10.9402 mle=1.9516 pcon=8.8004 forget=0.0000 orth=0.1882 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.1243 mle=2.1407 pcon=8.7961 forget=0.0000 orth=0.1874 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 22 it 48 total=11.1059 mle=2.1257 pcon=8.7934 forget=0.0000 orth=0.1868 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=10.9444 mle=1.9679 pcon=8.7903 forget=0.0000 orth=0.1862 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.0107 mle=2.0376 pcon=8.7875 forget=0.0000 orth=0.1855 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=10.9021 mle=1.9315 pcon=8.7857 forget=0.0000 orth=0.1849 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.0036 mle=2.0366 pcon=8.7828 forget=0.0000 orth=0.1843 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=10.9731 mle=2.0095 pcon=8.7799 forget=0.0000 orth=0.1837 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.1013 mle=2.1423 pcon=8.7759 forget=0.0000 orth=0.1831 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 23 it 7 total=10.9016 mle=1.9460 pcon=8.7731 forget=0.0000 orth=0.1825 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.1148 mle=2.1631 pcon=8.7698 forget=0.0000 orth=0.1819 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.7297 mle=1.7816 pcon=8.7668 forget=0.0000 orth=0.1814 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.2238 mle=2.2785 pcon=8.7645 forget=0.0000 orth=0.1809 favg=0.0000 nr=107 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.0423 mle=2.1005 pcon=8.7615 forget=0.0000 orth=0.1803 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=10.9534 mle=2.0152 pcon=8.7584 forget=0.0000 orth=0.1798 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.0289 mle=2.0948 pcon=8.7548 forget=0.0000 orth=0.1793 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=10.8476 mle=1.9170 pcon=8.7518 forget=0.0000 orth=0.1788 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 24 it 16 total=11.0204 mle=2.0929 pcon=8.7492 forget=0.0000 orth=0.1783 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=10.8547 mle=1.9291 pcon=8.7479 forget=0.0000 orth=0.1778 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.0731 mle=2.1506 pcon=8.7454 forget=0.0000 orth=0.1771 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.0805 mle=2.1617 pcon=8.7423 forget=0.0000 orth=0.1765 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=10.8369 mle=1.9221 pcon=8.7387 forget=0.0000 orth=0.1760 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=10.9012 mle=1.9899 pcon=8.7357 forget=0.0000 orth=0.1756 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=10.8362 mle=1.9279 pcon=8.7332 forget=0.0000 orth=0.1751 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.1684 mle=2.2633 pcon=8.7304 forget=0.0000 orth=0.1746 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 25 it 25 total=10.8693 mle=1.9676 pcon=8.7277 forget=0.0000 orth=0.1741 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=10.9518 mle=2.0528 pcon=8.7254 forget=0.0000 orth=0.1736 favg=0.0000 nr=115 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.2080 mle=2.3132 pcon=8.7217 forget=0.0000 orth=0.1731 favg=0.0000 nr=104 nf=12 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=10.9019 mle=2.0102 pcon=8.7190 forget=0.0000 orth=0.1727 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=10.7686 mle=1.8794 pcon=8.7169 forget=0.0000 orth=0.1723 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.0478 mle=2.1615 pcon=8.7145 forget=0.0000 orth=0.1718 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
 58%|█████▊    | 26/45 [04:51<03:32, 11.18s/it] 60%|██████    | 27/45 [05:03<03:24, 11.38s/it] 62%|██████▏   | 28/45 [05:14<03:12, 11.31s/it] 64%|██████▍   | 29/45 [05:25<02:58, 11.14s/it] 67%|██████▋   | 30/45 [05:36<02:44, 10.97s/it] 69%|██████▉   | 31/45 [05:47<02:36, 11.17s/it] 71%|███████   | 32/45 [05:59<02:26, 11.23s/it][loss] ep 25 it 325 total=10.8217 mle=1.9381 pcon=8.7121 forget=0.0000 orth=0.1714 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=10.9561 mle=2.0752 pcon=8.7099 forget=0.0000 orth=0.1710 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 26 it 34 total=10.7697 mle=1.8918 pcon=8.7074 forget=0.0000 orth=0.1706 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.0394 mle=2.1655 pcon=8.7037 forget=0.0000 orth=0.1702 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=10.9705 mle=2.0988 pcon=8.7019 forget=0.0000 orth=0.1698 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=10.9079 mle=2.0384 pcon=8.7000 forget=0.0000 orth=0.1695 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=10.8219 mle=1.9555 pcon=8.6975 forget=0.0000 orth=0.1690 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=10.9698 mle=2.1067 pcon=8.6945 forget=0.0000 orth=0.1686 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=10.8770 mle=2.0172 pcon=8.6916 forget=0.0000 orth=0.1681 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=10.7861 mle=1.9285 pcon=8.6898 forget=0.0000 orth=0.1679 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 27 it 43 total=11.0300 mle=2.1749 pcon=8.6876 forget=0.0000 orth=0.1675 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=10.9099 mle=2.0570 pcon=8.6859 forget=0.0000 orth=0.1671 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=10.9940 mle=2.1433 pcon=8.6839 forget=0.0000 orth=0.1667 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=10.8538 mle=2.0057 pcon=8.6816 forget=0.0000 orth=0.1664 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=10.8233 mle=1.9776 pcon=8.6797 forget=0.0000 orth=0.1661 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=10.8903 mle=2.0467 pcon=8.6778 forget=0.0000 orth=0.1658 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.6629 mle=1.8223 pcon=8.6751 forget=0.0000 orth=0.1655 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 28 it 2 total=10.6881 mle=1.8499 pcon=8.6731 forget=0.0000 orth=0.1651 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=10.9552 mle=2.1194 pcon=8.6710 forget=0.0000 orth=0.1648 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=10.8955 mle=2.0617 pcon=8.6693 forget=0.0000 orth=0.1645 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.0142 mle=2.1824 pcon=8.6676 forget=0.0000 orth=0.1642 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=10.9758 mle=2.1469 pcon=8.6650 forget=0.0000 orth=0.1639 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=10.8951 mle=2.0685 pcon=8.6630 forget=0.0000 orth=0.1636 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.6065 mle=1.7811 pcon=8.6621 forget=0.0000 orth=0.1633 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=10.8611 mle=2.0381 pcon=8.6601 forget=0.0000 orth=0.1629 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 29 it 11 total=10.6546 mle=1.8350 pcon=8.6570 forget=0.0000 orth=0.1626 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=10.8913 mle=2.0729 pcon=8.6561 forget=0.0000 orth=0.1623 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=10.9837 mle=2.1670 pcon=8.6546 forget=0.0000 orth=0.1621 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.7186 mle=1.9045 pcon=8.6523 forget=0.0000 orth=0.1618 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.0088 mle=2.1973 pcon=8.6499 forget=0.0000 orth=0.1615 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=10.8606 mle=2.0511 pcon=8.6482 forget=0.0000 orth=0.1613 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=10.7601 mle=1.9522 pcon=8.6469 forget=0.0000 orth=0.1610 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.1032 mle=2.2970 pcon=8.6454 forget=0.0000 orth=0.1607 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 30 it 20 total=10.6843 mle=1.8803 pcon=8.6436 forget=0.0000 orth=0.1604 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=10.9747 mle=2.1723 pcon=8.6423 forget=0.0000 orth=0.1602 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.7577 mle=1.9575 pcon=8.6403 forget=0.0000 orth=0.1599 favg=0.0000 nr=116 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=11.1467 mle=2.3485 pcon=8.6385 forget=0.0000 orth=0.1597 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=10.8677 mle=2.0711 pcon=8.6371 forget=0.0000 orth=0.1595 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.6698 mle=1.8746 pcon=8.6359 forget=0.0000 orth=0.1592 favg=0.0000 nr=117 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=10.8415 mle=2.0484 pcon=8.6341 forget=0.0000 orth=0.1590 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=10.9144 mle=2.1232 pcon=8.6324 forget=0.0000 orth=0.1587 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 31 it 29 total=10.7099 mle=1.9207 pcon=8.6306 forget=0.0000 orth=0.1586 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=10.9545 mle=2.1677 pcon=8.6284 forget=0.0000 orth=0.1584 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=10.7973 mle=2.0122 pcon=8.6270 forget=0.0000 orth=0.1581 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=10.9604 mle=2.1770 pcon=8.6255 forget=0.0000 orth=0.1579 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=10.9172 mle=2.1370 pcon=8.6226 forget=0.0000 orth=0.1577 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.6498 mle=1.8712 pcon=8.6211 forget=0.0000 orth=0.1575 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=10.9159 mle=2.1385 pcon=8.6201 forget=0.0000 orth=0.1572 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=10.8780 mle=2.1032 pcon=8.6178 forget=0.0000 orth=0.1570 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
 73%|███████▎  | 33/45 [06:10<02:15, 11.29s/it] 76%|███████▌  | 34/45 [06:21<02:04, 11.27s/it] 78%|███████▊  | 35/45 [06:33<01:52, 11.26s/it] 80%|████████  | 36/45 [06:45<01:43, 11.52s/it] 82%|████████▏ | 37/45 [06:57<01:33, 11.68s/it] 84%|████████▍ | 38/45 [07:08<01:20, 11.57s/it][loss] ep 32 it 38 total=10.7795 mle=2.0066 pcon=8.6161 forget=0.0000 orth=0.1568 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.7422 mle=1.9717 pcon=8.6138 forget=0.0000 orth=0.1566 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=10.7724 mle=2.0033 pcon=8.6127 forget=0.0000 orth=0.1564 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=10.9413 mle=2.1745 pcon=8.6106 forget=0.0000 orth=0.1562 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.6289 mle=1.8638 pcon=8.6090 forget=0.0000 orth=0.1560 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=10.7599 mle=1.9958 pcon=8.6082 forget=0.0000 orth=0.1559 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=10.9503 mle=2.1874 pcon=8.6071 forget=0.0000 orth=0.1558 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.6422 mle=1.8811 pcon=8.6055 forget=0.0000 orth=0.1556 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 33 it 47 total=10.9566 mle=2.1972 pcon=8.6040 forget=0.0000 orth=0.1554 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=10.9447 mle=2.1863 pcon=8.6031 forget=0.0000 orth=0.1553 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=10.8373 mle=2.0805 pcon=8.6017 forget=0.0000 orth=0.1551 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.5758 mle=1.8207 pcon=8.6002 forget=0.0000 orth=0.1549 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.6864 mle=1.9327 pcon=8.5989 forget=0.0000 orth=0.1548 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=10.8827 mle=2.1313 pcon=8.5967 forget=0.0000 orth=0.1547 favg=0.0000 nr=112 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=11.0102 mle=2.2595 pcon=8.5961 forget=0.0000 orth=0.1545 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 34 it 6 total=11.0246 mle=2.2754 pcon=8.5948 forget=0.0000 orth=0.1544 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.6672 mle=1.9200 pcon=8.5929 forget=0.0000 orth=0.1543 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.6730 mle=1.9272 pcon=8.5916 forget=0.0000 orth=0.1542 favg=0.0000 nr=112 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=10.7488 mle=2.0057 pcon=8.5891 forget=0.0000 orth=0.1540 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.6105 mle=1.8685 pcon=8.5881 forget=0.0000 orth=0.1539 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=10.7773 mle=2.0373 pcon=8.5863 forget=0.0000 orth=0.1538 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.7593 mle=2.0203 pcon=8.5854 forget=0.0000 orth=0.1536 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=10.9115 mle=2.1739 pcon=8.5841 forget=0.0000 orth=0.1535 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 35 it 15 total=10.7929 mle=2.0568 pcon=8.5827 forget=0.0000 orth=0.1534 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=10.8235 mle=2.0893 pcon=8.5809 forget=0.0000 orth=0.1533 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=10.8486 mle=2.1156 pcon=8.5799 forget=0.0000 orth=0.1532 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=10.8951 mle=2.1633 pcon=8.5787 forget=0.0000 orth=0.1531 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=10.8801 mle=2.1493 pcon=8.5778 forget=0.0000 orth=0.1530 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=10.8239 mle=2.0948 pcon=8.5762 forget=0.0000 orth=0.1529 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=10.8250 mle=2.0978 pcon=8.5745 forget=0.0000 orth=0.1528 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=10.7733 mle=2.0468 pcon=8.5739 forget=0.0000 orth=0.1526 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 36 it 24 total=10.8336 mle=2.1073 pcon=8.5737 forget=0.0000 orth=0.1525 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=10.7393 mle=2.0149 pcon=8.5719 forget=0.0000 orth=0.1524 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=10.5073 mle=1.7843 pcon=8.5707 forget=0.0000 orth=0.1524 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=10.7938 mle=2.0719 pcon=8.5696 forget=0.0000 orth=0.1523 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=10.7161 mle=1.9955 pcon=8.5684 forget=0.0000 orth=0.1522 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=10.9012 mle=2.1816 pcon=8.5675 forget=0.0000 orth=0.1521 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=10.8019 mle=2.0830 pcon=8.5670 forget=0.0000 orth=0.1520 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=10.7410 mle=2.0228 pcon=8.5663 forget=0.0000 orth=0.1519 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=10.7246 mle=2.0077 pcon=8.5650 forget=0.0000 orth=0.1519 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=10.8707 mle=2.1547 pcon=8.5642 forget=0.0000 orth=0.1518 favg=0.0000 nr=103 nf=12 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=10.7037 mle=1.9890 pcon=8.5631 forget=0.0000 orth=0.1517 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=10.7858 mle=2.0719 pcon=8.5623 forget=0.0000 orth=0.1516 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=10.5043 mle=1.7902 pcon=8.5624 forget=0.0000 orth=0.1516 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=10.9804 mle=2.2680 pcon=8.5609 forget=0.0000 orth=0.1515 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=11.0450 mle=2.3332 pcon=8.5603 forget=0.0000 orth=0.1515 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=10.6967 mle=1.9864 pcon=8.5589 forget=0.0000 orth=0.1514 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 38 it 42 total=10.7381 mle=2.0287 pcon=8.5581 forget=0.0000 orth=0.1514 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=10.9508 mle=2.2423 pcon=8.5572 forget=0.0000 orth=0.1513 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=10.6637 mle=1.9559 pcon=8.5565 forget=0.0000 orth=0.1513 favg=0.0000 nr=115 nf=2 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=10.5909 mle=1.8840 pcon=8.5557 forget=0.0000 orth=0.1512 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=10.7626 mle=2.0572 pcon=8.5542 forget=0.0000 orth=0.1512 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=10.8251 mle=2.1208 pcon=8.5532 forget=0.0000 orth=0.1511 favg=0.0000 nr=107 nf=3 protos=None fproto_sim=NA
 87%|████████▋ | 39/45 [07:20<01:09, 11.58s/it] 89%|████████▉ | 40/45 [07:30<00:56, 11.30s/it] 91%|█████████ | 41/45 [07:42<00:45, 11.38s/it] 93%|█████████▎| 42/45 [07:53<00:33, 11.18s/it] 96%|█████████▌| 43/45 [08:04<00:22, 11.07s/it] 98%|█████████▊| 44/45 [08:16<00:11, 11.39s/it]100%|██████████| 45/45 [08:26<00:00, 11.10s/it]100%|██████████| 45/45 [08:26<00:00, 11.26s/it]
[loss] ep 38 it 342 total=10.5523 mle=1.8502 pcon=8.5510 forget=0.0000 orth=0.1511 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 39 it 1 total=10.9553 mle=2.2537 pcon=8.5505 forget=0.0000 orth=0.1510 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=10.6401 mle=1.9400 pcon=8.5491 forget=0.0000 orth=0.1510 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=10.8356 mle=2.1357 pcon=8.5490 forget=0.0000 orth=0.1509 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=10.7345 mle=2.0357 pcon=8.5479 forget=0.0000 orth=0.1509 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=10.7979 mle=2.1007 pcon=8.5463 forget=0.0000 orth=0.1509 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=10.7688 mle=2.0717 pcon=8.5462 forget=0.0000 orth=0.1508 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=10.7207 mle=2.0248 pcon=8.5451 forget=0.0000 orth=0.1508 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=10.8691 mle=2.1742 pcon=8.5441 forget=0.0000 orth=0.1508 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 40 it 10 total=10.6407 mle=1.9466 pcon=8.5433 forget=0.0000 orth=0.1508 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=10.6507 mle=1.9576 pcon=8.5423 forget=0.0000 orth=0.1507 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=10.6965 mle=2.0042 pcon=8.5416 forget=0.0000 orth=0.1507 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=10.6665 mle=1.9750 pcon=8.5408 forget=0.0000 orth=0.1507 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=10.7127 mle=2.0220 pcon=8.5400 forget=0.0000 orth=0.1507 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=10.7223 mle=2.0320 pcon=8.5396 forget=0.0000 orth=0.1507 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=10.9318 mle=2.2421 pcon=8.5391 forget=0.0000 orth=0.1506 favg=0.0000 nr=106 nf=2 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=10.6850 mle=1.9958 pcon=8.5385 forget=0.0000 orth=0.1506 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 41 it 19 total=10.7904 mle=2.1021 pcon=8.5377 forget=0.0000 orth=0.1506 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=10.8630 mle=2.1747 pcon=8.5377 forget=0.0000 orth=0.1506 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=10.9507 mle=2.2628 pcon=8.5372 forget=0.0000 orth=0.1506 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=10.8159 mle=2.1292 pcon=8.5362 forget=0.0000 orth=0.1506 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=10.6406 mle=1.9541 pcon=8.5359 forget=0.0000 orth=0.1505 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=10.5660 mle=1.8805 pcon=8.5350 forget=0.0000 orth=0.1505 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=10.9085 mle=2.2234 pcon=8.5346 forget=0.0000 orth=0.1505 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=10.8263 mle=2.1417 pcon=8.5341 forget=0.0000 orth=0.1505 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 42 it 28 total=10.8029 mle=2.1189 pcon=8.5335 forget=0.0000 orth=0.1505 favg=0.0000 nr=110 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=10.7044 mle=2.0203 pcon=8.5336 forget=0.0000 orth=0.1505 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=10.7247 mle=2.0408 pcon=8.5334 forget=0.0000 orth=0.1505 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=10.6720 mle=1.9886 pcon=8.5329 forget=0.0000 orth=0.1505 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=10.5612 mle=1.8790 pcon=8.5318 forget=0.0000 orth=0.1504 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=10.8242 mle=2.1428 pcon=8.5309 forget=0.0000 orth=0.1504 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=10.7057 mle=2.0252 pcon=8.5300 forget=0.0000 orth=0.1504 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=10.7175 mle=2.0377 pcon=8.5294 forget=0.0000 orth=0.1504 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 43 it 37 total=10.7567 mle=2.0770 pcon=8.5292 forget=0.0000 orth=0.1504 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=10.6367 mle=1.9579 pcon=8.5284 forget=0.0000 orth=0.1504 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=10.9895 mle=2.3116 pcon=8.5275 forget=0.0000 orth=0.1504 favg=0.0000 nr=104 nf=13 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=10.7112 mle=2.0345 pcon=8.5263 forget=0.0000 orth=0.1504 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=10.7880 mle=2.1113 pcon=8.5263 forget=0.0000 orth=0.1504 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=10.7725 mle=2.0968 pcon=8.5254 forget=0.0000 orth=0.1504 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=10.7601 mle=2.0847 pcon=8.5250 forget=0.0000 orth=0.1504 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=10.6078 mle=1.9328 pcon=8.5246 forget=0.0000 orth=0.1504 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 44 it 46 total=10.7728 mle=2.0977 pcon=8.5247 forget=0.0000 orth=0.1504 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=10.6823 mle=2.0080 pcon=8.5239 forget=0.0000 orth=0.1504 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=10.9080 mle=2.2343 pcon=8.5234 forget=0.0000 orth=0.1504 favg=0.0000 nr=107 nf=3 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=10.9958 mle=2.3236 pcon=8.5218 forget=0.0000 orth=0.1504 favg=0.0000 nr=91 nf=8 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=10.6567 mle=1.9841 pcon=8.5221 forget=0.0000 orth=0.1504 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=10.8001 mle=2.1282 pcon=8.5215 forget=0.0000 orth=0.1504 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=10.6421 mle=1.9701 pcon=8.5216 forget=0.0000 orth=0.1504 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:01<06:37,  1.02s/it]  3%|▎         | 11/391 [00:01<00:29, 13.00it/s]  5%|▌         | 20/391 [00:01<00:15, 24.36it/s]  8%|▊         | 30/391 [00:01<00:09, 37.14it/s] 10%|█         | 40/391 [00:01<00:07, 49.09it/s] 13%|█▎        | 49/391 [00:01<00:05, 57.70it/s] 15%|█▌        | 59/391 [00:01<00:05, 64.70it/s] 17%|█▋        | 68/391 [00:01<00:05, 58.26it/s] 19%|█▉        | 76/391 [00:02<00:05, 55.93it/s] 21%|██        | 83/391 [00:02<00:05, 58.13it/s] 24%|██▍       | 93/391 [00:02<00:04, 66.64it/s] 26%|██▌       | 102/391 [00:02<00:04, 70.74it/s] 29%|██▊       | 112/391 [00:02<00:03, 77.23it/s] 31%|███       | 122/391 [00:02<00:03, 81.69it/s] 34%|███▍      | 132/391 [00:02<00:03, 85.17it/s] 36%|███▋      | 142/391 [00:02<00:02, 87.77it/s] 39%|███▉      | 152/391 [00:02<00:02, 88.75it/s] 41%|████▏     | 162/391 [00:02<00:02, 90.58it/s] 44%|████▍     | 172/391 [00:03<00:02, 91.46it/s] 47%|████▋     | 182/391 [00:03<00:02, 89.21it/s] 49%|████▉     | 191/391 [00:03<00:02, 88.36it/s] 51%|█████▏    | 201/391 [00:03<00:02, 90.49it/s] 54%|█████▍    | 211/391 [00:03<00:01, 91.44it/s] 57%|█████▋    | 221/391 [00:03<00:01, 92.55it/s] 59%|█████▉    | 231/391 [00:03<00:01, 93.17it/s] 62%|██████▏   | 241/391 [00:03<00:01, 93.57it/s] 64%|██████▍   | 251/391 [00:03<00:01, 93.01it/s] 67%|██████▋   | 261/391 [00:04<00:01, 92.58it/s] 69%|██████▉   | 271/391 [00:04<00:01, 81.92it/s] 72%|███████▏  | 280/391 [00:04<00:01, 70.61it/s] 74%|███████▍  | 290/391 [00:04<00:01, 76.81it/s] 77%|███████▋  | 300/391 [00:04<00:01, 81.25it/s] 79%|███████▉  | 310/391 [00:04<00:00, 85.19it/s] 82%|████████▏ | 319/391 [00:04<00:00, 83.33it/s] 84%|████████▍ | 329/391 [00:04<00:00, 86.25it/s] 87%|████████▋ | 339/391 [00:05<00:00, 88.84it/s] 89%|████████▉ | 349/391 [00:05<00:00, 89.50it/s] 92%|█████████▏| 359/391 [00:05<00:00, 89.75it/s] 94%|█████████▍| 369/391 [00:05<00:00, 91.64it/s] 97%|█████████▋| 379/391 [00:05<00:00, 93.26it/s] 99%|█████████▉| 389/391 [00:05<00:00, 94.51it/s]100%|██████████| 391/391 [00:05<00:00, 70.03it/s]
50000 images processed, 5.649703502655029 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.58it/s] 13%|█▎        | 10/79 [00:00<00:03, 17.69it/s] 25%|██▌       | 20/79 [00:00<00:01, 33.97it/s] 38%|███▊      | 30/79 [00:00<00:01, 47.96it/s] 48%|████▊     | 38/79 [00:01<00:00, 55.57it/s] 58%|█████▊    | 46/79 [00:01<00:00, 52.02it/s] 71%|███████   | 56/79 [00:01<00:00, 62.69it/s] 84%|████████▎ | 66/79 [00:01<00:00, 71.38it/s] 96%|█████████▌| 76/79 [00:01<00:00, 78.21it/s]100%|██████████| 79/79 [00:02<00:00, 37.17it/s]
10000 images processed, 2.144969940185547 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:47,  1.21it/s]  4%|▍         | 9/204 [00:00<00:15, 12.65it/s]  9%|▉         | 18/204 [00:01<00:07, 25.52it/s] 14%|█▎        | 28/204 [00:01<00:04, 39.43it/s] 18%|█▊        | 37/204 [00:01<00:03, 50.16it/s] 23%|██▎       | 47/204 [00:01<00:02, 60.38it/s] 28%|██▊       | 57/204 [00:01<00:02, 69.02it/s] 33%|███▎      | 67/204 [00:01<00:01, 75.82it/s] 38%|███▊      | 77/204 [00:01<00:01, 80.52it/s] 43%|████▎     | 87/204 [00:01<00:01, 79.10it/s] 48%|████▊     | 97/204 [00:01<00:01, 82.51it/s] 52%|█████▏    | 107/204 [00:02<00:01, 85.80it/s] 57%|█████▋    | 116/204 [00:02<00:01, 76.69it/s] 61%|██████▏   | 125/204 [00:02<00:01, 75.38it/s] 66%|██████▌   | 134/204 [00:02<00:00, 77.68it/s] 71%|███████   | 144/204 [00:02<00:00, 81.80it/s] 75%|███████▌  | 154/204 [00:02<00:00, 84.11it/s] 80%|████████  | 164/204 [00:02<00:00, 86.14it/s] 85%|████████▌ | 174/204 [00:02<00:00, 88.32it/s] 90%|█████████ | 184/204 [00:02<00:00, 90.51it/s] 95%|█████████▌| 194/204 [00:03<00:00, 92.24it/s]100%|██████████| 204/204 [00:03<00:00, 91.76it/s]100%|██████████| 204/204 [00:03<00:00, 64.40it/s]
26032 images processed, 3.224479913711548 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:03,  1.23it/s]  8%|▊         | 6/79 [00:00<00:08,  8.48it/s] 19%|█▉        | 15/79 [00:01<00:02, 22.40it/s] 27%|██▋       | 21/79 [00:01<00:02, 28.81it/s] 39%|███▉      | 31/79 [00:01<00:01, 43.28it/s] 52%|█████▏    | 41/79 [00:01<00:00, 55.49it/s] 62%|██████▏   | 49/79 [00:01<00:00, 61.36it/s] 73%|███████▎  | 58/79 [00:01<00:00, 67.11it/s] 86%|████████▌ | 68/79 [00:01<00:00, 75.04it/s] 99%|█████████▊| 78/79 [00:01<00:00, 80.92it/s]100%|██████████| 79/79 [00:01<00:00, 44.32it/s]
10000 images processed, 1.805729866027832 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:56,  1.38it/s] 13%|█▎        | 10/79 [00:00<00:04, 15.81it/s] 25%|██▌       | 20/79 [00:00<00:01, 31.27it/s] 38%|███▊      | 30/79 [00:01<00:01, 45.16it/s] 48%|████▊     | 38/79 [00:01<00:00, 44.09it/s] 57%|█████▋    | 45/79 [00:01<00:00, 49.29it/s] 67%|██████▋   | 53/79 [00:01<00:00, 56.15it/s] 80%|███████▉  | 63/79 [00:01<00:00, 66.40it/s] 92%|█████████▏| 73/79 [00:01<00:00, 74.45it/s]100%|██████████| 79/79 [00:01<00:00, 46.42it/s]
10000 images processed, 1.72780442237854 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:48,  1.43it/s] 11%|█▏        | 8/70 [00:00<00:04, 12.84it/s] 20%|██        | 14/70 [00:00<00:02, 21.37it/s] 31%|███▏      | 22/70 [00:01<00:01, 33.55it/s] 46%|████▌     | 32/70 [00:01<00:00, 48.30it/s] 60%|██████    | 42/70 [00:01<00:00, 60.10it/s] 74%|███████▍  | 52/70 [00:01<00:00, 69.72it/s] 89%|████████▊ | 62/70 [00:01<00:00, 76.23it/s]100%|██████████| 70/70 [00:01<00:00, 43.59it/s]
8925 images processed, 1.6892492771148682 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<01:02,  1.42s/it]  4%|▍         | 2/45 [00:01<00:30,  1.42it/s] 22%|██▏       | 10/45 [00:01<00:03,  9.57it/s] 36%|███▌      | 16/45 [00:01<00:01, 16.02it/s] 47%|████▋     | 21/45 [00:02<00:01, 15.92it/s] 56%|█████▌    | 25/45 [00:02<00:01, 16.76it/s] 73%|███████▎  | 33/45 [00:02<00:00, 20.22it/s] 80%|████████  | 36/45 [00:02<00:00, 18.35it/s]100%|██████████| 45/45 [00:02<00:00, 15.00it/s]
5640 images processed, 3.025162935256958 seconds used

21.37926959991455
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           8.75  98.25  83.37
places365     61.28  82.97  47.18
LSUN          72.00  82.06  51.98
iSUN          58.21  86.95  62.15
dtd           24.95  94.46  84.28
AVG           45.04  88.94  65.80
[incremental] Overall: 0.7180 New: 0.7140 Old: 0.7200
[incremental] Final(Top-1): 0.7180  Average: 0.7767
3.7272162437438965
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=45, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/45 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/45 [00:19<14:24, 19.66s/it]  4%|▍         | 2/45 [00:29<10:06, 14.11s/it]  7%|▋         | 3/45 [00:41<09:00, 12.86s/it]  9%|▉         | 4/45 [00:51<08:05, 11.85s/it] 11%|█         | 5/45 [01:01<07:32, 11.31s/it] 13%|█▎        | 6/45 [01:12<07:14, 11.14s/it][loss] ep 0 it 0 total=14.3256 mle=2.6848 pcon=9.8394 forget=0.0000 orth=1.8014 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=14.1348 mle=2.4937 pcon=9.8400 forget=0.0000 orth=1.8011 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=14.2656 mle=2.6256 pcon=9.8396 forget=0.0000 orth=1.8004 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=14.0859 mle=2.4495 pcon=9.8370 forget=0.0000 orth=1.7994 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=13.8285 mle=2.1971 pcon=9.8336 forget=0.0000 orth=1.7978 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.9361 mle=2.3113 pcon=9.8290 forget=0.0000 orth=1.7958 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=14.1854 mle=2.5692 pcon=9.8228 forget=0.0000 orth=1.7934 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.8779 mle=2.2726 pcon=9.8149 forget=0.0000 orth=1.7905 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.7654 mle=2.1717 pcon=9.8067 forget=0.0000 orth=1.7871 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.8807 mle=2.2995 pcon=9.7980 forget=0.0000 orth=1.7832 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.8902 mle=2.3225 pcon=9.7889 forget=0.0000 orth=1.7788 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=14.0343 mle=2.4813 pcon=9.7791 forget=0.0000 orth=1.7739 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.8583 mle=2.3222 pcon=9.7675 forget=0.0000 orth=1.7686 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.5963 mle=2.0771 pcon=9.7565 forget=0.0000 orth=1.7626 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.7416 mle=2.2403 pcon=9.7451 forget=0.0000 orth=1.7562 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.7710 mle=2.2893 pcon=9.7325 forget=0.0000 orth=1.7492 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.5550 mle=2.0918 pcon=9.7215 forget=0.0000 orth=1.7417 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.6088 mle=2.1652 pcon=9.7100 forget=0.0000 orth=1.7336 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.4928 mle=2.0699 pcon=9.6979 forget=0.0000 orth=1.7250 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.5895 mle=2.1873 pcon=9.6864 forget=0.0000 orth=1.7157 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.2421 mle=1.8627 pcon=9.6735 forget=0.0000 orth=1.7059 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.5524 mle=2.1970 pcon=9.6599 forget=0.0000 orth=1.6955 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.5309 mle=2.1987 pcon=9.6478 forget=0.0000 orth=1.6844 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.0496 mle=1.7415 pcon=9.6354 forget=0.0000 orth=1.6727 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.3901 mle=2.1069 pcon=9.6229 forget=0.0000 orth=1.6604 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.4849 mle=2.2274 pcon=9.6101 forget=0.0000 orth=1.6474 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.3656 mle=2.1345 pcon=9.5974 forget=0.0000 orth=1.6338 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.2704 mle=2.0659 pcon=9.5849 forget=0.0000 orth=1.6195 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.1904 mle=2.0133 pcon=9.5726 forget=0.0000 orth=1.6046 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.1169 mle=1.9679 pcon=9.5600 forget=0.0000 orth=1.5889 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.2153 mle=2.0947 pcon=9.5479 forget=0.0000 orth=1.5727 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.0742 mle=1.9821 pcon=9.5363 forget=0.0000 orth=1.5558 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.0937 mle=2.0313 pcon=9.5241 forget=0.0000 orth=1.5383 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.0787 mle=2.0465 pcon=9.5121 forget=0.0000 orth=1.5201 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.0781 mle=2.0768 pcon=9.5001 forget=0.0000 orth=1.5013 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.8216 mle=1.8511 pcon=9.4887 forget=0.0000 orth=1.4818 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.9360 mle=1.9964 pcon=9.4776 forget=0.0000 orth=1.4619 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.8075 mle=1.8990 pcon=9.4670 forget=0.0000 orth=1.4415 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.1442 mle=2.2678 pcon=9.4560 forget=0.0000 orth=1.4204 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.7392 mle=1.8953 pcon=9.4450 forget=0.0000 orth=1.3990 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 5 it 45 total=12.8750 mle=2.0633 pcon=9.4344 forget=0.0000 orth=1.3772 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.7380 mle=1.9585 pcon=9.4242 forget=0.0000 orth=1.3552 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.7531 mle=2.0073 pcon=9.4129 forget=0.0000 orth=1.3329 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.7329 mle=2.0197 pcon=9.4028 forget=0.0000 orth=1.3105 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.7361 mle=2.0554 pcon=9.3928 forget=0.0000 orth=1.2879 favg=0.0000 nr=97 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.5549 mle=1.9065 pcon=9.3828 forget=0.0000 orth=1.2655 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.7200 mle=2.1033 pcon=9.3737 forget=0.0000 orth=1.2431 favg=0.0000 nr=95 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 6 it 4 total=12.6539 mle=2.0687 pcon=9.3643 forget=0.0000 orth=1.2208 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.6193 mle=2.0652 pcon=9.3554 forget=0.0000 orth=1.1987 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.4100 mle=1.8876 pcon=9.3456 forget=0.0000 orth=1.1769 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.3230 mle=1.8317 pcon=9.3360 forget=0.0000 orth=1.1553 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=12.4039 mle=1.9424 pcon=9.3274 forget=0.0000 orth=1.1341 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
 16%|█▌        | 7/45 [01:23<06:54, 10.92s/it] 18%|█▊        | 8/45 [01:35<06:57, 11.29s/it] 20%|██        | 9/45 [01:45<06:39, 11.09s/it] 22%|██▏       | 10/45 [01:56<06:24, 10.98s/it] 24%|██▍       | 11/45 [02:07<06:13, 10.98s/it] 27%|██▋       | 12/45 [02:18<05:58, 10.87s/it] 29%|██▉       | 13/45 [02:29<05:54, 11.07s/it][loss] ep 6 it 254 total=12.5226 mle=2.0914 pcon=9.3181 forget=0.0000 orth=1.1131 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.5961 mle=2.1946 pcon=9.3090 forget=0.0000 orth=1.0925 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.3503 mle=1.9775 pcon=9.3007 forget=0.0000 orth=1.0720 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 7 it 13 total=12.4732 mle=2.1283 pcon=9.2929 forget=0.0000 orth=1.0520 favg=0.0000 nr=98 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.5607 mle=2.2440 pcon=9.2845 forget=0.0000 orth=1.0322 favg=0.0000 nr=94 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.3870 mle=2.0975 pcon=9.2766 forget=0.0000 orth=1.0128 favg=0.0000 nr=93 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.4706 mle=2.2082 pcon=9.2687 forget=0.0000 orth=0.9936 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.2196 mle=1.9836 pcon=9.2612 forget=0.0000 orth=0.9747 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.3404 mle=2.1312 pcon=9.2529 forget=0.0000 orth=0.9562 favg=0.0000 nr=102 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.1508 mle=1.9663 pcon=9.2465 forget=0.0000 orth=0.9380 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.2286 mle=2.0691 pcon=9.2394 forget=0.0000 orth=0.9201 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 8 it 22 total=12.1472 mle=2.0132 pcon=9.2315 forget=0.0000 orth=0.9024 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=12.0090 mle=1.8988 pcon=9.2250 forget=0.0000 orth=0.8851 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.9715 mle=1.8856 pcon=9.2178 forget=0.0000 orth=0.8681 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.8454 mle=1.7830 pcon=9.2110 forget=0.0000 orth=0.8514 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.8063 mle=1.7660 pcon=9.2054 forget=0.0000 orth=0.8350 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.9589 mle=1.9413 pcon=9.1988 forget=0.0000 orth=0.8188 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.9884 mle=1.9928 pcon=9.1927 forget=0.0000 orth=0.8029 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0915 mle=2.1179 pcon=9.1863 forget=0.0000 orth=0.7873 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 9 it 31 total=12.1027 mle=2.1503 pcon=9.1802 forget=0.0000 orth=0.7721 favg=0.0000 nr=92 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.8858 mle=1.9544 pcon=9.1742 forget=0.0000 orth=0.7573 favg=0.0000 nr=97 nf=13 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7808 mle=1.8689 pcon=9.1691 forget=0.0000 orth=0.7427 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8694 mle=1.9786 pcon=9.1624 forget=0.0000 orth=0.7284 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.6902 mle=1.8176 pcon=9.1581 forget=0.0000 orth=0.7145 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8573 mle=2.0043 pcon=9.1522 forget=0.0000 orth=0.7008 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9730 mle=2.1386 pcon=9.1470 forget=0.0000 orth=0.6874 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7433 mle=1.9275 pcon=9.1414 forget=0.0000 orth=0.6744 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 10 it 40 total=11.7145 mle=1.9167 pcon=9.1362 forget=0.0000 orth=0.6616 favg=0.0000 nr=109 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=11.9754 mle=2.1955 pcon=9.1305 forget=0.0000 orth=0.6494 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.7050 mle=1.9412 pcon=9.1261 forget=0.0000 orth=0.6377 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.6920 mle=1.9442 pcon=9.1213 forget=0.0000 orth=0.6265 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6219 mle=1.8898 pcon=9.1163 forget=0.0000 orth=0.6158 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=11.8902 mle=2.1727 pcon=9.1122 forget=0.0000 orth=0.6053 favg=0.0000 nr=93 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.5862 mle=1.8827 pcon=9.1083 forget=0.0000 orth=0.5952 favg=0.0000 nr=100 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=11.9065 mle=2.2177 pcon=9.1033 forget=0.0000 orth=0.5855 favg=0.0000 nr=65 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 11 it 49 total=11.6701 mle=1.9948 pcon=9.0991 forget=0.0000 orth=0.5761 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.8310 mle=2.1700 pcon=9.0938 forget=0.0000 orth=0.5671 favg=0.0000 nr=93 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.7279 mle=2.0794 pcon=9.0899 forget=0.0000 orth=0.5586 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.6192 mle=1.9841 pcon=9.0847 forget=0.0000 orth=0.5503 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.4487 mle=1.8256 pcon=9.0808 forget=0.0000 orth=0.5423 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.6994 mle=2.0885 pcon=9.0763 forget=0.0000 orth=0.5346 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.4758 mle=1.8761 pcon=9.0725 forget=0.0000 orth=0.5273 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 12 it 8 total=11.6796 mle=2.0904 pcon=9.0690 forget=0.0000 orth=0.5203 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.5753 mle=1.9976 pcon=9.0644 forget=0.0000 orth=0.5134 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.6163 mle=2.0491 pcon=9.0606 forget=0.0000 orth=0.5066 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.6105 mle=2.0528 pcon=9.0573 forget=0.0000 orth=0.5004 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.5403 mle=1.9920 pcon=9.0539 forget=0.0000 orth=0.4943 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.7408 mle=2.2019 pcon=9.0505 forget=0.0000 orth=0.4883 favg=0.0000 nr=97 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.7435 mle=2.2137 pcon=9.0472 forget=0.0000 orth=0.4826 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.6230 mle=2.1024 pcon=9.0436 forget=0.0000 orth=0.4770 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
 31%|███       | 14/45 [02:41<05:46, 11.17s/it] 33%|███▎      | 15/45 [02:52<05:34, 11.14s/it] 36%|███▌      | 16/45 [03:03<05:20, 11.04s/it] 38%|███▊      | 17/45 [03:12<04:59, 10.70s/it] 40%|████      | 18/45 [03:24<04:52, 10.83s/it] 42%|████▏     | 19/45 [03:35<04:43, 10.91s/it][loss] ep 13 it 17 total=11.6162 mle=2.1038 pcon=9.0407 forget=0.0000 orth=0.4717 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.4413 mle=1.9378 pcon=9.0371 forget=0.0000 orth=0.4665 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.6565 mle=2.1613 pcon=9.0337 forget=0.0000 orth=0.4615 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.6493 mle=2.1622 pcon=9.0306 forget=0.0000 orth=0.4566 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.6521 mle=2.1724 pcon=9.0278 forget=0.0000 orth=0.4519 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.5981 mle=2.1257 pcon=9.0250 forget=0.0000 orth=0.4473 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.5159 mle=2.0513 pcon=9.0216 forget=0.0000 orth=0.4429 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.5816 mle=2.1247 pcon=9.0183 forget=0.0000 orth=0.4386 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 14 it 26 total=11.6347 mle=2.1848 pcon=9.0156 forget=0.0000 orth=0.4344 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.3756 mle=1.9330 pcon=9.0124 forget=0.0000 orth=0.4303 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.4424 mle=2.0064 pcon=9.0097 forget=0.0000 orth=0.4263 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.6377 mle=2.2098 pcon=9.0055 forget=0.0000 orth=0.4224 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.4080 mle=1.9869 pcon=9.0025 forget=0.0000 orth=0.4185 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.6016 mle=2.1878 pcon=8.9990 forget=0.0000 orth=0.4148 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.5027 mle=2.0950 pcon=8.9965 forget=0.0000 orth=0.4112 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.2400 mle=1.8386 pcon=8.9937 forget=0.0000 orth=0.4077 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 15 it 35 total=11.4297 mle=2.0350 pcon=8.9904 forget=0.0000 orth=0.4043 favg=0.0000 nr=99 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.4502 mle=2.0614 pcon=8.9878 forget=0.0000 orth=0.4010 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.3209 mle=1.9388 pcon=8.9844 forget=0.0000 orth=0.3977 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.3623 mle=1.9856 pcon=8.9822 forget=0.0000 orth=0.3945 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.4804 mle=2.1101 pcon=8.9790 forget=0.0000 orth=0.3914 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.3701 mle=2.0049 pcon=8.9769 forget=0.0000 orth=0.3883 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.5072 mle=2.1476 pcon=8.9743 forget=0.0000 orth=0.3853 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.3575 mle=2.0035 pcon=8.9717 forget=0.0000 orth=0.3824 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 16 it 44 total=11.5462 mle=2.1960 pcon=8.9707 forget=0.0000 orth=0.3795 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.5225 mle=2.1770 pcon=8.9687 forget=0.0000 orth=0.3767 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.3568 mle=2.0164 pcon=8.9666 forget=0.0000 orth=0.3738 favg=0.0000 nr=100 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.3888 mle=2.0543 pcon=8.9635 forget=0.0000 orth=0.3711 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.2964 mle=1.9665 pcon=8.9616 forget=0.0000 orth=0.3684 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.2509 mle=1.9256 pcon=8.9596 forget=0.0000 orth=0.3657 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.3823 mle=2.0623 pcon=8.9567 forget=0.0000 orth=0.3633 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 17 it 3 total=11.1762 mle=1.8612 pcon=8.9542 forget=0.0000 orth=0.3609 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.1715 mle=1.8618 pcon=8.9513 forget=0.0000 orth=0.3583 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.3939 mle=2.0892 pcon=8.9488 forget=0.0000 orth=0.3559 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.2614 mle=1.9612 pcon=8.9466 forget=0.0000 orth=0.3536 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.2564 mle=1.9606 pcon=8.9445 forget=0.0000 orth=0.3513 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.3605 mle=2.0687 pcon=8.9428 forget=0.0000 orth=0.3490 favg=0.0000 nr=101 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.2119 mle=1.9244 pcon=8.9408 forget=0.0000 orth=0.3467 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.2843 mle=2.0012 pcon=8.9385 forget=0.0000 orth=0.3445 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 18 it 12 total=11.3042 mle=2.0258 pcon=8.9360 forget=0.0000 orth=0.3424 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.4483 mle=2.1741 pcon=8.9338 forget=0.0000 orth=0.3404 favg=0.0000 nr=98 nf=12 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.2195 mle=1.9489 pcon=8.9323 forget=0.0000 orth=0.3383 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.3160 mle=2.0496 pcon=8.9302 forget=0.0000 orth=0.3362 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.2966 mle=2.0348 pcon=8.9276 forget=0.0000 orth=0.3341 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.2543 mle=1.9974 pcon=8.9248 forget=0.0000 orth=0.3321 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.2577 mle=2.0049 pcon=8.9226 forget=0.0000 orth=0.3302 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.1260 mle=1.8773 pcon=8.9205 forget=0.0000 orth=0.3282 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 19 it 21 total=11.1187 mle=1.8740 pcon=8.9185 forget=0.0000 orth=0.3263 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.3033 mle=2.0627 pcon=8.9161 forget=0.0000 orth=0.3244 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=11.1381 mle=1.9011 pcon=8.9143 forget=0.0000 orth=0.3226 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.2758 mle=2.0426 pcon=8.9123 forget=0.0000 orth=0.3208 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
 44%|████▍     | 20/45 [03:47<04:42, 11.31s/it] 47%|████▋     | 21/45 [03:57<04:22, 10.95s/it] 49%|████▉     | 22/45 [04:08<04:13, 11.00s/it] 51%|█████     | 23/45 [04:19<04:01, 10.99s/it] 53%|█████▎    | 24/45 [04:31<03:57, 11.29s/it] 56%|█████▌    | 25/45 [04:42<03:45, 11.30s/it][loss] ep 19 it 221 total=11.2476 mle=2.0174 pcon=8.9111 forget=0.0000 orth=0.3190 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.3622 mle=2.1353 pcon=8.9096 forget=0.0000 orth=0.3173 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.3522 mle=2.1285 pcon=8.9081 forget=0.0000 orth=0.3156 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.2683 mle=2.0479 pcon=8.9064 forget=0.0000 orth=0.3139 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 20 it 30 total=11.3580 mle=2.1399 pcon=8.9059 forget=0.0000 orth=0.3122 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.1073 mle=1.8928 pcon=8.9039 forget=0.0000 orth=0.3106 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.2625 mle=2.0515 pcon=8.9019 forget=0.0000 orth=0.3090 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.2576 mle=2.0497 pcon=8.9005 forget=0.0000 orth=0.3075 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.1421 mle=1.9368 pcon=8.8995 forget=0.0000 orth=0.3059 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.2114 mle=2.0095 pcon=8.8975 forget=0.0000 orth=0.3044 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.4042 mle=2.2053 pcon=8.8960 forget=0.0000 orth=0.3029 favg=0.0000 nr=92 nf=13 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.2839 mle=2.0874 pcon=8.8951 forget=0.0000 orth=0.3014 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 21 it 39 total=11.2032 mle=2.0103 pcon=8.8930 forget=0.0000 orth=0.2999 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.1057 mle=1.9164 pcon=8.8910 forget=0.0000 orth=0.2984 favg=0.0000 nr=106 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.2557 mle=2.0688 pcon=8.8899 forget=0.0000 orth=0.2970 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.1146 mle=1.9306 pcon=8.8883 forget=0.0000 orth=0.2957 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.3026 mle=2.1220 pcon=8.8863 forget=0.0000 orth=0.2943 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.0873 mle=1.9094 pcon=8.8851 forget=0.0000 orth=0.2928 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.1234 mle=1.9481 pcon=8.8838 forget=0.0000 orth=0.2915 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.2914 mle=2.1197 pcon=8.8816 forget=0.0000 orth=0.2902 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 22 it 48 total=11.2484 mle=2.0795 pcon=8.8800 forget=0.0000 orth=0.2889 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.0974 mle=1.9314 pcon=8.8784 forget=0.0000 orth=0.2875 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.2168 mle=2.0535 pcon=8.8771 forget=0.0000 orth=0.2863 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.1461 mle=1.9854 pcon=8.8756 forget=0.0000 orth=0.2850 favg=0.0000 nr=102 nf=2 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.1781 mle=2.0200 pcon=8.8743 forget=0.0000 orth=0.2838 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.1126 mle=1.9568 pcon=8.8731 forget=0.0000 orth=0.2826 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.3025 mle=2.1497 pcon=8.8713 forget=0.0000 orth=0.2814 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 23 it 7 total=11.0825 mle=1.9325 pcon=8.8697 forget=0.0000 orth=0.2803 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.2756 mle=2.1280 pcon=8.8684 forget=0.0000 orth=0.2792 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.9512 mle=1.8063 pcon=8.8668 forget=0.0000 orth=0.2781 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.4302 mle=2.2881 pcon=8.8652 forget=0.0000 orth=0.2769 favg=0.0000 nr=94 nf=13 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.2736 mle=2.1344 pcon=8.8635 forget=0.0000 orth=0.2758 favg=0.0000 nr=96 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.1717 mle=2.0348 pcon=8.8623 forget=0.0000 orth=0.2747 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.2042 mle=2.0706 pcon=8.8600 forget=0.0000 orth=0.2737 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.0351 mle=1.9040 pcon=8.8585 forget=0.0000 orth=0.2726 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 24 it 16 total=11.2340 mle=2.1050 pcon=8.8573 forget=0.0000 orth=0.2716 favg=0.0000 nr=100 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.0365 mle=1.9093 pcon=8.8567 forget=0.0000 orth=0.2706 favg=0.0000 nr=105 nf=2 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.3269 mle=2.2020 pcon=8.8554 forget=0.0000 orth=0.2696 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.2976 mle=2.1756 pcon=8.8534 forget=0.0000 orth=0.2686 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.0463 mle=1.9271 pcon=8.8516 forget=0.0000 orth=0.2676 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.1070 mle=1.9909 pcon=8.8495 forget=0.0000 orth=0.2666 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.0381 mle=1.9240 pcon=8.8484 forget=0.0000 orth=0.2657 favg=0.0000 nr=103 nf=12 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.3750 mle=2.2630 pcon=8.8472 forget=0.0000 orth=0.2648 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 25 it 25 total=11.0374 mle=1.9278 pcon=8.8457 forget=0.0000 orth=0.2639 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=11.1776 mle=2.0702 pcon=8.8445 forget=0.0000 orth=0.2629 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.4094 mle=2.3054 pcon=8.8420 forget=0.0000 orth=0.2620 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=11.0878 mle=1.9859 pcon=8.8408 forget=0.0000 orth=0.2612 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=11.0177 mle=1.9180 pcon=8.8393 forget=0.0000 orth=0.2603 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.2160 mle=2.1184 pcon=8.8382 forget=0.0000 orth=0.2595 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=11.0543 mle=1.9587 pcon=8.8369 forget=0.0000 orth=0.2587 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=11.1878 mle=2.0933 pcon=8.8366 forget=0.0000 orth=0.2579 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
 58%|█████▊    | 26/45 [04:54<03:35, 11.33s/it] 60%|██████    | 27/45 [05:05<03:21, 11.20s/it] 62%|██████▏   | 28/45 [05:16<03:09, 11.13s/it] 64%|██████▍   | 29/45 [05:27<02:56, 11.05s/it] 67%|██████▋   | 30/45 [05:37<02:45, 11.02s/it] 69%|██████▉   | 31/45 [05:48<02:33, 10.98s/it] 71%|███████   | 32/45 [05:59<02:23, 11.01s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 26 it 34 total=11.0047 mle=1.9131 pcon=8.8345 forget=0.0000 orth=0.2570 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.2454 mle=2.1566 pcon=8.8325 forget=0.0000 orth=0.2563 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=11.1496 mle=2.0620 pcon=8.8322 forget=0.0000 orth=0.2555 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=11.1934 mle=2.1079 pcon=8.8308 forget=0.0000 orth=0.2547 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=11.0316 mle=1.9484 pcon=8.8294 forget=0.0000 orth=0.2539 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=11.1620 mle=2.0810 pcon=8.8279 forget=0.0000 orth=0.2531 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=11.0919 mle=2.0130 pcon=8.8267 forget=0.0000 orth=0.2523 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=11.0547 mle=1.9775 pcon=8.8257 forget=0.0000 orth=0.2516 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 27 it 43 total=11.2525 mle=2.1769 pcon=8.8247 forget=0.0000 orth=0.2508 favg=0.0000 nr=97 nf=3 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=11.0711 mle=1.9967 pcon=8.8243 forget=0.0000 orth=0.2501 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=11.1966 mle=2.1242 pcon=8.8230 forget=0.0000 orth=0.2494 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=11.0893 mle=2.0194 pcon=8.8212 forget=0.0000 orth=0.2487 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=11.1024 mle=2.0339 pcon=8.8205 forget=0.0000 orth=0.2480 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=11.1461 mle=2.0794 pcon=8.8194 forget=0.0000 orth=0.2474 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.9411 mle=1.8765 pcon=8.8179 forget=0.0000 orth=0.2467 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 28 it 2 total=10.9232 mle=1.8603 pcon=8.8169 forget=0.0000 orth=0.2460 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=11.2220 mle=2.1609 pcon=8.8157 forget=0.0000 orth=0.2454 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=11.1136 mle=2.0539 pcon=8.8149 forget=0.0000 orth=0.2448 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.2891 mle=2.2305 pcon=8.8145 forget=0.0000 orth=0.2442 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=11.1837 mle=2.1267 pcon=8.8134 forget=0.0000 orth=0.2436 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=11.1462 mle=2.0911 pcon=8.8121 forget=0.0000 orth=0.2430 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.8618 mle=1.8076 pcon=8.8118 forget=0.0000 orth=0.2424 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=11.0585 mle=2.0063 pcon=8.8104 forget=0.0000 orth=0.2418 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 29 it 11 total=10.8885 mle=1.8381 pcon=8.8091 forget=0.0000 orth=0.2412 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=11.0964 mle=2.0469 pcon=8.8087 forget=0.0000 orth=0.2407 favg=0.0000 nr=99 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=11.1879 mle=2.1398 pcon=8.8079 forget=0.0000 orth=0.2402 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.9972 mle=1.9506 pcon=8.8069 forget=0.0000 orth=0.2396 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.2225 mle=2.1780 pcon=8.8054 forget=0.0000 orth=0.2391 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=11.0844 mle=2.0410 pcon=8.8047 forget=0.0000 orth=0.2386 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=11.0552 mle=2.0128 pcon=8.8043 forget=0.0000 orth=0.2381 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.3653 mle=2.3240 pcon=8.8037 forget=0.0000 orth=0.2376 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 30 it 20 total=10.8825 mle=1.8420 pcon=8.8034 forget=0.0000 orth=0.2371 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=11.1472 mle=2.1074 pcon=8.8031 forget=0.0000 orth=0.2366 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.9963 mle=1.9582 pcon=8.8020 forget=0.0000 orth=0.2361 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=11.3445 mle=2.3078 pcon=8.8011 forget=0.0000 orth=0.2356 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=11.0960 mle=2.0598 pcon=8.8011 forget=0.0000 orth=0.2352 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.8882 mle=1.8531 pcon=8.8004 forget=0.0000 orth=0.2347 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=11.1059 mle=2.0720 pcon=8.7996 forget=0.0000 orth=0.2343 favg=0.0000 nr=98 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=11.1630 mle=2.1305 pcon=8.7987 forget=0.0000 orth=0.2338 favg=0.0000 nr=96 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 31 it 29 total=10.9503 mle=1.9195 pcon=8.7974 forget=0.0000 orth=0.2334 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=11.2066 mle=2.1777 pcon=8.7959 forget=0.0000 orth=0.2330 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=11.0442 mle=2.0164 pcon=8.7952 forget=0.0000 orth=0.2326 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=11.2109 mle=2.1838 pcon=8.7950 forget=0.0000 orth=0.2322 favg=0.0000 nr=101 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=11.1811 mle=2.1558 pcon=8.7935 forget=0.0000 orth=0.2318 favg=0.0000 nr=101 nf=3 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.8697 mle=1.8453 pcon=8.7930 forget=0.0000 orth=0.2314 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=11.1763 mle=2.1529 pcon=8.7925 forget=0.0000 orth=0.2310 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=11.1701 mle=2.1485 pcon=8.7910 forget=0.0000 orth=0.2306 favg=0.0000 nr=92 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 32 it 38 total=11.0586 mle=2.0390 pcon=8.7893 forget=0.0000 orth=0.2302 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.9847 mle=1.9667 pcon=8.7881 forget=0.0000 orth=0.2299 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
 73%|███████▎  | 33/45 [06:10<02:10, 10.85s/it] 76%|███████▌  | 34/45 [06:21<02:00, 10.97s/it] 78%|███████▊  | 35/45 [06:32<01:49, 10.92s/it] 80%|████████  | 36/45 [06:43<01:39, 11.06s/it] 82%|████████▏ | 37/45 [06:55<01:29, 11.17s/it] 84%|████████▍ | 38/45 [07:06<01:18, 11.25s/it][loss] ep 32 it 138 total=11.0129 mle=1.9963 pcon=8.7871 forget=0.0000 orth=0.2295 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=11.1697 mle=2.1547 pcon=8.7859 forget=0.0000 orth=0.2292 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.8825 mle=1.8685 pcon=8.7851 forget=0.0000 orth=0.2288 favg=0.0000 nr=107 nf=1 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=11.0073 mle=1.9946 pcon=8.7842 forget=0.0000 orth=0.2285 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=11.2296 mle=2.2173 pcon=8.7841 forget=0.0000 orth=0.2282 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.8769 mle=1.8654 pcon=8.7836 forget=0.0000 orth=0.2279 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 33 it 47 total=11.1627 mle=2.1522 pcon=8.7830 forget=0.0000 orth=0.2276 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=11.1889 mle=2.1792 pcon=8.7824 forget=0.0000 orth=0.2273 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=11.0889 mle=2.0802 pcon=8.7818 forget=0.0000 orth=0.2269 favg=0.0000 nr=105 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.8588 mle=1.8516 pcon=8.7805 forget=0.0000 orth=0.2267 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.9526 mle=1.9468 pcon=8.7795 forget=0.0000 orth=0.2264 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=11.1059 mle=2.1018 pcon=8.7780 forget=0.0000 orth=0.2261 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=11.1720 mle=2.1683 pcon=8.7778 forget=0.0000 orth=0.2258 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 34 it 6 total=11.2377 mle=2.2350 pcon=8.7771 forget=0.0000 orth=0.2256 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.9363 mle=1.9346 pcon=8.7764 forget=0.0000 orth=0.2253 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.9483 mle=1.9478 pcon=8.7754 forget=0.0000 orth=0.2251 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=11.0169 mle=2.0181 pcon=8.7740 forget=0.0000 orth=0.2248 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.8930 mle=1.8948 pcon=8.7737 forget=0.0000 orth=0.2246 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=11.0432 mle=2.0462 pcon=8.7727 forget=0.0000 orth=0.2243 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.9977 mle=2.0014 pcon=8.7722 forget=0.0000 orth=0.2241 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=11.1725 mle=2.1771 pcon=8.7715 forget=0.0000 orth=0.2239 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 35 it 15 total=11.0326 mle=2.0383 pcon=8.7706 forget=0.0000 orth=0.2237 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=11.0465 mle=2.0536 pcon=8.7695 forget=0.0000 orth=0.2235 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=11.1498 mle=2.1580 pcon=8.7685 forget=0.0000 orth=0.2232 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=11.1656 mle=2.1745 pcon=8.7681 forget=0.0000 orth=0.2230 favg=0.0000 nr=94 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=11.1320 mle=2.1416 pcon=8.7675 forget=0.0000 orth=0.2228 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=11.0682 mle=2.0790 pcon=8.7666 forget=0.0000 orth=0.2227 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=11.0757 mle=2.0873 pcon=8.7659 forget=0.0000 orth=0.2225 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=11.0782 mle=2.0904 pcon=8.7655 forget=0.0000 orth=0.2223 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 36 it 24 total=11.0980 mle=2.1103 pcon=8.7656 forget=0.0000 orth=0.2221 favg=0.0000 nr=94 nf=9 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=11.0109 mle=2.0236 pcon=8.7654 forget=0.0000 orth=0.2219 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=10.8263 mle=1.8394 pcon=8.7652 forget=0.0000 orth=0.2217 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=11.0150 mle=2.0291 pcon=8.7644 forget=0.0000 orth=0.2216 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=10.9305 mle=1.9453 pcon=8.7638 forget=0.0000 orth=0.2214 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=11.1682 mle=2.1837 pcon=8.7633 forget=0.0000 orth=0.2213 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=11.0373 mle=2.0531 pcon=8.7631 forget=0.0000 orth=0.2211 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=10.9368 mle=1.9536 pcon=8.7622 forget=0.0000 orth=0.2209 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=10.9700 mle=1.9876 pcon=8.7616 forget=0.0000 orth=0.2208 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=11.1308 mle=2.1496 pcon=8.7605 forget=0.0000 orth=0.2207 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=10.9428 mle=1.9619 pcon=8.7604 forget=0.0000 orth=0.2205 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=11.0629 mle=2.0826 pcon=8.7599 forget=0.0000 orth=0.2204 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=10.7831 mle=1.8031 pcon=8.7597 forget=0.0000 orth=0.2203 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=11.1719 mle=2.1933 pcon=8.7585 forget=0.0000 orth=0.2201 favg=0.0000 nr=99 nf=11 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=11.2893 mle=2.3110 pcon=8.7582 forget=0.0000 orth=0.2200 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=10.9836 mle=2.0064 pcon=8.7574 forget=0.0000 orth=0.2199 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 38 it 42 total=11.0500 mle=2.0735 pcon=8.7567 forget=0.0000 orth=0.2198 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=11.2633 mle=2.2879 pcon=8.7557 forget=0.0000 orth=0.2197 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=10.9677 mle=1.9930 pcon=8.7551 forget=0.0000 orth=0.2196 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=10.8643 mle=1.8904 pcon=8.7544 forget=0.0000 orth=0.2195 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=11.0110 mle=2.0375 pcon=8.7541 forget=0.0000 orth=0.2194 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=11.0780 mle=2.1048 pcon=8.7539 forget=0.0000 orth=0.2193 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=10.8490 mle=1.8770 pcon=8.7528 forget=0.0000 orth=0.2192 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
 87%|████████▋ | 39/45 [07:17<01:07, 11.18s/it] 89%|████████▉ | 40/45 [07:29<00:56, 11.33s/it] 91%|█████████ | 41/45 [07:40<00:45, 11.26s/it] 93%|█████████▎| 42/45 [07:51<00:33, 11.23s/it] 96%|█████████▌| 43/45 [08:03<00:22, 11.30s/it] 98%|█████████▊| 44/45 [08:14<00:11, 11.29s/it]100%|██████████| 45/45 [08:26<00:00, 11.41s/it]100%|██████████| 45/45 [08:26<00:00, 11.25s/it]
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 39 it 1 total=11.2033 mle=2.2313 pcon=8.7528 forget=0.0000 orth=0.2192 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=10.9435 mle=1.9725 pcon=8.7519 forget=0.0000 orth=0.2191 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=11.0937 mle=2.1229 pcon=8.7518 forget=0.0000 orth=0.2190 favg=0.0000 nr=93 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=10.9446 mle=1.9747 pcon=8.7509 forget=0.0000 orth=0.2189 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=11.1307 mle=2.1617 pcon=8.7501 forget=0.0000 orth=0.2189 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=11.0498 mle=2.0806 pcon=8.7504 forget=0.0000 orth=0.2188 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=10.9827 mle=2.0140 pcon=8.7499 forget=0.0000 orth=0.2187 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=11.1960 mle=2.2276 pcon=8.7498 forget=0.0000 orth=0.2187 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 40 it 10 total=10.9224 mle=1.9550 pcon=8.7488 forget=0.0000 orth=0.2186 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=10.9443 mle=1.9778 pcon=8.7479 forget=0.0000 orth=0.2186 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=10.8896 mle=1.9237 pcon=8.7474 forget=0.0000 orth=0.2185 favg=0.0000 nr=100 nf=4 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=10.9523 mle=1.9870 pcon=8.7468 forget=0.0000 orth=0.2185 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=10.9688 mle=2.0041 pcon=8.7463 forget=0.0000 orth=0.2184 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=11.0214 mle=2.0570 pcon=8.7460 forget=0.0000 orth=0.2184 favg=0.0000 nr=96 nf=11 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=11.2792 mle=2.3148 pcon=8.7461 forget=0.0000 orth=0.2183 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=10.9707 mle=2.0072 pcon=8.7453 forget=0.0000 orth=0.2183 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 41 it 19 total=11.0927 mle=2.1297 pcon=8.7448 forget=0.0000 orth=0.2182 favg=0.0000 nr=99 nf=12 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=11.1024 mle=2.1387 pcon=8.7455 forget=0.0000 orth=0.2182 favg=0.0000 nr=96 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=11.2339 mle=2.2707 pcon=8.7450 forget=0.0000 orth=0.2182 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=11.0637 mle=2.1009 pcon=8.7447 forget=0.0000 orth=0.2181 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=10.9252 mle=1.9631 pcon=8.7440 forget=0.0000 orth=0.2181 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=10.8162 mle=1.8549 pcon=8.7432 forget=0.0000 orth=0.2181 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=11.1940 mle=2.2328 pcon=8.7432 forget=0.0000 orth=0.2181 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=11.0766 mle=2.1153 pcon=8.7433 forget=0.0000 orth=0.2180 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 42 it 28 total=10.9965 mle=2.0359 pcon=8.7426 forget=0.0000 orth=0.2180 favg=0.0000 nr=99 nf=11 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=11.0033 mle=2.0422 pcon=8.7431 forget=0.0000 orth=0.2180 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=11.0035 mle=2.0424 pcon=8.7432 forget=0.0000 orth=0.2180 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=10.9394 mle=1.9790 pcon=8.7425 forget=0.0000 orth=0.2180 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=10.8402 mle=1.8806 pcon=8.7416 forget=0.0000 orth=0.2179 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=11.0967 mle=2.1381 pcon=8.7406 forget=0.0000 orth=0.2179 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=10.9859 mle=2.0279 pcon=8.7401 forget=0.0000 orth=0.2179 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=11.0022 mle=2.0447 pcon=8.7396 forget=0.0000 orth=0.2179 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 43 it 37 total=11.0253 mle=2.0681 pcon=8.7393 forget=0.0000 orth=0.2179 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=10.8763 mle=1.9191 pcon=8.7393 forget=0.0000 orth=0.2179 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=11.2391 mle=2.2823 pcon=8.7389 forget=0.0000 orth=0.2179 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=11.0172 mle=2.0609 pcon=8.7384 forget=0.0000 orth=0.2179 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=11.0444 mle=2.0884 pcon=8.7381 forget=0.0000 orth=0.2179 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=11.0791 mle=2.1238 pcon=8.7375 forget=0.0000 orth=0.2179 favg=0.0000 nr=99 nf=11 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=11.0144 mle=2.0588 pcon=8.7378 forget=0.0000 orth=0.2179 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=10.8739 mle=1.9179 pcon=8.7381 forget=0.0000 orth=0.2179 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 44 it 46 total=11.0615 mle=2.1058 pcon=8.7379 forget=0.0000 orth=0.2179 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=10.9535 mle=1.9985 pcon=8.7372 forget=0.0000 orth=0.2179 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=11.2323 mle=2.2774 pcon=8.7371 forget=0.0000 orth=0.2178 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=11.2412 mle=2.2871 pcon=8.7363 forget=0.0000 orth=0.2178 favg=0.0000 nr=85 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=10.9536 mle=1.9992 pcon=8.7365 forget=0.0000 orth=0.2178 favg=0.0000 nr=101 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=11.0455 mle=2.0914 pcon=8.7363 forget=0.0000 orth=0.2178 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=10.9332 mle=1.9787 pcon=8.7367 forget=0.0000 orth=0.2178 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e45-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:10,  2.05it/s]  3%|▎         | 11/391 [00:00<00:15, 23.84it/s]  5%|▌         | 21/391 [00:00<00:08, 41.35it/s]  8%|▊         | 31/391 [00:00<00:06, 54.81it/s] 10%|█         | 41/391 [00:00<00:05, 65.68it/s] 13%|█▎        | 51/391 [00:01<00:04, 73.37it/s] 16%|█▌        | 61/391 [00:01<00:04, 78.61it/s] 18%|█▊        | 71/391 [00:01<00:03, 83.43it/s] 21%|██        | 81/391 [00:01<00:03, 86.73it/s] 23%|██▎       | 91/391 [00:01<00:03, 87.35it/s] 26%|██▌       | 101/391 [00:01<00:03, 88.73it/s] 28%|██▊       | 111/391 [00:01<00:03, 90.72it/s] 31%|███       | 121/391 [00:01<00:02, 91.48it/s] 34%|███▎      | 131/391 [00:01<00:02, 92.21it/s] 36%|███▌      | 141/391 [00:01<00:02, 92.26it/s] 39%|███▊      | 151/391 [00:02<00:02, 86.15it/s] 41%|████      | 160/391 [00:02<00:02, 78.97it/s] 43%|████▎     | 169/391 [00:02<00:02, 80.33it/s] 46%|████▌     | 179/391 [00:02<00:02, 84.57it/s] 48%|████▊     | 189/391 [00:02<00:02, 87.54it/s] 51%|█████     | 199/391 [00:02<00:02, 89.90it/s] 53%|█████▎    | 209/391 [00:02<00:02, 79.14it/s] 56%|█████▌    | 218/391 [00:02<00:02, 80.44it/s] 58%|█████▊    | 228/391 [00:03<00:01, 84.39it/s] 61%|██████    | 238/391 [00:03<00:01, 86.98it/s] 63%|██████▎   | 248/391 [00:03<00:01, 89.08it/s] 66%|██████▌   | 258/391 [00:03<00:01, 78.07it/s] 69%|██████▊   | 268/391 [00:03<00:01, 81.94it/s] 71%|███████   | 278/391 [00:03<00:01, 84.78it/s] 74%|███████▎  | 288/391 [00:03<00:01, 87.51it/s] 76%|███████▌  | 298/391 [00:03<00:01, 89.56it/s] 79%|███████▉  | 308/391 [00:03<00:00, 89.99it/s] 81%|████████▏ | 318/391 [00:04<00:00, 91.07it/s] 84%|████████▍ | 328/391 [00:04<00:00, 92.16it/s] 86%|████████▋ | 338/391 [00:04<00:00, 92.74it/s] 89%|████████▉ | 348/391 [00:04<00:00, 93.67it/s] 92%|█████████▏| 358/391 [00:04<00:00, 94.32it/s] 94%|█████████▍| 368/391 [00:04<00:00, 94.91it/s] 97%|█████████▋| 378/391 [00:04<00:00, 95.80it/s] 99%|█████████▉| 388/391 [00:04<00:00, 96.43it/s]100%|██████████| 391/391 [00:04<00:00, 79.94it/s]
50000 images processed, 4.977192401885986 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.94it/s] 14%|█▍        | 11/79 [00:00<00:02, 22.92it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.41it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.36it/s] 52%|█████▏    | 41/79 [00:00<00:00, 65.07it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.40it/s] 77%|███████▋  | 61/79 [00:01<00:00, 79.94it/s] 90%|████████▉ | 71/79 [00:01<00:00, 84.81it/s]100%|██████████| 79/79 [00:01<00:00, 54.31it/s]
10000 images processed, 1.4726223945617676 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:58,  1.72it/s]  5%|▍         | 10/204 [00:00<00:10, 18.82it/s] 10%|▉         | 20/204 [00:00<00:05, 35.91it/s] 14%|█▍        | 29/204 [00:00<00:03, 48.17it/s] 19%|█▉        | 39/204 [00:01<00:02, 59.91it/s] 24%|██▍       | 49/204 [00:01<00:02, 69.29it/s] 29%|██▉       | 59/204 [00:01<00:01, 76.45it/s] 34%|███▍      | 69/204 [00:01<00:01, 81.03it/s] 39%|███▊      | 79/204 [00:01<00:01, 84.27it/s] 44%|████▎     | 89/204 [00:01<00:01, 86.76it/s] 49%|████▊     | 99/204 [00:01<00:01, 88.88it/s] 53%|█████▎    | 109/204 [00:01<00:01, 90.52it/s] 58%|█████▊    | 119/204 [00:01<00:00, 89.81it/s] 63%|██████▎   | 129/204 [00:01<00:00, 91.06it/s] 68%|██████▊   | 139/204 [00:02<00:00, 91.29it/s] 73%|███████▎  | 149/204 [00:02<00:00, 92.18it/s] 78%|███████▊  | 159/204 [00:02<00:00, 92.81it/s] 83%|████████▎ | 169/204 [00:02<00:00, 93.21it/s] 88%|████████▊ | 179/204 [00:02<00:00, 93.93it/s] 93%|█████████▎| 189/204 [00:02<00:00, 94.71it/s] 98%|█████████▊| 199/204 [00:02<00:00, 95.15it/s]100%|██████████| 204/204 [00:02<00:00, 73.62it/s]
26032 images processed, 2.8134500980377197 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:11,  1.09it/s] 11%|█▏        | 9/79 [00:01<00:06, 11.66it/s] 19%|█▉        | 15/79 [00:01<00:03, 19.31it/s] 30%|███       | 24/79 [00:01<00:01, 31.95it/s] 43%|████▎     | 34/79 [00:01<00:00, 45.39it/s] 56%|█████▌    | 44/79 [00:01<00:00, 56.48it/s] 67%|██████▋   | 53/79 [00:01<00:00, 59.13it/s] 80%|███████▉  | 63/79 [00:01<00:00, 68.35it/s] 92%|█████████▏| 73/79 [00:01<00:00, 75.39it/s]100%|██████████| 79/79 [00:01<00:00, 42.67it/s]
10000 images processed, 1.9053735733032227 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:57,  1.35it/s] 11%|█▏        | 9/79 [00:00<00:05, 13.88it/s] 24%|██▍       | 19/79 [00:00<00:02, 29.53it/s] 37%|███▋      | 29/79 [00:01<00:01, 43.66it/s] 49%|████▉     | 39/79 [00:01<00:00, 55.41it/s] 62%|██████▏   | 49/79 [00:01<00:00, 65.30it/s] 75%|███████▍  | 59/79 [00:01<00:00, 71.63it/s] 86%|████████▌ | 68/79 [00:01<00:00, 64.27it/s] 96%|█████████▌| 76/79 [00:01<00:00, 60.70it/s]100%|██████████| 79/79 [00:01<00:00, 45.18it/s]
10000 images processed, 1.770381212234497 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:59,  1.16it/s] 16%|█▌        | 11/70 [00:00<00:03, 15.09it/s] 30%|███       | 21/70 [00:01<00:01, 29.01it/s] 44%|████▍     | 31/70 [00:01<00:00, 42.02it/s] 59%|█████▊    | 41/70 [00:01<00:00, 53.59it/s] 73%|███████▎  | 51/70 [00:01<00:00, 63.67it/s] 87%|████████▋ | 61/70 [00:01<00:00, 71.91it/s]100%|██████████| 70/70 [00:01<00:00, 43.85it/s]
8925 images processed, 1.6290867328643799 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:47,  1.09s/it]  4%|▍         | 2/45 [00:01<00:22,  1.94it/s] 27%|██▋       | 12/45 [00:01<00:02, 15.60it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.02it/s] 47%|████▋     | 21/45 [00:01<00:01, 16.08it/s] 56%|█████▌    | 25/45 [00:01<00:01, 19.58it/s] 67%|██████▋   | 30/45 [00:02<00:00, 17.01it/s] 73%|███████▎  | 33/45 [00:02<00:00, 18.19it/s] 80%|████████  | 36/45 [00:02<00:00, 17.99it/s]100%|██████████| 45/45 [00:02<00:00, 16.46it/s]
5640 images processed, 2.7531559467315674 seconds used

19.138678073883057
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           9.02  98.10  83.31
places365     66.22  83.15  56.31
LSUN          43.48  89.11  66.25
iSUN          54.22  88.48  71.57
dtd           21.84  95.27  88.72
AVG           38.96  90.82  73.23
[incremental] Overall: 0.6710 New: 0.6880 Old: 0.6653
[incremental] Final(Top-1): 0.6710  Average: 0.7503
5.222142457962036
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:41,  1.87it/s] 13%|█▎        | 10/79 [00:00<00:03, 20.05it/s] 23%|██▎       | 18/79 [00:00<00:01, 33.54it/s] 35%|███▌      | 28/79 [00:00<00:01, 49.15it/s] 48%|████▊     | 38/79 [00:00<00:00, 61.35it/s] 59%|█████▉    | 47/79 [00:01<00:00, 60.32it/s] 70%|██████▉   | 55/79 [00:01<00:00, 58.93it/s] 78%|███████▊  | 62/79 [00:01<00:00, 56.49it/s] 89%|████████▊ | 70/79 [00:01<00:00, 61.99it/s]100%|██████████| 79/79 [00:01<00:00, 67.78it/s]100%|██████████| 79/79 [00:01<00:00, 49.34it/s]
10000 images processed, 1.6212990283966064 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:51,  1.34it/s] 13%|█▎        | 9/70 [00:00<00:04, 14.00it/s] 27%|██▋       | 19/70 [00:00<00:01, 29.77it/s] 41%|████▏     | 29/70 [00:01<00:00, 43.99it/s] 56%|█████▌    | 39/70 [00:01<00:00, 55.96it/s] 70%|███████   | 49/70 [00:01<00:00, 66.19it/s] 84%|████████▍ | 59/70 [00:01<00:00, 74.18it/s] 99%|█████████▊| 69/70 [00:01<00:00, 80.25it/s]100%|██████████| 70/70 [00:01<00:00, 47.10it/s]
8925 images processed, 1.5132098197937012 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<01:02,  1.42s/it] 18%|█▊        | 8/45 [00:01<00:05,  7.02it/s] 38%|███▊      | 17/45 [00:01<00:02, 11.60it/s] 51%|█████     | 23/45 [00:02<00:01, 12.83it/s] 73%|███████▎  | 33/45 [00:02<00:00, 17.37it/s] 89%|████████▉ | 40/45 [00:02<00:00, 22.71it/s]100%|██████████| 45/45 [00:02<00:00, 15.57it/s]
5640 images processed, 2.909572124481201 seconds used

19.653904914855957
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           9.02  98.10  83.31
places365     66.22  83.15  56.31
LSUN          43.48  89.11  66.25
iSUN          54.22  88.48  71.57
dtd           21.84  95.27  88.72
AVG           38.96  90.82  73.23
[incremental] Overall: 0.6710 New: 0.6880 Old: 0.6653
[incremental] Final(Top-1): 0.6710  Average: 0.7503
4.744370937347412
[DEBUG] Parsed: avg_fpr=38.96 avg_auroc=90.82 final_top1=0.6710 average=0.7503
[Result] AVG-AUROC=90.82 AVG-FPR=38.96 Final-Top1=0.6710 Average=0.7503 Score=73.50

==========================================
[Run] lambda_pcon=1 lr=0.001 epochs=50 lora_r=8
==========================================
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [00:14<12:10, 14.90s/it]  4%|▍         | 2/50 [00:23<08:57, 11.20s/it]  6%|▌         | 3/50 [00:31<07:28,  9.54s/it]  8%|▊         | 4/50 [00:38<06:49,  8.89s/it] 10%|█         | 5/50 [00:46<06:15,  8.35s/it] 12%|█▏        | 6/50 [00:53<05:54,  8.06s/it][loss] ep 0 it 0 total=8.5895 mle=3.2130 pcon=5.3765 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=8.6441 mle=3.2647 pcon=5.3793 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.0878 mle=3.7057 pcon=5.3821 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=8.6783 mle=3.2935 pcon=5.3848 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=7.9792 mle=2.5920 pcon=5.3872 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=8.3816 mle=2.9918 pcon=5.3897 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4733 mle=4.0810 pcon=5.3923 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.4955 mle=3.1007 pcon=5.3948 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 1 it 9 total=8.5368 mle=3.1398 pcon=5.3970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.2413 mle=2.8417 pcon=5.3996 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.7243 mle=3.3224 pcon=5.4019 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.0961 mle=3.6916 pcon=5.4045 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.4458 mle=4.0386 pcon=5.4072 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.3582 mle=2.9487 pcon=5.4095 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0699 mle=3.6581 pcon=5.4118 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.5544 mle=3.1402 pcon=5.4141 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 2 it 18 total=8.5076 mle=3.0907 pcon=5.4169 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6320 mle=3.2130 pcon=5.4189 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.2433 mle=2.8213 pcon=5.4220 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.4330 mle=3.0086 pcon=5.4244 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=7.7380 mle=2.3110 pcon=5.4269 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6782 mle=3.2489 pcon=5.4293 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.8372 mle=3.4054 pcon=5.4318 forget=0.0000 orth=0.0000 favg=0.0000 nr=112 nf=16 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=7.7149 mle=2.2804 pcon=5.4344 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 3 it 27 total=8.2998 mle=2.8636 pcon=5.4361 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4255 mle=2.9875 pcon=5.4380 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.1013 mle=2.6614 pcon=5.4399 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=7.9322 mle=2.4906 pcon=5.4416 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=7.6430 mle=2.2004 pcon=5.4426 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=7.6506 mle=2.2064 pcon=5.4442 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=7.6232 mle=2.1786 pcon=5.4447 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=7.6687 mle=2.2232 pcon=5.4456 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 4 it 36 total=7.6921 mle=2.2453 pcon=5.4468 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.6983 mle=2.2505 pcon=5.4478 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.7880 mle=2.3395 pcon=5.4484 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.4444 mle=1.9940 pcon=5.4503 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.4891 mle=2.0370 pcon=5.4521 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.4849 mle=2.0301 pcon=5.4548 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.9108 mle=2.4539 pcon=5.4568 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.4957 mle=2.0364 pcon=5.4593 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 5 it 45 total=7.5990 mle=2.1381 pcon=5.4609 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.5302 mle=2.0670 pcon=5.4632 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.5470 mle=2.0818 pcon=5.4652 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.6399 mle=2.1723 pcon=5.4676 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.6793 mle=2.2097 pcon=5.4696 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.3914 mle=1.9190 pcon=5.4724 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7724 mle=2.2972 pcon=5.4752 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[loss] ep 6 it 4 total=7.6269 mle=2.1494 pcon=5.4775 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.7452 mle=2.2649 pcon=5.4803 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.5335 mle=2.0506 pcon=5.4829 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.3494 mle=1.8648 pcon=5.4846 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.5081 mle=2.0203 pcon=5.4878 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
 14%|█▍        | 7/50 [01:01<05:39,  7.91s/it] 16%|█▌        | 8/50 [01:08<05:27,  7.79s/it] 18%|█▊        | 9/50 [01:16<05:18,  7.77s/it] 20%|██        | 10/50 [01:24<05:12,  7.81s/it] 22%|██▏       | 11/50 [01:32<05:01,  7.73s/it] 24%|██▍       | 12/50 [01:39<04:51,  7.66s/it] 26%|██▌       | 13/50 [01:47<04:42,  7.64s/it] 28%|██▊       | 14/50 [01:54<04:34,  7.63s/it][loss] ep 6 it 254 total=7.5031 mle=2.0123 pcon=5.4908 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.9124 mle=2.4186 pcon=5.4938 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.4511 mle=1.9540 pcon=5.4972 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 7 it 13 total=7.7899 mle=2.2892 pcon=5.5007 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.9123 mle=2.4082 pcon=5.5041 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.7383 mle=2.2306 pcon=5.5077 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.8008 mle=2.2896 pcon=5.5112 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.5631 mle=2.0490 pcon=5.5142 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.6841 mle=2.1656 pcon=5.5185 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.5469 mle=2.0251 pcon=5.5218 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.6894 mle=2.1636 pcon=5.5257 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 22 total=7.6969 mle=2.1677 pcon=5.5293 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.5196 mle=1.9873 pcon=5.5323 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.3987 mle=1.8633 pcon=5.5354 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=7.3098 mle=1.7707 pcon=5.5392 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=7.3353 mle=1.7922 pcon=5.5432 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.5152 mle=1.9686 pcon=5.5466 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=7.5382 mle=1.9884 pcon=5.5498 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=7.7813 mle=2.2276 pcon=5.5537 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 31 total=7.9268 mle=2.3704 pcon=5.5564 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=7.6420 mle=2.0820 pcon=5.5600 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=7.4836 mle=1.9208 pcon=5.5628 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=7.6007 mle=2.0348 pcon=5.5659 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=7.5366 mle=1.9671 pcon=5.5695 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=7.5923 mle=2.0192 pcon=5.5731 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=7.6972 mle=2.1211 pcon=5.5761 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=7.5191 mle=1.9398 pcon=5.5793 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 40 total=7.4384 mle=1.8566 pcon=5.5818 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=7.9047 mle=2.3205 pcon=5.5842 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=7.5868 mle=1.9998 pcon=5.5870 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=7.5869 mle=1.9970 pcon=5.5899 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=7.4326 mle=1.8404 pcon=5.5922 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=7.8545 mle=2.2592 pcon=5.5953 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=7.5762 mle=1.9787 pcon=5.5974 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=7.8367 mle=2.2362 pcon=5.6005 forget=0.0000 orth=0.0000 favg=0.0000 nr=77 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 49 total=7.5662 mle=1.9625 pcon=5.6037 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=7.9002 mle=2.2935 pcon=5.6066 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=7.7698 mle=2.1603 pcon=5.6094 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=7.6113 mle=1.9988 pcon=5.6125 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=7.4136 mle=1.7979 pcon=5.6157 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=7.7316 mle=2.1134 pcon=5.6182 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=7.4545 mle=1.8339 pcon=5.6205 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 8 total=7.8478 mle=2.2247 pcon=5.6230 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=7.6098 mle=1.9845 pcon=5.6254 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=7.8279 mle=2.1997 pcon=5.6281 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=7.5988 mle=1.9679 pcon=5.6309 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=7.6265 mle=1.9931 pcon=5.6334 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=7.9018 mle=2.2658 pcon=5.6361 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=7.7429 mle=2.1047 pcon=5.6382 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=7.7904 mle=2.1497 pcon=5.6407 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 13 it 17 total=7.8736 mle=2.2304 pcon=5.6432 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=7.6738 mle=2.0281 pcon=5.6457 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=7.9256 mle=2.2782 pcon=5.6474 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=7.7543 mle=2.1050 pcon=5.6493 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=7.9474 mle=2.2967 pcon=5.6507 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=7.8502 mle=2.1973 pcon=5.6529 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=7.7400 mle=2.0851 pcon=5.6549 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=7.7592 mle=2.1018 pcon=5.6574 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 26 total=7.9672 mle=2.3080 pcon=5.6592 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=7.7009 mle=2.0401 pcon=5.6609 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=7.7289 mle=2.0667 pcon=5.6622 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=7.8706 mle=2.2070 pcon=5.6636 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
 30%|███       | 15/50 [02:02<04:26,  7.61s/it] 32%|███▏      | 16/50 [02:10<04:21,  7.69s/it] 34%|███▍      | 17/50 [02:17<04:12,  7.64s/it] 36%|███▌      | 18/50 [02:25<04:05,  7.68s/it] 38%|███▊      | 19/50 [02:33<03:58,  7.70s/it] 40%|████      | 20/50 [02:41<03:50,  7.69s/it] 42%|████▏     | 21/50 [02:48<03:42,  7.67s/it] 44%|████▍     | 22/50 [02:56<03:35,  7.69s/it][loss] ep 14 it 226 total=7.6114 mle=1.9460 pcon=5.6655 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=7.8307 mle=2.1631 pcon=5.6676 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=7.7753 mle=2.1061 pcon=5.6693 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=7.5908 mle=1.9199 pcon=5.6709 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 15 it 35 total=7.8053 mle=2.1326 pcon=5.6727 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=7.7867 mle=2.1120 pcon=5.6747 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=7.6453 mle=1.9691 pcon=5.6762 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=7.6450 mle=1.9678 pcon=5.6772 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=7.8558 mle=2.1777 pcon=5.6781 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=7.7253 mle=2.0457 pcon=5.6796 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=7.9075 mle=2.2268 pcon=5.6807 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=7.6825 mle=2.0003 pcon=5.6822 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 44 total=7.8737 mle=2.1905 pcon=5.6832 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=7.8322 mle=2.1476 pcon=5.6846 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=7.7347 mle=2.0490 pcon=5.6857 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=7.7343 mle=2.0476 pcon=5.6867 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=7.6658 mle=1.9778 pcon=5.6879 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=7.5869 mle=1.8981 pcon=5.6888 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=7.7514 mle=2.0621 pcon=5.6892 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 3 total=7.4738 mle=1.7835 pcon=5.6904 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=7.5345 mle=1.8432 pcon=5.6913 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=7.7215 mle=2.0292 pcon=5.6923 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=7.5306 mle=1.8371 pcon=5.6935 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=7.6353 mle=1.9412 pcon=5.6941 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=7.7509 mle=2.0564 pcon=5.6944 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=7.6379 mle=1.9431 pcon=5.6948 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=7.6481 mle=1.9527 pcon=5.6954 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 12 total=7.6768 mle=1.9811 pcon=5.6957 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=7.9777 mle=2.2819 pcon=5.6957 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=7.6329 mle=1.9370 pcon=5.6959 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=7.7741 mle=2.0779 pcon=5.6961 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=7.8393 mle=2.1429 pcon=5.6964 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=7.6885 mle=1.9921 pcon=5.6963 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=7.6187 mle=1.9221 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=7.5017 mle=1.8049 pcon=5.6968 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 21 total=7.6671 mle=1.9700 pcon=5.6971 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=7.7305 mle=2.0332 pcon=5.6973 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=7.6601 mle=1.9631 pcon=5.6970 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=7.7231 mle=2.0259 pcon=5.6973 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=7.7376 mle=2.0401 pcon=5.6975 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=7.9021 mle=2.2046 pcon=5.6975 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=7.8214 mle=2.1238 pcon=5.6976 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=7.7566 mle=2.0592 pcon=5.6974 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 30 total=7.8437 mle=2.1462 pcon=5.6975 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=7.6108 mle=1.9130 pcon=5.6978 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=7.7676 mle=2.0700 pcon=5.6975 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=7.8262 mle=2.1280 pcon=5.6983 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=7.5255 mle=1.8275 pcon=5.6980 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=7.7739 mle=2.0772 pcon=5.6967 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=8.0081 mle=2.3113 pcon=5.6968 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=7.9398 mle=2.2427 pcon=5.6971 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 39 total=7.7714 mle=2.0755 pcon=5.6959 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=7.5668 mle=1.8708 pcon=5.6960 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=7.7133 mle=2.0178 pcon=5.6955 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=7.5468 mle=1.8513 pcon=5.6955 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=7.8758 mle=2.1812 pcon=5.6945 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=7.6271 mle=1.9329 pcon=5.6942 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=7.6465 mle=1.9524 pcon=5.6941 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=7.8836 mle=2.1899 pcon=5.6937 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 48 total=7.8443 mle=2.1507 pcon=5.6935 forget=0.0000 orth=0.0000 favg=0.0000 nr=115 nf=13 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=7.7223 mle=2.0293 pcon=5.6930 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=7.7153 mle=2.0225 pcon=5.6928 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
 46%|████▌     | 23/50 [03:04<03:29,  7.76s/it] 48%|████▊     | 24/50 [03:11<03:20,  7.70s/it] 50%|█████     | 25/50 [03:19<03:11,  7.68s/it] 52%|█████▏    | 26/50 [03:27<03:03,  7.67s/it] 54%|█████▍    | 27/50 [03:34<02:56,  7.69s/it] 56%|█████▌    | 28/50 [03:42<02:50,  7.73s/it] 58%|█████▊    | 29/50 [03:51<02:46,  7.93s/it] 60%|██████    | 30/50 [03:58<02:37,  7.88s/it][loss] ep 22 it 198 total=7.6303 mle=1.9371 pcon=5.6931 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=7.7877 mle=2.0947 pcon=5.6929 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=7.7738 mle=2.0820 pcon=5.6918 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=7.8695 mle=2.1783 pcon=5.6912 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 7 total=7.7555 mle=2.0652 pcon=5.6904 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=7.7748 mle=2.0847 pcon=5.6901 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=7.4694 mle=1.7796 pcon=5.6898 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=8.0327 mle=2.3441 pcon=5.6886 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=7.8095 mle=2.1212 pcon=5.6883 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=7.7802 mle=2.0923 pcon=5.6880 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=7.7664 mle=2.0790 pcon=5.6875 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=7.6288 mle=1.9425 pcon=5.6863 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 16 total=7.8499 mle=2.1650 pcon=5.6850 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=7.6431 mle=1.9585 pcon=5.6846 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=7.8692 mle=2.1849 pcon=5.6843 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=7.7973 mle=2.1143 pcon=5.6830 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=7.5634 mle=1.8816 pcon=5.6818 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=7.6876 mle=2.0070 pcon=5.6806 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=7.6991 mle=2.0187 pcon=5.6804 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=8.0058 mle=2.3258 pcon=5.6800 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 25 it 25 total=7.5324 mle=1.8534 pcon=5.6790 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=7.6745 mle=1.9956 pcon=5.6789 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=7.9581 mle=2.2804 pcon=5.6777 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=7.7147 mle=2.0380 pcon=5.6768 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=7.5083 mle=1.8324 pcon=5.6759 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=7.8758 mle=2.2009 pcon=5.6749 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=7.6319 mle=1.9576 pcon=5.6743 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=7.7757 mle=2.1031 pcon=5.6727 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 34 total=7.5541 mle=1.8818 pcon=5.6723 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=7.7888 mle=2.1178 pcon=5.6710 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=7.7167 mle=2.0461 pcon=5.6707 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=7.7529 mle=2.0834 pcon=5.6695 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=7.5888 mle=1.9196 pcon=5.6692 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=7.7901 mle=2.1216 pcon=5.6685 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=7.7183 mle=2.0511 pcon=5.6672 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=7.5961 mle=1.9292 pcon=5.6669 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 43 total=7.8678 mle=2.2016 pcon=5.6662 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=7.7418 mle=2.0763 pcon=5.6655 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=7.7925 mle=2.1276 pcon=5.6649 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=7.6875 mle=2.0234 pcon=5.6640 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=7.7409 mle=2.0776 pcon=5.6632 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=7.6220 mle=1.9593 pcon=5.6627 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=7.4358 mle=1.7744 pcon=5.6614 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 2 total=7.5428 mle=1.8830 pcon=5.6598 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=7.8518 mle=2.1927 pcon=5.6591 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=7.6489 mle=1.9912 pcon=5.6577 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=7.8765 mle=2.2195 pcon=5.6570 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=7.7541 mle=2.0984 pcon=5.6557 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=7.7273 mle=2.0725 pcon=5.6548 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=7.4064 mle=1.7521 pcon=5.6542 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=7.5456 mle=1.8927 pcon=5.6529 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 11 total=7.5394 mle=1.8873 pcon=5.6521 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=7.7655 mle=2.1140 pcon=5.6515 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=7.9285 mle=2.2781 pcon=5.6504 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=7.5398 mle=1.8903 pcon=5.6495 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=7.7819 mle=2.1335 pcon=5.6484 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=7.6970 mle=2.0487 pcon=5.6483 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=7.6350 mle=1.9875 pcon=5.6475 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=7.9580 mle=2.3111 pcon=5.6469 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 20 total=7.6154 mle=1.9695 pcon=5.6460 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=7.7901 mle=2.1454 pcon=5.6447 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=7.5321 mle=1.8887 pcon=5.6434 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
 62%|██████▏   | 31/50 [04:06<02:26,  7.72s/it] 64%|██████▍   | 32/50 [04:13<02:18,  7.69s/it] 66%|██████▌   | 33/50 [04:21<02:09,  7.62s/it] 68%|██████▊   | 34/50 [04:28<02:02,  7.63s/it] 70%|███████   | 35/50 [04:36<01:55,  7.68s/it] 72%|███████▏  | 36/50 [04:44<01:47,  7.69s/it] 74%|███████▍  | 37/50 [04:52<01:40,  7.69s/it] 76%|███████▌  | 38/50 [04:59<01:32,  7.68s/it][loss] ep 30 it 170 total=7.9334 mle=2.2911 pcon=5.6424 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=7.7692 mle=2.1273 pcon=5.6419 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=7.4916 mle=1.8506 pcon=5.6410 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=7.7010 mle=2.0606 pcon=5.6403 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=7.7616 mle=2.1225 pcon=5.6391 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 29 total=7.5131 mle=1.8741 pcon=5.6390 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=7.7907 mle=2.1528 pcon=5.6379 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=7.6257 mle=1.9890 pcon=5.6367 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=7.7986 mle=2.1620 pcon=5.6366 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=7.7065 mle=2.0711 pcon=5.6354 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=7.5013 mle=1.8676 pcon=5.6336 forget=0.0000 orth=0.0000 favg=0.0000 nr=127 nf=1 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=7.7472 mle=2.1148 pcon=5.6324 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=7.8560 mle=2.2254 pcon=5.6307 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 32 it 38 total=7.6678 mle=2.0381 pcon=5.6297 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=7.5994 mle=1.9707 pcon=5.6287 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=7.6138 mle=1.9859 pcon=5.6278 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=7.7441 mle=2.1171 pcon=5.6270 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=7.5120 mle=1.8862 pcon=5.6258 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=7.5887 mle=1.9640 pcon=5.6247 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=7.8121 mle=2.1873 pcon=5.6248 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=7.4337 mle=1.8095 pcon=5.6242 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 33 it 47 total=7.8397 mle=2.2167 pcon=5.6230 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=7.7785 mle=2.1567 pcon=5.6218 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=7.6547 mle=2.0335 pcon=5.6212 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=7.4139 mle=1.7937 pcon=5.6201 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=7.5596 mle=1.9400 pcon=5.6196 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=7.7516 mle=2.1330 pcon=5.6186 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=7.8678 mle=2.2503 pcon=5.6175 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 6 total=7.8210 mle=2.2039 pcon=5.6171 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=7.4988 mle=1.8826 pcon=5.6163 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=7.4943 mle=1.8786 pcon=5.6157 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=7.6775 mle=2.0626 pcon=5.6149 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=7.5175 mle=1.9033 pcon=5.6142 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=7.5738 mle=1.9604 pcon=5.6134 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=7.5877 mle=1.9756 pcon=5.6121 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=7.7644 mle=2.1536 pcon=5.6108 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 15 total=7.5407 mle=1.9313 pcon=5.6094 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=7.6527 mle=2.0438 pcon=5.6089 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=7.7101 mle=2.1012 pcon=5.6088 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=7.8372 mle=2.2291 pcon=5.6082 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=7.7558 mle=2.1483 pcon=5.6075 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=7.6723 mle=2.0652 pcon=5.6071 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=7.6921 mle=2.0859 pcon=5.6062 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=7.7357 mle=2.1301 pcon=5.6056 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 24 total=7.7926 mle=2.1877 pcon=5.6050 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=7.5620 mle=1.9584 pcon=5.6036 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=7.2579 mle=1.6554 pcon=5.6026 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=7.6360 mle=2.0349 pcon=5.6011 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=7.5225 mle=1.9227 pcon=5.5999 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=7.6567 mle=2.0571 pcon=5.5996 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=7.7076 mle=2.1084 pcon=5.5992 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=7.6649 mle=2.0660 pcon=5.5989 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=7.6254 mle=2.0265 pcon=5.5990 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=7.7277 mle=2.1292 pcon=5.5984 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=7.5533 mle=1.9554 pcon=5.5979 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=7.6013 mle=2.0045 pcon=5.5968 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=7.3650 mle=1.7687 pcon=5.5963 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=7.8998 mle=2.3048 pcon=5.5951 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=7.8807 mle=2.2862 pcon=5.5945 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=7.5356 mle=1.9419 pcon=5.5937 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 42 total=7.7346 mle=2.1420 pcon=5.5927 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=7.9013 mle=2.3097 pcon=5.5917 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
 78%|███████▊  | 39/50 [05:07<01:24,  7.67s/it] 80%|████████  | 40/50 [05:15<01:17,  7.72s/it] 82%|████████▏ | 41/50 [05:23<01:09,  7.74s/it] 84%|████████▍ | 42/50 [05:30<01:02,  7.79s/it] 86%|████████▌ | 43/50 [05:39<00:55,  7.94s/it] 88%|████████▊ | 44/50 [05:47<00:48,  8.15s/it] 90%|█████████ | 45/50 [05:55<00:40,  8.04s/it] 92%|█████████▏| 46/50 [06:03<00:31,  7.88s/it][loss] ep 38 it 142 total=7.4418 mle=1.8514 pcon=5.5903 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=7.4240 mle=1.8338 pcon=5.5902 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=7.6777 mle=2.0884 pcon=5.5893 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=7.7336 mle=2.1450 pcon=5.5885 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=7.4241 mle=1.8367 pcon=5.5875 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 1 total=7.8230 mle=2.2358 pcon=5.5872 forget=0.0000 orth=0.0000 favg=0.0000 nr=117 nf=11 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=7.4996 mle=1.9130 pcon=5.5865 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=7.7330 mle=2.1458 pcon=5.5872 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=7.6171 mle=2.0307 pcon=5.5864 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=7.7034 mle=2.1177 pcon=5.5857 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=7.5285 mle=1.9433 pcon=5.5852 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=7.5644 mle=1.9793 pcon=5.5850 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=7.6779 mle=2.0937 pcon=5.5842 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 10 total=7.5215 mle=1.9377 pcon=5.5838 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=7.5399 mle=1.9571 pcon=5.5827 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=7.6488 mle=2.0664 pcon=5.5824 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=7.5119 mle=1.9305 pcon=5.5814 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=7.6515 mle=2.0702 pcon=5.5813 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=7.6373 mle=2.0566 pcon=5.5807 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=7.7840 mle=2.2041 pcon=5.5799 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=7.6090 mle=2.0297 pcon=5.5793 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 41 it 19 total=7.6943 mle=2.1154 pcon=5.5789 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=7.7774 mle=2.1988 pcon=5.5786 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=7.8007 mle=2.2222 pcon=5.5785 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=7.6897 mle=2.1126 pcon=5.5771 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=7.4679 mle=1.8915 pcon=5.5764 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=7.3759 mle=1.8002 pcon=5.5758 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=7.8181 mle=2.2430 pcon=5.5751 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=7.6875 mle=2.1122 pcon=5.5754 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 28 total=7.6563 mle=2.0809 pcon=5.5754 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=7.5519 mle=1.9770 pcon=5.5748 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=7.6172 mle=2.0427 pcon=5.5745 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=7.4555 mle=1.8817 pcon=5.5739 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=7.3948 mle=1.8214 pcon=5.5734 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=7.6689 mle=2.0956 pcon=5.5733 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=7.6159 mle=2.0430 pcon=5.5729 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=7.6431 mle=2.0704 pcon=5.5726 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 37 total=7.5966 mle=2.0240 pcon=5.5726 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=7.4994 mle=1.9266 pcon=5.5728 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=7.8072 mle=2.2349 pcon=5.5723 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=7.5762 mle=2.0046 pcon=5.5715 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=7.6175 mle=2.0463 pcon=5.5712 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=7.7061 mle=2.1352 pcon=5.5709 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=7.6768 mle=2.1067 pcon=5.5701 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=7.4979 mle=1.9282 pcon=5.5697 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 46 total=7.6993 mle=2.1308 pcon=5.5686 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=7.5130 mle=1.9449 pcon=5.5681 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=7.8834 mle=2.3155 pcon=5.5679 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=7.9496 mle=2.3825 pcon=5.5670 forget=0.0000 orth=0.0000 favg=0.0000 nr=107 nf=21 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=7.5591 mle=1.9921 pcon=5.5669 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=7.6274 mle=2.0606 pcon=5.5668 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=7.5692 mle=2.0028 pcon=5.5663 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 45 it 5 total=7.4716 mle=1.9058 pcon=5.5658 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 55 total=7.4570 mle=1.8918 pcon=5.5652 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 105 total=7.6047 mle=2.0391 pcon=5.5656 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 45 it 155 total=7.7231 mle=2.1569 pcon=5.5662 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 205 total=7.6990 mle=2.1322 pcon=5.5668 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 45 it 255 total=7.5573 mle=1.9909 pcon=5.5664 forget=0.0000 orth=0.0000 favg=0.0000 nr=120 nf=8 protos=None fproto_sim=NA
[loss] ep 45 it 305 total=7.6263 mle=2.0599 pcon=5.5664 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 355 total=7.4998 mle=1.9336 pcon=5.5662 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 14 total=7.5817 mle=2.0154 pcon=5.5663 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 64 total=7.7353 mle=2.1698 pcon=5.5655 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
 94%|█████████▍| 47/50 [06:11<00:23,  7.98s/it] 96%|█████████▌| 48/50 [06:19<00:15,  7.91s/it] 98%|█████████▊| 49/50 [06:27<00:07,  7.96s/it]100%|██████████| 50/50 [06:34<00:00,  7.86s/it]100%|██████████| 50/50 [06:34<00:00,  7.90s/it]
[loss] ep 46 it 114 total=7.7609 mle=2.1950 pcon=5.5659 forget=0.0000 orth=0.0000 favg=0.0000 nr=116 nf=12 protos=None fproto_sim=NA
[loss] ep 46 it 164 total=7.5662 mle=2.0005 pcon=5.5656 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 46 it 214 total=7.5972 mle=2.0322 pcon=5.5650 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 46 it 264 total=7.6147 mle=2.0502 pcon=5.5645 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 46 it 314 total=7.6010 mle=2.0368 pcon=5.5641 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
[loss] ep 46 it 364 total=7.7423 mle=2.1787 pcon=5.5636 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 23 total=7.7977 mle=2.2345 pcon=5.5633 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 73 total=7.6793 mle=2.1165 pcon=5.5629 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 47 it 123 total=7.5524 mle=1.9895 pcon=5.5629 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 173 total=7.4129 mle=1.8508 pcon=5.5621 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 223 total=7.6387 mle=2.0765 pcon=5.5622 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 47 it 273 total=7.6356 mle=2.0731 pcon=5.5625 forget=0.0000 orth=0.0000 favg=0.0000 nr=121 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 323 total=7.6809 mle=2.1183 pcon=5.5626 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 47 it 373 total=7.4588 mle=1.8963 pcon=5.5625 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 48 it 32 total=7.5494 mle=1.9866 pcon=5.5627 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 82 total=7.6619 mle=2.0992 pcon=5.5627 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 48 it 132 total=7.3899 mle=1.8274 pcon=5.5626 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 48 it 182 total=7.6403 mle=2.0778 pcon=5.5625 forget=0.0000 orth=0.0000 favg=0.0000 nr=119 nf=9 protos=None fproto_sim=NA
[loss] ep 48 it 232 total=7.8857 mle=2.3237 pcon=5.5620 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 48 it 282 total=7.7693 mle=2.2071 pcon=5.5622 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 48 it 332 total=7.5941 mle=2.0324 pcon=5.5617 forget=0.0000 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=None fproto_sim=NA
[loss] ep 48 it 382 total=7.3386 mle=1.7772 pcon=5.5614 forget=0.0000 orth=0.0000 favg=0.0000 nr=123 nf=5 protos=None fproto_sim=NA
[loss] ep 49 it 41 total=7.5894 mle=2.0276 pcon=5.5617 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 49 it 91 total=7.6217 mle=2.0608 pcon=5.5609 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 49 it 141 total=7.6853 mle=2.1245 pcon=5.5608 forget=0.0000 orth=0.0000 favg=0.0000 nr=122 nf=6 protos=None fproto_sim=NA
[loss] ep 49 it 191 total=7.5991 mle=2.0388 pcon=5.5603 forget=0.0000 orth=0.0000 favg=0.0000 nr=126 nf=2 protos=None fproto_sim=NA
[loss] ep 49 it 241 total=7.7144 mle=2.1547 pcon=5.5597 forget=0.0000 orth=0.0000 favg=0.0000 nr=124 nf=4 protos=None fproto_sim=NA
[loss] ep 49 it 291 total=7.8099 mle=2.2495 pcon=5.5604 forget=0.0000 orth=0.0000 favg=0.0000 nr=113 nf=15 protos=None fproto_sim=NA
[loss] ep 49 it 341 total=7.5430 mle=1.9828 pcon=5.5601 forget=0.0000 orth=0.0000 favg=0.0000 nr=125 nf=3 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage1-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:35,  1.81it/s]  2%|▏         | 7/391 [00:00<00:28, 13.40it/s]  3%|▎         | 13/391 [00:00<00:16, 22.51it/s]  5%|▌         | 20/391 [00:00<00:11, 33.33it/s]  7%|▋         | 28/391 [00:01<00:08, 43.74it/s] 10%|▉         | 38/391 [00:01<00:06, 57.31it/s] 12%|█▏        | 48/391 [00:01<00:05, 67.48it/s] 15%|█▍        | 58/391 [00:01<00:04, 74.90it/s] 17%|█▋        | 67/391 [00:01<00:04, 76.54it/s] 19%|█▉        | 76/391 [00:01<00:03, 79.99it/s] 22%|██▏       | 86/391 [00:01<00:03, 83.41it/s] 25%|██▍       | 96/391 [00:01<00:03, 86.07it/s] 27%|██▋       | 106/391 [00:01<00:03, 88.58it/s] 30%|██▉       | 116/391 [00:01<00:03, 90.58it/s] 32%|███▏      | 126/391 [00:02<00:02, 92.12it/s] 35%|███▍      | 136/391 [00:02<00:02, 93.17it/s] 37%|███▋      | 146/391 [00:02<00:02, 93.61it/s] 40%|███▉      | 156/391 [00:02<00:02, 92.51it/s] 42%|████▏     | 166/391 [00:02<00:02, 91.48it/s] 45%|████▌     | 176/391 [00:02<00:02, 92.69it/s] 48%|████▊     | 186/391 [00:02<00:02, 93.69it/s] 50%|█████     | 196/391 [00:02<00:02, 93.23it/s] 53%|█████▎    | 206/391 [00:02<00:01, 93.15it/s] 55%|█████▌    | 216/391 [00:03<00:01, 90.26it/s] 58%|█████▊    | 226/391 [00:03<00:01, 91.39it/s] 60%|██████    | 236/391 [00:03<00:01, 90.30it/s] 63%|██████▎   | 246/391 [00:03<00:01, 81.42it/s] 65%|██████▌   | 256/391 [00:03<00:01, 84.71it/s] 68%|██████▊   | 266/391 [00:03<00:01, 87.67it/s] 71%|███████   | 276/391 [00:03<00:01, 89.71it/s] 73%|███████▎  | 286/391 [00:03<00:01, 91.14it/s] 76%|███████▌  | 296/391 [00:03<00:01, 92.38it/s] 78%|███████▊  | 306/391 [00:04<00:00, 92.81it/s] 81%|████████  | 316/391 [00:04<00:00, 93.51it/s] 83%|████████▎ | 326/391 [00:04<00:00, 94.32it/s] 86%|████████▌ | 336/391 [00:04<00:00, 94.55it/s] 88%|████████▊ | 346/391 [00:04<00:00, 94.95it/s] 91%|█████████ | 356/391 [00:04<00:00, 93.93it/s] 94%|█████████▎| 366/391 [00:04<00:00, 82.25it/s] 96%|█████████▌| 376/391 [00:04<00:00, 86.33it/s] 99%|█████████▊| 386/391 [00:04<00:00, 89.49it/s]100%|██████████| 391/391 [00:04<00:00, 78.21it/s]
50000 images processed, 5.031807899475098 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:30,  2.54it/s] 11%|█▏        | 9/79 [00:00<00:03, 22.59it/s] 24%|██▍       | 19/79 [00:00<00:01, 42.47it/s] 33%|███▎      | 26/79 [00:00<00:01, 43.12it/s] 44%|████▍     | 35/79 [00:00<00:00, 54.94it/s] 57%|█████▋    | 45/79 [00:00<00:00, 65.38it/s] 70%|██████▉   | 55/79 [00:01<00:00, 73.74it/s] 82%|████████▏ | 65/79 [00:01<00:00, 80.17it/s] 95%|█████████▍| 75/79 [00:01<00:00, 84.94it/s]100%|██████████| 79/79 [00:01<00:00, 46.38it/s]
10000 images processed, 1.7255921363830566 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:39,  2.04it/s]  5%|▌         | 11/204 [00:00<00:08, 23.68it/s] 10%|▉         | 20/204 [00:00<00:04, 38.93it/s] 15%|█▍        | 30/204 [00:00<00:03, 53.40it/s] 20%|█▉        | 40/204 [00:00<00:02, 64.34it/s] 24%|██▍       | 49/204 [00:01<00:02, 71.00it/s] 29%|██▉       | 59/204 [00:01<00:01, 77.38it/s] 34%|███▍      | 69/204 [00:01<00:01, 82.02it/s] 39%|███▊      | 79/204 [00:01<00:01, 85.13it/s] 44%|████▎     | 89/204 [00:01<00:01, 75.93it/s] 48%|████▊     | 98/204 [00:01<00:01, 75.79it/s] 53%|█████▎    | 108/204 [00:01<00:01, 80.19it/s] 57%|█████▋    | 117/204 [00:01<00:01, 81.27it/s] 62%|██████▏   | 127/204 [00:01<00:00, 84.78it/s] 67%|██████▋   | 136/204 [00:02<00:00, 86.11it/s] 72%|███████▏  | 146/204 [00:02<00:00, 88.40it/s] 76%|███████▌  | 155/204 [00:02<00:00, 87.16it/s] 80%|████████  | 164/204 [00:02<00:00, 80.09it/s] 85%|████████▍ | 173/204 [00:02<00:00, 73.33it/s] 90%|████████▉ | 183/204 [00:02<00:00, 79.47it/s] 95%|█████████▍| 193/204 [00:02<00:00, 84.21it/s]100%|█████████▉| 203/204 [00:02<00:00, 87.71it/s]100%|██████████| 204/204 [00:02<00:00, 71.09it/s]
26032 images processed, 2.9247777462005615 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:15,  1.04it/s] 13%|█▎        | 10/79 [00:01<00:05, 12.44it/s] 24%|██▍       | 19/79 [00:01<00:02, 24.38it/s] 37%|███▋      | 29/79 [00:01<00:01, 37.71it/s] 47%|████▋     | 37/79 [00:01<00:00, 43.72it/s] 59%|█████▉    | 47/79 [00:01<00:00, 54.54it/s] 71%|███████   | 56/79 [00:01<00:00, 61.83it/s] 84%|████████▎ | 66/79 [00:01<00:00, 70.49it/s] 95%|█████████▍| 75/79 [00:01<00:00, 65.92it/s]100%|██████████| 79/79 [00:01<00:00, 41.18it/s]
10000 images processed, 1.9493370056152344 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:47,  1.63it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.89it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.06it/s] 39%|███▉      | 31/79 [00:00<00:00, 49.84it/s] 52%|█████▏    | 41/79 [00:01<00:00, 60.60it/s] 65%|██████▍   | 51/79 [00:01<00:00, 69.64it/s] 77%|███████▋  | 61/79 [00:01<00:00, 77.01it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.54it/s]100%|██████████| 79/79 [00:01<00:00, 55.09it/s]
10000 images processed, 1.4523265361785889 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:01<01:11,  1.03s/it] 16%|█▌        | 11/70 [00:01<00:04, 12.92it/s] 24%|██▍       | 17/70 [00:01<00:02, 19.57it/s] 34%|███▍      | 24/70 [00:01<00:01, 27.55it/s] 43%|████▎     | 30/70 [00:01<00:01, 33.54it/s] 57%|█████▋    | 40/70 [00:01<00:00, 47.21it/s] 71%|███████▏  | 50/70 [00:01<00:00, 59.05it/s] 83%|████████▎ | 58/70 [00:01<00:00, 62.72it/s] 94%|█████████▍| 66/70 [00:01<00:00, 64.65it/s]100%|██████████| 70/70 [00:01<00:00, 35.96it/s]
8925 images processed, 1.9915997982025146 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:44,  1.01s/it]  4%|▍         | 2/45 [00:01<00:23,  1.79it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.46it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.64it/s] 47%|████▋     | 21/45 [00:01<00:01, 14.62it/s] 53%|█████▎    | 24/45 [00:02<00:01, 15.84it/s] 76%|███████▌  | 34/45 [00:02<00:00, 17.55it/s] 98%|█████████▊| 44/45 [00:02<00:00, 27.29it/s]100%|██████████| 45/45 [00:02<00:00, 16.73it/s]
5640 images processed, 2.7100958824157715 seconds used

20.2937114238739
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           3.56  99.04  73.60
places365     49.92  89.49  51.36
LSUN          25.93  95.19  76.04
iSUN          26.01  95.03  73.73
dtd           24.68  94.43  71.73
AVG           26.02  94.64  69.29
[incremental] Overall: 0.8480 New: 0.8480 Old: nan
[incremental] Final(Top-1): 0.8480  Average: 0.8480
2.7838125228881836
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [00:18<15:02, 18.42s/it]  4%|▍         | 2/50 [00:28<10:36, 13.26s/it]  6%|▌         | 3/50 [00:38<09:26, 12.05s/it]  8%|▊         | 4/50 [00:49<08:55, 11.64s/it] 10%|█         | 5/50 [00:59<08:07, 10.84s/it] 12%|█▏        | 6/50 [01:10<08:01, 10.94s/it][loss] ep 0 it 0 total=12.0911 mle=2.3148 pcon=8.7277 forget=0.0000 orth=1.0486 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=12.0666 mle=2.2863 pcon=8.7318 forget=0.0000 orth=1.0485 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=12.2136 mle=2.4299 pcon=8.7353 forget=0.0000 orth=1.0484 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=12.1215 mle=2.3345 pcon=8.7388 forget=0.0000 orth=1.0482 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=11.7747 mle=1.9851 pcon=8.7417 forget=0.0000 orth=1.0480 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=11.9871 mle=2.1951 pcon=8.7444 forget=0.0000 orth=1.0477 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=12.4181 mle=2.6241 pcon=8.7466 forget=0.0000 orth=1.0474 favg=0.0000 nr=105 nf=12 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=11.9928 mle=2.1975 pcon=8.7483 forget=0.0000 orth=1.0471 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 1 it 9 total=11.9500 mle=2.1529 pcon=8.7504 forget=0.0000 orth=1.0467 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=11.9380 mle=2.1393 pcon=8.7524 forget=0.0000 orth=1.0463 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=12.0898 mle=2.2899 pcon=8.7539 forget=0.0000 orth=1.0459 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=12.3272 mle=2.5261 pcon=8.7557 forget=0.0000 orth=1.0454 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=12.2575 mle=2.4557 pcon=8.7568 forget=0.0000 orth=1.0450 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=11.8905 mle=2.0881 pcon=8.7580 forget=0.0000 orth=1.0445 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=12.1923 mle=2.3893 pcon=8.7592 forget=0.0000 orth=1.0439 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=12.0808 mle=2.2772 pcon=8.7603 forget=0.0000 orth=1.0433 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 2 it 18 total=12.0149 mle=2.2114 pcon=8.7610 forget=0.0000 orth=1.0425 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=12.0754 mle=2.2715 pcon=8.7622 forget=0.0000 orth=1.0418 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=11.9126 mle=2.1078 pcon=8.7636 forget=0.0000 orth=1.0411 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=11.9622 mle=2.1571 pcon=8.7647 forget=0.0000 orth=1.0403 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=11.5838 mle=1.7782 pcon=8.7660 forget=0.0000 orth=1.0396 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=12.1267 mle=2.3213 pcon=8.7666 forget=0.0000 orth=1.0388 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=12.1813 mle=2.3760 pcon=8.7674 forget=0.0000 orth=1.0379 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=11.6930 mle=1.8873 pcon=8.7687 forget=0.0000 orth=1.0370 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 3 it 27 total=12.0749 mle=2.2697 pcon=8.7692 forget=0.0000 orth=1.0360 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=12.1938 mle=2.3886 pcon=8.7703 forget=0.0000 orth=1.0349 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=12.1312 mle=2.3262 pcon=8.7711 forget=0.0000 orth=1.0339 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=12.0205 mle=2.2154 pcon=8.7723 forget=0.0000 orth=1.0329 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=11.9360 mle=2.1306 pcon=8.7735 forget=0.0000 orth=1.0318 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=11.9651 mle=2.1599 pcon=8.7745 forget=0.0000 orth=1.0306 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=11.9501 mle=2.1454 pcon=8.7754 forget=0.0000 orth=1.0293 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=12.0058 mle=2.2017 pcon=8.7759 forget=0.0000 orth=1.0281 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 4 it 36 total=12.0140 mle=2.2097 pcon=8.7774 forget=0.0000 orth=1.0268 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=12.0257 mle=2.2212 pcon=8.7786 forget=0.0000 orth=1.0259 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=12.1449 mle=2.3407 pcon=8.7796 forget=0.0000 orth=1.0247 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=11.8309 mle=2.0271 pcon=8.7804 forget=0.0000 orth=1.0234 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=11.8796 mle=2.0764 pcon=8.7812 forget=0.0000 orth=1.0219 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=11.8369 mle=2.0337 pcon=8.7826 forget=0.0000 orth=1.0206 favg=0.0000 nr=115 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.1787 mle=2.3754 pcon=8.7836 forget=0.0000 orth=1.0196 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=11.8034 mle=2.0001 pcon=8.7849 forget=0.0000 orth=1.0184 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 5 it 45 total=11.9762 mle=2.1736 pcon=8.7855 forget=0.0000 orth=1.0170 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=11.8752 mle=2.0729 pcon=8.7868 forget=0.0000 orth=1.0154 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=11.9058 mle=2.1041 pcon=8.7875 forget=0.0000 orth=1.0142 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=11.9913 mle=2.1896 pcon=8.7890 forget=0.0000 orth=1.0127 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.0464 mle=2.2449 pcon=8.7901 forget=0.0000 orth=1.0114 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=11.7278 mle=1.9258 pcon=8.7921 forget=0.0000 orth=1.0100 favg=0.0000 nr=120 nf=1 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.1236 mle=2.3213 pcon=8.7937 forget=0.0000 orth=1.0086 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 6 it 4 total=11.9787 mle=2.1769 pcon=8.7944 forget=0.0000 orth=1.0074 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.0672 mle=2.2651 pcon=8.7961 forget=0.0000 orth=1.0061 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.8457 mle=2.0432 pcon=8.7979 forget=0.0000 orth=1.0046 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.6709 mle=1.8690 pcon=8.7987 forget=0.0000 orth=1.0032 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
 14%|█▍        | 7/50 [01:20<07:47, 10.88s/it] 16%|█▌        | 8/50 [01:31<07:33, 10.80s/it] 18%|█▊        | 9/50 [01:41<07:14, 10.60s/it] 20%|██        | 10/50 [01:52<07:03, 10.60s/it] 22%|██▏       | 11/50 [02:03<06:55, 10.67s/it] 24%|██▍       | 12/50 [02:13<06:37, 10.46s/it][loss] ep 6 it 204 total=11.8448 mle=2.0433 pcon=8.7998 forget=0.0000 orth=1.0016 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.8537 mle=2.0526 pcon=8.8008 forget=0.0000 orth=1.0003 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.2112 mle=2.4097 pcon=8.8025 forget=0.0000 orth=0.9991 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.7709 mle=1.9692 pcon=8.8040 forget=0.0000 orth=0.9977 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 7 it 13 total=12.1375 mle=2.3355 pcon=8.8056 forget=0.0000 orth=0.9965 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.2206 mle=2.4181 pcon=8.8073 forget=0.0000 orth=0.9952 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.0884 mle=2.2860 pcon=8.8087 forget=0.0000 orth=0.9937 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.1135 mle=2.3103 pcon=8.8108 forget=0.0000 orth=0.9924 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.9123 mle=2.1098 pcon=8.8113 forget=0.0000 orth=0.9911 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.9889 mle=2.1855 pcon=8.8136 forget=0.0000 orth=0.9898 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.8657 mle=2.0618 pcon=8.8154 forget=0.0000 orth=0.9885 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.0134 mle=2.2091 pcon=8.8172 forget=0.0000 orth=0.9870 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 8 it 22 total=11.9792 mle=2.1748 pcon=8.8184 forget=0.0000 orth=0.9860 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.8128 mle=2.0086 pcon=8.8198 forget=0.0000 orth=0.9845 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.7033 mle=1.8991 pcon=8.8210 forget=0.0000 orth=0.9831 favg=0.0000 nr=118 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.5985 mle=1.7943 pcon=8.8223 forget=0.0000 orth=0.9818 favg=0.0000 nr=124 nf=1 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.6303 mle=1.8259 pcon=8.8240 forget=0.0000 orth=0.9803 favg=0.0000 nr=121 nf=3 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.7914 mle=1.9875 pcon=8.8249 forget=0.0000 orth=0.9791 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.8221 mle=2.0181 pcon=8.8263 forget=0.0000 orth=0.9777 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0350 mle=2.2302 pcon=8.8285 forget=0.0000 orth=0.9763 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 9 it 31 total=12.1873 mle=2.3826 pcon=8.8299 forget=0.0000 orth=0.9748 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.9305 mle=2.1261 pcon=8.8308 forget=0.0000 orth=0.9736 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7378 mle=1.9343 pcon=8.8316 forget=0.0000 orth=0.9719 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8459 mle=2.0426 pcon=8.8324 forget=0.0000 orth=0.9709 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.7756 mle=1.9714 pcon=8.8352 forget=0.0000 orth=0.9691 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8322 mle=2.0281 pcon=8.8367 forget=0.0000 orth=0.9674 favg=0.0000 nr=122 nf=2 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9322 mle=2.1279 pcon=8.8388 forget=0.0000 orth=0.9656 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7590 mle=1.9545 pcon=8.8403 forget=0.0000 orth=0.9642 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 10 it 40 total=11.6745 mle=1.8701 pcon=8.8418 forget=0.0000 orth=0.9627 favg=0.0000 nr=123 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=12.1513 mle=2.3475 pcon=8.8427 forget=0.0000 orth=0.9611 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.8339 mle=2.0298 pcon=8.8448 forget=0.0000 orth=0.9593 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.7999 mle=1.9959 pcon=8.8466 forget=0.0000 orth=0.9574 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6462 mle=1.8433 pcon=8.8470 forget=0.0000 orth=0.9559 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=12.0891 mle=2.2863 pcon=8.8491 forget=0.0000 orth=0.9537 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.7919 mle=1.9904 pcon=8.8498 forget=0.0000 orth=0.9517 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=12.0292 mle=2.2287 pcon=8.8509 forget=0.0000 orth=0.9495 favg=0.0000 nr=74 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 11 it 49 total=11.7757 mle=1.9756 pcon=8.8527 forget=0.0000 orth=0.9474 favg=0.0000 nr=117 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=12.0823 mle=2.2831 pcon=8.8539 forget=0.0000 orth=0.9454 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.9658 mle=2.1682 pcon=8.8547 forget=0.0000 orth=0.9429 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.8132 mle=2.0168 pcon=8.8557 forget=0.0000 orth=0.9407 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.6014 mle=1.8062 pcon=8.8570 forget=0.0000 orth=0.9382 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.9100 mle=2.1166 pcon=8.8579 forget=0.0000 orth=0.9354 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.6428 mle=1.8510 pcon=8.8591 forget=0.0000 orth=0.9327 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 12 it 8 total=11.9882 mle=2.1976 pcon=8.8606 forget=0.0000 orth=0.9300 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.7790 mle=1.9910 pcon=8.8613 forget=0.0000 orth=0.9267 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.9803 mle=2.1945 pcon=8.8622 forget=0.0000 orth=0.9235 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.7483 mle=1.9649 pcon=8.8632 forget=0.0000 orth=0.9202 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.7774 mle=1.9966 pcon=8.8643 forget=0.0000 orth=0.9165 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=12.0679 mle=2.2892 pcon=8.8659 forget=0.0000 orth=0.9129 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.8767 mle=2.1016 pcon=8.8662 forget=0.0000 orth=0.9089 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.9352 mle=2.1629 pcon=8.8674 forget=0.0000 orth=0.9049 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
 26%|██▌       | 13/50 [02:23<06:23, 10.36s/it] 28%|██▊       | 14/50 [02:34<06:18, 10.52s/it] 30%|███       | 15/50 [02:45<06:14, 10.71s/it] 32%|███▏      | 16/50 [02:56<06:05, 10.76s/it] 34%|███▍      | 17/50 [03:07<05:57, 10.83s/it] 36%|███▌      | 18/50 [03:17<05:39, 10.62s/it] 38%|███▊      | 19/50 [03:28<05:32, 10.72s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 13 it 17 total=11.9953 mle=2.2259 pcon=8.8689 forget=0.0000 orth=0.9004 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.7758 mle=2.0100 pcon=8.8698 forget=0.0000 orth=0.8960 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=12.0281 mle=2.2662 pcon=8.8706 forget=0.0000 orth=0.8913 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.8678 mle=2.1112 pcon=8.8701 forget=0.0000 orth=0.8865 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=12.0417 mle=2.2899 pcon=8.8705 forget=0.0000 orth=0.8814 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.9454 mle=2.1989 pcon=8.8704 forget=0.0000 orth=0.8761 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.8323 mle=2.0906 pcon=8.8712 forget=0.0000 orth=0.8704 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.8512 mle=2.1154 pcon=8.8711 forget=0.0000 orth=0.8647 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 14 it 26 total=12.0177 mle=2.2878 pcon=8.8712 forget=0.0000 orth=0.8586 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.7267 mle=2.0032 pcon=8.8710 forget=0.0000 orth=0.8525 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.7773 mle=2.0598 pcon=8.8714 forget=0.0000 orth=0.8461 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.9225 mle=2.2141 pcon=8.8689 forget=0.0000 orth=0.8395 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.6263 mle=1.9253 pcon=8.8684 forget=0.0000 orth=0.8327 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.8423 mle=2.1487 pcon=8.8677 forget=0.0000 orth=0.8258 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.7677 mle=2.0819 pcon=8.8673 forget=0.0000 orth=0.8186 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.5797 mle=1.9025 pcon=8.8661 forget=0.0000 orth=0.8111 favg=0.0000 nr=121 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 15 it 35 total=11.7557 mle=2.0870 pcon=8.8653 forget=0.0000 orth=0.8034 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.7395 mle=2.0795 pcon=8.8643 forget=0.0000 orth=0.7957 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.6097 mle=1.9585 pcon=8.8633 forget=0.0000 orth=0.7880 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.6071 mle=1.9658 pcon=8.8616 forget=0.0000 orth=0.7797 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.8157 mle=2.1842 pcon=8.8599 forget=0.0000 orth=0.7715 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.6535 mle=2.0314 pcon=8.8591 forget=0.0000 orth=0.7631 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.8099 mle=2.1987 pcon=8.8567 forget=0.0000 orth=0.7545 favg=0.0000 nr=107 nf=12 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.5952 mle=1.9942 pcon=8.8554 forget=0.0000 orth=0.7456 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 16 it 44 total=11.7104 mle=2.1204 pcon=8.8533 forget=0.0000 orth=0.7367 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.7447 mle=2.1652 pcon=8.8520 forget=0.0000 orth=0.7276 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.5573 mle=1.9889 pcon=8.8500 forget=0.0000 orth=0.7185 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.5709 mle=2.0139 pcon=8.8479 forget=0.0000 orth=0.7091 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.4870 mle=1.9417 pcon=8.8457 forget=0.0000 orth=0.6996 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.3927 mle=1.8594 pcon=8.8434 forget=0.0000 orth=0.6899 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.5460 mle=2.0246 pcon=8.8412 forget=0.0000 orth=0.6801 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 17 it 3 total=11.2915 mle=1.7818 pcon=8.8394 forget=0.0000 orth=0.6702 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.3156 mle=1.8184 pcon=8.8369 forget=0.0000 orth=0.6602 favg=0.0000 nr=120 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.4770 mle=1.9916 pcon=8.8354 forget=0.0000 orth=0.6500 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.3285 mle=1.8543 pcon=8.8345 forget=0.0000 orth=0.6397 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.3777 mle=1.9162 pcon=8.8320 forget=0.0000 orth=0.6295 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.4628 mle=2.0135 pcon=8.8303 forget=0.0000 orth=0.6190 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.3514 mle=1.9157 pcon=8.8273 forget=0.0000 orth=0.6084 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.4159 mle=1.9946 pcon=8.8236 forget=0.0000 orth=0.5978 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 18 it 12 total=11.3440 mle=1.9359 pcon=8.8211 forget=0.0000 orth=0.5870 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.6285 mle=2.2346 pcon=8.8177 forget=0.0000 orth=0.5762 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.2912 mle=1.9103 pcon=8.8155 forget=0.0000 orth=0.5654 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.4856 mle=2.1195 pcon=8.8116 forget=0.0000 orth=0.5546 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.4591 mle=2.1067 pcon=8.8088 forget=0.0000 orth=0.5437 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.3071 mle=1.9692 pcon=8.8052 forget=0.0000 orth=0.5327 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.2569 mle=1.9332 pcon=8.8019 forget=0.0000 orth=0.5219 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.1593 mle=1.8495 pcon=8.7988 forget=0.0000 orth=0.5109 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 19 it 21 total=11.2305 mle=1.9339 pcon=8.7967 forget=0.0000 orth=0.5000 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.3158 mle=2.0337 pcon=8.7931 forget=0.0000 orth=0.4890 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
 40%|████      | 20/50 [03:38<05:17, 10.59s/it] 42%|████▏     | 21/50 [03:49<05:13, 10.79s/it] 44%|████▍     | 22/50 [04:00<05:02, 10.80s/it] 46%|████▌     | 23/50 [04:11<04:53, 10.88s/it] 48%|████▊     | 24/50 [04:22<04:38, 10.71s/it] 50%|█████     | 25/50 [04:33<04:31, 10.86s/it][loss] ep 19 it 121 total=11.1814 mle=1.9127 pcon=8.7907 forget=0.0000 orth=0.4780 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.2677 mle=2.0121 pcon=8.7883 forget=0.0000 orth=0.4672 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.2396 mle=1.9971 pcon=8.7861 forget=0.0000 orth=0.4564 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.3163 mle=2.0881 pcon=8.7825 forget=0.0000 orth=0.4457 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.2785 mle=2.0638 pcon=8.7797 forget=0.0000 orth=0.4350 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.2502 mle=2.0491 pcon=8.7768 forget=0.0000 orth=0.4244 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 20 it 30 total=11.3177 mle=2.1299 pcon=8.7739 forget=0.0000 orth=0.4139 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.1074 mle=1.9334 pcon=8.7705 forget=0.0000 orth=0.4034 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.2193 mle=2.0588 pcon=8.7674 forget=0.0000 orth=0.3932 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.2472 mle=2.0998 pcon=8.7646 forget=0.0000 orth=0.3828 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=10.9343 mle=1.8010 pcon=8.7607 forget=0.0000 orth=0.3726 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.1318 mle=2.0123 pcon=8.7568 forget=0.0000 orth=0.3626 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.3676 mle=2.2615 pcon=8.7534 forget=0.0000 orth=0.3527 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.2064 mle=2.1121 pcon=8.7512 forget=0.0000 orth=0.3430 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 21 it 39 total=11.1216 mle=2.0417 pcon=8.7464 forget=0.0000 orth=0.3334 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=10.9148 mle=1.8477 pcon=8.7432 forget=0.0000 orth=0.3239 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.0771 mle=2.0227 pcon=8.7398 forget=0.0000 orth=0.3146 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=10.8977 mle=1.8560 pcon=8.7363 forget=0.0000 orth=0.3054 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.1729 mle=2.1439 pcon=8.7325 forget=0.0000 orth=0.2965 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=10.9020 mle=1.8853 pcon=8.7290 forget=0.0000 orth=0.2876 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=10.9410 mle=1.9363 pcon=8.7257 forget=0.0000 orth=0.2789 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.0893 mle=2.0971 pcon=8.7216 forget=0.0000 orth=0.2706 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 22 it 48 total=11.0728 mle=2.0921 pcon=8.7183 forget=0.0000 orth=0.2623 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=10.9311 mle=1.9620 pcon=8.7148 forget=0.0000 orth=0.2543 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=10.9433 mle=1.9848 pcon=8.7122 forget=0.0000 orth=0.2463 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=10.8406 mle=1.8923 pcon=8.7098 forget=0.0000 orth=0.2385 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=10.9782 mle=2.0406 pcon=8.7068 forget=0.0000 orth=0.2308 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=10.9492 mle=2.0227 pcon=8.7031 forget=0.0000 orth=0.2234 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.0940 mle=2.1787 pcon=8.6992 forget=0.0000 orth=0.2161 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 23 it 7 total=10.9158 mle=2.0125 pcon=8.6942 forget=0.0000 orth=0.2091 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=10.9418 mle=2.0491 pcon=8.6903 forget=0.0000 orth=0.2023 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.6414 mle=1.7595 pcon=8.6862 forget=0.0000 orth=0.1957 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.1611 mle=2.2892 pcon=8.6827 forget=0.0000 orth=0.1892 favg=0.0000 nr=113 nf=10 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=10.9153 mle=2.0534 pcon=8.6790 forget=0.0000 orth=0.1829 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=10.8876 mle=2.0357 pcon=8.6752 forget=0.0000 orth=0.1767 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=10.9073 mle=2.0654 pcon=8.6709 forget=0.0000 orth=0.1709 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=10.7618 mle=1.9295 pcon=8.6671 forget=0.0000 orth=0.1652 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 24 it 16 total=10.9247 mle=2.1016 pcon=8.6634 forget=0.0000 orth=0.1597 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=10.7399 mle=1.9254 pcon=8.6602 forget=0.0000 orth=0.1543 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=10.9673 mle=2.1617 pcon=8.6565 forget=0.0000 orth=0.1491 favg=0.0000 nr=115 nf=9 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=10.9128 mle=2.1169 pcon=8.6519 forget=0.0000 orth=0.1440 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=10.6842 mle=1.8976 pcon=8.6475 forget=0.0000 orth=0.1391 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=10.7473 mle=1.9684 pcon=8.6443 forget=0.0000 orth=0.1346 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=10.7434 mle=1.9727 pcon=8.6407 forget=0.0000 orth=0.1300 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.0287 mle=2.2666 pcon=8.6365 forget=0.0000 orth=0.1256 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 25 it 25 total=10.6272 mle=1.8738 pcon=8.6321 forget=0.0000 orth=0.1213 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=10.7113 mle=1.9658 pcon=8.6283 forget=0.0000 orth=0.1172 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.0086 mle=2.2720 pcon=8.6233 forget=0.0000 orth=0.1133 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=10.7501 mle=2.0217 pcon=8.6188 forget=0.0000 orth=0.1096 favg=0.0000 nr=112 nf=10 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=10.5231 mle=1.8018 pcon=8.6153 forget=0.0000 orth=0.1059 favg=0.0000 nr=121 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=10.8087 mle=2.0948 pcon=8.6115 forget=0.0000 orth=0.1024 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
 52%|█████▏    | 26/50 [04:44<04:21, 10.90s/it] 54%|█████▍    | 27/50 [04:55<04:13, 11.03s/it] 56%|█████▌    | 28/50 [05:06<04:03, 11.08s/it] 58%|█████▊    | 29/50 [05:18<03:57, 11.32s/it] 60%|██████    | 30/50 [05:30<03:47, 11.36s/it] 62%|██████▏   | 31/50 [05:40<03:31, 11.13s/it] 64%|██████▍   | 32/50 [05:52<03:23, 11.28s/it][loss] ep 25 it 325 total=10.6001 mle=1.8931 pcon=8.6081 forget=0.0000 orth=0.0989 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=10.7882 mle=2.0896 pcon=8.6028 forget=0.0000 orth=0.0957 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 26 it 34 total=10.5433 mle=1.8524 pcon=8.5983 forget=0.0000 orth=0.0926 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=10.7746 mle=2.0908 pcon=8.5943 forget=0.0000 orth=0.0895 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=10.6963 mle=2.0188 pcon=8.5909 forget=0.0000 orth=0.0866 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=10.7242 mle=2.0541 pcon=8.5862 forget=0.0000 orth=0.0838 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=10.5681 mle=1.9051 pcon=8.5819 forget=0.0000 orth=0.0812 favg=0.0000 nr=124 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=10.7975 mle=2.1410 pcon=8.5779 forget=0.0000 orth=0.0786 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=10.6783 mle=2.0281 pcon=8.5740 forget=0.0000 orth=0.0761 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=10.5303 mle=1.8858 pcon=8.5707 forget=0.0000 orth=0.0738 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 27 it 43 total=10.7547 mle=2.1165 pcon=8.5667 forget=0.0000 orth=0.0715 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=10.6616 mle=2.0295 pcon=8.5628 forget=0.0000 orth=0.0694 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=10.7583 mle=2.1317 pcon=8.5595 forget=0.0000 orth=0.0672 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=10.6479 mle=2.0276 pcon=8.5551 forget=0.0000 orth=0.0652 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=10.5651 mle=1.9512 pcon=8.5507 forget=0.0000 orth=0.0632 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=10.5997 mle=1.9920 pcon=8.5463 forget=0.0000 orth=0.0614 favg=0.0000 nr=122 nf=4 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.4081 mle=1.8062 pcon=8.5423 forget=0.0000 orth=0.0596 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 28 it 2 total=10.4507 mle=1.8550 pcon=8.5379 forget=0.0000 orth=0.0579 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=10.7486 mle=2.1593 pcon=8.5330 forget=0.0000 orth=0.0562 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=10.5850 mle=2.0012 pcon=8.5292 forget=0.0000 orth=0.0546 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=10.7841 mle=2.2055 pcon=8.5255 forget=0.0000 orth=0.0531 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=10.6595 mle=2.0865 pcon=8.5214 forget=0.0000 orth=0.0516 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=10.6185 mle=2.0505 pcon=8.5178 forget=0.0000 orth=0.0502 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.3419 mle=1.7790 pcon=8.5141 forget=0.0000 orth=0.0488 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=10.5195 mle=1.9626 pcon=8.5094 forget=0.0000 orth=0.0475 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 29 it 11 total=10.4021 mle=1.8515 pcon=8.5043 forget=0.0000 orth=0.0463 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=10.6203 mle=2.0736 pcon=8.5015 forget=0.0000 orth=0.0451 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=10.7618 mle=2.2195 pcon=8.4984 forget=0.0000 orth=0.0440 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.4995 mle=1.9619 pcon=8.4947 forget=0.0000 orth=0.0429 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=10.7235 mle=2.1909 pcon=8.4907 forget=0.0000 orth=0.0418 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=10.5964 mle=2.0677 pcon=8.4879 forget=0.0000 orth=0.0408 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=10.4673 mle=1.9433 pcon=8.4842 forget=0.0000 orth=0.0398 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=10.8216 mle=2.3026 pcon=8.4802 forget=0.0000 orth=0.0389 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 30 it 20 total=10.4260 mle=1.9122 pcon=8.4758 forget=0.0000 orth=0.0380 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=10.6321 mle=2.1233 pcon=8.4718 forget=0.0000 orth=0.0371 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.3772 mle=1.8728 pcon=8.4681 forget=0.0000 orth=0.0363 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=10.8471 mle=2.3466 pcon=8.4650 forget=0.0000 orth=0.0355 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=10.5445 mle=2.0485 pcon=8.4613 forget=0.0000 orth=0.0347 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.3215 mle=1.8299 pcon=8.4577 forget=0.0000 orth=0.0339 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=10.5089 mle=2.0215 pcon=8.4542 forget=0.0000 orth=0.0332 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=10.5776 mle=2.0945 pcon=8.4506 forget=0.0000 orth=0.0326 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 31 it 29 total=10.3931 mle=1.9143 pcon=8.4469 forget=0.0000 orth=0.0319 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=10.5893 mle=2.1159 pcon=8.4422 forget=0.0000 orth=0.0312 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=10.4430 mle=1.9736 pcon=8.4388 forget=0.0000 orth=0.0306 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=10.6572 mle=2.1921 pcon=8.4351 forget=0.0000 orth=0.0300 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=10.5634 mle=2.1031 pcon=8.4308 forget=0.0000 orth=0.0295 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.2917 mle=1.8351 pcon=8.4276 forget=0.0000 orth=0.0289 favg=0.0000 nr=118 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=10.5589 mle=2.1060 pcon=8.4245 forget=0.0000 orth=0.0284 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=10.6417 mle=2.1936 pcon=8.4203 forget=0.0000 orth=0.0278 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
 66%|██████▌   | 33/50 [06:03<03:10, 11.23s/it] 68%|██████▊   | 34/50 [06:13<02:55, 10.99s/it] 70%|███████   | 35/50 [06:25<02:47, 11.18s/it] 72%|███████▏  | 36/50 [06:35<02:32, 10.90s/it] 74%|███████▍  | 37/50 [06:46<02:22, 10.97s/it] 76%|███████▌  | 38/50 [06:58<02:13, 11.13s/it][loss] ep 32 it 38 total=10.4335 mle=1.9892 pcon=8.4170 forget=0.0000 orth=0.0274 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.4123 mle=1.9724 pcon=8.4130 forget=0.0000 orth=0.0269 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=10.4238 mle=1.9875 pcon=8.4099 forget=0.0000 orth=0.0265 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=10.5793 mle=2.1472 pcon=8.4061 forget=0.0000 orth=0.0261 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.2462 mle=1.8185 pcon=8.4021 forget=0.0000 orth=0.0256 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=10.3487 mle=1.9243 pcon=8.3992 forget=0.0000 orth=0.0252 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=10.6263 mle=2.2048 pcon=8.3967 forget=0.0000 orth=0.0248 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.2503 mle=1.8325 pcon=8.3933 forget=0.0000 orth=0.0245 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 33 it 47 total=10.5868 mle=2.1736 pcon=8.3891 forget=0.0000 orth=0.0241 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=10.5692 mle=2.1595 pcon=8.3860 forget=0.0000 orth=0.0237 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=10.4896 mle=2.0841 pcon=8.3821 forget=0.0000 orth=0.0234 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.2090 mle=1.8074 pcon=8.3786 forget=0.0000 orth=0.0231 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.2988 mle=1.9012 pcon=8.3749 forget=0.0000 orth=0.0228 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=10.4907 mle=2.0967 pcon=8.3715 forget=0.0000 orth=0.0225 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=10.6372 mle=2.2458 pcon=8.3692 forget=0.0000 orth=0.0222 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 34 it 6 total=10.5739 mle=2.1863 pcon=8.3658 forget=0.0000 orth=0.0219 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.2933 mle=1.9093 pcon=8.3624 forget=0.0000 orth=0.0216 favg=0.0000 nr=119 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.2882 mle=1.9077 pcon=8.3591 forget=0.0000 orth=0.0214 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=10.4261 mle=2.0501 pcon=8.3549 forget=0.0000 orth=0.0211 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.2233 mle=1.8505 pcon=8.3520 forget=0.0000 orth=0.0208 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=10.3479 mle=1.9790 pcon=8.3482 forget=0.0000 orth=0.0206 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.3327 mle=1.9672 pcon=8.3452 forget=0.0000 orth=0.0204 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=10.4859 mle=2.1238 pcon=8.3419 forget=0.0000 orth=0.0202 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 35 it 15 total=10.3402 mle=1.9817 pcon=8.3386 forget=0.0000 orth=0.0199 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=10.4144 mle=2.0597 pcon=8.3349 forget=0.0000 orth=0.0197 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=10.4888 mle=2.1367 pcon=8.3326 forget=0.0000 orth=0.0195 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=10.5493 mle=2.2000 pcon=8.3299 forget=0.0000 orth=0.0193 favg=0.0000 nr=106 nf=13 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=10.4789 mle=2.1323 pcon=8.3275 forget=0.0000 orth=0.0191 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=10.4047 mle=2.0614 pcon=8.3243 forget=0.0000 orth=0.0190 favg=0.0000 nr=116 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=10.4266 mle=2.0872 pcon=8.3206 forget=0.0000 orth=0.0188 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=10.4026 mle=2.0660 pcon=8.3180 forget=0.0000 orth=0.0186 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 36 it 24 total=10.5009 mle=2.1666 pcon=8.3158 forget=0.0000 orth=0.0185 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=10.2993 mle=1.9691 pcon=8.3119 forget=0.0000 orth=0.0183 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=10.0348 mle=1.7082 pcon=8.3085 forget=0.0000 orth=0.0181 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=10.3346 mle=2.0121 pcon=8.3045 forget=0.0000 orth=0.0180 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=10.2786 mle=1.9598 pcon=8.3010 forget=0.0000 orth=0.0178 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=10.4847 mle=2.1682 pcon=8.2989 forget=0.0000 orth=0.0177 favg=0.0000 nr=115 nf=11 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=10.4225 mle=2.1082 pcon=8.2967 forget=0.0000 orth=0.0176 favg=0.0000 nr=116 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=10.3293 mle=2.0175 pcon=8.2944 forget=0.0000 orth=0.0174 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 37 it 33 total=10.3333 mle=2.0241 pcon=8.2919 forget=0.0000 orth=0.0173 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=10.4283 mle=2.1219 pcon=8.2893 forget=0.0000 orth=0.0172 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=10.2820 mle=1.9782 pcon=8.2868 forget=0.0000 orth=0.0170 favg=0.0000 nr=116 nf=2 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=10.3546 mle=2.0539 pcon=8.2838 forget=0.0000 orth=0.0169 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=10.1267 mle=1.8281 pcon=8.2818 forget=0.0000 orth=0.0168 favg=0.0000 nr=120 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=10.5263 mle=2.2318 pcon=8.2778 forget=0.0000 orth=0.0167 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=10.5696 mle=2.2777 pcon=8.2754 forget=0.0000 orth=0.0166 favg=0.0000 nr=110 nf=11 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=10.2439 mle=1.9551 pcon=8.2723 forget=0.0000 orth=0.0165 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 38 it 42 total=10.3802 mle=2.0943 pcon=8.2694 forget=0.0000 orth=0.0164 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=10.5962 mle=2.3138 pcon=8.2661 forget=0.0000 orth=0.0163 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=10.1952 mle=1.9151 pcon=8.2639 forget=0.0000 orth=0.0162 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=10.1598 mle=1.8810 pcon=8.2626 forget=0.0000 orth=0.0162 favg=0.0000 nr=122 nf=3 protos=None fproto_sim=NA
 78%|███████▊  | 39/50 [07:10<02:04, 11.30s/it] 80%|████████  | 40/50 [07:22<01:55, 11.55s/it] 82%|████████▏ | 41/50 [07:33<01:44, 11.56s/it] 84%|████████▍ | 42/50 [07:45<01:32, 11.61s/it] 86%|████████▌ | 43/50 [07:56<01:20, 11.52s/it] 88%|████████▊ | 44/50 [08:07<01:07, 11.22s/it][loss] ep 38 it 242 total=10.3342 mle=2.0586 pcon=8.2596 forget=0.0000 orth=0.0161 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=10.4000 mle=2.1269 pcon=8.2571 forget=0.0000 orth=0.0160 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=10.1238 mle=1.8537 pcon=8.2542 forget=0.0000 orth=0.0159 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 39 it 1 total=10.4756 mle=2.2071 pcon=8.2527 forget=0.0000 orth=0.0158 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=10.2126 mle=1.9476 pcon=8.2493 forget=0.0000 orth=0.0157 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=10.3811 mle=2.1176 pcon=8.2479 forget=0.0000 orth=0.0157 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=10.2581 mle=1.9972 pcon=8.2453 forget=0.0000 orth=0.0156 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=10.3993 mle=2.1411 pcon=8.2426 forget=0.0000 orth=0.0155 favg=0.0000 nr=118 nf=8 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=10.2545 mle=1.9978 pcon=8.2413 forget=0.0000 orth=0.0154 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=10.2529 mle=1.9991 pcon=8.2385 forget=0.0000 orth=0.0154 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=10.4070 mle=2.1562 pcon=8.2354 forget=0.0000 orth=0.0153 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 40 it 10 total=10.2248 mle=1.9762 pcon=8.2334 forget=0.0000 orth=0.0153 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=10.2169 mle=1.9718 pcon=8.2299 forget=0.0000 orth=0.0152 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=10.2772 mle=2.0332 pcon=8.2288 forget=0.0000 orth=0.0151 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=10.2041 mle=1.9628 pcon=8.2262 forget=0.0000 orth=0.0151 favg=0.0000 nr=120 nf=2 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=10.2667 mle=2.0275 pcon=8.2241 forget=0.0000 orth=0.0150 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=10.2448 mle=2.0072 pcon=8.2226 forget=0.0000 orth=0.0150 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=10.4856 mle=2.2500 pcon=8.2206 forget=0.0000 orth=0.0149 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=10.2354 mle=2.0014 pcon=8.2191 forget=0.0000 orth=0.0149 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 41 it 19 total=10.3528 mle=2.1201 pcon=8.2178 forget=0.0000 orth=0.0149 favg=0.0000 nr=118 nf=3 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=10.4585 mle=2.2274 pcon=8.2163 forget=0.0000 orth=0.0148 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=10.4426 mle=2.2131 pcon=8.2147 forget=0.0000 orth=0.0148 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=10.3304 mle=2.1030 pcon=8.2126 forget=0.0000 orth=0.0147 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=10.1731 mle=1.9473 pcon=8.2111 forget=0.0000 orth=0.0147 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=10.0239 mle=1.7995 pcon=8.2098 forget=0.0000 orth=0.0147 favg=0.0000 nr=119 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=10.4454 mle=2.2240 pcon=8.2067 forget=0.0000 orth=0.0146 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=10.3302 mle=2.1103 pcon=8.2053 forget=0.0000 orth=0.0146 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 42 it 28 total=10.3009 mle=2.0837 pcon=8.2027 forget=0.0000 orth=0.0145 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=10.2608 mle=2.0459 pcon=8.2004 forget=0.0000 orth=0.0145 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=10.2630 mle=2.0500 pcon=8.1985 forget=0.0000 orth=0.0145 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=10.1800 mle=1.9693 pcon=8.1963 forget=0.0000 orth=0.0144 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=10.0326 mle=1.8240 pcon=8.1942 forget=0.0000 orth=0.0144 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=10.3129 mle=2.1061 pcon=8.1924 forget=0.0000 orth=0.0144 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=10.1964 mle=1.9907 pcon=8.1913 forget=0.0000 orth=0.0143 favg=0.0000 nr=111 nf=10 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=10.2890 mle=2.0854 pcon=8.1893 forget=0.0000 orth=0.0143 favg=0.0000 nr=118 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 43 it 37 total=10.3109 mle=2.1090 pcon=8.1876 forget=0.0000 orth=0.0143 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=10.1621 mle=1.9613 pcon=8.1866 forget=0.0000 orth=0.0143 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=10.4696 mle=2.2713 pcon=8.1841 forget=0.0000 orth=0.0142 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=10.2208 mle=2.0248 pcon=8.1818 forget=0.0000 orth=0.0142 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=10.2804 mle=2.0856 pcon=8.1806 forget=0.0000 orth=0.0142 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=10.3185 mle=2.1252 pcon=8.1791 forget=0.0000 orth=0.0142 favg=0.0000 nr=117 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=10.2943 mle=2.1035 pcon=8.1766 forget=0.0000 orth=0.0141 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=10.0927 mle=1.9028 pcon=8.1758 forget=0.0000 orth=0.0141 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 44 it 46 total=10.2633 mle=2.0755 pcon=8.1736 forget=0.0000 orth=0.0141 favg=0.0000 nr=116 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=10.1964 mle=2.0110 pcon=8.1713 forget=0.0000 orth=0.0141 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=10.4833 mle=2.2986 pcon=8.1706 forget=0.0000 orth=0.0141 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=10.5406 mle=2.3587 pcon=8.1679 forget=0.0000 orth=0.0140 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=10.1611 mle=1.9796 pcon=8.1674 forget=0.0000 orth=0.0140 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=10.2646 mle=2.0847 pcon=8.1659 forget=0.0000 orth=0.0140 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=10.1239 mle=1.9457 pcon=8.1642 forget=0.0000 orth=0.0140 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
 90%|█████████ | 45/50 [08:18<00:55, 11.11s/it] 92%|█████████▏| 46/50 [08:28<00:43, 10.91s/it] 94%|█████████▍| 47/50 [08:39<00:32, 10.90s/it] 96%|█████████▌| 48/50 [08:50<00:22, 11.05s/it] 98%|█████████▊| 49/50 [09:02<00:11, 11.13s/it]100%|██████████| 50/50 [09:13<00:00, 11.25s/it]100%|██████████| 50/50 [09:13<00:00, 11.08s/it]
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 45 it 5 total=10.1304 mle=1.9531 pcon=8.1633 forget=0.0000 orth=0.0140 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 55 total=10.1275 mle=1.9510 pcon=8.1625 forget=0.0000 orth=0.0140 favg=0.0000 nr=122 nf=1 protos=None fproto_sim=NA
[loss] ep 45 it 105 total=10.2238 mle=2.0482 pcon=8.1616 forget=0.0000 orth=0.0140 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 45 it 155 total=10.2915 mle=2.1162 pcon=8.1613 forget=0.0000 orth=0.0140 favg=0.0000 nr=115 nf=8 protos=None fproto_sim=NA
[loss] ep 45 it 205 total=10.3834 mle=2.2089 pcon=8.1606 forget=0.0000 orth=0.0140 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 45 it 255 total=10.1920 mle=2.0177 pcon=8.1604 forget=0.0000 orth=0.0139 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 45 it 305 total=10.3294 mle=2.1574 pcon=8.1581 forget=0.0000 orth=0.0139 favg=0.0000 nr=112 nf=11 protos=None fproto_sim=NA
[loss] ep 45 it 355 total=10.1214 mle=1.9514 pcon=8.1561 forget=0.0000 orth=0.0139 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 46 it 14 total=10.1759 mle=2.0072 pcon=8.1548 forget=0.0000 orth=0.0139 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 46 it 64 total=10.3445 mle=2.1772 pcon=8.1534 forget=0.0000 orth=0.0139 favg=0.0000 nr=110 nf=11 protos=None fproto_sim=NA
[loss] ep 46 it 114 total=10.4076 mle=2.2413 pcon=8.1524 forget=0.0000 orth=0.0139 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 46 it 164 total=10.1669 mle=2.0028 pcon=8.1502 forget=0.0000 orth=0.0139 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 46 it 214 total=10.2039 mle=2.0410 pcon=8.1491 forget=0.0000 orth=0.0139 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 264 total=10.2497 mle=2.0878 pcon=8.1480 forget=0.0000 orth=0.0139 favg=0.0000 nr=117 nf=8 protos=None fproto_sim=NA
[loss] ep 46 it 314 total=10.1689 mle=2.0080 pcon=8.1470 forget=0.0000 orth=0.0139 favg=0.0000 nr=119 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 364 total=10.3395 mle=2.1804 pcon=8.1452 forget=0.0000 orth=0.0139 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 47 it 23 total=10.4253 mle=2.2663 pcon=8.1451 forget=0.0000 orth=0.0139 favg=0.0000 nr=112 nf=9 protos=None fproto_sim=NA
[loss] ep 47 it 73 total=10.3069 mle=2.1491 pcon=8.1440 forget=0.0000 orth=0.0139 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 123 total=10.1475 mle=1.9906 pcon=8.1430 forget=0.0000 orth=0.0139 favg=0.0000 nr=118 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 173 total=10.0693 mle=1.9140 pcon=8.1414 forget=0.0000 orth=0.0138 favg=0.0000 nr=114 nf=9 protos=None fproto_sim=NA
[loss] ep 47 it 223 total=10.1715 mle=2.0175 pcon=8.1401 forget=0.0000 orth=0.0138 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 273 total=10.2224 mle=2.0705 pcon=8.1381 forget=0.0000 orth=0.0138 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 47 it 323 total=10.2975 mle=2.1461 pcon=8.1375 forget=0.0000 orth=0.0138 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[loss] ep 47 it 373 total=10.0092 mle=1.8578 pcon=8.1375 forget=0.0000 orth=0.0138 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 48 it 32 total=10.1992 mle=2.0486 pcon=8.1368 forget=0.0000 orth=0.0138 favg=0.0000 nr=120 nf=3 protos=None fproto_sim=NA
[loss] ep 48 it 82 total=10.2287 mle=2.0789 pcon=8.1360 forget=0.0000 orth=0.0138 favg=0.0000 nr=117 nf=2 protos=None fproto_sim=NA
[loss] ep 48 it 132 total=9.9586 mle=1.8095 pcon=8.1353 forget=0.0000 orth=0.0138 favg=0.0000 nr=119 nf=3 protos=None fproto_sim=NA
[loss] ep 48 it 182 total=10.1958 mle=2.0472 pcon=8.1348 forget=0.0000 orth=0.0138 favg=0.0000 nr=116 nf=3 protos=None fproto_sim=NA
[loss] ep 48 it 232 total=10.4728 mle=2.3241 pcon=8.1349 forget=0.0000 orth=0.0138 favg=0.0000 nr=119 nf=5 protos=None fproto_sim=NA
[loss] ep 48 it 282 total=10.3739 mle=2.2264 pcon=8.1337 forget=0.0000 orth=0.0138 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 48 it 332 total=10.2064 mle=2.0590 pcon=8.1335 forget=0.0000 orth=0.0138 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 48 it 382 total=9.9478 mle=1.8016 pcon=8.1324 forget=0.0000 orth=0.0138 favg=0.0000 nr=117 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[loss] ep 49 it 41 total=10.2000 mle=2.0553 pcon=8.1309 forget=0.0000 orth=0.0138 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 49 it 91 total=10.2004 mle=2.0571 pcon=8.1296 forget=0.0000 orth=0.0138 favg=0.0000 nr=118 nf=6 protos=None fproto_sim=NA
[loss] ep 49 it 141 total=10.2953 mle=2.1523 pcon=8.1292 forget=0.0000 orth=0.0138 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 49 it 191 total=10.2276 mle=2.0857 pcon=8.1281 forget=0.0000 orth=0.0138 favg=0.0000 nr=120 nf=6 protos=None fproto_sim=NA
[loss] ep 49 it 241 total=10.3430 mle=2.2026 pcon=8.1265 forget=0.0000 orth=0.0138 favg=0.0000 nr=114 nf=10 protos=None fproto_sim=NA
[loss] ep 49 it 291 total=10.3508 mle=2.2104 pcon=8.1266 forget=0.0000 orth=0.0138 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 49 it 341 total=10.1776 mle=2.0379 pcon=8.1258 forget=0.0000 orth=0.0138 favg=0.0000 nr=121 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage2-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:34,  1.42it/s]  3%|▎         | 11/391 [00:00<00:21, 17.89it/s]  5%|▌         | 21/391 [00:00<00:11, 33.37it/s]  8%|▊         | 31/391 [00:01<00:07, 47.00it/s] 10%|█         | 41/391 [00:01<00:05, 58.45it/s] 13%|█▎        | 51/391 [00:01<00:05, 67.21it/s] 16%|█▌        | 61/391 [00:01<00:04, 74.66it/s] 18%|█▊        | 71/391 [00:01<00:04, 79.69it/s] 21%|██        | 81/391 [00:01<00:03, 83.77it/s] 23%|██▎       | 91/391 [00:01<00:03, 86.94it/s] 26%|██▌       | 101/391 [00:01<00:03, 89.22it/s] 28%|██▊       | 111/391 [00:01<00:03, 90.37it/s] 31%|███       | 121/391 [00:01<00:02, 91.79it/s] 34%|███▎      | 131/391 [00:02<00:02, 87.63it/s] 36%|███▌      | 141/391 [00:02<00:02, 89.72it/s] 39%|███▊      | 151/391 [00:02<00:02, 89.92it/s] 41%|████      | 161/391 [00:02<00:02, 90.59it/s] 44%|████▎     | 171/391 [00:02<00:02, 90.62it/s] 46%|████▋     | 181/391 [00:02<00:02, 91.54it/s] 49%|████▉     | 191/391 [00:02<00:02, 90.06it/s] 51%|█████▏    | 201/391 [00:02<00:02, 91.32it/s] 54%|█████▍    | 211/391 [00:02<00:01, 92.36it/s] 57%|█████▋    | 221/391 [00:03<00:01, 93.29it/s] 59%|█████▉    | 231/391 [00:03<00:01, 93.26it/s] 62%|██████▏   | 241/391 [00:03<00:01, 93.88it/s] 64%|██████▍   | 251/391 [00:03<00:01, 93.29it/s] 67%|██████▋   | 261/391 [00:03<00:01, 93.88it/s] 69%|██████▉   | 271/391 [00:03<00:01, 94.34it/s] 72%|███████▏  | 281/391 [00:03<00:01, 94.37it/s] 74%|███████▍  | 291/391 [00:03<00:01, 93.72it/s] 77%|███████▋  | 301/391 [00:03<00:00, 93.83it/s] 80%|███████▉  | 311/391 [00:04<00:00, 94.23it/s] 82%|████████▏ | 321/391 [00:04<00:00, 93.23it/s] 85%|████████▍ | 331/391 [00:04<00:00, 93.75it/s] 87%|████████▋ | 341/391 [00:04<00:00, 92.15it/s] 90%|████████▉ | 351/391 [00:04<00:00, 93.13it/s] 92%|█████████▏| 361/391 [00:04<00:00, 93.05it/s] 95%|█████████▍| 371/391 [00:04<00:00, 94.20it/s] 97%|█████████▋| 381/391 [00:04<00:00, 95.00it/s]100%|██████████| 391/391 [00:04<00:00, 92.11it/s]100%|██████████| 391/391 [00:04<00:00, 79.84it/s]
50000 images processed, 4.947292804718018 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:54,  1.43it/s] 10%|█         | 8/79 [00:00<00:05, 13.05it/s] 23%|██▎       | 18/79 [00:00<00:02, 29.70it/s] 35%|███▌      | 28/79 [00:01<00:01, 43.92it/s] 48%|████▊     | 38/79 [00:01<00:00, 55.83it/s] 61%|██████    | 48/79 [00:01<00:00, 65.41it/s] 73%|███████▎  | 58/79 [00:01<00:00, 73.41it/s] 86%|████████▌ | 68/79 [00:01<00:00, 79.64it/s] 99%|█████████▊| 78/79 [00:01<00:00, 84.27it/s]100%|██████████| 79/79 [00:02<00:00, 38.98it/s]
10000 images processed, 2.0451107025146484 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:48,  1.21it/s]  5%|▌         | 11/204 [00:00<00:12, 15.56it/s] 10%|▉         | 20/204 [00:01<00:06, 28.28it/s] 15%|█▍        | 30/204 [00:01<00:04, 41.80it/s] 20%|█▉        | 40/204 [00:01<00:03, 53.61it/s] 25%|██▍       | 50/204 [00:01<00:02, 63.54it/s] 29%|██▉       | 60/204 [00:01<00:02, 71.18it/s] 34%|███▍      | 70/204 [00:01<00:01, 76.84it/s] 39%|███▉      | 80/204 [00:01<00:01, 80.48it/s] 44%|████▎     | 89/204 [00:01<00:01, 82.93it/s] 49%|████▊     | 99/204 [00:01<00:01, 85.93it/s] 53%|█████▎    | 109/204 [00:02<00:01, 88.27it/s] 58%|█████▊    | 119/204 [00:02<00:00, 89.74it/s] 63%|██████▎   | 129/204 [00:02<00:00, 89.02it/s] 68%|██████▊   | 139/204 [00:02<00:00, 89.68it/s] 73%|███████▎  | 149/204 [00:02<00:00, 90.40it/s] 78%|███████▊  | 159/204 [00:02<00:00, 90.49it/s] 83%|████████▎ | 169/204 [00:02<00:00, 87.22it/s] 88%|████████▊ | 179/204 [00:02<00:00, 89.28it/s] 93%|█████████▎| 189/204 [00:02<00:00, 91.14it/s] 98%|█████████▊| 199/204 [00:02<00:00, 92.41it/s]100%|██████████| 204/204 [00:03<00:00, 66.87it/s]
26032 images processed, 3.1061811447143555 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:01<01:22,  1.05s/it] 14%|█▍        | 11/79 [00:01<00:05, 12.69it/s] 27%|██▋       | 21/79 [00:01<00:02, 25.12it/s] 39%|███▉      | 31/79 [00:01<00:01, 37.34it/s] 52%|█████▏    | 41/79 [00:01<00:00, 48.78it/s] 65%|██████▍   | 51/79 [00:01<00:00, 58.77it/s] 77%|███████▋  | 61/79 [00:01<00:00, 67.46it/s] 90%|████████▉ | 71/79 [00:01<00:00, 74.60it/s]100%|██████████| 79/79 [00:01<00:00, 42.12it/s]
10000 images processed, 1.8995885848999023 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:03,  1.23it/s] 14%|█▍        | 11/79 [00:00<00:04, 15.77it/s] 27%|██▋       | 21/79 [00:01<00:01, 30.03it/s] 39%|███▉      | 31/79 [00:01<00:01, 42.94it/s] 52%|█████▏    | 41/79 [00:01<00:00, 54.38it/s] 63%|██████▎   | 50/79 [00:01<00:00, 61.00it/s] 76%|███████▌  | 60/79 [00:01<00:00, 69.73it/s] 89%|████████▊ | 70/79 [00:01<00:00, 76.61it/s]100%|██████████| 79/79 [00:01<00:00, 47.71it/s]
10000 images processed, 1.6777663230895996 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:51,  1.34it/s] 16%|█▌        | 11/70 [00:00<00:03, 16.99it/s] 30%|███       | 21/70 [00:00<00:01, 31.97it/s] 44%|████▍     | 31/70 [00:01<00:00, 45.37it/s] 59%|█████▊    | 41/70 [00:01<00:00, 56.93it/s] 73%|███████▎  | 51/70 [00:01<00:00, 66.65it/s] 87%|████████▋ | 61/70 [00:01<00:00, 74.36it/s]100%|██████████| 70/70 [00:01<00:00, 47.09it/s]
8925 images processed, 1.529609203338623 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:59,  1.35s/it]  4%|▍         | 2/45 [00:01<00:30,  1.42it/s] 13%|█▎        | 6/45 [00:01<00:07,  5.40it/s] 33%|███▎      | 15/45 [00:01<00:01, 16.31it/s] 44%|████▍     | 20/45 [00:02<00:01, 14.04it/s] 67%|██████▋   | 30/45 [00:02<00:00, 24.79it/s] 80%|████████  | 36/45 [00:02<00:00, 17.72it/s] 93%|█████████▎| 42/45 [00:03<00:00, 22.28it/s]100%|██████████| 45/45 [00:03<00:00, 14.60it/s]
5640 images processed, 3.107537031173706 seconds used

20.363422870635986
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           9.76  98.24  79.99
places365     56.04  86.68  52.25
LSUN          27.73  94.12  71.88
iSUN          46.15  91.38  69.64
dtd           20.46  95.98  84.87
AVG           32.03  93.28  71.73
[incremental] Overall: 0.7760 New: 0.7500 Old: 0.8020
[incremental] Final(Top-1): 0.7760  Average: 0.8120
2.858466148376465
==== Stage 3: inc={59,58,44,93,10}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='59,58,44,93,10', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [00:17<14:30, 17.76s/it]  4%|▍         | 2/50 [00:29<11:21, 14.21s/it]  6%|▌         | 3/50 [00:40<09:54, 12.66s/it]  8%|▊         | 4/50 [00:51<09:20, 12.19s/it] 10%|█         | 5/50 [01:01<08:35, 11.46s/it] 12%|█▏        | 6/50 [01:13<08:27, 11.53s/it][loss] ep 0 it 0 total=15.2820 mle=2.6003 pcon=9.4392 forget=0.0000 orth=3.2425 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=15.2832 mle=2.6010 pcon=9.4412 forget=0.0000 orth=3.2409 favg=0.0000 nr=106 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=15.2792 mle=2.5986 pcon=9.4428 forget=0.0000 orth=3.2378 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=15.0932 mle=2.4179 pcon=9.4427 forget=0.0000 orth=3.2326 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=14.8373 mle=2.1699 pcon=9.4422 forget=0.0000 orth=3.2252 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=14.9219 mle=2.2657 pcon=9.4406 forget=0.0000 orth=3.2156 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=15.2674 mle=2.6247 pcon=9.4389 forget=0.0000 orth=3.2039 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=14.9626 mle=2.3367 pcon=9.4362 forget=0.0000 orth=3.1897 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 1 it 9 total=14.8854 mle=2.2788 pcon=9.4333 forget=0.0000 orth=3.1734 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=14.9133 mle=2.3291 pcon=9.4297 forget=0.0000 orth=3.1545 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=14.8759 mle=2.3167 pcon=9.4259 forget=0.0000 orth=3.1332 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=15.0038 mle=2.4738 pcon=9.4208 forget=0.0000 orth=3.1092 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=14.8922 mle=2.3945 pcon=9.4153 forget=0.0000 orth=3.0825 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=14.5399 mle=2.0774 pcon=9.4095 forget=0.0000 orth=3.0531 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=14.7675 mle=2.3431 pcon=9.4036 forget=0.0000 orth=3.0208 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=14.7006 mle=2.3174 pcon=9.3979 forget=0.0000 orth=2.9853 favg=0.0000 nr=111 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 2 it 18 total=14.4711 mle=2.1320 pcon=9.3922 forget=0.0000 orth=2.9469 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=14.5016 mle=2.2106 pcon=9.3860 forget=0.0000 orth=2.9051 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=14.2697 mle=2.0302 pcon=9.3796 forget=0.0000 orth=2.8599 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=14.3376 mle=2.1525 pcon=9.3739 forget=0.0000 orth=2.8113 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.9987 mle=1.8722 pcon=9.3677 forget=0.0000 orth=2.7589 favg=0.0000 nr=119 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=14.3403 mle=2.2765 pcon=9.3608 forget=0.0000 orth=2.7031 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=14.2205 mle=2.2224 pcon=9.3546 forget=0.0000 orth=2.6435 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.7371 mle=1.8081 pcon=9.3487 forget=0.0000 orth=2.5803 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 3 it 27 total=13.9713 mle=2.1153 pcon=9.3424 forget=0.0000 orth=2.5137 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=14.0149 mle=2.2350 pcon=9.3362 forget=0.0000 orth=2.4437 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.8496 mle=2.1494 pcon=9.3297 forget=0.0000 orth=2.3706 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.7087 mle=2.0907 pcon=9.3233 forget=0.0000 orth=2.2947 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.4951 mle=1.9627 pcon=9.3159 forget=0.0000 orth=2.2165 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.4776 mle=2.0314 pcon=9.3095 forget=0.0000 orth=2.1367 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.4150 mle=2.0569 pcon=9.3023 forget=0.0000 orth=2.0557 favg=0.0000 nr=108 nf=10 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.3284 mle=2.0584 pcon=9.2966 forget=0.0000 orth=1.9734 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 4 it 36 total=13.2782 mle=2.0968 pcon=9.2903 forget=0.0000 orth=1.8911 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.1962 mle=2.1037 pcon=9.2834 forget=0.0000 orth=1.8091 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.0944 mle=2.0895 pcon=9.2770 forget=0.0000 orth=1.7280 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.8678 mle=1.9484 pcon=9.2706 forget=0.0000 orth=1.6488 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.7588 mle=1.9229 pcon=9.2646 forget=0.0000 orth=1.5713 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.7037 mle=1.9479 pcon=9.2592 forget=0.0000 orth=1.4966 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=12.9471 mle=2.2693 pcon=9.2533 forget=0.0000 orth=1.4245 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.5404 mle=1.9366 pcon=9.2477 forget=0.0000 orth=1.3561 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 5 it 45 total=12.5910 mle=2.0591 pcon=9.2418 forget=0.0000 orth=1.2902 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.4613 mle=1.9971 pcon=9.2367 forget=0.0000 orth=1.2276 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.4092 mle=2.0102 pcon=9.2303 forget=0.0000 orth=1.1687 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.3790 mle=2.0403 pcon=9.2254 forget=0.0000 orth=1.1133 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.3608 mle=2.0792 pcon=9.2206 forget=0.0000 orth=1.0610 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.1022 mle=1.8751 pcon=9.2153 forget=0.0000 orth=1.0118 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.3396 mle=2.1634 pcon=9.2106 forget=0.0000 orth=0.9656 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 6 it 4 total=12.1807 mle=2.0523 pcon=9.2059 forget=0.0000 orth=0.9225 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.2005 mle=2.1170 pcon=9.2010 forget=0.0000 orth=0.8825 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=11.9380 mle=1.8965 pcon=9.1964 forget=0.0000 orth=0.8451 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=11.7900 mle=1.7890 pcon=9.1911 forget=0.0000 orth=0.8099 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
 14%|█▍        | 7/50 [01:24<08:04, 11.26s/it] 16%|█▌        | 8/50 [01:34<07:44, 11.05s/it] 18%|█▊        | 9/50 [01:45<07:25, 10.87s/it] 20%|██        | 10/50 [01:55<07:07, 10.69s/it] 22%|██▏       | 11/50 [02:06<07:01, 10.80s/it] 24%|██▍       | 12/50 [02:17<06:45, 10.66s/it][loss] ep 6 it 204 total=11.9658 mle=2.0025 pcon=9.1862 forget=0.0000 orth=0.7772 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 254 total=11.9698 mle=2.0418 pcon=9.1812 forget=0.0000 orth=0.7468 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.1832 mle=2.2884 pcon=9.1764 forget=0.0000 orth=0.7184 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=11.8204 mle=1.9559 pcon=9.1724 forget=0.0000 orth=0.6921 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 7 it 13 total=12.0293 mle=2.1936 pcon=9.1683 forget=0.0000 orth=0.6674 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.1308 mle=2.3227 pcon=9.1636 forget=0.0000 orth=0.6446 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=11.9429 mle=2.1610 pcon=9.1591 forget=0.0000 orth=0.6228 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=11.9897 mle=2.2317 pcon=9.1553 forget=0.0000 orth=0.6027 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=11.7131 mle=1.9775 pcon=9.1514 forget=0.0000 orth=0.5841 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=11.8945 mle=2.1810 pcon=9.1470 forget=0.0000 orth=0.5666 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=11.6732 mle=1.9790 pcon=9.1439 forget=0.0000 orth=0.5503 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=11.8092 mle=2.1337 pcon=9.1403 forget=0.0000 orth=0.5353 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 8 it 22 total=11.7119 mle=2.0550 pcon=9.1361 forget=0.0000 orth=0.5208 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.5682 mle=1.9283 pcon=9.1327 forget=0.0000 orth=0.5072 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.5060 mle=1.8824 pcon=9.1289 forget=0.0000 orth=0.4946 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.3611 mle=1.7536 pcon=9.1248 forget=0.0000 orth=0.4826 favg=0.0000 nr=117 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.3263 mle=1.7333 pcon=9.1218 forget=0.0000 orth=0.4713 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.5285 mle=1.9502 pcon=9.1179 forget=0.0000 orth=0.4604 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.5915 mle=2.0274 pcon=9.1139 forget=0.0000 orth=0.4502 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=11.6761 mle=2.1253 pcon=9.1100 forget=0.0000 orth=0.4408 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 9 it 31 total=11.7884 mle=2.2505 pcon=9.1061 forget=0.0000 orth=0.4317 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.5483 mle=2.0223 pcon=9.1029 forget=0.0000 orth=0.4232 favg=0.0000 nr=110 nf=10 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.4117 mle=1.8972 pcon=9.0997 forget=0.0000 orth=0.4149 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.5528 mle=2.0501 pcon=9.0958 forget=0.0000 orth=0.4069 favg=0.0000 nr=115 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.3875 mle=1.8942 pcon=9.0934 forget=0.0000 orth=0.3999 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.5174 mle=2.0354 pcon=9.0891 forget=0.0000 orth=0.3928 favg=0.0000 nr=113 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.6170 mle=2.1461 pcon=9.0851 forget=0.0000 orth=0.3858 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.4012 mle=1.9404 pcon=9.0818 forget=0.0000 orth=0.3790 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 10 it 40 total=11.3371 mle=1.8857 pcon=9.0785 forget=0.0000 orth=0.3729 favg=0.0000 nr=111 nf=12 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=11.6757 mle=2.2345 pcon=9.0743 forget=0.0000 orth=0.3670 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.3696 mle=1.9372 pcon=9.0713 forget=0.0000 orth=0.3612 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.3896 mle=1.9660 pcon=9.0677 forget=0.0000 orth=0.3558 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.2547 mle=1.8406 pcon=9.0636 forget=0.0000 orth=0.3504 favg=0.0000 nr=115 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=11.6773 mle=2.2709 pcon=9.0607 forget=0.0000 orth=0.3457 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.2880 mle=1.8898 pcon=9.0574 forget=0.0000 orth=0.3408 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=11.5940 mle=2.2045 pcon=9.0533 forget=0.0000 orth=0.3362 favg=0.0000 nr=68 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 11 it 49 total=11.3157 mle=1.9340 pcon=9.0500 forget=0.0000 orth=0.3317 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.5517 mle=2.1784 pcon=9.0457 forget=0.0000 orth=0.3276 favg=0.0000 nr=102 nf=11 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.4636 mle=2.0979 pcon=9.0422 forget=0.0000 orth=0.3235 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.3524 mle=1.9948 pcon=9.0380 forget=0.0000 orth=0.3196 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.1242 mle=1.7743 pcon=9.0340 forget=0.0000 orth=0.3158 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.4485 mle=2.1069 pcon=9.0295 forget=0.0000 orth=0.3121 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.2225 mle=1.8877 pcon=9.0261 forget=0.0000 orth=0.3087 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 12 it 8 total=11.4628 mle=2.1351 pcon=9.0223 forget=0.0000 orth=0.3053 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.2866 mle=1.9670 pcon=9.0174 forget=0.0000 orth=0.3021 favg=0.0000 nr=115 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.3783 mle=2.0660 pcon=9.0137 forget=0.0000 orth=0.2986 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.2833 mle=1.9781 pcon=9.0097 forget=0.0000 orth=0.2955 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.2292 mle=1.9309 pcon=9.0058 forget=0.0000 orth=0.2924 favg=0.0000 nr=114 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.5433 mle=2.2508 pcon=9.0031 forget=0.0000 orth=0.2894 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.4547 mle=2.1695 pcon=8.9989 forget=0.0000 orth=0.2863 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.3497 mle=2.0711 pcon=8.9952 forget=0.0000 orth=0.2834 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
 26%|██▌       | 13/50 [02:27<06:35, 10.68s/it] 28%|██▊       | 14/50 [02:37<06:16, 10.46s/it] 30%|███       | 15/50 [02:48<06:10, 10.58s/it] 32%|███▏      | 16/50 [02:58<05:52, 10.38s/it] 34%|███▍      | 17/50 [03:08<05:41, 10.36s/it] 36%|███▌      | 18/50 [03:19<05:31, 10.35s/it] 38%|███▊      | 19/50 [03:29<05:21, 10.36s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 13 it 17 total=11.4278 mle=2.1549 pcon=8.9920 forget=0.0000 orth=0.2809 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.1871 mle=1.9210 pcon=8.9878 forget=0.0000 orth=0.2783 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.4771 mle=2.2169 pcon=8.9845 forget=0.0000 orth=0.2757 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.3932 mle=2.1392 pcon=8.9807 forget=0.0000 orth=0.2733 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.4499 mle=2.2017 pcon=8.9773 forget=0.0000 orth=0.2709 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.3657 mle=2.1239 pcon=8.9733 forget=0.0000 orth=0.2685 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.2611 mle=2.0261 pcon=8.9689 forget=0.0000 orth=0.2662 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.3546 mle=2.1260 pcon=8.9647 forget=0.0000 orth=0.2639 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 14 it 26 total=11.4504 mle=2.2274 pcon=8.9613 forget=0.0000 orth=0.2617 favg=0.0000 nr=101 nf=13 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.1589 mle=1.9421 pcon=8.9574 forget=0.0000 orth=0.2594 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.2304 mle=2.0197 pcon=8.9534 forget=0.0000 orth=0.2573 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.3584 mle=2.1545 pcon=8.9486 forget=0.0000 orth=0.2553 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.1314 mle=1.9344 pcon=8.9438 forget=0.0000 orth=0.2532 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.3770 mle=2.1863 pcon=8.9395 forget=0.0000 orth=0.2512 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.2683 mle=2.0835 pcon=8.9354 forget=0.0000 orth=0.2494 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.0294 mle=1.8500 pcon=8.9318 forget=0.0000 orth=0.2476 favg=0.0000 nr=113 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 15 it 35 total=11.2066 mle=2.0329 pcon=8.9279 forget=0.0000 orth=0.2458 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.2489 mle=2.0802 pcon=8.9246 forget=0.0000 orth=0.2441 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.1121 mle=1.9499 pcon=8.9200 forget=0.0000 orth=0.2423 favg=0.0000 nr=118 nf=1 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.1500 mle=1.9934 pcon=8.9162 forget=0.0000 orth=0.2404 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.2829 mle=2.1319 pcon=8.9122 forget=0.0000 orth=0.2388 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.1343 mle=1.9887 pcon=8.9084 forget=0.0000 orth=0.2371 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.3018 mle=2.1620 pcon=8.9043 forget=0.0000 orth=0.2354 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.1150 mle=1.9806 pcon=8.9005 forget=0.0000 orth=0.2339 favg=0.0000 nr=111 nf=1 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 16 it 44 total=11.3324 mle=2.2018 pcon=8.8979 forget=0.0000 orth=0.2327 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.2882 mle=2.1625 pcon=8.8944 forget=0.0000 orth=0.2313 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.1706 mle=2.0501 pcon=8.8908 forget=0.0000 orth=0.2297 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.1265 mle=2.0119 pcon=8.8862 forget=0.0000 orth=0.2284 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.0589 mle=1.9493 pcon=8.8826 forget=0.0000 orth=0.2269 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.0101 mle=1.9058 pcon=8.8790 forget=0.0000 orth=0.2254 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.1561 mle=2.0567 pcon=8.8753 forget=0.0000 orth=0.2241 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 17 it 3 total=10.9067 mle=1.8120 pcon=8.8720 forget=0.0000 orth=0.2228 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=10.9003 mle=1.8109 pcon=8.8678 forget=0.0000 orth=0.2216 favg=0.0000 nr=113 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.1533 mle=2.0687 pcon=8.8644 forget=0.0000 orth=0.2202 favg=0.0000 nr=113 nf=3 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=10.9567 mle=1.8767 pcon=8.8611 forget=0.0000 orth=0.2189 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.0210 mle=1.9465 pcon=8.8568 forget=0.0000 orth=0.2177 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.0784 mle=2.0077 pcon=8.8543 forget=0.0000 orth=0.2164 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=10.9714 mle=1.9052 pcon=8.8511 forget=0.0000 orth=0.2152 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.0450 mle=1.9842 pcon=8.8469 forget=0.0000 orth=0.2140 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 18 it 12 total=11.0628 mle=2.0072 pcon=8.8428 forget=0.0000 orth=0.2128 favg=0.0000 nr=117 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.2558 mle=2.2047 pcon=8.8393 forget=0.0000 orth=0.2118 favg=0.0000 nr=110 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=10.9305 mle=1.8832 pcon=8.8366 forget=0.0000 orth=0.2107 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.1095 mle=2.0675 pcon=8.8324 forget=0.0000 orth=0.2096 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.1164 mle=2.0798 pcon=8.8282 forget=0.0000 orth=0.2084 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.0184 mle=1.9869 pcon=8.8242 forget=0.0000 orth=0.2073 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.0104 mle=1.9831 pcon=8.8209 forget=0.0000 orth=0.2063 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=10.8723 mle=1.8500 pcon=8.8169 forget=0.0000 orth=0.2053 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 19 it 21 total=10.9530 mle=1.9346 pcon=8.8141 forget=0.0000 orth=0.2043 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.1278 mle=2.1147 pcon=8.8099 forget=0.0000 orth=0.2032 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
 40%|████      | 20/50 [03:39<05:09, 10.31s/it] 42%|████▏     | 21/50 [03:49<04:56, 10.21s/it] 44%|████▍     | 22/50 [04:00<04:49, 10.34s/it] 46%|████▌     | 23/50 [04:10<04:40, 10.40s/it] 48%|████▊     | 24/50 [04:21<04:29, 10.38s/it] 50%|█████     | 25/50 [04:31<04:19, 10.37s/it][loss] ep 19 it 121 total=10.8989 mle=1.8900 pcon=8.8066 forget=0.0000 orth=0.2023 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.0243 mle=2.0200 pcon=8.8029 forget=0.0000 orth=0.2014 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 221 total=11.0473 mle=2.0473 pcon=8.7997 forget=0.0000 orth=0.2003 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.0805 mle=2.0849 pcon=8.7962 forget=0.0000 orth=0.1994 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.0360 mle=2.0440 pcon=8.7935 forget=0.0000 orth=0.1985 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.0226 mle=2.0342 pcon=8.7907 forget=0.0000 orth=0.1976 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 20 it 30 total=11.1639 mle=2.1790 pcon=8.7881 forget=0.0000 orth=0.1968 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=10.8869 mle=1.9064 pcon=8.7845 forget=0.0000 orth=0.1960 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.0253 mle=2.0486 pcon=8.7815 forget=0.0000 orth=0.1952 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.0310 mle=2.0585 pcon=8.7782 forget=0.0000 orth=0.1943 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=10.8301 mle=1.8616 pcon=8.7750 forget=0.0000 orth=0.1935 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=10.9839 mle=2.0198 pcon=8.7714 forget=0.0000 orth=0.1926 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.2248 mle=2.2645 pcon=8.7684 forget=0.0000 orth=0.1918 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.0778 mle=2.1209 pcon=8.7660 forget=0.0000 orth=0.1909 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 21 it 39 total=10.9324 mle=1.9806 pcon=8.7618 forget=0.0000 orth=0.1900 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=10.8571 mle=1.9097 pcon=8.7582 forget=0.0000 orth=0.1892 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.0414 mle=2.0975 pcon=8.7553 forget=0.0000 orth=0.1885 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=10.8933 mle=1.9536 pcon=8.7521 forget=0.0000 orth=0.1876 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.0441 mle=2.1081 pcon=8.7490 forget=0.0000 orth=0.1871 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=10.8099 mle=1.8774 pcon=8.7462 forget=0.0000 orth=0.1863 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=10.8856 mle=1.9561 pcon=8.7438 forget=0.0000 orth=0.1857 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.0687 mle=2.1442 pcon=8.7397 forget=0.0000 orth=0.1848 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 22 it 48 total=11.0518 mle=2.1308 pcon=8.7369 forget=0.0000 orth=0.1841 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=10.8877 mle=1.9703 pcon=8.7340 forget=0.0000 orth=0.1834 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=10.9568 mle=2.0429 pcon=8.7313 forget=0.0000 orth=0.1827 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=10.8500 mle=1.9386 pcon=8.7294 forget=0.0000 orth=0.1820 favg=0.0000 nr=104 nf=11 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=10.9442 mle=2.0364 pcon=8.7265 forget=0.0000 orth=0.1813 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=10.9111 mle=2.0068 pcon=8.7236 forget=0.0000 orth=0.1808 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.0449 mle=2.1450 pcon=8.7199 forget=0.0000 orth=0.1800 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 23 it 7 total=10.8446 mle=1.9483 pcon=8.7170 forget=0.0000 orth=0.1794 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.0628 mle=2.1701 pcon=8.7141 forget=0.0000 orth=0.1787 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.6756 mle=1.7867 pcon=8.7108 forget=0.0000 orth=0.1781 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.1635 mle=2.2773 pcon=8.7086 forget=0.0000 orth=0.1776 favg=0.0000 nr=107 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=10.9926 mle=2.1101 pcon=8.7056 forget=0.0000 orth=0.1769 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=10.8987 mle=2.0197 pcon=8.7027 forget=0.0000 orth=0.1763 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=10.9757 mle=2.1009 pcon=8.6990 forget=0.0000 orth=0.1758 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=10.7950 mle=1.9239 pcon=8.6959 forget=0.0000 orth=0.1752 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 24 it 16 total=10.9677 mle=2.0993 pcon=8.6937 forget=0.0000 orth=0.1747 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=10.7882 mle=1.9219 pcon=8.6923 forget=0.0000 orth=0.1741 favg=0.0000 nr=107 nf=11 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.0179 mle=2.1549 pcon=8.6898 forget=0.0000 orth=0.1733 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.0290 mle=2.1696 pcon=8.6868 forget=0.0000 orth=0.1727 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=10.7898 mle=1.9346 pcon=8.6832 forget=0.0000 orth=0.1721 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=10.8498 mle=1.9980 pcon=8.6801 forget=0.0000 orth=0.1716 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=10.7795 mle=1.9306 pcon=8.6778 forget=0.0000 orth=0.1711 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.1161 mle=2.2703 pcon=8.6752 forget=0.0000 orth=0.1705 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 25 it 25 total=10.8183 mle=1.9759 pcon=8.6724 forget=0.0000 orth=0.1700 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=10.9017 mle=2.0622 pcon=8.6701 forget=0.0000 orth=0.1693 favg=0.0000 nr=115 nf=2 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.1543 mle=2.3190 pcon=8.6665 forget=0.0000 orth=0.1688 favg=0.0000 nr=104 nf=12 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=10.8481 mle=2.0158 pcon=8.6640 forget=0.0000 orth=0.1684 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=10.7115 mle=1.8817 pcon=8.6619 forget=0.0000 orth=0.1679 favg=0.0000 nr=116 nf=5 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=10.9861 mle=2.1592 pcon=8.6596 forget=0.0000 orth=0.1673 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
 52%|█████▏    | 26/50 [04:41<04:08, 10.35s/it] 54%|█████▍    | 27/50 [04:52<04:02, 10.56s/it] 56%|█████▌    | 28/50 [05:03<03:51, 10.54s/it] 58%|█████▊    | 29/50 [05:14<03:41, 10.56s/it] 60%|██████    | 30/50 [05:25<03:36, 10.83s/it] 62%|██████▏   | 31/50 [05:36<03:29, 11.01s/it] 64%|██████▍   | 32/50 [05:47<03:18, 11.01s/it][loss] ep 25 it 325 total=10.7597 mle=1.9356 pcon=8.6571 forget=0.0000 orth=0.1669 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=10.9017 mle=2.0801 pcon=8.6552 forget=0.0000 orth=0.1664 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 26 it 34 total=10.7145 mle=1.8959 pcon=8.6527 forget=0.0000 orth=0.1659 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=10.9824 mle=2.1680 pcon=8.6489 forget=0.0000 orth=0.1655 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=10.9147 mle=2.1026 pcon=8.6471 forget=0.0000 orth=0.1650 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=10.8500 mle=2.0401 pcon=8.6453 forget=0.0000 orth=0.1646 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=10.7658 mle=1.9590 pcon=8.6428 forget=0.0000 orth=0.1640 favg=0.0000 nr=113 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=10.9045 mle=2.1011 pcon=8.6398 forget=0.0000 orth=0.1636 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=10.8239 mle=2.0239 pcon=8.6369 forget=0.0000 orth=0.1631 favg=0.0000 nr=106 nf=11 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=10.7363 mle=1.9387 pcon=8.6349 forget=0.0000 orth=0.1628 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 27 it 43 total=10.9761 mle=2.1809 pcon=8.6329 forget=0.0000 orth=0.1623 favg=0.0000 nr=100 nf=11 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=10.8525 mle=2.0595 pcon=8.6312 forget=0.0000 orth=0.1618 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=10.9411 mle=2.1505 pcon=8.6292 forget=0.0000 orth=0.1614 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=10.7953 mle=2.0076 pcon=8.6268 forget=0.0000 orth=0.1610 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=10.7701 mle=1.9846 pcon=8.6248 forget=0.0000 orth=0.1607 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=10.8365 mle=2.0532 pcon=8.6231 forget=0.0000 orth=0.1603 favg=0.0000 nr=114 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.6132 mle=1.8329 pcon=8.6205 forget=0.0000 orth=0.1599 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 28 it 2 total=10.6312 mle=1.8531 pcon=8.6186 forget=0.0000 orth=0.1595 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=10.9006 mle=2.1253 pcon=8.6162 forget=0.0000 orth=0.1591 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=10.8303 mle=2.0568 pcon=8.6147 forget=0.0000 orth=0.1587 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=10.9554 mle=2.1842 pcon=8.6128 forget=0.0000 orth=0.1584 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=10.9187 mle=2.1505 pcon=8.6103 forget=0.0000 orth=0.1580 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=10.8315 mle=2.0657 pcon=8.6082 forget=0.0000 orth=0.1576 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.5454 mle=1.7808 pcon=8.6073 forget=0.0000 orth=0.1573 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=10.8109 mle=2.0490 pcon=8.6051 forget=0.0000 orth=0.1569 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 29 it 11 total=10.5973 mle=1.8387 pcon=8.6021 forget=0.0000 orth=0.1565 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=10.8235 mle=2.0662 pcon=8.6012 forget=0.0000 orth=0.1561 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=10.9243 mle=2.1689 pcon=8.5996 forget=0.0000 orth=0.1558 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.6621 mle=1.9091 pcon=8.5975 forget=0.0000 orth=0.1555 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=10.9443 mle=2.1942 pcon=8.5950 forget=0.0000 orth=0.1551 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=10.8092 mle=2.0609 pcon=8.5935 forget=0.0000 orth=0.1548 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=10.7063 mle=1.9598 pcon=8.5920 forget=0.0000 orth=0.1544 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.0463 mle=2.3014 pcon=8.5907 forget=0.0000 orth=0.1541 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 30 it 20 total=10.6210 mle=1.8785 pcon=8.5887 forget=0.0000 orth=0.1538 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=10.9102 mle=2.1693 pcon=8.5875 forget=0.0000 orth=0.1534 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.7010 mle=1.9624 pcon=8.5855 forget=0.0000 orth=0.1532 favg=0.0000 nr=116 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=11.0929 mle=2.3565 pcon=8.5835 forget=0.0000 orth=0.1529 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=10.8081 mle=2.0733 pcon=8.5822 forget=0.0000 orth=0.1525 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.6099 mle=1.8768 pcon=8.5809 forget=0.0000 orth=0.1522 favg=0.0000 nr=117 nf=2 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=10.7808 mle=2.0499 pcon=8.5790 forget=0.0000 orth=0.1519 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=10.8598 mle=2.1307 pcon=8.5775 forget=0.0000 orth=0.1516 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 31 it 29 total=10.6466 mle=1.9197 pcon=8.5754 forget=0.0000 orth=0.1514 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=10.8925 mle=2.1682 pcon=8.5731 forget=0.0000 orth=0.1511 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=10.7380 mle=2.0155 pcon=8.5717 forget=0.0000 orth=0.1508 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=10.9090 mle=2.1883 pcon=8.5702 forget=0.0000 orth=0.1505 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=10.8622 mle=2.1445 pcon=8.5674 forget=0.0000 orth=0.1502 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.5878 mle=1.8720 pcon=8.5658 forget=0.0000 orth=0.1499 favg=0.0000 nr=114 nf=4 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=10.8539 mle=2.1397 pcon=8.5646 forget=0.0000 orth=0.1496 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=10.8034 mle=2.0920 pcon=8.5621 forget=0.0000 orth=0.1493 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
 66%|██████▌   | 33/50 [05:58<03:07, 11.00s/it] 68%|██████▊   | 34/50 [06:10<02:58, 11.16s/it] 70%|███████   | 35/50 [06:20<02:43, 10.89s/it] 72%|███████▏  | 36/50 [06:31<02:32, 10.89s/it] 74%|███████▍  | 37/50 [06:42<02:21, 10.92s/it] 76%|███████▌  | 38/50 [06:55<02:16, 11.38s/it][loss] ep 32 it 38 total=10.7189 mle=2.0097 pcon=8.5601 forget=0.0000 orth=0.1491 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.6795 mle=1.9729 pcon=8.5578 forget=0.0000 orth=0.1488 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=10.7106 mle=2.0055 pcon=8.5567 forget=0.0000 orth=0.1485 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=10.8793 mle=2.1765 pcon=8.5546 forget=0.0000 orth=0.1483 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.5693 mle=1.8683 pcon=8.5529 forget=0.0000 orth=0.1480 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=10.6998 mle=2.0002 pcon=8.5518 forget=0.0000 orth=0.1478 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=10.8906 mle=2.1921 pcon=8.5509 forget=0.0000 orth=0.1476 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.5836 mle=1.8868 pcon=8.5494 forget=0.0000 orth=0.1474 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 33 it 47 total=10.8860 mle=2.1910 pcon=8.5477 forget=0.0000 orth=0.1472 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=10.8837 mle=2.1900 pcon=8.5467 forget=0.0000 orth=0.1470 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=10.7754 mle=2.0835 pcon=8.5452 forget=0.0000 orth=0.1467 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.5164 mle=1.8262 pcon=8.5436 forget=0.0000 orth=0.1465 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.6228 mle=1.9342 pcon=8.5423 forget=0.0000 orth=0.1463 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=10.8109 mle=2.1246 pcon=8.5402 forget=0.0000 orth=0.1461 favg=0.0000 nr=112 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=10.9457 mle=2.2602 pcon=8.5396 forget=0.0000 orth=0.1459 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 34 it 6 total=10.9622 mle=2.2783 pcon=8.5383 forget=0.0000 orth=0.1457 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.6055 mle=1.9237 pcon=8.5363 forget=0.0000 orth=0.1455 favg=0.0000 nr=110 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.6176 mle=1.9373 pcon=8.5349 forget=0.0000 orth=0.1453 favg=0.0000 nr=112 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=10.6769 mle=1.9993 pcon=8.5325 forget=0.0000 orth=0.1451 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.5495 mle=1.8731 pcon=8.5314 forget=0.0000 orth=0.1450 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=10.7149 mle=2.0406 pcon=8.5295 forget=0.0000 orth=0.1447 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.7022 mle=2.0291 pcon=8.5285 forget=0.0000 orth=0.1445 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=10.8338 mle=2.1625 pcon=8.5270 forget=0.0000 orth=0.1443 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 35 it 15 total=10.7263 mle=2.0568 pcon=8.5254 forget=0.0000 orth=0.1441 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=10.7645 mle=2.0970 pcon=8.5235 forget=0.0000 orth=0.1440 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=10.7913 mle=2.1252 pcon=8.5223 forget=0.0000 orth=0.1438 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=10.8210 mle=2.1562 pcon=8.5212 forget=0.0000 orth=0.1436 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=10.8199 mle=2.1562 pcon=8.5203 forget=0.0000 orth=0.1434 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=10.7543 mle=2.0927 pcon=8.5184 forget=0.0000 orth=0.1433 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=10.7581 mle=2.0981 pcon=8.5168 forget=0.0000 orth=0.1431 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=10.7115 mle=2.0523 pcon=8.5163 forget=0.0000 orth=0.1429 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 36 it 24 total=10.7605 mle=2.1019 pcon=8.5159 forget=0.0000 orth=0.1427 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=10.6735 mle=2.0168 pcon=8.5142 forget=0.0000 orth=0.1426 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=10.4524 mle=1.7971 pcon=8.5129 forget=0.0000 orth=0.1424 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=10.7300 mle=2.0761 pcon=8.5116 forget=0.0000 orth=0.1423 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=10.6498 mle=1.9975 pcon=8.5101 forget=0.0000 orth=0.1421 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=10.8416 mle=2.1902 pcon=8.5093 forget=0.0000 orth=0.1420 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=10.7328 mle=2.0822 pcon=8.5087 forget=0.0000 orth=0.1418 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=10.6599 mle=2.0103 pcon=8.5079 forget=0.0000 orth=0.1417 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=10.6511 mle=2.0030 pcon=8.5065 forget=0.0000 orth=0.1416 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=10.7969 mle=2.1499 pcon=8.5055 forget=0.0000 orth=0.1415 favg=0.0000 nr=103 nf=12 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=10.6371 mle=1.9914 pcon=8.5044 forget=0.0000 orth=0.1413 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=10.7237 mle=2.0790 pcon=8.5035 forget=0.0000 orth=0.1412 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=10.4373 mle=1.7925 pcon=8.5037 forget=0.0000 orth=0.1411 favg=0.0000 nr=116 nf=4 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=10.9066 mle=2.2637 pcon=8.5020 forget=0.0000 orth=0.1409 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=10.9886 mle=2.3463 pcon=8.5014 forget=0.0000 orth=0.1408 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=10.6296 mle=1.9891 pcon=8.4998 forget=0.0000 orth=0.1407 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 38 it 42 total=10.6605 mle=2.0211 pcon=8.4988 forget=0.0000 orth=0.1406 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=10.8863 mle=2.2479 pcon=8.4979 forget=0.0000 orth=0.1405 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=10.6090 mle=1.9714 pcon=8.4971 forget=0.0000 orth=0.1404 favg=0.0000 nr=115 nf=2 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=10.5250 mle=1.8886 pcon=8.4961 forget=0.0000 orth=0.1403 favg=0.0000 nr=116 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=10.6903 mle=2.0557 pcon=8.4945 forget=0.0000 orth=0.1402 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=10.7699 mle=2.1364 pcon=8.4934 forget=0.0000 orth=0.1401 favg=0.0000 nr=107 nf=3 protos=None fproto_sim=NA
 78%|███████▊  | 39/50 [07:06<02:04, 11.29s/it] 80%|████████  | 40/50 [07:17<01:53, 11.30s/it] 82%|████████▏ | 41/50 [07:28<01:42, 11.34s/it] 84%|████████▍ | 42/50 [07:39<01:29, 11.23s/it] 86%|████████▌ | 43/50 [07:51<01:19, 11.35s/it] 88%|████████▊ | 44/50 [08:02<01:08, 11.36s/it] 90%|█████████ | 45/50 [08:16<00:59, 11.92s/it][loss] ep 38 it 342 total=10.4923 mle=1.8612 pcon=8.4911 forget=0.0000 orth=0.1400 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 39 it 1 total=10.8806 mle=2.2502 pcon=8.4906 forget=0.0000 orth=0.1399 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=10.5741 mle=1.9455 pcon=8.4888 forget=0.0000 orth=0.1398 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=10.7632 mle=2.1347 pcon=8.4888 forget=0.0000 orth=0.1397 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=10.6531 mle=2.0258 pcon=8.4877 forget=0.0000 orth=0.1396 favg=0.0000 nr=110 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=10.7188 mle=2.0934 pcon=8.4859 forget=0.0000 orth=0.1395 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=10.7065 mle=2.0813 pcon=8.4858 forget=0.0000 orth=0.1394 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=10.6529 mle=2.0290 pcon=8.4846 forget=0.0000 orth=0.1394 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=10.8025 mle=2.1797 pcon=8.4835 forget=0.0000 orth=0.1393 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 40 it 10 total=10.5696 mle=1.9480 pcon=8.4824 forget=0.0000 orth=0.1392 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=10.5767 mle=1.9562 pcon=8.4813 forget=0.0000 orth=0.1392 favg=0.0000 nr=115 nf=4 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=10.6157 mle=1.9959 pcon=8.4807 forget=0.0000 orth=0.1391 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=10.6017 mle=1.9829 pcon=8.4797 forget=0.0000 orth=0.1391 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=10.6341 mle=2.0163 pcon=8.4789 forget=0.0000 orth=0.1390 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=10.6475 mle=2.0303 pcon=8.4783 forget=0.0000 orth=0.1389 favg=0.0000 nr=107 nf=9 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=10.8691 mle=2.2526 pcon=8.4777 forget=0.0000 orth=0.1388 favg=0.0000 nr=106 nf=2 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=10.6172 mle=2.0011 pcon=8.4773 forget=0.0000 orth=0.1388 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 41 it 19 total=10.7130 mle=2.0981 pcon=8.4762 forget=0.0000 orth=0.1387 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=10.7923 mle=2.1776 pcon=8.4761 forget=0.0000 orth=0.1386 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=10.8933 mle=2.2791 pcon=8.4757 forget=0.0000 orth=0.1386 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=10.7479 mle=2.1347 pcon=8.4747 forget=0.0000 orth=0.1385 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=10.5637 mle=1.9511 pcon=8.4742 forget=0.0000 orth=0.1385 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=10.4943 mle=1.8825 pcon=8.4734 forget=0.0000 orth=0.1384 favg=0.0000 nr=114 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=10.8378 mle=2.2267 pcon=8.4728 forget=0.0000 orth=0.1383 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=10.7501 mle=2.1394 pcon=8.4724 forget=0.0000 orth=0.1383 favg=0.0000 nr=113 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 42 it 28 total=10.7145 mle=2.1048 pcon=8.4715 forget=0.0000 orth=0.1382 favg=0.0000 nr=110 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=10.6310 mle=2.0212 pcon=8.4716 forget=0.0000 orth=0.1382 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=10.6509 mle=2.0415 pcon=8.4713 forget=0.0000 orth=0.1381 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=10.5921 mle=1.9834 pcon=8.4707 forget=0.0000 orth=0.1381 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=10.4872 mle=1.8799 pcon=8.4692 forget=0.0000 orth=0.1380 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=10.7526 mle=2.1462 pcon=8.4684 forget=0.0000 orth=0.1380 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=10.6270 mle=2.0216 pcon=8.4675 forget=0.0000 orth=0.1379 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=10.6272 mle=2.0227 pcon=8.4666 forget=0.0000 orth=0.1379 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 43 it 37 total=10.6825 mle=2.0784 pcon=8.4662 forget=0.0000 orth=0.1379 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=10.5601 mle=1.9569 pcon=8.4655 forget=0.0000 orth=0.1378 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=10.9267 mle=2.3247 pcon=8.4641 forget=0.0000 orth=0.1378 favg=0.0000 nr=104 nf=13 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=10.6439 mle=2.0431 pcon=8.4630 forget=0.0000 orth=0.1378 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=10.7162 mle=2.1154 pcon=8.4631 forget=0.0000 orth=0.1377 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=10.6967 mle=2.0968 pcon=8.4622 forget=0.0000 orth=0.1377 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=10.6829 mle=2.0836 pcon=8.4617 forget=0.0000 orth=0.1376 favg=0.0000 nr=112 nf=6 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=10.5335 mle=1.9348 pcon=8.4611 forget=0.0000 orth=0.1376 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 44 it 46 total=10.7004 mle=2.1019 pcon=8.4610 forget=0.0000 orth=0.1376 favg=0.0000 nr=109 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=10.6085 mle=2.0109 pcon=8.4600 forget=0.0000 orth=0.1376 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=10.8374 mle=2.2406 pcon=8.4593 forget=0.0000 orth=0.1375 favg=0.0000 nr=107 nf=3 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=10.9285 mle=2.3334 pcon=8.4577 forget=0.0000 orth=0.1375 favg=0.0000 nr=91 nf=8 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=10.5927 mle=1.9973 pcon=8.4580 forget=0.0000 orth=0.1375 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=10.7095 mle=2.1148 pcon=8.4573 forget=0.0000 orth=0.1375 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=10.5659 mle=1.9713 pcon=8.4572 forget=0.0000 orth=0.1374 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 45 it 5 total=10.5719 mle=1.9777 pcon=8.4568 forget=0.0000 orth=0.1374 favg=0.0000 nr=110 nf=8 protos=None fproto_sim=NA
 92%|█████████▏| 46/50 [08:27<00:46, 11.66s/it] 94%|█████████▍| 47/50 [08:38<00:35, 11.70s/it] 96%|█████████▌| 48/50 [08:50<00:23, 11.68s/it] 98%|█████████▊| 49/50 [09:02<00:11, 11.89s/it]100%|██████████| 50/50 [09:14<00:00, 11.80s/it]100%|██████████| 50/50 [09:14<00:00, 11.09s/it]
[loss] ep 45 it 55 total=10.5497 mle=1.9554 pcon=8.4569 forget=0.0000 orth=0.1374 favg=0.0000 nr=118 nf=4 protos=None fproto_sim=NA
[loss] ep 45 it 105 total=10.5944 mle=2.0000 pcon=8.4570 forget=0.0000 orth=0.1374 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 45 it 155 total=10.7185 mle=2.1244 pcon=8.4568 forget=0.0000 orth=0.1374 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 45 it 205 total=10.7903 mle=2.1971 pcon=8.4558 forget=0.0000 orth=0.1373 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 45 it 255 total=10.6305 mle=2.0379 pcon=8.4553 forget=0.0000 orth=0.1373 favg=0.0000 nr=102 nf=12 protos=None fproto_sim=NA
[loss] ep 45 it 305 total=10.7090 mle=2.1172 pcon=8.4545 forget=0.0000 orth=0.1373 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 45 it 355 total=10.5490 mle=1.9586 pcon=8.4531 forget=0.0000 orth=0.1373 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 46 it 14 total=10.6613 mle=2.0709 pcon=8.4531 forget=0.0000 orth=0.1373 favg=0.0000 nr=109 nf=9 protos=None fproto_sim=NA
[loss] ep 46 it 64 total=10.7445 mle=2.1551 pcon=8.4521 forget=0.0000 orth=0.1373 favg=0.0000 nr=107 nf=3 protos=None fproto_sim=NA
[loss] ep 46 it 114 total=10.8246 mle=2.2350 pcon=8.4523 forget=0.0000 orth=0.1373 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 164 total=10.5739 mle=1.9848 pcon=8.4519 forget=0.0000 orth=0.1373 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 214 total=10.6577 mle=2.0685 pcon=8.4520 forget=0.0000 orth=0.1372 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 46 it 264 total=10.6331 mle=2.0443 pcon=8.4516 forget=0.0000 orth=0.1372 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 314 total=10.5696 mle=1.9811 pcon=8.4512 forget=0.0000 orth=0.1372 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 46 it 364 total=10.7692 mle=2.1814 pcon=8.4506 forget=0.0000 orth=0.1372 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 47 it 23 total=10.8238 mle=2.2364 pcon=8.4502 forget=0.0000 orth=0.1372 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 47 it 73 total=10.7780 mle=2.1914 pcon=8.4494 forget=0.0000 orth=0.1372 favg=0.0000 nr=108 nf=9 protos=None fproto_sim=NA
[loss] ep 47 it 123 total=10.5885 mle=2.0019 pcon=8.4493 forget=0.0000 orth=0.1372 favg=0.0000 nr=113 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 173 total=10.5102 mle=1.9241 pcon=8.4489 forget=0.0000 orth=0.1372 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 47 it 223 total=10.6086 mle=2.0235 pcon=8.4479 forget=0.0000 orth=0.1372 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 47 it 273 total=10.6185 mle=2.0335 pcon=8.4478 forget=0.0000 orth=0.1372 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 47 it 323 total=10.7413 mle=2.1565 pcon=8.4476 forget=0.0000 orth=0.1372 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 47 it 373 total=10.5527 mle=1.9675 pcon=8.4480 forget=0.0000 orth=0.1372 favg=0.0000 nr=112 nf=2 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 48 it 32 total=10.7235 mle=2.1379 pcon=8.4484 forget=0.0000 orth=0.1372 favg=0.0000 nr=109 nf=11 protos=None fproto_sim=NA
[loss] ep 48 it 82 total=10.6554 mle=2.0700 pcon=8.4482 forget=0.0000 orth=0.1372 favg=0.0000 nr=114 nf=3 protos=None fproto_sim=NA
[loss] ep 48 it 132 total=10.4131 mle=1.8283 pcon=8.4476 forget=0.0000 orth=0.1372 favg=0.0000 nr=112 nf=7 protos=None fproto_sim=NA
[loss] ep 48 it 182 total=10.6325 mle=2.0475 pcon=8.4478 forget=0.0000 orth=0.1372 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 48 it 232 total=10.9469 mle=2.3621 pcon=8.4475 forget=0.0000 orth=0.1372 favg=0.0000 nr=109 nf=10 protos=None fproto_sim=NA
[loss] ep 48 it 282 total=10.8263 mle=2.2426 pcon=8.4465 forget=0.0000 orth=0.1372 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 48 it 332 total=10.6193 mle=2.0352 pcon=8.4469 forget=0.0000 orth=0.1372 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 48 it 382 total=10.3929 mle=1.8097 pcon=8.4460 forget=0.0000 orth=0.1372 favg=0.0000 nr=113 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[loss] ep 49 it 41 total=10.5837 mle=2.0012 pcon=8.4453 forget=0.0000 orth=0.1372 favg=0.0000 nr=115 nf=2 protos=None fproto_sim=NA
[loss] ep 49 it 91 total=10.5838 mle=2.0021 pcon=8.4445 forget=0.0000 orth=0.1372 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 49 it 141 total=10.7285 mle=2.1474 pcon=8.4440 forget=0.0000 orth=0.1372 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 49 it 191 total=10.6384 mle=2.0582 pcon=8.4430 forget=0.0000 orth=0.1372 favg=0.0000 nr=112 nf=8 protos=None fproto_sim=NA
[loss] ep 49 it 241 total=10.7474 mle=2.1677 pcon=8.4425 forget=0.0000 orth=0.1372 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 49 it 291 total=10.7956 mle=2.2159 pcon=8.4425 forget=0.0000 orth=0.1372 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 49 it 341 total=10.6117 mle=2.0325 pcon=8.4421 forget=0.0000 orth=0.1372 favg=0.0000 nr=117 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage3-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:00,  1.62it/s]  3%|▎         | 11/391 [00:00<00:19, 19.79it/s]  4%|▍         | 17/391 [00:00<00:13, 26.91it/s]  7%|▋         | 26/391 [00:00<00:08, 40.70it/s]  9%|▉         | 36/391 [00:01<00:06, 54.10it/s] 12%|█▏        | 46/391 [00:01<00:05, 64.90it/s] 14%|█▍        | 56/391 [00:01<00:04, 72.79it/s] 17%|█▋        | 66/391 [00:01<00:04, 79.00it/s] 19%|█▉        | 76/391 [00:01<00:03, 83.68it/s] 22%|██▏       | 86/391 [00:01<00:03, 86.34it/s] 25%|██▍       | 96/391 [00:01<00:03, 88.74it/s] 27%|██▋       | 106/391 [00:01<00:03, 90.48it/s] 30%|██▉       | 116/391 [00:01<00:03, 91.34it/s] 32%|███▏      | 126/391 [00:02<00:02, 92.34it/s] 35%|███▍      | 136/391 [00:02<00:02, 92.89it/s] 37%|███▋      | 146/391 [00:02<00:02, 93.70it/s] 40%|███▉      | 156/391 [00:02<00:02, 93.91it/s] 42%|████▏     | 166/391 [00:02<00:02, 93.14it/s] 45%|████▌     | 176/391 [00:02<00:02, 93.61it/s] 48%|████▊     | 186/391 [00:02<00:02, 93.45it/s] 50%|█████     | 196/391 [00:02<00:02, 93.68it/s] 53%|█████▎    | 206/391 [00:02<00:02, 91.11it/s] 55%|█████▌    | 216/391 [00:02<00:01, 91.92it/s] 58%|█████▊    | 226/391 [00:03<00:01, 93.00it/s] 60%|██████    | 236/391 [00:03<00:01, 93.58it/s] 63%|██████▎   | 246/391 [00:03<00:01, 93.60it/s] 65%|██████▌   | 256/391 [00:03<00:01, 93.65it/s] 68%|██████▊   | 266/391 [00:03<00:01, 94.04it/s] 71%|███████   | 276/391 [00:03<00:01, 94.01it/s] 73%|███████▎  | 286/391 [00:03<00:01, 94.18it/s] 76%|███████▌  | 296/391 [00:03<00:01, 94.68it/s] 78%|███████▊  | 306/391 [00:03<00:00, 94.89it/s] 81%|████████  | 316/391 [00:04<00:00, 94.93it/s] 83%|████████▎ | 326/391 [00:04<00:00, 94.62it/s] 86%|████████▌ | 336/391 [00:04<00:00, 94.54it/s] 88%|████████▊ | 346/391 [00:04<00:00, 93.94it/s] 91%|█████████ | 356/391 [00:04<00:00, 93.63it/s] 94%|█████████▎| 366/391 [00:04<00:00, 85.13it/s] 96%|█████████▌| 375/391 [00:04<00:00, 63.60it/s] 98%|█████████▊| 384/391 [00:04<00:00, 68.36it/s]100%|██████████| 391/391 [00:05<00:00, 76.65it/s]
50000 images processed, 5.251862287521362 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:54,  1.42it/s] 11%|█▏        | 9/79 [00:00<00:04, 14.52it/s] 23%|██▎       | 18/79 [00:00<00:02, 28.94it/s] 35%|███▌      | 28/79 [00:01<00:01, 43.59it/s] 47%|████▋     | 37/79 [00:01<00:00, 54.28it/s] 59%|█████▉    | 47/79 [00:01<00:00, 64.28it/s] 72%|███████▏  | 57/79 [00:01<00:00, 72.91it/s] 85%|████████▍ | 67/79 [00:01<00:00, 79.36it/s] 97%|█████████▋| 77/79 [00:01<00:00, 83.87it/s]100%|██████████| 79/79 [00:01<00:00, 50.39it/s]
10000 images processed, 1.6077468395233154 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:45,  1.23it/s]  5%|▌         | 11/204 [00:00<00:12, 15.83it/s] 10%|█         | 21/204 [00:01<00:06, 30.01it/s] 15%|█▌        | 31/204 [00:01<00:04, 43.10it/s] 20%|█▉        | 40/204 [00:01<00:03, 50.65it/s] 25%|██▍       | 50/204 [00:01<00:02, 61.11it/s] 29%|██▉       | 59/204 [00:01<00:02, 64.36it/s] 33%|███▎      | 67/204 [00:01<00:02, 61.63it/s] 38%|███▊      | 77/204 [00:01<00:01, 69.91it/s] 43%|████▎     | 87/204 [00:01<00:01, 76.04it/s] 48%|████▊     | 97/204 [00:01<00:01, 80.94it/s] 52%|█████▏    | 107/204 [00:02<00:01, 84.48it/s] 57%|█████▋    | 117/204 [00:02<00:00, 87.06it/s] 62%|██████▏   | 127/204 [00:02<00:00, 89.13it/s] 67%|██████▋   | 137/204 [00:02<00:00, 90.90it/s] 72%|███████▏  | 147/204 [00:02<00:00, 91.89it/s] 77%|███████▋  | 157/204 [00:02<00:00, 92.77it/s] 82%|████████▏ | 167/204 [00:02<00:00, 93.40it/s] 87%|████████▋ | 177/204 [00:02<00:00, 93.99it/s] 92%|█████████▏| 187/204 [00:02<00:00, 94.86it/s] 97%|█████████▋| 197/204 [00:03<00:00, 95.10it/s]100%|██████████| 204/204 [00:03<00:00, 66.13it/s]
26032 images processed, 3.128751754760742 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:01<01:51,  1.42s/it] 13%|█▎        | 10/79 [00:01<00:07,  8.84it/s] 24%|██▍       | 19/79 [00:01<00:03, 18.03it/s] 33%|███▎      | 26/79 [00:01<00:02, 24.61it/s] 42%|████▏     | 33/79 [00:01<00:01, 31.07it/s] 51%|█████     | 40/79 [00:01<00:01, 37.72it/s] 61%|██████    | 48/79 [00:02<00:00, 46.43it/s] 73%|███████▎  | 58/79 [00:02<00:00, 57.96it/s] 86%|████████▌ | 68/79 [00:02<00:00, 67.61it/s] 99%|█████████▊| 78/79 [00:02<00:00, 75.20it/s]100%|██████████| 79/79 [00:02<00:00, 32.99it/s]
10000 images processed, 2.4392778873443604 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.76it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.22it/s] 27%|██▋       | 21/79 [00:00<00:01, 38.13it/s] 39%|███▉      | 31/79 [00:00<00:00, 51.83it/s] 52%|█████▏    | 41/79 [00:00<00:00, 63.02it/s] 65%|██████▍   | 51/79 [00:01<00:00, 71.05it/s] 77%|███████▋  | 61/79 [00:01<00:00, 78.00it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.22it/s]100%|██████████| 79/79 [00:01<00:00, 57.00it/s]
10000 images processed, 1.4074113368988037 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:43,  1.58it/s] 13%|█▎        | 9/70 [00:00<00:03, 15.98it/s] 27%|██▋       | 19/70 [00:00<00:01, 33.07it/s] 39%|███▊      | 27/70 [00:00<00:01, 42.89it/s] 50%|█████     | 35/70 [00:01<00:00, 47.53it/s] 64%|██████▍   | 45/70 [00:01<00:00, 59.57it/s] 79%|███████▊  | 55/70 [00:01<00:00, 69.32it/s] 93%|█████████▎| 65/70 [00:01<00:00, 75.78it/s]100%|██████████| 70/70 [00:01<00:00, 48.02it/s]
8925 images processed, 1.4898808002471924 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:54,  1.23s/it] 16%|█▌        | 7/45 [00:01<00:06,  5.51it/s] 36%|███▌      | 16/45 [00:01<00:02, 14.25it/s] 47%|████▋     | 21/45 [00:02<00:01, 14.43it/s] 56%|█████▌    | 25/45 [00:02<00:01, 14.35it/s] 71%|███████   | 32/45 [00:02<00:00, 21.35it/s] 82%|████████▏ | 37/45 [00:02<00:00, 16.28it/s]100%|██████████| 45/45 [00:02<00:00, 15.02it/s]
5640 images processed, 3.020353317260742 seconds used

20.34819984436035
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           8.27  98.25  83.76
places365     59.64  83.31  48.03
LSUN          73.03  81.47  51.38
iSUN          54.78  87.44  63.20
dtd           23.71  94.63  84.79
AVG           43.88  89.02  66.23
[incremental] Overall: 0.7173 New: 0.7080 Old: 0.7220
[incremental] Final(Top-1): 0.7173  Average: 0.7804
3.607151746749878
==== Stage 4: inc={64,22,42,9,90}; seen={0,8,11,40,51,66,67,88,94,57,59,58,44,93,10}; all(union)={0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc='split', incremental=True, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3', forget_classes='0,8,9,10,11,22,40,42,44,51,57,58,59,64,66,67,88,90,93,94', forget_list_path=None, forget_classes_inc='64,22,42,9,90', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.0, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
[incremental] resumed from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:167: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:271: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [00:17<13:54, 17.04s/it]  4%|▍         | 2/50 [00:28<10:59, 13.73s/it]  6%|▌         | 3/50 [00:40<10:05, 12.89s/it]  8%|▊         | 4/50 [00:50<09:05, 11.87s/it] 10%|█         | 5/50 [01:02<08:56, 11.91s/it] 12%|█▏        | 6/50 [01:13<08:29, 11.58s/it][loss] ep 0 it 0 total=14.3493 mle=2.7119 pcon=9.8394 forget=0.0000 orth=1.7981 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=14.1452 mle=2.5074 pcon=9.8401 forget=0.0000 orth=1.7977 favg=0.0000 nr=105 nf=1 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=14.2795 mle=2.6431 pcon=9.8394 forget=0.0000 orth=1.7971 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=14.1122 mle=2.4793 pcon=9.8369 forget=0.0000 orth=1.7959 favg=0.0000 nr=103 nf=10 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=13.8501 mle=2.2226 pcon=9.8331 forget=0.0000 orth=1.7943 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=13.9721 mle=2.3516 pcon=9.8282 forget=0.0000 orth=1.7923 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=14.1830 mle=2.5715 pcon=9.8218 forget=0.0000 orth=1.7897 favg=0.0000 nr=94 nf=6 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=13.8805 mle=2.2803 pcon=9.8135 forget=0.0000 orth=1.7867 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 1 it 9 total=13.7654 mle=2.1774 pcon=9.8048 forget=0.0000 orth=1.7832 favg=0.0000 nr=104 nf=2 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=13.9085 mle=2.3335 pcon=9.7959 forget=0.0000 orth=1.7792 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=13.8837 mle=2.3230 pcon=9.7860 forget=0.0000 orth=1.7747 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=14.0391 mle=2.4937 pcon=9.7758 forget=0.0000 orth=1.7696 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=13.8610 mle=2.3334 pcon=9.7636 forget=0.0000 orth=1.7641 favg=0.0000 nr=91 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=13.5969 mle=2.0870 pcon=9.7519 forget=0.0000 orth=1.7580 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=13.7255 mle=2.2342 pcon=9.7399 forget=0.0000 orth=1.7514 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=13.7439 mle=2.2731 pcon=9.7266 forget=0.0000 orth=1.7442 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 2 it 18 total=13.5328 mle=2.0815 pcon=9.7148 forget=0.0000 orth=1.7364 favg=0.0000 nr=103 nf=2 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=13.6092 mle=2.1785 pcon=9.7025 forget=0.0000 orth=1.7282 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=13.4786 mle=2.0696 pcon=9.6897 forget=0.0000 orth=1.7193 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=13.5853 mle=2.1980 pcon=9.6775 forget=0.0000 orth=1.7098 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=13.2273 mle=1.8637 pcon=9.6638 forget=0.0000 orth=1.6998 favg=0.0000 nr=111 nf=8 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=13.5248 mle=2.1865 pcon=9.6492 forget=0.0000 orth=1.6891 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=13.5116 mle=2.1975 pcon=9.6363 forget=0.0000 orth=1.6779 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=13.0231 mle=1.7340 pcon=9.6231 forget=0.0000 orth=1.6660 favg=0.0000 nr=111 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 3 it 27 total=13.3524 mle=2.0892 pcon=9.6097 forget=0.0000 orth=1.6535 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=13.4518 mle=2.2152 pcon=9.5962 forget=0.0000 orth=1.6403 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=13.3490 mle=2.1397 pcon=9.5828 forget=0.0000 orth=1.6266 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=13.2289 mle=2.0472 pcon=9.5696 forget=0.0000 orth=1.6121 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=13.1681 mle=2.0146 pcon=9.5564 forget=0.0000 orth=1.5971 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=13.0959 mle=1.9715 pcon=9.5430 forget=0.0000 orth=1.5814 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=13.1817 mle=2.0863 pcon=9.5303 forget=0.0000 orth=1.5652 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=13.0556 mle=1.9894 pcon=9.5179 forget=0.0000 orth=1.5483 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 4 it 36 total=13.0529 mle=2.0171 pcon=9.5050 forget=0.0000 orth=1.5308 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=13.0441 mle=2.0395 pcon=9.4920 forget=0.0000 orth=1.5127 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=13.0569 mle=2.0836 pcon=9.4793 forget=0.0000 orth=1.4940 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=12.7879 mle=1.8460 pcon=9.4671 forget=0.0000 orth=1.4748 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=12.9130 mle=2.0025 pcon=9.4553 forget=0.0000 orth=1.4552 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=12.7684 mle=1.8892 pcon=9.4442 forget=0.0000 orth=1.4351 favg=0.0000 nr=108 nf=3 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=13.1157 mle=2.2689 pcon=9.4324 forget=0.0000 orth=1.4145 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=12.7082 mle=1.8939 pcon=9.4208 forget=0.0000 orth=1.3935 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 5 it 45 total=12.8427 mle=2.0607 pcon=9.4097 forget=0.0000 orth=1.3723 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=12.7058 mle=1.9561 pcon=9.3988 forget=0.0000 orth=1.3509 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=12.7174 mle=2.0013 pcon=9.3868 forget=0.0000 orth=1.3293 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=12.6947 mle=2.0110 pcon=9.3762 forget=0.0000 orth=1.3076 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=12.7073 mle=2.0561 pcon=9.3654 forget=0.0000 orth=1.2858 favg=0.0000 nr=97 nf=12 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=12.5310 mle=1.9117 pcon=9.3552 forget=0.0000 orth=1.2641 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=12.6953 mle=2.1072 pcon=9.3457 forget=0.0000 orth=1.2424 favg=0.0000 nr=95 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 6 it 4 total=12.6130 mle=2.0561 pcon=9.3361 forget=0.0000 orth=1.2208 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=12.5857 mle=2.0598 pcon=9.3266 forget=0.0000 orth=1.1993 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=12.3800 mle=1.8858 pcon=9.3163 forget=0.0000 orth=1.1780 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=12.2968 mle=1.8335 pcon=9.3064 forget=0.0000 orth=1.1568 favg=0.0000 nr=111 nf=7 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=12.3706 mle=1.9372 pcon=9.2977 forget=0.0000 orth=1.1358 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
 14%|█▍        | 7/50 [01:24<08:09, 11.38s/it] 16%|█▌        | 8/50 [01:34<07:36, 10.88s/it] 18%|█▊        | 9/50 [01:44<07:12, 10.55s/it] 20%|██        | 10/50 [01:55<07:17, 10.94s/it] 22%|██▏       | 11/50 [02:07<07:07, 10.97s/it] 24%|██▍       | 12/50 [02:18<06:58, 11.00s/it] 26%|██▌       | 13/50 [02:28<06:44, 10.93s/it][loss] ep 6 it 254 total=12.4997 mle=2.0967 pcon=9.2880 forget=0.0000 orth=1.1150 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=12.5628 mle=2.1898 pcon=9.2786 forget=0.0000 orth=1.0943 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=12.3260 mle=1.9824 pcon=9.2698 forget=0.0000 orth=1.0737 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 7 it 13 total=12.4371 mle=2.1220 pcon=9.2616 forget=0.0000 orth=1.0534 favg=0.0000 nr=98 nf=4 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=12.5193 mle=2.2330 pcon=9.2531 forget=0.0000 orth=1.0332 favg=0.0000 nr=94 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=12.3473 mle=2.0891 pcon=9.2449 forget=0.0000 orth=1.0133 favg=0.0000 nr=93 nf=5 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=12.4380 mle=2.2078 pcon=9.2366 forget=0.0000 orth=0.9935 favg=0.0000 nr=99 nf=8 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=12.1955 mle=1.9927 pcon=9.2288 forget=0.0000 orth=0.9740 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=12.2980 mle=2.1228 pcon=9.2205 forget=0.0000 orth=0.9547 favg=0.0000 nr=102 nf=1 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=12.1098 mle=1.9602 pcon=9.2139 forget=0.0000 orth=0.9358 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=12.1922 mle=2.0685 pcon=9.2066 forget=0.0000 orth=0.9171 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 8 it 22 total=12.1122 mle=2.0150 pcon=9.1985 forget=0.0000 orth=0.8987 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=11.9805 mle=1.9081 pcon=9.1917 forget=0.0000 orth=0.8807 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=11.9188 mle=1.8713 pcon=9.1845 forget=0.0000 orth=0.8630 favg=0.0000 nr=103 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=11.8088 mle=1.7855 pcon=9.1775 forget=0.0000 orth=0.8457 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=11.7644 mle=1.7639 pcon=9.1717 forget=0.0000 orth=0.8288 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=11.9119 mle=1.9343 pcon=9.1653 forget=0.0000 orth=0.8123 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=11.9474 mle=1.9925 pcon=9.1588 forget=0.0000 orth=0.7961 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=12.0507 mle=2.1180 pcon=9.1523 forget=0.0000 orth=0.7804 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 9 it 31 total=12.0584 mle=2.1470 pcon=9.1462 forget=0.0000 orth=0.7652 favg=0.0000 nr=92 nf=11 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=11.8380 mle=1.9474 pcon=9.1401 forget=0.0000 orth=0.7505 favg=0.0000 nr=97 nf=13 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=11.7434 mle=1.8722 pcon=9.1349 forget=0.0000 orth=0.7362 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=11.8217 mle=1.9714 pcon=9.1280 forget=0.0000 orth=0.7223 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=11.6531 mle=1.8210 pcon=9.1234 forget=0.0000 orth=0.7088 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=11.8246 mle=2.0114 pcon=9.1175 forget=0.0000 orth=0.6957 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=11.9417 mle=2.1465 pcon=9.1122 forget=0.0000 orth=0.6830 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=11.7016 mle=1.9241 pcon=9.1068 forget=0.0000 orth=0.6707 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 10 it 40 total=11.6756 mle=1.9152 pcon=9.1017 forget=0.0000 orth=0.6587 favg=0.0000 nr=109 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=11.9304 mle=2.1872 pcon=9.0959 forget=0.0000 orth=0.6473 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=11.6706 mle=1.9425 pcon=9.0916 forget=0.0000 orth=0.6365 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=11.6578 mle=1.9449 pcon=9.0868 forget=0.0000 orth=0.6261 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=11.6015 mle=1.9033 pcon=9.0817 forget=0.0000 orth=0.6165 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=11.8558 mle=2.1715 pcon=9.0775 forget=0.0000 orth=0.6068 favg=0.0000 nr=93 nf=8 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=11.5511 mle=1.8801 pcon=9.0735 forget=0.0000 orth=0.5975 favg=0.0000 nr=100 nf=3 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=11.8719 mle=2.2147 pcon=9.0686 forget=0.0000 orth=0.5886 favg=0.0000 nr=65 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 11 it 49 total=11.6374 mle=1.9929 pcon=9.0643 forget=0.0000 orth=0.5801 favg=0.0000 nr=99 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=11.7788 mle=2.1480 pcon=9.0590 forget=0.0000 orth=0.5719 favg=0.0000 nr=93 nf=9 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=11.6968 mle=2.0779 pcon=9.0549 forget=0.0000 orth=0.5640 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=11.5929 mle=1.9868 pcon=9.0497 forget=0.0000 orth=0.5564 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=11.4339 mle=1.8388 pcon=9.0460 forget=0.0000 orth=0.5492 favg=0.0000 nr=113 nf=2 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=11.6662 mle=2.0828 pcon=9.0413 forget=0.0000 orth=0.5421 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=11.4496 mle=1.8765 pcon=9.0377 forget=0.0000 orth=0.5354 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 12 it 8 total=11.6656 mle=2.1024 pcon=9.0342 forget=0.0000 orth=0.5290 favg=0.0000 nr=108 nf=7 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=11.5552 mle=2.0030 pcon=9.0295 forget=0.0000 orth=0.5226 favg=0.0000 nr=107 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=11.5845 mle=2.0423 pcon=9.0257 forget=0.0000 orth=0.5165 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=11.5898 mle=2.0567 pcon=9.0224 forget=0.0000 orth=0.5107 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=11.5154 mle=1.9912 pcon=9.0191 forget=0.0000 orth=0.5051 favg=0.0000 nr=106 nf=8 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=11.7084 mle=2.1934 pcon=9.0154 forget=0.0000 orth=0.4996 favg=0.0000 nr=97 nf=5 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=11.7125 mle=2.2059 pcon=9.0123 forget=0.0000 orth=0.4943 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=11.6033 mle=2.1053 pcon=9.0088 forget=0.0000 orth=0.4892 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
 28%|██▊       | 14/50 [02:39<06:35, 10.99s/it] 30%|███       | 15/50 [02:52<06:41, 11.48s/it] 32%|███▏      | 16/50 [03:02<06:12, 10.97s/it] 34%|███▍      | 17/50 [03:13<06:03, 11.03s/it] 36%|███▌      | 18/50 [03:24<05:51, 10.98s/it] 38%|███▊      | 19/50 [03:35<05:43, 11.08s/it][loss] ep 13 it 17 total=11.5885 mle=2.0983 pcon=9.0060 forget=0.0000 orth=0.4843 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=11.4205 mle=1.9388 pcon=9.0022 forget=0.0000 orth=0.4795 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=11.6279 mle=2.1541 pcon=8.9989 forget=0.0000 orth=0.4749 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=11.6367 mle=2.1707 pcon=8.9956 forget=0.0000 orth=0.4704 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=11.6389 mle=2.1800 pcon=8.9928 forget=0.0000 orth=0.4660 favg=0.0000 nr=96 nf=9 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=11.5673 mle=2.1155 pcon=8.9900 forget=0.0000 orth=0.4618 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=11.5048 mle=2.0604 pcon=8.9867 forget=0.0000 orth=0.4577 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=11.5662 mle=2.1290 pcon=8.9834 forget=0.0000 orth=0.4537 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 14 it 26 total=11.6243 mle=2.1938 pcon=8.9807 forget=0.0000 orth=0.4498 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=11.3621 mle=1.9387 pcon=8.9774 forget=0.0000 orth=0.4460 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=11.4163 mle=1.9993 pcon=8.9747 forget=0.0000 orth=0.4423 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=11.6322 mle=2.2229 pcon=8.9707 forget=0.0000 orth=0.4387 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=11.3945 mle=1.9915 pcon=8.9679 forget=0.0000 orth=0.4351 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=11.5828 mle=2.1867 pcon=8.9645 forget=0.0000 orth=0.4316 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=11.4842 mle=2.0942 pcon=8.9618 forget=0.0000 orth=0.4282 favg=0.0000 nr=103 nf=11 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=11.2298 mle=1.8457 pcon=8.9591 forget=0.0000 orth=0.4250 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 15 it 35 total=11.4129 mle=2.0355 pcon=8.9557 forget=0.0000 orth=0.4218 favg=0.0000 nr=99 nf=6 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=11.4350 mle=2.0633 pcon=8.9530 forget=0.0000 orth=0.4187 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=11.3087 mle=1.9434 pcon=8.9497 forget=0.0000 orth=0.4156 favg=0.0000 nr=115 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=11.3561 mle=1.9960 pcon=8.9476 forget=0.0000 orth=0.4126 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=11.4674 mle=2.1134 pcon=8.9444 forget=0.0000 orth=0.4096 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=11.3514 mle=2.0024 pcon=8.9422 forget=0.0000 orth=0.4068 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=11.4879 mle=2.1444 pcon=8.9396 forget=0.0000 orth=0.4040 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=11.3399 mle=2.0018 pcon=8.9369 forget=0.0000 orth=0.4012 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 16 it 44 total=11.5251 mle=2.1908 pcon=8.9357 forget=0.0000 orth=0.3986 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=11.4980 mle=2.1682 pcon=8.9339 forget=0.0000 orth=0.3958 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=11.3280 mle=2.0031 pcon=8.9318 forget=0.0000 orth=0.3932 favg=0.0000 nr=100 nf=9 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=11.3775 mle=2.0583 pcon=8.9286 forget=0.0000 orth=0.3906 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=11.2834 mle=1.9687 pcon=8.9267 forget=0.0000 orth=0.3880 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=11.2324 mle=1.9224 pcon=8.9245 forget=0.0000 orth=0.3855 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=11.3705 mle=2.0655 pcon=8.9218 forget=0.0000 orth=0.3832 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 17 it 3 total=11.1626 mle=1.8624 pcon=8.9194 forget=0.0000 orth=0.3809 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=11.1638 mle=1.8686 pcon=8.9168 forget=0.0000 orth=0.3784 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=11.3865 mle=2.0960 pcon=8.9144 forget=0.0000 orth=0.3761 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=11.2550 mle=1.9689 pcon=8.9122 forget=0.0000 orth=0.3739 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=11.2432 mle=1.9614 pcon=8.9101 forget=0.0000 orth=0.3717 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=11.3458 mle=2.0678 pcon=8.9085 forget=0.0000 orth=0.3695 favg=0.0000 nr=101 nf=2 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=11.1992 mle=1.9252 pcon=8.9067 forget=0.0000 orth=0.3673 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=11.2739 mle=2.0044 pcon=8.9043 forget=0.0000 orth=0.3652 favg=0.0000 nr=103 nf=4 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 18 it 12 total=11.2902 mle=2.0254 pcon=8.9016 forget=0.0000 orth=0.3632 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=11.4228 mle=2.1620 pcon=8.8995 forget=0.0000 orth=0.3612 favg=0.0000 nr=98 nf=12 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=11.2112 mle=1.9538 pcon=8.8982 forget=0.0000 orth=0.3592 favg=0.0000 nr=101 nf=5 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=11.3005 mle=2.0472 pcon=8.8961 forget=0.0000 orth=0.3572 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=11.2782 mle=2.0293 pcon=8.8936 forget=0.0000 orth=0.3553 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=11.2476 mle=2.0033 pcon=8.8910 forget=0.0000 orth=0.3533 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=11.2534 mle=2.0131 pcon=8.8888 forget=0.0000 orth=0.3514 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=11.1129 mle=1.8765 pcon=8.8869 forget=0.0000 orth=0.3495 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 19 it 21 total=11.0971 mle=1.8642 pcon=8.8852 forget=0.0000 orth=0.3477 favg=0.0000 nr=104 nf=6 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=11.2906 mle=2.0618 pcon=8.8829 forget=0.0000 orth=0.3459 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=11.1239 mle=1.8985 pcon=8.8812 forget=0.0000 orth=0.3441 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=11.2717 mle=2.0500 pcon=8.8793 forget=0.0000 orth=0.3424 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
 40%|████      | 20/50 [03:47<05:40, 11.36s/it] 42%|████▏     | 21/50 [03:58<05:20, 11.04s/it] 44%|████▍     | 22/50 [04:09<05:10, 11.08s/it] 46%|████▌     | 23/50 [04:19<04:53, 10.85s/it] 48%|████▊     | 24/50 [04:30<04:39, 10.76s/it] 50%|█████     | 25/50 [04:40<04:30, 10.81s/it][loss] ep 19 it 221 total=11.2402 mle=2.0213 pcon=8.8782 forget=0.0000 orth=0.3407 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=11.3592 mle=2.1436 pcon=8.8767 forget=0.0000 orth=0.3389 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=11.3456 mle=2.1331 pcon=8.8753 forget=0.0000 orth=0.3373 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=11.2510 mle=2.0417 pcon=8.8737 forget=0.0000 orth=0.3357 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 20 it 30 total=11.3524 mle=2.1452 pcon=8.8732 forget=0.0000 orth=0.3340 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=11.0930 mle=1.8893 pcon=8.8714 forget=0.0000 orth=0.3324 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=11.2457 mle=2.0453 pcon=8.8695 forget=0.0000 orth=0.3309 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=11.2456 mle=2.0481 pcon=8.8681 forget=0.0000 orth=0.3294 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=11.1401 mle=1.9453 pcon=8.8671 forget=0.0000 orth=0.3278 favg=0.0000 nr=109 nf=3 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=11.1961 mle=2.0046 pcon=8.8652 forget=0.0000 orth=0.3263 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=11.3922 mle=2.2037 pcon=8.8637 forget=0.0000 orth=0.3248 favg=0.0000 nr=92 nf=13 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=11.2752 mle=2.0891 pcon=8.8627 forget=0.0000 orth=0.3233 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 21 it 39 total=11.1844 mle=2.0019 pcon=8.8607 forget=0.0000 orth=0.3218 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=11.0909 mle=1.9118 pcon=8.8587 forget=0.0000 orth=0.3203 favg=0.0000 nr=106 nf=2 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=11.2435 mle=2.0668 pcon=8.8578 forget=0.0000 orth=0.3190 favg=0.0000 nr=104 nf=3 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=11.0997 mle=1.9257 pcon=8.8564 forget=0.0000 orth=0.3176 favg=0.0000 nr=107 nf=4 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=11.2986 mle=2.1278 pcon=8.8545 forget=0.0000 orth=0.3162 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=11.0857 mle=1.9177 pcon=8.8532 forget=0.0000 orth=0.3148 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=11.1069 mle=1.9414 pcon=8.8520 forget=0.0000 orth=0.3135 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=11.2887 mle=2.1267 pcon=8.8498 forget=0.0000 orth=0.3122 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 22 it 48 total=11.2344 mle=2.0751 pcon=8.8485 forget=0.0000 orth=0.3108 favg=0.0000 nr=98 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=11.0796 mle=1.9232 pcon=8.8469 forget=0.0000 orth=0.3095 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=11.2125 mle=2.0587 pcon=8.8456 forget=0.0000 orth=0.3082 favg=0.0000 nr=100 nf=6 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=11.1469 mle=1.9956 pcon=8.8443 forget=0.0000 orth=0.3070 favg=0.0000 nr=102 nf=2 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=11.1587 mle=2.0099 pcon=8.8430 forget=0.0000 orth=0.3058 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=11.0966 mle=1.9502 pcon=8.8419 forget=0.0000 orth=0.3045 favg=0.0000 nr=104 nf=10 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=11.2816 mle=2.1381 pcon=8.8402 forget=0.0000 orth=0.3033 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 23 it 7 total=11.0655 mle=1.9250 pcon=8.8384 forget=0.0000 orth=0.3022 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=11.2410 mle=2.1027 pcon=8.8372 forget=0.0000 orth=0.3010 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=10.9356 mle=1.8000 pcon=8.8357 forget=0.0000 orth=0.2999 favg=0.0000 nr=112 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=11.4125 mle=2.2797 pcon=8.8341 forget=0.0000 orth=0.2987 favg=0.0000 nr=94 nf=13 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=11.2625 mle=2.1326 pcon=8.8324 forget=0.0000 orth=0.2975 favg=0.0000 nr=96 nf=5 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=11.1599 mle=2.0321 pcon=8.8314 forget=0.0000 orth=0.2964 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=11.1907 mle=2.0662 pcon=8.8292 forget=0.0000 orth=0.2953 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=11.0263 mle=1.9041 pcon=8.8280 forget=0.0000 orth=0.2942 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 24 it 16 total=11.2242 mle=2.1043 pcon=8.8267 forget=0.0000 orth=0.2931 favg=0.0000 nr=100 nf=10 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=11.0254 mle=1.9070 pcon=8.8263 forget=0.0000 orth=0.2921 favg=0.0000 nr=105 nf=2 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=11.3187 mle=2.2028 pcon=8.8249 forget=0.0000 orth=0.2910 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=11.2868 mle=2.1736 pcon=8.8231 forget=0.0000 orth=0.2900 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=11.0309 mle=1.9207 pcon=8.8213 forget=0.0000 orth=0.2889 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=11.0953 mle=1.9881 pcon=8.8192 forget=0.0000 orth=0.2879 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=11.0252 mle=1.9198 pcon=8.8184 forget=0.0000 orth=0.2870 favg=0.0000 nr=103 nf=12 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=11.3562 mle=2.2528 pcon=8.8175 forget=0.0000 orth=0.2860 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 25 it 25 total=11.0316 mle=1.9305 pcon=8.8160 forget=0.0000 orth=0.2850 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=11.1638 mle=2.0649 pcon=8.8149 forget=0.0000 orth=0.2840 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=11.3915 mle=2.2961 pcon=8.8124 forget=0.0000 orth=0.2830 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=11.0847 mle=1.9911 pcon=8.8115 forget=0.0000 orth=0.2821 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=11.0137 mle=1.9225 pcon=8.8100 forget=0.0000 orth=0.2812 favg=0.0000 nr=108 nf=8 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=11.2002 mle=2.1110 pcon=8.8090 forget=0.0000 orth=0.2803 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=11.0509 mle=1.9637 pcon=8.8080 forget=0.0000 orth=0.2793 favg=0.0000 nr=106 nf=9 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=11.1886 mle=2.1025 pcon=8.8076 forget=0.0000 orth=0.2785 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
 52%|█████▏    | 26/50 [04:52<04:22, 10.92s/it] 54%|█████▍    | 27/50 [05:02<04:09, 10.85s/it] 56%|█████▌    | 28/50 [05:13<03:57, 10.79s/it] 58%|█████▊    | 29/50 [05:24<03:46, 10.78s/it] 60%|██████    | 30/50 [05:35<03:36, 10.83s/it] 62%|██████▏   | 31/50 [05:46<03:29, 11.01s/it] 64%|██████▍   | 32/50 [05:58<03:20, 11.13s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 26 it 34 total=11.0016 mle=1.9183 pcon=8.8057 forget=0.0000 orth=0.2776 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=11.2323 mle=2.1519 pcon=8.8037 forget=0.0000 orth=0.2767 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=11.1424 mle=2.0631 pcon=8.8034 forget=0.0000 orth=0.2759 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=11.1824 mle=2.1053 pcon=8.8021 forget=0.0000 orth=0.2750 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=11.0173 mle=1.9424 pcon=8.8008 forget=0.0000 orth=0.2741 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=11.1555 mle=2.0829 pcon=8.7993 forget=0.0000 orth=0.2733 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=11.0777 mle=2.0071 pcon=8.7982 forget=0.0000 orth=0.2724 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=11.0599 mle=1.9911 pcon=8.7973 forget=0.0000 orth=0.2716 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 27 it 43 total=11.2375 mle=2.1701 pcon=8.7966 forget=0.0000 orth=0.2708 favg=0.0000 nr=97 nf=3 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=11.0633 mle=1.9970 pcon=8.7963 forget=0.0000 orth=0.2700 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=11.1859 mle=2.1216 pcon=8.7951 forget=0.0000 orth=0.2692 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=11.0768 mle=2.0150 pcon=8.7934 forget=0.0000 orth=0.2684 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=11.0981 mle=2.0378 pcon=8.7927 forget=0.0000 orth=0.2676 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=11.1502 mle=2.0916 pcon=8.7917 forget=0.0000 orth=0.2669 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=10.9403 mle=1.8838 pcon=8.7903 forget=0.0000 orth=0.2661 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 28 it 2 total=10.9242 mle=1.8694 pcon=8.7894 forget=0.0000 orth=0.2654 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=11.2172 mle=2.1643 pcon=8.7883 forget=0.0000 orth=0.2646 favg=0.0000 nr=97 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=11.1011 mle=2.0497 pcon=8.7875 forget=0.0000 orth=0.2639 favg=0.0000 nr=102 nf=6 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=11.2845 mle=2.2341 pcon=8.7873 forget=0.0000 orth=0.2632 favg=0.0000 nr=96 nf=7 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=11.1755 mle=2.1268 pcon=8.7861 forget=0.0000 orth=0.2625 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=11.1369 mle=2.0901 pcon=8.7850 forget=0.0000 orth=0.2618 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=10.8551 mle=1.8093 pcon=8.7847 forget=0.0000 orth=0.2611 favg=0.0000 nr=112 nf=5 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=11.0529 mle=2.0090 pcon=8.7834 forget=0.0000 orth=0.2604 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 29 it 11 total=10.8776 mle=1.8357 pcon=8.7822 forget=0.0000 orth=0.2598 favg=0.0000 nr=107 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=11.0962 mle=2.0552 pcon=8.7818 forget=0.0000 orth=0.2591 favg=0.0000 nr=99 nf=3 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=11.1708 mle=2.1314 pcon=8.7810 forget=0.0000 orth=0.2585 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=10.9911 mle=1.9531 pcon=8.7801 forget=0.0000 orth=0.2578 favg=0.0000 nr=109 nf=8 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=11.2149 mle=2.1790 pcon=8.7786 forget=0.0000 orth=0.2572 favg=0.0000 nr=101 nf=11 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=11.0787 mle=2.0439 pcon=8.7781 forget=0.0000 orth=0.2566 favg=0.0000 nr=103 nf=9 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=11.0456 mle=2.0118 pcon=8.7777 forget=0.0000 orth=0.2560 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=11.3582 mle=2.3255 pcon=8.7773 forget=0.0000 orth=0.2554 favg=0.0000 nr=97 nf=11 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 30 it 20 total=10.8708 mle=1.8390 pcon=8.7770 forget=0.0000 orth=0.2547 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=11.1219 mle=2.0909 pcon=8.7768 forget=0.0000 orth=0.2542 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=10.9859 mle=1.9566 pcon=8.7757 forget=0.0000 orth=0.2536 favg=0.0000 nr=112 nf=4 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=11.3416 mle=2.3136 pcon=8.7750 forget=0.0000 orth=0.2530 favg=0.0000 nr=100 nf=8 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=11.0790 mle=2.0516 pcon=8.7750 forget=0.0000 orth=0.2524 favg=0.0000 nr=102 nf=10 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=10.8878 mle=1.8615 pcon=8.7744 forget=0.0000 orth=0.2518 favg=0.0000 nr=110 nf=7 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=11.0911 mle=2.0662 pcon=8.7736 forget=0.0000 orth=0.2513 favg=0.0000 nr=98 nf=5 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=11.1478 mle=2.1245 pcon=8.7725 forget=0.0000 orth=0.2507 favg=0.0000 nr=96 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 31 it 29 total=10.9332 mle=1.9116 pcon=8.7714 forget=0.0000 orth=0.2502 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=11.1944 mle=2.1747 pcon=8.7700 forget=0.0000 orth=0.2497 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=11.0370 mle=2.0185 pcon=8.7694 forget=0.0000 orth=0.2491 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=11.1966 mle=2.1788 pcon=8.7692 forget=0.0000 orth=0.2486 favg=0.0000 nr=101 nf=7 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=11.1634 mle=2.1475 pcon=8.7678 forget=0.0000 orth=0.2481 favg=0.0000 nr=101 nf=3 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=10.8559 mle=1.8413 pcon=8.7671 forget=0.0000 orth=0.2475 favg=0.0000 nr=105 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=11.1631 mle=2.1494 pcon=8.7667 forget=0.0000 orth=0.2470 favg=0.0000 nr=102 nf=9 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=11.1532 mle=2.1416 pcon=8.7651 forget=0.0000 orth=0.2466 favg=0.0000 nr=92 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 32 it 38 total=11.0520 mle=2.0425 pcon=8.7634 forget=0.0000 orth=0.2461 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=10.9758 mle=1.9682 pcon=8.7620 forget=0.0000 orth=0.2456 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
 66%|██████▌   | 33/50 [06:10<03:14, 11.41s/it] 68%|██████▊   | 34/50 [06:21<03:02, 11.39s/it] 70%|███████   | 35/50 [06:32<02:49, 11.31s/it] 72%|███████▏  | 36/50 [06:43<02:34, 11.06s/it] 74%|███████▍  | 37/50 [06:54<02:23, 11.04s/it] 76%|███████▌  | 38/50 [07:04<02:10, 10.86s/it][loss] ep 32 it 138 total=11.0040 mle=1.9977 pcon=8.7611 forget=0.0000 orth=0.2452 favg=0.0000 nr=104 nf=5 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=11.1625 mle=2.1578 pcon=8.7600 forget=0.0000 orth=0.2447 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 32 it 238 total=10.8737 mle=1.8701 pcon=8.7594 forget=0.0000 orth=0.2442 favg=0.0000 nr=107 nf=1 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=10.9969 mle=1.9949 pcon=8.7582 forget=0.0000 orth=0.2438 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=11.2178 mle=2.2163 pcon=8.7581 forget=0.0000 orth=0.2433 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=10.8595 mle=1.8591 pcon=8.7575 forget=0.0000 orth=0.2429 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 33 it 47 total=11.1411 mle=2.1420 pcon=8.7567 forget=0.0000 orth=0.2425 favg=0.0000 nr=98 nf=8 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=11.1723 mle=2.1740 pcon=8.7562 forget=0.0000 orth=0.2421 favg=0.0000 nr=99 nf=10 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=11.0759 mle=2.0788 pcon=8.7555 forget=0.0000 orth=0.2416 favg=0.0000 nr=105 nf=4 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=10.8555 mle=1.8601 pcon=8.7542 forget=0.0000 orth=0.2412 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=10.9385 mle=1.9446 pcon=8.7531 forget=0.0000 orth=0.2408 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=11.0919 mle=2.0997 pcon=8.7517 forget=0.0000 orth=0.2405 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=11.1648 mle=2.1731 pcon=8.7517 forget=0.0000 orth=0.2401 favg=0.0000 nr=96 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 34 it 6 total=11.2217 mle=2.2310 pcon=8.7511 forget=0.0000 orth=0.2397 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=10.9224 mle=1.9327 pcon=8.7504 forget=0.0000 orth=0.2393 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=10.9432 mle=1.9547 pcon=8.7495 forget=0.0000 orth=0.2390 favg=0.0000 nr=107 nf=5 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=11.0025 mle=2.0155 pcon=8.7484 forget=0.0000 orth=0.2386 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=10.8862 mle=1.9002 pcon=8.7479 forget=0.0000 orth=0.2382 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=11.0247 mle=2.0399 pcon=8.7469 forget=0.0000 orth=0.2379 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=10.9870 mle=2.0030 pcon=8.7465 forget=0.0000 orth=0.2375 favg=0.0000 nr=107 nf=2 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=11.1587 mle=2.1757 pcon=8.7458 forget=0.0000 orth=0.2372 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 35 it 15 total=11.0107 mle=2.0290 pcon=8.7449 forget=0.0000 orth=0.2368 favg=0.0000 nr=104 nf=4 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=11.0344 mle=2.0542 pcon=8.7437 forget=0.0000 orth=0.2365 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=11.1392 mle=2.1603 pcon=8.7427 forget=0.0000 orth=0.2362 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=11.1346 mle=2.1567 pcon=8.7421 forget=0.0000 orth=0.2358 favg=0.0000 nr=94 nf=9 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=11.1117 mle=2.1346 pcon=8.7416 forget=0.0000 orth=0.2355 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=11.0435 mle=2.0677 pcon=8.7406 forget=0.0000 orth=0.2352 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=11.0494 mle=2.0746 pcon=8.7399 forget=0.0000 orth=0.2349 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=11.0620 mle=2.0878 pcon=8.7395 forget=0.0000 orth=0.2346 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 36 it 24 total=11.0778 mle=2.1039 pcon=8.7396 forget=0.0000 orth=0.2343 favg=0.0000 nr=94 nf=9 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=11.0034 mle=2.0301 pcon=8.7393 forget=0.0000 orth=0.2340 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=10.8212 mle=1.8485 pcon=8.7390 forget=0.0000 orth=0.2337 favg=0.0000 nr=114 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=10.9965 mle=2.0249 pcon=8.7383 forget=0.0000 orth=0.2334 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=10.9189 mle=1.9484 pcon=8.7375 forget=0.0000 orth=0.2331 favg=0.0000 nr=109 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=11.1393 mle=2.1698 pcon=8.7366 forget=0.0000 orth=0.2328 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=11.0153 mle=2.0465 pcon=8.7363 forget=0.0000 orth=0.2325 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=10.9237 mle=1.9561 pcon=8.7354 forget=0.0000 orth=0.2323 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=10.9374 mle=1.9707 pcon=8.7347 forget=0.0000 orth=0.2320 favg=0.0000 nr=98 nf=10 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=11.1019 mle=2.1364 pcon=8.7337 forget=0.0000 orth=0.2318 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=10.9315 mle=1.9663 pcon=8.7337 forget=0.0000 orth=0.2315 favg=0.0000 nr=101 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=11.0345 mle=2.0703 pcon=8.7330 forget=0.0000 orth=0.2313 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=10.7645 mle=1.8006 pcon=8.7329 forget=0.0000 orth=0.2310 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=11.1557 mle=2.1932 pcon=8.7318 forget=0.0000 orth=0.2308 favg=0.0000 nr=99 nf=11 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=11.2732 mle=2.3112 pcon=8.7315 forget=0.0000 orth=0.2306 favg=0.0000 nr=97 nf=6 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=10.9697 mle=2.0087 pcon=8.7307 forget=0.0000 orth=0.2303 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 38 it 42 total=11.0385 mle=2.0784 pcon=8.7299 forget=0.0000 orth=0.2301 favg=0.0000 nr=95 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=11.2378 mle=2.2789 pcon=8.7289 forget=0.0000 orth=0.2299 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=10.9545 mle=1.9964 pcon=8.7284 forget=0.0000 orth=0.2297 favg=0.0000 nr=111 nf=4 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=10.8379 mle=1.8810 pcon=8.7275 forget=0.0000 orth=0.2295 favg=0.0000 nr=111 nf=5 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=10.9930 mle=2.0365 pcon=8.7272 forget=0.0000 orth=0.2293 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=11.0637 mle=2.1076 pcon=8.7270 forget=0.0000 orth=0.2291 favg=0.0000 nr=101 nf=6 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=10.8367 mle=1.8821 pcon=8.7256 forget=0.0000 orth=0.2289 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
 78%|███████▊  | 39/50 [07:15<02:01, 11.01s/it] 80%|████████  | 40/50 [07:26<01:48, 10.84s/it] 82%|████████▏ | 41/50 [07:37<01:38, 10.96s/it] 84%|████████▍ | 42/50 [07:48<01:28, 11.06s/it] 86%|████████▌ | 43/50 [07:59<01:17, 11.08s/it] 88%|████████▊ | 44/50 [08:11<01:07, 11.23s/it] 90%|█████████ | 45/50 [08:22<00:55, 11.17s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 39 it 1 total=11.1754 mle=2.2208 pcon=8.7259 forget=0.0000 orth=0.2287 favg=0.0000 nr=101 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=10.9292 mle=1.9757 pcon=8.7250 forget=0.0000 orth=0.2285 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=11.0735 mle=2.1202 pcon=8.7249 forget=0.0000 orth=0.2284 favg=0.0000 nr=93 nf=7 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=10.9168 mle=1.9646 pcon=8.7240 forget=0.0000 orth=0.2282 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=11.1082 mle=2.1571 pcon=8.7231 forget=0.0000 orth=0.2280 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=11.0244 mle=2.0734 pcon=8.7232 forget=0.0000 orth=0.2279 favg=0.0000 nr=109 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=10.9616 mle=2.0113 pcon=8.7226 forget=0.0000 orth=0.2277 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=11.1733 mle=2.2235 pcon=8.7223 forget=0.0000 orth=0.2275 favg=0.0000 nr=103 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 40 it 10 total=10.9003 mle=1.9517 pcon=8.7212 forget=0.0000 orth=0.2274 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=10.9198 mle=1.9725 pcon=8.7201 forget=0.0000 orth=0.2272 favg=0.0000 nr=110 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=10.8638 mle=1.9171 pcon=8.7196 forget=0.0000 orth=0.2271 favg=0.0000 nr=100 nf=4 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=10.9348 mle=1.9889 pcon=8.7190 forget=0.0000 orth=0.2269 favg=0.0000 nr=109 nf=5 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=10.9463 mle=2.0012 pcon=8.7184 forget=0.0000 orth=0.2268 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=10.9962 mle=2.0514 pcon=8.7182 forget=0.0000 orth=0.2266 favg=0.0000 nr=96 nf=11 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=11.2718 mle=2.3272 pcon=8.7181 forget=0.0000 orth=0.2265 favg=0.0000 nr=97 nf=9 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=10.9509 mle=2.0071 pcon=8.7174 forget=0.0000 orth=0.2264 favg=0.0000 nr=106 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 41 it 19 total=11.0729 mle=2.1297 pcon=8.7170 forget=0.0000 orth=0.2262 favg=0.0000 nr=99 nf=12 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=11.0714 mle=2.1275 pcon=8.7178 forget=0.0000 orth=0.2261 favg=0.0000 nr=96 nf=5 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=11.2124 mle=2.2691 pcon=8.7173 forget=0.0000 orth=0.2260 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=11.0478 mle=2.1047 pcon=8.7172 forget=0.0000 orth=0.2259 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=10.9068 mle=1.9646 pcon=8.7165 forget=0.0000 orth=0.2258 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=10.7912 mle=1.8499 pcon=8.7157 forget=0.0000 orth=0.2256 favg=0.0000 nr=111 nf=3 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=11.1818 mle=2.2404 pcon=8.7159 forget=0.0000 orth=0.2255 favg=0.0000 nr=97 nf=10 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=11.0629 mle=2.1216 pcon=8.7158 forget=0.0000 orth=0.2254 favg=0.0000 nr=105 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 42 it 28 total=10.9665 mle=2.0258 pcon=8.7154 forget=0.0000 orth=0.2253 favg=0.0000 nr=99 nf=11 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=10.9781 mle=2.0371 pcon=8.7158 forget=0.0000 orth=0.2252 favg=0.0000 nr=106 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=10.9805 mle=2.0395 pcon=8.7158 forget=0.0000 orth=0.2251 favg=0.0000 nr=103 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=10.9170 mle=1.9766 pcon=8.7153 forget=0.0000 orth=0.2251 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=10.8158 mle=1.8764 pcon=8.7144 forget=0.0000 orth=0.2250 favg=0.0000 nr=104 nf=9 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=11.0756 mle=2.1374 pcon=8.7134 forget=0.0000 orth=0.2249 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=10.9670 mle=2.0292 pcon=8.7130 forget=0.0000 orth=0.2248 favg=0.0000 nr=99 nf=7 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=10.9681 mle=2.0311 pcon=8.7123 forget=0.0000 orth=0.2247 favg=0.0000 nr=102 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 43 it 37 total=11.0068 mle=2.0700 pcon=8.7121 forget=0.0000 orth=0.2247 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=10.8545 mle=1.9178 pcon=8.7121 forget=0.0000 orth=0.2246 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=11.2110 mle=2.2749 pcon=8.7116 forget=0.0000 orth=0.2245 favg=0.0000 nr=93 nf=11 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=10.9867 mle=2.0512 pcon=8.7110 forget=0.0000 orth=0.2244 favg=0.0000 nr=103 nf=7 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=11.0235 mle=2.0882 pcon=8.7109 forget=0.0000 orth=0.2244 favg=0.0000 nr=98 nf=9 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=11.0421 mle=2.1076 pcon=8.7103 forget=0.0000 orth=0.2243 favg=0.0000 nr=99 nf=11 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=10.9830 mle=2.0483 pcon=8.7105 forget=0.0000 orth=0.2242 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=10.8544 mle=1.9196 pcon=8.7106 forget=0.0000 orth=0.2242 favg=0.0000 nr=106 nf=7 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 44 it 46 total=11.0356 mle=2.1012 pcon=8.7103 forget=0.0000 orth=0.2241 favg=0.0000 nr=102 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=10.9332 mle=1.9994 pcon=8.7097 forget=0.0000 orth=0.2241 favg=0.0000 nr=106 nf=4 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=11.1978 mle=2.2643 pcon=8.7094 forget=0.0000 orth=0.2240 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=11.2078 mle=2.2753 pcon=8.7085 forget=0.0000 orth=0.2240 favg=0.0000 nr=85 nf=6 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=10.9288 mle=1.9962 pcon=8.7087 forget=0.0000 orth=0.2239 favg=0.0000 nr=101 nf=7 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=11.0254 mle=2.0931 pcon=8.7084 forget=0.0000 orth=0.2239 favg=0.0000 nr=101 nf=10 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=10.9159 mle=1.9833 pcon=8.7087 forget=0.0000 orth=0.2238 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 45 it 5 total=10.8818 mle=1.9496 pcon=8.7084 forget=0.0000 orth=0.2238 favg=0.0000 nr=108 nf=2 protos=None fproto_sim=NA
[loss] ep 45 it 55 total=10.8670 mle=1.9347 pcon=8.7085 forget=0.0000 orth=0.2238 favg=0.0000 nr=109 nf=9 protos=None fproto_sim=NA
[loss] ep 45 it 105 total=10.9321 mle=1.9997 pcon=8.7087 forget=0.0000 orth=0.2237 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 45 it 155 total=11.0847 mle=2.1522 pcon=8.7087 forget=0.0000 orth=0.2237 favg=0.0000 nr=100 nf=5 protos=None fproto_sim=NA
 92%|█████████▏| 46/50 [08:33<00:44, 11.09s/it] 94%|█████████▍| 47/50 [08:44<00:33, 11.15s/it] 96%|█████████▌| 48/50 [08:56<00:22, 11.19s/it] 98%|█████████▊| 49/50 [09:07<00:11, 11.20s/it]100%|██████████| 50/50 [09:18<00:00, 11.22s/it]100%|██████████| 50/50 [09:18<00:00, 11.17s/it]
[loss] ep 45 it 205 total=11.1510 mle=2.2191 pcon=8.7083 forget=0.0000 orth=0.2236 favg=0.0000 nr=100 nf=10 protos=None fproto_sim=NA
[loss] ep 45 it 255 total=10.9662 mle=2.0346 pcon=8.7079 forget=0.0000 orth=0.2236 favg=0.0000 nr=99 nf=3 protos=None fproto_sim=NA
[loss] ep 45 it 305 total=11.0549 mle=2.1243 pcon=8.7070 forget=0.0000 orth=0.2236 favg=0.0000 nr=100 nf=4 protos=None fproto_sim=NA
[loss] ep 45 it 355 total=10.8962 mle=1.9662 pcon=8.7065 forget=0.0000 orth=0.2236 favg=0.0000 nr=106 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 14 total=10.9441 mle=2.0138 pcon=8.7068 forget=0.0000 orth=0.2235 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 46 it 64 total=11.0506 mle=2.1211 pcon=8.7060 forget=0.0000 orth=0.2235 favg=0.0000 nr=102 nf=5 protos=None fproto_sim=NA
[loss] ep 46 it 114 total=11.1199 mle=2.1901 pcon=8.7063 forget=0.0000 orth=0.2235 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 164 total=10.9144 mle=1.9852 pcon=8.7057 forget=0.0000 orth=0.2235 favg=0.0000 nr=105 nf=3 protos=None fproto_sim=NA
[loss] ep 46 it 214 total=10.9873 mle=2.0579 pcon=8.7059 forget=0.0000 orth=0.2234 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[loss] ep 46 it 264 total=10.9697 mle=2.0406 pcon=8.7057 forget=0.0000 orth=0.2234 favg=0.0000 nr=105 nf=5 protos=None fproto_sim=NA
[loss] ep 46 it 314 total=10.9080 mle=1.9789 pcon=8.7058 forget=0.0000 orth=0.2234 favg=0.0000 nr=104 nf=7 protos=None fproto_sim=NA
[loss] ep 46 it 364 total=11.0864 mle=2.1583 pcon=8.7047 forget=0.0000 orth=0.2234 favg=0.0000 nr=99 nf=5 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 47 it 23 total=11.1271 mle=2.1984 pcon=8.7053 forget=0.0000 orth=0.2234 favg=0.0000 nr=98 nf=6 protos=None fproto_sim=NA
[loss] ep 47 it 73 total=11.1144 mle=2.1861 pcon=8.7050 forget=0.0000 orth=0.2234 favg=0.0000 nr=107 nf=1 protos=None fproto_sim=NA
[loss] ep 47 it 123 total=10.9381 mle=2.0103 pcon=8.7045 forget=0.0000 orth=0.2233 favg=0.0000 nr=108 nf=5 protos=None fproto_sim=NA
[loss] ep 47 it 173 total=10.8798 mle=1.9530 pcon=8.7035 forget=0.0000 orth=0.2233 favg=0.0000 nr=106 nf=1 protos=None fproto_sim=NA
[loss] ep 47 it 223 total=10.9423 mle=2.0159 pcon=8.7031 forget=0.0000 orth=0.2233 favg=0.0000 nr=102 nf=4 protos=None fproto_sim=NA
[loss] ep 47 it 273 total=10.9577 mle=2.0315 pcon=8.7029 forget=0.0000 orth=0.2233 favg=0.0000 nr=103 nf=6 protos=None fproto_sim=NA
[loss] ep 47 it 323 total=11.0904 mle=2.1647 pcon=8.7024 forget=0.0000 orth=0.2233 favg=0.0000 nr=97 nf=8 protos=None fproto_sim=NA
[loss] ep 47 it 373 total=10.8599 mle=1.9340 pcon=8.7026 forget=0.0000 orth=0.2233 favg=0.0000 nr=104 nf=8 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 48 it 32 total=11.0020 mle=2.0761 pcon=8.7027 forget=0.0000 orth=0.2233 favg=0.0000 nr=100 nf=9 protos=None fproto_sim=NA
[loss] ep 48 it 82 total=10.9714 mle=2.0461 pcon=8.7021 forget=0.0000 orth=0.2233 favg=0.0000 nr=108 nf=6 protos=None fproto_sim=NA
[loss] ep 48 it 132 total=10.7959 mle=1.8709 pcon=8.7018 forget=0.0000 orth=0.2233 favg=0.0000 nr=108 nf=4 protos=None fproto_sim=NA
[loss] ep 48 it 182 total=10.9529 mle=2.0278 pcon=8.7018 forget=0.0000 orth=0.2233 favg=0.0000 nr=101 nf=7 protos=None fproto_sim=NA
[loss] ep 48 it 232 total=11.2844 mle=2.3596 pcon=8.7015 forget=0.0000 orth=0.2233 favg=0.0000 nr=100 nf=9 protos=None fproto_sim=NA
[loss] ep 48 it 282 total=11.1393 mle=2.2147 pcon=8.7013 forget=0.0000 orth=0.2233 favg=0.0000 nr=100 nf=7 protos=None fproto_sim=NA
[loss] ep 48 it 332 total=10.8940 mle=1.9691 pcon=8.7016 forget=0.0000 orth=0.2233 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 48 it 382 total=10.6996 mle=1.7753 pcon=8.7011 forget=0.0000 orth=0.2233 favg=0.0000 nr=110 nf=3 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[loss] ep 49 it 41 total=10.8938 mle=1.9697 pcon=8.7009 forget=0.0000 orth=0.2233 favg=0.0000 nr=105 nf=10 protos=None fproto_sim=NA
[loss] ep 49 it 91 total=10.9322 mle=2.0084 pcon=8.7005 forget=0.0000 orth=0.2233 favg=0.0000 nr=105 nf=6 protos=None fproto_sim=NA
[loss] ep 49 it 141 total=11.0912 mle=2.1677 pcon=8.7003 forget=0.0000 orth=0.2233 favg=0.0000 nr=99 nf=6 protos=None fproto_sim=NA
[loss] ep 49 it 191 total=10.9848 mle=2.0624 pcon=8.6991 forget=0.0000 orth=0.2233 favg=0.0000 nr=105 nf=7 protos=None fproto_sim=NA
[loss] ep 49 it 241 total=11.0810 mle=2.1591 pcon=8.6987 forget=0.0000 orth=0.2232 favg=0.0000 nr=98 nf=7 protos=None fproto_sim=NA
[loss] ep 49 it 291 total=11.1194 mle=2.1974 pcon=8.6988 forget=0.0000 orth=0.2232 favg=0.0000 nr=95 nf=5 protos=None fproto_sim=NA
[loss] ep 49 it 341 total=10.9586 mle=2.0372 pcon=8.6982 forget=0.0000 orth=0.2232 favg=0.0000 nr=107 nf=10 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-upper-retain-c80.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-pcon1-lora_r8a32d0.05-temp0.08-ol1-continual-from-c80-to-CIFAR-100-palm_mle_all-pcon_split-stage4-seen-inc: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:49,  1.35it/s]  3%|▎         | 11/391 [00:00<00:22, 17.13it/s]  5%|▌         | 21/391 [00:00<00:11, 32.25it/s]  7%|▋         | 29/391 [00:01<00:08, 42.01it/s]  9%|▉         | 37/391 [00:01<00:08, 43.24it/s] 12%|█▏        | 47/391 [00:01<00:06, 55.20it/s] 15%|█▍        | 57/391 [00:01<00:05, 65.06it/s] 17%|█▋        | 67/391 [00:01<00:04, 72.72it/s] 20%|█▉        | 77/391 [00:01<00:03, 78.93it/s] 22%|██▏       | 87/391 [00:01<00:03, 83.54it/s] 25%|██▍       | 97/391 [00:01<00:03, 87.07it/s] 27%|██▋       | 107/391 [00:01<00:03, 89.43it/s] 30%|██▉       | 117/391 [00:02<00:02, 91.62it/s] 32%|███▏      | 127/391 [00:02<00:02, 93.00it/s] 35%|███▌      | 137/391 [00:02<00:02, 93.90it/s] 38%|███▊      | 147/391 [00:02<00:02, 94.25it/s] 40%|████      | 157/391 [00:02<00:02, 94.83it/s] 43%|████▎     | 167/391 [00:02<00:02, 95.20it/s] 45%|████▌     | 177/391 [00:02<00:02, 95.41it/s] 48%|████▊     | 187/391 [00:02<00:02, 95.53it/s] 50%|█████     | 197/391 [00:02<00:02, 95.48it/s] 53%|█████▎    | 207/391 [00:03<00:02, 87.97it/s] 55%|█████▌    | 217/391 [00:03<00:01, 90.24it/s] 58%|█████▊    | 227/391 [00:03<00:01, 91.99it/s] 61%|██████    | 237/391 [00:03<00:01, 93.23it/s] 63%|██████▎   | 247/391 [00:03<00:01, 94.06it/s] 66%|██████▌   | 257/391 [00:03<00:01, 94.71it/s] 68%|██████▊   | 267/391 [00:03<00:01, 95.14it/s] 71%|███████   | 277/391 [00:03<00:01, 91.12it/s] 73%|███████▎  | 287/391 [00:03<00:01, 92.60it/s] 76%|███████▌  | 297/391 [00:03<00:01, 93.73it/s] 79%|███████▊  | 307/391 [00:04<00:00, 94.47it/s] 81%|████████  | 317/391 [00:04<00:00, 94.61it/s] 84%|████████▎ | 327/391 [00:04<00:00, 95.20it/s] 86%|████████▌ | 337/391 [00:04<00:00, 95.54it/s] 89%|████████▊ | 347/391 [00:04<00:00, 94.82it/s] 91%|█████████▏| 357/391 [00:04<00:00, 94.94it/s] 94%|█████████▍| 367/391 [00:04<00:00, 95.29it/s] 96%|█████████▋| 377/391 [00:04<00:00, 95.96it/s] 99%|█████████▉| 387/391 [00:04<00:00, 96.52it/s]100%|██████████| 391/391 [00:04<00:00, 78.61it/s]
50000 images processed, 5.032378435134888 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.93it/s] 14%|█▍        | 11/79 [00:00<00:02, 22.70it/s] 27%|██▋       | 21/79 [00:00<00:01, 39.78it/s] 39%|███▉      | 31/79 [00:00<00:00, 53.64it/s] 52%|█████▏    | 41/79 [00:00<00:00, 64.31it/s] 63%|██████▎   | 50/79 [00:01<00:00, 66.16it/s] 73%|███████▎  | 58/79 [00:01<00:00, 64.24it/s] 84%|████████▎ | 66/79 [00:01<00:00, 61.44it/s] 92%|█████████▏| 73/79 [00:01<00:00, 60.63it/s]100%|██████████| 79/79 [00:01<00:00, 46.61it/s]
10000 images processed, 1.752650499343872 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:56,  1.75it/s]  5%|▌         | 11/204 [00:00<00:09, 21.04it/s] 10%|█         | 21/204 [00:00<00:04, 37.58it/s] 15%|█▌        | 31/204 [00:00<00:03, 51.56it/s] 20%|█▉        | 40/204 [00:01<00:02, 59.96it/s] 24%|██▍       | 49/204 [00:01<00:02, 67.65it/s] 28%|██▊       | 58/204 [00:01<00:01, 73.23it/s] 33%|███▎      | 67/204 [00:01<00:01, 70.60it/s] 38%|███▊      | 77/204 [00:01<00:01, 76.37it/s] 42%|████▏     | 86/204 [00:01<00:01, 70.71it/s] 47%|████▋     | 96/204 [00:01<00:01, 76.99it/s] 51%|█████▏    | 105/204 [00:01<00:01, 72.12it/s] 55%|█████▌    | 113/204 [00:02<00:01, 65.45it/s] 59%|█████▉    | 120/204 [00:02<00:01, 60.82it/s] 64%|██████▎   | 130/204 [00:02<00:01, 69.03it/s] 69%|██████▊   | 140/204 [00:02<00:00, 75.12it/s] 74%|███████▎  | 150/204 [00:02<00:00, 79.92it/s] 78%|███████▊  | 159/204 [00:02<00:00, 74.44it/s] 82%|████████▏ | 167/204 [00:02<00:00, 69.33it/s] 86%|████████▌ | 175/204 [00:02<00:00, 68.33it/s] 90%|█████████ | 184/204 [00:02<00:00, 73.42it/s] 95%|█████████▌| 194/204 [00:03<00:00, 79.79it/s]100%|██████████| 204/204 [00:03<00:00, 83.46it/s]100%|██████████| 204/204 [00:03<00:00, 64.14it/s]
26032 images processed, 3.353508472442627 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:02,  1.25it/s] 11%|█▏        | 9/79 [00:00<00:05, 13.17it/s] 23%|██▎       | 18/79 [00:01<00:02, 25.61it/s] 35%|███▌      | 28/79 [00:01<00:01, 39.72it/s] 46%|████▌     | 36/79 [00:01<00:00, 44.32it/s] 56%|█████▌    | 44/79 [00:01<00:00, 52.07it/s] 66%|██████▌   | 52/79 [00:01<00:00, 58.40it/s] 76%|███████▌  | 60/79 [00:01<00:00, 60.96it/s] 89%|████████▊ | 70/79 [00:01<00:00, 70.40it/s]100%|██████████| 79/79 [00:01<00:00, 43.95it/s]
10000 images processed, 1.842353105545044 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:11,  1.09it/s] 14%|█▍        | 11/79 [00:01<00:04, 14.35it/s] 27%|██▋       | 21/79 [00:01<00:02, 27.91it/s] 39%|███▉      | 31/79 [00:01<00:01, 40.77it/s] 51%|█████     | 40/79 [00:01<00:00, 50.56it/s] 63%|██████▎   | 50/79 [00:01<00:00, 60.70it/s] 76%|███████▌  | 60/79 [00:01<00:00, 69.67it/s] 89%|████████▊ | 70/79 [00:01<00:00, 76.86it/s]100%|██████████| 79/79 [00:01<00:00, 45.52it/s]
10000 images processed, 1.7526519298553467 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.77it/s] 14%|█▍        | 10/70 [00:00<00:03, 18.93it/s] 29%|██▊       | 20/70 [00:00<00:01, 36.17it/s] 39%|███▊      | 27/70 [00:00<00:01, 42.90it/s] 49%|████▊     | 34/70 [00:01<00:00, 48.20it/s] 63%|██████▎   | 44/70 [00:01<00:00, 60.74it/s] 77%|███████▋  | 54/70 [00:01<00:00, 70.52it/s] 91%|█████████▏| 64/70 [00:01<00:00, 77.53it/s]100%|██████████| 70/70 [00:01<00:00, 50.37it/s]
8925 images processed, 1.4173614978790283 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:43,  1.02it/s]  4%|▍         | 2/45 [00:01<00:22,  1.93it/s] 16%|█▌        | 7/45 [00:01<00:05,  6.55it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.67it/s] 49%|████▉     | 22/45 [00:01<00:01, 20.39it/s] 58%|█████▊    | 26/45 [00:02<00:01, 14.40it/s] 76%|███████▌  | 34/45 [00:02<00:00, 21.21it/s] 87%|████████▋ | 39/45 [00:02<00:00, 19.46it/s]100%|██████████| 45/45 [00:02<00:00, 15.90it/s]
5640 images processed, 2.85412859916687 seconds used

20.07493782043457
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN          10.32  97.82  82.26
places365     64.60  83.64  57.09
LSUN          44.71  88.35  64.45
iSUN          54.79  88.03  70.44
dtd           22.32  94.98  87.99
AVG           39.35  90.56  72.45
[incremental] Overall: 0.6740 New: 0.6840 Old: 0.6707
[incremental] Final(Top-1): 0.6740  Average: 0.7538
4.903886318206787
[DEBUG] Eval output (last 30 lines):
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.78it/s]  9%|▉         | 7/79 [00:00<00:05, 13.57it/s] 22%|██▏       | 17/79 [00:00<00:01, 32.57it/s] 34%|███▍      | 27/79 [00:00<00:01, 48.08it/s] 46%|████▌     | 36/79 [00:00<00:00, 58.23it/s] 58%|█████▊    | 46/79 [00:01<00:00, 68.30it/s] 71%|███████   | 56/79 [00:01<00:00, 76.08it/s] 84%|████████▎ | 66/79 [00:01<00:00, 81.99it/s] 96%|█████████▌| 76/79 [00:01<00:00, 72.89it/s]100%|██████████| 79/79 [00:01<00:00, 53.28it/s]
10000 images processed, 1.5074026584625244 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:31,  2.21it/s] 13%|█▎        | 9/70 [00:00<00:02, 20.83it/s] 21%|██▏       | 15/70 [00:00<00:01, 29.47it/s] 29%|██▊       | 20/70 [00:00<00:01, 31.78it/s] 41%|████▏     | 29/70 [00:00<00:00, 45.57it/s] 56%|█████▌    | 39/70 [00:01<00:00, 56.63it/s] 70%|███████   | 49/70 [00:01<00:00, 67.32it/s] 84%|████████▍ | 59/70 [00:01<00:00, 75.47it/s] 99%|█████████▊| 69/70 [00:01<00:00, 81.54it/s]100%|██████████| 70/70 [00:01<00:00, 51.37it/s]
8925 images processed, 1.3941400051116943 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:53,  1.22s/it] 16%|█▌        | 7/45 [00:01<00:05,  6.88it/s] 38%|███▊      | 17/45 [00:01<00:02, 12.96it/s] 49%|████▉     | 22/45 [00:01<00:01, 15.44it/s] 56%|█████▌    | 25/45 [00:02<00:01, 16.96it/s] 73%|███████▎  | 33/45 [00:02<00:00, 17.87it/s] 93%|█████████▎| 42/45 [00:02<00:00, 26.65it/s]100%|██████████| 45/45 [00:02<00:00, 16.85it/s]
5640 images processed, 2.6945855617523193 seconds used

20.82013750076294
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN          10.32  97.82  82.26
places365     64.60  83.64  57.09
LSUN          44.71  88.35  64.45
iSUN          54.79  88.03  70.44
dtd           22.32  94.98  87.99
AVG           39.35  90.56  72.45
[incremental] Overall: 0.6740 New: 0.6840 Old: 0.6707
[incremental] Final(Top-1): 0.6740  Average: 0.7538
5.552891492843628
[DEBUG] Parsed: avg_fpr=39.35 avg_auroc=90.56 final_top1=0.6740 average=0.7538
[Result] AVG-AUROC=90.56 AVG-FPR=39.35 Final-Top1=0.6740 Average=0.7538 Score=73.50

[Grid Search Continual] Completed. Results saved to: evaluation_results/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-continual-continual-lambda1.0-epoch_grid_runs.csv
