nohup: ignoring input
==== Stage 1: forget_inc={0,8,11,40,51}; forget_seen={}; all={0,8,11,40,51,66,67,88,94,57} ====
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:54: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,66,67,88,94,57', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:163: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [00:13<10:53, 13.33s/it]  4%|▍         | 2/50 [00:22<08:55, 11.16s/it]  6%|▌         | 3/50 [00:32<08:07, 10.37s/it]  8%|▊         | 4/50 [00:47<09:22, 12.23s/it] 10%|█         | 5/50 [01:09<11:42, 15.60s/it] 12%|█▏        | 6/50 [01:32<13:16, 18.11s/it][loss] ep 0 it 0 total=8.5977 mle=1.8293 pcon=5.2950 forget=1.4733 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 50 total=8.6425 mle=1.9035 pcon=5.2884 forget=1.4506 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 100 total=8.5285 mle=1.7937 pcon=5.2815 forget=1.4534 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 150 total=8.4503 mle=1.7177 pcon=5.2750 forget=1.4576 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 200 total=8.4973 mle=1.7454 pcon=5.2685 forget=1.4834 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 250 total=8.5017 mle=1.7720 pcon=5.2623 forget=1.4675 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 300 total=8.4491 mle=1.7796 pcon=5.2562 forget=1.4134 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 350 total=8.4942 mle=1.8205 pcon=5.2502 forget=1.4235 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 1 it 10 total=8.4306 mle=1.7634 pcon=5.2445 forget=1.4227 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 60 total=8.4302 mle=1.7535 pcon=5.2386 forget=1.4380 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 110 total=8.3021 mle=1.6298 pcon=5.2328 forget=1.4395 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 160 total=8.3852 mle=1.7727 pcon=5.2273 forget=1.3852 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 210 total=8.5324 mle=1.8929 pcon=5.2216 forget=1.4179 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 260 total=8.5410 mle=1.9197 pcon=5.2166 forget=1.4047 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 310 total=8.5246 mle=1.8776 pcon=5.2118 forget=1.4352 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 360 total=8.4084 mle=1.7377 pcon=5.2067 forget=1.4640 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 2 it 20 total=8.4201 mle=1.7942 pcon=5.2015 forget=1.4244 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 70 total=8.3202 mle=1.7351 pcon=5.1964 forget=1.3887 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 120 total=8.3617 mle=1.7632 pcon=5.1913 forget=1.4072 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 170 total=8.1841 mle=1.5783 pcon=5.1868 forget=1.4191 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 220 total=8.5176 mle=1.9286 pcon=5.1819 forget=1.4072 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 270 total=8.3465 mle=1.7575 pcon=5.1773 forget=1.4117 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 320 total=8.4557 mle=1.8544 pcon=5.1729 forget=1.4284 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 370 total=8.2941 mle=1.7252 pcon=5.1683 forget=1.4006 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 3 it 30 total=8.4086 mle=1.8505 pcon=5.1641 forget=1.3939 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 80 total=8.4612 mle=1.9259 pcon=5.1595 forget=1.3757 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 130 total=8.2603 mle=1.7049 pcon=5.1554 forget=1.4000 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 180 total=8.3622 mle=1.8257 pcon=5.1509 forget=1.3856 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 230 total=8.2369 mle=1.6841 pcon=5.1468 forget=1.4060 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 280 total=8.2284 mle=1.6609 pcon=5.1430 forget=1.4245 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 330 total=8.2958 mle=1.7349 pcon=5.1396 forget=1.4212 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 380 total=8.2171 mle=1.6826 pcon=5.1356 forget=1.3989 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 4 it 40 total=8.1216 mle=1.5625 pcon=5.1320 forget=1.4271 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 90 total=8.2743 mle=1.7436 pcon=5.1286 forget=1.4021 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 140 total=8.1064 mle=1.5865 pcon=5.1249 forget=1.3949 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 190 total=8.4356 mle=1.8984 pcon=5.1214 forget=1.4157 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 240 total=8.3869 mle=1.8173 pcon=5.1180 forget=1.4516 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 290 total=8.2602 mle=1.7324 pcon=5.1146 forget=1.4132 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 340 total=8.1195 mle=1.6162 pcon=5.1113 forget=1.3920 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 5 it 0 total=8.1513 mle=1.6443 pcon=5.1079 forget=1.3991 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 50 total=8.2175 mle=1.7284 pcon=5.1048 forget=1.3842 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 100 total=8.3074 mle=1.7832 pcon=5.1016 forget=1.4227 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 150 total=8.4533 mle=1.9554 pcon=5.0988 forget=1.3991 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 200 total=8.2770 mle=1.7874 pcon=5.0959 forget=1.3937 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 250 total=8.2096 mle=1.7155 pcon=5.0928 forget=1.4013 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 300 total=8.2842 mle=1.8001 pcon=5.0902 forget=1.3939 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 350 total=8.2352 mle=1.7382 pcon=5.0871 forget=1.4098 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 6 it 10 total=8.3860 mle=1.9009 pcon=5.0839 forget=1.4013 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 60 total=8.1601 mle=1.6957 pcon=5.0813 forget=1.3831 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 110 total=8.1229 mle=1.6664 pcon=5.0788 forget=1.3776 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 160 total=8.2216 mle=1.7502 pcon=5.0764 forget=1.3950 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 210 total=8.2964 mle=1.8401 pcon=5.0734 forget=1.3829 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 260 total=8.3774 mle=1.9182 pcon=5.0710 forget=1.3882 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 310 total=8.3627 mle=1.8855 pcon=5.0683 forget=1.4089 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 360 total=8.2491 mle=1.7967 pcon=5.0662 forget=1.3863 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 14%|█▍        | 7/50 [01:53<13:49, 19.30s/it] 16%|█▌        | 8/50 [02:15<14:08, 20.21s/it] 18%|█▊        | 9/50 [02:36<13:50, 20.26s/it] 20%|██        | 10/50 [02:55<13:22, 20.06s/it] 22%|██▏       | 11/50 [03:17<13:19, 20.50s/it] 24%|██▍       | 12/50 [03:37<12:50, 20.28s/it] 26%|██▌       | 13/50 [03:59<12:49, 20.80s/it] 28%|██▊       | 14/50 [04:32<14:45, 24.59s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 7 it 20 total=8.1649 mle=1.6981 pcon=5.0637 forget=1.4032 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 70 total=8.0091 mle=1.5602 pcon=5.0617 forget=1.3872 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 120 total=8.0506 mle=1.6355 pcon=5.0592 forget=1.3559 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 170 total=8.1336 mle=1.7033 pcon=5.0570 forget=1.3733 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 220 total=8.2959 mle=1.8493 pcon=5.0549 forget=1.3917 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 270 total=8.2143 mle=1.7792 pcon=5.0527 forget=1.3824 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 320 total=8.3029 mle=1.8621 pcon=5.0507 forget=1.3901 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 370 total=8.0248 mle=1.5858 pcon=5.0486 forget=1.3903 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 8 it 30 total=8.1948 mle=1.7239 pcon=5.0467 forget=1.4242 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 80 total=7.9580 mle=1.5442 pcon=5.0445 forget=1.3693 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 130 total=8.2205 mle=1.7860 pcon=5.0425 forget=1.3920 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 180 total=8.1193 mle=1.7035 pcon=5.0402 forget=1.3756 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 230 total=8.0505 mle=1.6569 pcon=5.0382 forget=1.3555 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 280 total=8.0248 mle=1.6262 pcon=5.0358 forget=1.3628 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 330 total=7.9086 mle=1.4993 pcon=5.0337 forget=1.3756 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 380 total=8.4101 mle=2.0014 pcon=5.0317 forget=1.3769 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 9 it 40 total=8.1284 mle=1.7485 pcon=5.0297 forget=1.3502 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 90 total=8.0429 mle=1.6575 pcon=5.0276 forget=1.3579 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 140 total=8.0199 mle=1.6068 pcon=5.0255 forget=1.3875 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 190 total=8.1203 mle=1.7539 pcon=5.0235 forget=1.3429 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 240 total=8.1875 mle=1.7747 pcon=5.0214 forget=1.3913 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 290 total=8.0270 mle=1.6605 pcon=5.0197 forget=1.3468 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 340 total=8.0576 mle=1.6890 pcon=5.0177 forget=1.3509 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 10 it 0 total=7.8121 mle=1.4430 pcon=5.0157 forget=1.3534 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 50 total=7.9857 mle=1.6281 pcon=5.0141 forget=1.3435 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 100 total=8.0961 mle=1.7328 pcon=5.0121 forget=1.3512 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 150 total=8.1067 mle=1.7523 pcon=5.0102 forget=1.3442 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 200 total=7.9430 mle=1.5850 pcon=5.0081 forget=1.3499 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 250 total=8.0002 mle=1.6119 pcon=5.0062 forget=1.3821 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 300 total=7.9237 mle=1.5598 pcon=5.0044 forget=1.3595 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 350 total=7.9533 mle=1.5918 pcon=5.0027 forget=1.3588 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 11 it 10 total=8.0788 mle=1.7016 pcon=5.0007 forget=1.3765 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 60 total=8.0127 mle=1.6512 pcon=4.9992 forget=1.3624 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 110 total=8.0003 mle=1.6281 pcon=4.9977 forget=1.3745 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 160 total=7.9502 mle=1.5927 pcon=4.9958 forget=1.3617 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 210 total=8.0677 mle=1.7043 pcon=4.9942 forget=1.3692 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 260 total=7.9964 mle=1.6248 pcon=4.9930 forget=1.3786 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 310 total=8.1455 mle=1.7754 pcon=4.9914 forget=1.3788 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 360 total=7.9821 mle=1.6023 pcon=4.9899 forget=1.3899 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 20 total=8.0317 mle=1.6250 pcon=4.9885 forget=1.4182 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 70 total=7.8734 mle=1.4835 pcon=4.9873 forget=1.4026 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 120 total=8.0352 mle=1.6382 pcon=4.9860 forget=1.4110 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 170 total=8.1147 mle=1.7008 pcon=4.9847 forget=1.4292 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 220 total=7.9592 mle=1.5588 pcon=4.9837 forget=1.4167 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 270 total=8.0987 mle=1.6936 pcon=4.9827 forget=1.4225 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 320 total=8.2826 mle=1.8547 pcon=4.9818 forget=1.4460 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 370 total=8.2949 mle=1.8804 pcon=4.9807 forget=1.4338 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 30 total=7.9824 mle=1.5547 pcon=4.9799 forget=1.4478 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 80 total=8.1267 mle=1.6890 pcon=4.9790 forget=1.4588 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 130 total=7.9647 mle=1.5161 pcon=4.9779 forget=1.4706 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 180 total=8.0292 mle=1.5465 pcon=4.9770 forget=1.5058 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 230 total=8.1448 mle=1.7027 pcon=4.9759 forget=1.4662 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 280 total=8.0222 mle=1.5659 pcon=4.9746 forget=1.4816 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 330 total=8.1274 mle=1.6744 pcon=4.9734 forget=1.4796 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 380 total=8.1778 mle=1.7235 pcon=4.9723 forget=1.4820 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 40 total=8.1523 mle=1.6822 pcon=4.9708 forget=1.4994 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 30%|███       | 15/50 [05:08<16:19, 27.99s/it] 32%|███▏      | 16/50 [05:43<17:06, 30.19s/it] 34%|███▍      | 17/50 [06:18<17:17, 31.44s/it] 36%|███▌      | 18/50 [06:52<17:17, 32.43s/it] 38%|███▊      | 19/50 [07:27<17:08, 33.18s/it] 40%|████      | 20/50 [08:02<16:52, 33.75s/it] 42%|████▏     | 21/50 [08:40<16:53, 34.95s/it][loss] ep 14 it 90 total=8.1212 mle=1.6694 pcon=4.9696 forget=1.4822 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 140 total=8.0222 mle=1.5563 pcon=4.9679 forget=1.4981 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 190 total=8.0221 mle=1.5637 pcon=4.9662 forget=1.4922 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 240 total=8.1082 mle=1.6613 pcon=4.9645 forget=1.4825 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 290 total=8.0850 mle=1.6155 pcon=4.9626 forget=1.5069 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 340 total=8.3223 mle=1.8476 pcon=4.9609 forget=1.5139 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 0 total=8.1469 mle=1.6925 pcon=4.9583 forget=1.4961 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 50 total=8.0714 mle=1.6363 pcon=4.9558 forget=1.4793 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 100 total=8.0870 mle=1.6930 pcon=4.9535 forget=1.4405 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 150 total=7.9752 mle=1.5496 pcon=4.9508 forget=1.4747 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 200 total=7.9275 mle=1.5403 pcon=4.9482 forget=1.4390 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 250 total=8.0442 mle=1.6470 pcon=4.9459 forget=1.4513 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 300 total=8.0637 mle=1.7182 pcon=4.9432 forget=1.4022 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 350 total=8.0970 mle=1.7929 pcon=4.9404 forget=1.3637 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 16 it 10 total=8.0286 mle=1.7581 pcon=4.9375 forget=1.3329 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 60 total=8.0178 mle=1.7638 pcon=4.9342 forget=1.3198 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 110 total=7.9028 mle=1.6623 pcon=4.9314 forget=1.3090 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 160 total=7.7140 mle=1.5530 pcon=4.9283 forget=1.2328 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 210 total=7.8424 mle=1.6157 pcon=4.9246 forget=1.3022 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 260 total=7.7114 mle=1.5028 pcon=4.9211 forget=1.2875 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 310 total=7.8691 mle=1.6794 pcon=4.9175 forget=1.2721 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 360 total=7.7381 mle=1.6707 pcon=4.9142 forget=1.1532 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 17 it 20 total=7.9050 mle=1.8127 pcon=4.9106 forget=1.1818 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 70 total=7.6191 mle=1.5155 pcon=4.9067 forget=1.1969 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 120 total=7.7064 mle=1.6462 pcon=4.9026 forget=1.1575 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 170 total=7.8328 mle=1.8113 pcon=4.8990 forget=1.1225 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 220 total=7.8254 mle=1.7738 pcon=4.8952 forget=1.1565 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 270 total=7.8368 mle=1.7871 pcon=4.8912 forget=1.1586 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 320 total=7.6964 mle=1.6206 pcon=4.8870 forget=1.1889 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 370 total=7.6826 mle=1.5481 pcon=4.8829 forget=1.2516 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 18 it 30 total=7.6193 mle=1.5253 pcon=4.8787 forget=1.2153 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 80 total=7.8110 mle=1.7961 pcon=4.8748 forget=1.1401 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 130 total=7.6598 mle=1.5751 pcon=4.8704 forget=1.2142 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 180 total=7.6848 mle=1.5675 pcon=4.8663 forget=1.2511 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 230 total=7.5816 mle=1.4954 pcon=4.8620 forget=1.2242 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 280 total=7.6258 mle=1.5665 pcon=4.8573 forget=1.2019 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 330 total=7.8858 mle=1.8118 pcon=4.8530 forget=1.2209 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 380 total=7.7228 mle=1.6932 pcon=4.8485 forget=1.1811 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 19 it 40 total=7.7180 mle=1.5931 pcon=4.8442 forget=1.2807 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 90 total=7.6334 mle=1.6082 pcon=4.8399 forget=1.1852 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 140 total=7.7183 mle=1.6605 pcon=4.8354 forget=1.2224 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 190 total=7.7719 mle=1.7272 pcon=4.8312 forget=1.2134 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 240 total=7.8525 mle=1.7999 pcon=4.8269 forget=1.2257 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 290 total=7.7088 mle=1.5796 pcon=4.8225 forget=1.3067 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 340 total=7.7802 mle=1.6876 pcon=4.8184 forget=1.2743 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 0 total=7.8773 mle=1.8027 pcon=4.8141 forget=1.2605 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 50 total=7.6846 mle=1.6145 pcon=4.8101 forget=1.2601 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 100 total=7.5761 mle=1.4810 pcon=4.8060 forget=1.2891 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 150 total=7.9200 mle=1.8533 pcon=4.8022 forget=1.2645 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 200 total=7.6923 mle=1.6440 pcon=4.7983 forget=1.2500 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 250 total=7.7400 mle=1.6884 pcon=4.7944 forget=1.2572 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 300 total=7.9279 mle=1.9092 pcon=4.7903 forget=1.2284 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 350 total=7.7420 mle=1.7028 pcon=4.7862 forget=1.2530 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 10 total=7.7263 mle=1.6900 pcon=4.7824 forget=1.2540 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 60 total=7.6092 mle=1.5720 pcon=4.7788 forget=1.2584 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 110 total=7.6546 mle=1.6146 pcon=4.7751 forget=1.2648 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 160 total=7.6024 mle=1.5633 pcon=4.7716 forget=1.2676 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 44%|████▍     | 22/50 [09:17<16:34, 35.50s/it] 46%|████▌     | 23/50 [09:51<15:50, 35.19s/it] 48%|████▊     | 24/50 [10:27<15:20, 35.41s/it] 50%|█████     | 25/50 [11:03<14:49, 35.59s/it] 52%|█████▏    | 26/50 [11:40<14:22, 35.96s/it] 54%|█████▍    | 27/50 [12:17<13:50, 36.12s/it] 56%|█████▌    | 28/50 [12:53<13:17, 36.23s/it] 58%|█████▊    | 29/50 [13:30<12:45, 36.44s/it][loss] ep 21 it 210 total=7.7110 mle=1.6545 pcon=4.7683 forget=1.2882 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 260 total=7.8367 mle=1.7904 pcon=4.7651 forget=1.2812 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 310 total=7.7309 mle=1.6720 pcon=4.7619 forget=1.2970 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 360 total=7.8343 mle=1.7547 pcon=4.7591 forget=1.3205 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 20 total=7.7195 mle=1.6534 pcon=4.7563 forget=1.3097 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 70 total=7.5564 mle=1.4857 pcon=4.7536 forget=1.3171 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 120 total=7.5899 mle=1.4951 pcon=4.7511 forget=1.3436 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 170 total=7.6869 mle=1.6014 pcon=4.7487 forget=1.3368 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 220 total=7.8792 mle=1.7920 pcon=4.7464 forget=1.3408 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 270 total=7.8444 mle=1.7485 pcon=4.7439 forget=1.3520 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 320 total=7.7335 mle=1.6289 pcon=4.7418 forget=1.3629 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 370 total=7.8543 mle=1.7480 pcon=4.7396 forget=1.3667 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 30 total=7.9482 mle=1.8301 pcon=4.7377 forget=1.3805 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 80 total=7.7554 mle=1.6428 pcon=4.7357 forget=1.3769 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 130 total=7.8275 mle=1.7207 pcon=4.7337 forget=1.3731 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 180 total=7.8075 mle=1.6975 pcon=4.7319 forget=1.3781 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 230 total=7.8576 mle=1.7485 pcon=4.7301 forget=1.3789 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 280 total=7.7825 mle=1.6512 pcon=4.7284 forget=1.4029 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 330 total=7.9617 mle=1.8580 pcon=4.7267 forget=1.3769 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 380 total=7.7138 mle=1.5977 pcon=4.7253 forget=1.3908 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 40 total=7.7623 mle=1.6428 pcon=4.7237 forget=1.3959 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 90 total=7.8558 mle=1.7468 pcon=4.7220 forget=1.3870 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 140 total=7.8732 mle=1.7592 pcon=4.7203 forget=1.3937 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 190 total=7.8258 mle=1.7098 pcon=4.7187 forget=1.3972 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 240 total=7.8118 mle=1.6992 pcon=4.7173 forget=1.3953 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 290 total=7.6227 mle=1.4959 pcon=4.7159 forget=1.4108 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 340 total=7.6404 mle=1.5365 pcon=4.7147 forget=1.3891 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 0 total=7.7754 mle=1.6532 pcon=4.7133 forget=1.4089 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 50 total=7.8475 mle=1.7342 pcon=4.7121 forget=1.4012 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 100 total=7.6565 mle=1.5478 pcon=4.7108 forget=1.3979 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 150 total=7.8145 mle=1.7158 pcon=4.7096 forget=1.3891 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 200 total=8.0701 mle=1.9509 pcon=4.7083 forget=1.4109 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 250 total=7.9183 mle=1.8315 pcon=4.7070 forget=1.3798 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 300 total=7.6226 mle=1.5237 pcon=4.7058 forget=1.3931 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 350 total=7.7042 mle=1.5966 pcon=4.7048 forget=1.4029 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 10 total=7.8197 mle=1.7406 pcon=4.7036 forget=1.3755 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 60 total=7.7646 mle=1.6674 pcon=4.7023 forget=1.3948 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 110 total=7.6976 mle=1.6274 pcon=4.7014 forget=1.3688 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 160 total=7.7338 mle=1.6692 pcon=4.7004 forget=1.3642 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 210 total=7.7311 mle=1.6684 pcon=4.6995 forget=1.3631 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 260 total=7.6551 mle=1.6116 pcon=4.6985 forget=1.3449 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 310 total=7.7023 mle=1.6533 pcon=4.6976 forget=1.3514 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 360 total=7.6790 mle=1.6034 pcon=4.6964 forget=1.3792 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 20 total=7.7333 mle=1.6835 pcon=4.6954 forget=1.3544 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 70 total=7.6586 mle=1.6164 pcon=4.6945 forget=1.3477 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 120 total=7.6512 mle=1.6144 pcon=4.6935 forget=1.3434 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 170 total=7.6914 mle=1.6564 pcon=4.6925 forget=1.3425 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 220 total=7.7251 mle=1.6934 pcon=4.6916 forget=1.3401 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 270 total=7.8216 mle=1.7931 pcon=4.6905 forget=1.3380 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 320 total=7.5434 mle=1.5174 pcon=4.6898 forget=1.3362 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 370 total=7.7325 mle=1.7139 pcon=4.6888 forget=1.3298 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 28 it 30 total=7.6765 mle=1.6591 pcon=4.6879 forget=1.3295 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 80 total=7.7469 mle=1.7354 pcon=4.6869 forget=1.3247 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 130 total=7.5945 mle=1.5794 pcon=4.6859 forget=1.3292 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 180 total=7.5673 mle=1.5459 pcon=4.6850 forget=1.3364 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 230 total=7.7490 mle=1.7396 pcon=4.6842 forget=1.3252 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 280 total=7.7178 mle=1.7223 pcon=4.6833 forget=1.3122 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 330 total=7.7542 mle=1.7479 pcon=4.6823 forget=1.3240 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 380 total=7.7716 mle=1.7719 pcon=4.6813 forget=1.3183 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 29 it 40 total=7.6409 mle=1.6418 pcon=4.6805 forget=1.3186 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 60%|██████    | 30/50 [14:06<12:06, 36.30s/it] 62%|██████▏   | 31/50 [14:41<11:21, 35.88s/it] 64%|██████▍   | 32/50 [15:16<10:43, 35.73s/it] 66%|██████▌   | 33/50 [15:52<10:09, 35.85s/it] 68%|██████▊   | 34/50 [16:44<10:47, 40.50s/it] 70%|███████   | 35/50 [17:35<10:55, 43.71s/it] 72%|███████▏  | 36/50 [18:23<10:30, 45.04s/it][loss] ep 29 it 90 total=7.6650 mle=1.6748 pcon=4.6797 forget=1.3105 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 140 total=7.9264 mle=1.9381 pcon=4.6788 forget=1.3095 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 190 total=7.4897 mle=1.4932 pcon=4.6780 forget=1.3184 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 240 total=7.6450 mle=1.6598 pcon=4.6772 forget=1.3079 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 290 total=7.5689 mle=1.5813 pcon=4.6763 forget=1.3113 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 340 total=7.6710 mle=1.6849 pcon=4.6754 forget=1.3108 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 30 it 0 total=7.8343 mle=1.8529 pcon=4.6745 forget=1.3069 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 50 total=7.5014 mle=1.5090 pcon=4.6737 forget=1.3187 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 100 total=7.6280 mle=1.6480 pcon=4.6729 forget=1.3071 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 150 total=7.7233 mle=1.7330 pcon=4.6723 forget=1.3180 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 200 total=7.6120 mle=1.6212 pcon=4.6716 forget=1.3193 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 250 total=7.7918 mle=1.8070 pcon=4.6709 forget=1.3139 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 300 total=7.6456 mle=1.6581 pcon=4.6701 forget=1.3174 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 350 total=7.5604 mle=1.5709 pcon=4.6691 forget=1.3204 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[loss] ep 31 it 10 total=7.8693 mle=1.8749 pcon=4.6685 forget=1.3258 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 60 total=7.5629 mle=1.5750 pcon=4.6678 forget=1.3201 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 110 total=7.5471 mle=1.5519 pcon=4.6670 forget=1.3281 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 160 total=7.6235 mle=1.6247 pcon=4.6665 forget=1.3323 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 210 total=7.5830 mle=1.5753 pcon=4.6658 forget=1.3419 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 260 total=7.6359 mle=1.6260 pcon=4.6653 forget=1.3447 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 310 total=7.8061 mle=1.7977 pcon=4.6645 forget=1.3439 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 360 total=7.6501 mle=1.6380 pcon=4.6640 forget=1.3482 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 20 total=7.7239 mle=1.7087 pcon=4.6632 forget=1.3520 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 70 total=7.6562 mle=1.6399 pcon=4.6626 forget=1.3536 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 120 total=7.9731 mle=1.9471 pcon=4.6620 forget=1.3639 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 170 total=7.7776 mle=1.7662 pcon=4.6614 forget=1.3500 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 220 total=7.6691 mle=1.6397 pcon=4.6607 forget=1.3687 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 270 total=7.7806 mle=1.7490 pcon=4.6602 forget=1.3714 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 320 total=7.8149 mle=1.7836 pcon=4.6597 forget=1.3716 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 370 total=7.6979 mle=1.6578 pcon=4.6592 forget=1.3808 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 30 total=7.5989 mle=1.5647 pcon=4.6586 forget=1.3755 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 80 total=7.6106 mle=1.5642 pcon=4.6581 forget=1.3884 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 130 total=7.7106 mle=1.6589 pcon=4.6574 forget=1.3943 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 180 total=7.7615 mle=1.7020 pcon=4.6569 forget=1.4027 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 230 total=7.6956 mle=1.6427 pcon=4.6565 forget=1.3965 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 280 total=7.7797 mle=1.7218 pcon=4.6560 forget=1.4020 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 330 total=7.7438 mle=1.6864 pcon=4.6555 forget=1.4018 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 380 total=7.5538 mle=1.4951 pcon=4.6551 forget=1.4036 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 40 total=7.7698 mle=1.7070 pcon=4.6547 forget=1.4081 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 90 total=7.8019 mle=1.7261 pcon=4.6543 forget=1.4215 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 140 total=7.6922 mle=1.6148 pcon=4.6537 forget=1.4237 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 190 total=7.9119 mle=1.8398 pcon=4.6533 forget=1.4188 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 240 total=7.8424 mle=1.7490 pcon=4.6528 forget=1.4405 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 290 total=7.8997 mle=1.8205 pcon=4.6524 forget=1.4268 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 340 total=7.7217 mle=1.6354 pcon=4.6520 forget=1.4343 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 0 total=7.7618 mle=1.6731 pcon=4.6516 forget=1.4371 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 50 total=7.8554 mle=1.7674 pcon=4.6513 forget=1.4367 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 100 total=7.7823 mle=1.6923 pcon=4.6508 forget=1.4392 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 150 total=7.9534 mle=1.8507 pcon=4.6504 forget=1.4524 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 200 total=7.7975 mle=1.6911 pcon=4.6499 forget=1.4565 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 250 total=7.6477 mle=1.5358 pcon=4.6496 forget=1.4623 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 300 total=7.7454 mle=1.6314 pcon=4.6492 forget=1.4647 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 350 total=7.7688 mle=1.6368 pcon=4.6489 forget=1.4831 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 10 total=7.8007 mle=1.6819 pcon=4.6485 forget=1.4703 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 60 total=7.7527 mle=1.6255 pcon=4.6482 forget=1.4790 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 110 total=7.8983 mle=1.7888 pcon=4.6478 forget=1.4617 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 160 total=7.8450 mle=1.7206 pcon=4.6474 forget=1.4769 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 210 total=7.9222 mle=1.7973 pcon=4.6470 forget=1.4779 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 260 total=7.9199 mle=1.7780 pcon=4.6468 forget=1.4951 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 310 total=7.7069 mle=1.5701 pcon=4.6466 forget=1.4902 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 74%|███████▍  | 37/50 [19:10<09:52, 45.61s/it] 76%|███████▌  | 38/50 [20:01<09:26, 47.17s/it] 78%|███████▊  | 39/50 [20:51<08:50, 48.18s/it] 80%|████████  | 40/50 [21:43<08:12, 49.22s/it] 82%|████████▏ | 41/50 [22:29<07:14, 48.32s/it] 84%|████████▍ | 42/50 [23:20<06:31, 48.96s/it] 86%|████████▌ | 43/50 [24:09<05:42, 48.99s/it] 88%|████████▊ | 44/50 [24:57<04:52, 48.75s/it][loss] ep 36 it 360 total=7.7773 mle=1.6422 pcon=4.6464 forget=1.4888 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 20 total=7.7777 mle=1.6367 pcon=4.6462 forget=1.4948 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 70 total=7.7492 mle=1.6125 pcon=4.6459 forget=1.4908 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 120 total=7.7774 mle=1.6354 pcon=4.6457 forget=1.4963 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 170 total=7.7356 mle=1.5864 pcon=4.6454 forget=1.5038 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 220 total=7.8367 mle=1.6933 pcon=4.6453 forget=1.4982 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 270 total=7.8135 mle=1.6843 pcon=4.6450 forget=1.4842 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 320 total=7.7674 mle=1.6235 pcon=4.6449 forget=1.4989 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 370 total=7.8035 mle=1.6409 pcon=4.6448 forget=1.5178 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 30 total=7.6276 mle=1.4863 pcon=4.6448 forget=1.4965 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 80 total=7.8775 mle=1.7267 pcon=4.6444 forget=1.5064 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 130 total=7.9251 mle=1.7734 pcon=4.6442 forget=1.5075 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 180 total=7.7442 mle=1.5754 pcon=4.6440 forget=1.5248 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 230 total=7.6911 mle=1.5381 pcon=4.6438 forget=1.5092 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 280 total=7.8846 mle=1.7051 pcon=4.6437 forget=1.5357 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 330 total=7.8185 mle=1.6338 pcon=4.6436 forget=1.5411 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 380 total=8.0142 mle=1.8460 pcon=4.6436 forget=1.5246 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 40 total=7.7498 mle=1.5822 pcon=4.6435 forget=1.5242 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 90 total=7.7802 mle=1.6194 pcon=4.6433 forget=1.5175 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 140 total=7.8401 mle=1.6594 pcon=4.6433 forget=1.5375 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 190 total=7.8300 mle=1.6563 pcon=4.6431 forget=1.5306 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 240 total=8.0276 mle=1.8524 pcon=4.6431 forget=1.5321 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 290 total=7.7550 mle=1.5745 pcon=4.6430 forget=1.5376 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 340 total=7.8130 mle=1.6283 pcon=4.6432 forget=1.5415 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 0 total=7.7893 mle=1.6095 pcon=4.6432 forget=1.5367 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 50 total=7.8287 mle=1.6467 pcon=4.6430 forget=1.5390 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 100 total=7.8432 mle=1.6629 pcon=4.6429 forget=1.5375 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 150 total=7.7647 mle=1.5667 pcon=4.6428 forget=1.5551 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 200 total=8.0039 mle=1.7909 pcon=4.6426 forget=1.5704 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 250 total=8.1438 mle=1.9537 pcon=4.6425 forget=1.5476 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 300 total=7.9446 mle=1.7441 pcon=4.6424 forget=1.5581 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 350 total=8.0009 mle=1.8069 pcon=4.6423 forget=1.5517 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 10 total=7.8762 mle=1.6760 pcon=4.6421 forget=1.5581 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 60 total=7.9414 mle=1.7482 pcon=4.6421 forget=1.5512 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 110 total=7.8806 mle=1.6761 pcon=4.6418 forget=1.5627 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 160 total=7.9785 mle=1.7965 pcon=4.6418 forget=1.5402 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 210 total=7.8167 mle=1.6199 pcon=4.6417 forget=1.5551 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 260 total=7.9514 mle=1.7465 pcon=4.6414 forget=1.5635 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 310 total=7.7216 mle=1.5146 pcon=4.6413 forget=1.5657 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 360 total=7.8725 mle=1.6749 pcon=4.6410 forget=1.5566 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 20 total=7.8069 mle=1.5926 pcon=4.6409 forget=1.5734 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 70 total=7.7446 mle=1.5472 pcon=4.6408 forget=1.5565 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 120 total=8.0311 mle=1.8206 pcon=4.6408 forget=1.5697 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 170 total=7.9487 mle=1.7461 pcon=4.6406 forget=1.5620 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 220 total=7.7730 mle=1.5600 pcon=4.6406 forget=1.5724 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 270 total=8.0713 mle=1.8683 pcon=4.6405 forget=1.5624 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 320 total=7.8477 mle=1.6483 pcon=4.6403 forget=1.5591 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 370 total=7.7630 mle=1.5522 pcon=4.6403 forget=1.5705 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 30 total=7.8779 mle=1.6681 pcon=4.6403 forget=1.5695 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 80 total=7.8388 mle=1.6380 pcon=4.6403 forget=1.5605 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 130 total=7.9690 mle=1.7567 pcon=4.6401 forget=1.5722 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 180 total=7.8725 mle=1.6684 pcon=4.6400 forget=1.5641 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 230 total=7.8039 mle=1.6047 pcon=4.6401 forget=1.5592 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 280 total=7.8347 mle=1.6347 pcon=4.6401 forget=1.5600 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 330 total=7.7294 mle=1.5132 pcon=4.6400 forget=1.5763 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 380 total=7.8839 mle=1.6732 pcon=4.6398 forget=1.5709 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 40 total=8.1138 mle=1.8813 pcon=4.6398 forget=1.5927 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 90 total=7.6828 mle=1.4864 pcon=4.6398 forget=1.5566 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 140 total=7.9905 mle=1.7606 pcon=4.6398 forget=1.5901 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 190 total=7.9889 mle=1.7760 pcon=4.6399 forget=1.5730 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 240 total=7.8633 mle=1.6367 pcon=4.6399 forget=1.5866 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 290 total=7.9111 mle=1.6855 pcon=4.6397 forget=1.5858 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 90%|█████████ | 45/50 [25:46<04:04, 48.88s/it] 92%|█████████▏| 46/50 [26:34<03:13, 48.48s/it] 94%|█████████▍| 47/50 [27:24<02:26, 48.93s/it] 96%|█████████▌| 48/50 [28:13<01:38, 49.00s/it] 98%|█████████▊| 49/50 [29:00<00:48, 48.38s/it]100%|██████████| 50/50 [29:46<00:00, 47.82s/it]100%|██████████| 50/50 [29:46<00:00, 35.74s/it]
[loss] ep 44 it 340 total=7.8966 mle=1.6654 pcon=4.6396 forget=1.5916 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 0 total=7.8910 mle=1.6638 pcon=4.6398 forget=1.5874 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 50 total=7.9139 mle=1.6935 pcon=4.6397 forget=1.5807 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 100 total=7.8852 mle=1.6529 pcon=4.6397 forget=1.5926 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 150 total=7.8835 mle=1.6732 pcon=4.6397 forget=1.5706 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 200 total=7.7608 mle=1.5440 pcon=4.6396 forget=1.5772 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 250 total=7.8977 mle=1.6634 pcon=4.6397 forget=1.5946 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 300 total=7.8233 mle=1.6040 pcon=4.6398 forget=1.5794 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 350 total=8.0008 mle=1.7705 pcon=4.6397 forget=1.5905 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 10 total=7.8995 mle=1.6752 pcon=4.6396 forget=1.5846 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 60 total=8.0322 mle=1.8034 pcon=4.6397 forget=1.5891 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 110 total=7.9380 mle=1.7149 pcon=4.6398 forget=1.5833 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 160 total=7.8287 mle=1.5996 pcon=4.6396 forget=1.5895 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 210 total=7.8243 mle=1.5873 pcon=4.6396 forget=1.5974 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 260 total=7.8970 mle=1.6554 pcon=4.6394 forget=1.6023 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 310 total=7.9515 mle=1.7161 pcon=4.6393 forget=1.5960 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 360 total=7.7607 mle=1.5203 pcon=4.6393 forget=1.6011 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 20 total=8.1067 mle=1.8714 pcon=4.6395 forget=1.5959 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 70 total=7.7974 mle=1.5626 pcon=4.6395 forget=1.5953 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 120 total=7.8950 mle=1.6533 pcon=4.6397 forget=1.6020 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 170 total=7.9880 mle=1.7461 pcon=4.6395 forget=1.6025 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 220 total=7.9490 mle=1.7159 pcon=4.6394 forget=1.5936 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 270 total=7.9248 mle=1.6814 pcon=4.6394 forget=1.6040 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 320 total=7.8729 mle=1.6214 pcon=4.6393 forget=1.6122 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 370 total=7.9806 mle=1.7318 pcon=4.6393 forget=1.6095 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 30 total=7.9193 mle=1.6661 pcon=4.6393 forget=1.6139 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 80 total=7.9499 mle=1.7219 pcon=4.6393 forget=1.5887 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 130 total=7.7792 mle=1.5335 pcon=4.6393 forget=1.6064 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 180 total=7.8721 mle=1.6279 pcon=4.6393 forget=1.6049 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 230 total=7.9693 mle=1.7115 pcon=4.6394 forget=1.6184 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 280 total=7.9105 mle=1.6591 pcon=4.6394 forget=1.6120 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 330 total=7.9183 mle=1.6674 pcon=4.6394 forget=1.6115 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 380 total=7.8541 mle=1.6042 pcon=4.6395 forget=1.6104 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 40 total=7.9915 mle=1.7486 pcon=4.6397 forget=1.6031 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 90 total=8.0289 mle=1.7639 pcon=4.6398 forget=1.6251 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 140 total=8.1190 mle=1.8615 pcon=4.6399 forget=1.6176 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 190 total=8.0013 mle=1.7541 pcon=4.6401 forget=1.6071 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 240 total=7.9025 mle=1.6431 pcon=4.6401 forget=1.6194 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 290 total=7.8608 mle=1.6063 pcon=4.6401 forget=1.6144 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 340 total=8.0406 mle=1.7800 pcon=4.6400 forget=1.6206 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage1-inc1: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:42,  1.75it/s]  2%|▏         | 8/391 [00:00<00:26, 14.63it/s]  3%|▎         | 13/391 [00:00<00:17, 21.42it/s]  5%|▍         | 18/391 [00:00<00:13, 27.71it/s]  6%|▌         | 23/391 [00:01<00:11, 32.66it/s]  8%|▊         | 30/391 [00:01<00:08, 41.98it/s] 10%|▉         | 39/391 [00:01<00:06, 54.07it/s] 12%|█▏        | 46/391 [00:01<00:06, 52.74it/s] 13%|█▎        | 52/391 [00:01<00:06, 51.78it/s] 15%|█▍        | 58/391 [00:01<00:06, 50.93it/s] 17%|█▋        | 65/391 [00:01<00:05, 55.45it/s] 18%|█▊        | 72/391 [00:01<00:05, 57.42it/s] 20%|█▉        | 78/391 [00:01<00:05, 52.79it/s] 21%|██▏       | 84/391 [00:02<00:06, 51.00it/s] 23%|██▎       | 90/391 [00:02<00:05, 51.00it/s] 25%|██▌       | 99/391 [00:02<00:04, 59.37it/s] 27%|██▋       | 107/391 [00:02<00:04, 62.29it/s] 29%|██▉       | 114/391 [00:02<00:04, 55.79it/s] 31%|███       | 121/391 [00:02<00:04, 56.76it/s] 32%|███▏      | 127/391 [00:02<00:04, 53.60it/s] 34%|███▍      | 134/391 [00:02<00:04, 57.60it/s] 36%|███▋      | 142/391 [00:03<00:04, 61.96it/s] 38%|███▊      | 150/391 [00:03<00:03, 62.93it/s] 40%|████      | 157/391 [00:03<00:04, 56.54it/s] 42%|████▏     | 164/391 [00:03<00:03, 56.80it/s] 44%|████▎     | 171/391 [00:03<00:03, 57.86it/s] 46%|████▌     | 179/391 [00:03<00:03, 61.79it/s] 48%|████▊     | 188/391 [00:03<00:03, 67.19it/s] 50%|████▉     | 195/391 [00:03<00:03, 58.51it/s] 52%|█████▏    | 202/391 [00:04<00:03, 60.56it/s] 53%|█████▎    | 209/391 [00:04<00:03, 56.55it/s] 55%|█████▌    | 217/391 [00:04<00:02, 61.28it/s] 58%|█████▊    | 225/391 [00:04<00:02, 65.96it/s] 59%|█████▉    | 232/391 [00:04<00:02, 62.92it/s] 61%|██████    | 239/391 [00:04<00:02, 56.48it/s] 63%|██████▎   | 245/391 [00:04<00:02, 56.22it/s] 64%|██████▍   | 252/391 [00:04<00:02, 59.64it/s] 66%|██████▌   | 259/391 [00:05<00:02, 59.96it/s] 68%|██████▊   | 266/391 [00:05<00:02, 61.88it/s] 70%|██████▉   | 273/391 [00:05<00:02, 55.33it/s] 72%|███████▏  | 280/391 [00:05<00:01, 56.69it/s] 73%|███████▎  | 286/391 [00:05<00:01, 54.86it/s] 75%|███████▌  | 294/391 [00:05<00:01, 60.74it/s] 77%|███████▋  | 301/391 [00:05<00:01, 62.84it/s] 79%|███████▉  | 308/391 [00:05<00:01, 56.50it/s] 80%|████████  | 314/391 [00:05<00:01, 56.67it/s] 82%|████████▏ | 320/391 [00:06<00:01, 54.70it/s] 84%|████████▍ | 328/391 [00:06<00:01, 60.19it/s] 86%|████████▌ | 335/391 [00:06<00:00, 61.11it/s] 87%|████████▋ | 342/391 [00:06<00:00, 58.78it/s] 89%|████████▉ | 348/391 [00:06<00:00, 54.53it/s] 91%|█████████ | 354/391 [00:06<00:00, 55.48it/s] 92%|█████████▏| 361/391 [00:06<00:00, 58.88it/s] 95%|█████████▍| 370/391 [00:06<00:00, 67.06it/s] 97%|█████████▋| 379/391 [00:07<00:00, 69.98it/s] 99%|█████████▉| 388/391 [00:07<00:00, 73.97it/s]100%|██████████| 391/391 [00:07<00:00, 54.58it/s]
50000 images processed, 7.298109531402588 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:55,  1.41it/s]  6%|▋         | 5/79 [00:00<00:09,  7.69it/s] 13%|█▎        | 10/79 [00:00<00:04, 15.41it/s] 20%|██        | 16/79 [00:01<00:02, 23.76it/s] 29%|██▉       | 23/79 [00:01<00:01, 33.47it/s] 39%|███▉      | 31/79 [00:01<00:01, 43.56it/s] 48%|████▊     | 38/79 [00:01<00:00, 48.01it/s] 56%|█████▌    | 44/79 [00:01<00:00, 46.50it/s] 63%|██████▎   | 50/79 [00:01<00:00, 49.53it/s] 71%|███████   | 56/79 [00:01<00:00, 50.55it/s] 81%|████████  | 64/79 [00:01<00:00, 56.85it/s] 91%|█████████ | 72/79 [00:01<00:00, 63.00it/s]100%|██████████| 79/79 [00:02<00:00, 63.63it/s]100%|██████████| 79/79 [00:02<00:00, 38.30it/s]
10000 images processed, 2.1022017002105713 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage1-inc1/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:45,  1.23it/s]  3%|▎         | 6/204 [00:00<00:23,  8.38it/s]  7%|▋         | 14/204 [00:01<00:09, 20.62it/s] 11%|█         | 22/204 [00:01<00:05, 31.95it/s] 14%|█▎        | 28/204 [00:01<00:04, 35.36it/s] 17%|█▋        | 34/204 [00:01<00:04, 38.58it/s] 21%|██        | 42/204 [00:01<00:03, 47.20it/s] 24%|██▎       | 48/204 [00:01<00:03, 48.80it/s] 28%|██▊       | 57/204 [00:01<00:02, 57.60it/s] 31%|███▏      | 64/204 [00:01<00:02, 54.57it/s] 34%|███▍      | 70/204 [00:02<00:02, 52.17it/s] 37%|███▋      | 76/204 [00:02<00:02, 54.08it/s] 40%|████      | 82/204 [00:02<00:02, 50.09it/s] 44%|████▎     | 89/204 [00:02<00:02, 53.76it/s] 47%|████▋     | 95/204 [00:02<00:02, 48.85it/s] 50%|████▉     | 101/204 [00:02<00:02, 50.88it/s] 52%|█████▏    | 107/204 [00:02<00:01, 52.93it/s] 56%|█████▌    | 114/204 [00:02<00:01, 54.94it/s] 60%|█████▉    | 122/204 [00:02<00:01, 60.15it/s] 63%|██████▎   | 129/204 [00:03<00:01, 56.99it/s] 66%|██████▌   | 135/204 [00:03<00:01, 54.46it/s] 70%|██████▉   | 142/204 [00:03<00:01, 56.93it/s] 73%|███████▎  | 149/204 [00:03<00:00, 59.14it/s] 76%|███████▋  | 156/204 [00:03<00:00, 61.93it/s] 80%|███████▉  | 163/204 [00:03<00:00, 61.51it/s] 83%|████████▎ | 170/204 [00:03<00:00, 52.54it/s] 86%|████████▋ | 176/204 [00:03<00:00, 51.39it/s] 91%|█████████ | 185/204 [00:04<00:00, 59.45it/s] 94%|█████████▍| 192/204 [00:04<00:00, 60.55it/s] 99%|█████████▊| 201/204 [00:04<00:00, 66.33it/s]100%|██████████| 204/204 [00:04<00:00, 47.12it/s]
26032 images processed, 4.369366645812988 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:01<01:36,  1.23s/it]  9%|▉         | 7/79 [00:01<00:10,  6.94it/s] 20%|██        | 16/79 [00:01<00:03, 17.43it/s] 28%|██▊       | 22/79 [00:01<00:02, 20.27it/s] 35%|███▌      | 28/79 [00:01<00:01, 26.33it/s] 42%|████▏     | 33/79 [00:01<00:01, 27.21it/s] 48%|████▊     | 38/79 [00:02<00:01, 30.54it/s] 57%|█████▋    | 45/79 [00:02<00:00, 37.44it/s] 66%|██████▌   | 52/79 [00:02<00:00, 43.85it/s] 73%|███████▎  | 58/79 [00:02<00:00, 38.09it/s] 81%|████████  | 64/79 [00:02<00:00, 40.96it/s] 89%|████████▊ | 70/79 [00:02<00:00, 44.71it/s]100%|██████████| 79/79 [00:02<00:00, 28.13it/s]
10000 images processed, 2.8671488761901855 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:59,  1.31it/s]  8%|▊         | 6/79 [00:00<00:08,  8.74it/s] 16%|█▋        | 13/79 [00:00<00:03, 19.46it/s] 24%|██▍       | 19/79 [00:01<00:02, 27.04it/s] 34%|███▍      | 27/79 [00:01<00:01, 38.21it/s] 44%|████▍     | 35/79 [00:01<00:00, 46.71it/s] 53%|█████▎    | 42/79 [00:01<00:00, 45.03it/s] 65%|██████▍   | 51/79 [00:01<00:00, 54.29it/s] 73%|███████▎  | 58/79 [00:01<00:00, 54.16it/s] 85%|████████▍ | 67/79 [00:01<00:00, 62.67it/s] 96%|█████████▌| 76/79 [00:01<00:00, 69.31it/s]100%|██████████| 79/79 [00:01<00:00, 40.38it/s]
10000 images processed, 1.9844326972961426 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:54,  1.26it/s]  9%|▊         | 6/70 [00:00<00:07,  8.43it/s] 19%|█▊        | 13/70 [00:01<00:03, 18.41it/s] 30%|███       | 21/70 [00:01<00:01, 29.77it/s] 40%|████      | 28/70 [00:01<00:01, 36.91it/s] 49%|████▊     | 34/70 [00:01<00:00, 37.67it/s] 59%|█████▊    | 41/70 [00:01<00:00, 44.35it/s] 67%|██████▋   | 47/70 [00:01<00:00, 44.84it/s] 80%|████████  | 56/70 [00:01<00:00, 55.57it/s] 93%|█████████▎| 65/70 [00:01<00:00, 64.06it/s]100%|██████████| 70/70 [00:01<00:00, 36.45it/s]
8925 images processed, 1.9623308181762695 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:51,  1.17s/it]  4%|▍         | 2/45 [00:01<00:26,  1.64it/s] 16%|█▌        | 7/45 [00:01<00:05,  7.22it/s] 29%|██▉       | 13/45 [00:01<00:02, 14.53it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.35it/s] 44%|████▍     | 20/45 [00:02<00:02, 10.88it/s] 51%|█████     | 23/45 [00:02<00:01, 11.43it/s] 67%|██████▋   | 30/45 [00:02<00:00, 19.22it/s] 76%|███████▌  | 34/45 [00:03<00:00, 11.06it/s] 89%|████████▉ | 40/45 [00:03<00:00, 15.77it/s]100%|██████████| 45/45 [00:03<00:00, 12.48it/s]
5640 images processed, 3.6388070583343506 seconds used

26.366758108139038
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.46  98.78
places365     72.66  79.74
LSUN          27.04  94.18
iSUN          76.25  79.49
dtd           47.20  89.36
AVG           45.72  88.31
Retain-Acc: 0.7387
Forget-as-OOD (retain known vs forget novel):
  FPR: 38.00 AUROC: 88.86 AUIN: 99.23
58.00896072387695
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage1-inc1_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage1-inc1_rf.png
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage1-seen: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<05:19,  1.22it/s]  2%|▏         | 8/391 [00:00<00:34, 11.18it/s]  4%|▍         | 15/391 [00:01<00:17, 20.91it/s]  6%|▌         | 22/391 [00:01<00:12, 30.26it/s]  7%|▋         | 29/391 [00:01<00:09, 37.63it/s]  9%|▉         | 35/391 [00:01<00:09, 39.03it/s] 11%|█         | 42/391 [00:01<00:07, 45.62it/s] 12%|█▏        | 48/391 [00:01<00:07, 47.59it/s] 14%|█▍        | 56/391 [00:01<00:06, 55.42it/s] 16%|█▋        | 64/391 [00:01<00:05, 59.27it/s] 18%|█▊        | 71/391 [00:02<00:05, 53.91it/s] 20%|█▉        | 77/391 [00:02<00:05, 54.07it/s] 21%|██        | 83/391 [00:02<00:06, 50.15it/s] 23%|██▎       | 91/391 [00:02<00:05, 56.48it/s] 25%|██▌       | 98/391 [00:02<00:05, 56.15it/s] 27%|██▋       | 104/391 [00:02<00:05, 51.85it/s] 29%|██▊       | 112/391 [00:02<00:04, 56.93it/s] 30%|███       | 118/391 [00:02<00:04, 56.98it/s] 32%|███▏      | 125/391 [00:02<00:04, 58.13it/s] 34%|███▎      | 131/391 [00:03<00:04, 55.27it/s] 35%|███▌      | 137/391 [00:03<00:05, 50.42it/s] 37%|███▋      | 145/391 [00:03<00:04, 54.82it/s] 39%|███▉      | 152/391 [00:03<00:04, 57.75it/s] 41%|████      | 161/391 [00:03<00:03, 63.85it/s] 43%|████▎     | 169/391 [00:03<00:03, 66.12it/s] 45%|████▌     | 176/391 [00:03<00:03, 66.88it/s] 47%|████▋     | 183/391 [00:03<00:03, 58.38it/s] 49%|████▊     | 190/391 [00:04<00:03, 60.71it/s] 50%|█████     | 197/391 [00:04<00:03, 54.29it/s] 53%|█████▎    | 206/391 [00:04<00:03, 61.37it/s] 54%|█████▍    | 213/391 [00:04<00:02, 62.16it/s] 56%|█████▋    | 220/391 [00:04<00:03, 55.53it/s] 58%|█████▊    | 227/391 [00:04<00:02, 57.11it/s] 60%|█████▉    | 233/391 [00:04<00:02, 54.11it/s] 62%|██████▏   | 241/391 [00:04<00:02, 58.86it/s] 64%|██████▍   | 250/391 [00:05<00:02, 65.11it/s] 66%|██████▌   | 257/391 [00:05<00:02, 61.64it/s] 68%|██████▊   | 264/391 [00:05<00:02, 56.58it/s] 69%|██████▉   | 270/391 [00:05<00:02, 56.37it/s] 71%|███████   | 276/391 [00:05<00:02, 56.49it/s] 73%|███████▎  | 285/391 [00:05<00:01, 63.66it/s] 75%|███████▌  | 294/391 [00:05<00:01, 69.15it/s] 77%|███████▋  | 303/391 [00:05<00:01, 73.26it/s] 80%|███████▉  | 311/391 [00:06<00:01, 62.27it/s] 81%|████████▏ | 318/391 [00:06<00:01, 60.69it/s] 83%|████████▎ | 325/391 [00:06<00:01, 58.88it/s] 85%|████████▌ | 334/391 [00:06<00:00, 65.62it/s] 88%|████████▊ | 343/391 [00:06<00:00, 70.78it/s] 90%|████████▉ | 351/391 [00:06<00:00, 69.13it/s] 92%|█████████▏| 359/391 [00:06<00:00, 57.84it/s] 94%|█████████▎| 366/391 [00:06<00:00, 54.65it/s] 96%|█████████▌| 375/391 [00:07<00:00, 61.64it/s] 98%|█████████▊| 383/391 [00:07<00:00, 65.40it/s]100%|██████████| 391/391 [00:07<00:00, 68.09it/s]100%|██████████| 391/391 [00:07<00:00, 53.63it/s]
50000 images processed, 7.437289237976074 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:53,  1.45it/s]  8%|▊         | 6/79 [00:00<00:07,  9.77it/s] 18%|█▊        | 14/79 [00:00<00:02, 23.21it/s] 27%|██▋       | 21/79 [00:01<00:01, 32.95it/s] 35%|███▌      | 28/79 [00:01<00:01, 40.39it/s] 43%|████▎     | 34/79 [00:01<00:01, 41.87it/s] 52%|█████▏    | 41/79 [00:01<00:00, 46.36it/s] 59%|█████▉    | 47/79 [00:01<00:00, 47.84it/s] 68%|██████▊   | 54/79 [00:01<00:00, 53.36it/s] 80%|███████▉  | 63/79 [00:01<00:00, 62.18it/s] 90%|████████▉ | 71/79 [00:01<00:00, 66.32it/s]100%|██████████| 79/79 [00:01<00:00, 66.59it/s]100%|██████████| 79/79 [00:01<00:00, 41.21it/s]
10000 images processed, 1.9521543979644775 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage1-seen/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:19,  1.46it/s]  4%|▍         | 8/204 [00:00<00:14, 13.23it/s]  7%|▋         | 15/204 [00:00<00:07, 24.17it/s] 10%|█         | 21/204 [00:01<00:06, 28.03it/s] 14%|█▍        | 29/204 [00:01<00:04, 38.70it/s] 17%|█▋        | 35/204 [00:01<00:04, 41.49it/s] 21%|██        | 42/204 [00:01<00:03, 48.01it/s] 25%|██▌       | 51/204 [00:01<00:02, 57.15it/s] 29%|██▉       | 60/204 [00:01<00:02, 63.88it/s] 33%|███▎      | 68/204 [00:01<00:02, 60.13it/s] 37%|███▋      | 75/204 [00:01<00:02, 54.52it/s] 40%|███▉      | 81/204 [00:02<00:02, 55.13it/s] 43%|████▎     | 87/204 [00:02<00:02, 56.10it/s] 46%|████▌     | 94/204 [00:02<00:01, 58.05it/s] 50%|█████     | 102/204 [00:02<00:01, 62.35it/s] 53%|█████▎    | 109/204 [00:02<00:01, 53.82it/s] 56%|█████▋    | 115/204 [00:02<00:01, 53.17it/s] 59%|█████▉    | 121/204 [00:02<00:01, 54.58it/s] 63%|██████▎   | 129/204 [00:02<00:01, 59.97it/s] 67%|██████▋   | 136/204 [00:02<00:01, 62.53it/s] 70%|███████   | 143/204 [00:03<00:00, 63.28it/s] 74%|███████▎  | 150/204 [00:03<00:01, 53.50it/s] 76%|███████▋  | 156/204 [00:03<00:00, 49.85it/s] 80%|███████▉  | 163/204 [00:03<00:00, 54.65it/s] 83%|████████▎ | 169/204 [00:03<00:00, 55.96it/s] 87%|████████▋ | 178/204 [00:03<00:00, 64.38it/s] 92%|█████████▏| 187/204 [00:03<00:00, 70.91it/s] 96%|█████████▌| 195/204 [00:03<00:00, 63.70it/s] 99%|█████████▉| 202/204 [00:04<00:00, 57.54it/s]100%|██████████| 204/204 [00:04<00:00, 49.34it/s]
26032 images processed, 4.187573432922363 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:16,  1.02it/s]  9%|▉         | 7/79 [00:01<00:08,  8.52it/s] 18%|█▊        | 14/79 [00:01<00:03, 17.81it/s] 24%|██▍       | 19/79 [00:01<00:02, 23.47it/s] 30%|███       | 24/79 [00:01<00:02, 27.47it/s] 39%|███▉      | 31/79 [00:01<00:01, 35.81it/s] 47%|████▋     | 37/79 [00:01<00:01, 39.51it/s] 57%|█████▋    | 45/79 [00:01<00:00, 48.37it/s] 68%|██████▊   | 54/79 [00:01<00:00, 57.73it/s] 78%|███████▊  | 62/79 [00:01<00:00, 60.82it/s] 87%|████████▋ | 69/79 [00:02<00:00, 52.75it/s] 95%|█████████▍| 75/79 [00:02<00:00, 51.03it/s]100%|██████████| 79/79 [00:02<00:00, 34.06it/s]
10000 images processed, 2.3589742183685303 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:05,  1.19it/s]  9%|▉         | 7/79 [00:00<00:07,  9.69it/s] 15%|█▌        | 12/79 [00:01<00:04, 16.59it/s] 24%|██▍       | 19/79 [00:01<00:02, 26.73it/s] 34%|███▍      | 27/79 [00:01<00:01, 38.21it/s] 43%|████▎     | 34/79 [00:01<00:01, 42.52it/s] 51%|█████     | 40/79 [00:01<00:00, 43.10it/s] 58%|█████▊    | 46/79 [00:01<00:00, 44.41it/s] 70%|██████▉   | 55/79 [00:01<00:00, 54.40it/s] 80%|███████▉  | 63/79 [00:01<00:00, 60.64it/s] 91%|█████████ | 72/79 [00:01<00:00, 66.47it/s]100%|██████████| 79/79 [00:02<00:00, 38.60it/s]
10000 images processed, 2.081923246383667 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:54,  1.28it/s]  7%|▋         | 5/70 [00:00<00:09,  7.19it/s] 16%|█▌        | 11/70 [00:00<00:03, 16.55it/s] 23%|██▎       | 16/70 [00:01<00:02, 23.17it/s] 36%|███▌      | 25/70 [00:01<00:01, 37.69it/s] 49%|████▊     | 34/70 [00:01<00:00, 49.18it/s] 59%|█████▊    | 41/70 [00:01<00:00, 53.27it/s] 69%|██████▊   | 48/70 [00:01<00:00, 57.47it/s] 79%|███████▊  | 55/70 [00:01<00:00, 50.99it/s] 87%|████████▋ | 61/70 [00:01<00:00, 49.55it/s]100%|██████████| 70/70 [00:01<00:00, 56.99it/s]100%|██████████| 70/70 [00:01<00:00, 36.09it/s]
8925 images processed, 1.9853363037109375 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:58,  1.32s/it]  4%|▍         | 2/45 [00:01<00:26,  1.60it/s] 16%|█▌        | 7/45 [00:01<00:05,  6.83it/s] 31%|███       | 14/45 [00:01<00:02, 15.34it/s] 40%|████      | 18/45 [00:01<00:01, 17.13it/s] 49%|████▉     | 22/45 [00:02<00:01, 16.36it/s] 56%|█████▌    | 25/45 [00:02<00:01, 16.88it/s] 73%|███████▎  | 33/45 [00:02<00:00, 21.56it/s] 87%|████████▋ | 39/45 [00:02<00:00, 24.01it/s]100%|██████████| 45/45 [00:02<00:00, 15.68it/s]
5640 images processed, 2.9005653858184814 seconds used

24.831270456314087
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.46  98.78
places365     72.66  79.74
LSUN          27.04  94.18
iSUN          76.25  79.49
dtd           47.20  89.36
AVG           45.72  88.31
Retain-Acc: 0.7387
Forget-as-OOD (retain known vs forget novel):
  FPR: 38.00 AUROC: 88.86 AUIN: 99.23
38.51066493988037
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage1-seen_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage1-seen_rf.png
==== Stage 2: forget_inc={66,67,88,94,57}; forget_seen={0,8,11,40,51}; all={0,8,11,40,51,66,67,88,94,57} ====
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:54: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1', forget_classes='0,8,11,40,51,66,67,88,94,57', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:163: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:237: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [01:00<49:41, 60.84s/it]  4%|▍         | 2/50 [01:35<36:30, 45.64s/it]  6%|▌         | 3/50 [02:15<33:35, 42.87s/it]  8%|▊         | 4/50 [02:55<31:53, 41.59s/it] 10%|█         | 5/50 [03:34<30:37, 40.82s/it] 12%|█▏        | 6/50 [04:09<28:36, 39.01s/it][loss] ep 0 it 0 total=9.7542 mle=1.9345 pcon=5.2948 forget=1.3749 orth=1.1499 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 0 it 50 total=9.6697 mle=1.8793 pcon=5.2809 forget=1.3597 orth=1.1498 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 0 it 100 total=9.7142 mle=1.9475 pcon=5.2666 forget=1.3505 orth=1.1496 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 0 it 150 total=9.6113 mle=1.8480 pcon=5.2527 forget=1.3614 orth=1.1492 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 0 it 200 total=9.6915 mle=1.9477 pcon=5.2390 forget=1.3560 orth=1.1487 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 0 it 250 total=9.5602 mle=1.8241 pcon=5.2258 forget=1.3623 orth=1.1480 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 0 it 300 total=9.5706 mle=1.8500 pcon=5.2129 forget=1.3605 orth=1.1473 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 0 it 350 total=9.6426 mle=1.9342 pcon=5.2001 forget=1.3619 orth=1.1464 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 1 it 10 total=9.5410 mle=1.8437 pcon=5.1877 forget=1.3643 orth=1.1453 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 1 it 60 total=9.4436 mle=1.7776 pcon=5.1754 forget=1.3465 orth=1.1441 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 1 it 110 total=9.5180 mle=1.8498 pcon=5.1642 forget=1.3611 orth=1.1428 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 1 it 160 total=9.4624 mle=1.8071 pcon=5.1529 forget=1.3611 orth=1.1414 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 1 it 210 total=9.4982 mle=1.8409 pcon=5.1418 forget=1.3756 orth=1.1398 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 1 it 260 total=9.2252 mle=1.5846 pcon=5.1308 forget=1.3717 orth=1.1382 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 1 it 310 total=9.2272 mle=1.5977 pcon=5.1201 forget=1.3730 orth=1.1364 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 1 it 360 total=9.3471 mle=1.6940 pcon=5.1098 forget=1.4087 orth=1.1345 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 2 it 20 total=9.1518 mle=1.5673 pcon=5.0998 forget=1.3521 orth=1.1326 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 2 it 70 total=9.3446 mle=1.7720 pcon=5.0900 forget=1.3521 orth=1.1305 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 2 it 120 total=9.2500 mle=1.6764 pcon=5.0804 forget=1.3648 orth=1.1283 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 2 it 170 total=9.2151 mle=1.6308 pcon=5.0712 forget=1.3871 orth=1.1261 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 2 it 220 total=9.3267 mle=1.7861 pcon=5.0620 forget=1.3550 orth=1.1237 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 2 it 270 total=9.0710 mle=1.5526 pcon=5.0534 forget=1.3437 orth=1.1213 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 2 it 320 total=9.1930 mle=1.6606 pcon=5.0450 forget=1.3686 orth=1.1188 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 2 it 370 total=9.2941 mle=1.7744 pcon=5.0365 forget=1.3671 orth=1.1161 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 3 it 30 total=9.2928 mle=1.8118 pcon=5.0283 forget=1.3394 orth=1.1133 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 80 total=9.1253 mle=1.6443 pcon=5.0203 forget=1.3501 orth=1.1106 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 130 total=9.1015 mle=1.6214 pcon=5.0122 forget=1.3600 orth=1.1078 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 3 it 180 total=9.0536 mle=1.5781 pcon=5.0046 forget=1.3660 orth=1.1049 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 230 total=9.1377 mle=1.6890 pcon=4.9970 forget=1.3497 orth=1.1019 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 3 it 280 total=9.1015 mle=1.6378 pcon=4.9896 forget=1.3753 orth=1.0989 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 3 it 330 total=8.9891 mle=1.5499 pcon=4.9823 forget=1.3613 orth=1.0956 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 380 total=9.1430 mle=1.7155 pcon=4.9754 forget=1.3598 orth=1.0923 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 4 it 40 total=9.3071 mle=1.8711 pcon=4.9685 forget=1.3786 orth=1.0889 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 4 it 90 total=9.1573 mle=1.7463 pcon=4.9619 forget=1.3636 orth=1.0855 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 4 it 140 total=9.0708 mle=1.6478 pcon=4.9557 forget=1.3853 orth=1.0821 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 4 it 190 total=9.0435 mle=1.6384 pcon=4.9489 forget=1.3776 orth=1.0786 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 4 it 240 total=8.9460 mle=1.5528 pcon=4.9428 forget=1.3755 orth=1.0750 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 4 it 290 total=9.1951 mle=1.8223 pcon=4.9366 forget=1.3649 orth=1.0713 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 4 it 340 total=9.1973 mle=1.8356 pcon=4.9306 forget=1.3635 orth=1.0676 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 5 it 0 total=9.0796 mle=1.7258 pcon=4.9248 forget=1.3651 orth=1.0638 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 5 it 50 total=8.9928 mle=1.6606 pcon=4.9191 forget=1.3531 orth=1.0600 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 5 it 100 total=8.8257 mle=1.4741 pcon=4.9134 forget=1.3821 orth=1.0562 favg=0.0000 nr=55 nf=55 protos=540 fproto_sim=NA
[loss] ep 5 it 150 total=9.0130 mle=1.6890 pcon=4.9081 forget=1.3638 orth=1.0522 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 5 it 200 total=9.0010 mle=1.6843 pcon=4.9029 forget=1.3656 orth=1.0482 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 5 it 250 total=8.8550 mle=1.5569 pcon=4.8978 forget=1.3560 orth=1.0442 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 5 it 300 total=9.0438 mle=1.7717 pcon=4.8926 forget=1.3394 orth=1.0402 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 5 it 350 total=9.0463 mle=1.7812 pcon=4.8877 forget=1.3412 orth=1.0362 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 6 it 10 total=8.9328 mle=1.6616 pcon=4.8829 forget=1.3561 orth=1.0322 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 6 it 60 total=8.9878 mle=1.7135 pcon=4.8784 forget=1.3678 orth=1.0282 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 110 total=8.8300 mle=1.5700 pcon=4.8737 forget=1.3623 orth=1.0240 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 6 it 160 total=8.8226 mle=1.5846 pcon=4.8691 forget=1.3489 orth=1.0200 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 6 it 210 total=9.2074 mle=1.9665 pcon=4.8645 forget=1.3605 orth=1.0159 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 260 total=8.8460 mle=1.6352 pcon=4.8601 forget=1.3389 orth=1.0118 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 310 total=8.7672 mle=1.5356 pcon=4.8557 forget=1.3683 orth=1.0076 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 360 total=8.8187 mle=1.6032 pcon=4.8516 forget=1.3605 orth=1.0034 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
 14%|█▍        | 7/50 [04:44<26:55, 37.58s/it] 16%|█▌        | 8/50 [05:31<28:23, 40.56s/it] 18%|█▊        | 9/50 [06:07<26:40, 39.03s/it] 20%|██        | 10/50 [06:42<25:15, 37.90s/it] 22%|██▏       | 11/50 [07:21<24:53, 38.31s/it] 24%|██▍       | 12/50 [08:12<26:43, 42.20s/it] 26%|██▌       | 13/50 [08:57<26:32, 43.03s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 7 it 20 total=8.8507 mle=1.6732 pcon=4.8474 forget=1.3309 orth=0.9992 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 7 it 70 total=8.9251 mle=1.7420 pcon=4.8433 forget=1.3449 orth=0.9948 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 7 it 120 total=8.7875 mle=1.6445 pcon=4.8393 forget=1.3132 orth=0.9906 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 7 it 170 total=8.9535 mle=1.7913 pcon=4.8357 forget=1.3402 orth=0.9863 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 7 it 220 total=8.8073 mle=1.6530 pcon=4.8324 forget=1.3398 orth=0.9820 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 7 it 270 total=8.6422 mle=1.5066 pcon=4.8291 forget=1.3289 orth=0.9776 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 7 it 320 total=8.8638 mle=1.7258 pcon=4.8256 forget=1.3392 orth=0.9731 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 7 it 370 total=8.8085 mle=1.6597 pcon=4.8222 forget=1.3578 orth=0.9687 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 8 it 30 total=8.6094 mle=1.4882 pcon=4.8189 forget=1.3381 orth=0.9642 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 80 total=8.6352 mle=1.5313 pcon=4.8159 forget=1.3285 orth=0.9596 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 130 total=8.7510 mle=1.6619 pcon=4.8126 forget=1.3212 orth=0.9552 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 8 it 180 total=8.6663 mle=1.5798 pcon=4.8095 forget=1.3262 orth=0.9507 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 8 it 230 total=8.6839 mle=1.5946 pcon=4.8066 forget=1.3367 orth=0.9460 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 280 total=8.7669 mle=1.6856 pcon=4.8037 forget=1.3362 orth=0.9415 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 8 it 330 total=8.7289 mle=1.6458 pcon=4.8011 forget=1.3451 orth=0.9369 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 380 total=8.6821 mle=1.6269 pcon=4.7985 forget=1.3244 orth=0.9323 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 9 it 40 total=8.6450 mle=1.6091 pcon=4.7959 forget=1.3125 orth=0.9276 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 9 it 90 total=8.7362 mle=1.7108 pcon=4.7932 forget=1.3091 orth=0.9231 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 9 it 140 total=8.6431 mle=1.6043 pcon=4.7907 forget=1.3296 orth=0.9186 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 9 it 190 total=8.5441 mle=1.5293 pcon=4.7881 forget=1.3128 orth=0.9138 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 9 it 240 total=8.7573 mle=1.7461 pcon=4.7858 forget=1.3164 orth=0.9090 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 9 it 290 total=8.7005 mle=1.7065 pcon=4.7834 forget=1.3064 orth=0.9041 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 9 it 340 total=8.5104 mle=1.5301 pcon=4.7811 forget=1.3001 orth=0.8992 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 10 it 0 total=8.6862 mle=1.7064 pcon=4.7788 forget=1.3071 orth=0.8938 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 10 it 50 total=8.6345 mle=1.6848 pcon=4.7767 forget=1.2844 orth=0.8886 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 10 it 100 total=8.5788 mle=1.6071 pcon=4.7747 forget=1.3136 orth=0.8834 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 10 it 150 total=8.4516 mle=1.5093 pcon=4.7726 forget=1.2918 orth=0.8779 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 10 it 200 total=8.5482 mle=1.6032 pcon=4.7706 forget=1.3020 orth=0.8723 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 10 it 250 total=8.5136 mle=1.5848 pcon=4.7687 forget=1.2934 orth=0.8667 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 10 it 300 total=8.7302 mle=1.8292 pcon=4.7667 forget=1.2732 orth=0.8612 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 10 it 350 total=8.5269 mle=1.6489 pcon=4.7648 forget=1.2575 orth=0.8555 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 11 it 10 total=8.4880 mle=1.6200 pcon=4.7630 forget=1.2553 orth=0.8497 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 11 it 60 total=8.4282 mle=1.5907 pcon=4.7614 forget=1.2323 orth=0.8438 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 11 it 110 total=8.5384 mle=1.7100 pcon=4.7596 forget=1.2309 orth=0.8378 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 11 it 160 total=8.3751 mle=1.5610 pcon=4.7579 forget=1.2246 orth=0.8316 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 11 it 210 total=8.3396 mle=1.5450 pcon=4.7562 forget=1.2133 orth=0.8252 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 11 it 260 total=8.4649 mle=1.6831 pcon=4.7547 forget=1.2085 orth=0.8186 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 11 it 310 total=8.5453 mle=1.7651 pcon=4.7532 forget=1.2148 orth=0.8121 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 11 it 360 total=8.4486 mle=1.6985 pcon=4.7517 forget=1.1929 orth=0.8054 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 12 it 20 total=8.4138 mle=1.6871 pcon=4.7502 forget=1.1780 orth=0.7985 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 12 it 70 total=8.3972 mle=1.6675 pcon=4.7487 forget=1.1895 orth=0.7915 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 12 it 120 total=8.3435 mle=1.6309 pcon=4.7473 forget=1.1811 orth=0.7843 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 12 it 170 total=8.3166 mle=1.6149 pcon=4.7457 forget=1.1790 orth=0.7770 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 12 it 220 total=8.2584 mle=1.5734 pcon=4.7443 forget=1.1712 orth=0.7696 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 12 it 270 total=8.2396 mle=1.5683 pcon=4.7428 forget=1.1667 orth=0.7618 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 12 it 320 total=8.3051 mle=1.6436 pcon=4.7414 forget=1.1663 orth=0.7537 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 12 it 370 total=8.2761 mle=1.6430 pcon=4.7397 forget=1.1479 orth=0.7454 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 13 it 30 total=8.2656 mle=1.6337 pcon=4.7381 forget=1.1568 orth=0.7369 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 80 total=8.2349 mle=1.6244 pcon=4.7368 forget=1.1455 orth=0.7281 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 130 total=8.2516 mle=1.6403 pcon=4.7354 forget=1.1569 orth=0.7190 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 13 it 180 total=8.2447 mle=1.6541 pcon=4.7340 forget=1.1467 orth=0.7099 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 230 total=8.1976 mle=1.6169 pcon=4.7326 forget=1.1477 orth=0.7004 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 280 total=8.2196 mle=1.6401 pcon=4.7309 forget=1.1579 orth=0.6907 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
 28%|██▊       | 14/50 [09:43<26:19, 43.87s/it] 30%|███       | 15/50 [10:31<26:12, 44.94s/it] 32%|███▏      | 16/50 [11:19<26:05, 46.05s/it] 34%|███▍      | 17/50 [12:06<25:28, 46.32s/it] 36%|███▌      | 18/50 [12:53<24:49, 46.54s/it] 38%|███▊      | 19/50 [13:40<24:06, 46.67s/it] 40%|████      | 20/50 [14:28<23:27, 46.92s/it][loss] ep 13 it 330 total=8.1063 mle=1.5576 pcon=4.7294 forget=1.1385 orth=0.6809 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 13 it 380 total=8.0998 mle=1.5605 pcon=4.7280 forget=1.1406 orth=0.6707 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 14 it 40 total=8.1281 mle=1.6003 pcon=4.7264 forget=1.1412 orth=0.6602 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 14 it 90 total=8.3684 mle=1.8555 pcon=4.7250 forget=1.1384 orth=0.6495 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 14 it 140 total=8.1946 mle=1.6895 pcon=4.7235 forget=1.1429 orth=0.6387 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 14 it 190 total=8.0973 mle=1.6053 pcon=4.7220 forget=1.1424 orth=0.6276 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 14 it 240 total=8.3520 mle=1.8662 pcon=4.7207 forget=1.1489 orth=0.6162 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 14 it 290 total=8.3188 mle=1.8395 pcon=4.7195 forget=1.1549 orth=0.6048 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 14 it 340 total=8.1283 mle=1.6578 pcon=4.7183 forget=1.1588 orth=0.5933 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 15 it 0 total=8.0531 mle=1.6049 pcon=4.7170 forget=1.1497 orth=0.5815 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 15 it 50 total=8.2047 mle=1.7407 pcon=4.7157 forget=1.1786 orth=0.5696 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 100 total=8.1590 mle=1.7344 pcon=4.7145 forget=1.1524 orth=0.5576 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 15 it 150 total=7.9768 mle=1.5627 pcon=4.7133 forget=1.1552 orth=0.5456 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 200 total=8.0781 mle=1.6822 pcon=4.7120 forget=1.1505 orth=0.5333 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 250 total=8.1031 mle=1.7137 pcon=4.7107 forget=1.1577 orth=0.5211 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 300 total=8.0671 mle=1.6885 pcon=4.7095 forget=1.1603 orth=0.5088 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 15 it 350 total=7.9857 mle=1.6184 pcon=4.7082 forget=1.1626 orth=0.4965 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 16 it 10 total=7.9171 mle=1.5662 pcon=4.7071 forget=1.1596 orth=0.4842 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 16 it 60 total=8.0561 mle=1.7097 pcon=4.7059 forget=1.1685 orth=0.4721 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 16 it 110 total=7.8964 mle=1.5677 pcon=4.7049 forget=1.1640 orth=0.4599 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 16 it 160 total=7.8835 mle=1.5637 pcon=4.7038 forget=1.1683 orth=0.4478 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 16 it 210 total=7.9947 mle=1.6846 pcon=4.7026 forget=1.1717 orth=0.4358 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 16 it 260 total=8.0330 mle=1.7213 pcon=4.7015 forget=1.1864 orth=0.4238 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 16 it 310 total=7.8529 mle=1.5603 pcon=4.7003 forget=1.1802 orth=0.4121 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 16 it 360 total=7.8001 mle=1.5249 pcon=4.6992 forget=1.1756 orth=0.4004 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 17 it 20 total=8.2823 mle=2.0035 pcon=4.6982 forget=1.1918 orth=0.3889 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 70 total=8.0411 mle=1.7836 pcon=4.6971 forget=1.1828 orth=0.3776 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 120 total=7.8988 mle=1.6423 pcon=4.6960 forget=1.1940 orth=0.3665 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 17 it 170 total=7.8076 mle=1.5621 pcon=4.6950 forget=1.1950 orth=0.3556 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 220 total=7.9890 mle=1.7524 pcon=4.6940 forget=1.1977 orth=0.3449 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 17 it 270 total=8.0420 mle=1.8062 pcon=4.6929 forget=1.2085 orth=0.3344 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 17 it 320 total=7.8133 mle=1.5995 pcon=4.6919 forget=1.1978 orth=0.3241 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 370 total=7.7823 mle=1.5722 pcon=4.6909 forget=1.2051 orth=0.3141 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 18 it 30 total=7.7911 mle=1.5823 pcon=4.6900 forget=1.2145 orth=0.3043 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 80 total=7.8701 mle=1.6704 pcon=4.6891 forget=1.2158 orth=0.2948 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 130 total=7.8363 mle=1.6501 pcon=4.6883 forget=1.2124 orth=0.2855 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 18 it 180 total=7.8861 mle=1.7072 pcon=4.6873 forget=1.2151 orth=0.2765 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 18 it 230 total=7.7932 mle=1.6232 pcon=4.6866 forget=1.2158 orth=0.2677 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 18 it 280 total=7.9145 mle=1.7448 pcon=4.6856 forget=1.2249 orth=0.2591 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 330 total=7.9397 mle=1.7865 pcon=4.6849 forget=1.2174 orth=0.2508 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 18 it 380 total=7.8407 mle=1.6850 pcon=4.6840 forget=1.2290 orth=0.2428 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 19 it 40 total=7.8388 mle=1.6992 pcon=4.6832 forget=1.2214 orth=0.2349 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 19 it 90 total=7.6607 mle=1.5250 pcon=4.6825 forget=1.2258 orth=0.2274 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 19 it 140 total=7.8186 mle=1.6820 pcon=4.6816 forget=1.2350 orth=0.2200 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 19 it 190 total=7.8978 mle=1.7744 pcon=4.6808 forget=1.2297 orth=0.2129 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 19 it 240 total=7.7879 mle=1.6701 pcon=4.6800 forget=1.2316 orth=0.2061 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 19 it 290 total=7.7397 mle=1.6260 pcon=4.6793 forget=1.2349 orth=0.1995 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 19 it 340 total=7.8077 mle=1.6892 pcon=4.6786 forget=1.2468 orth=0.1931 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 20 it 0 total=7.7606 mle=1.6525 pcon=4.6779 forget=1.2434 orth=0.1869 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 20 it 50 total=7.5782 mle=1.4813 pcon=4.6773 forget=1.2386 orth=0.1810 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 20 it 100 total=7.9049 mle=1.8124 pcon=4.6767 forget=1.2406 orth=0.1753 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 150 total=7.8275 mle=1.7329 pcon=4.6763 forget=1.2486 orth=0.1697 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 200 total=7.7272 mle=1.6350 pcon=4.6757 forget=1.2520 orth=0.1644 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
 42%|████▏     | 21/50 [15:21<23:33, 48.73s/it] 44%|████▍     | 22/50 [16:11<22:56, 49.16s/it] 46%|████▌     | 23/50 [16:59<21:59, 48.85s/it] 48%|████▊     | 24/50 [17:47<21:00, 48.50s/it] 50%|█████     | 25/50 [18:36<20:15, 48.62s/it] 52%|█████▏    | 26/50 [19:21<19:05, 47.74s/it] 54%|█████▍    | 27/50 [20:09<18:16, 47.66s/it][loss] ep 20 it 250 total=7.7558 mle=1.6713 pcon=4.6752 forget=1.2501 orth=0.1593 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 300 total=7.8053 mle=1.7178 pcon=4.6745 forget=1.2587 orth=0.1544 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 350 total=7.8052 mle=1.7300 pcon=4.6738 forget=1.2518 orth=0.1497 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 21 it 10 total=7.7495 mle=1.6814 pcon=4.6731 forget=1.2499 orth=0.1451 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 21 it 60 total=7.7313 mle=1.6550 pcon=4.6724 forget=1.2630 orth=0.1408 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 21 it 110 total=7.8705 mle=1.8037 pcon=4.6719 forget=1.2583 orth=0.1366 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 21 it 160 total=7.7246 mle=1.6623 pcon=4.6714 forget=1.2583 orth=0.1326 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 21 it 210 total=7.6225 mle=1.5629 pcon=4.6708 forget=1.2601 orth=0.1288 favg=0.0000 nr=55 nf=55 protos=540 fproto_sim=NA
[loss] ep 21 it 260 total=7.7179 mle=1.6614 pcon=4.6703 forget=1.2611 orth=0.1251 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 21 it 310 total=7.5946 mle=1.5317 pcon=4.6699 forget=1.2715 orth=0.1215 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 21 it 360 total=7.6970 mle=1.6397 pcon=4.6695 forget=1.2697 orth=0.1181 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 22 it 20 total=7.8432 mle=1.7971 pcon=4.6690 forget=1.2622 orth=0.1149 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 22 it 70 total=7.6319 mle=1.5769 pcon=4.6685 forget=1.2748 orth=0.1118 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 120 total=7.6800 mle=1.6331 pcon=4.6681 forget=1.2701 orth=0.1088 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 22 it 170 total=7.6862 mle=1.6438 pcon=4.6677 forget=1.2688 orth=0.1059 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 220 total=7.6955 mle=1.6431 pcon=4.6672 forget=1.2821 orth=0.1031 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 22 it 270 total=8.0576 mle=2.0100 pcon=4.6668 forget=1.2803 orth=0.1005 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 320 total=7.7467 mle=1.6975 pcon=4.6664 forget=1.2848 orth=0.0980 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 370 total=7.7197 mle=1.6816 pcon=4.6660 forget=1.2765 orth=0.0956 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 23 it 30 total=7.7830 mle=1.7344 pcon=4.6656 forget=1.2898 orth=0.0933 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 23 it 80 total=7.7145 mle=1.6796 pcon=4.6651 forget=1.2786 orth=0.0910 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 23 it 130 total=7.6099 mle=1.5761 pcon=4.6647 forget=1.2802 orth=0.0889 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 23 it 180 total=7.7398 mle=1.7085 pcon=4.6644 forget=1.2801 orth=0.0869 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 23 it 230 total=7.8921 mle=1.8570 pcon=4.6640 forget=1.2861 orth=0.0850 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 23 it 280 total=7.6461 mle=1.6088 pcon=4.6636 forget=1.2906 orth=0.0831 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 23 it 330 total=7.7193 mle=1.6884 pcon=4.6630 forget=1.2865 orth=0.0813 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 23 it 380 total=7.6712 mle=1.6428 pcon=4.6628 forget=1.2860 orth=0.0796 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 24 it 40 total=7.7013 mle=1.6713 pcon=4.6625 forget=1.2895 orth=0.0780 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 24 it 90 total=7.6188 mle=1.5827 pcon=4.6622 forget=1.2975 orth=0.0764 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 24 it 140 total=7.6932 mle=1.6583 pcon=4.6617 forget=1.2983 orth=0.0749 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 24 it 190 total=7.8270 mle=1.7953 pcon=4.6614 forget=1.2969 orth=0.0735 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 24 it 240 total=7.7879 mle=1.7482 pcon=4.6611 forget=1.3066 orth=0.0721 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 24 it 290 total=7.8662 mle=1.8297 pcon=4.6607 forget=1.3050 orth=0.0707 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 24 it 340 total=7.7585 mle=1.7207 pcon=4.6605 forget=1.3078 orth=0.0695 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 25 it 0 total=7.6624 mle=1.6306 pcon=4.6602 forget=1.3034 orth=0.0682 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 50 total=7.7284 mle=1.6984 pcon=4.6599 forget=1.3030 orth=0.0671 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 100 total=7.5491 mle=1.5213 pcon=4.6596 forget=1.3023 orth=0.0660 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 25 it 150 total=7.7286 mle=1.7000 pcon=4.6594 forget=1.3044 orth=0.0649 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 25 it 200 total=7.8792 mle=1.8324 pcon=4.6593 forget=1.3236 orth=0.0639 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 25 it 250 total=7.5823 mle=1.5569 pcon=4.6589 forget=1.3037 orth=0.0629 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 25 it 300 total=7.8162 mle=1.7811 pcon=4.6586 forget=1.3147 orth=0.0619 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 350 total=7.6890 mle=1.6685 pcon=4.6584 forget=1.3011 orth=0.0610 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[loss] ep 26 it 10 total=7.7116 mle=1.6873 pcon=4.6581 forget=1.3061 orth=0.0601 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 26 it 60 total=7.6533 mle=1.6219 pcon=4.6578 forget=1.3144 orth=0.0592 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 110 total=7.6299 mle=1.6092 pcon=4.6575 forget=1.3047 orth=0.0584 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 26 it 160 total=7.6769 mle=1.6495 pcon=4.6573 forget=1.3124 orth=0.0576 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 210 total=7.9276 mle=1.9059 pcon=4.6570 forget=1.3078 orth=0.0568 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 260 total=7.6792 mle=1.6569 pcon=4.6567 forget=1.3095 orth=0.0561 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 26 it 310 total=7.6572 mle=1.6376 pcon=4.6566 forget=1.3076 orth=0.0554 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 360 total=7.6297 mle=1.5986 pcon=4.6562 forget=1.3201 orth=0.0547 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 27 it 20 total=7.6797 mle=1.6579 pcon=4.6561 forget=1.3116 orth=0.0540 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 27 it 70 total=7.6521 mle=1.6220 pcon=4.6559 forget=1.3209 orth=0.0534 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 27 it 120 total=7.8645 mle=1.8374 pcon=4.6555 forget=1.3188 orth=0.0528 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 27 it 170 total=7.6293 mle=1.6054 pcon=4.6553 forget=1.3164 orth=0.0522 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 27 it 220 total=7.7685 mle=1.7392 pcon=4.6551 forget=1.3226 orth=0.0516 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 27 it 270 total=7.6560 mle=1.6321 pcon=4.6549 forget=1.3180 orth=0.0510 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
 56%|█████▌    | 28/50 [20:59<17:48, 48.56s/it] 58%|█████▊    | 29/50 [21:47<16:55, 48.36s/it] 60%|██████    | 30/50 [22:35<16:05, 48.26s/it] 62%|██████▏   | 31/50 [23:22<15:10, 47.94s/it] 64%|██████▍   | 32/50 [24:08<14:11, 47.29s/it] 66%|██████▌   | 33/50 [24:58<13:34, 47.91s/it] 68%|██████▊   | 34/50 [25:45<12:43, 47.72s/it] 70%|███████   | 35/50 [26:33<11:57, 47.86s/it][loss] ep 27 it 320 total=7.5968 mle=1.5658 pcon=4.6547 forget=1.3258 orth=0.0505 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 27 it 370 total=7.7150 mle=1.6854 pcon=4.6545 forget=1.3252 orth=0.0500 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 28 it 30 total=7.6466 mle=1.6192 pcon=4.6543 forget=1.3236 orth=0.0494 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 28 it 80 total=7.6799 mle=1.6369 pcon=4.6541 forget=1.3399 orth=0.0489 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 28 it 130 total=7.6716 mle=1.6415 pcon=4.6539 forget=1.3278 orth=0.0485 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 28 it 180 total=7.6139 mle=1.5742 pcon=4.6537 forget=1.3380 orth=0.0480 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 28 it 230 total=7.7394 mle=1.7108 pcon=4.6536 forget=1.3275 orth=0.0476 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 28 it 280 total=7.7646 mle=1.7303 pcon=4.6534 forget=1.3337 orth=0.0471 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 28 it 330 total=7.6664 mle=1.6199 pcon=4.6531 forget=1.3466 orth=0.0467 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 28 it 380 total=7.8309 mle=1.7917 pcon=4.6529 forget=1.3400 orth=0.0463 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 29 it 40 total=7.8018 mle=1.7596 pcon=4.6525 forget=1.3438 orth=0.0459 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 29 it 90 total=7.7562 mle=1.7120 pcon=4.6525 forget=1.3462 orth=0.0455 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 29 it 140 total=7.6736 mle=1.6343 pcon=4.6525 forget=1.3417 orth=0.0452 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 29 it 190 total=7.6723 mle=1.6342 pcon=4.6523 forget=1.3410 orth=0.0448 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 29 it 240 total=7.6255 mle=1.5862 pcon=4.6522 forget=1.3427 orth=0.0444 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 29 it 290 total=7.7028 mle=1.6508 pcon=4.6520 forget=1.3559 orth=0.0441 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 29 it 340 total=7.6177 mle=1.5766 pcon=4.6519 forget=1.3454 orth=0.0438 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 30 it 0 total=7.7707 mle=1.7226 pcon=4.6517 forget=1.3530 orth=0.0434 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 30 it 50 total=7.7366 mle=1.6879 pcon=4.6515 forget=1.3540 orth=0.0431 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 30 it 100 total=7.6024 mle=1.5542 pcon=4.6514 forget=1.3540 orth=0.0428 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 30 it 150 total=7.7144 mle=1.6691 pcon=4.6513 forget=1.3515 orth=0.0425 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 30 it 200 total=7.7753 mle=1.7292 pcon=4.6511 forget=1.3528 orth=0.0422 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 30 it 250 total=7.9865 mle=1.9364 pcon=4.6511 forget=1.3571 orth=0.0419 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 30 it 300 total=7.8839 mle=1.8342 pcon=4.6510 forget=1.3571 orth=0.0417 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 30 it 350 total=7.7853 mle=1.7274 pcon=4.6507 forget=1.3658 orth=0.0414 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 10 total=7.6936 mle=1.6396 pcon=4.6505 forget=1.3623 orth=0.0411 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 31 it 60 total=7.6092 mle=1.5479 pcon=4.6503 forget=1.3701 orth=0.0409 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 31 it 110 total=7.7035 mle=1.6480 pcon=4.6501 forget=1.3648 orth=0.0406 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 160 total=7.6731 mle=1.6147 pcon=4.6500 forget=1.3680 orth=0.0404 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 210 total=7.6873 mle=1.6249 pcon=4.6498 forget=1.3725 orth=0.0401 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 260 total=7.6319 mle=1.5709 pcon=4.6498 forget=1.3713 orth=0.0399 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 31 it 310 total=7.6977 mle=1.6340 pcon=4.6497 forget=1.3744 orth=0.0397 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 31 it 360 total=7.6307 mle=1.5690 pcon=4.6495 forget=1.3727 orth=0.0394 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 32 it 20 total=7.7645 mle=1.6969 pcon=4.6495 forget=1.3790 orth=0.0392 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 70 total=7.6812 mle=1.6108 pcon=4.6493 forget=1.3821 orth=0.0390 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 32 it 120 total=7.8104 mle=1.7410 pcon=4.6490 forget=1.3816 orth=0.0388 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 32 it 170 total=7.7054 mle=1.6359 pcon=4.6487 forget=1.3821 orth=0.0386 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 32 it 220 total=7.6659 mle=1.5915 pcon=4.6487 forget=1.3872 orth=0.0384 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 270 total=7.7565 mle=1.6760 pcon=4.6486 forget=1.3937 orth=0.0382 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 320 total=7.7180 mle=1.6423 pcon=4.6484 forget=1.3892 orth=0.0380 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 370 total=7.7595 mle=1.6788 pcon=4.6483 forget=1.3945 orth=0.0379 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 33 it 30 total=8.0035 mle=1.9246 pcon=4.6483 forget=1.3929 orth=0.0377 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 33 it 80 total=8.0476 mle=1.9661 pcon=4.6482 forget=1.3958 orth=0.0375 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 33 it 130 total=7.9297 mle=1.8491 pcon=4.6481 forget=1.3951 orth=0.0373 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 33 it 180 total=7.7606 mle=1.6696 pcon=4.6481 forget=1.4057 orth=0.0372 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 33 it 230 total=7.7011 mle=1.6154 pcon=4.6480 forget=1.4007 orth=0.0370 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 33 it 280 total=7.8246 mle=1.7396 pcon=4.6480 forget=1.4001 orth=0.0369 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 33 it 330 total=7.8349 mle=1.7521 pcon=4.6480 forget=1.3981 orth=0.0367 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 33 it 380 total=7.7422 mle=1.6571 pcon=4.6479 forget=1.4007 orth=0.0365 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 34 it 40 total=7.9172 mle=1.8289 pcon=4.6478 forget=1.4041 orth=0.0364 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 34 it 90 total=7.7210 mle=1.6312 pcon=4.6477 forget=1.4059 orth=0.0362 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 34 it 140 total=8.0533 mle=1.9609 pcon=4.6476 forget=1.4087 orth=0.0361 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 34 it 190 total=7.8926 mle=1.7979 pcon=4.6475 forget=1.4113 orth=0.0360 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 34 it 240 total=7.7454 mle=1.6563 pcon=4.6474 forget=1.4059 orth=0.0358 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 34 it 290 total=7.7657 mle=1.6756 pcon=4.6473 forget=1.4070 orth=0.0357 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 34 it 340 total=7.6267 mle=1.5296 pcon=4.6472 forget=1.4143 orth=0.0356 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 0 total=7.6182 mle=1.5212 pcon=4.6471 forget=1.4144 orth=0.0354 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 50 total=7.9007 mle=1.8022 pcon=4.6469 forget=1.4162 orth=0.0353 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 35 it 100 total=7.6836 mle=1.5800 pcon=4.6469 forget=1.4215 orth=0.0352 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 150 total=7.8062 mle=1.7054 pcon=4.6469 forget=1.4189 orth=0.0351 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 35 it 200 total=7.7413 mle=1.6404 pcon=4.6469 forget=1.4190 orth=0.0350 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 35 it 250 total=7.6839 mle=1.5763 pcon=4.6469 forget=1.4259 orth=0.0349 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
 72%|███████▏  | 36/50 [27:22<11:13, 48.08s/it] 74%|███████▍  | 37/50 [28:08<10:18, 47.55s/it] 76%|███████▌  | 38/50 [28:55<09:29, 47.49s/it] 78%|███████▊  | 39/50 [29:48<08:58, 48.95s/it] 80%|████████  | 40/50 [30:41<08:23, 50.31s/it] 82%|████████▏ | 41/50 [31:31<07:30, 50.09s/it] 84%|████████▍ | 42/50 [32:19<06:36, 49.60s/it] 86%|████████▌ | 43/50 [33:07<05:42, 48.97s/it][loss] ep 35 it 300 total=7.6319 mle=1.5292 pcon=4.6469 forget=1.4210 orth=0.0347 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 350 total=7.6136 mle=1.5127 pcon=4.6468 forget=1.4195 orth=0.0346 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 36 it 10 total=7.8234 mle=1.7202 pcon=4.6466 forget=1.4221 orth=0.0345 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 36 it 60 total=7.9024 mle=1.8009 pcon=4.6466 forget=1.4205 orth=0.0344 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 36 it 110 total=7.8226 mle=1.7117 pcon=4.6465 forget=1.4301 orth=0.0343 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 36 it 160 total=7.9357 mle=1.8240 pcon=4.6465 forget=1.4310 orth=0.0342 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 36 it 210 total=7.8138 mle=1.7070 pcon=4.6463 forget=1.4264 orth=0.0341 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 36 it 260 total=7.8389 mle=1.7345 pcon=4.6462 forget=1.4241 orth=0.0340 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 36 it 310 total=7.7612 mle=1.6538 pcon=4.6462 forget=1.4273 orth=0.0339 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 36 it 360 total=7.6966 mle=1.5909 pcon=4.6461 forget=1.4257 orth=0.0338 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 37 it 20 total=7.7506 mle=1.6396 pcon=4.6460 forget=1.4312 orth=0.0337 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 37 it 70 total=7.7058 mle=1.5944 pcon=4.6460 forget=1.4316 orth=0.0336 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 37 it 120 total=7.7973 mle=1.6729 pcon=4.6461 forget=1.4447 orth=0.0336 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 37 it 170 total=7.8317 mle=1.7216 pcon=4.6460 forget=1.4307 orth=0.0335 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 37 it 220 total=7.7167 mle=1.5993 pcon=4.6458 forget=1.4382 orth=0.0334 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 37 it 270 total=7.8139 mle=1.6988 pcon=4.6459 forget=1.4359 orth=0.0333 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 37 it 320 total=7.9674 mle=1.8459 pcon=4.6459 forget=1.4424 orth=0.0332 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 37 it 370 total=7.7131 mle=1.5984 pcon=4.6458 forget=1.4357 orth=0.0332 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 38 it 30 total=7.6683 mle=1.5602 pcon=4.6459 forget=1.4291 orth=0.0331 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 38 it 80 total=7.7536 mle=1.6345 pcon=4.6458 forget=1.4403 orth=0.0330 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 38 it 130 total=7.7816 mle=1.6561 pcon=4.6458 forget=1.4467 orth=0.0330 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 38 it 180 total=7.8108 mle=1.6913 pcon=4.6456 forget=1.4410 orth=0.0329 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 38 it 230 total=7.8338 mle=1.7157 pcon=4.6456 forget=1.4396 orth=0.0328 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 38 it 280 total=7.8359 mle=1.7182 pcon=4.6456 forget=1.4394 orth=0.0327 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 38 it 330 total=7.7718 mle=1.6438 pcon=4.6457 forget=1.4496 orth=0.0327 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 38 it 380 total=7.9430 mle=1.8234 pcon=4.6455 forget=1.4414 orth=0.0326 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 39 it 40 total=7.7194 mle=1.6030 pcon=4.6455 forget=1.4384 orth=0.0326 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 90 total=7.7558 mle=1.6217 pcon=4.6453 forget=1.4563 orth=0.0325 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 140 total=7.7249 mle=1.6042 pcon=4.6453 forget=1.4430 orth=0.0324 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 190 total=7.8066 mle=1.6924 pcon=4.6452 forget=1.4367 orth=0.0324 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 39 it 240 total=7.8246 mle=1.6989 pcon=4.6451 forget=1.4483 orth=0.0323 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 290 total=7.9599 mle=1.8455 pcon=4.6451 forget=1.4370 orth=0.0323 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 39 it 340 total=7.7610 mle=1.6474 pcon=4.6453 forget=1.4361 orth=0.0322 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 40 it 0 total=7.7458 mle=1.6303 pcon=4.6452 forget=1.4382 orth=0.0321 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 40 it 50 total=7.7184 mle=1.5992 pcon=4.6451 forget=1.4420 orth=0.0321 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 40 it 100 total=7.6845 mle=1.5619 pcon=4.6449 forget=1.4456 orth=0.0320 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 40 it 150 total=7.8778 mle=1.7640 pcon=4.6448 forget=1.4371 orth=0.0320 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 40 it 200 total=7.7418 mle=1.6225 pcon=4.6448 forget=1.4426 orth=0.0320 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 40 it 250 total=7.8444 mle=1.7290 pcon=4.6446 forget=1.4389 orth=0.0319 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 40 it 300 total=7.7226 mle=1.5987 pcon=4.6446 forget=1.4475 orth=0.0319 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 40 it 350 total=7.9237 mle=1.8044 pcon=4.6445 forget=1.4429 orth=0.0318 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 41 it 10 total=7.9680 mle=1.8547 pcon=4.6444 forget=1.4372 orth=0.0318 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 41 it 60 total=7.6890 mle=1.5736 pcon=4.6444 forget=1.4393 orth=0.0317 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 41 it 110 total=7.8030 mle=1.6842 pcon=4.6443 forget=1.4428 orth=0.0317 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 41 it 160 total=7.9027 mle=1.7854 pcon=4.6443 forget=1.4414 orth=0.0317 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 41 it 210 total=7.7574 mle=1.6401 pcon=4.6442 forget=1.4414 orth=0.0316 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 41 it 260 total=7.7562 mle=1.6345 pcon=4.6440 forget=1.4460 orth=0.0316 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 41 it 310 total=7.7818 mle=1.6649 pcon=4.6439 forget=1.4414 orth=0.0315 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 41 it 360 total=7.6972 mle=1.5813 pcon=4.6439 forget=1.4405 orth=0.0315 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 42 it 20 total=7.7836 mle=1.6670 pcon=4.6438 forget=1.4413 orth=0.0315 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 42 it 70 total=7.8101 mle=1.6916 pcon=4.6437 forget=1.4434 orth=0.0314 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 42 it 120 total=7.7256 mle=1.6096 pcon=4.6438 forget=1.4407 orth=0.0314 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 42 it 170 total=7.7550 mle=1.6382 pcon=4.6437 forget=1.4417 orth=0.0314 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 42 it 220 total=7.8265 mle=1.7054 pcon=4.6437 forget=1.4461 orth=0.0314 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 42 it 270 total=7.8917 mle=1.7636 pcon=4.6435 forget=1.4532 orth=0.0313 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 42 it 320 total=7.9339 mle=1.8180 pcon=4.6433 forget=1.4413 orth=0.0313 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 42 it 370 total=7.5642 mle=1.4464 pcon=4.6432 forget=1.4433 orth=0.0313 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 43 it 30 total=7.8872 mle=1.7723 pcon=4.6432 forget=1.4405 orth=0.0312 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 43 it 80 total=7.7751 mle=1.6554 pcon=4.6431 forget=1.4453 orth=0.0312 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 43 it 130 total=7.7516 mle=1.6354 pcon=4.6430 forget=1.4420 orth=0.0312 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 43 it 180 total=7.8529 mle=1.7343 pcon=4.6430 forget=1.4444 orth=0.0312 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 43 it 230 total=7.8825 mle=1.7695 pcon=4.6429 forget=1.4389 orth=0.0312 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
 88%|████████▊ | 44/50 [33:54<04:50, 48.49s/it] 90%|█████████ | 45/50 [34:39<03:57, 47.55s/it] 92%|█████████▏| 46/50 [35:26<03:09, 47.36s/it] 94%|█████████▍| 47/50 [36:15<02:23, 47.87s/it] 96%|█████████▌| 48/50 [37:02<01:34, 47.50s/it] 98%|█████████▊| 49/50 [37:49<00:47, 47.40s/it]100%|██████████| 50/50 [38:39<00:00, 47.98s/it]100%|██████████| 50/50 [38:39<00:00, 46.38s/it]
[loss] ep 43 it 280 total=7.9167 mle=1.8012 pcon=4.6430 forget=1.4413 orth=0.0311 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 43 it 330 total=7.8334 mle=1.7029 pcon=4.6429 forget=1.4565 orth=0.0311 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 43 it 380 total=7.7054 mle=1.5891 pcon=4.6430 forget=1.4423 orth=0.0311 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 44 it 40 total=7.7538 mle=1.6330 pcon=4.6430 forget=1.4468 orth=0.0311 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 44 it 90 total=7.8828 mle=1.7664 pcon=4.6430 forget=1.4423 orth=0.0311 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 44 it 140 total=7.7764 mle=1.6559 pcon=4.6429 forget=1.4465 orth=0.0310 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 44 it 190 total=7.8341 mle=1.7122 pcon=4.6430 forget=1.4480 orth=0.0310 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 44 it 240 total=7.7070 mle=1.5855 pcon=4.6428 forget=1.4477 orth=0.0310 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 44 it 290 total=7.7798 mle=1.6597 pcon=4.6429 forget=1.4462 orth=0.0310 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 44 it 340 total=7.7290 mle=1.6148 pcon=4.6429 forget=1.4404 orth=0.0310 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 0 total=7.7038 mle=1.5876 pcon=4.6428 forget=1.4424 orth=0.0310 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 50 total=7.8751 mle=1.7553 pcon=4.6428 forget=1.4462 orth=0.0309 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 45 it 100 total=7.9271 mle=1.8094 pcon=4.6429 forget=1.4440 orth=0.0309 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 150 total=7.7671 mle=1.6442 pcon=4.6428 forget=1.4491 orth=0.0309 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 45 it 200 total=7.8449 mle=1.7268 pcon=4.6428 forget=1.4445 orth=0.0309 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 45 it 250 total=7.7998 mle=1.6859 pcon=4.6428 forget=1.4402 orth=0.0309 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 45 it 300 total=7.6685 mle=1.5449 pcon=4.6428 forget=1.4500 orth=0.0309 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 350 total=7.7987 mle=1.6753 pcon=4.6427 forget=1.4497 orth=0.0309 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 46 it 10 total=7.7503 mle=1.6301 pcon=4.6428 forget=1.4465 orth=0.0309 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 46 it 60 total=7.8691 mle=1.7519 pcon=4.6429 forget=1.4434 orth=0.0309 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 46 it 110 total=7.8086 mle=1.6838 pcon=4.6429 forget=1.4511 orth=0.0309 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 46 it 160 total=7.7360 mle=1.6138 pcon=4.6428 forget=1.4485 orth=0.0308 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 46 it 210 total=7.8371 mle=1.7133 pcon=4.6427 forget=1.4502 orth=0.0308 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 46 it 260 total=7.7013 mle=1.5758 pcon=4.6425 forget=1.4522 orth=0.0308 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 46 it 310 total=7.7606 mle=1.6429 pcon=4.6424 forget=1.4445 orth=0.0308 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 46 it 360 total=7.8415 mle=1.7207 pcon=4.6424 forget=1.4476 orth=0.0308 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 47 it 20 total=8.0757 mle=1.9479 pcon=4.6424 forget=1.4545 orth=0.0308 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 47 it 70 total=7.6916 mle=1.5724 pcon=4.6424 forget=1.4460 orth=0.0308 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 47 it 120 total=7.9429 mle=1.8187 pcon=4.6424 forget=1.4510 orth=0.0308 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 47 it 170 total=7.7802 mle=1.6598 pcon=4.6422 forget=1.4474 orth=0.0308 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 47 it 220 total=7.8088 mle=1.6860 pcon=4.6422 forget=1.4498 orth=0.0308 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 47 it 270 total=7.9036 mle=1.7707 pcon=4.6421 forget=1.4599 orth=0.0308 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 47 it 320 total=7.7202 mle=1.5976 pcon=4.6422 forget=1.4496 orth=0.0308 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 47 it 370 total=7.8808 mle=1.7531 pcon=4.6421 forget=1.4548 orth=0.0308 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 48 it 30 total=7.8167 mle=1.6943 pcon=4.6420 forget=1.4496 orth=0.0308 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 48 it 80 total=7.9295 mle=1.8055 pcon=4.6420 forget=1.4512 orth=0.0308 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 130 total=7.6428 mle=1.5198 pcon=4.6420 forget=1.4502 orth=0.0308 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 180 total=7.7687 mle=1.6384 pcon=4.6421 forget=1.4574 orth=0.0308 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 230 total=7.8230 mle=1.7037 pcon=4.6420 forget=1.4465 orth=0.0308 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 280 total=7.8144 mle=1.6897 pcon=4.6420 forget=1.4519 orth=0.0308 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 48 it 330 total=7.8326 mle=1.7107 pcon=4.6419 forget=1.4493 orth=0.0308 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 48 it 380 total=7.8031 mle=1.6833 pcon=4.6418 forget=1.4472 orth=0.0308 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 49 it 40 total=7.8480 mle=1.7203 pcon=4.6418 forget=1.4552 orth=0.0308 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 49 it 90 total=7.8553 mle=1.7328 pcon=4.6418 forget=1.4499 orth=0.0308 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 49 it 140 total=7.7636 mle=1.6406 pcon=4.6419 forget=1.4504 orth=0.0308 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 49 it 190 total=7.9789 mle=1.8534 pcon=4.6420 forget=1.4528 orth=0.0308 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 49 it 240 total=7.6800 mle=1.5577 pcon=4.6420 forget=1.4496 orth=0.0308 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 49 it 290 total=7.8814 mle=1.7586 pcon=4.6421 forget=1.4499 orth=0.0308 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 49 it 340 total=7.7847 mle=1.6628 pcon=4.6421 forget=1.4491 orth=0.0308 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-inc1: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:12,  1.54it/s]  2%|▏         | 6/391 [00:00<00:37, 10.23it/s]  3%|▎         | 13/391 [00:00<00:17, 21.79it/s]  5%|▌         | 21/391 [00:00<00:10, 34.04it/s]  7%|▋         | 27/391 [00:01<00:09, 38.85it/s]  8%|▊         | 33/391 [00:01<00:08, 40.92it/s] 10%|█         | 41/391 [00:01<00:07, 48.63it/s] 12%|█▏        | 48/391 [00:01<00:06, 52.73it/s] 15%|█▍        | 58/391 [00:01<00:05, 62.94it/s] 17%|█▋        | 67/391 [00:01<00:04, 68.77it/s] 19%|█▉        | 76/391 [00:01<00:04, 70.81it/s] 21%|██▏       | 84/391 [00:01<00:05, 61.03it/s] 24%|██▎       | 92/391 [00:02<00:04, 62.58it/s] 25%|██▌       | 99/391 [00:02<00:04, 59.53it/s] 27%|██▋       | 106/391 [00:02<00:04, 61.94it/s] 29%|██▉       | 115/391 [00:02<00:04, 66.28it/s] 31%|███       | 122/391 [00:02<00:04, 66.20it/s] 33%|███▎      | 129/391 [00:02<00:04, 59.10it/s] 35%|███▌      | 137/391 [00:02<00:04, 63.31it/s] 37%|███▋      | 144/391 [00:02<00:04, 61.32it/s] 39%|███▉      | 152/391 [00:03<00:03, 65.84it/s] 41%|████      | 160/391 [00:03<00:03, 68.75it/s] 43%|████▎     | 168/391 [00:03<00:03, 62.93it/s] 45%|████▍     | 175/391 [00:03<00:03, 57.97it/s] 47%|████▋     | 182/391 [00:03<00:03, 58.91it/s] 48%|████▊     | 189/391 [00:03<00:03, 60.00it/s] 50%|█████     | 197/391 [00:03<00:03, 64.44it/s] 52%|█████▏    | 205/391 [00:03<00:02, 66.98it/s] 54%|█████▍    | 212/391 [00:03<00:02, 67.78it/s] 56%|█████▋    | 220/391 [00:04<00:02, 68.03it/s] 58%|█████▊    | 227/391 [00:04<00:02, 60.10it/s] 60%|█████▉    | 234/391 [00:04<00:02, 62.43it/s] 62%|██████▏   | 241/391 [00:04<00:02, 58.51it/s] 64%|██████▎   | 249/391 [00:04<00:02, 63.41it/s] 66%|██████▌   | 258/391 [00:04<00:01, 68.82it/s] 68%|██████▊   | 266/391 [00:04<00:01, 64.15it/s] 70%|██████▉   | 273/391 [00:04<00:02, 58.46it/s] 72%|███████▏  | 281/391 [00:05<00:01, 63.16it/s] 74%|███████▎  | 288/391 [00:05<00:01, 58.46it/s] 76%|███████▌  | 297/391 [00:05<00:01, 65.18it/s] 78%|███████▊  | 306/391 [00:05<00:01, 69.70it/s] 80%|████████  | 314/391 [00:05<00:01, 64.29it/s] 82%|████████▏ | 321/391 [00:05<00:01, 60.59it/s] 84%|████████▍ | 330/391 [00:05<00:00, 67.26it/s] 86%|████████▌ | 337/391 [00:05<00:00, 63.43it/s] 88%|████████▊ | 346/391 [00:06<00:00, 68.59it/s] 91%|█████████ | 354/391 [00:06<00:00, 69.89it/s] 93%|█████████▎| 362/391 [00:06<00:00, 69.36it/s] 95%|█████████▍| 370/391 [00:06<00:00, 57.68it/s] 97%|█████████▋| 378/391 [00:06<00:00, 62.42it/s] 98%|█████████▊| 385/391 [00:06<00:00, 60.46it/s]100%|██████████| 391/391 [00:06<00:00, 57.55it/s]
50000 images processed, 6.898675441741943 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:54,  1.44it/s]  5%|▌         | 4/79 [00:00<00:12,  6.17it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.39it/s] 25%|██▌       | 20/79 [00:01<00:01, 32.60it/s] 35%|███▌      | 28/79 [00:01<00:01, 42.95it/s] 44%|████▍     | 35/79 [00:01<00:01, 42.67it/s] 52%|█████▏    | 41/79 [00:01<00:00, 44.66it/s] 61%|██████    | 48/79 [00:01<00:00, 49.28it/s] 72%|███████▏  | 57/79 [00:01<00:00, 58.85it/s] 84%|████████▎ | 66/79 [00:01<00:00, 66.13it/s] 95%|█████████▍| 75/79 [00:01<00:00, 71.71it/s]100%|██████████| 79/79 [00:01<00:00, 41.60it/s]
10000 images processed, 1.9275434017181396 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-inc1/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<03:05,  1.10it/s]  1%|▏         | 3/204 [00:01<00:55,  3.64it/s]  3%|▎         | 7/204 [00:01<00:20,  9.47it/s]  6%|▋         | 13/204 [00:01<00:10, 18.54it/s]  9%|▉         | 19/204 [00:01<00:07, 26.30it/s] 14%|█▎        | 28/204 [00:01<00:04, 39.65it/s] 18%|█▊        | 37/204 [00:01<00:03, 49.97it/s] 22%|██▏       | 44/204 [00:01<00:03, 51.66it/s] 25%|██▌       | 51/204 [00:01<00:03, 49.32it/s] 28%|██▊       | 58/204 [00:01<00:02, 51.71it/s] 32%|███▏      | 65/204 [00:02<00:02, 56.07it/s] 36%|███▋      | 74/204 [00:02<00:02, 63.39it/s] 40%|███▉      | 81/204 [00:02<00:01, 63.79it/s] 43%|████▎     | 88/204 [00:02<00:02, 55.14it/s] 47%|████▋     | 95/204 [00:02<00:01, 57.20it/s] 50%|█████     | 102/204 [00:02<00:01, 60.21it/s] 54%|█████▍    | 111/204 [00:02<00:01, 66.40it/s] 58%|█████▊    | 119/204 [00:02<00:01, 68.95it/s] 62%|██████▏   | 127/204 [00:03<00:01, 57.44it/s] 66%|██████▌   | 134/204 [00:03<00:01, 55.16it/s] 70%|██████▉   | 142/204 [00:03<00:01, 59.53it/s] 73%|███████▎  | 149/204 [00:03<00:00, 60.17it/s] 77%|███████▋  | 157/204 [00:03<00:00, 63.63it/s] 80%|████████  | 164/204 [00:03<00:00, 55.43it/s] 84%|████████▍ | 171/204 [00:03<00:00, 58.66it/s] 87%|████████▋ | 178/204 [00:03<00:00, 56.94it/s] 92%|█████████▏| 187/204 [00:04<00:00, 64.97it/s] 96%|█████████▌| 196/204 [00:04<00:00, 71.27it/s]100%|██████████| 204/204 [00:04<00:00, 47.95it/s]
26032 images processed, 4.303512334823608 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:14,  1.04it/s]  4%|▍         | 3/79 [00:01<00:22,  3.39it/s]  9%|▉         | 7/79 [00:01<00:08,  8.83it/s] 16%|█▋        | 13/79 [00:01<00:03, 17.41it/s] 25%|██▌       | 20/79 [00:01<00:02, 27.72it/s] 35%|███▌      | 28/79 [00:01<00:01, 39.17it/s] 46%|████▌     | 36/79 [00:01<00:00, 47.61it/s] 54%|█████▍    | 43/79 [00:01<00:00, 44.72it/s] 63%|██████▎   | 50/79 [00:01<00:00, 48.12it/s] 72%|███████▏  | 57/79 [00:02<00:00, 51.86it/s] 84%|████████▎ | 66/79 [00:02<00:00, 60.66it/s] 95%|█████████▍| 75/79 [00:02<00:00, 67.99it/s]100%|██████████| 79/79 [00:02<00:00, 34.72it/s]
10000 images processed, 2.3094401359558105 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:00,  1.30it/s]  6%|▋         | 5/79 [00:00<00:10,  7.17it/s] 14%|█▍        | 11/79 [00:00<00:04, 16.35it/s] 20%|██        | 16/79 [00:01<00:02, 22.77it/s] 29%|██▉       | 23/79 [00:01<00:01, 32.94it/s] 38%|███▊      | 30/79 [00:01<00:01, 40.80it/s] 46%|████▌     | 36/79 [00:01<00:01, 39.43it/s] 53%|█████▎    | 42/79 [00:01<00:00, 42.59it/s] 61%|██████    | 48/79 [00:01<00:00, 45.66it/s] 72%|███████▏  | 57/79 [00:01<00:00, 55.93it/s] 84%|████████▎ | 66/79 [00:01<00:00, 64.64it/s] 95%|█████████▍| 75/79 [00:02<00:00, 71.16it/s]100%|██████████| 79/79 [00:02<00:00, 38.36it/s]
10000 images processed, 2.095698356628418 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:59,  1.17it/s] 13%|█▎        | 9/70 [00:00<00:05, 12.17it/s] 24%|██▍       | 17/70 [00:01<00:02, 23.23it/s] 36%|███▌      | 25/70 [00:01<00:01, 32.95it/s] 46%|████▌     | 32/70 [00:01<00:01, 36.40it/s] 57%|█████▋    | 40/70 [00:01<00:00, 45.13it/s] 70%|███████   | 49/70 [00:01<00:00, 53.81it/s] 80%|████████  | 56/70 [00:01<00:00, 55.02it/s] 93%|█████████▎| 65/70 [00:01<00:00, 63.42it/s]100%|██████████| 70/70 [00:01<00:00, 37.70it/s]
8925 images processed, 1.8895728588104248 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:57,  1.30s/it]  4%|▍         | 2/45 [00:01<00:28,  1.50it/s] 22%|██▏       | 10/45 [00:01<00:03,  9.64it/s] 29%|██▉       | 13/45 [00:01<00:02, 12.29it/s] 40%|████      | 18/45 [00:02<00:02, 12.98it/s] 58%|█████▊    | 26/45 [00:02<00:01, 18.89it/s] 73%|███████▎  | 33/45 [00:02<00:00, 22.08it/s] 80%|████████  | 36/45 [00:02<00:00, 16.64it/s] 93%|█████████▎| 42/45 [00:03<00:00, 17.49it/s]100%|██████████| 45/45 [00:03<00:00, 13.52it/s]
5640 images processed, 3.357100248336792 seconds used

24.922978401184082
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           6.51  98.59
places365     73.77  79.21
LSUN          50.56  87.45
iSUN          78.50  78.62
dtd           47.89  89.21
AVG           51.45  86.61
Retain-Acc: 0.7334
Forget-as-OOD (retain known vs forget novel):
  FPR: 44.40 AUROC: 89.17 AUIN: 99.28
35.89961266517639
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-inc1_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-inc1_rf.png
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-inc2: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:39,  2.44it/s]  2%|▏         | 7/391 [00:00<00:22, 16.86it/s]  3%|▎         | 12/391 [00:00<00:15, 24.45it/s]  5%|▍         | 19/391 [00:00<00:10, 36.38it/s]  7%|▋         | 28/391 [00:00<00:07, 49.99it/s]  9%|▉         | 37/391 [00:00<00:06, 58.82it/s] 11%|█▏        | 44/391 [00:01<00:06, 54.89it/s] 13%|█▎        | 51/391 [00:01<00:06, 53.27it/s] 15%|█▍        | 57/391 [00:01<00:06, 52.21it/s] 17%|█▋        | 66/391 [00:01<00:05, 61.05it/s] 19%|█▉        | 75/391 [00:01<00:04, 68.41it/s] 21%|██▏       | 84/391 [00:01<00:04, 73.87it/s] 24%|██▎       | 92/391 [00:01<00:03, 75.40it/s] 26%|██▌       | 100/391 [00:01<00:04, 64.88it/s] 27%|██▋       | 107/391 [00:02<00:04, 61.90it/s] 29%|██▉       | 114/391 [00:02<00:04, 61.31it/s] 31%|███       | 122/391 [00:02<00:04, 65.66it/s] 34%|███▎      | 131/391 [00:02<00:03, 71.03it/s] 36%|███▌      | 139/391 [00:02<00:03, 71.28it/s] 38%|███▊      | 147/391 [00:02<00:03, 67.19it/s] 39%|███▉      | 154/391 [00:02<00:04, 58.83it/s] 41%|████      | 161/391 [00:02<00:03, 60.72it/s] 43%|████▎     | 168/391 [00:03<00:03, 59.49it/s] 45%|████▌     | 177/391 [00:03<00:03, 65.72it/s] 47%|████▋     | 185/391 [00:03<00:03, 68.24it/s] 49%|████▉     | 192/391 [00:03<00:03, 61.65it/s] 51%|█████     | 199/391 [00:03<00:03, 59.93it/s] 53%|█████▎    | 207/391 [00:03<00:02, 62.02it/s] 55%|█████▍    | 214/391 [00:03<00:02, 63.56it/s] 57%|█████▋    | 222/391 [00:03<00:02, 67.81it/s] 59%|█████▉    | 230/391 [00:03<00:02, 69.71it/s] 61%|██████    | 238/391 [00:04<00:02, 68.71it/s] 63%|██████▎   | 245/391 [00:04<00:02, 63.90it/s] 64%|██████▍   | 252/391 [00:04<00:02, 60.13it/s] 66%|██████▌   | 259/391 [00:04<00:02, 62.31it/s] 68%|██████▊   | 266/391 [00:04<00:01, 62.52it/s] 70%|███████   | 274/391 [00:04<00:01, 64.86it/s] 72%|███████▏  | 283/391 [00:04<00:01, 70.80it/s] 75%|███████▍  | 292/391 [00:04<00:01, 74.83it/s] 77%|███████▋  | 300/391 [00:05<00:01, 69.12it/s] 79%|███████▉  | 308/391 [00:05<00:01, 59.36it/s] 81%|████████  | 315/391 [00:05<00:01, 57.88it/s] 82%|████████▏ | 322/391 [00:05<00:01, 60.68it/s] 84%|████████▍ | 330/391 [00:05<00:00, 63.67it/s] 86%|████████▋ | 338/391 [00:05<00:00, 67.67it/s] 88%|████████▊ | 346/391 [00:05<00:00, 67.05it/s] 90%|█████████ | 353/391 [00:05<00:00, 57.15it/s] 92%|█████████▏| 360/391 [00:06<00:00, 55.98it/s] 94%|█████████▍| 368/391 [00:06<00:00, 61.11it/s] 96%|█████████▋| 377/391 [00:06<00:00, 68.09it/s] 98%|█████████▊| 385/391 [00:06<00:00, 70.31it/s]100%|██████████| 391/391 [00:06<00:00, 60.70it/s]
50000 images processed, 6.536056995391846 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:37,  2.08it/s]  8%|▊         | 6/79 [00:00<00:05, 12.97it/s] 16%|█▋        | 13/79 [00:00<00:02, 26.92it/s] 23%|██▎       | 18/79 [00:00<00:01, 32.41it/s] 33%|███▎      | 26/79 [00:00<00:01, 44.50it/s] 42%|████▏     | 33/79 [00:00<00:00, 51.45it/s] 53%|█████▎    | 42/79 [00:01<00:00, 60.94it/s] 62%|██████▏   | 49/79 [00:01<00:00, 53.71it/s] 71%|███████   | 56/79 [00:01<00:00, 55.81it/s] 82%|████████▏ | 65/79 [00:01<00:00, 63.56it/s] 91%|█████████ | 72/79 [00:01<00:00, 62.21it/s]100%|██████████| 79/79 [00:02<00:00, 26.47it/s]100%|██████████| 79/79 [00:02<00:00, 35.21it/s]
10000 images processed, 2.270224094390869 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-inc2/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:56,  1.74it/s]  3%|▎         | 7/204 [00:00<00:14, 13.19it/s]  7%|▋         | 15/204 [00:00<00:06, 27.35it/s] 12%|█▏        | 24/204 [00:00<00:04, 41.83it/s] 16%|█▌        | 32/204 [00:00<00:03, 51.14it/s] 20%|█▉        | 40/204 [00:01<00:03, 51.34it/s] 23%|██▎       | 47/204 [00:01<00:03, 51.44it/s] 26%|██▋       | 54/204 [00:01<00:02, 50.91it/s] 31%|███       | 63/204 [00:01<00:02, 59.91it/s] 35%|███▌      | 72/204 [00:01<00:02, 65.68it/s] 40%|███▉      | 81/204 [00:01<00:01, 70.87it/s] 44%|████▎     | 89/204 [00:01<00:01, 62.64it/s] 47%|████▋     | 96/204 [00:02<00:01, 61.13it/s] 50%|█████     | 103/204 [00:02<00:01, 56.73it/s] 55%|█████▍    | 112/204 [00:02<00:01, 64.35it/s] 59%|█████▉    | 121/204 [00:02<00:01, 68.36it/s] 64%|██████▎   | 130/204 [00:02<00:01, 73.04it/s] 68%|██████▊   | 138/204 [00:02<00:00, 69.19it/s] 72%|███████▏  | 146/204 [00:02<00:00, 60.28it/s] 75%|███████▌  | 153/204 [00:02<00:00, 59.44it/s] 78%|███████▊  | 160/204 [00:03<00:00, 60.69it/s] 82%|████████▏ | 167/204 [00:03<00:00, 62.75it/s] 86%|████████▋ | 176/204 [00:03<00:00, 69.05it/s] 91%|█████████ | 185/204 [00:03<00:00, 71.47it/s] 95%|█████████▍| 193/204 [00:03<00:00, 60.60it/s] 99%|█████████▊| 201/204 [00:03<00:00, 63.61it/s]100%|██████████| 204/204 [00:03<00:00, 55.20it/s]
26032 images processed, 3.748894453048706 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:52,  1.49it/s]  9%|▉         | 7/79 [00:00<00:06, 11.59it/s] 20%|██        | 16/79 [00:00<00:02, 27.09it/s] 32%|███▏      | 25/79 [00:00<00:01, 40.84it/s] 43%|████▎     | 34/79 [00:01<00:00, 52.17it/s] 53%|█████▎    | 42/79 [00:01<00:00, 58.63it/s] 63%|██████▎   | 50/79 [00:01<00:00, 62.10it/s] 76%|███████▌  | 60/79 [00:01<00:00, 70.98it/s] 89%|████████▊ | 70/79 [00:01<00:00, 77.72it/s]100%|██████████| 79/79 [00:01<00:00, 49.29it/s]
10000 images processed, 1.6511435508728027 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.79it/s] 11%|█▏        | 9/79 [00:00<00:04, 17.22it/s] 18%|█▊        | 14/79 [00:00<00:02, 23.81it/s] 24%|██▍       | 19/79 [00:00<00:02, 29.39it/s] 32%|███▏      | 25/79 [00:00<00:01, 36.63it/s] 39%|███▉      | 31/79 [00:01<00:01, 41.46it/s] 49%|████▉     | 39/79 [00:01<00:00, 50.92it/s] 58%|█████▊    | 46/79 [00:01<00:00, 54.79it/s] 70%|██████▉   | 55/79 [00:01<00:00, 63.90it/s] 80%|███████▉  | 63/79 [00:01<00:00, 66.42it/s] 89%|████████▊ | 70/79 [00:01<00:00, 61.42it/s] 97%|█████████▋| 77/79 [00:01<00:00, 57.43it/s]100%|██████████| 79/79 [00:01<00:00, 42.97it/s]
10000 images processed, 1.8773841857910156 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.91it/s] 10%|█         | 7/70 [00:00<00:04, 13.94it/s] 20%|██        | 14/70 [00:00<00:02, 26.63it/s] 31%|███▏      | 22/70 [00:00<00:01, 39.08it/s] 44%|████▍     | 31/70 [00:00<00:00, 50.82it/s] 56%|█████▌    | 39/70 [00:01<00:00, 57.90it/s] 67%|██████▋   | 47/70 [00:01<00:00, 51.63it/s] 79%|███████▊  | 55/70 [00:01<00:00, 57.62it/s] 89%|████████▊ | 62/70 [00:01<00:00, 55.77it/s]100%|██████████| 70/70 [00:01<00:00, 60.67it/s]100%|██████████| 70/70 [00:01<00:00, 43.83it/s]
8925 images processed, 1.6402661800384521 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:51,  1.17s/it]  4%|▍         | 2/45 [00:01<00:25,  1.66it/s] 24%|██▍       | 11/45 [00:01<00:02, 12.37it/s] 36%|███▌      | 16/45 [00:01<00:01, 17.91it/s] 47%|████▋     | 21/45 [00:01<00:01, 16.37it/s] 56%|█████▌    | 25/45 [00:02<00:01, 18.79it/s] 69%|██████▉   | 31/45 [00:02<00:00, 25.11it/s] 78%|███████▊  | 35/45 [00:02<00:00, 16.60it/s] 93%|█████████▎| 42/45 [00:02<00:00, 23.97it/s]100%|██████████| 45/45 [00:02<00:00, 16.01it/s]
5640 images processed, 2.8343963623046875 seconds used

22.21027112007141
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.80  98.70
places365     71.55  80.59
LSUN          33.52  93.86
iSUN          77.61  79.37
dtd           45.82  89.91
AVG           46.86  88.49
Retain-Acc: 0.7319
Forget-as-OOD (retain known vs forget novel):
  FPR: 49.40 AUROC: 90.97 AUIN: 99.46
46.85403370857239
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-inc2_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-inc2_rf.png
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-seen: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:06,  1.58it/s]  2%|▏         | 6/391 [00:00<00:36, 10.41it/s]  4%|▎         | 14/391 [00:00<00:15, 24.46it/s]  6%|▌         | 23/391 [00:00<00:09, 38.60it/s]  8%|▊         | 31/391 [00:01<00:07, 47.99it/s] 10%|▉         | 38/391 [00:01<00:07, 49.41it/s] 12%|█▏        | 45/391 [00:01<00:07, 47.19it/s] 13%|█▎        | 52/391 [00:01<00:06, 52.20it/s] 15%|█▍        | 58/391 [00:01<00:06, 54.02it/s] 17%|█▋        | 66/391 [00:01<00:05, 60.86it/s] 19%|█▊        | 73/391 [00:01<00:05, 62.40it/s] 21%|██        | 82/391 [00:01<00:04, 68.03it/s] 23%|██▎       | 90/391 [00:01<00:04, 67.05it/s] 25%|██▍       | 97/391 [00:02<00:04, 59.21it/s] 27%|██▋       | 105/391 [00:02<00:04, 63.76it/s] 29%|██▊       | 112/391 [00:02<00:04, 61.61it/s] 30%|███       | 119/391 [00:02<00:04, 63.35it/s] 33%|███▎      | 128/391 [00:02<00:03, 69.35it/s] 35%|███▌      | 137/391 [00:02<00:03, 74.08it/s] 37%|███▋      | 145/391 [00:02<00:03, 75.12it/s] 39%|███▉      | 153/391 [00:02<00:03, 63.48it/s] 41%|████      | 160/391 [00:03<00:03, 63.67it/s] 43%|████▎     | 169/391 [00:03<00:03, 67.20it/s] 45%|████▌     | 176/391 [00:03<00:03, 66.84it/s] 47%|████▋     | 185/391 [00:03<00:02, 71.01it/s] 50%|████▉     | 194/391 [00:03<00:02, 73.38it/s] 52%|█████▏    | 203/391 [00:03<00:02, 75.52it/s] 54%|█████▍    | 211/391 [00:03<00:02, 66.69it/s] 56%|█████▌    | 218/391 [00:03<00:02, 58.63it/s] 58%|█████▊    | 225/391 [00:04<00:02, 57.83it/s] 60%|█████▉    | 233/391 [00:04<00:02, 62.88it/s] 62%|██████▏   | 241/391 [00:04<00:02, 67.08it/s] 63%|██████▎   | 248/391 [00:04<00:02, 66.56it/s] 65%|██████▌   | 255/391 [00:04<00:02, 66.32it/s] 67%|██████▋   | 262/391 [00:04<00:02, 58.42it/s] 69%|██████▉   | 270/391 [00:04<00:01, 60.92it/s] 71%|███████   | 277/391 [00:04<00:01, 57.87it/s] 73%|███████▎  | 285/391 [00:05<00:01, 62.67it/s] 75%|███████▍  | 293/391 [00:05<00:01, 66.68it/s] 77%|███████▋  | 300/391 [00:05<00:01, 63.67it/s] 79%|███████▊  | 307/391 [00:05<00:01, 56.59it/s] 80%|████████  | 313/391 [00:05<00:01, 55.04it/s] 82%|████████▏ | 321/391 [00:05<00:01, 60.59it/s] 84%|████████▍ | 330/391 [00:05<00:00, 67.18it/s] 86%|████████▋ | 338/391 [00:05<00:00, 68.22it/s] 88%|████████▊ | 345/391 [00:05<00:00, 60.81it/s] 90%|█████████ | 352/391 [00:06<00:00, 61.33it/s] 92%|█████████▏| 359/391 [00:06<00:00, 58.77it/s] 94%|█████████▍| 367/391 [00:06<00:00, 61.93it/s] 96%|█████████▌| 376/391 [00:06<00:00, 69.12it/s] 98%|█████████▊| 385/391 [00:06<00:00, 74.55it/s]100%|██████████| 391/391 [00:06<00:00, 59.03it/s]
50000 images processed, 6.741623640060425 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:51,  1.51it/s]  8%|▊         | 6/79 [00:00<00:07,  9.89it/s] 15%|█▌        | 12/79 [00:00<00:03, 19.36it/s] 27%|██▋       | 21/79 [00:01<00:01, 33.55it/s] 37%|███▋      | 29/79 [00:01<00:01, 44.19it/s] 46%|████▌     | 36/79 [00:01<00:00, 48.92it/s] 54%|█████▍    | 43/79 [00:01<00:00, 47.53it/s] 62%|██████▏   | 49/79 [00:01<00:00, 49.62it/s] 72%|███████▏  | 57/79 [00:01<00:00, 55.90it/s] 81%|████████  | 64/79 [00:01<00:00, 59.33it/s] 92%|█████████▏| 73/79 [00:01<00:00, 66.99it/s]100%|██████████| 79/79 [00:02<00:00, 28.69it/s]
10000 images processed, 2.7887284755706787 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-seen/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:17,  1.47it/s]  3%|▎         | 6/204 [00:00<00:20,  9.52it/s]  7%|▋         | 14/204 [00:00<00:08, 22.63it/s] 10%|█         | 21/204 [00:01<00:05, 31.21it/s] 14%|█▍        | 29/204 [00:01<00:04, 41.27it/s] 18%|█▊        | 37/204 [00:01<00:03, 49.83it/s] 22%|██▏       | 44/204 [00:01<00:02, 54.50it/s] 26%|██▌       | 53/204 [00:01<00:02, 60.97it/s] 29%|██▉       | 60/204 [00:01<00:02, 51.73it/s] 32%|███▏      | 66/204 [00:01<00:02, 50.67it/s] 37%|███▋      | 75/204 [00:01<00:02, 59.03it/s] 41%|████      | 84/204 [00:01<00:01, 66.37it/s] 46%|████▌     | 93/204 [00:02<00:01, 69.88it/s] 50%|█████     | 102/204 [00:02<00:01, 71.83it/s] 54%|█████▍    | 110/204 [00:02<00:01, 58.69it/s] 57%|█████▋    | 117/204 [00:02<00:01, 57.28it/s] 61%|██████▏   | 125/204 [00:02<00:01, 61.88it/s] 65%|██████▌   | 133/204 [00:02<00:01, 65.83it/s] 69%|██████▉   | 141/204 [00:02<00:00, 68.67it/s] 73%|███████▎  | 149/204 [00:02<00:00, 70.32it/s] 77%|███████▋  | 157/204 [00:03<00:00, 57.76it/s] 80%|████████  | 164/204 [00:03<00:00, 56.18it/s] 85%|████████▍ | 173/204 [00:03<00:00, 62.84it/s] 89%|████████▊ | 181/204 [00:03<00:00, 65.54it/s] 93%|█████████▎| 190/204 [00:03<00:00, 71.71it/s] 98%|█████████▊| 199/204 [00:03<00:00, 76.52it/s]100%|██████████| 204/204 [00:03<00:00, 53.88it/s]
26032 images processed, 3.8478429317474365 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:02,  1.25it/s]  8%|▊         | 6/79 [00:00<00:08,  8.52it/s] 19%|█▉        | 15/79 [00:01<00:02, 22.57it/s] 30%|███       | 24/79 [00:01<00:01, 35.41it/s] 42%|████▏     | 33/79 [00:01<00:00, 46.35it/s] 53%|█████▎    | 42/79 [00:01<00:00, 54.43it/s] 63%|██████▎   | 50/79 [00:01<00:00, 47.92it/s] 72%|███████▏  | 57/79 [00:01<00:00, 47.25it/s] 84%|████████▎ | 66/79 [00:01<00:00, 56.36it/s] 95%|█████████▍| 75/79 [00:01<00:00, 64.17it/s]100%|██████████| 79/79 [00:01<00:00, 40.44it/s]
10000 images processed, 1.9882428646087646 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.68it/s] 10%|█         | 8/79 [00:00<00:04, 14.71it/s] 16%|█▋        | 13/79 [00:00<00:03, 21.99it/s] 25%|██▌       | 20/79 [00:00<00:01, 33.11it/s] 35%|███▌      | 28/79 [00:01<00:01, 44.68it/s] 46%|████▌     | 36/79 [00:01<00:00, 53.69it/s] 56%|█████▌    | 44/79 [00:01<00:00, 58.57it/s] 65%|██████▍   | 51/79 [00:01<00:00, 52.52it/s] 75%|███████▍  | 59/79 [00:01<00:00, 56.09it/s] 84%|████████▎ | 66/79 [00:01<00:00, 57.43it/s] 95%|█████████▍| 75/79 [00:01<00:00, 63.34it/s]100%|██████████| 79/79 [00:01<00:00, 44.11it/s]
10000 images processed, 1.8224594593048096 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:45,  1.51it/s] 10%|█         | 7/70 [00:00<00:05, 11.73it/s] 21%|██▏       | 15/70 [00:00<00:02, 24.61it/s] 33%|███▎      | 23/70 [00:01<00:01, 35.18it/s] 43%|████▎     | 30/70 [00:01<00:00, 41.90it/s] 51%|█████▏    | 36/70 [00:01<00:00, 43.05it/s] 60%|██████    | 42/70 [00:01<00:00, 43.71it/s] 69%|██████▊   | 48/70 [00:01<00:00, 45.70it/s] 81%|████████▏ | 57/70 [00:01<00:00, 56.57it/s] 93%|█████████▎| 65/70 [00:01<00:00, 60.84it/s]100%|██████████| 70/70 [00:01<00:00, 39.09it/s]
8925 images processed, 1.8243753910064697 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:50,  1.15s/it]  4%|▍         | 2/45 [00:01<00:23,  1.85it/s] 16%|█▌        | 7/45 [00:01<00:04,  8.11it/s] 31%|███       | 14/45 [00:01<00:01, 15.58it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.87it/s] 47%|████▋     | 21/45 [00:02<00:01, 15.92it/s] 67%|██████▋   | 30/45 [00:02<00:00, 20.61it/s] 73%|███████▎  | 33/45 [00:02<00:00, 19.76it/s] 82%|████████▏ | 37/45 [00:02<00:00, 22.29it/s] 96%|█████████▌| 43/45 [00:02<00:00, 29.06it/s]100%|██████████| 45/45 [00:02<00:00, 16.33it/s]
5640 images processed, 2.790297269821167 seconds used

23.550127744674683
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.82  98.70
places365     71.72  80.55
LSUN          33.61  93.83
iSUN          77.03  79.32
dtd           45.92  89.79
AVG           46.82  88.44
Retain-Acc: 0.7361
Forget-as-OOD (retain known vs forget novel):
  FPR: 47.90 AUROC: 89.99 AUIN: 98.69
45.646753787994385
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-seen_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-ol1-stage2-seen_rf.png
