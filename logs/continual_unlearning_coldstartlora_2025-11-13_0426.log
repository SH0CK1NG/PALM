nohup: ignoring input
runner-incremental-continual-forget.sh: line 76: [false: command not found
==== Stage 1: inc={0,8,11,40,51}; seen={}; all(union)={0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:168: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [00:16<13:32, 16.58s/it]  4%|▍         | 2/50 [00:26<09:54, 12.39s/it]  6%|▌         | 3/50 [00:35<08:44, 11.16s/it]  8%|▊         | 4/50 [00:43<07:39, 10.00s/it] 10%|█         | 5/50 [00:54<07:31, 10.04s/it] 12%|█▏        | 6/50 [01:04<07:29, 10.22s/it][loss] ep 0 it 0 total=8.0836 mle=1.4625 pcon=5.2950 forget=1.3262 orth=0.0000 favg=0.0000 nr=118 nf=4 protos=570 fproto_sim=NA
[loss] ep 0 it 50 total=8.1491 mle=1.4668 pcon=5.2874 forget=1.3950 orth=0.0000 favg=0.0000 nr=116 nf=8 protos=570 fproto_sim=NA
[loss] ep 0 it 100 total=8.1396 mle=1.5410 pcon=5.2797 forget=1.3189 orth=0.0000 favg=0.0000 nr=113 nf=7 protos=570 fproto_sim=NA
[loss] ep 0 it 150 total=8.1106 mle=1.4246 pcon=5.2727 forget=1.4133 orth=0.0000 favg=0.0000 nr=117 nf=7 protos=570 fproto_sim=NA
[loss] ep 0 it 200 total=8.1117 mle=1.5365 pcon=5.2658 forget=1.3094 orth=0.0000 favg=0.0000 nr=121 nf=4 protos=570 fproto_sim=NA
[loss] ep 0 it 250 total=7.9993 mle=1.4140 pcon=5.2591 forget=1.3263 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 0 it 300 total=8.2220 mle=1.5024 pcon=5.2521 forget=1.4674 orth=0.0000 favg=0.0000 nr=105 nf=11 protos=570 fproto_sim=NA
[loss] ep 0 it 350 total=8.0669 mle=1.3691 pcon=5.2456 forget=1.4522 orth=0.0000 favg=0.0000 nr=119 nf=4 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 1 it 9 total=7.8825 mle=1.3110 pcon=5.2393 forget=1.3322 orth=0.0000 favg=0.0000 nr=111 nf=5 protos=570 fproto_sim=NA
[loss] ep 1 it 59 total=8.1409 mle=1.5582 pcon=5.2332 forget=1.3494 orth=0.0000 favg=0.0000 nr=120 nf=7 protos=570 fproto_sim=NA
[loss] ep 1 it 109 total=8.0208 mle=1.3991 pcon=5.2273 forget=1.3943 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 1 it 159 total=8.1115 mle=1.5266 pcon=5.2214 forget=1.3635 orth=0.0000 favg=0.0000 nr=113 nf=8 protos=570 fproto_sim=NA
[loss] ep 1 it 209 total=8.0304 mle=1.3629 pcon=5.2157 forget=1.4519 orth=0.0000 favg=0.0000 nr=114 nf=8 protos=570 fproto_sim=NA
[loss] ep 1 it 259 total=8.1440 mle=1.5226 pcon=5.2105 forget=1.4109 orth=0.0000 favg=0.0000 nr=118 nf=6 protos=570 fproto_sim=NA
[loss] ep 1 it 309 total=7.8865 mle=1.3270 pcon=5.2049 forget=1.3546 orth=0.0000 favg=0.0000 nr=111 nf=8 protos=570 fproto_sim=NA
[loss] ep 1 it 359 total=8.1047 mle=1.4598 pcon=5.1999 forget=1.4450 orth=0.0000 favg=0.0000 nr=120 nf=3 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 2 it 18 total=8.1255 mle=1.5142 pcon=5.1954 forget=1.4160 orth=0.0000 favg=0.0000 nr=115 nf=5 protos=570 fproto_sim=NA
[loss] ep 2 it 68 total=8.0182 mle=1.4825 pcon=5.1908 forget=1.3449 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[loss] ep 2 it 118 total=7.8473 mle=1.3158 pcon=5.1864 forget=1.3451 orth=0.0000 favg=0.0000 nr=120 nf=4 protos=570 fproto_sim=NA
[loss] ep 2 it 168 total=7.9946 mle=1.4520 pcon=5.1813 forget=1.3613 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 2 it 218 total=7.8695 mle=1.2730 pcon=5.1770 forget=1.4195 orth=0.0000 favg=0.0000 nr=121 nf=4 protos=570 fproto_sim=NA
[loss] ep 2 it 268 total=7.9293 mle=1.4083 pcon=5.1726 forget=1.3484 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 2 it 318 total=7.9546 mle=1.3860 pcon=5.1686 forget=1.4000 orth=0.0000 favg=0.0000 nr=105 nf=16 protos=570 fproto_sim=NA
[loss] ep 2 it 368 total=7.7879 mle=1.2777 pcon=5.1647 forget=1.3455 orth=0.0000 favg=0.0000 nr=120 nf=4 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 3 it 27 total=8.0880 mle=1.5936 pcon=5.1608 forget=1.3336 orth=0.0000 favg=0.0000 nr=118 nf=3 protos=570 fproto_sim=NA
[loss] ep 3 it 77 total=7.8611 mle=1.3720 pcon=5.1569 forget=1.3322 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 3 it 127 total=7.8863 mle=1.3912 pcon=5.1531 forget=1.3421 orth=0.0000 favg=0.0000 nr=116 nf=6 protos=570 fproto_sim=NA
[loss] ep 3 it 177 total=7.9033 mle=1.3910 pcon=5.1495 forget=1.3629 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 3 it 227 total=7.8491 mle=1.3911 pcon=5.1461 forget=1.3119 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 3 it 277 total=7.9297 mle=1.4156 pcon=5.1430 forget=1.3710 orth=0.0000 favg=0.0000 nr=115 nf=6 protos=570 fproto_sim=NA
[loss] ep 3 it 327 total=7.8833 mle=1.3929 pcon=5.1398 forget=1.3507 orth=0.0000 favg=0.0000 nr=118 nf=6 protos=570 fproto_sim=NA
[loss] ep 3 it 377 total=7.9665 mle=1.5093 pcon=5.1367 forget=1.3206 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 4 it 36 total=7.9286 mle=1.4202 pcon=5.1337 forget=1.3747 orth=0.0000 favg=0.0000 nr=115 nf=8 protos=570 fproto_sim=NA
[loss] ep 4 it 86 total=8.0192 mle=1.4614 pcon=5.1308 forget=1.4271 orth=0.0000 favg=0.0000 nr=119 nf=6 protos=570 fproto_sim=NA
[loss] ep 4 it 136 total=7.9035 mle=1.4010 pcon=5.1281 forget=1.3745 orth=0.0000 favg=0.0000 nr=110 nf=10 protos=570 fproto_sim=NA
[loss] ep 4 it 186 total=7.8183 mle=1.3580 pcon=5.1250 forget=1.3354 orth=0.0000 favg=0.0000 nr=115 nf=4 protos=570 fproto_sim=NA
[loss] ep 4 it 236 total=7.9484 mle=1.5012 pcon=5.1226 forget=1.3247 orth=0.0000 favg=0.0000 nr=113 nf=9 protos=570 fproto_sim=NA
[loss] ep 4 it 286 total=7.8306 mle=1.4073 pcon=5.1198 forget=1.3035 orth=0.0000 favg=0.0000 nr=115 nf=3 protos=570 fproto_sim=NA
[loss] ep 4 it 336 total=7.8789 mle=1.4575 pcon=5.1171 forget=1.3042 orth=0.0000 favg=0.0000 nr=114 nf=5 protos=570 fproto_sim=NA
[loss] ep 4 it 386 total=7.9659 mle=1.3962 pcon=5.1146 forget=1.4551 orth=0.0000 favg=0.0000 nr=120 nf=2 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 5 it 45 total=7.9147 mle=1.3790 pcon=5.1116 forget=1.4242 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[loss] ep 5 it 95 total=7.9701 mle=1.4652 pcon=5.1095 forget=1.3955 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 5 it 145 total=7.8289 mle=1.3727 pcon=5.1071 forget=1.3491 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 5 it 195 total=7.8593 mle=1.3861 pcon=5.1052 forget=1.3680 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 5 it 245 total=7.9409 mle=1.5021 pcon=5.1027 forget=1.3361 orth=0.0000 favg=0.0000 nr=114 nf=7 protos=570 fproto_sim=NA
[loss] ep 5 it 295 total=7.8205 mle=1.4023 pcon=5.1008 forget=1.3175 orth=0.0000 favg=0.0000 nr=120 nf=7 protos=570 fproto_sim=NA
[loss] ep 5 it 345 total=7.8758 mle=1.4461 pcon=5.0988 forget=1.3309 orth=0.0000 favg=0.0000 nr=110 nf=10 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 6 it 4 total=7.8279 mle=1.4115 pcon=5.0967 forget=1.3197 orth=0.0000 favg=0.0000 nr=117 nf=7 protos=570 fproto_sim=NA
[loss] ep 6 it 54 total=7.8911 mle=1.4705 pcon=5.0947 forget=1.3260 orth=0.0000 favg=0.0000 nr=112 nf=7 protos=570 fproto_sim=NA
[loss] ep 6 it 104 total=7.8994 mle=1.4540 pcon=5.0929 forget=1.3526 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 6 it 154 total=7.8347 mle=1.4049 pcon=5.0911 forget=1.3387 orth=0.0000 favg=0.0000 nr=119 nf=3 protos=570 fproto_sim=NA
[loss] ep 6 it 204 total=7.9223 mle=1.4829 pcon=5.0890 forget=1.3504 orth=0.0000 favg=0.0000 nr=118 nf=5 protos=570 fproto_sim=NA
 14%|█▍        | 7/50 [01:14<07:13, 10.08s/it] 16%|█▌        | 8/50 [01:22<06:33,  9.37s/it] 18%|█▊        | 9/50 [01:38<07:55, 11.60s/it] 20%|██        | 10/50 [01:49<07:32, 11.32s/it] 22%|██▏       | 11/50 [01:57<06:43, 10.36s/it] 24%|██▍       | 12/50 [02:07<06:30, 10.29s/it] 26%|██▌       | 13/50 [02:16<06:01,  9.76s/it][loss] ep 6 it 254 total=7.8476 mle=1.4144 pcon=5.0876 forget=1.3457 orth=0.0000 favg=0.0000 nr=118 nf=8 protos=570 fproto_sim=NA
[loss] ep 6 it 304 total=8.0094 mle=1.5627 pcon=5.0860 forget=1.3607 orth=0.0000 favg=0.0000 nr=113 nf=4 protos=570 fproto_sim=NA
[loss] ep 6 it 354 total=7.8517 mle=1.4037 pcon=5.0842 forget=1.3638 orth=0.0000 favg=0.0000 nr=118 nf=3 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 7 it 13 total=7.9249 mle=1.4700 pcon=5.0827 forget=1.3722 orth=0.0000 favg=0.0000 nr=112 nf=10 protos=570 fproto_sim=NA
[loss] ep 7 it 63 total=7.9719 mle=1.5547 pcon=5.0812 forget=1.3360 orth=0.0000 favg=0.0000 nr=112 nf=8 protos=570 fproto_sim=NA
[loss] ep 7 it 113 total=8.0448 mle=1.6474 pcon=5.0797 forget=1.3177 orth=0.0000 favg=0.0000 nr=106 nf=9 protos=570 fproto_sim=NA
[loss] ep 7 it 163 total=8.0410 mle=1.6066 pcon=5.0783 forget=1.3561 orth=0.0000 favg=0.0000 nr=111 nf=10 protos=570 fproto_sim=NA
[loss] ep 7 it 213 total=7.8270 mle=1.3641 pcon=5.0768 forget=1.3860 orth=0.0000 favg=0.0000 nr=111 nf=9 protos=570 fproto_sim=NA
[loss] ep 7 it 263 total=7.9362 mle=1.4806 pcon=5.0756 forget=1.3800 orth=0.0000 favg=0.0000 nr=114 nf=7 protos=570 fproto_sim=NA
[loss] ep 7 it 313 total=7.9142 mle=1.5028 pcon=5.0742 forget=1.3372 orth=0.0000 favg=0.0000 nr=113 nf=8 protos=570 fproto_sim=NA
[loss] ep 7 it 363 total=7.9393 mle=1.4749 pcon=5.0728 forget=1.3916 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 8 it 22 total=7.9081 mle=1.4590 pcon=5.0714 forget=1.3777 orth=0.0000 favg=0.0000 nr=119 nf=6 protos=570 fproto_sim=NA
[loss] ep 8 it 72 total=7.8423 mle=1.4561 pcon=5.0700 forget=1.3162 orth=0.0000 favg=0.0000 nr=114 nf=8 protos=570 fproto_sim=NA
[loss] ep 8 it 122 total=7.8876 mle=1.4234 pcon=5.0687 forget=1.3955 orth=0.0000 favg=0.0000 nr=118 nf=3 protos=570 fproto_sim=NA
[loss] ep 8 it 172 total=7.8233 mle=1.3119 pcon=5.0677 forget=1.4437 orth=0.0000 favg=0.0000 nr=124 nf=3 protos=570 fproto_sim=NA
[loss] ep 8 it 222 total=7.7988 mle=1.4369 pcon=5.0664 forget=1.2955 orth=0.0000 favg=0.0000 nr=121 nf=4 protos=570 fproto_sim=NA
[loss] ep 8 it 272 total=7.9101 mle=1.5273 pcon=5.0653 forget=1.3175 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 8 it 322 total=8.0166 mle=1.5228 pcon=5.0641 forget=1.4297 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 8 it 372 total=7.9282 mle=1.5723 pcon=5.0631 forget=1.2928 orth=0.0000 favg=0.0000 nr=114 nf=5 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 9 it 31 total=8.0153 mle=1.5988 pcon=5.0621 forget=1.3543 orth=0.0000 favg=0.0000 nr=114 nf=10 protos=570 fproto_sim=NA
[loss] ep 9 it 81 total=7.8463 mle=1.4211 pcon=5.0610 forget=1.3643 orth=0.0000 favg=0.0000 nr=120 nf=5 protos=570 fproto_sim=NA
[loss] ep 9 it 131 total=7.6920 mle=1.3303 pcon=5.0601 forget=1.3016 orth=0.0000 favg=0.0000 nr=121 nf=2 protos=570 fproto_sim=NA
[loss] ep 9 it 181 total=7.8815 mle=1.4818 pcon=5.0592 forget=1.3406 orth=0.0000 favg=0.0000 nr=122 nf=2 protos=570 fproto_sim=NA
[loss] ep 9 it 231 total=7.7999 mle=1.4355 pcon=5.0582 forget=1.3062 orth=0.0000 favg=0.0000 nr=118 nf=6 protos=570 fproto_sim=NA
[loss] ep 9 it 281 total=7.9354 mle=1.5781 pcon=5.0575 forget=1.2998 orth=0.0000 favg=0.0000 nr=122 nf=4 protos=570 fproto_sim=NA
[loss] ep 9 it 331 total=7.7872 mle=1.4256 pcon=5.0566 forget=1.3050 orth=0.0000 favg=0.0000 nr=117 nf=7 protos=570 fproto_sim=NA
[loss] ep 9 it 381 total=7.7238 mle=1.3682 pcon=5.0552 forget=1.3004 orth=0.0000 favg=0.0000 nr=115 nf=5 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 10 it 40 total=8.0000 mle=1.3839 pcon=5.0547 forget=1.5614 orth=0.0000 favg=0.0000 nr=123 nf=2 protos=570 fproto_sim=NA
[loss] ep 10 it 90 total=7.9282 mle=1.5552 pcon=5.0535 forget=1.3195 orth=0.0000 favg=0.0000 nr=113 nf=10 protos=570 fproto_sim=NA
[loss] ep 10 it 140 total=7.8481 mle=1.4214 pcon=5.0529 forget=1.3739 orth=0.0000 favg=0.0000 nr=117 nf=7 protos=570 fproto_sim=NA
[loss] ep 10 it 190 total=7.9117 mle=1.5360 pcon=5.0523 forget=1.3234 orth=0.0000 favg=0.0000 nr=118 nf=7 protos=570 fproto_sim=NA
[loss] ep 10 it 240 total=7.8143 mle=1.4415 pcon=5.0518 forget=1.3210 orth=0.0000 favg=0.0000 nr=121 nf=5 protos=570 fproto_sim=NA
[loss] ep 10 it 290 total=7.9040 mle=1.5250 pcon=5.0508 forget=1.3282 orth=0.0000 favg=0.0000 nr=107 nf=9 protos=570 fproto_sim=NA
[loss] ep 10 it 340 total=7.7250 mle=1.3379 pcon=5.0504 forget=1.3367 orth=0.0000 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[loss] ep 10 it 390 total=8.0774 mle=1.7144 pcon=5.0499 forget=1.3131 orth=0.0000 favg=0.0000 nr=74 nf=3 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 11 it 49 total=7.7503 mle=1.4155 pcon=5.0492 forget=1.2856 orth=0.0000 favg=0.0000 nr=117 nf=2 protos=570 fproto_sim=NA
[loss] ep 11 it 99 total=7.7870 mle=1.4100 pcon=5.0484 forget=1.3286 orth=0.0000 favg=0.0000 nr=113 nf=9 protos=570 fproto_sim=NA
[loss] ep 11 it 149 total=7.8830 mle=1.4488 pcon=5.0476 forget=1.3866 orth=0.0000 favg=0.0000 nr=111 nf=8 protos=570 fproto_sim=NA
[loss] ep 11 it 199 total=7.7631 mle=1.3623 pcon=5.0465 forget=1.3543 orth=0.0000 favg=0.0000 nr=119 nf=6 protos=570 fproto_sim=NA
[loss] ep 11 it 249 total=7.8485 mle=1.4621 pcon=5.0456 forget=1.3408 orth=0.0000 favg=0.0000 nr=119 nf=6 protos=570 fproto_sim=NA
[loss] ep 11 it 299 total=7.9739 mle=1.5961 pcon=5.0451 forget=1.3327 orth=0.0000 favg=0.0000 nr=112 nf=10 protos=570 fproto_sim=NA
[loss] ep 11 it 349 total=7.7592 mle=1.4148 pcon=5.0442 forget=1.3002 orth=0.0000 favg=0.0000 nr=116 nf=5 protos=570 fproto_sim=NA
[loss] ep 12 it 8 total=7.9950 mle=1.5814 pcon=5.0432 forget=1.3704 orth=0.0000 favg=0.0000 nr=118 nf=5 protos=570 fproto_sim=NA
[loss] ep 12 it 58 total=7.8478 mle=1.5093 pcon=5.0423 forget=1.2961 orth=0.0000 favg=0.0000 nr=120 nf=6 protos=570 fproto_sim=NA
[loss] ep 12 it 108 total=7.9540 mle=1.5421 pcon=5.0415 forget=1.3704 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 12 it 158 total=7.7846 mle=1.4381 pcon=5.0409 forget=1.3055 orth=0.0000 favg=0.0000 nr=115 nf=8 protos=570 fproto_sim=NA
[loss] ep 12 it 208 total=7.7468 mle=1.4066 pcon=5.0400 forget=1.3002 orth=0.0000 favg=0.0000 nr=121 nf=3 protos=570 fproto_sim=NA
[loss] ep 12 it 258 total=7.9173 mle=1.5627 pcon=5.0393 forget=1.3153 orth=0.0000 favg=0.0000 nr=110 nf=11 protos=570 fproto_sim=NA
[loss] ep 12 it 308 total=7.9504 mle=1.5214 pcon=5.0390 forget=1.3900 orth=0.0000 favg=0.0000 nr=118 nf=6 protos=570 fproto_sim=NA
[loss] ep 12 it 358 total=7.8379 mle=1.5018 pcon=5.0386 forget=1.2975 orth=0.0000 favg=0.0000 nr=117 nf=3 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 13 it 17 total=7.8877 mle=1.5500 pcon=5.0376 forget=1.3001 orth=0.0000 favg=0.0000 nr=114 nf=8 protos=570 fproto_sim=NA
[loss] ep 13 it 67 total=7.7806 mle=1.4439 pcon=5.0369 forget=1.2998 orth=0.0000 favg=0.0000 nr=116 nf=6 protos=570 fproto_sim=NA
 28%|██▊       | 14/50 [02:25<05:40,  9.46s/it] 30%|███       | 15/50 [02:33<05:19,  9.12s/it] 32%|███▏      | 16/50 [02:42<05:06,  9.03s/it] 34%|███▍      | 17/50 [02:51<04:59,  9.07s/it] 36%|███▌      | 18/50 [03:00<04:47,  8.97s/it] 38%|███▊      | 19/50 [03:09<04:38,  9.00s/it] 40%|████      | 20/50 [03:17<04:26,  8.87s/it][loss] ep 13 it 117 total=7.8034 mle=1.4474 pcon=5.0363 forget=1.3197 orth=0.0000 favg=0.0000 nr=113 nf=8 protos=570 fproto_sim=NA
[loss] ep 13 it 167 total=7.7846 mle=1.4491 pcon=5.0356 forget=1.2999 orth=0.0000 favg=0.0000 nr=114 nf=7 protos=570 fproto_sim=NA
[loss] ep 13 it 217 total=7.8058 mle=1.4419 pcon=5.0351 forget=1.3287 orth=0.0000 favg=0.0000 nr=111 nf=12 protos=570 fproto_sim=NA
[loss] ep 13 it 267 total=7.7575 mle=1.4152 pcon=5.0345 forget=1.3078 orth=0.0000 favg=0.0000 nr=115 nf=9 protos=570 fproto_sim=NA
[loss] ep 13 it 317 total=7.6297 mle=1.2774 pcon=5.0339 forget=1.3184 orth=0.0000 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[loss] ep 13 it 367 total=7.7126 mle=1.3664 pcon=5.0336 forget=1.3125 orth=0.0000 favg=0.0000 nr=113 nf=8 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 14 it 26 total=7.9490 mle=1.5407 pcon=5.0333 forget=1.3750 orth=0.0000 favg=0.0000 nr=114 nf=9 protos=570 fproto_sim=NA
[loss] ep 14 it 76 total=7.7971 mle=1.4308 pcon=5.0330 forget=1.3334 orth=0.0000 favg=0.0000 nr=115 nf=8 protos=570 fproto_sim=NA
[loss] ep 14 it 126 total=7.8573 mle=1.5155 pcon=5.0324 forget=1.3095 orth=0.0000 favg=0.0000 nr=111 nf=8 protos=570 fproto_sim=NA
[loss] ep 14 it 176 total=7.7822 mle=1.4417 pcon=5.0320 forget=1.3085 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[loss] ep 14 it 226 total=7.7690 mle=1.4251 pcon=5.0315 forget=1.3124 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 14 it 276 total=7.8666 mle=1.5214 pcon=5.0311 forget=1.3141 orth=0.0000 favg=0.0000 nr=116 nf=5 protos=570 fproto_sim=NA
[loss] ep 14 it 326 total=7.8589 mle=1.4932 pcon=5.0301 forget=1.3357 orth=0.0000 favg=0.0000 nr=118 nf=6 protos=570 fproto_sim=NA
[loss] ep 14 it 376 total=7.8769 mle=1.5208 pcon=5.0299 forget=1.3262 orth=0.0000 favg=0.0000 nr=121 nf=2 protos=570 fproto_sim=NA
[loss] ep 15 it 35 total=7.7681 mle=1.3987 pcon=5.0292 forget=1.3402 orth=0.0000 favg=0.0000 nr=113 nf=7 protos=570 fproto_sim=NA
[loss] ep 15 it 85 total=7.7744 mle=1.3754 pcon=5.0286 forget=1.3704 orth=0.0000 favg=0.0000 nr=116 nf=5 protos=570 fproto_sim=NA
[loss] ep 15 it 135 total=7.8071 mle=1.4632 pcon=5.0283 forget=1.3157 orth=0.0000 favg=0.0000 nr=119 nf=6 protos=570 fproto_sim=NA
[loss] ep 15 it 185 total=7.8312 mle=1.4418 pcon=5.0280 forget=1.3614 orth=0.0000 favg=0.0000 nr=119 nf=5 protos=570 fproto_sim=NA
[loss] ep 15 it 235 total=7.7693 mle=1.3900 pcon=5.0275 forget=1.3518 orth=0.0000 favg=0.0000 nr=113 nf=11 protos=570 fproto_sim=NA
[loss] ep 15 it 285 total=7.7756 mle=1.4064 pcon=5.0272 forget=1.3421 orth=0.0000 favg=0.0000 nr=114 nf=7 protos=570 fproto_sim=NA
[loss] ep 15 it 335 total=7.9430 mle=1.5947 pcon=5.0267 forget=1.3215 orth=0.0000 favg=0.0000 nr=107 nf=9 protos=570 fproto_sim=NA
[loss] ep 15 it 385 total=7.8404 mle=1.4791 pcon=5.0261 forget=1.3352 orth=0.0000 favg=0.0000 nr=112 nf=8 protos=570 fproto_sim=NA
[loss] ep 16 it 44 total=7.8448 mle=1.4953 pcon=5.0252 forget=1.3244 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 16 it 94 total=7.7800 mle=1.4383 pcon=5.0248 forget=1.3169 orth=0.0000 favg=0.0000 nr=115 nf=6 protos=570 fproto_sim=NA
[loss] ep 16 it 144 total=7.7429 mle=1.3848 pcon=5.0242 forget=1.3338 orth=0.0000 favg=0.0000 nr=112 nf=7 protos=570 fproto_sim=NA
[loss] ep 16 it 194 total=7.8892 mle=1.4787 pcon=5.0234 forget=1.3871 orth=0.0000 favg=0.0000 nr=115 nf=5 protos=570 fproto_sim=NA
[loss] ep 16 it 244 total=7.8041 mle=1.4096 pcon=5.0229 forget=1.3716 orth=0.0000 favg=0.0000 nr=110 nf=10 protos=570 fproto_sim=NA
[loss] ep 16 it 294 total=7.7903 mle=1.4055 pcon=5.0224 forget=1.3624 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 16 it 344 total=7.9102 mle=1.4589 pcon=5.0218 forget=1.4294 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 17 it 3 total=7.7442 mle=1.3416 pcon=5.0215 forget=1.3810 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 17 it 53 total=7.7929 mle=1.4355 pcon=5.0210 forget=1.3364 orth=0.0000 favg=0.0000 nr=120 nf=4 protos=570 fproto_sim=NA
[loss] ep 17 it 103 total=7.7761 mle=1.4086 pcon=5.0205 forget=1.3470 orth=0.0000 favg=0.0000 nr=116 nf=7 protos=570 fproto_sim=NA
[loss] ep 17 it 153 total=7.8395 mle=1.4427 pcon=5.0198 forget=1.3770 orth=0.0000 favg=0.0000 nr=118 nf=2 protos=570 fproto_sim=NA
[loss] ep 17 it 203 total=7.8562 mle=1.4559 pcon=5.0191 forget=1.3812 orth=0.0000 favg=0.0000 nr=118 nf=6 protos=570 fproto_sim=NA
[loss] ep 17 it 253 total=7.8672 mle=1.4872 pcon=5.0183 forget=1.3618 orth=0.0000 favg=0.0000 nr=112 nf=8 protos=570 fproto_sim=NA
[loss] ep 17 it 303 total=7.7488 mle=1.3759 pcon=5.0176 forget=1.3554 orth=0.0000 favg=0.0000 nr=112 nf=7 protos=570 fproto_sim=NA
[loss] ep 17 it 353 total=7.9029 mle=1.4845 pcon=5.0166 forget=1.4018 orth=0.0000 favg=0.0000 nr=112 nf=8 protos=570 fproto_sim=NA
[loss] ep 18 it 12 total=7.7992 mle=1.4462 pcon=5.0161 forget=1.3369 orth=0.0000 favg=0.0000 nr=120 nf=3 protos=570 fproto_sim=NA
[loss] ep 18 it 62 total=7.8603 mle=1.4758 pcon=5.0153 forget=1.3692 orth=0.0000 favg=0.0000 nr=114 nf=11 protos=570 fproto_sim=NA
[loss] ep 18 it 112 total=7.6405 mle=1.2835 pcon=5.0150 forget=1.3420 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 18 it 162 total=7.7724 mle=1.3542 pcon=5.0140 forget=1.4042 orth=0.0000 favg=0.0000 nr=112 nf=8 protos=570 fproto_sim=NA
[loss] ep 18 it 212 total=7.7835 mle=1.4271 pcon=5.0130 forget=1.3434 orth=0.0000 favg=0.0000 nr=113 nf=7 protos=570 fproto_sim=NA
[loss] ep 18 it 262 total=7.8225 mle=1.4091 pcon=5.0121 forget=1.4013 orth=0.0000 favg=0.0000 nr=113 nf=5 protos=570 fproto_sim=NA
[loss] ep 18 it 312 total=7.9532 mle=1.5586 pcon=5.0111 forget=1.3835 orth=0.0000 favg=0.0000 nr=113 nf=6 protos=570 fproto_sim=NA
[loss] ep 18 it 362 total=7.9102 mle=1.5202 pcon=5.0101 forget=1.3799 orth=0.0000 favg=0.0000 nr=116 nf=7 protos=570 fproto_sim=NA
[loss] ep 19 it 21 total=7.7854 mle=1.4103 pcon=5.0094 forget=1.3658 orth=0.0000 favg=0.0000 nr=117 nf=3 protos=570 fproto_sim=NA
[loss] ep 19 it 71 total=7.8884 mle=1.4701 pcon=5.0083 forget=1.4100 orth=0.0000 favg=0.0000 nr=113 nf=10 protos=570 fproto_sim=NA
[loss] ep 19 it 121 total=7.7875 mle=1.4225 pcon=5.0067 forget=1.3582 orth=0.0000 favg=0.0000 nr=118 nf=5 protos=570 fproto_sim=NA
[loss] ep 19 it 171 total=7.8080 mle=1.4378 pcon=5.0056 forget=1.3647 orth=0.0000 favg=0.0000 nr=111 nf=10 protos=570 fproto_sim=NA
[loss] ep 19 it 221 total=8.0585 mle=1.6872 pcon=5.0046 forget=1.3666 orth=0.0000 favg=0.0000 nr=117 nf=7 protos=570 fproto_sim=NA
[loss] ep 19 it 271 total=7.9554 mle=1.5948 pcon=5.0034 forget=1.3571 orth=0.0000 favg=0.0000 nr=119 nf=6 protos=570 fproto_sim=NA
[loss] ep 19 it 321 total=7.8606 mle=1.4715 pcon=5.0026 forget=1.3864 orth=0.0000 favg=0.0000 nr=112 nf=8 protos=570 fproto_sim=NA
[loss] ep 19 it 371 total=7.7867 mle=1.4179 pcon=5.0011 forget=1.3677 orth=0.0000 favg=0.0000 nr=116 nf=6 protos=570 fproto_sim=NA
[loss] ep 20 it 30 total=7.7077 mle=1.3604 pcon=5.0002 forget=1.3471 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[loss] ep 20 it 80 total=7.8238 mle=1.4793 pcon=4.9986 forget=1.3459 orth=0.0000 favg=0.0000 nr=119 nf=3 protos=570 fproto_sim=NA
[loss] ep 20 it 130 total=7.7875 mle=1.4669 pcon=4.9975 forget=1.3231 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 20 it 180 total=7.9998 mle=1.5952 pcon=4.9963 forget=1.4083 orth=0.0000 favg=0.0000 nr=119 nf=4 protos=570 fproto_sim=NA
[loss] ep 20 it 230 total=7.8157 mle=1.4045 pcon=4.9950 forget=1.4163 orth=0.0000 favg=0.0000 nr=118 nf=7 protos=570 fproto_sim=NA
[loss] ep 20 it 280 total=7.8045 mle=1.4625 pcon=4.9936 forget=1.3485 orth=0.0000 favg=0.0000 nr=112 nf=5 protos=570 fproto_sim=NA
[loss] ep 20 it 330 total=7.8933 mle=1.5613 pcon=4.9921 forget=1.3398 orth=0.0000 favg=0.0000 nr=115 nf=8 protos=570 fproto_sim=NA
 42%|████▏     | 21/50 [03:27<04:26,  9.20s/it] 44%|████▍     | 22/50 [03:37<04:20,  9.29s/it] 46%|████▌     | 23/50 [03:46<04:12,  9.35s/it] 48%|████▊     | 24/50 [03:55<04:00,  9.26s/it] 50%|█████     | 25/50 [04:03<03:43,  8.92s/it] 52%|█████▏    | 26/50 [04:15<03:52,  9.71s/it] 54%|█████▍    | 27/50 [04:25<03:46,  9.86s/it][loss] ep 20 it 380 total=7.9123 mle=1.5423 pcon=4.9909 forget=1.3792 orth=0.0000 favg=0.0000 nr=114 nf=7 protos=570 fproto_sim=NA
[loss] ep 21 it 39 total=7.7683 mle=1.4354 pcon=4.9894 forget=1.3435 orth=0.0000 favg=0.0000 nr=116 nf=8 protos=570 fproto_sim=NA
[loss] ep 21 it 89 total=7.7401 mle=1.3979 pcon=4.9879 forget=1.3543 orth=0.0000 favg=0.0000 nr=113 nf=7 protos=570 fproto_sim=NA
[loss] ep 21 it 139 total=7.8236 mle=1.4949 pcon=4.9864 forget=1.3423 orth=0.0000 favg=0.0000 nr=115 nf=9 protos=570 fproto_sim=NA
[loss] ep 21 it 189 total=7.9766 mle=1.6141 pcon=4.9849 forget=1.3777 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 21 it 239 total=7.8386 mle=1.5188 pcon=4.9835 forget=1.3364 orth=0.0000 favg=0.0000 nr=111 nf=5 protos=570 fproto_sim=NA
[loss] ep 21 it 289 total=7.8108 mle=1.4576 pcon=4.9817 forget=1.3715 orth=0.0000 favg=0.0000 nr=116 nf=7 protos=570 fproto_sim=NA
[loss] ep 21 it 339 total=7.7029 mle=1.3705 pcon=4.9801 forget=1.3523 orth=0.0000 favg=0.0000 nr=115 nf=8 protos=570 fproto_sim=NA
[loss] ep 21 it 389 total=7.8732 mle=1.5664 pcon=4.9783 forget=1.3285 orth=0.0000 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 22 it 48 total=7.7724 mle=1.4097 pcon=4.9762 forget=1.3866 orth=0.0000 favg=0.0000 nr=109 nf=13 protos=570 fproto_sim=NA
[loss] ep 22 it 98 total=7.7724 mle=1.5019 pcon=4.9746 forget=1.2960 orth=0.0000 favg=0.0000 nr=113 nf=7 protos=570 fproto_sim=NA
[loss] ep 22 it 148 total=7.7625 mle=1.4340 pcon=4.9727 forget=1.3557 orth=0.0000 favg=0.0000 nr=113 nf=11 protos=570 fproto_sim=NA
[loss] ep 22 it 198 total=7.6795 mle=1.3876 pcon=4.9708 forget=1.3211 orth=0.0000 favg=0.0000 nr=115 nf=8 protos=570 fproto_sim=NA
[loss] ep 22 it 248 total=7.8034 mle=1.4981 pcon=4.9690 forget=1.3363 orth=0.0000 favg=0.0000 nr=113 nf=7 protos=570 fproto_sim=NA
[loss] ep 22 it 298 total=7.7120 mle=1.4561 pcon=4.9671 forget=1.2888 orth=0.0000 favg=0.0000 nr=120 nf=5 protos=570 fproto_sim=NA
[loss] ep 22 it 348 total=7.8301 mle=1.5194 pcon=4.9650 forget=1.3457 orth=0.0000 favg=0.0000 nr=113 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 23 it 7 total=7.8357 mle=1.5547 pcon=4.9629 forget=1.3181 orth=0.0000 favg=0.0000 nr=116 nf=6 protos=570 fproto_sim=NA
[loss] ep 23 it 57 total=7.8503 mle=1.5135 pcon=4.9605 forget=1.3763 orth=0.0000 favg=0.0000 nr=111 nf=9 protos=570 fproto_sim=NA
[loss] ep 23 it 107 total=7.6959 mle=1.4093 pcon=4.9582 forget=1.3283 orth=0.0000 favg=0.0000 nr=119 nf=4 protos=570 fproto_sim=NA
[loss] ep 23 it 157 total=7.8076 mle=1.4840 pcon=4.9564 forget=1.3672 orth=0.0000 favg=0.0000 nr=113 nf=5 protos=570 fproto_sim=NA
[loss] ep 23 it 207 total=7.8531 mle=1.5259 pcon=4.9541 forget=1.3731 orth=0.0000 favg=0.0000 nr=112 nf=7 protos=570 fproto_sim=NA
[loss] ep 23 it 257 total=7.7465 mle=1.4674 pcon=4.9515 forget=1.3276 orth=0.0000 favg=0.0000 nr=114 nf=5 protos=570 fproto_sim=NA
[loss] ep 23 it 307 total=8.0193 mle=1.7044 pcon=4.9491 forget=1.3658 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 23 it 357 total=7.6307 mle=1.4029 pcon=4.9467 forget=1.2811 orth=0.0000 favg=0.0000 nr=116 nf=4 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 24 it 16 total=7.8002 mle=1.4944 pcon=4.9443 forget=1.3615 orth=0.0000 favg=0.0000 nr=113 nf=6 protos=570 fproto_sim=NA
[loss] ep 24 it 66 total=7.6502 mle=1.4160 pcon=4.9419 forget=1.2923 orth=0.0000 favg=0.0000 nr=118 nf=4 protos=570 fproto_sim=NA
[loss] ep 24 it 116 total=7.8729 mle=1.5652 pcon=4.9394 forget=1.3683 orth=0.0000 favg=0.0000 nr=115 nf=4 protos=570 fproto_sim=NA
[loss] ep 24 it 166 total=7.8974 mle=1.5945 pcon=4.9371 forget=1.3658 orth=0.0000 favg=0.0000 nr=118 nf=4 protos=570 fproto_sim=NA
[loss] ep 24 it 216 total=7.7078 mle=1.4005 pcon=4.9349 forget=1.3724 orth=0.0000 favg=0.0000 nr=119 nf=5 protos=570 fproto_sim=NA
[loss] ep 24 it 266 total=7.6865 mle=1.4149 pcon=4.9325 forget=1.3392 orth=0.0000 favg=0.0000 nr=113 nf=4 protos=570 fproto_sim=NA
[loss] ep 24 it 316 total=7.5706 mle=1.3623 pcon=4.9301 forget=1.2783 orth=0.0000 favg=0.0000 nr=118 nf=4 protos=570 fproto_sim=NA
[loss] ep 24 it 366 total=7.9177 mle=1.6618 pcon=4.9278 forget=1.3281 orth=0.0000 favg=0.0000 nr=111 nf=11 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 25 it 25 total=7.7507 mle=1.4694 pcon=4.9252 forget=1.3562 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 25 it 75 total=7.7154 mle=1.4609 pcon=4.9226 forget=1.3319 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 25 it 125 total=7.8421 mle=1.5591 pcon=4.9202 forget=1.3628 orth=0.0000 favg=0.0000 nr=116 nf=7 protos=570 fproto_sim=NA
[loss] ep 25 it 175 total=7.7650 mle=1.5232 pcon=4.9178 forget=1.3241 orth=0.0000 favg=0.0000 nr=112 nf=6 protos=570 fproto_sim=NA
[loss] ep 25 it 225 total=7.7619 mle=1.5631 pcon=4.9155 forget=1.2833 orth=0.0000 favg=0.0000 nr=121 nf=5 protos=570 fproto_sim=NA
[loss] ep 25 it 275 total=7.8429 mle=1.5279 pcon=4.9133 forget=1.4017 orth=0.0000 favg=0.0000 nr=113 nf=7 protos=570 fproto_sim=NA
[loss] ep 25 it 325 total=7.8948 mle=1.6895 pcon=4.9109 forget=1.2944 orth=0.0000 favg=0.0000 nr=119 nf=3 protos=570 fproto_sim=NA
[loss] ep 25 it 375 total=7.8222 mle=1.5861 pcon=4.9088 forget=1.3272 orth=0.0000 favg=0.0000 nr=116 nf=7 protos=570 fproto_sim=NA
[loss] ep 26 it 34 total=7.6980 mle=1.4449 pcon=4.9067 forget=1.3464 orth=0.0000 favg=0.0000 nr=114 nf=8 protos=570 fproto_sim=NA
[loss] ep 26 it 84 total=7.5746 mle=1.3965 pcon=4.9042 forget=1.2738 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 26 it 134 total=7.6629 mle=1.4626 pcon=4.9021 forget=1.2982 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 26 it 184 total=7.8933 mle=1.6128 pcon=4.8996 forget=1.3809 orth=0.0000 favg=0.0000 nr=111 nf=10 protos=570 fproto_sim=NA
[loss] ep 26 it 234 total=7.6441 mle=1.4641 pcon=4.8973 forget=1.2827 orth=0.0000 favg=0.0000 nr=124 nf=2 protos=570 fproto_sim=NA
[loss] ep 26 it 284 total=7.6975 mle=1.4755 pcon=4.8950 forget=1.3270 orth=0.0000 favg=0.0000 nr=112 nf=10 protos=570 fproto_sim=NA
[loss] ep 26 it 334 total=7.8158 mle=1.6415 pcon=4.8930 forget=1.2814 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 26 it 384 total=7.7457 mle=1.5799 pcon=4.8905 forget=1.2753 orth=0.0000 favg=0.0000 nr=119 nf=4 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 27 it 43 total=7.8166 mle=1.5373 pcon=4.8882 forget=1.3911 orth=0.0000 favg=0.0000 nr=111 nf=10 protos=570 fproto_sim=NA
[loss] ep 27 it 93 total=7.7093 mle=1.4782 pcon=4.8861 forget=1.3450 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 27 it 143 total=7.7461 mle=1.4487 pcon=4.8839 forget=1.4136 orth=0.0000 favg=0.0000 nr=116 nf=8 protos=570 fproto_sim=NA
[loss] ep 27 it 193 total=7.7586 mle=1.5434 pcon=4.8817 forget=1.3335 orth=0.0000 favg=0.0000 nr=114 nf=9 protos=570 fproto_sim=NA
[loss] ep 27 it 243 total=7.8030 mle=1.4541 pcon=4.8795 forget=1.4694 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
 56%|█████▌    | 28/50 [04:33<03:26,  9.38s/it] 58%|█████▊    | 29/50 [04:42<03:12,  9.18s/it] 60%|██████    | 30/50 [04:50<02:58,  8.93s/it] 62%|██████▏   | 31/50 [05:01<03:00,  9.52s/it] 64%|██████▍   | 32/50 [05:10<02:48,  9.34s/it] 66%|██████▌   | 33/50 [05:20<02:40,  9.41s/it] 68%|██████▊   | 34/50 [05:31<02:37,  9.84s/it][loss] ep 27 it 293 total=7.9101 mle=1.5639 pcon=4.8775 forget=1.4688 orth=0.0000 favg=0.0000 nr=122 nf=2 protos=570 fproto_sim=NA
[loss] ep 27 it 343 total=7.6757 mle=1.4183 pcon=4.8755 forget=1.3819 orth=0.0000 favg=0.0000 nr=119 nf=4 protos=570 fproto_sim=NA
[loss] ep 28 it 2 total=7.9282 mle=1.5510 pcon=4.8736 forget=1.5036 orth=0.0000 favg=0.0000 nr=113 nf=6 protos=570 fproto_sim=NA
[loss] ep 28 it 52 total=7.8224 mle=1.5803 pcon=4.8720 forget=1.3701 orth=0.0000 favg=0.0000 nr=114 nf=9 protos=570 fproto_sim=NA
[loss] ep 28 it 102 total=7.7755 mle=1.5309 pcon=4.8700 forget=1.3746 orth=0.0000 favg=0.0000 nr=115 nf=5 protos=570 fproto_sim=NA
[loss] ep 28 it 152 total=7.6974 mle=1.5406 pcon=4.8682 forget=1.2886 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[loss] ep 28 it 202 total=7.9308 mle=1.5884 pcon=4.8663 forget=1.4761 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 28 it 252 total=7.9936 mle=1.7709 pcon=4.8646 forget=1.3581 orth=0.0000 favg=0.0000 nr=116 nf=6 protos=570 fproto_sim=NA
[loss] ep 28 it 302 total=7.6262 mle=1.4775 pcon=4.8631 forget=1.2856 orth=0.0000 favg=0.0000 nr=121 nf=3 protos=570 fproto_sim=NA
[loss] ep 28 it 352 total=7.7770 mle=1.5232 pcon=4.8614 forget=1.3924 orth=0.0000 favg=0.0000 nr=114 nf=9 protos=570 fproto_sim=NA
[loss] ep 29 it 11 total=7.7502 mle=1.5066 pcon=4.8595 forget=1.3841 orth=0.0000 favg=0.0000 nr=118 nf=5 protos=570 fproto_sim=NA
[loss] ep 29 it 61 total=7.8150 mle=1.4782 pcon=4.8577 forget=1.4791 orth=0.0000 favg=0.0000 nr=111 nf=9 protos=570 fproto_sim=NA
[loss] ep 29 it 111 total=7.9188 mle=1.6935 pcon=4.8563 forget=1.3690 orth=0.0000 favg=0.0000 nr=111 nf=8 protos=570 fproto_sim=NA
[loss] ep 29 it 161 total=7.6017 mle=1.4477 pcon=4.8546 forget=1.2994 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 29 it 211 total=7.7265 mle=1.5862 pcon=4.8529 forget=1.2874 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 29 it 261 total=7.8570 mle=1.4649 pcon=4.8513 forget=1.5408 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 29 it 311 total=7.6923 mle=1.4630 pcon=4.8497 forget=1.3797 orth=0.0000 favg=0.0000 nr=118 nf=10 protos=570 fproto_sim=NA
[loss] ep 29 it 361 total=7.8800 mle=1.5198 pcon=4.8483 forget=1.5119 orth=0.0000 favg=0.0000 nr=115 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 30 it 20 total=7.7021 mle=1.4870 pcon=4.8469 forget=1.3682 orth=0.0000 favg=0.0000 nr=116 nf=5 protos=570 fproto_sim=NA
[loss] ep 30 it 70 total=7.9144 mle=1.6072 pcon=4.8455 forget=1.4616 orth=0.0000 favg=0.0000 nr=111 nf=8 protos=570 fproto_sim=NA
[loss] ep 30 it 120 total=7.5761 mle=1.4322 pcon=4.8444 forget=1.2995 orth=0.0000 favg=0.0000 nr=118 nf=4 protos=570 fproto_sim=NA
[loss] ep 30 it 170 total=7.6831 mle=1.5232 pcon=4.8428 forget=1.3170 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 30 it 220 total=7.6699 mle=1.5155 pcon=4.8417 forget=1.3127 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 30 it 270 total=7.6487 mle=1.4990 pcon=4.8406 forget=1.3091 orth=0.0000 favg=0.0000 nr=119 nf=2 protos=570 fproto_sim=NA
[loss] ep 30 it 320 total=7.6512 mle=1.5094 pcon=4.8392 forget=1.3026 orth=0.0000 favg=0.0000 nr=111 nf=9 protos=570 fproto_sim=NA
[loss] ep 30 it 370 total=7.7018 mle=1.4930 pcon=4.8379 forget=1.3710 orth=0.0000 favg=0.0000 nr=115 nf=5 protos=570 fproto_sim=NA
[loss] ep 31 it 29 total=7.8449 mle=1.5054 pcon=4.8368 forget=1.5027 orth=0.0000 favg=0.0000 nr=115 nf=6 protos=570 fproto_sim=NA
[loss] ep 31 it 79 total=7.8988 mle=1.6259 pcon=4.8356 forget=1.4374 orth=0.0000 favg=0.0000 nr=115 nf=6 protos=570 fproto_sim=NA
[loss] ep 31 it 129 total=7.7221 mle=1.5133 pcon=4.8344 forget=1.3744 orth=0.0000 favg=0.0000 nr=114 nf=5 protos=570 fproto_sim=NA
[loss] ep 31 it 179 total=7.6915 mle=1.5473 pcon=4.8335 forget=1.3108 orth=0.0000 favg=0.0000 nr=116 nf=7 protos=570 fproto_sim=NA
[loss] ep 31 it 229 total=7.8209 mle=1.5642 pcon=4.8323 forget=1.4244 orth=0.0000 favg=0.0000 nr=111 nf=8 protos=570 fproto_sim=NA
[loss] ep 31 it 279 total=7.5606 mle=1.4348 pcon=4.8313 forget=1.2945 orth=0.0000 favg=0.0000 nr=118 nf=1 protos=570 fproto_sim=NA
[loss] ep 31 it 329 total=7.8662 mle=1.6092 pcon=4.8304 forget=1.4266 orth=0.0000 favg=0.0000 nr=116 nf=6 protos=570 fproto_sim=NA
[loss] ep 31 it 379 total=7.7230 mle=1.5235 pcon=4.8294 forget=1.3701 orth=0.0000 favg=0.0000 nr=112 nf=11 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 32 it 38 total=7.6291 mle=1.4687 pcon=4.8287 forget=1.3317 orth=0.0000 favg=0.0000 nr=114 nf=8 protos=570 fproto_sim=NA
[loss] ep 32 it 88 total=7.7473 mle=1.5430 pcon=4.8277 forget=1.3766 orth=0.0000 favg=0.0000 nr=114 nf=10 protos=570 fproto_sim=NA
[loss] ep 32 it 138 total=7.7457 mle=1.5100 pcon=4.8267 forget=1.4090 orth=0.0000 favg=0.0000 nr=113 nf=9 protos=570 fproto_sim=NA
[loss] ep 32 it 188 total=7.9144 mle=1.5391 pcon=4.8257 forget=1.5496 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 32 it 238 total=7.6531 mle=1.5082 pcon=4.8249 forget=1.3201 orth=0.0000 favg=0.0000 nr=116 nf=6 protos=570 fproto_sim=NA
[loss] ep 32 it 288 total=7.6006 mle=1.4230 pcon=4.8241 forget=1.3534 orth=0.0000 favg=0.0000 nr=112 nf=5 protos=570 fproto_sim=NA
[loss] ep 32 it 338 total=7.7308 mle=1.5783 pcon=4.8232 forget=1.3293 orth=0.0000 favg=0.0000 nr=115 nf=6 protos=570 fproto_sim=NA
[loss] ep 32 it 388 total=7.7045 mle=1.5600 pcon=4.8225 forget=1.3220 orth=0.0000 favg=0.0000 nr=120 nf=2 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 33 it 47 total=7.8117 mle=1.6456 pcon=4.8215 forget=1.3446 orth=0.0000 favg=0.0000 nr=112 nf=8 protos=570 fproto_sim=NA
[loss] ep 33 it 97 total=7.6672 mle=1.5549 pcon=4.8207 forget=1.2915 orth=0.0000 favg=0.0000 nr=115 nf=6 protos=570 fproto_sim=NA
[loss] ep 33 it 147 total=7.7593 mle=1.6238 pcon=4.8196 forget=1.3158 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 33 it 197 total=7.6380 mle=1.4630 pcon=4.8187 forget=1.3563 orth=0.0000 favg=0.0000 nr=119 nf=6 protos=570 fproto_sim=NA
[loss] ep 33 it 247 total=7.6854 mle=1.5405 pcon=4.8180 forget=1.3269 orth=0.0000 favg=0.0000 nr=114 nf=8 protos=570 fproto_sim=NA
[loss] ep 33 it 297 total=7.6208 mle=1.5145 pcon=4.8172 forget=1.2891 orth=0.0000 favg=0.0000 nr=119 nf=2 protos=570 fproto_sim=NA
[loss] ep 33 it 347 total=7.7060 mle=1.5691 pcon=4.8163 forget=1.3206 orth=0.0000 favg=0.0000 nr=112 nf=7 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 34 it 6 total=7.6546 mle=1.5038 pcon=4.8152 forget=1.3355 orth=0.0000 favg=0.0000 nr=109 nf=9 protos=570 fproto_sim=NA
[loss] ep 34 it 56 total=7.6318 mle=1.4947 pcon=4.8143 forget=1.3228 orth=0.0000 favg=0.0000 nr=119 nf=5 protos=570 fproto_sim=NA
[loss] ep 34 it 106 total=7.6251 mle=1.4989 pcon=4.8136 forget=1.3126 orth=0.0000 favg=0.0000 nr=119 nf=4 protos=570 fproto_sim=NA
[loss] ep 34 it 156 total=7.7108 mle=1.5575 pcon=4.8126 forget=1.3407 orth=0.0000 favg=0.0000 nr=116 nf=4 protos=570 fproto_sim=NA
[loss] ep 34 it 206 total=7.5175 mle=1.3812 pcon=4.8118 forget=1.3245 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 34 it 256 total=7.7139 mle=1.4875 pcon=4.8113 forget=1.4151 orth=0.0000 favg=0.0000 nr=112 nf=7 protos=570 fproto_sim=NA
 70%|███████   | 35/50 [05:42<02:33, 10.24s/it] 72%|███████▏  | 36/50 [05:50<02:15,  9.69s/it] 74%|███████▍  | 37/50 [05:59<02:00,  9.29s/it] 76%|███████▌  | 38/50 [06:08<01:52,  9.41s/it] 78%|███████▊  | 39/50 [06:16<01:38,  8.96s/it] 80%|████████  | 40/50 [06:25<01:29,  8.92s/it] 82%|████████▏ | 41/50 [06:33<01:18,  8.71s/it] 84%|████████▍ | 42/50 [06:43<01:11,  8.89s/it][loss] ep 34 it 306 total=7.5817 mle=1.4701 pcon=4.8108 forget=1.3008 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 34 it 356 total=7.6332 mle=1.5273 pcon=4.8101 forget=1.2959 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 35 it 15 total=7.6965 mle=1.5179 pcon=4.8094 forget=1.3692 orth=0.0000 favg=0.0000 nr=115 nf=5 protos=570 fproto_sim=NA
[loss] ep 35 it 65 total=7.7496 mle=1.6186 pcon=4.8088 forget=1.3222 orth=0.0000 favg=0.0000 nr=118 nf=5 protos=570 fproto_sim=NA
[loss] ep 35 it 115 total=7.6353 mle=1.5121 pcon=4.8083 forget=1.3149 orth=0.0000 favg=0.0000 nr=114 nf=9 protos=570 fproto_sim=NA
[loss] ep 35 it 165 total=7.6888 mle=1.5611 pcon=4.8075 forget=1.3203 orth=0.0000 favg=0.0000 nr=106 nf=9 protos=570 fproto_sim=NA
[loss] ep 35 it 215 total=7.6341 mle=1.4759 pcon=4.8065 forget=1.3516 orth=0.0000 favg=0.0000 nr=114 nf=5 protos=570 fproto_sim=NA
[loss] ep 35 it 265 total=7.7524 mle=1.5660 pcon=4.8061 forget=1.3802 orth=0.0000 favg=0.0000 nr=116 nf=3 protos=570 fproto_sim=NA
[loss] ep 35 it 315 total=7.6577 mle=1.5244 pcon=4.8056 forget=1.3276 orth=0.0000 favg=0.0000 nr=111 nf=11 protos=570 fproto_sim=NA
[loss] ep 35 it 365 total=7.6434 mle=1.5310 pcon=4.8051 forget=1.3074 orth=0.0000 favg=0.0000 nr=114 nf=7 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[loss] ep 36 it 24 total=7.6797 mle=1.5488 pcon=4.8043 forget=1.3265 orth=0.0000 favg=0.0000 nr=114 nf=7 protos=570 fproto_sim=NA
[loss] ep 36 it 74 total=7.7383 mle=1.5872 pcon=4.8036 forget=1.3475 orth=0.0000 favg=0.0000 nr=117 nf=3 protos=570 fproto_sim=NA
[loss] ep 36 it 124 total=7.6728 mle=1.4993 pcon=4.8031 forget=1.3704 orth=0.0000 favg=0.0000 nr=120 nf=6 protos=570 fproto_sim=NA
[loss] ep 36 it 174 total=7.7288 mle=1.5447 pcon=4.8027 forget=1.3813 orth=0.0000 favg=0.0000 nr=118 nf=6 protos=570 fproto_sim=NA
[loss] ep 36 it 224 total=7.7923 mle=1.6546 pcon=4.8018 forget=1.3359 orth=0.0000 favg=0.0000 nr=119 nf=4 protos=570 fproto_sim=NA
[loss] ep 36 it 274 total=7.6621 mle=1.4923 pcon=4.8017 forget=1.3681 orth=0.0000 favg=0.0000 nr=115 nf=2 protos=570 fproto_sim=NA
[loss] ep 36 it 324 total=7.5958 mle=1.4908 pcon=4.8010 forget=1.3039 orth=0.0000 favg=0.0000 nr=116 nf=4 protos=570 fproto_sim=NA
[loss] ep 36 it 374 total=7.6443 mle=1.5250 pcon=4.8004 forget=1.3189 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[loss] ep 37 it 33 total=7.6680 mle=1.5214 pcon=4.8000 forget=1.3466 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 37 it 83 total=7.6671 mle=1.5168 pcon=4.7997 forget=1.3506 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 37 it 133 total=7.5785 mle=1.4205 pcon=4.7994 forget=1.3586 orth=0.0000 favg=0.0000 nr=116 nf=10 protos=570 fproto_sim=NA
[loss] ep 37 it 183 total=7.7362 mle=1.5566 pcon=4.7992 forget=1.3804 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 37 it 233 total=7.6149 mle=1.4721 pcon=4.7987 forget=1.3441 orth=0.0000 favg=0.0000 nr=120 nf=3 protos=570 fproto_sim=NA
[loss] ep 37 it 283 total=7.7441 mle=1.5827 pcon=4.7986 forget=1.3628 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 37 it 333 total=7.6733 mle=1.4920 pcon=4.7980 forget=1.3832 orth=0.0000 favg=0.0000 nr=110 nf=7 protos=570 fproto_sim=NA
[loss] ep 37 it 383 total=7.7109 mle=1.5785 pcon=4.7978 forget=1.3345 orth=0.0000 favg=0.0000 nr=117 nf=7 protos=570 fproto_sim=NA
[loss] ep 38 it 42 total=7.6659 mle=1.5419 pcon=4.7979 forget=1.3262 orth=0.0000 favg=0.0000 nr=112 nf=11 protos=570 fproto_sim=NA
[loss] ep 38 it 92 total=7.7858 mle=1.6332 pcon=4.7974 forget=1.3551 orth=0.0000 favg=0.0000 nr=112 nf=7 protos=570 fproto_sim=NA
[loss] ep 38 it 142 total=7.7208 mle=1.5355 pcon=4.7970 forget=1.3883 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 38 it 192 total=7.6203 mle=1.4240 pcon=4.7968 forget=1.3995 orth=0.0000 favg=0.0000 nr=122 nf=3 protos=570 fproto_sim=NA
[loss] ep 38 it 242 total=7.6481 mle=1.5116 pcon=4.7967 forget=1.3398 orth=0.0000 favg=0.0000 nr=115 nf=6 protos=570 fproto_sim=NA
[loss] ep 38 it 292 total=7.7579 mle=1.5666 pcon=4.7964 forget=1.3949 orth=0.0000 favg=0.0000 nr=110 nf=10 protos=570 fproto_sim=NA
[loss] ep 38 it 342 total=7.8352 mle=1.5969 pcon=4.7961 forget=1.4422 orth=0.0000 favg=0.0000 nr=118 nf=7 protos=570 fproto_sim=NA
[loss] ep 39 it 1 total=7.8439 mle=1.6898 pcon=4.7956 forget=1.3585 orth=0.0000 favg=0.0000 nr=112 nf=11 protos=570 fproto_sim=NA
[loss] ep 39 it 51 total=7.7286 mle=1.5487 pcon=4.7952 forget=1.3846 orth=0.0000 favg=0.0000 nr=118 nf=5 protos=570 fproto_sim=NA
[loss] ep 39 it 101 total=7.8781 mle=1.6974 pcon=4.7948 forget=1.3859 orth=0.0000 favg=0.0000 nr=107 nf=10 protos=570 fproto_sim=NA
[loss] ep 39 it 151 total=7.6411 mle=1.4543 pcon=4.7947 forget=1.3921 orth=0.0000 favg=0.0000 nr=116 nf=7 protos=570 fproto_sim=NA
[loss] ep 39 it 201 total=7.8375 mle=1.5998 pcon=4.7944 forget=1.4433 orth=0.0000 favg=0.0000 nr=118 nf=2 protos=570 fproto_sim=NA
[loss] ep 39 it 251 total=7.7584 mle=1.6135 pcon=4.7944 forget=1.3505 orth=0.0000 favg=0.0000 nr=118 nf=7 protos=570 fproto_sim=NA
[loss] ep 39 it 301 total=7.8495 mle=1.5967 pcon=4.7942 forget=1.4586 orth=0.0000 favg=0.0000 nr=115 nf=6 protos=570 fproto_sim=NA
[loss] ep 39 it 351 total=7.8321 mle=1.6176 pcon=4.7942 forget=1.4203 orth=0.0000 favg=0.0000 nr=111 nf=8 protos=570 fproto_sim=NA
[loss] ep 40 it 10 total=7.7767 mle=1.6042 pcon=4.7937 forget=1.3789 orth=0.0000 favg=0.0000 nr=113 nf=7 protos=570 fproto_sim=NA
[loss] ep 40 it 60 total=7.7411 mle=1.5788 pcon=4.7934 forget=1.3690 orth=0.0000 favg=0.0000 nr=119 nf=7 protos=570 fproto_sim=NA
[loss] ep 40 it 110 total=7.6521 mle=1.5097 pcon=4.7929 forget=1.3495 orth=0.0000 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[loss] ep 40 it 160 total=7.9002 mle=1.5953 pcon=4.7927 forget=1.5121 orth=0.0000 favg=0.0000 nr=120 nf=6 protos=570 fproto_sim=NA
[loss] ep 40 it 210 total=7.8440 mle=1.5777 pcon=4.7925 forget=1.4739 orth=0.0000 favg=0.0000 nr=115 nf=5 protos=570 fproto_sim=NA
[loss] ep 40 it 260 total=7.6441 mle=1.5161 pcon=4.7924 forget=1.3356 orth=0.0000 favg=0.0000 nr=116 nf=6 protos=570 fproto_sim=NA
[loss] ep 40 it 310 total=7.8746 mle=1.6729 pcon=4.7923 forget=1.4094 orth=0.0000 favg=0.0000 nr=108 nf=12 protos=570 fproto_sim=NA
[loss] ep 40 it 360 total=7.9574 mle=1.6925 pcon=4.7919 forget=1.4730 orth=0.0000 favg=0.0000 nr=115 nf=9 protos=570 fproto_sim=NA
[loss] ep 41 it 19 total=7.7118 mle=1.5655 pcon=4.7916 forget=1.3547 orth=0.0000 favg=0.0000 nr=118 nf=7 protos=570 fproto_sim=NA
[loss] ep 41 it 69 total=7.6778 mle=1.5217 pcon=4.7914 forget=1.3647 orth=0.0000 favg=0.0000 nr=111 nf=8 protos=570 fproto_sim=NA
[loss] ep 41 it 119 total=7.8543 mle=1.6518 pcon=4.7910 forget=1.4115 orth=0.0000 favg=0.0000 nr=112 nf=7 protos=570 fproto_sim=NA
[loss] ep 41 it 169 total=7.8276 mle=1.5904 pcon=4.7909 forget=1.4463 orth=0.0000 favg=0.0000 nr=116 nf=8 protos=570 fproto_sim=NA
[loss] ep 41 it 219 total=7.6828 mle=1.4493 pcon=4.7905 forget=1.4430 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 41 it 269 total=7.6950 mle=1.5301 pcon=4.7904 forget=1.3745 orth=0.0000 favg=0.0000 nr=119 nf=2 protos=570 fproto_sim=NA
[loss] ep 41 it 319 total=7.8443 mle=1.6253 pcon=4.7904 forget=1.4286 orth=0.0000 favg=0.0000 nr=117 nf=3 protos=570 fproto_sim=NA
[loss] ep 41 it 369 total=7.8716 mle=1.5784 pcon=4.7900 forget=1.5032 orth=0.0000 favg=0.0000 nr=119 nf=4 protos=570 fproto_sim=NA
[loss] ep 42 it 28 total=7.6782 mle=1.5307 pcon=4.7897 forget=1.3578 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[loss] ep 42 it 78 total=7.8639 mle=1.6456 pcon=4.7895 forget=1.4288 orth=0.0000 favg=0.0000 nr=116 nf=7 protos=570 fproto_sim=NA
 86%|████████▌ | 43/50 [06:58<01:15, 10.86s/it] 88%|████████▊ | 44/50 [07:09<01:05, 10.86s/it] 90%|█████████ | 45/50 [07:17<00:50, 10.14s/it] 92%|█████████▏| 46/50 [07:26<00:38,  9.71s/it] 94%|█████████▍| 47/50 [07:34<00:27,  9.29s/it] 96%|█████████▌| 48/50 [07:42<00:17,  8.84s/it] 98%|█████████▊| 49/50 [07:52<00:09,  9.23s/it]100%|██████████| 50/50 [08:02<00:00,  9.34s/it]100%|██████████| 50/50 [08:02<00:00,  9.65s/it]
[loss] ep 42 it 128 total=7.7351 mle=1.5393 pcon=4.7892 forget=1.4066 orth=0.0000 favg=0.0000 nr=114 nf=7 protos=570 fproto_sim=NA
[loss] ep 42 it 178 total=7.7116 mle=1.5437 pcon=4.7888 forget=1.3790 orth=0.0000 favg=0.0000 nr=115 nf=9 protos=570 fproto_sim=NA
[loss] ep 42 it 228 total=7.6558 mle=1.4396 pcon=4.7887 forget=1.4275 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 42 it 278 total=7.7234 mle=1.5776 pcon=4.7884 forget=1.3573 orth=0.0000 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[loss] ep 42 it 328 total=7.7088 mle=1.5387 pcon=4.7883 forget=1.3818 orth=0.0000 favg=0.0000 nr=111 nf=7 protos=570 fproto_sim=NA
[loss] ep 42 it 378 total=8.0807 mle=1.6757 pcon=4.7879 forget=1.6170 orth=0.0000 favg=0.0000 nr=118 nf=8 protos=570 fproto_sim=NA
[loss] ep 43 it 37 total=7.7710 mle=1.5079 pcon=4.7878 forget=1.4753 orth=0.0000 favg=0.0000 nr=114 nf=9 protos=570 fproto_sim=NA
[loss] ep 43 it 87 total=7.8717 mle=1.5466 pcon=4.7876 forget=1.5375 orth=0.0000 favg=0.0000 nr=115 nf=8 protos=570 fproto_sim=NA
[loss] ep 43 it 137 total=8.0646 mle=1.6000 pcon=4.7875 forget=1.6771 orth=0.0000 favg=0.0000 nr=117 nf=3 protos=570 fproto_sim=NA
[loss] ep 43 it 187 total=7.9911 mle=1.5751 pcon=4.7874 forget=1.6286 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 43 it 237 total=7.7032 mle=1.4984 pcon=4.7874 forget=1.4174 orth=0.0000 favg=0.0000 nr=115 nf=10 protos=570 fproto_sim=NA
[loss] ep 43 it 287 total=7.8171 mle=1.5632 pcon=4.7872 forget=1.4667 orth=0.0000 favg=0.0000 nr=117 nf=6 protos=570 fproto_sim=NA
[loss] ep 43 it 337 total=7.7981 mle=1.5319 pcon=4.7873 forget=1.4790 orth=0.0000 favg=0.0000 nr=118 nf=5 protos=570 fproto_sim=NA
[loss] ep 43 it 387 total=7.8626 mle=1.5399 pcon=4.7871 forget=1.5356 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 44 it 46 total=7.6812 mle=1.4586 pcon=4.7869 forget=1.4356 orth=0.0000 favg=0.0000 nr=116 nf=5 protos=570 fproto_sim=NA
[loss] ep 44 it 96 total=7.7754 mle=1.4661 pcon=4.7869 forget=1.5224 orth=0.0000 favg=0.0000 nr=117 nf=7 protos=570 fproto_sim=NA
[loss] ep 44 it 146 total=7.8101 mle=1.6604 pcon=4.7867 forget=1.3630 orth=0.0000 favg=0.0000 nr=110 nf=9 protos=570 fproto_sim=NA
[loss] ep 44 it 196 total=7.8850 mle=1.5729 pcon=4.7865 forget=1.5256 orth=0.0000 favg=0.0000 nr=99 nf=21 protos=570 fproto_sim=NA
[loss] ep 44 it 246 total=7.7332 mle=1.4451 pcon=4.7864 forget=1.5017 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 44 it 296 total=7.8632 mle=1.5393 pcon=4.7863 forget=1.5376 orth=0.0000 favg=0.0000 nr=116 nf=6 protos=570 fproto_sim=NA
[loss] ep 44 it 346 total=7.7267 mle=1.5216 pcon=4.7864 forget=1.4186 orth=0.0000 favg=0.0000 nr=115 nf=10 protos=570 fproto_sim=NA
[loss] ep 45 it 5 total=7.8002 mle=1.5953 pcon=4.7865 forget=1.4185 orth=0.0000 favg=0.0000 nr=118 nf=5 protos=570 fproto_sim=NA
[loss] ep 45 it 55 total=7.7236 mle=1.5015 pcon=4.7864 forget=1.4357 orth=0.0000 favg=0.0000 nr=122 nf=5 protos=570 fproto_sim=NA
[loss] ep 45 it 105 total=7.7654 mle=1.5162 pcon=4.7867 forget=1.4625 orth=0.0000 favg=0.0000 nr=115 nf=9 protos=570 fproto_sim=NA
[loss] ep 45 it 155 total=7.8360 mle=1.4826 pcon=4.7867 forget=1.5666 orth=0.0000 favg=0.0000 nr=115 nf=5 protos=570 fproto_sim=NA
[loss] ep 45 it 205 total=8.0014 mle=1.6684 pcon=4.7864 forget=1.5466 orth=0.0000 favg=0.0000 nr=117 nf=7 protos=570 fproto_sim=NA
[loss] ep 45 it 255 total=7.9267 mle=1.5429 pcon=4.7863 forget=1.5974 orth=0.0000 favg=0.0000 nr=114 nf=8 protos=570 fproto_sim=NA
[loss] ep 45 it 305 total=7.6657 mle=1.4955 pcon=4.7861 forget=1.3841 orth=0.0000 favg=0.0000 nr=112 nf=5 protos=570 fproto_sim=NA
[loss] ep 45 it 355 total=7.7287 mle=1.4191 pcon=4.7861 forget=1.5235 orth=0.0000 favg=0.0000 nr=115 nf=7 protos=570 fproto_sim=NA
[loss] ep 46 it 14 total=8.0495 mle=1.6344 pcon=4.7861 forget=1.6290 orth=0.0000 favg=0.0000 nr=118 nf=6 protos=570 fproto_sim=NA
[loss] ep 46 it 64 total=7.7320 mle=1.5144 pcon=4.7861 forget=1.4316 orth=0.0000 favg=0.0000 nr=110 nf=7 protos=570 fproto_sim=NA
[loss] ep 46 it 114 total=8.0465 mle=1.6887 pcon=4.7861 forget=1.5716 orth=0.0000 favg=0.0000 nr=112 nf=12 protos=570 fproto_sim=NA
[loss] ep 46 it 164 total=7.8452 mle=1.4923 pcon=4.7860 forget=1.5669 orth=0.0000 favg=0.0000 nr=114 nf=5 protos=570 fproto_sim=NA
[loss] ep 46 it 214 total=7.7899 mle=1.6412 pcon=4.7860 forget=1.3627 orth=0.0000 favg=0.0000 nr=120 nf=2 protos=570 fproto_sim=NA
[loss] ep 46 it 264 total=7.7848 mle=1.4570 pcon=4.7860 forget=1.5418 orth=0.0000 favg=0.0000 nr=117 nf=3 protos=570 fproto_sim=NA
[loss] ep 46 it 314 total=7.9039 mle=1.5577 pcon=4.7860 forget=1.5602 orth=0.0000 favg=0.0000 nr=119 nf=3 protos=570 fproto_sim=NA
[loss] ep 46 it 364 total=7.7296 mle=1.5319 pcon=4.7861 forget=1.4117 orth=0.0000 favg=0.0000 nr=114 nf=7 protos=570 fproto_sim=NA
[loss] ep 47 it 23 total=7.7182 mle=1.6198 pcon=4.7861 forget=1.3123 orth=0.0000 favg=0.0000 nr=112 nf=7 protos=570 fproto_sim=NA
[loss] ep 47 it 73 total=8.1321 mle=1.6827 pcon=4.7860 forget=1.6635 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 47 it 123 total=7.7669 mle=1.5172 pcon=4.7862 forget=1.4636 orth=0.0000 favg=0.0000 nr=118 nf=5 protos=570 fproto_sim=NA
[loss] ep 47 it 173 total=7.6386 mle=1.5058 pcon=4.7861 forget=1.3467 orth=0.0000 favg=0.0000 nr=114 nf=5 protos=570 fproto_sim=NA
[loss] ep 47 it 223 total=7.6855 mle=1.4684 pcon=4.7860 forget=1.4310 orth=0.0000 favg=0.0000 nr=114 nf=9 protos=570 fproto_sim=NA
[loss] ep 47 it 273 total=7.9214 mle=1.6047 pcon=4.7862 forget=1.5305 orth=0.0000 favg=0.0000 nr=117 nf=7 protos=570 fproto_sim=NA
[loss] ep 47 it 323 total=7.8838 mle=1.5350 pcon=4.7864 forget=1.5624 orth=0.0000 favg=0.0000 nr=113 nf=9 protos=570 fproto_sim=NA
[loss] ep 47 it 373 total=7.8535 mle=1.5122 pcon=4.7862 forget=1.5551 orth=0.0000 favg=0.0000 nr=114 nf=9 protos=570 fproto_sim=NA
[loss] ep 48 it 32 total=7.7131 mle=1.5344 pcon=4.7861 forget=1.3925 orth=0.0000 favg=0.0000 nr=120 nf=5 protos=570 fproto_sim=NA
[loss] ep 48 it 82 total=7.8554 mle=1.6391 pcon=4.7862 forget=1.4301 orth=0.0000 favg=0.0000 nr=117 nf=9 protos=570 fproto_sim=NA
[loss] ep 48 it 132 total=7.6646 mle=1.5284 pcon=4.7862 forget=1.3500 orth=0.0000 favg=0.0000 nr=119 nf=6 protos=570 fproto_sim=NA
[loss] ep 48 it 182 total=7.8268 mle=1.5284 pcon=4.7862 forget=1.5123 orth=0.0000 favg=0.0000 nr=116 nf=9 protos=570 fproto_sim=NA
[loss] ep 48 it 232 total=7.9734 mle=1.5531 pcon=4.7862 forget=1.6340 orth=0.0000 favg=0.0000 nr=119 nf=4 protos=570 fproto_sim=NA
[loss] ep 48 it 282 total=7.9631 mle=1.5665 pcon=4.7862 forget=1.6104 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[loss] ep 48 it 332 total=7.8547 mle=1.5974 pcon=4.7861 forget=1.4711 orth=0.0000 favg=0.0000 nr=114 nf=10 protos=570 fproto_sim=NA
[loss] ep 48 it 382 total=7.6123 mle=1.4748 pcon=4.7862 forget=1.3514 orth=0.0000 favg=0.0000 nr=117 nf=5 protos=570 fproto_sim=NA
[loss] ep 49 it 41 total=7.8794 mle=1.7025 pcon=4.7859 forget=1.3909 orth=0.0000 favg=0.0000 nr=117 nf=4 protos=570 fproto_sim=NA
[loss] ep 49 it 91 total=7.9179 mle=1.6731 pcon=4.7859 forget=1.4589 orth=0.0000 favg=0.0000 nr=118 nf=4 protos=570 fproto_sim=NA
[loss] ep 49 it 141 total=7.7962 mle=1.4986 pcon=4.7858 forget=1.5118 orth=0.0000 favg=0.0000 nr=114 nf=6 protos=570 fproto_sim=NA
[loss] ep 49 it 191 total=7.7514 mle=1.5732 pcon=4.7859 forget=1.3924 orth=0.0000 favg=0.0000 nr=120 nf=2 protos=570 fproto_sim=NA
[loss] ep 49 it 241 total=7.9328 mle=1.5361 pcon=4.7855 forget=1.6112 orth=0.0000 favg=0.0000 nr=114 nf=4 protos=570 fproto_sim=NA
[loss] ep 49 it 291 total=7.8982 mle=1.6297 pcon=4.7856 forget=1.4829 orth=0.0000 favg=0.0000 nr=105 nf=15 protos=570 fproto_sim=NA
[loss] ep 49 it 341 total=7.6408 mle=1.5322 pcon=4.7858 forget=1.3229 orth=0.0000 favg=0.0000 nr=121 nf=3 protos=570 fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-inc1-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:01<09:51,  1.52s/it]  3%|▎         | 10/391 [00:01<00:45,  8.33it/s]  5%|▌         | 20/391 [00:01<00:20, 18.16it/s]  8%|▊         | 30/391 [00:01<00:12, 28.85it/s] 10%|█         | 40/391 [00:01<00:08, 39.80it/s] 13%|█▎        | 50/391 [00:02<00:06, 50.39it/s] 15%|█▌        | 60/391 [00:02<00:05, 60.20it/s] 18%|█▊        | 70/391 [00:02<00:04, 68.25it/s] 20%|██        | 80/391 [00:02<00:04, 75.07it/s] 23%|██▎       | 90/391 [00:02<00:03, 80.49it/s] 26%|██▌       | 100/391 [00:02<00:03, 84.48it/s] 28%|██▊       | 110/391 [00:02<00:03, 87.50it/s] 31%|███       | 120/391 [00:02<00:03, 89.66it/s] 33%|███▎      | 130/391 [00:02<00:02, 91.55it/s] 36%|███▌      | 140/391 [00:02<00:02, 92.86it/s] 38%|███▊      | 150/391 [00:03<00:02, 93.48it/s] 41%|████      | 160/391 [00:03<00:02, 94.25it/s] 43%|████▎     | 170/391 [00:03<00:02, 94.63it/s] 46%|████▌     | 180/391 [00:03<00:02, 94.78it/s] 49%|████▊     | 190/391 [00:03<00:02, 95.13it/s] 51%|█████     | 200/391 [00:03<00:02, 95.35it/s] 54%|█████▎    | 210/391 [00:03<00:01, 95.63it/s] 56%|█████▋    | 220/391 [00:03<00:01, 95.33it/s] 59%|█████▉    | 230/391 [00:03<00:01, 95.39it/s] 61%|██████▏   | 240/391 [00:04<00:01, 95.60it/s] 64%|██████▍   | 250/391 [00:04<00:01, 95.66it/s] 66%|██████▋   | 260/391 [00:04<00:01, 94.72it/s] 69%|██████▉   | 270/391 [00:04<00:01, 94.77it/s] 72%|███████▏  | 280/391 [00:04<00:01, 95.14it/s] 74%|███████▍  | 290/391 [00:04<00:01, 95.49it/s] 77%|███████▋  | 300/391 [00:04<00:00, 95.54it/s] 79%|███████▉  | 310/391 [00:04<00:00, 95.70it/s] 82%|████████▏ | 320/391 [00:04<00:00, 95.80it/s] 84%|████████▍ | 330/391 [00:04<00:00, 95.46it/s] 87%|████████▋ | 340/391 [00:05<00:00, 95.62it/s] 90%|████████▉ | 350/391 [00:05<00:00, 95.80it/s] 92%|█████████▏| 360/391 [00:05<00:00, 95.01it/s] 95%|█████████▍| 370/391 [00:05<00:00, 95.83it/s] 97%|█████████▋| 380/391 [00:05<00:00, 96.44it/s]100%|█████████▉| 390/391 [00:05<00:00, 96.83it/s]100%|██████████| 391/391 [00:05<00:00, 69.55it/s]
50000 images processed, 5.772374391555786 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:51,  1.50it/s] 13%|█▎        | 10/79 [00:00<00:04, 16.87it/s] 25%|██▌       | 20/79 [00:00<00:01, 32.69it/s] 35%|███▌      | 28/79 [00:00<00:01, 42.59it/s] 46%|████▌     | 36/79 [00:01<00:00, 50.72it/s] 58%|█████▊    | 46/79 [00:01<00:00, 61.55it/s] 71%|███████   | 56/79 [00:01<00:00, 70.20it/s] 84%|████████▎ | 66/79 [00:01<00:00, 76.90it/s] 96%|█████████▌| 76/79 [00:01<00:00, 81.80it/s]100%|██████████| 79/79 [00:02<00:00, 30.72it/s]
10000 images processed, 2.6287219524383545 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-inc1-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:34,  2.15it/s]  4%|▍         | 8/204 [00:00<00:10, 17.94it/s]  9%|▉         | 18/204 [00:00<00:04, 37.57it/s] 13%|█▎        | 26/204 [00:00<00:03, 48.36it/s] 18%|█▊        | 36/204 [00:00<00:02, 60.64it/s] 23%|██▎       | 46/204 [00:00<00:02, 69.73it/s] 27%|██▋       | 55/204 [00:01<00:02, 74.25it/s] 31%|███▏      | 64/204 [00:01<00:01, 71.04it/s] 36%|███▋      | 74/204 [00:01<00:01, 77.07it/s] 41%|████      | 83/204 [00:01<00:01, 76.92it/s] 46%|████▌     | 93/204 [00:01<00:01, 81.99it/s] 50%|█████     | 103/204 [00:01<00:01, 85.68it/s] 55%|█████▍    | 112/204 [00:01<00:01, 83.55it/s] 59%|█████▉    | 121/204 [00:01<00:01, 79.69it/s] 64%|██████▍   | 131/204 [00:02<00:00, 83.82it/s] 69%|██████▉   | 141/204 [00:02<00:00, 86.64it/s] 74%|███████▍  | 151/204 [00:02<00:00, 89.04it/s] 79%|███████▉  | 161/204 [00:02<00:00, 90.90it/s] 84%|████████▍ | 171/204 [00:02<00:00, 92.16it/s] 89%|████████▊ | 181/204 [00:02<00:00, 93.26it/s] 94%|█████████▎| 191/204 [00:02<00:00, 94.36it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.03it/s]100%|██████████| 204/204 [00:02<00:00, 73.07it/s]
26032 images processed, 2.8296334743499756 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.62it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.93it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.37it/s] 39%|███▉      | 31/79 [00:00<00:00, 50.21it/s] 52%|█████▏    | 41/79 [00:01<00:00, 61.51it/s] 65%|██████▍   | 51/79 [00:01<00:00, 70.37it/s] 77%|███████▋  | 61/79 [00:01<00:00, 77.35it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.74it/s]100%|██████████| 79/79 [00:01<00:00, 55.35it/s]
10000 images processed, 1.4588818550109863 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.21it/s]  5%|▌         | 4/79 [00:00<00:08,  8.50it/s]  9%|▉         | 7/79 [00:00<00:05, 13.80it/s] 18%|█▊        | 14/79 [00:00<00:02, 28.44it/s] 30%|███       | 24/79 [00:00<00:01, 46.57it/s] 43%|████▎     | 34/79 [00:00<00:00, 59.87it/s] 56%|█████▌    | 44/79 [00:01<00:00, 69.68it/s] 67%|██████▋   | 53/79 [00:01<00:00, 73.06it/s] 77%|███████▋  | 61/79 [00:01<00:00, 72.79it/s] 87%|████████▋ | 69/79 [00:01<00:00, 73.83it/s]100%|██████████| 79/79 [00:01<00:00, 51.98it/s]
10000 images processed, 1.5399296283721924 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.92it/s] 14%|█▍        | 10/70 [00:00<00:02, 20.75it/s] 29%|██▊       | 20/70 [00:00<00:01, 38.41it/s] 43%|████▎     | 30/70 [00:00<00:00, 52.52it/s] 57%|█████▋    | 40/70 [00:00<00:00, 63.19it/s] 71%|███████▏  | 50/70 [00:01<00:00, 72.25it/s] 86%|████████▌ | 60/70 [00:01<00:00, 79.12it/s]100%|██████████| 70/70 [00:01<00:00, 83.34it/s]100%|██████████| 70/70 [00:01<00:00, 55.36it/s]
8925 images processed, 1.2947947978973389 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:40,  1.09it/s]  4%|▍         | 2/45 [00:01<00:18,  2.27it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.68it/s] 38%|███▊      | 17/45 [00:01<00:01, 17.43it/s] 51%|█████     | 23/45 [00:01<00:01, 21.69it/s] 67%|██████▋   | 30/45 [00:01<00:00, 22.49it/s] 76%|███████▌  | 34/45 [00:02<00:00, 23.23it/s] 98%|█████████▊| 44/45 [00:02<00:00, 35.84it/s]100%|██████████| 45/45 [00:02<00:00, 20.72it/s]
5640 images processed, 2.1925454139709473 seconds used

19.26910400390625
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.13  98.84  96.59
places365     81.92  76.23  76.01
LSUN          42.08  91.36  91.79
iSUN          85.03  76.49  81.25
dtd           49.01  88.66  93.01
AVG           52.63  86.32  87.73
Retain-Acc: 0.7464
Forget-as-OOD (retain known vs forget novel):
  FPR: 39.40 AUROC: 90.43 AUIN: 99.37
7.3732311725616455
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-seen-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:18,  2.81it/s]  2%|▏         | 8/391 [00:00<00:18, 21.19it/s]  5%|▍         | 18/391 [00:00<00:08, 42.17it/s]  7%|▋         | 28/391 [00:00<00:06, 57.33it/s] 10%|▉         | 38/391 [00:00<00:05, 68.52it/s] 12%|█▏        | 48/391 [00:00<00:04, 76.71it/s] 15%|█▍        | 58/391 [00:00<00:04, 82.50it/s] 17%|█▋        | 68/391 [00:01<00:03, 86.63it/s] 20%|█▉        | 78/391 [00:01<00:03, 89.49it/s] 23%|██▎       | 88/391 [00:01<00:03, 91.63it/s] 25%|██▌       | 98/391 [00:01<00:03, 92.97it/s] 28%|██▊       | 108/391 [00:01<00:03, 93.90it/s] 30%|███       | 118/391 [00:01<00:02, 94.55it/s] 33%|███▎      | 128/391 [00:01<00:02, 94.86it/s] 35%|███▌      | 138/391 [00:01<00:02, 95.10it/s] 38%|███▊      | 148/391 [00:01<00:02, 95.31it/s] 40%|████      | 158/391 [00:02<00:02, 95.40it/s] 43%|████▎     | 168/391 [00:02<00:02, 95.71it/s] 46%|████▌     | 178/391 [00:02<00:02, 95.81it/s] 48%|████▊     | 188/391 [00:02<00:02, 95.93it/s] 51%|█████     | 198/391 [00:02<00:02, 95.91it/s] 53%|█████▎    | 208/391 [00:02<00:01, 95.98it/s] 56%|█████▌    | 218/391 [00:02<00:01, 96.09it/s] 58%|█████▊    | 228/391 [00:02<00:01, 96.04it/s] 61%|██████    | 238/391 [00:02<00:01, 96.06it/s] 63%|██████▎   | 248/391 [00:02<00:01, 96.04it/s] 66%|██████▌   | 258/391 [00:03<00:01, 95.86it/s] 69%|██████▊   | 268/391 [00:03<00:01, 95.71it/s] 71%|███████   | 278/391 [00:03<00:01, 95.89it/s] 74%|███████▎  | 288/391 [00:03<00:01, 95.82it/s] 76%|███████▌  | 298/391 [00:03<00:00, 95.99it/s] 79%|███████▉  | 308/391 [00:03<00:00, 96.01it/s] 81%|████████▏ | 318/391 [00:03<00:00, 96.04it/s] 84%|████████▍ | 328/391 [00:03<00:00, 95.93it/s] 86%|████████▋ | 338/391 [00:03<00:00, 95.87it/s] 89%|████████▉ | 348/391 [00:04<00:00, 95.85it/s] 92%|█████████▏| 358/391 [00:04<00:00, 95.83it/s] 94%|█████████▍| 368/391 [00:04<00:00, 95.89it/s] 97%|█████████▋| 378/391 [00:04<00:00, 96.53it/s] 99%|█████████▉| 388/391 [00:04<00:00, 96.99it/s]100%|██████████| 391/391 [00:04<00:00, 87.43it/s]
50000 images processed, 4.550585031509399 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:30,  2.59it/s] 13%|█▎        | 10/79 [00:00<00:02, 25.48it/s] 24%|██▍       | 19/79 [00:00<00:01, 42.49it/s] 37%|███▋      | 29/79 [00:00<00:00, 56.72it/s] 49%|████▉     | 39/79 [00:00<00:00, 67.04it/s] 62%|██████▏   | 49/79 [00:00<00:00, 74.45it/s] 75%|███████▍  | 59/79 [00:01<00:00, 80.31it/s] 87%|████████▋ | 69/79 [00:01<00:00, 84.46it/s]100%|██████████| 79/79 [00:01<00:00, 41.72it/s]100%|██████████| 79/79 [00:01<00:00, 48.16it/s]
10000 images processed, 1.6833579540252686 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-seen-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:35,  2.12it/s]  5%|▍         | 10/204 [00:00<00:08, 22.55it/s] 10%|▉         | 20/204 [00:00<00:04, 41.31it/s] 15%|█▍        | 30/204 [00:00<00:03, 55.74it/s] 20%|█▉        | 40/204 [00:00<00:02, 66.62it/s] 25%|██▍       | 50/204 [00:00<00:02, 74.83it/s] 29%|██▉       | 60/204 [00:01<00:01, 80.70it/s] 34%|███▍      | 70/204 [00:01<00:01, 85.05it/s] 39%|███▉      | 80/204 [00:01<00:01, 87.93it/s] 44%|████▍     | 90/204 [00:01<00:01, 90.08it/s] 49%|████▉     | 100/204 [00:01<00:01, 91.59it/s] 54%|█████▍    | 110/204 [00:01<00:01, 92.84it/s] 59%|█████▉    | 120/204 [00:01<00:00, 93.43it/s] 64%|██████▎   | 130/204 [00:01<00:00, 93.83it/s] 69%|██████▊   | 140/204 [00:01<00:00, 92.77it/s] 74%|███████▎  | 150/204 [00:02<00:00, 93.24it/s] 78%|███████▊  | 160/204 [00:02<00:00, 93.93it/s] 83%|████████▎ | 170/204 [00:02<00:00, 94.13it/s] 88%|████████▊ | 180/204 [00:02<00:00, 94.68it/s] 93%|█████████▎| 190/204 [00:02<00:00, 95.40it/s] 98%|█████████▊| 200/204 [00:02<00:00, 95.83it/s]100%|██████████| 204/204 [00:02<00:00, 78.00it/s]
26032 images processed, 2.654494047164917 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:46,  1.68it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.47it/s] 27%|██▋       | 21/79 [00:00<00:01, 37.10it/s] 39%|███▉      | 31/79 [00:00<00:00, 51.10it/s] 52%|█████▏    | 41/79 [00:01<00:00, 62.38it/s] 65%|██████▍   | 51/79 [00:01<00:00, 70.98it/s] 77%|███████▋  | 61/79 [00:01<00:00, 77.86it/s] 90%|████████▉ | 71/79 [00:01<00:00, 83.17it/s]100%|██████████| 79/79 [00:01<00:00, 56.18it/s]
10000 images processed, 1.4375426769256592 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:37,  2.06it/s] 13%|█▎        | 10/79 [00:00<00:03, 21.98it/s] 25%|██▌       | 20/79 [00:00<00:01, 40.08it/s] 38%|███▊      | 30/79 [00:00<00:00, 54.21it/s] 51%|█████     | 40/79 [00:00<00:00, 64.88it/s] 63%|██████▎   | 50/79 [00:01<00:00, 73.26it/s] 76%|███████▌  | 60/79 [00:01<00:00, 79.96it/s] 89%|████████▊ | 70/79 [00:01<00:00, 84.85it/s]100%|██████████| 79/79 [00:01<00:00, 60.30it/s]
10000 images processed, 1.3319733142852783 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.90it/s] 14%|█▍        | 10/70 [00:00<00:02, 20.60it/s] 29%|██▊       | 20/70 [00:00<00:01, 38.35it/s] 43%|████▎     | 30/70 [00:00<00:00, 52.65it/s] 57%|█████▋    | 40/70 [00:00<00:00, 63.54it/s] 71%|███████▏  | 50/70 [00:01<00:00, 72.24it/s] 86%|████████▌ | 60/70 [00:01<00:00, 79.09it/s]100%|██████████| 70/70 [00:01<00:00, 83.38it/s]100%|██████████| 70/70 [00:01<00:00, 55.26it/s]
8925 images processed, 1.2953743934631348 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.04it/s]  4%|▍         | 2/45 [00:01<00:19,  2.16it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.00it/s] 38%|███▊      | 17/45 [00:01<00:01, 17.98it/s] 51%|█████     | 23/45 [00:01<00:00, 22.86it/s] 73%|███████▎  | 33/45 [00:02<00:00, 22.77it/s] 87%|████████▋ | 39/45 [00:02<00:00, 27.71it/s]100%|██████████| 45/45 [00:02<00:00, 20.43it/s]
5640 images processed, 2.22224760055542 seconds used

16.863096952438354
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.13  98.84  96.59
places365     81.92  76.23  76.01
LSUN          42.08  91.36  91.79
iSUN          85.03  76.49  81.25
dtd           49.01  88.66  93.01
AVG           52.63  86.32  87.73
Retain-Acc: 0.7464
Forget-as-OOD (retain known vs forget novel):
  FPR: 39.40 AUROC: 90.43 AUIN: 99.37
7.485287666320801
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage1-seen-forget_rf.png
==== Stage 2: inc={66,67,88,94,57}; seen={0,8,11,40,51}; all(union)={0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1', forget_classes='0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:168: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:274: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [00:19<15:57, 19.54s/it]  4%|▍         | 2/50 [00:33<13:00, 16.25s/it]  6%|▌         | 3/50 [00:47<11:50, 15.13s/it]  8%|▊         | 4/50 [01:00<11:02, 14.40s/it] 10%|█         | 5/50 [01:13<10:23, 13.85s/it] 12%|█▏        | 6/50 [01:26<10:00, 13.64s/it][loss] ep 0 it 0 total=9.2893 mle=1.6084 pcon=5.2948 forget=1.3073 orth=1.0787 favg=0.0000 nr=118 nf=6 protos=540 fproto_sim=NA
[loss] ep 0 it 50 total=9.2161 mle=1.5365 pcon=5.2779 forget=1.3230 orth=1.0787 favg=0.0000 nr=116 nf=4 protos=540 fproto_sim=NA
[loss] ep 0 it 100 total=9.4070 mle=1.6574 pcon=5.2614 forget=1.4096 orth=1.0785 favg=0.0000 nr=113 nf=8 protos=540 fproto_sim=NA
[loss] ep 0 it 150 total=9.2049 mle=1.5386 pcon=5.2457 forget=1.3423 orth=1.0783 favg=0.0000 nr=117 nf=4 protos=540 fproto_sim=NA
[loss] ep 0 it 200 total=9.4623 mle=1.7125 pcon=5.2304 forget=1.4414 orth=1.0779 favg=0.0000 nr=121 nf=3 protos=540 fproto_sim=NA
[loss] ep 0 it 250 total=9.0951 mle=1.5003 pcon=5.2158 forget=1.3015 orth=1.0775 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 0 it 300 total=9.1221 mle=1.5188 pcon=5.2013 forget=1.3250 orth=1.0770 favg=0.0000 nr=105 nf=12 protos=540 fproto_sim=NA
[loss] ep 0 it 350 total=9.0768 mle=1.5209 pcon=5.1874 forget=1.2920 orth=1.0764 favg=0.0000 nr=119 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 1 it 9 total=8.9393 mle=1.3674 pcon=5.1742 forget=1.3219 orth=1.0757 favg=0.0000 nr=111 nf=12 protos=540 fproto_sim=NA
[loss] ep 1 it 59 total=9.0913 mle=1.5279 pcon=5.1612 forget=1.3272 orth=1.0750 favg=0.0000 nr=120 nf=1 protos=540 fproto_sim=NA
[loss] ep 1 it 109 total=8.9435 mle=1.4140 pcon=5.1488 forget=1.3065 orth=1.0742 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 1 it 159 total=9.1380 mle=1.5755 pcon=5.1368 forget=1.3525 orth=1.0733 favg=0.0000 nr=113 nf=7 protos=540 fproto_sim=NA
[loss] ep 1 it 209 total=8.9253 mle=1.4250 pcon=5.1252 forget=1.3027 orth=1.0723 favg=0.0000 nr=114 nf=6 protos=540 fproto_sim=NA
[loss] ep 1 it 259 total=9.0470 mle=1.5339 pcon=5.1143 forget=1.3277 orth=1.0712 favg=0.0000 nr=118 nf=4 protos=540 fproto_sim=NA
[loss] ep 1 it 309 total=8.9246 mle=1.3835 pcon=5.1030 forget=1.3680 orth=1.0701 favg=0.0000 nr=111 nf=9 protos=540 fproto_sim=NA
[loss] ep 1 it 359 total=8.9884 mle=1.5161 pcon=5.0929 forget=1.3105 orth=1.0689 favg=0.0000 nr=120 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 2 it 18 total=8.9382 mle=1.4684 pcon=5.0834 forget=1.3188 orth=1.0676 favg=0.0000 nr=115 nf=8 protos=540 fproto_sim=NA
[loss] ep 2 it 68 total=8.9003 mle=1.4461 pcon=5.0739 forget=1.3139 orth=1.0663 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[loss] ep 2 it 118 total=8.8126 mle=1.3938 pcon=5.0649 forget=1.2890 orth=1.0649 favg=0.0000 nr=120 nf=4 protos=540 fproto_sim=NA
[loss] ep 2 it 168 total=8.9275 mle=1.5033 pcon=5.0556 forget=1.3052 orth=1.0634 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[loss] ep 2 it 218 total=8.7227 mle=1.2942 pcon=5.0472 forget=1.3194 orth=1.0619 favg=0.0000 nr=121 nf=3 protos=540 fproto_sim=NA
[loss] ep 2 it 268 total=8.8151 mle=1.4227 pcon=5.0389 forget=1.2932 orth=1.0603 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 2 it 318 total=8.8251 mle=1.4167 pcon=5.0310 forget=1.3186 orth=1.0587 favg=0.0000 nr=105 nf=7 protos=540 fproto_sim=NA
[loss] ep 2 it 368 total=8.8423 mle=1.3893 pcon=5.0234 forget=1.3726 orth=1.0570 favg=0.0000 nr=120 nf=4 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 3 it 27 total=8.9596 mle=1.5238 pcon=5.0161 forget=1.3644 orth=1.0553 favg=0.0000 nr=118 nf=7 protos=540 fproto_sim=NA
[loss] ep 3 it 77 total=8.8409 mle=1.4555 pcon=5.0089 forget=1.3229 orth=1.0536 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 3 it 127 total=8.8362 mle=1.4695 pcon=5.0020 forget=1.3130 orth=1.0518 favg=0.0000 nr=116 nf=6 protos=540 fproto_sim=NA
[loss] ep 3 it 177 total=8.7624 mle=1.4096 pcon=4.9954 forget=1.3075 orth=1.0499 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 3 it 227 total=8.7476 mle=1.4076 pcon=4.9891 forget=1.3029 orth=1.0480 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 3 it 277 total=8.8303 mle=1.4872 pcon=4.9832 forget=1.3139 orth=1.0460 favg=0.0000 nr=115 nf=7 protos=540 fproto_sim=NA
[loss] ep 3 it 327 total=8.8002 mle=1.4633 pcon=4.9773 forget=1.3155 orth=1.0441 favg=0.0000 nr=118 nf=4 protos=540 fproto_sim=NA
[loss] ep 3 it 377 total=8.8710 mle=1.5396 pcon=4.9716 forget=1.3179 orth=1.0420 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 4 it 36 total=8.8427 mle=1.5086 pcon=4.9662 forget=1.3279 orth=1.0399 favg=0.0000 nr=115 nf=5 protos=540 fproto_sim=NA
[loss] ep 4 it 86 total=8.7353 mle=1.4290 pcon=4.9609 forget=1.3075 orth=1.0379 favg=0.0000 nr=119 nf=3 protos=540 fproto_sim=NA
[loss] ep 4 it 136 total=8.7062 mle=1.4181 pcon=4.9558 forget=1.2965 orth=1.0358 favg=0.0000 nr=110 nf=8 protos=540 fproto_sim=NA
[loss] ep 4 it 186 total=8.7712 mle=1.4530 pcon=4.9506 forget=1.3340 orth=1.0336 favg=0.0000 nr=115 nf=9 protos=540 fproto_sim=NA
[loss] ep 4 it 236 total=8.8201 mle=1.5399 pcon=4.9460 forget=1.3028 orth=1.0314 favg=0.0000 nr=113 nf=6 protos=540 fproto_sim=NA
[loss] ep 4 it 286 total=8.7585 mle=1.4426 pcon=4.9415 forget=1.3453 orth=1.0291 favg=0.0000 nr=115 nf=10 protos=540 fproto_sim=NA
[loss] ep 4 it 336 total=8.7678 mle=1.4829 pcon=4.9369 forget=1.3211 orth=1.0268 favg=0.0000 nr=114 nf=9 protos=540 fproto_sim=NA
[loss] ep 4 it 386 total=8.6842 mle=1.4272 pcon=4.9327 forget=1.2998 orth=1.0245 favg=0.0000 nr=120 nf=6 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 5 it 45 total=8.7670 mle=1.4738 pcon=4.9280 forget=1.3431 orth=1.0222 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[loss] ep 5 it 95 total=8.7815 mle=1.4835 pcon=4.9241 forget=1.3539 orth=1.0200 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 5 it 145 total=8.7132 mle=1.4755 pcon=4.9202 forget=1.3000 orth=1.0176 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 5 it 195 total=8.6724 mle=1.4363 pcon=4.9165 forget=1.3044 orth=1.0152 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 5 it 245 total=8.8973 mle=1.5739 pcon=4.9127 forget=1.3979 orth=1.0128 favg=0.0000 nr=114 nf=7 protos=540 fproto_sim=NA
[loss] ep 5 it 295 total=8.7255 mle=1.4717 pcon=4.9092 forget=1.3341 orth=1.0104 favg=0.0000 nr=120 nf=1 protos=540 fproto_sim=NA
[loss] ep 5 it 345 total=8.7432 mle=1.5275 pcon=4.9059 forget=1.3018 orth=1.0080 favg=0.0000 nr=110 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 6 it 4 total=8.6333 mle=1.4285 pcon=4.9025 forget=1.2968 orth=1.0056 favg=0.0000 nr=117 nf=4 protos=540 fproto_sim=NA
[loss] ep 6 it 54 total=8.7253 mle=1.4771 pcon=4.8992 forget=1.3458 orth=1.0032 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[loss] ep 6 it 104 total=8.6709 mle=1.4185 pcon=4.8961 forget=1.3556 orth=1.0007 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 6 it 154 total=8.6906 mle=1.5114 pcon=4.8932 forget=1.2878 orth=0.9983 favg=0.0000 nr=119 nf=6 protos=540 fproto_sim=NA
[loss] ep 6 it 204 total=8.7368 mle=1.5423 pcon=4.8899 forget=1.3087 orth=0.9958 favg=0.0000 nr=118 nf=5 protos=540 fproto_sim=NA
 14%|█▍        | 7/50 [01:39<09:31, 13.29s/it] 16%|█▌        | 8/50 [01:53<09:24, 13.45s/it] 18%|█▊        | 9/50 [02:05<09:00, 13.17s/it] 20%|██        | 10/50 [02:18<08:39, 12.99s/it] 22%|██▏       | 11/50 [02:30<08:20, 12.84s/it] 24%|██▍       | 12/50 [02:49<09:12, 14.54s/it] 26%|██▌       | 13/50 [03:02<08:44, 14.19s/it][loss] ep 6 it 254 total=8.6269 mle=1.4578 pcon=4.8872 forget=1.2886 orth=0.9932 favg=0.0000 nr=118 nf=2 protos=540 fproto_sim=NA
[loss] ep 6 it 304 total=8.8252 mle=1.6501 pcon=4.8846 forget=1.2998 orth=0.9907 favg=0.0000 nr=113 nf=11 protos=540 fproto_sim=NA
[loss] ep 6 it 354 total=8.6783 mle=1.4827 pcon=4.8817 forget=1.3258 orth=0.9881 favg=0.0000 nr=118 nf=7 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 7 it 13 total=8.6721 mle=1.4962 pcon=4.8792 forget=1.3113 orth=0.9855 favg=0.0000 nr=112 nf=6 protos=540 fproto_sim=NA
[loss] ep 7 it 63 total=8.7125 mle=1.5560 pcon=4.8767 forget=1.2970 orth=0.9829 favg=0.0000 nr=112 nf=8 protos=540 fproto_sim=NA
[loss] ep 7 it 113 total=8.8104 mle=1.6556 pcon=4.8741 forget=1.3004 orth=0.9803 favg=0.0000 nr=106 nf=13 protos=540 fproto_sim=NA
[loss] ep 7 it 163 total=8.7877 mle=1.6527 pcon=4.8717 forget=1.2857 orth=0.9776 favg=0.0000 nr=111 nf=7 protos=540 fproto_sim=NA
[loss] ep 7 it 213 total=8.5157 mle=1.3794 pcon=4.8693 forget=1.2920 orth=0.9750 favg=0.0000 nr=111 nf=8 protos=540 fproto_sim=NA
[loss] ep 7 it 263 total=8.6425 mle=1.5190 pcon=4.8671 forget=1.2841 orth=0.9723 favg=0.0000 nr=114 nf=7 protos=540 fproto_sim=NA
[loss] ep 7 it 313 total=8.6730 mle=1.5492 pcon=4.8647 forget=1.2896 orth=0.9695 favg=0.0000 nr=113 nf=7 protos=540 fproto_sim=NA
[loss] ep 7 it 363 total=8.6488 mle=1.5473 pcon=4.8624 forget=1.2723 orth=0.9668 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 8 it 22 total=8.6294 mle=1.5181 pcon=4.8601 forget=1.2872 orth=0.9640 favg=0.0000 nr=119 nf=3 protos=540 fproto_sim=NA
[loss] ep 8 it 72 total=8.6601 mle=1.5449 pcon=4.8578 forget=1.2962 orth=0.9612 favg=0.0000 nr=114 nf=6 protos=540 fproto_sim=NA
[loss] ep 8 it 122 total=8.5661 mle=1.4747 pcon=4.8558 forget=1.2773 orth=0.9584 favg=0.0000 nr=118 nf=7 protos=540 fproto_sim=NA
[loss] ep 8 it 172 total=8.4326 mle=1.3737 pcon=4.8538 forget=1.2494 orth=0.9556 favg=0.0000 nr=124 nf=1 protos=540 fproto_sim=NA
[loss] ep 8 it 222 total=8.5274 mle=1.4744 pcon=4.8517 forget=1.2487 orth=0.9527 favg=0.0000 nr=121 nf=3 protos=540 fproto_sim=NA
[loss] ep 8 it 272 total=8.6589 mle=1.5919 pcon=4.8496 forget=1.2676 orth=0.9499 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 8 it 322 total=8.5890 mle=1.5424 pcon=4.8476 forget=1.2520 orth=0.9470 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 8 it 372 total=8.6466 mle=1.5768 pcon=4.8457 forget=1.2799 orth=0.9441 favg=0.0000 nr=114 nf=9 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 9 it 31 total=8.6785 mle=1.6227 pcon=4.8439 forget=1.2706 orth=0.9413 favg=0.0000 nr=114 nf=4 protos=540 fproto_sim=NA
[loss] ep 9 it 81 total=8.4801 mle=1.4350 pcon=4.8420 forget=1.2646 orth=0.9384 favg=0.0000 nr=120 nf=3 protos=540 fproto_sim=NA
[loss] ep 9 it 131 total=8.4587 mle=1.4186 pcon=4.8401 forget=1.2645 orth=0.9355 favg=0.0000 nr=121 nf=5 protos=540 fproto_sim=NA
[loss] ep 9 it 181 total=8.5379 mle=1.5034 pcon=4.8383 forget=1.2635 orth=0.9327 favg=0.0000 nr=122 nf=4 protos=540 fproto_sim=NA
[loss] ep 9 it 231 total=8.4908 mle=1.4641 pcon=4.8365 forget=1.2605 orth=0.9298 favg=0.0000 nr=118 nf=4 protos=540 fproto_sim=NA
[loss] ep 9 it 281 total=8.6172 mle=1.6005 pcon=4.8350 forget=1.2548 orth=0.9269 favg=0.0000 nr=122 nf=2 protos=540 fproto_sim=NA
[loss] ep 9 it 331 total=8.5166 mle=1.4856 pcon=4.8333 forget=1.2738 orth=0.9239 favg=0.0000 nr=117 nf=4 protos=540 fproto_sim=NA
[loss] ep 9 it 381 total=8.4136 mle=1.3945 pcon=4.8313 forget=1.2668 orth=0.9211 favg=0.0000 nr=115 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 10 it 40 total=8.5194 mle=1.5070 pcon=4.8299 forget=1.2642 orth=0.9182 favg=0.0000 nr=123 nf=3 protos=540 fproto_sim=NA
[loss] ep 10 it 90 total=8.5923 mle=1.5617 pcon=4.8280 forget=1.2872 orth=0.9154 favg=0.0000 nr=113 nf=5 protos=540 fproto_sim=NA
[loss] ep 10 it 140 total=8.4867 mle=1.4485 pcon=4.8267 forget=1.2989 orth=0.9125 favg=0.0000 nr=117 nf=4 protos=540 fproto_sim=NA
[loss] ep 10 it 190 total=8.5608 mle=1.5553 pcon=4.8253 forget=1.2705 orth=0.9096 favg=0.0000 nr=118 nf=3 protos=540 fproto_sim=NA
[loss] ep 10 it 240 total=8.5766 mle=1.5320 pcon=4.8240 forget=1.3139 orth=0.9067 favg=0.0000 nr=121 nf=2 protos=540 fproto_sim=NA
[loss] ep 10 it 290 total=8.5845 mle=1.5593 pcon=4.8224 forget=1.2989 orth=0.9039 favg=0.0000 nr=107 nf=12 protos=540 fproto_sim=NA
[loss] ep 10 it 340 total=8.4462 mle=1.4110 pcon=4.8214 forget=1.3128 orth=0.9010 favg=0.0000 nr=111 nf=10 protos=540 fproto_sim=NA
[loss] ep 10 it 390 total=8.6623 mle=1.6482 pcon=4.8203 forget=1.2956 orth=0.8982 favg=0.0000 nr=74 nf=3 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 11 it 49 total=8.5176 mle=1.5007 pcon=4.8191 forget=1.3024 orth=0.8954 favg=0.0000 nr=117 nf=9 protos=540 fproto_sim=NA
[loss] ep 11 it 99 total=8.4951 mle=1.4746 pcon=4.8178 forget=1.3101 orth=0.8926 favg=0.0000 nr=113 nf=6 protos=540 fproto_sim=NA
[loss] ep 11 it 149 total=8.6063 mle=1.5845 pcon=4.8165 forget=1.3156 orth=0.8897 favg=0.0000 nr=111 nf=9 protos=540 fproto_sim=NA
[loss] ep 11 it 199 total=8.4861 mle=1.4710 pcon=4.8151 forget=1.3131 orth=0.8868 favg=0.0000 nr=119 nf=3 protos=540 fproto_sim=NA
[loss] ep 11 it 249 total=8.5887 mle=1.5727 pcon=4.8139 forget=1.3183 orth=0.8839 favg=0.0000 nr=119 nf=3 protos=540 fproto_sim=NA
[loss] ep 11 it 299 total=8.6336 mle=1.5794 pcon=4.8128 forget=1.3605 orth=0.8809 favg=0.0000 nr=112 nf=6 protos=540 fproto_sim=NA
[loss] ep 11 it 349 total=8.5140 mle=1.4930 pcon=4.8116 forget=1.3315 orth=0.8780 favg=0.0000 nr=116 nf=7 protos=540 fproto_sim=NA
[loss] ep 12 it 8 total=8.6632 mle=1.6497 pcon=4.8103 forget=1.3283 orth=0.8749 favg=0.0000 nr=118 nf=5 protos=540 fproto_sim=NA
[loss] ep 12 it 58 total=8.6414 mle=1.6210 pcon=4.8091 forget=1.3395 orth=0.8719 favg=0.0000 nr=120 nf=2 protos=540 fproto_sim=NA
[loss] ep 12 it 108 total=8.5905 mle=1.5712 pcon=4.8079 forget=1.3427 orth=0.8687 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 12 it 158 total=8.5306 mle=1.5016 pcon=4.8069 forget=1.3566 orth=0.8655 favg=0.0000 nr=115 nf=5 protos=540 fproto_sim=NA
[loss] ep 12 it 208 total=8.4975 mle=1.4804 pcon=4.8057 forget=1.3492 orth=0.8622 favg=0.0000 nr=121 nf=4 protos=540 fproto_sim=NA
[loss] ep 12 it 258 total=8.6139 mle=1.5962 pcon=4.8046 forget=1.3543 orth=0.8589 favg=0.0000 nr=110 nf=7 protos=540 fproto_sim=NA
[loss] ep 12 it 308 total=8.5922 mle=1.5727 pcon=4.8038 forget=1.3602 orth=0.8555 favg=0.0000 nr=118 nf=4 protos=540 fproto_sim=NA
[loss] ep 12 it 358 total=8.5308 mle=1.5132 pcon=4.8031 forget=1.3626 orth=0.8519 favg=0.0000 nr=117 nf=8 protos=540 fproto_sim=NA
[loss] ep 13 it 17 total=8.6816 mle=1.5992 pcon=4.8021 forget=1.4321 orth=0.8483 favg=0.0000 nr=114 nf=6 protos=540 fproto_sim=NA
[loss] ep 13 it 67 total=8.5188 mle=1.5009 pcon=4.8012 forget=1.3720 orth=0.8447 favg=0.0000 nr=116 nf=6 protos=540 fproto_sim=NA
[loss] ep 13 it 117 total=8.5314 mle=1.5131 pcon=4.8004 forget=1.3769 orth=0.8409 favg=0.0000 nr=113 nf=7 protos=540 fproto_sim=NA
[loss] ep 13 it 167 total=8.5269 mle=1.5163 pcon=4.7996 forget=1.3740 orth=0.8371 favg=0.0000 nr=114 nf=7 protos=540 fproto_sim=NA
 28%|██▊       | 14/50 [03:17<08:34, 14.29s/it] 30%|███       | 15/50 [03:28<07:49, 13.43s/it] 32%|███▏      | 16/50 [03:42<07:41, 13.58s/it] 34%|███▍      | 17/50 [03:56<07:30, 13.66s/it] 36%|███▌      | 18/50 [04:09<07:15, 13.61s/it] 38%|███▊      | 19/50 [04:22<06:58, 13.51s/it] 40%|████      | 20/50 [04:36<06:48, 13.63s/it][loss] ep 13 it 217 total=8.5245 mle=1.5073 pcon=4.7989 forget=1.3853 orth=0.8330 favg=0.0000 nr=111 nf=5 protos=540 fproto_sim=NA
[loss] ep 13 it 267 total=8.4477 mle=1.4381 pcon=4.7980 forget=1.3827 orth=0.8289 favg=0.0000 nr=115 nf=4 protos=540 fproto_sim=NA
[loss] ep 13 it 317 total=8.4113 mle=1.4129 pcon=4.7971 forget=1.3766 orth=0.8247 favg=0.0000 nr=111 nf=10 protos=540 fproto_sim=NA
[loss] ep 13 it 367 total=8.4874 mle=1.4815 pcon=4.7965 forget=1.3890 orth=0.8204 favg=0.0000 nr=113 nf=7 protos=540 fproto_sim=NA
[loss] ep 14 it 26 total=8.6052 mle=1.6123 pcon=4.7959 forget=1.3810 orth=0.8159 favg=0.0000 nr=114 nf=5 protos=540 fproto_sim=NA
[loss] ep 14 it 76 total=8.5309 mle=1.5403 pcon=4.7954 forget=1.3838 orth=0.8113 favg=0.0000 nr=115 nf=5 protos=540 fproto_sim=NA
[loss] ep 14 it 126 total=8.5754 mle=1.5655 pcon=4.7945 forget=1.4088 orth=0.8065 favg=0.0000 nr=111 nf=9 protos=540 fproto_sim=NA
[loss] ep 14 it 176 total=8.5231 mle=1.5490 pcon=4.7940 forget=1.3785 orth=0.8016 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[loss] ep 14 it 226 total=8.4573 mle=1.4795 pcon=4.7933 forget=1.3879 orth=0.7967 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[loss] ep 14 it 276 total=8.5394 mle=1.5654 pcon=4.7926 forget=1.3900 orth=0.7915 favg=0.0000 nr=116 nf=7 protos=540 fproto_sim=NA
[loss] ep 14 it 326 total=8.5414 mle=1.5506 pcon=4.7917 forget=1.4129 orth=0.7861 favg=0.0000 nr=118 nf=4 protos=540 fproto_sim=NA
[loss] ep 14 it 376 total=8.4542 mle=1.4920 pcon=4.7912 forget=1.3902 orth=0.7807 favg=0.0000 nr=121 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 15 it 35 total=8.4127 mle=1.4634 pcon=4.7903 forget=1.3839 orth=0.7751 favg=0.0000 nr=113 nf=8 protos=540 fproto_sim=NA
[loss] ep 15 it 85 total=8.4190 mle=1.4505 pcon=4.7895 forget=1.4098 orth=0.7692 favg=0.0000 nr=116 nf=7 protos=540 fproto_sim=NA
[loss] ep 15 it 135 total=8.5159 mle=1.5898 pcon=4.7888 forget=1.3742 orth=0.7631 favg=0.0000 nr=119 nf=3 protos=540 fproto_sim=NA
[loss] ep 15 it 185 total=8.4544 mle=1.5304 pcon=4.7882 forget=1.3789 orth=0.7569 favg=0.0000 nr=119 nf=4 protos=540 fproto_sim=NA
[loss] ep 15 it 235 total=8.4358 mle=1.5153 pcon=4.7874 forget=1.3826 orth=0.7505 favg=0.0000 nr=113 nf=4 protos=540 fproto_sim=NA
[loss] ep 15 it 285 total=8.4006 mle=1.4889 pcon=4.7867 forget=1.3811 orth=0.7438 favg=0.0000 nr=114 nf=7 protos=540 fproto_sim=NA
[loss] ep 15 it 335 total=8.4893 mle=1.5857 pcon=4.7859 forget=1.3808 orth=0.7370 favg=0.0000 nr=107 nf=12 protos=540 fproto_sim=NA
[loss] ep 15 it 385 total=8.4332 mle=1.5505 pcon=4.7851 forget=1.3677 orth=0.7299 favg=0.0000 nr=112 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 16 it 44 total=8.4995 mle=1.6294 pcon=4.7840 forget=1.3634 orth=0.7227 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 16 it 94 total=8.4264 mle=1.5410 pcon=4.7832 forget=1.3868 orth=0.7153 favg=0.0000 nr=115 nf=7 protos=540 fproto_sim=NA
[loss] ep 16 it 144 total=8.3797 mle=1.5162 pcon=4.7824 forget=1.3734 orth=0.7077 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[loss] ep 16 it 194 total=8.4329 mle=1.5983 pcon=4.7815 forget=1.3533 orth=0.6999 favg=0.0000 nr=115 nf=8 protos=540 fproto_sim=NA
[loss] ep 16 it 244 total=8.3414 mle=1.4875 pcon=4.7806 forget=1.3814 orth=0.6919 favg=0.0000 nr=110 nf=8 protos=540 fproto_sim=NA
[loss] ep 16 it 294 total=8.3344 mle=1.5156 pcon=4.7798 forget=1.3553 orth=0.6837 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 16 it 344 total=8.3658 mle=1.5499 pcon=4.7791 forget=1.3615 orth=0.6753 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 17 it 3 total=8.2347 mle=1.4279 pcon=4.7784 forget=1.3617 orth=0.6668 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 17 it 53 total=8.3124 mle=1.5314 pcon=4.7775 forget=1.3455 orth=0.6580 favg=0.0000 nr=120 nf=4 protos=540 fproto_sim=NA
[loss] ep 17 it 103 total=8.3409 mle=1.5726 pcon=4.7767 forget=1.3426 orth=0.6491 favg=0.0000 nr=116 nf=5 protos=540 fproto_sim=NA
[loss] ep 17 it 153 total=8.3535 mle=1.5933 pcon=4.7758 forget=1.3444 orth=0.6400 favg=0.0000 nr=118 nf=8 protos=540 fproto_sim=NA
[loss] ep 17 it 203 total=8.3427 mle=1.5910 pcon=4.7750 forget=1.3460 orth=0.6307 favg=0.0000 nr=118 nf=4 protos=540 fproto_sim=NA
[loss] ep 17 it 253 total=8.2990 mle=1.5590 pcon=4.7740 forget=1.3446 orth=0.6213 favg=0.0000 nr=112 nf=8 protos=540 fproto_sim=NA
[loss] ep 17 it 303 total=8.2351 mle=1.5176 pcon=4.7732 forget=1.3326 orth=0.6118 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[loss] ep 17 it 353 total=8.2340 mle=1.5096 pcon=4.7723 forget=1.3500 orth=0.6021 favg=0.0000 nr=112 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 18 it 12 total=8.2872 mle=1.5812 pcon=4.7716 forget=1.3422 orth=0.5923 favg=0.0000 nr=120 nf=5 protos=540 fproto_sim=NA
[loss] ep 18 it 62 total=8.2554 mle=1.5586 pcon=4.7708 forget=1.3437 orth=0.5823 favg=0.0000 nr=114 nf=3 protos=540 fproto_sim=NA
[loss] ep 18 it 112 total=8.0840 mle=1.3981 pcon=4.7703 forget=1.3434 orth=0.5723 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 18 it 162 total=8.1380 mle=1.4585 pcon=4.7693 forget=1.3480 orth=0.5621 favg=0.0000 nr=112 nf=8 protos=540 fproto_sim=NA
[loss] ep 18 it 212 total=8.2029 mle=1.5356 pcon=4.7686 forget=1.3469 orth=0.5518 favg=0.0000 nr=113 nf=8 protos=540 fproto_sim=NA
[loss] ep 18 it 262 total=8.1028 mle=1.4437 pcon=4.7678 forget=1.3499 orth=0.5415 favg=0.0000 nr=113 nf=10 protos=540 fproto_sim=NA
[loss] ep 18 it 312 total=8.2174 mle=1.5745 pcon=4.7672 forget=1.3446 orth=0.5310 favg=0.0000 nr=113 nf=9 protos=540 fproto_sim=NA
[loss] ep 18 it 362 total=8.1814 mle=1.5496 pcon=4.7665 forget=1.3447 orth=0.5206 favg=0.0000 nr=116 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 19 it 21 total=8.1372 mle=1.5098 pcon=4.7660 forget=1.3514 orth=0.5100 favg=0.0000 nr=117 nf=8 protos=540 fproto_sim=NA
[loss] ep 19 it 71 total=8.1742 mle=1.5611 pcon=4.7654 forget=1.3484 orth=0.4994 favg=0.0000 nr=113 nf=5 protos=540 fproto_sim=NA
[loss] ep 19 it 121 total=8.0825 mle=1.4671 pcon=4.7645 forget=1.3623 orth=0.4887 favg=0.0000 nr=118 nf=5 protos=540 fproto_sim=NA
[loss] ep 19 it 171 total=8.1394 mle=1.5339 pcon=4.7639 forget=1.3636 orth=0.4780 favg=0.0000 nr=111 nf=7 protos=540 fproto_sim=NA
[loss] ep 19 it 221 total=8.2636 mle=1.6624 pcon=4.7634 forget=1.3705 orth=0.4673 favg=0.0000 nr=117 nf=4 protos=540 fproto_sim=NA
[loss] ep 19 it 271 total=8.2136 mle=1.6391 pcon=4.7628 forget=1.3551 orth=0.4566 favg=0.0000 nr=119 nf=3 protos=540 fproto_sim=NA
[loss] ep 19 it 321 total=8.1192 mle=1.5513 pcon=4.7624 forget=1.3597 orth=0.4458 favg=0.0000 nr=112 nf=8 protos=540 fproto_sim=NA
[loss] ep 19 it 371 total=8.0980 mle=1.5346 pcon=4.7616 forget=1.3665 orth=0.4352 favg=0.0000 nr=116 nf=6 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 20 it 30 total=8.0468 mle=1.5021 pcon=4.7612 forget=1.3591 orth=0.4245 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
 42%|████▏     | 21/50 [04:50<06:37, 13.70s/it] 44%|████▍     | 22/50 [05:04<06:23, 13.71s/it] 46%|████▌     | 23/50 [05:16<05:58, 13.30s/it] 48%|████▊     | 24/50 [05:29<05:41, 13.14s/it] 50%|█████     | 25/50 [05:42<05:27, 13.11s/it] 52%|█████▏    | 26/50 [05:55<05:13, 13.06s/it][loss] ep 20 it 80 total=8.1021 mle=1.5740 pcon=4.7605 forget=1.3539 orth=0.4138 favg=0.0000 nr=119 nf=6 protos=540 fproto_sim=NA
[loss] ep 20 it 130 total=8.1389 mle=1.5628 pcon=4.7600 forget=1.4128 orth=0.4032 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 20 it 180 total=8.2286 mle=1.7100 pcon=4.7595 forget=1.3663 orth=0.3927 favg=0.0000 nr=119 nf=5 protos=540 fproto_sim=NA
[loss] ep 20 it 230 total=8.0373 mle=1.5068 pcon=4.7591 forget=1.3893 orth=0.3822 favg=0.0000 nr=118 nf=3 protos=540 fproto_sim=NA
[loss] ep 20 it 280 total=7.9841 mle=1.5016 pcon=4.7586 forget=1.3521 orth=0.3718 favg=0.0000 nr=112 nf=11 protos=540 fproto_sim=NA
[loss] ep 20 it 330 total=8.0802 mle=1.6053 pcon=4.7581 forget=1.3552 orth=0.3615 favg=0.0000 nr=115 nf=5 protos=540 fproto_sim=NA
[loss] ep 20 it 380 total=8.0838 mle=1.6122 pcon=4.7577 forget=1.3626 orth=0.3513 favg=0.0000 nr=114 nf=7 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 21 it 39 total=7.9081 mle=1.4881 pcon=4.7572 forget=1.3216 orth=0.3412 favg=0.0000 nr=116 nf=4 protos=540 fproto_sim=NA
[loss] ep 21 it 89 total=7.9005 mle=1.4743 pcon=4.7566 forget=1.3384 orth=0.3312 favg=0.0000 nr=113 nf=8 protos=540 fproto_sim=NA
[loss] ep 21 it 139 total=7.9373 mle=1.5095 pcon=4.7560 forget=1.3504 orth=0.3214 favg=0.0000 nr=115 nf=4 protos=540 fproto_sim=NA
[loss] ep 21 it 189 total=8.0145 mle=1.6280 pcon=4.7556 forget=1.3192 orth=0.3117 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 21 it 239 total=7.9334 mle=1.5347 pcon=4.7552 forget=1.3414 orth=0.3021 favg=0.0000 nr=111 nf=12 protos=540 fproto_sim=NA
[loss] ep 21 it 289 total=7.8822 mle=1.5299 pcon=4.7546 forget=1.3051 orth=0.2927 favg=0.0000 nr=116 nf=5 protos=540 fproto_sim=NA
[loss] ep 21 it 339 total=7.7924 mle=1.4574 pcon=4.7541 forget=1.2975 orth=0.2834 favg=0.0000 nr=115 nf=5 protos=540 fproto_sim=NA
[loss] ep 21 it 389 total=7.9210 mle=1.5981 pcon=4.7535 forget=1.2951 orth=0.2744 favg=0.0000 nr=111 nf=10 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 22 it 48 total=7.8201 mle=1.5159 pcon=4.7528 forget=1.2859 orth=0.2655 favg=0.0000 nr=109 nf=6 protos=540 fproto_sim=NA
[loss] ep 22 it 98 total=7.8499 mle=1.5394 pcon=4.7524 forget=1.3012 orth=0.2568 favg=0.0000 nr=113 nf=8 protos=540 fproto_sim=NA
[loss] ep 22 it 148 total=7.8574 mle=1.5288 pcon=4.7518 forget=1.3285 orth=0.2483 favg=0.0000 nr=113 nf=4 protos=540 fproto_sim=NA
[loss] ep 22 it 198 total=7.8026 mle=1.5305 pcon=4.7512 forget=1.2810 orth=0.2400 favg=0.0000 nr=115 nf=5 protos=540 fproto_sim=NA
[loss] ep 22 it 248 total=7.8691 mle=1.5676 pcon=4.7508 forget=1.3189 orth=0.2318 favg=0.0000 nr=113 nf=8 protos=540 fproto_sim=NA
[loss] ep 22 it 298 total=7.8245 mle=1.5726 pcon=4.7502 forget=1.2777 orth=0.2239 favg=0.0000 nr=120 nf=3 protos=540 fproto_sim=NA
[loss] ep 22 it 348 total=7.7893 mle=1.5435 pcon=4.7497 forget=1.2799 orth=0.2162 favg=0.0000 nr=113 nf=9 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 23 it 7 total=7.8236 mle=1.5904 pcon=4.7491 forget=1.2754 orth=0.2088 favg=0.0000 nr=116 nf=6 protos=540 fproto_sim=NA
[loss] ep 23 it 57 total=7.8377 mle=1.6004 pcon=4.7485 forget=1.2873 orth=0.2015 favg=0.0000 nr=111 nf=8 protos=540 fproto_sim=NA
[loss] ep 23 it 107 total=7.7474 mle=1.5235 pcon=4.7479 forget=1.2816 orth=0.1944 favg=0.0000 nr=119 nf=5 protos=540 fproto_sim=NA
[loss] ep 23 it 157 total=7.7826 mle=1.5553 pcon=4.7476 forget=1.2921 orth=0.1876 favg=0.0000 nr=113 nf=10 protos=540 fproto_sim=NA
[loss] ep 23 it 207 total=7.7976 mle=1.5921 pcon=4.7471 forget=1.2774 orth=0.1810 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[loss] ep 23 it 257 total=7.7378 mle=1.5354 pcon=4.7464 forget=1.2814 orth=0.1745 favg=0.0000 nr=114 nf=9 protos=540 fproto_sim=NA
[loss] ep 23 it 307 total=7.9392 mle=1.7262 pcon=4.7459 forget=1.2988 orth=0.1683 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 23 it 357 total=7.7227 mle=1.5254 pcon=4.7454 forget=1.2896 orth=0.1624 favg=0.0000 nr=116 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 24 it 16 total=7.6907 mle=1.5082 pcon=4.7451 forget=1.2808 orth=0.1566 favg=0.0000 nr=113 nf=9 protos=540 fproto_sim=NA
[loss] ep 24 it 66 total=7.6685 mle=1.4949 pcon=4.7448 forget=1.2778 orth=0.1510 favg=0.0000 nr=118 nf=6 protos=540 fproto_sim=NA
[loss] ep 24 it 116 total=7.8351 mle=1.6659 pcon=4.7444 forget=1.2791 orth=0.1456 favg=0.0000 nr=115 nf=9 protos=540 fproto_sim=NA
[loss] ep 24 it 166 total=7.8221 mle=1.6519 pcon=4.7442 forget=1.2855 orth=0.1405 favg=0.0000 nr=118 nf=6 protos=540 fproto_sim=NA
[loss] ep 24 it 216 total=7.5882 mle=1.4119 pcon=4.7440 forget=1.2968 orth=0.1355 favg=0.0000 nr=119 nf=4 protos=540 fproto_sim=NA
[loss] ep 24 it 266 total=7.6700 mle=1.5133 pcon=4.7437 forget=1.2823 orth=0.1307 favg=0.0000 nr=113 nf=11 protos=540 fproto_sim=NA
[loss] ep 24 it 316 total=7.7090 mle=1.4785 pcon=4.7435 forget=1.3608 orth=0.1261 favg=0.0000 nr=118 nf=6 protos=540 fproto_sim=NA
[loss] ep 24 it 366 total=7.8432 mle=1.6842 pcon=4.7434 forget=1.2940 orth=0.1217 favg=0.0000 nr=111 nf=6 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 25 it 25 total=7.7461 mle=1.5676 pcon=4.7430 forget=1.3181 orth=0.1175 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 25 it 75 total=7.6805 mle=1.5092 pcon=4.7427 forget=1.3153 orth=0.1134 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 25 it 125 total=7.7943 mle=1.6453 pcon=4.7425 forget=1.2971 orth=0.1095 favg=0.0000 nr=116 nf=5 protos=540 fproto_sim=NA
[loss] ep 25 it 175 total=7.7071 mle=1.5669 pcon=4.7423 forget=1.2922 orth=0.1057 favg=0.0000 nr=112 nf=10 protos=540 fproto_sim=NA
[loss] ep 25 it 225 total=7.7847 mle=1.6357 pcon=4.7422 forget=1.3047 orth=0.1021 favg=0.0000 nr=121 nf=2 protos=540 fproto_sim=NA
[loss] ep 25 it 275 total=7.7263 mle=1.5776 pcon=4.7422 forget=1.3079 orth=0.0987 favg=0.0000 nr=113 nf=8 protos=540 fproto_sim=NA
[loss] ep 25 it 325 total=7.8376 mle=1.7117 pcon=4.7420 forget=1.2885 orth=0.0953 favg=0.0000 nr=119 nf=6 protos=540 fproto_sim=NA
[loss] ep 25 it 375 total=7.7611 mle=1.6355 pcon=4.7421 forget=1.2913 orth=0.0922 favg=0.0000 nr=116 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 26 it 34 total=7.6307 mle=1.4955 pcon=4.7420 forget=1.3039 orth=0.0892 favg=0.0000 nr=114 nf=6 protos=540 fproto_sim=NA
[loss] ep 26 it 84 total=7.6558 mle=1.4976 pcon=4.7417 forget=1.3302 orth=0.0863 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 26 it 134 total=7.6714 mle=1.5450 pcon=4.7417 forget=1.3012 orth=0.0835 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[loss] ep 26 it 184 total=7.7975 mle=1.6664 pcon=4.7415 forget=1.3088 orth=0.0808 favg=0.0000 nr=111 nf=7 protos=540 fproto_sim=NA
[loss] ep 26 it 234 total=7.6111 mle=1.5100 pcon=4.7413 forget=1.2815 orth=0.0783 favg=0.0000 nr=124 nf=2 protos=540 fproto_sim=NA
[loss] ep 26 it 284 total=7.6453 mle=1.5208 pcon=4.7413 forget=1.3074 orth=0.0758 favg=0.0000 nr=112 nf=6 protos=540 fproto_sim=NA
 54%|█████▍    | 27/50 [06:09<05:05, 13.27s/it] 56%|█████▌    | 28/50 [06:23<04:56, 13.47s/it] 58%|█████▊    | 29/50 [06:37<04:44, 13.57s/it] 60%|██████    | 30/50 [06:50<04:30, 13.52s/it] 62%|██████▏   | 31/50 [07:02<04:07, 13.02s/it] 64%|██████▍   | 32/50 [07:14<03:51, 12.85s/it] 66%|██████▌   | 33/50 [07:27<03:39, 12.89s/it][loss] ep 26 it 334 total=7.7196 mle=1.5945 pcon=4.7413 forget=1.3104 orth=0.0735 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 26 it 384 total=7.7263 mle=1.6060 pcon=4.7409 forget=1.3081 orth=0.0713 favg=0.0000 nr=119 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 27 it 43 total=7.7311 mle=1.6187 pcon=4.7407 forget=1.3026 orth=0.0691 favg=0.0000 nr=111 nf=7 protos=540 fproto_sim=NA
[loss] ep 27 it 93 total=7.6401 mle=1.5274 pcon=4.7407 forget=1.3049 orth=0.0671 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 27 it 143 total=7.5921 mle=1.4804 pcon=4.7405 forget=1.3061 orth=0.0651 favg=0.0000 nr=116 nf=4 protos=540 fproto_sim=NA
[loss] ep 27 it 193 total=7.6649 mle=1.5347 pcon=4.7403 forget=1.3267 orth=0.0632 favg=0.0000 nr=114 nf=5 protos=540 fproto_sim=NA
[loss] ep 27 it 243 total=7.6072 mle=1.4980 pcon=4.7401 forget=1.3077 orth=0.0614 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 27 it 293 total=7.7161 mle=1.6108 pcon=4.7399 forget=1.3057 orth=0.0597 favg=0.0000 nr=122 nf=4 protos=540 fproto_sim=NA
[loss] ep 27 it 343 total=7.6143 mle=1.5046 pcon=4.7399 forget=1.3118 orth=0.0581 favg=0.0000 nr=119 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 28 it 2 total=7.7022 mle=1.6031 pcon=4.7399 forget=1.3028 orth=0.0565 favg=0.0000 nr=113 nf=9 protos=540 fproto_sim=NA
[loss] ep 28 it 52 total=7.6873 mle=1.5910 pcon=4.7399 forget=1.3014 orth=0.0550 favg=0.0000 nr=114 nf=5 protos=540 fproto_sim=NA
[loss] ep 28 it 102 total=7.6902 mle=1.5907 pcon=4.7398 forget=1.3062 orth=0.0535 favg=0.0000 nr=115 nf=8 protos=540 fproto_sim=NA
[loss] ep 28 it 152 total=7.7209 mle=1.6175 pcon=4.7396 forget=1.3117 orth=0.0521 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[loss] ep 28 it 202 total=7.7141 mle=1.6164 pcon=4.7394 forget=1.3075 orth=0.0508 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[loss] ep 28 it 252 total=7.8385 mle=1.7393 pcon=4.7393 forget=1.3103 orth=0.0495 favg=0.0000 nr=116 nf=6 protos=540 fproto_sim=NA
[loss] ep 28 it 302 total=7.6300 mle=1.5240 pcon=4.7394 forget=1.3184 orth=0.0483 favg=0.0000 nr=121 nf=4 protos=540 fproto_sim=NA
[loss] ep 28 it 352 total=7.6522 mle=1.5589 pcon=4.7392 forget=1.3069 orth=0.0472 favg=0.0000 nr=114 nf=5 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 29 it 11 total=7.6121 mle=1.5199 pcon=4.7389 forget=1.3074 orth=0.0460 favg=0.0000 nr=118 nf=5 protos=540 fproto_sim=NA
[loss] ep 29 it 61 total=7.6107 mle=1.5189 pcon=4.7386 forget=1.3083 orth=0.0450 favg=0.0000 nr=111 nf=8 protos=540 fproto_sim=NA
[loss] ep 29 it 111 total=7.8169 mle=1.7225 pcon=4.7386 forget=1.3119 orth=0.0439 favg=0.0000 nr=111 nf=9 protos=540 fproto_sim=NA
[loss] ep 29 it 161 total=7.6090 mle=1.5161 pcon=4.7384 forget=1.3114 orth=0.0430 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 29 it 211 total=7.7003 mle=1.6161 pcon=4.7381 forget=1.3041 orth=0.0420 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 29 it 261 total=7.6160 mle=1.5105 pcon=4.7379 forget=1.3265 orth=0.0411 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 29 it 311 total=6.2828 mle=1.5049 pcon=4.7377 forget=0.0000 orth=0.0402 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=7.6446 mle=1.5481 pcon=4.7377 forget=1.3194 orth=0.0394 favg=0.0000 nr=115 nf=7 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 30 it 20 total=7.6710 mle=1.5592 pcon=4.7375 forget=1.3356 orth=0.0386 favg=0.0000 nr=116 nf=7 protos=540 fproto_sim=NA
[loss] ep 30 it 70 total=7.7738 mle=1.6745 pcon=4.7375 forget=1.3239 orth=0.0378 favg=0.0000 nr=111 nf=9 protos=540 fproto_sim=NA
[loss] ep 30 it 120 total=7.5925 mle=1.5054 pcon=4.7375 forget=1.3125 orth=0.0371 favg=0.0000 nr=118 nf=6 protos=540 fproto_sim=NA
[loss] ep 30 it 170 total=7.6564 mle=1.5582 pcon=4.7371 forget=1.3246 orth=0.0364 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 30 it 220 total=7.6437 mle=1.5567 pcon=4.7370 forget=1.3142 orth=0.0357 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 30 it 270 total=7.6401 mle=1.5496 pcon=4.7370 forget=1.3184 orth=0.0351 favg=0.0000 nr=119 nf=7 protos=540 fproto_sim=NA
[loss] ep 30 it 320 total=7.7276 mle=1.6056 pcon=4.7368 forget=1.3508 orth=0.0344 favg=0.0000 nr=111 nf=8 protos=540 fproto_sim=NA
[loss] ep 30 it 370 total=7.6133 mle=1.5303 pcon=4.7365 forget=1.3126 orth=0.0338 favg=0.0000 nr=115 nf=8 protos=540 fproto_sim=NA
[loss] ep 31 it 29 total=7.6733 mle=1.5781 pcon=4.7365 forget=1.3254 orth=0.0333 favg=0.0000 nr=115 nf=7 protos=540 fproto_sim=NA
[loss] ep 31 it 79 total=7.7579 mle=1.6659 pcon=4.7363 forget=1.3230 orth=0.0327 favg=0.0000 nr=115 nf=7 protos=540 fproto_sim=NA
[loss] ep 31 it 129 total=7.6836 mle=1.5425 pcon=4.7362 forget=1.3727 orth=0.0321 favg=0.0000 nr=114 nf=9 protos=540 fproto_sim=NA
[loss] ep 31 it 179 total=7.7074 mle=1.5920 pcon=4.7363 forget=1.3474 orth=0.0316 favg=0.0000 nr=116 nf=5 protos=540 fproto_sim=NA
[loss] ep 31 it 229 total=7.7133 mle=1.6093 pcon=4.7361 forget=1.3367 orth=0.0311 favg=0.0000 nr=111 nf=9 protos=540 fproto_sim=NA
[loss] ep 31 it 279 total=7.5736 mle=1.4845 pcon=4.7361 forget=1.3224 orth=0.0306 favg=0.0000 nr=118 nf=9 protos=540 fproto_sim=NA
[loss] ep 31 it 329 total=7.7335 mle=1.6247 pcon=4.7361 forget=1.3425 orth=0.0302 favg=0.0000 nr=116 nf=6 protos=540 fproto_sim=NA
[loss] ep 31 it 379 total=7.6417 mle=1.5599 pcon=4.7360 forget=1.3160 orth=0.0297 favg=0.0000 nr=112 nf=5 protos=540 fproto_sim=NA
[loss] ep 32 it 38 total=7.5958 mle=1.5176 pcon=4.7361 forget=1.3127 orth=0.0293 favg=0.0000 nr=114 nf=6 protos=540 fproto_sim=NA
[loss] ep 32 it 88 total=7.6739 mle=1.5770 pcon=4.7361 forget=1.3320 orth=0.0289 favg=0.0000 nr=114 nf=4 protos=540 fproto_sim=NA
[loss] ep 32 it 138 total=7.6089 mle=1.5197 pcon=4.7359 forget=1.3248 orth=0.0285 favg=0.0000 nr=113 nf=6 protos=540 fproto_sim=NA
[loss] ep 32 it 188 total=7.7063 mle=1.5921 pcon=4.7358 forget=1.3504 orth=0.0281 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 32 it 238 total=7.6174 mle=1.5410 pcon=4.7358 forget=1.3129 orth=0.0277 favg=0.0000 nr=116 nf=6 protos=540 fproto_sim=NA
[loss] ep 32 it 288 total=7.5581 mle=1.4715 pcon=4.7358 forget=1.3235 orth=0.0274 favg=0.0000 nr=112 nf=11 protos=540 fproto_sim=NA
[loss] ep 32 it 338 total=7.6980 mle=1.6167 pcon=4.7357 forget=1.3186 orth=0.0270 favg=0.0000 nr=115 nf=7 protos=540 fproto_sim=NA
[loss] ep 32 it 388 total=7.6909 mle=1.6158 pcon=4.7357 forget=1.3127 orth=0.0267 favg=0.0000 nr=120 nf=6 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 33 it 47 total=7.7503 mle=1.6627 pcon=4.7355 forget=1.3258 orth=0.0264 favg=0.0000 nr=112 nf=8 protos=540 fproto_sim=NA
[loss] ep 33 it 97 total=7.6806 mle=1.6140 pcon=4.7355 forget=1.3050 orth=0.0261 favg=0.0000 nr=115 nf=7 protos=540 fproto_sim=NA
[loss] ep 33 it 147 total=7.7726 mle=1.6599 pcon=4.7351 forget=1.3518 orth=0.0258 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 33 it 197 total=7.6026 mle=1.5073 pcon=4.7349 forget=1.3349 orth=0.0255 favg=0.0000 nr=119 nf=3 protos=540 fproto_sim=NA
 68%|██████▊   | 34/50 [07:40<03:25, 12.85s/it] 70%|███████   | 35/50 [07:56<03:25, 13.70s/it] 72%|███████▏  | 36/50 [08:10<03:15, 14.00s/it] 74%|███████▍  | 37/50 [08:26<03:09, 14.59s/it] 76%|███████▌  | 38/50 [08:41<02:53, 14.48s/it] 78%|███████▊  | 39/50 [08:56<02:42, 14.77s/it] 80%|████████  | 40/50 [09:10<02:25, 14.57s/it][loss] ep 33 it 247 total=7.6409 mle=1.5584 pcon=4.7349 forget=1.3225 orth=0.0252 favg=0.0000 nr=114 nf=6 protos=540 fproto_sim=NA
[loss] ep 33 it 297 total=7.6480 mle=1.5565 pcon=4.7349 forget=1.3317 orth=0.0249 favg=0.0000 nr=119 nf=7 protos=540 fproto_sim=NA
[loss] ep 33 it 347 total=7.6692 mle=1.5881 pcon=4.7347 forget=1.3217 orth=0.0247 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 34 it 6 total=7.6335 mle=1.5268 pcon=4.7343 forget=1.3480 orth=0.0244 favg=0.0000 nr=109 nf=10 protos=540 fproto_sim=NA
[loss] ep 34 it 56 total=7.5841 mle=1.5226 pcon=4.7340 forget=1.3033 orth=0.0242 favg=0.0000 nr=119 nf=4 protos=540 fproto_sim=NA
[loss] ep 34 it 106 total=7.6238 mle=1.5473 pcon=4.7339 forget=1.3188 orth=0.0239 favg=0.0000 nr=119 nf=5 protos=540 fproto_sim=NA
[loss] ep 34 it 156 total=7.6282 mle=1.5562 pcon=4.7336 forget=1.3148 orth=0.0237 favg=0.0000 nr=116 nf=8 protos=540 fproto_sim=NA
[loss] ep 34 it 206 total=7.4980 mle=1.4302 pcon=4.7333 forget=1.3111 orth=0.0235 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 34 it 256 total=7.5952 mle=1.5163 pcon=4.7334 forget=1.3224 orth=0.0232 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[loss] ep 34 it 306 total=7.5509 mle=1.4893 pcon=4.7334 forget=1.3052 orth=0.0230 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 34 it 356 total=7.6620 mle=1.5806 pcon=4.7332 forget=1.3253 orth=0.0228 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 35 it 15 total=7.6025 mle=1.5303 pcon=4.7331 forget=1.3164 orth=0.0226 favg=0.0000 nr=115 nf=8 protos=540 fproto_sim=NA
[loss] ep 35 it 65 total=7.7524 mle=1.6353 pcon=4.7331 forget=1.3616 orth=0.0224 favg=0.0000 nr=118 nf=5 protos=540 fproto_sim=NA
[loss] ep 35 it 115 total=7.6146 mle=1.5368 pcon=4.7330 forget=1.3225 orth=0.0223 favg=0.0000 nr=114 nf=5 protos=540 fproto_sim=NA
[loss] ep 35 it 165 total=7.6503 mle=1.5731 pcon=4.7327 forget=1.3225 orth=0.0221 favg=0.0000 nr=106 nf=13 protos=540 fproto_sim=NA
[loss] ep 35 it 215 total=7.5593 mle=1.5036 pcon=4.7324 forget=1.3014 orth=0.0219 favg=0.0000 nr=114 nf=9 protos=540 fproto_sim=NA
[loss] ep 35 it 265 total=7.6529 mle=1.5902 pcon=4.7324 forget=1.3086 orth=0.0217 favg=0.0000 nr=116 nf=9 protos=540 fproto_sim=NA
[loss] ep 35 it 315 total=7.6193 mle=1.5605 pcon=4.7323 forget=1.3049 orth=0.0216 favg=0.0000 nr=111 nf=6 protos=540 fproto_sim=NA
[loss] ep 35 it 365 total=7.6664 mle=1.5530 pcon=4.7323 forget=1.3597 orth=0.0214 favg=0.0000 nr=114 nf=7 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 36 it 24 total=7.7106 mle=1.5880 pcon=4.7320 forget=1.3694 orth=0.0213 favg=0.0000 nr=114 nf=7 protos=540 fproto_sim=NA
[loss] ep 36 it 74 total=7.6480 mle=1.5927 pcon=4.7317 forget=1.3024 orth=0.0211 favg=0.0000 nr=117 nf=8 protos=540 fproto_sim=NA
[loss] ep 36 it 124 total=7.5848 mle=1.5287 pcon=4.7316 forget=1.3036 orth=0.0210 favg=0.0000 nr=120 nf=2 protos=540 fproto_sim=NA
[loss] ep 36 it 174 total=7.6508 mle=1.5841 pcon=4.7316 forget=1.3142 orth=0.0208 favg=0.0000 nr=118 nf=4 protos=540 fproto_sim=NA
[loss] ep 36 it 224 total=7.7349 mle=1.6421 pcon=4.7312 forget=1.3410 orth=0.0207 favg=0.0000 nr=119 nf=5 protos=540 fproto_sim=NA
[loss] ep 36 it 274 total=7.5759 mle=1.5224 pcon=4.7314 forget=1.3016 orth=0.0206 favg=0.0000 nr=115 nf=11 protos=540 fproto_sim=NA
[loss] ep 36 it 324 total=7.6482 mle=1.5441 pcon=4.7312 forget=1.3525 orth=0.0204 favg=0.0000 nr=116 nf=8 protos=540 fproto_sim=NA
[loss] ep 36 it 374 total=7.6445 mle=1.5930 pcon=4.7309 forget=1.3003 orth=0.0203 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 37 it 33 total=7.6054 mle=1.5378 pcon=4.7308 forget=1.3166 orth=0.0202 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[loss] ep 37 it 83 total=7.5836 mle=1.5287 pcon=4.7308 forget=1.3040 orth=0.0201 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 37 it 133 total=7.4877 mle=1.4635 pcon=4.7308 forget=1.2735 orth=0.0200 favg=0.0000 nr=116 nf=2 protos=540 fproto_sim=NA
[loss] ep 37 it 183 total=7.6256 mle=1.5958 pcon=4.7309 forget=1.2790 orth=0.0198 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 37 it 233 total=7.5995 mle=1.5235 pcon=4.7308 forget=1.3254 orth=0.0197 favg=0.0000 nr=120 nf=5 protos=540 fproto_sim=NA
[loss] ep 37 it 283 total=7.7522 mle=1.6718 pcon=4.7309 forget=1.3299 orth=0.0196 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 37 it 333 total=7.5689 mle=1.5080 pcon=4.7307 forget=1.3106 orth=0.0195 favg=0.0000 nr=110 nf=11 protos=540 fproto_sim=NA
[loss] ep 37 it 383 total=7.6519 mle=1.6080 pcon=4.7308 forget=1.2936 orth=0.0194 favg=0.0000 nr=117 nf=4 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 38 it 42 total=7.6201 mle=1.5535 pcon=4.7311 forget=1.3161 orth=0.0193 favg=0.0000 nr=112 nf=5 protos=540 fproto_sim=NA
[loss] ep 38 it 92 total=7.6919 mle=1.6248 pcon=4.7310 forget=1.3169 orth=0.0192 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[loss] ep 38 it 142 total=7.6058 mle=1.5660 pcon=4.7309 forget=1.2897 orth=0.0192 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 38 it 192 total=7.5080 mle=1.4481 pcon=4.7309 forget=1.3100 orth=0.0191 favg=0.0000 nr=122 nf=3 protos=540 fproto_sim=NA
[loss] ep 38 it 242 total=7.5807 mle=1.5327 pcon=4.7310 forget=1.2980 orth=0.0190 favg=0.0000 nr=115 nf=7 protos=540 fproto_sim=NA
[loss] ep 38 it 292 total=7.6513 mle=1.5954 pcon=4.7309 forget=1.3061 orth=0.0189 favg=0.0000 nr=110 nf=8 protos=540 fproto_sim=NA
[loss] ep 38 it 342 total=7.6354 mle=1.6019 pcon=4.7310 forget=1.2837 orth=0.0188 favg=0.0000 nr=118 nf=3 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 39 it 1 total=7.7424 mle=1.6991 pcon=4.7308 forget=1.2938 orth=0.0187 favg=0.0000 nr=112 nf=5 protos=540 fproto_sim=NA
[loss] ep 39 it 51 total=7.6542 mle=1.5634 pcon=4.7307 forget=1.3415 orth=0.0187 favg=0.0000 nr=118 nf=5 protos=540 fproto_sim=NA
[loss] ep 39 it 101 total=7.7785 mle=1.7307 pcon=4.7306 forget=1.2985 orth=0.0186 favg=0.0000 nr=107 nf=11 protos=540 fproto_sim=NA
[loss] ep 39 it 151 total=7.5492 mle=1.4968 pcon=4.7307 forget=1.3031 orth=0.0185 favg=0.0000 nr=116 nf=5 protos=540 fproto_sim=NA
[loss] ep 39 it 201 total=7.7122 mle=1.6289 pcon=4.7307 forget=1.3342 orth=0.0184 favg=0.0000 nr=118 nf=8 protos=540 fproto_sim=NA
[loss] ep 39 it 251 total=7.6644 mle=1.6146 pcon=4.7308 forget=1.3006 orth=0.0184 favg=0.0000 nr=118 nf=3 protos=540 fproto_sim=NA
[loss] ep 39 it 301 total=7.6470 mle=1.5999 pcon=4.7308 forget=1.2980 orth=0.0183 favg=0.0000 nr=115 nf=7 protos=540 fproto_sim=NA
[loss] ep 39 it 351 total=7.7377 mle=1.6610 pcon=4.7309 forget=1.3275 orth=0.0183 favg=0.0000 nr=111 nf=9 protos=540 fproto_sim=NA
[loss] ep 40 it 10 total=7.6213 mle=1.5992 pcon=4.7306 forget=1.2733 orth=0.0182 favg=0.0000 nr=113 nf=8 protos=540 fproto_sim=NA
[loss] ep 40 it 60 total=7.6203 mle=1.5918 pcon=4.7305 forget=1.2798 orth=0.0181 favg=0.0000 nr=119 nf=2 protos=540 fproto_sim=NA
 82%|████████▏ | 41/50 [09:24<02:09, 14.34s/it] 84%|████████▍ | 42/50 [09:39<01:56, 14.51s/it] 86%|████████▌ | 43/50 [09:55<01:44, 14.98s/it] 88%|████████▊ | 44/50 [10:10<01:29, 14.95s/it] 90%|█████████ | 45/50 [10:25<01:15, 15.12s/it] 92%|█████████▏| 46/50 [10:43<01:02, 15.74s/it] 94%|█████████▍| 47/50 [10:58<00:47, 15.76s/it][loss] ep 40 it 110 total=7.5484 mle=1.5108 pcon=4.7302 forget=1.2893 orth=0.0181 favg=0.0000 nr=111 nf=10 protos=540 fproto_sim=NA
[loss] ep 40 it 160 total=7.6715 mle=1.6213 pcon=4.7302 forget=1.3020 orth=0.0180 favg=0.0000 nr=120 nf=2 protos=540 fproto_sim=NA
[loss] ep 40 it 210 total=7.6323 mle=1.5990 pcon=4.7301 forget=1.2852 orth=0.0180 favg=0.0000 nr=115 nf=8 protos=540 fproto_sim=NA
[loss] ep 40 it 260 total=7.5921 mle=1.5460 pcon=4.7301 forget=1.2981 orth=0.0179 favg=0.0000 nr=116 nf=6 protos=540 fproto_sim=NA
[loss] ep 40 it 310 total=7.6684 mle=1.6391 pcon=4.7302 forget=1.2813 orth=0.0179 favg=0.0000 nr=108 nf=8 protos=540 fproto_sim=NA
[loss] ep 40 it 360 total=7.7102 mle=1.6883 pcon=4.7300 forget=1.2742 orth=0.0178 favg=0.0000 nr=115 nf=4 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 41 it 19 total=7.6267 mle=1.5872 pcon=4.7298 forget=1.2919 orth=0.0178 favg=0.0000 nr=118 nf=3 protos=540 fproto_sim=NA
[loss] ep 41 it 69 total=7.5858 mle=1.5400 pcon=4.7298 forget=1.2983 orth=0.0177 favg=0.0000 nr=111 nf=9 protos=540 fproto_sim=NA
[loss] ep 41 it 119 total=7.7201 mle=1.6748 pcon=4.7296 forget=1.2981 orth=0.0177 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[loss] ep 41 it 169 total=7.6137 mle=1.5725 pcon=4.7296 forget=1.2940 orth=0.0176 favg=0.0000 nr=116 nf=4 protos=540 fproto_sim=NA
[loss] ep 41 it 219 total=7.5541 mle=1.5070 pcon=4.7293 forget=1.3002 orth=0.0176 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 41 it 269 total=7.6412 mle=1.5309 pcon=4.7293 forget=1.3635 orth=0.0176 favg=0.0000 nr=119 nf=7 protos=540 fproto_sim=NA
[loss] ep 41 it 319 total=7.7175 mle=1.6624 pcon=4.7294 forget=1.3082 orth=0.0175 favg=0.0000 nr=117 nf=8 protos=540 fproto_sim=NA
[loss] ep 41 it 369 total=7.6317 mle=1.5967 pcon=4.7292 forget=1.2884 orth=0.0175 favg=0.0000 nr=119 nf=5 protos=540 fproto_sim=NA
[loss] ep 42 it 28 total=7.6075 mle=1.5615 pcon=4.7289 forget=1.2996 orth=0.0174 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[loss] ep 42 it 78 total=7.7010 mle=1.6644 pcon=4.7288 forget=1.2904 orth=0.0174 favg=0.0000 nr=116 nf=5 protos=540 fproto_sim=NA
[loss] ep 42 it 128 total=7.5943 mle=1.5519 pcon=4.7285 forget=1.2964 orth=0.0174 favg=0.0000 nr=114 nf=7 protos=540 fproto_sim=NA
[loss] ep 42 it 178 total=7.5831 mle=1.5542 pcon=4.7283 forget=1.2832 orth=0.0173 favg=0.0000 nr=115 nf=4 protos=540 fproto_sim=NA
[loss] ep 42 it 228 total=7.4964 mle=1.4705 pcon=4.7282 forget=1.2803 orth=0.0173 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 42 it 278 total=7.6262 mle=1.5934 pcon=4.7281 forget=1.2875 orth=0.0173 favg=0.0000 nr=111 nf=10 protos=540 fproto_sim=NA
[loss] ep 42 it 328 total=7.5997 mle=1.5696 pcon=4.7281 forget=1.2848 orth=0.0172 favg=0.0000 nr=111 nf=10 protos=540 fproto_sim=NA
[loss] ep 42 it 378 total=7.7322 mle=1.6883 pcon=4.7278 forget=1.2989 orth=0.0172 favg=0.0000 nr=118 nf=2 protos=540 fproto_sim=NA
[loss] ep 43 it 37 total=7.6424 mle=1.5398 pcon=4.7279 forget=1.3575 orth=0.0172 favg=0.0000 nr=114 nf=5 protos=540 fproto_sim=NA
[loss] ep 43 it 87 total=7.6376 mle=1.5672 pcon=4.7277 forget=1.3255 orth=0.0172 favg=0.0000 nr=115 nf=5 protos=540 fproto_sim=NA
[loss] ep 43 it 137 total=7.6150 mle=1.5824 pcon=4.7277 forget=1.2877 orth=0.0171 favg=0.0000 nr=117 nf=8 protos=540 fproto_sim=NA
[loss] ep 43 it 187 total=7.6175 mle=1.5680 pcon=4.7277 forget=1.3047 orth=0.0171 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 43 it 237 total=7.5650 mle=1.5264 pcon=4.7278 forget=1.2937 orth=0.0171 favg=0.0000 nr=115 nf=3 protos=540 fproto_sim=NA
[loss] ep 43 it 287 total=7.6195 mle=1.5897 pcon=4.7277 forget=1.2850 orth=0.0171 favg=0.0000 nr=117 nf=5 protos=540 fproto_sim=NA
[loss] ep 43 it 337 total=7.6500 mle=1.6090 pcon=4.7278 forget=1.2961 orth=0.0171 favg=0.0000 nr=118 nf=5 protos=540 fproto_sim=NA
[loss] ep 43 it 387 total=7.6285 mle=1.5899 pcon=4.7277 forget=1.2939 orth=0.0170 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[loss] ep 44 it 46 total=7.5268 mle=1.4957 pcon=4.7276 forget=1.2865 orth=0.0170 favg=0.0000 nr=116 nf=7 protos=540 fproto_sim=NA
[loss] ep 44 it 96 total=7.5211 mle=1.4844 pcon=4.7277 forget=1.2920 orth=0.0170 favg=0.0000 nr=117 nf=4 protos=540 fproto_sim=NA
[loss] ep 44 it 146 total=7.7172 mle=1.6845 pcon=4.7276 forget=1.2881 orth=0.0170 favg=0.0000 nr=110 nf=9 protos=540 fproto_sim=NA
[loss] ep 44 it 196 total=7.6234 mle=1.5708 pcon=4.7274 forget=1.3082 orth=0.0170 favg=0.0000 nr=99 nf=8 protos=540 fproto_sim=NA
[loss] ep 44 it 246 total=7.5658 mle=1.5282 pcon=4.7273 forget=1.2934 orth=0.0169 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[loss] ep 44 it 296 total=7.6426 mle=1.5891 pcon=4.7272 forget=1.3094 orth=0.0169 favg=0.0000 nr=116 nf=6 protos=540 fproto_sim=NA
[loss] ep 44 it 346 total=7.5847 mle=1.5614 pcon=4.7275 forget=1.2789 orth=0.0169 favg=0.0000 nr=115 nf=3 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[loss] ep 45 it 5 total=7.6601 mle=1.6415 pcon=4.7276 forget=1.2742 orth=0.0169 favg=0.0000 nr=118 nf=5 protos=540 fproto_sim=NA
[loss] ep 45 it 55 total=7.5882 mle=1.5184 pcon=4.7276 forget=1.3254 orth=0.0169 favg=0.0000 nr=122 nf=1 protos=540 fproto_sim=NA
[loss] ep 45 it 105 total=7.5812 mle=1.5460 pcon=4.7278 forget=1.2906 orth=0.0169 favg=0.0000 nr=115 nf=4 protos=540 fproto_sim=NA
[loss] ep 45 it 155 total=7.5573 mle=1.5277 pcon=4.7279 forget=1.2849 orth=0.0169 favg=0.0000 nr=115 nf=8 protos=540 fproto_sim=NA
[loss] ep 45 it 205 total=7.7395 mle=1.6982 pcon=4.7276 forget=1.2969 orth=0.0168 favg=0.0000 nr=117 nf=4 protos=540 fproto_sim=NA
[loss] ep 45 it 255 total=7.6114 mle=1.5683 pcon=4.7275 forget=1.2987 orth=0.0168 favg=0.0000 nr=114 nf=6 protos=540 fproto_sim=NA
[loss] ep 45 it 305 total=7.5541 mle=1.5184 pcon=4.7274 forget=1.2915 orth=0.0168 favg=0.0000 nr=112 nf=11 protos=540 fproto_sim=NA
[loss] ep 45 it 355 total=7.5120 mle=1.4705 pcon=4.7274 forget=1.2973 orth=0.0168 favg=0.0000 nr=115 nf=6 protos=540 fproto_sim=NA
[loss] ep 46 it 14 total=7.7217 mle=1.6917 pcon=4.7274 forget=1.2859 orth=0.0168 favg=0.0000 nr=118 nf=4 protos=540 fproto_sim=NA
[loss] ep 46 it 64 total=7.6096 mle=1.5411 pcon=4.7273 forget=1.3243 orth=0.0168 favg=0.0000 nr=110 nf=11 protos=540 fproto_sim=NA
[loss] ep 46 it 114 total=7.7040 mle=1.6798 pcon=4.7273 forget=1.2801 orth=0.0168 favg=0.0000 nr=112 nf=4 protos=540 fproto_sim=NA
[loss] ep 46 it 164 total=7.5610 mle=1.5250 pcon=4.7272 forget=1.2919 orth=0.0168 favg=0.0000 nr=114 nf=9 protos=540 fproto_sim=NA
[loss] ep 46 it 214 total=7.6546 mle=1.6263 pcon=4.7272 forget=1.2843 orth=0.0168 favg=0.0000 nr=120 nf=6 protos=540 fproto_sim=NA
[loss] ep 46 it 264 total=7.5497 mle=1.5093 pcon=4.7273 forget=1.2963 orth=0.0168 favg=0.0000 nr=117 nf=8 protos=540 fproto_sim=NA
[loss] ep 46 it 314 total=7.6298 mle=1.5985 pcon=4.7272 forget=1.2874 orth=0.0168 favg=0.0000 nr=119 nf=6 protos=540 fproto_sim=NA
[loss] ep 46 it 364 total=7.5993 mle=1.5678 pcon=4.7272 forget=1.2875 orth=0.0168 favg=0.0000 nr=114 nf=7 protos=540 fproto_sim=NA
[loss] ep 47 it 23 total=7.6867 mle=1.6421 pcon=4.7273 forget=1.3006 orth=0.0168 favg=0.0000 nr=112 nf=9 protos=540 fproto_sim=NA
[loss] ep 47 it 73 total=7.7753 mle=1.7178 pcon=4.7273 forget=1.3134 orth=0.0167 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[loss] ep 47 it 123 total=7.5734 mle=1.5424 pcon=4.7275 forget=1.2869 orth=0.0167 favg=0.0000 nr=118 nf=5 protos=540 fproto_sim=NA
[loss] ep 47 it 173 total=7.5919 mle=1.5534 pcon=4.7274 forget=1.2944 orth=0.0167 favg=0.0000 nr=114 nf=9 protos=540 fproto_sim=NA
[loss] ep 47 it 223 total=7.5367 mle=1.5120 pcon=4.7273 forget=1.2807 orth=0.0167 favg=0.0000 nr=114 nf=5 protos=540 fproto_sim=NA
[loss] ep 47 it 273 total=7.6467 mle=1.6240 pcon=4.7274 forget=1.2786 orth=0.0167 favg=0.0000 nr=117 nf=4 protos=540 fproto_sim=NA
 96%|█████████▌| 48/50 [11:14<00:31, 15.74s/it] 98%|█████████▊| 49/50 [11:29<00:15, 15.57s/it]100%|██████████| 50/50 [11:44<00:00, 15.31s/it]100%|██████████| 50/50 [11:44<00:00, 14.09s/it]
[loss] ep 47 it 323 total=7.5910 mle=1.5598 pcon=4.7275 forget=1.2870 orth=0.0167 favg=0.0000 nr=113 nf=6 protos=540 fproto_sim=NA
[loss] ep 47 it 373 total=7.5657 mle=1.5407 pcon=4.7273 forget=1.2810 orth=0.0167 favg=0.0000 nr=114 nf=5 protos=540 fproto_sim=NA
[loss] ep 48 it 32 total=7.6025 mle=1.5720 pcon=4.7272 forget=1.2865 orth=0.0167 favg=0.0000 nr=120 nf=3 protos=540 fproto_sim=NA
[loss] ep 48 it 82 total=7.7684 mle=1.7186 pcon=4.7273 forget=1.3058 orth=0.0167 favg=0.0000 nr=117 nf=2 protos=540 fproto_sim=NA
[loss] ep 48 it 132 total=7.5485 mle=1.5270 pcon=4.7273 forget=1.2774 orth=0.0167 favg=0.0000 nr=119 nf=3 protos=540 fproto_sim=NA
[loss] ep 48 it 182 total=7.6152 mle=1.5895 pcon=4.7273 forget=1.2816 orth=0.0167 favg=0.0000 nr=116 nf=3 protos=540 fproto_sim=NA
[loss] ep 48 it 232 total=7.6371 mle=1.5918 pcon=4.7274 forget=1.3012 orth=0.0167 favg=0.0000 nr=119 nf=5 protos=540 fproto_sim=NA
[loss] ep 48 it 282 total=7.6526 mle=1.6037 pcon=4.7273 forget=1.3050 orth=0.0167 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[loss] ep 48 it 332 total=7.6072 mle=1.5698 pcon=4.7273 forget=1.2933 orth=0.0167 favg=0.0000 nr=114 nf=4 protos=540 fproto_sim=NA
[loss] ep 48 it 382 total=7.5391 mle=1.5112 pcon=4.7274 forget=1.2837 orth=0.0167 favg=0.0000 nr=117 nf=6 protos=540 fproto_sim=NA
[loss] ep 49 it 41 total=7.7372 mle=1.6886 pcon=4.7273 forget=1.3046 orth=0.0167 favg=0.0000 nr=117 nf=7 protos=540 fproto_sim=NA
[loss] ep 49 it 91 total=7.7230 mle=1.6980 pcon=4.7273 forget=1.2810 orth=0.0167 favg=0.0000 nr=118 nf=6 protos=540 fproto_sim=NA
[loss] ep 49 it 141 total=7.5499 mle=1.5189 pcon=4.7272 forget=1.2872 orth=0.0167 favg=0.0000 nr=114 nf=8 protos=540 fproto_sim=NA
[loss] ep 49 it 191 total=7.6228 mle=1.6017 pcon=4.7272 forget=1.2772 orth=0.0167 favg=0.0000 nr=120 nf=6 protos=540 fproto_sim=NA
[loss] ep 49 it 241 total=7.6198 mle=1.5646 pcon=4.7269 forget=1.3116 orth=0.0167 favg=0.0000 nr=114 nf=10 protos=540 fproto_sim=NA
[loss] ep 49 it 291 total=7.6931 mle=1.6585 pcon=4.7270 forget=1.2909 orth=0.0167 favg=0.0000 nr=105 nf=8 protos=540 fproto_sim=NA
[loss] ep 49 it 341 total=7.5899 mle=1.5701 pcon=4.7272 forget=1.2759 orth=0.0167 favg=0.0000 nr=121 nf=4 protos=540 fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc1-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:03,  2.12it/s]  2%|▏         | 9/391 [00:00<00:19, 19.68it/s]  4%|▍         | 17/391 [00:00<00:10, 34.09it/s]  6%|▋         | 25/391 [00:00<00:08, 45.58it/s]  8%|▊         | 33/391 [00:00<00:06, 54.37it/s] 10%|█         | 41/391 [00:00<00:05, 60.92it/s] 13%|█▎        | 49/391 [00:01<00:05, 65.89it/s] 15%|█▍        | 57/391 [00:01<00:04, 69.50it/s] 17%|█▋        | 65/391 [00:01<00:04, 72.10it/s] 19%|█▊        | 73/391 [00:01<00:04, 73.74it/s] 21%|██        | 81/391 [00:01<00:04, 72.76it/s] 23%|██▎       | 89/391 [00:01<00:04, 74.32it/s] 25%|██▍       | 97/391 [00:01<00:04, 72.87it/s] 27%|██▋       | 105/391 [00:01<00:03, 74.36it/s] 29%|██▉       | 113/391 [00:01<00:03, 72.59it/s] 31%|███       | 121/391 [00:02<00:03, 74.01it/s] 33%|███▎      | 129/391 [00:02<00:03, 72.52it/s] 35%|███▌      | 137/391 [00:02<00:03, 73.85it/s] 37%|███▋      | 145/391 [00:02<00:03, 72.63it/s] 39%|███▉      | 153/391 [00:02<00:03, 74.07it/s] 41%|████      | 161/391 [00:02<00:03, 74.65it/s] 43%|████▎     | 169/391 [00:02<00:03, 73.81it/s] 45%|████▌     | 177/391 [00:02<00:02, 75.00it/s] 47%|████▋     | 185/391 [00:02<00:02, 73.28it/s] 49%|████▉     | 193/391 [00:03<00:02, 74.53it/s] 51%|█████▏    | 201/391 [00:03<00:02, 74.19it/s] 53%|█████▎    | 209/391 [00:03<00:02, 74.45it/s] 55%|█████▌    | 217/391 [00:03<00:02, 75.10it/s] 58%|█████▊    | 225/391 [00:03<00:02, 73.57it/s] 60%|█████▉    | 233/391 [00:03<00:02, 74.91it/s] 62%|██████▏   | 241/391 [00:03<00:01, 75.08it/s] 64%|██████▍   | 250/391 [00:03<00:01, 77.06it/s] 66%|██████▌   | 258/391 [00:03<00:01, 76.97it/s] 68%|██████▊   | 266/391 [00:03<00:01, 77.12it/s] 70%|███████   | 274/391 [00:04<00:01, 77.08it/s] 72%|███████▏  | 282/391 [00:04<00:01, 77.62it/s] 74%|███████▍  | 291/391 [00:04<00:01, 79.80it/s] 76%|███████▋  | 299/391 [00:04<00:01, 75.36it/s] 79%|███████▊  | 307/391 [00:04<00:01, 76.06it/s] 81%|████████  | 315/391 [00:04<00:01, 74.33it/s] 83%|████████▎ | 323/391 [00:04<00:00, 75.18it/s] 85%|████████▍ | 331/391 [00:04<00:00, 75.49it/s] 87%|████████▋ | 339/391 [00:04<00:00, 74.33it/s] 89%|████████▊ | 347/391 [00:05<00:00, 75.28it/s] 91%|█████████ | 355/391 [00:05<00:00, 73.74it/s] 93%|█████████▎| 363/391 [00:05<00:00, 74.48it/s] 95%|█████████▍| 371/391 [00:05<00:00, 75.20it/s] 97%|█████████▋| 379/391 [00:05<00:00, 75.44it/s] 99%|█████████▉| 387/391 [00:05<00:00, 75.30it/s]100%|██████████| 391/391 [00:05<00:00, 69.19it/s]
50000 images processed, 5.730698108673096 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:30,  2.56it/s] 11%|█▏        | 9/79 [00:00<00:03, 22.83it/s] 22%|██▏       | 17/79 [00:00<00:01, 37.84it/s] 30%|███       | 24/79 [00:00<00:01, 46.17it/s] 39%|███▉      | 31/79 [00:00<00:00, 51.87it/s] 49%|████▉     | 39/79 [00:00<00:00, 58.39it/s] 58%|█████▊    | 46/79 [00:01<00:00, 61.29it/s] 68%|██████▊   | 54/79 [00:01<00:00, 65.25it/s] 77%|███████▋  | 61/79 [00:01<00:00, 66.25it/s] 87%|████████▋ | 69/79 [00:01<00:00, 68.77it/s] 97%|█████████▋| 77/79 [00:01<00:00, 69.23it/s]100%|██████████| 79/79 [00:01<00:00, 53.17it/s]
10000 images processed, 1.5081791877746582 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc1-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:31,  2.22it/s]  4%|▍         | 8/204 [00:00<00:10, 18.18it/s]  7%|▋         | 15/204 [00:00<00:06, 30.59it/s] 11%|█         | 22/204 [00:00<00:04, 40.78it/s] 15%|█▍        | 30/204 [00:00<00:03, 51.20it/s] 19%|█▊        | 38/204 [00:00<00:02, 58.68it/s] 22%|██▏       | 45/204 [00:01<00:02, 61.11it/s] 26%|██▌       | 53/204 [00:01<00:02, 63.23it/s] 30%|██▉       | 61/204 [00:01<00:02, 65.97it/s] 33%|███▎      | 68/204 [00:01<00:02, 66.49it/s] 37%|███▋      | 76/204 [00:01<00:01, 68.75it/s] 41%|████      | 84/204 [00:01<00:01, 68.94it/s] 45%|████▌     | 92/204 [00:01<00:01, 68.81it/s] 49%|████▉     | 100/204 [00:01<00:01, 70.38it/s] 53%|█████▎    | 108/204 [00:01<00:01, 70.33it/s] 57%|█████▋    | 116/204 [00:02<00:01, 70.18it/s] 61%|██████    | 124/204 [00:02<00:01, 71.56it/s] 65%|██████▍   | 132/204 [00:02<00:01, 70.62it/s] 69%|██████▊   | 140/204 [00:02<00:00, 72.55it/s] 73%|███████▎  | 148/204 [00:02<00:00, 74.01it/s] 76%|███████▋  | 156/204 [00:02<00:00, 74.99it/s] 80%|████████  | 164/204 [00:02<00:00, 72.99it/s] 84%|████████▍ | 172/204 [00:02<00:00, 73.91it/s] 88%|████████▊ | 180/204 [00:02<00:00, 75.01it/s] 92%|█████████▏| 188/204 [00:03<00:00, 75.90it/s] 96%|█████████▌| 196/204 [00:03<00:00, 76.47it/s]100%|██████████| 204/204 [00:03<00:00, 76.56it/s]100%|██████████| 204/204 [00:03<00:00, 62.71it/s]
26032 images processed, 3.2908356189727783 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.60it/s] 10%|█         | 8/79 [00:00<00:04, 14.28it/s] 19%|█▉        | 15/79 [00:00<00:02, 25.73it/s] 28%|██▊       | 22/79 [00:00<00:01, 35.19it/s] 38%|███▊      | 30/79 [00:01<00:01, 44.22it/s] 48%|████▊     | 38/79 [00:01<00:00, 52.45it/s] 57%|█████▋    | 45/79 [00:01<00:00, 56.19it/s] 67%|██████▋   | 53/79 [00:01<00:00, 61.81it/s] 76%|███████▌  | 60/79 [00:01<00:00, 63.61it/s] 86%|████████▌ | 68/79 [00:01<00:00, 67.08it/s] 96%|█████████▌| 76/79 [00:01<00:00, 68.27it/s]100%|██████████| 79/79 [00:01<00:00, 45.82it/s]
10000 images processed, 1.7588865756988525 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.20it/s]  9%|▉         | 7/79 [00:00<00:04, 15.61it/s] 18%|█▊        | 14/79 [00:00<00:02, 28.80it/s] 28%|██▊       | 22/79 [00:00<00:01, 41.26it/s] 37%|███▋      | 29/79 [00:00<00:01, 48.34it/s] 47%|████▋     | 37/79 [00:00<00:00, 55.73it/s] 57%|█████▋    | 45/79 [00:01<00:00, 60.28it/s] 67%|██████▋   | 53/79 [00:01<00:00, 64.21it/s] 77%|███████▋  | 61/79 [00:01<00:00, 68.14it/s] 87%|████████▋ | 69/79 [00:01<00:00, 70.95it/s] 97%|█████████▋| 77/79 [00:01<00:00, 73.15it/s]100%|██████████| 79/79 [00:01<00:00, 51.45it/s]
10000 images processed, 1.5555319786071777 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:33,  2.08it/s] 13%|█▎        | 9/70 [00:00<00:03, 19.49it/s] 24%|██▍       | 17/70 [00:00<00:01, 33.70it/s] 36%|███▌      | 25/70 [00:00<00:01, 44.83it/s] 47%|████▋     | 33/70 [00:00<00:00, 53.48it/s] 59%|█████▊    | 41/70 [00:01<00:00, 60.27it/s] 70%|███████   | 49/70 [00:01<00:00, 65.26it/s] 81%|████████▏ | 57/70 [00:01<00:00, 68.90it/s] 93%|█████████▎| 65/70 [00:01<00:00, 71.58it/s]100%|██████████| 70/70 [00:01<00:00, 50.46it/s]
8925 images processed, 1.4162654876708984 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:37,  1.16it/s]  4%|▍         | 2/45 [00:01<00:18,  2.27it/s] 20%|██        | 9/45 [00:01<00:02, 13.01it/s] 38%|███▊      | 17/45 [00:01<00:01, 21.14it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.99it/s] 56%|█████▌    | 25/45 [00:01<00:00, 24.00it/s] 73%|███████▎  | 33/45 [00:01<00:00, 25.18it/s] 80%|████████  | 36/45 [00:02<00:00, 25.13it/s]100%|██████████| 45/45 [00:02<00:00, 37.02it/s]100%|██████████| 45/45 [00:02<00:00, 21.08it/s]
5640 images processed, 2.155970335006714 seconds used

18.98394203186035
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.80  98.94  96.92
places365     71.31  80.11  78.80
LSUN          29.19  93.69  93.48
iSUN          75.73  79.80  82.99
dtd           41.67  90.43  94.00
AVG           44.54  88.60  89.24
Retain-Acc: 0.7459
Forget-as-OOD (retain known vs forget novel):
  FPR: 38.00 AUROC: 89.87 AUIN: 99.30
8.038414716720581
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc2-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:55,  2.23it/s]  2%|▏         | 8/391 [00:00<00:20, 18.26it/s]  4%|▍         | 15/391 [00:00<00:12, 31.15it/s]  5%|▌         | 21/391 [00:00<00:09, 38.75it/s]  7%|▋         | 27/391 [00:00<00:08, 43.00it/s]  8%|▊         | 33/391 [00:00<00:07, 46.28it/s] 10%|▉         | 39/391 [00:01<00:07, 49.85it/s] 12%|█▏        | 45/391 [00:01<00:07, 49.04it/s] 13%|█▎        | 51/391 [00:01<00:07, 47.37it/s] 15%|█▌        | 59/391 [00:01<00:06, 54.82it/s] 17%|█▋        | 66/391 [00:01<00:05, 58.82it/s] 19%|█▉        | 74/391 [00:01<00:04, 63.41it/s] 21%|██        | 82/391 [00:01<00:04, 65.46it/s] 23%|██▎       | 90/391 [00:01<00:04, 68.65it/s] 25%|██▌       | 98/391 [00:01<00:04, 68.98it/s] 27%|██▋       | 106/391 [00:02<00:03, 71.77it/s] 29%|██▉       | 114/391 [00:02<00:03, 73.59it/s] 31%|███       | 122/391 [00:02<00:03, 74.60it/s] 33%|███▎      | 130/391 [00:02<00:03, 73.22it/s] 35%|███▌      | 138/391 [00:02<00:03, 74.57it/s] 37%|███▋      | 146/391 [00:02<00:03, 75.59it/s] 39%|███▉      | 154/391 [00:02<00:03, 74.27it/s] 41%|████▏     | 162/391 [00:02<00:03, 74.81it/s] 43%|████▎     | 170/391 [00:02<00:03, 73.31it/s] 46%|████▌     | 178/391 [00:03<00:02, 74.66it/s] 48%|████▊     | 186/391 [00:03<00:02, 73.23it/s] 50%|████▉     | 194/391 [00:03<00:02, 74.37it/s] 52%|█████▏    | 202/391 [00:03<00:02, 75.50it/s] 54%|█████▎    | 210/391 [00:03<00:02, 73.66it/s] 56%|█████▌    | 218/391 [00:03<00:02, 74.84it/s] 58%|█████▊    | 226/391 [00:03<00:02, 73.35it/s] 60%|█████▉    | 234/391 [00:03<00:02, 74.57it/s] 62%|██████▏   | 242/391 [00:03<00:02, 73.24it/s] 64%|██████▍   | 250/391 [00:04<00:01, 74.50it/s] 66%|██████▌   | 258/391 [00:04<00:01, 73.05it/s] 68%|██████▊   | 266/391 [00:04<00:01, 74.45it/s] 70%|███████   | 274/391 [00:04<00:01, 73.11it/s] 72%|███████▏  | 282/391 [00:04<00:01, 74.31it/s] 74%|███████▍  | 290/391 [00:04<00:01, 74.42it/s] 76%|███████▌  | 298/391 [00:04<00:01, 73.90it/s] 78%|███████▊  | 306/391 [00:04<00:01, 72.80it/s] 80%|████████  | 314/391 [00:04<00:01, 74.19it/s] 82%|████████▏ | 322/391 [00:05<00:00, 72.93it/s] 84%|████████▍ | 330/391 [00:05<00:00, 74.24it/s] 86%|████████▋ | 338/391 [00:05<00:00, 74.80it/s] 88%|████████▊ | 346/391 [00:05<00:00, 73.79it/s] 91%|█████████ | 354/391 [00:05<00:00, 74.81it/s] 93%|█████████▎| 362/391 [00:05<00:00, 73.13it/s] 95%|█████████▍| 370/391 [00:05<00:00, 74.75it/s] 97%|█████████▋| 378/391 [00:05<00:00, 73.51it/s] 99%|█████████▊| 386/391 [00:05<00:00, 74.76it/s]100%|██████████| 391/391 [00:05<00:00, 65.77it/s]
50000 images processed, 6.0238120555877686 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.77it/s] 10%|█         | 8/79 [00:00<00:04, 15.35it/s] 18%|█▊        | 14/79 [00:00<00:02, 25.16it/s] 28%|██▊       | 22/79 [00:00<00:01, 36.57it/s] 38%|███▊      | 30/79 [00:01<00:01, 45.08it/s] 48%|████▊     | 38/79 [00:01<00:00, 51.21it/s] 58%|█████▊    | 46/79 [00:01<00:00, 57.20it/s] 71%|███████   | 56/79 [00:01<00:00, 66.81it/s] 82%|████████▏ | 65/79 [00:01<00:00, 72.50it/s] 92%|█████████▏| 73/79 [00:01<00:00, 73.16it/s]100%|██████████| 79/79 [00:01<00:00, 47.80it/s]
10000 images processed, 1.674980878829956 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc2-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:30,  2.23it/s]  3%|▎         | 7/204 [00:00<00:12, 16.09it/s]  6%|▋         | 13/204 [00:00<00:07, 26.69it/s] 10%|▉         | 20/204 [00:00<00:04, 37.81it/s] 13%|█▎        | 27/204 [00:00<00:03, 46.04it/s] 17%|█▋        | 34/204 [00:00<00:03, 51.52it/s] 21%|██        | 42/204 [00:01<00:02, 58.28it/s] 24%|██▍       | 49/204 [00:01<00:02, 60.97it/s] 28%|██▊       | 57/204 [00:01<00:02, 64.78it/s] 31%|███▏      | 64/204 [00:01<00:02, 66.16it/s] 35%|███▌      | 72/204 [00:01<00:01, 66.65it/s] 39%|███▊      | 79/204 [00:01<00:01, 64.08it/s] 42%|████▏     | 86/204 [00:01<00:01, 64.71it/s] 46%|████▌     | 94/204 [00:01<00:01, 67.80it/s] 50%|████▉     | 101/204 [00:01<00:01, 68.11it/s] 53%|█████▎    | 109/204 [00:02<00:01, 69.27it/s] 57%|█████▋    | 116/204 [00:02<00:01, 69.02it/s] 60%|██████    | 123/204 [00:02<00:01, 68.94it/s] 64%|██████▍   | 131/204 [00:02<00:01, 70.70it/s] 68%|██████▊   | 139/204 [00:02<00:00, 69.64it/s] 72%|███████▏  | 147/204 [00:02<00:00, 69.96it/s] 76%|███████▌  | 155/204 [00:02<00:00, 71.34it/s] 80%|███████▉  | 163/204 [00:02<00:00, 70.64it/s] 84%|████████▍ | 171/204 [00:02<00:00, 71.86it/s] 88%|████████▊ | 179/204 [00:03<00:00, 71.52it/s] 92%|█████████▏| 187/204 [00:03<00:00, 72.34it/s] 96%|█████████▌| 195/204 [00:03<00:00, 72.43it/s]100%|█████████▉| 203/204 [00:03<00:00, 72.08it/s]100%|██████████| 204/204 [00:03<00:00, 60.20it/s]
26032 images processed, 3.42718768119812 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.62it/s] 10%|█         | 8/79 [00:00<00:04, 14.36it/s] 20%|██        | 16/79 [00:00<00:02, 27.66it/s] 29%|██▉       | 23/79 [00:00<00:01, 36.12it/s] 38%|███▊      | 30/79 [00:01<00:01, 43.99it/s] 48%|████▊     | 38/79 [00:01<00:00, 51.53it/s] 57%|█████▋    | 45/79 [00:01<00:00, 55.35it/s] 67%|██████▋   | 53/79 [00:01<00:00, 61.25it/s] 77%|███████▋  | 61/79 [00:01<00:00, 63.79it/s] 87%|████████▋ | 69/79 [00:01<00:00, 67.27it/s] 97%|█████████▋| 77/79 [00:01<00:00, 67.90it/s]100%|██████████| 79/79 [00:01<00:00, 45.92it/s]
10000 images processed, 1.7559599876403809 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.04it/s]  8%|▊         | 6/79 [00:00<00:05, 12.65it/s] 18%|█▊        | 14/79 [00:00<00:02, 27.99it/s] 28%|██▊       | 22/79 [00:00<00:01, 39.62it/s] 37%|███▋      | 29/79 [00:00<00:01, 47.05it/s] 47%|████▋     | 37/79 [00:01<00:00, 53.40it/s] 57%|█████▋    | 45/79 [00:01<00:00, 57.85it/s] 67%|██████▋   | 53/79 [00:01<00:00, 62.73it/s] 77%|███████▋  | 61/79 [00:01<00:00, 64.76it/s] 87%|████████▋ | 69/79 [00:01<00:00, 68.15it/s] 97%|█████████▋| 77/79 [00:01<00:00, 68.52it/s]100%|██████████| 79/79 [00:01<00:00, 48.83it/s]
10000 images processed, 1.6392486095428467 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:30,  2.25it/s]  4%|▍         | 3/70 [00:00<00:11,  6.03it/s] 11%|█▏        | 8/70 [00:00<00:03, 16.10it/s] 21%|██▏       | 15/70 [00:00<00:01, 28.84it/s] 31%|███▏      | 22/70 [00:00<00:01, 38.64it/s] 43%|████▎     | 30/70 [00:01<00:00, 48.91it/s] 53%|█████▎    | 37/70 [00:01<00:00, 53.62it/s] 64%|██████▍   | 45/70 [00:01<00:00, 58.46it/s] 76%|███████▌  | 53/70 [00:01<00:00, 62.90it/s] 86%|████████▌ | 60/70 [00:01<00:00, 64.52it/s] 97%|█████████▋| 68/70 [00:01<00:00, 66.70it/s]100%|██████████| 70/70 [00:01<00:00, 43.92it/s]
8925 images processed, 1.63128662109375 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:43,  1.01it/s] 11%|█         | 5/45 [00:01<00:06,  5.89it/s] 27%|██▋       | 12/45 [00:01<00:02, 15.59it/s] 38%|███▊      | 17/45 [00:01<00:01, 16.93it/s] 51%|█████     | 23/45 [00:01<00:01, 21.84it/s] 60%|██████    | 27/45 [00:01<00:00, 23.19it/s] 73%|███████▎  | 33/45 [00:02<00:00, 21.71it/s] 91%|█████████ | 41/45 [00:02<00:00, 26.33it/s]100%|██████████| 45/45 [00:02<00:00, 19.98it/s]100%|██████████| 45/45 [00:02<00:00, 17.01it/s]
5640 images processed, 2.675663471221924 seconds used

20.43199110031128
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.85  98.93  96.89
places365     70.86  80.67  79.44
LSUN          24.14  95.31  95.34
iSUN          75.47  79.98  83.09
dtd           41.05  90.68  94.14
AVG           43.27  89.12  89.78
Retain-Acc: 0.7425
Forget-as-OOD (retain known vs forget novel):
  FPR: 38.40 AUROC: 93.24 AUIN: 99.60
7.633787155151367
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc2-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-inc2-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-seen-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:01<08:43,  1.34s/it]  3%|▎         | 11/391 [00:01<00:37, 10.22it/s]  5%|▌         | 21/391 [00:01<00:17, 20.92it/s]  8%|▊         | 31/391 [00:01<00:11, 32.30it/s] 10%|█         | 41/391 [00:01<00:08, 43.71it/s] 13%|█▎        | 51/391 [00:01<00:06, 54.41it/s] 16%|█▌        | 61/391 [00:01<00:05, 63.81it/s] 18%|█▊        | 71/391 [00:02<00:04, 71.86it/s] 21%|██        | 81/391 [00:02<00:03, 78.13it/s] 23%|██▎       | 91/391 [00:02<00:03, 82.94it/s] 26%|██▌       | 101/391 [00:02<00:03, 86.77it/s] 28%|██▊       | 111/391 [00:02<00:03, 89.37it/s] 31%|███       | 121/391 [00:02<00:02, 91.49it/s] 34%|███▎      | 131/391 [00:02<00:02, 92.19it/s] 36%|███▌      | 141/391 [00:02<00:02, 93.64it/s] 39%|███▊      | 151/391 [00:02<00:02, 94.61it/s] 41%|████      | 161/391 [00:03<00:02, 94.84it/s] 44%|████▎     | 171/391 [00:03<00:02, 95.55it/s] 46%|████▋     | 181/391 [00:03<00:02, 95.83it/s] 49%|████▉     | 191/391 [00:03<00:02, 96.23it/s] 51%|█████▏    | 201/391 [00:03<00:01, 96.53it/s] 54%|█████▍    | 211/391 [00:03<00:01, 96.35it/s] 57%|█████▋    | 221/391 [00:03<00:01, 96.19it/s] 59%|█████▉    | 231/391 [00:03<00:01, 96.45it/s] 62%|██████▏   | 241/391 [00:03<00:01, 96.60it/s] 64%|██████▍   | 251/391 [00:03<00:01, 96.62it/s] 67%|██████▋   | 261/391 [00:04<00:01, 96.22it/s] 69%|██████▉   | 271/391 [00:04<00:01, 96.46it/s] 72%|███████▏  | 281/391 [00:04<00:01, 96.47it/s] 74%|███████▍  | 291/391 [00:04<00:01, 96.43it/s] 77%|███████▋  | 301/391 [00:04<00:00, 96.50it/s] 80%|███████▉  | 311/391 [00:04<00:00, 96.55it/s] 82%|████████▏ | 321/391 [00:04<00:00, 96.43it/s] 85%|████████▍ | 331/391 [00:04<00:00, 85.81it/s] 87%|████████▋ | 341/391 [00:04<00:00, 87.71it/s] 90%|████████▉ | 351/391 [00:05<00:00, 89.72it/s] 92%|█████████▏| 361/391 [00:05<00:00, 90.69it/s] 95%|█████████▍| 371/391 [00:05<00:00, 92.57it/s] 97%|█████████▋| 381/391 [00:05<00:00, 94.04it/s]100%|██████████| 391/391 [00:05<00:00, 92.43it/s]100%|██████████| 391/391 [00:05<00:00, 71.76it/s]
50000 images processed, 5.546071529388428 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.36it/s] 13%|█▎        | 10/79 [00:00<00:02, 24.21it/s] 24%|██▍       | 19/79 [00:00<00:01, 41.15it/s] 35%|███▌      | 28/79 [00:00<00:00, 53.04it/s] 48%|████▊     | 38/79 [00:00<00:00, 64.27it/s] 61%|██████    | 48/79 [00:00<00:00, 72.12it/s] 73%|███████▎  | 58/79 [00:01<00:00, 78.59it/s] 86%|████████▌ | 68/79 [00:01<00:00, 83.29it/s] 99%|█████████▊| 78/79 [00:01<00:00, 86.50it/s]100%|██████████| 79/79 [00:02<00:00, 32.36it/s]
10000 images processed, 2.503952741622925 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-seen-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:40,  2.03it/s]  5%|▌         | 11/204 [00:00<00:08, 23.50it/s] 10%|█         | 21/204 [00:00<00:04, 40.94it/s] 15%|█▌        | 31/204 [00:00<00:03, 55.02it/s] 20%|██        | 41/204 [00:00<00:02, 66.04it/s] 25%|██▌       | 51/204 [00:01<00:02, 74.01it/s] 30%|██▉       | 61/204 [00:01<00:01, 79.98it/s] 35%|███▍      | 71/204 [00:01<00:01, 84.57it/s] 40%|███▉      | 81/204 [00:01<00:01, 87.16it/s] 45%|████▍     | 91/204 [00:01<00:01, 89.16it/s] 50%|████▉     | 101/204 [00:01<00:01, 91.09it/s] 54%|█████▍    | 111/204 [00:01<00:01, 92.26it/s] 59%|█████▉    | 121/204 [00:01<00:00, 93.16it/s] 64%|██████▍   | 131/204 [00:01<00:00, 93.72it/s] 69%|██████▉   | 141/204 [00:01<00:00, 94.07it/s] 74%|███████▍  | 151/204 [00:02<00:00, 94.64it/s] 79%|███████▉  | 161/204 [00:02<00:00, 94.76it/s] 84%|████████▍ | 171/204 [00:02<00:00, 95.19it/s] 89%|████████▊ | 181/204 [00:02<00:00, 95.52it/s] 94%|█████████▎| 191/204 [00:02<00:00, 96.09it/s] 99%|█████████▊| 201/204 [00:02<00:00, 96.51it/s]100%|██████████| 204/204 [00:02<00:00, 77.52it/s]
26032 images processed, 2.6749284267425537 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:47,  1.66it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.08it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.55it/s] 39%|███▉      | 31/79 [00:00<00:00, 50.42it/s] 51%|█████     | 40/79 [00:01<00:00, 59.95it/s] 62%|██████▏   | 49/79 [00:01<00:00, 67.62it/s] 75%|███████▍  | 59/79 [00:01<00:00, 74.88it/s] 87%|████████▋ | 69/79 [00:01<00:00, 80.93it/s]100%|██████████| 79/79 [00:01<00:00, 55.06it/s]
10000 images processed, 1.4632399082183838 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.01it/s] 14%|█▍        | 11/79 [00:00<00:02, 23.36it/s] 27%|██▋       | 21/79 [00:00<00:01, 40.65it/s] 39%|███▉      | 31/79 [00:00<00:00, 54.67it/s] 52%|█████▏    | 41/79 [00:00<00:00, 65.47it/s] 65%|██████▍   | 51/79 [00:01<00:00, 73.80it/s] 77%|███████▋  | 61/79 [00:01<00:00, 80.17it/s] 90%|████████▉ | 71/79 [00:01<00:00, 84.99it/s]100%|██████████| 79/79 [00:01<00:00, 60.07it/s]
10000 images processed, 1.3364942073822021 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:35,  1.93it/s] 16%|█▌        | 11/70 [00:00<00:02, 22.77it/s] 29%|██▊       | 20/70 [00:00<00:01, 37.83it/s] 43%|████▎     | 30/70 [00:00<00:00, 52.42it/s] 56%|█████▌    | 39/70 [00:00<00:00, 61.64it/s] 70%|███████   | 49/70 [00:01<00:00, 71.04it/s] 84%|████████▍ | 59/70 [00:01<00:00, 78.07it/s] 99%|█████████▊| 69/70 [00:01<00:00, 83.45it/s]100%|██████████| 70/70 [00:01<00:00, 55.22it/s]
8925 images processed, 1.3039453029632568 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:43,  1.00it/s]  4%|▍         | 2/45 [00:01<00:20,  2.07it/s] 27%|██▋       | 12/45 [00:01<00:01, 16.51it/s] 38%|███▊      | 17/45 [00:01<00:01, 17.67it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.09it/s] 69%|██████▉   | 31/45 [00:01<00:00, 35.52it/s] 82%|████████▏ | 37/45 [00:02<00:00, 21.94it/s]100%|██████████| 45/45 [00:02<00:00, 19.72it/s]
5640 images processed, 2.3043463230133057 seconds used

18.805482625961304
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.94  98.91  96.68
places365     70.95  80.63  78.59
LSUN          24.82  95.18  95.00
iSUN          75.94  79.87  82.37
dtd           41.35  90.61  93.82
AVG           43.60  89.04  89.29
Retain-Acc: 0.7474
Forget-as-OOD (retain known vs forget novel):
  FPR: 38.10 AUROC: 91.69 AUIN: 98.88
7.21247935295105
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage2-seen-forget_rf.png
==== Stage 3: inc={100,101,102,103,104}; seen={0,8,11,40,51,66,67,88,94,57}; all(union)={0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2', forget_classes='0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='100,101,102,103,104', forget_classes_seen='0,8,11,40,51,66,67,88,94,57', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:168: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:274: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [00:20<16:48, 20.58s/it]  4%|▍         | 2/50 [00:34<13:18, 16.63s/it]  6%|▌         | 3/50 [00:47<11:54, 15.21s/it]  8%|▊         | 4/50 [01:01<11:15, 14.69s/it] 10%|█         | 5/50 [01:16<11:05, 14.78s/it] 12%|█▏        | 6/50 [01:31<10:49, 14.75s/it][loss] ep 0 it 0 total=9.7063 mle=1.6602 pcon=5.2947 forget=0.0000 orth=2.7514 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=9.6286 mle=1.6039 pcon=5.2749 forget=0.0000 orth=2.7498 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.7040 mle=1.7019 pcon=5.2554 forget=0.0000 orth=2.7467 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=9.5696 mle=1.5912 pcon=5.2370 forget=0.0000 orth=2.7414 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=9.6422 mle=1.6891 pcon=5.2191 forget=0.0000 orth=2.7340 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=9.4715 mle=1.5452 pcon=5.2019 forget=0.0000 orth=2.7244 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.4596 mle=1.5619 pcon=5.1851 forget=0.0000 orth=2.7126 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=9.4440 mle=1.5766 pcon=5.1689 forget=0.0000 orth=2.6985 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 1 it 9 total=9.2527 mle=1.4170 pcon=5.1536 forget=0.0000 orth=2.6821 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=9.3353 mle=1.5334 pcon=5.1386 forget=0.0000 orth=2.6633 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=9.2442 mle=1.4778 pcon=5.1243 forget=0.0000 orth=2.6421 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=9.3165 mle=1.5875 pcon=5.1105 forget=0.0000 orth=2.6185 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=9.1541 mle=1.4645 pcon=5.0972 forget=0.0000 orth=2.5923 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=9.2001 mle=1.5518 pcon=5.0847 forget=0.0000 orth=2.5636 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=9.0368 mle=1.4324 pcon=5.0721 forget=0.0000 orth=2.5322 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=9.0883 mle=1.5295 pcon=5.0606 forget=0.0000 orth=2.4982 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 2 it 18 total=9.0060 mle=1.4947 pcon=5.0498 forget=0.0000 orth=2.4615 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.9510 mle=1.4898 pcon=5.0391 forget=0.0000 orth=2.4221 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.8206 mle=1.4116 pcon=5.0290 forget=0.0000 orth=2.3800 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.8957 mle=1.5418 pcon=5.0187 forget=0.0000 orth=2.3352 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=8.6439 mle=1.3470 pcon=5.0091 forget=0.0000 orth=2.2879 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.6717 mle=1.4339 pcon=4.9998 forget=0.0000 orth=2.2380 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.6590 mle=1.4823 pcon=4.9910 forget=0.0000 orth=2.1857 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=8.5076 mle=1.3938 pcon=4.9826 forget=0.0000 orth=2.1312 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 3 it 27 total=8.5708 mle=1.5215 pcon=4.9745 forget=0.0000 orth=2.0748 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4284 mle=1.4453 pcon=4.9665 forget=0.0000 orth=2.0166 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.3599 mle=1.4442 pcon=4.9588 forget=0.0000 orth=1.9569 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=8.2880 mle=1.4406 pcon=4.9514 forget=0.0000 orth=1.8960 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=8.2337 mle=1.4549 pcon=4.9445 forget=0.0000 orth=1.8342 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=8.2188 mle=1.5089 pcon=4.9380 forget=0.0000 orth=1.7719 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=8.1181 mle=1.4774 pcon=4.9314 forget=0.0000 orth=1.7093 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=8.1091 mle=1.5371 pcon=4.9251 forget=0.0000 orth=1.6469 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 4 it 36 total=8.0155 mle=1.5113 pcon=4.9192 forget=0.0000 orth=1.5849 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=7.8881 mle=1.4509 pcon=4.9135 forget=0.0000 orth=1.5236 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=7.8180 mle=1.4466 pcon=4.9081 forget=0.0000 orth=1.4633 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=7.7897 mle=1.4829 pcon=4.9025 forget=0.0000 orth=1.4043 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=7.7967 mle=1.5523 pcon=4.8975 forget=0.0000 orth=1.3469 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=7.6422 mle=1.4584 pcon=4.8927 forget=0.0000 orth=1.2910 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=7.6211 mle=1.4964 pcon=4.8880 forget=0.0000 orth=1.2368 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.5396 mle=1.4716 pcon=4.8835 forget=0.0000 orth=1.1845 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 5 it 45 total=7.4828 mle=1.4699 pcon=4.8787 forget=0.0000 orth=1.1342 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.4605 mle=1.4999 pcon=4.8746 forget=0.0000 orth=1.0860 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.3788 mle=1.4683 pcon=4.8706 forget=0.0000 orth=1.0399 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.3052 mle=1.4423 pcon=4.8670 forget=0.0000 orth=0.9960 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.3952 mle=1.5781 pcon=4.8632 forget=0.0000 orth=0.9540 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.2957 mle=1.5218 pcon=4.8597 forget=0.0000 orth=0.9142 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.3045 mle=1.5715 pcon=4.8564 forget=0.0000 orth=0.8765 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 6 it 4 total=7.1569 mle=1.4630 pcon=4.8531 forget=0.0000 orth=0.8408 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.1845 mle=1.5272 pcon=4.8501 forget=0.0000 orth=0.8071 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.0488 mle=1.4262 pcon=4.8472 forget=0.0000 orth=0.7754 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.0962 mle=1.5060 pcon=4.8445 forget=0.0000 orth=0.7457 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.1107 mle=1.5513 pcon=4.8415 forget=0.0000 orth=0.7178 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
 14%|█▍        | 7/50 [01:45<10:18, 14.39s/it] 16%|█▌        | 8/50 [01:59<10:03, 14.37s/it] 18%|█▊        | 9/50 [02:13<09:47, 14.34s/it] 20%|██        | 10/50 [02:27<09:26, 14.16s/it] 22%|██▏       | 11/50 [02:42<09:26, 14.51s/it] 24%|██▍       | 12/50 [02:56<09:07, 14.40s/it] 26%|██▌       | 13/50 [03:11<08:51, 14.36s/it][loss] ep 6 it 254 total=7.0006 mle=1.4699 pcon=4.8391 forget=0.0000 orth=0.6917 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.1557 mle=1.6519 pcon=4.8367 forget=0.0000 orth=0.6671 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=6.9884 mle=1.5101 pcon=4.8342 forget=0.0000 orth=0.6441 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 7 it 13 total=6.9733 mle=1.5185 pcon=4.8319 forget=0.0000 orth=0.6228 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.0032 mle=1.5706 pcon=4.8298 forget=0.0000 orth=0.6028 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.0904 mle=1.6787 pcon=4.8276 forget=0.0000 orth=0.5841 favg=0.0000 nr=106 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.0598 mle=1.6675 pcon=4.8256 forget=0.0000 orth=0.5667 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=6.7885 mle=1.4145 pcon=4.8236 forget=0.0000 orth=0.5504 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=6.8914 mle=1.5346 pcon=4.8217 forget=0.0000 orth=0.5352 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=6.9071 mle=1.5665 pcon=4.8197 forget=0.0000 orth=0.5210 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=6.9104 mle=1.5849 pcon=4.8178 forget=0.0000 orth=0.5077 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 8 it 22 total=6.8377 mle=1.5266 pcon=4.8160 forget=0.0000 orth=0.4951 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=6.8731 mle=1.5756 pcon=4.8142 forget=0.0000 orth=0.4834 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=6.7998 mle=1.5150 pcon=4.8125 forget=0.0000 orth=0.4723 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=6.6844 mle=1.4114 pcon=4.8110 forget=0.0000 orth=0.4620 favg=0.0000 nr=124 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=6.7708 mle=1.5092 pcon=4.8093 forget=0.0000 orth=0.4522 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=6.8485 mle=1.5978 pcon=4.8077 forget=0.0000 orth=0.4430 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=6.7798 mle=1.5393 pcon=4.8062 forget=0.0000 orth=0.4343 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=6.8119 mle=1.5810 pcon=4.8048 forget=0.0000 orth=0.4261 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 9 it 31 total=6.8618 mle=1.6401 pcon=4.8034 forget=0.0000 orth=0.4184 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=6.6687 mle=1.4558 pcon=4.8020 forget=0.0000 orth=0.4109 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=6.6447 mle=1.4402 pcon=4.8006 forget=0.0000 orth=0.4039 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=6.7106 mle=1.5141 pcon=4.7993 forget=0.0000 orth=0.3972 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=6.6704 mle=1.4817 pcon=4.7979 forget=0.0000 orth=0.3908 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=6.8004 mle=1.6189 pcon=4.7968 forget=0.0000 orth=0.3847 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=6.6489 mle=1.4746 pcon=4.7955 forget=0.0000 orth=0.3788 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=6.5775 mle=1.4104 pcon=4.7939 forget=0.0000 orth=0.3732 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 10 it 40 total=6.6704 mle=1.5095 pcon=4.7930 forget=0.0000 orth=0.3678 favg=0.0000 nr=123 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=6.7112 mle=1.5570 pcon=4.7916 forget=0.0000 orth=0.3627 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=6.6055 mle=1.4570 pcon=4.7907 forget=0.0000 orth=0.3579 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=6.7168 mle=1.5740 pcon=4.7896 forget=0.0000 orth=0.3532 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=6.6744 mle=1.5370 pcon=4.7885 forget=0.0000 orth=0.3488 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=6.6987 mle=1.5668 pcon=4.7874 forget=0.0000 orth=0.3445 favg=0.0000 nr=107 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=6.5563 mle=1.4292 pcon=4.7866 forget=0.0000 orth=0.3405 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=6.7788 mle=1.6564 pcon=4.7858 forget=0.0000 orth=0.3365 favg=0.0000 nr=74 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 11 it 49 total=6.6278 mle=1.5101 pcon=4.7849 forget=0.0000 orth=0.3327 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=6.6018 mle=1.4889 pcon=4.7838 forget=0.0000 orth=0.3291 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=6.7054 mle=1.5971 pcon=4.7827 forget=0.0000 orth=0.3255 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=6.6039 mle=1.5001 pcon=4.7816 forget=0.0000 orth=0.3221 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=6.6894 mle=1.5901 pcon=4.7805 forget=0.0000 orth=0.3188 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=6.6708 mle=1.5755 pcon=4.7797 forget=0.0000 orth=0.3157 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=6.6134 mle=1.5223 pcon=4.7786 forget=0.0000 orth=0.3126 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 12 it 8 total=6.7571 mle=1.6701 pcon=4.7774 forget=0.0000 orth=0.3096 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=6.7122 mle=1.6292 pcon=4.7763 forget=0.0000 orth=0.3066 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=6.6494 mle=1.5703 pcon=4.7752 forget=0.0000 orth=0.3038 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=6.5971 mle=1.5217 pcon=4.7743 forget=0.0000 orth=0.3011 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=6.5685 mle=1.4970 pcon=4.7732 forget=0.0000 orth=0.2984 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=6.7016 mle=1.6337 pcon=4.7721 forget=0.0000 orth=0.2958 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=6.6282 mle=1.5637 pcon=4.7714 forget=0.0000 orth=0.2932 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=6.5724 mle=1.5110 pcon=4.7707 forget=0.0000 orth=0.2907 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
 28%|██▊       | 14/50 [03:25<08:39, 14.44s/it] 30%|███       | 15/50 [03:39<08:20, 14.29s/it] 32%|███▏      | 16/50 [04:00<09:09, 16.15s/it] 34%|███▍      | 17/50 [04:13<08:25, 15.32s/it] 36%|███▌      | 18/50 [04:27<08:00, 15.01s/it] 38%|███▊      | 19/50 [04:42<07:39, 14.82s/it][loss] ep 13 it 17 total=6.6697 mle=1.6116 pcon=4.7698 forget=0.0000 orth=0.2883 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=6.5721 mle=1.5172 pcon=4.7690 forget=0.0000 orth=0.2859 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=6.5763 mle=1.5245 pcon=4.7682 forget=0.0000 orth=0.2836 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=6.5816 mle=1.5328 pcon=4.7674 forget=0.0000 orth=0.2814 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=6.5699 mle=1.5242 pcon=4.7666 forget=0.0000 orth=0.2792 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=6.5083 mle=1.4656 pcon=4.7657 forget=0.0000 orth=0.2770 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=6.4639 mle=1.4242 pcon=4.7648 forget=0.0000 orth=0.2749 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=6.5298 mle=1.4928 pcon=4.7642 forget=0.0000 orth=0.2728 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 14 it 26 total=6.6437 mle=1.6093 pcon=4.7636 forget=0.0000 orth=0.2708 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=6.5618 mle=1.5298 pcon=4.7631 forget=0.0000 orth=0.2689 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=6.6059 mle=1.5767 pcon=4.7623 forget=0.0000 orth=0.2669 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=6.5991 mle=1.5723 pcon=4.7617 forget=0.0000 orth=0.2651 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=6.5240 mle=1.4997 pcon=4.7611 forget=0.0000 orth=0.2632 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=6.5905 mle=1.5687 pcon=4.7604 forget=0.0000 orth=0.2614 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=6.5833 mle=1.5640 pcon=4.7596 forget=0.0000 orth=0.2596 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=6.5222 mle=1.5051 pcon=4.7592 forget=0.0000 orth=0.2579 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 15 it 35 total=6.4825 mle=1.4679 pcon=4.7584 forget=0.0000 orth=0.2562 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=6.4762 mle=1.4640 pcon=4.7577 forget=0.0000 orth=0.2545 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=6.6228 mle=1.6128 pcon=4.7571 forget=0.0000 orth=0.2529 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=6.5388 mle=1.5309 pcon=4.7566 forget=0.0000 orth=0.2513 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=6.5334 mle=1.5278 pcon=4.7559 forget=0.0000 orth=0.2497 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=6.5108 mle=1.5072 pcon=4.7554 forget=0.0000 orth=0.2482 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=6.6227 mle=1.6213 pcon=4.7547 forget=0.0000 orth=0.2467 favg=0.0000 nr=107 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=6.5529 mle=1.5537 pcon=4.7541 forget=0.0000 orth=0.2452 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 16 it 44 total=6.6051 mle=1.6081 pcon=4.7532 forget=0.0000 orth=0.2437 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=6.5468 mle=1.5518 pcon=4.7527 forget=0.0000 orth=0.2423 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=6.5048 mle=1.5117 pcon=4.7521 forget=0.0000 orth=0.2409 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=6.5687 mle=1.5777 pcon=4.7514 forget=0.0000 orth=0.2396 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=6.5037 mle=1.5148 pcon=4.7507 forget=0.0000 orth=0.2382 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=6.5200 mle=1.5330 pcon=4.7502 forget=0.0000 orth=0.2369 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=6.5460 mle=1.5609 pcon=4.7496 forget=0.0000 orth=0.2355 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 17 it 3 total=6.4256 mle=1.4421 pcon=4.7492 forget=0.0000 orth=0.2343 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=6.5066 mle=1.5250 pcon=4.7486 forget=0.0000 orth=0.2330 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=6.5519 mle=1.5721 pcon=4.7480 forget=0.0000 orth=0.2318 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=6.5767 mle=1.5987 pcon=4.7474 forget=0.0000 orth=0.2306 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=6.5509 mle=1.5747 pcon=4.7468 forget=0.0000 orth=0.2294 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=6.5487 mle=1.5743 pcon=4.7462 forget=0.0000 orth=0.2282 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=6.4854 mle=1.5127 pcon=4.7456 forget=0.0000 orth=0.2271 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=6.4753 mle=1.5043 pcon=4.7450 forget=0.0000 orth=0.2259 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 18 it 12 total=6.5286 mle=1.5593 pcon=4.7445 forget=0.0000 orth=0.2248 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=6.5179 mle=1.5503 pcon=4.7439 forget=0.0000 orth=0.2237 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=6.3752 mle=1.4090 pcon=4.7436 forget=0.0000 orth=0.2227 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=6.4098 mle=1.4453 pcon=4.7429 forget=0.0000 orth=0.2216 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=6.4993 mle=1.5364 pcon=4.7423 forget=0.0000 orth=0.2205 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=6.4109 mle=1.4495 pcon=4.7418 forget=0.0000 orth=0.2195 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=6.5378 mle=1.5779 pcon=4.7414 forget=0.0000 orth=0.2185 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=6.5225 mle=1.5641 pcon=4.7408 forget=0.0000 orth=0.2175 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 19 it 21 total=6.4920 mle=1.5350 pcon=4.7404 forget=0.0000 orth=0.2165 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=6.5187 mle=1.5632 pcon=4.7399 forget=0.0000 orth=0.2156 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=6.4346 mle=1.4808 pcon=4.7391 forget=0.0000 orth=0.2146 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=6.4750 mle=1.5226 pcon=4.7387 forget=0.0000 orth=0.2137 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
 40%|████      | 20/50 [04:55<07:08, 14.29s/it] 42%|████▏     | 21/50 [05:09<06:53, 14.26s/it] 44%|████▍     | 22/50 [05:23<06:36, 14.16s/it] 46%|████▌     | 23/50 [05:36<06:14, 13.86s/it] 48%|████▊     | 24/50 [05:50<06:00, 13.88s/it] 50%|█████     | 25/50 [06:05<05:54, 14.18s/it][loss] ep 19 it 221 total=6.6136 mle=1.6626 pcon=4.7382 forget=0.0000 orth=0.2128 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=6.6109 mle=1.6613 pcon=4.7377 forget=0.0000 orth=0.2119 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=6.4960 mle=1.5477 pcon=4.7373 forget=0.0000 orth=0.2110 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=6.4775 mle=1.5307 pcon=4.7366 forget=0.0000 orth=0.2102 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 20 it 30 total=6.4718 mle=1.5261 pcon=4.7363 forget=0.0000 orth=0.2093 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=6.5105 mle=1.5664 pcon=4.7356 forget=0.0000 orth=0.2085 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=6.5055 mle=1.5625 pcon=4.7353 forget=0.0000 orth=0.2076 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=6.6448 mle=1.7030 pcon=4.7349 forget=0.0000 orth=0.2068 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=6.4922 mle=1.5516 pcon=4.7346 forget=0.0000 orth=0.2060 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=6.4576 mle=1.5182 pcon=4.7342 forget=0.0000 orth=0.2052 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=6.5646 mle=1.6262 pcon=4.7339 forget=0.0000 orth=0.2045 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=6.5622 mle=1.6249 pcon=4.7336 forget=0.0000 orth=0.2037 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 21 it 39 total=6.4458 mle=1.5096 pcon=4.7333 forget=0.0000 orth=0.2030 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=6.4256 mle=1.4906 pcon=4.7328 forget=0.0000 orth=0.2022 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=6.4624 mle=1.5283 pcon=4.7325 forget=0.0000 orth=0.2015 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=6.5656 mle=1.6326 pcon=4.7322 forget=0.0000 orth=0.2008 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=6.4753 mle=1.5431 pcon=4.7321 forget=0.0000 orth=0.2001 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=6.4743 mle=1.5431 pcon=4.7317 forget=0.0000 orth=0.1994 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=6.4001 mle=1.4699 pcon=4.7315 forget=0.0000 orth=0.1987 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=6.5404 mle=1.6113 pcon=4.7311 forget=0.0000 orth=0.1980 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 22 it 48 total=6.4299 mle=1.5019 pcon=4.7307 forget=0.0000 orth=0.1974 favg=0.0000 nr=109 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=6.4786 mle=1.5514 pcon=4.7306 forget=0.0000 orth=0.1967 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=6.4565 mle=1.5302 pcon=4.7302 forget=0.0000 orth=0.1960 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=6.4394 mle=1.5141 pcon=4.7299 forget=0.0000 orth=0.1954 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=6.4934 mle=1.5689 pcon=4.7298 forget=0.0000 orth=0.1948 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=6.4874 mle=1.5637 pcon=4.7296 forget=0.0000 orth=0.1941 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=6.5049 mle=1.5821 pcon=4.7293 forget=0.0000 orth=0.1935 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 23 it 7 total=6.5009 mle=1.5790 pcon=4.7290 forget=0.0000 orth=0.1929 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=6.5134 mle=1.5924 pcon=4.7287 forget=0.0000 orth=0.1923 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=6.4474 mle=1.5273 pcon=4.7283 forget=0.0000 orth=0.1917 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=6.4895 mle=1.5700 pcon=4.7283 forget=0.0000 orth=0.1911 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=6.5292 mle=1.6107 pcon=4.7280 forget=0.0000 orth=0.1906 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=6.4644 mle=1.5469 pcon=4.7275 forget=0.0000 orth=0.1900 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=6.6414 mle=1.7248 pcon=4.7271 forget=0.0000 orth=0.1894 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=6.4140 mle=1.4983 pcon=4.7268 forget=0.0000 orth=0.1889 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 24 it 16 total=6.4261 mle=1.5112 pcon=4.7266 forget=0.0000 orth=0.1883 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=6.4139 mle=1.4997 pcon=4.7264 forget=0.0000 orth=0.1878 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=6.5627 mle=1.6493 pcon=4.7262 forget=0.0000 orth=0.1873 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=6.5488 mle=1.6361 pcon=4.7260 forget=0.0000 orth=0.1867 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=6.3268 mle=1.4146 pcon=4.7259 forget=0.0000 orth=0.1862 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=6.4549 mle=1.5436 pcon=4.7257 forget=0.0000 orth=0.1857 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=6.4013 mle=1.4906 pcon=4.7255 forget=0.0000 orth=0.1852 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=6.5778 mle=1.6677 pcon=4.7254 forget=0.0000 orth=0.1847 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 25 it 25 total=6.4673 mle=1.5580 pcon=4.7251 forget=0.0000 orth=0.1842 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=6.4206 mle=1.5121 pcon=4.7248 forget=0.0000 orth=0.1837 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=6.5499 mle=1.6420 pcon=4.7246 forget=0.0000 orth=0.1832 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=6.4851 mle=1.5779 pcon=4.7244 forget=0.0000 orth=0.1828 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=6.5500 mle=1.6434 pcon=4.7244 forget=0.0000 orth=0.1823 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=6.5002 mle=1.5941 pcon=4.7242 forget=0.0000 orth=0.1818 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=6.6101 mle=1.7046 pcon=4.7240 forget=0.0000 orth=0.1814 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=6.5477 mle=1.6426 pcon=4.7241 forget=0.0000 orth=0.1809 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
 52%|█████▏    | 26/50 [06:18<05:29, 13.74s/it] 54%|█████▍    | 27/50 [06:31<05:11, 13.54s/it] 56%|█████▌    | 28/50 [06:45<05:01, 13.70s/it] 58%|█████▊    | 29/50 [06:59<04:50, 13.82s/it] 60%|██████    | 30/50 [07:13<04:37, 13.85s/it] 62%|██████▏   | 31/50 [07:27<04:27, 14.09s/it] 64%|██████▍   | 32/50 [07:42<04:13, 14.09s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 26 it 34 total=6.4226 mle=1.5181 pcon=4.7240 forget=0.0000 orth=0.1805 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=6.4140 mle=1.5103 pcon=4.7237 forget=0.0000 orth=0.1801 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=6.4611 mle=1.5578 pcon=4.7237 forget=0.0000 orth=0.1796 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=6.5679 mle=1.6652 pcon=4.7234 forget=0.0000 orth=0.1792 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=6.4129 mle=1.5109 pcon=4.7232 forget=0.0000 orth=0.1788 favg=0.0000 nr=124 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=6.4401 mle=1.5387 pcon=4.7231 forget=0.0000 orth=0.1784 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=6.5088 mle=1.6078 pcon=4.7231 forget=0.0000 orth=0.1779 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=6.5016 mle=1.6013 pcon=4.7227 forget=0.0000 orth=0.1775 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 27 it 43 total=6.5065 mle=1.6068 pcon=4.7225 forget=0.0000 orth=0.1771 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=6.4308 mle=1.5316 pcon=4.7224 forget=0.0000 orth=0.1767 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=6.4183 mle=1.5198 pcon=4.7222 forget=0.0000 orth=0.1763 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=6.4356 mle=1.5378 pcon=4.7219 forget=0.0000 orth=0.1760 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=6.3918 mle=1.4945 pcon=4.7217 forget=0.0000 orth=0.1756 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=6.5320 mle=1.6352 pcon=4.7215 forget=0.0000 orth=0.1752 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=6.3871 mle=1.4909 pcon=4.7214 forget=0.0000 orth=0.1748 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 28 it 2 total=6.4949 mle=1.5992 pcon=4.7213 forget=0.0000 orth=0.1745 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=6.5101 mle=1.6147 pcon=4.7214 forget=0.0000 orth=0.1741 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=6.4713 mle=1.5763 pcon=4.7212 forget=0.0000 orth=0.1737 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=6.5045 mle=1.6101 pcon=4.7210 forget=0.0000 orth=0.1734 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=6.4968 mle=1.6029 pcon=4.7208 forget=0.0000 orth=0.1730 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=6.6360 mle=1.7426 pcon=4.7207 forget=0.0000 orth=0.1727 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=6.4198 mle=1.5268 pcon=4.7207 forget=0.0000 orth=0.1724 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=6.4931 mle=1.6005 pcon=4.7205 forget=0.0000 orth=0.1720 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 29 it 11 total=6.4184 mle=1.5265 pcon=4.7202 forget=0.0000 orth=0.1717 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=6.4342 mle=1.5429 pcon=4.7199 forget=0.0000 orth=0.1714 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=6.6500 mle=1.7590 pcon=4.7200 forget=0.0000 orth=0.1710 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=6.4297 mle=1.5392 pcon=4.7198 forget=0.0000 orth=0.1707 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=6.5087 mle=1.6187 pcon=4.7195 forget=0.0000 orth=0.1704 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=6.4068 mle=1.5174 pcon=4.7193 forget=0.0000 orth=0.1701 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=6.4075 mle=1.5185 pcon=4.7192 forget=0.0000 orth=0.1698 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=6.4393 mle=1.5507 pcon=4.7191 forget=0.0000 orth=0.1695 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 30 it 20 total=6.4486 mle=1.5604 pcon=4.7190 forget=0.0000 orth=0.1692 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=6.5579 mle=1.6700 pcon=4.7189 forget=0.0000 orth=0.1689 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=6.4049 mle=1.5173 pcon=4.7189 forget=0.0000 orth=0.1686 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=6.4652 mle=1.5782 pcon=4.7186 forget=0.0000 orth=0.1683 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=6.4646 mle=1.5780 pcon=4.7186 forget=0.0000 orth=0.1681 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=6.4280 mle=1.5416 pcon=4.7186 forget=0.0000 orth=0.1678 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=6.4954 mle=1.6095 pcon=4.7185 forget=0.0000 orth=0.1675 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=6.4336 mle=1.5481 pcon=4.7182 forget=0.0000 orth=0.1672 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 29 total=6.4585 mle=1.5733 pcon=4.7182 forget=0.0000 orth=0.1670 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=6.5496 mle=1.6648 pcon=4.7181 forget=0.0000 orth=0.1667 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=6.4179 mle=1.5335 pcon=4.7180 forget=0.0000 orth=0.1664 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=6.4753 mle=1.5910 pcon=4.7182 forget=0.0000 orth=0.1662 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=6.5023 mle=1.6183 pcon=4.7180 forget=0.0000 orth=0.1659 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=6.3820 mle=1.4984 pcon=4.7180 forget=0.0000 orth=0.1657 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=6.5171 mle=1.6336 pcon=4.7180 forget=0.0000 orth=0.1654 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=6.4356 mle=1.5526 pcon=4.7179 forget=0.0000 orth=0.1652 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 32 it 38 total=6.4097 mle=1.5267 pcon=4.7180 forget=0.0000 orth=0.1650 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=6.4539 mle=1.5712 pcon=4.7179 forget=0.0000 orth=0.1647 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=6.4375 mle=1.5552 pcon=4.7177 forget=0.0000 orth=0.1645 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=6.4945 mle=1.6125 pcon=4.7177 forget=0.0000 orth=0.1643 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
 66%|██████▌   | 33/50 [07:57<04:04, 14.40s/it] 68%|██████▊   | 34/50 [08:10<03:46, 14.14s/it] 70%|███████   | 35/50 [08:29<03:53, 15.54s/it] 72%|███████▏  | 36/50 [08:44<03:34, 15.29s/it] 74%|███████▍  | 37/50 [08:58<03:13, 14.92s/it] 76%|███████▌  | 38/50 [09:11<02:54, 14.54s/it] 78%|███████▊  | 39/50 [09:26<02:39, 14.53s/it][loss] ep 32 it 238 total=6.4295 mle=1.5479 pcon=4.7176 forget=0.0000 orth=0.1640 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=6.3583 mle=1.4768 pcon=4.7177 forget=0.0000 orth=0.1638 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=6.5176 mle=1.6364 pcon=4.7176 forget=0.0000 orth=0.1636 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=6.4878 mle=1.6068 pcon=4.7176 forget=0.0000 orth=0.1634 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 33 it 47 total=6.5362 mle=1.6555 pcon=4.7175 forget=0.0000 orth=0.1632 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=6.4849 mle=1.6044 pcon=4.7175 forget=0.0000 orth=0.1630 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=6.5306 mle=1.6506 pcon=4.7172 forget=0.0000 orth=0.1628 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=6.3770 mle=1.4973 pcon=4.7171 forget=0.0000 orth=0.1626 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=6.4369 mle=1.5574 pcon=4.7171 forget=0.0000 orth=0.1624 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=6.4540 mle=1.5747 pcon=4.7171 forget=0.0000 orth=0.1622 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=6.4704 mle=1.5915 pcon=4.7169 forget=0.0000 orth=0.1620 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 6 total=6.4434 mle=1.5650 pcon=4.7166 forget=0.0000 orth=0.1618 favg=0.0000 nr=109 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=6.4116 mle=1.5337 pcon=4.7163 forget=0.0000 orth=0.1616 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=6.4429 mle=1.5653 pcon=4.7163 forget=0.0000 orth=0.1614 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=6.4597 mle=1.5825 pcon=4.7160 forget=0.0000 orth=0.1612 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=6.3248 mle=1.4480 pcon=4.7158 forget=0.0000 orth=0.1611 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=6.4031 mle=1.5264 pcon=4.7159 forget=0.0000 orth=0.1609 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=6.4098 mle=1.5331 pcon=4.7160 forget=0.0000 orth=0.1607 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=6.4456 mle=1.5692 pcon=4.7158 forget=0.0000 orth=0.1605 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 35 it 15 total=6.3965 mle=1.5205 pcon=4.7157 forget=0.0000 orth=0.1604 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=6.5066 mle=1.6307 pcon=4.7157 forget=0.0000 orth=0.1602 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=6.4201 mle=1.5443 pcon=4.7157 forget=0.0000 orth=0.1600 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=6.4679 mle=1.5926 pcon=4.7154 forget=0.0000 orth=0.1599 favg=0.0000 nr=106 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=6.4140 mle=1.5391 pcon=4.7151 forget=0.0000 orth=0.1597 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=6.4529 mle=1.5781 pcon=4.7152 forget=0.0000 orth=0.1596 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=6.4479 mle=1.5734 pcon=4.7151 forget=0.0000 orth=0.1594 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=6.4315 mle=1.5572 pcon=4.7151 forget=0.0000 orth=0.1593 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 36 it 24 total=6.4575 mle=1.5835 pcon=4.7148 forget=0.0000 orth=0.1591 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=6.4872 mle=1.6136 pcon=4.7146 forget=0.0000 orth=0.1590 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=6.3914 mle=1.5180 pcon=4.7146 forget=0.0000 orth=0.1588 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=6.4585 mle=1.5852 pcon=4.7146 forget=0.0000 orth=0.1587 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=6.5328 mle=1.6600 pcon=4.7143 forget=0.0000 orth=0.1586 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=6.3983 mle=1.5252 pcon=4.7146 forget=0.0000 orth=0.1584 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=6.4147 mle=1.5420 pcon=4.7144 forget=0.0000 orth=0.1583 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=6.4722 mle=1.5999 pcon=4.7141 forget=0.0000 orth=0.1582 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=6.4173 mle=1.5451 pcon=4.7141 forget=0.0000 orth=0.1581 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=6.4236 mle=1.5515 pcon=4.7142 forget=0.0000 orth=0.1579 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=6.3318 mle=1.4597 pcon=4.7142 forget=0.0000 orth=0.1578 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=6.4750 mle=1.6030 pcon=4.7143 forget=0.0000 orth=0.1577 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=6.3848 mle=1.5129 pcon=4.7143 forget=0.0000 orth=0.1576 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=6.5076 mle=1.6357 pcon=4.7144 forget=0.0000 orth=0.1575 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=6.4171 mle=1.5455 pcon=4.7143 forget=0.0000 orth=0.1574 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=6.4900 mle=1.6183 pcon=4.7144 forget=0.0000 orth=0.1572 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 38 it 42 total=6.4333 mle=1.5615 pcon=4.7147 forget=0.0000 orth=0.1571 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=6.5005 mle=1.6289 pcon=4.7145 forget=0.0000 orth=0.1570 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=6.4422 mle=1.5709 pcon=4.7145 forget=0.0000 orth=0.1569 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=6.3422 mle=1.4709 pcon=4.7145 forget=0.0000 orth=0.1568 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=6.4131 mle=1.5417 pcon=4.7147 forget=0.0000 orth=0.1567 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=6.4678 mle=1.5965 pcon=4.7146 forget=0.0000 orth=0.1566 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=6.4937 mle=1.6225 pcon=4.7146 forget=0.0000 orth=0.1565 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 39 it 1 total=6.5580 mle=1.6870 pcon=4.7146 forget=0.0000 orth=0.1565 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=6.4554 mle=1.5846 pcon=4.7144 forget=0.0000 orth=0.1564 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=6.6140 mle=1.7434 pcon=4.7144 forget=0.0000 orth=0.1563 favg=0.0000 nr=107 nf=0 protos=None fproto_sim=NA
 80%|████████  | 40/50 [09:38<02:18, 13.82s/it] 82%|████████▏ | 41/50 [09:52<02:04, 13.86s/it] 84%|████████▍ | 42/50 [10:05<01:49, 13.69s/it] 86%|████████▌ | 43/50 [10:19<01:35, 13.63s/it] 88%|████████▊ | 44/50 [10:33<01:21, 13.66s/it] 90%|█████████ | 45/50 [10:46<01:07, 13.55s/it] 92%|█████████▏| 46/50 [10:57<00:51, 12.89s/it][loss] ep 39 it 151 total=6.3547 mle=1.4840 pcon=4.7144 forget=0.0000 orth=0.1562 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=6.5134 mle=1.6429 pcon=4.7144 forget=0.0000 orth=0.1561 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 251 total=6.4635 mle=1.5929 pcon=4.7146 forget=0.0000 orth=0.1560 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=6.4943 mle=1.6238 pcon=4.7145 forget=0.0000 orth=0.1560 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=6.5136 mle=1.6431 pcon=4.7147 forget=0.0000 orth=0.1559 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 10 total=6.4959 mle=1.6256 pcon=4.7145 forget=0.0000 orth=0.1558 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=6.4763 mle=1.6062 pcon=4.7143 forget=0.0000 orth=0.1557 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=6.3931 mle=1.5232 pcon=4.7142 forget=0.0000 orth=0.1557 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=6.5388 mle=1.6691 pcon=4.7141 forget=0.0000 orth=0.1556 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=6.4718 mle=1.6023 pcon=4.7141 forget=0.0000 orth=0.1555 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=6.4371 mle=1.5675 pcon=4.7141 forget=0.0000 orth=0.1555 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=6.5421 mle=1.6726 pcon=4.7141 forget=0.0000 orth=0.1554 favg=0.0000 nr=108 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=6.5377 mle=1.6684 pcon=4.7140 forget=0.0000 orth=0.1553 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 41 it 19 total=6.4829 mle=1.6138 pcon=4.7138 forget=0.0000 orth=0.1553 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=6.4235 mle=1.5544 pcon=4.7139 forget=0.0000 orth=0.1552 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=6.5379 mle=1.6691 pcon=4.7136 forget=0.0000 orth=0.1551 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=6.4633 mle=1.5945 pcon=4.7137 forget=0.0000 orth=0.1551 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=6.3871 mle=1.5186 pcon=4.7135 forget=0.0000 orth=0.1550 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=6.4094 mle=1.5409 pcon=4.7135 forget=0.0000 orth=0.1550 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=6.5328 mle=1.6642 pcon=4.7136 forget=0.0000 orth=0.1549 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=6.4852 mle=1.6169 pcon=4.7134 forget=0.0000 orth=0.1549 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 28 total=6.4250 mle=1.5569 pcon=4.7133 forget=0.0000 orth=0.1548 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=6.5709 mle=1.7030 pcon=4.7132 forget=0.0000 orth=0.1548 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=6.4103 mle=1.5425 pcon=4.7130 forget=0.0000 orth=0.1547 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=6.4207 mle=1.5532 pcon=4.7128 forget=0.0000 orth=0.1547 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=6.3572 mle=1.4897 pcon=4.7128 forget=0.0000 orth=0.1547 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=6.4691 mle=1.6018 pcon=4.7127 forget=0.0000 orth=0.1546 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=6.4487 mle=1.5815 pcon=4.7126 forget=0.0000 orth=0.1546 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=6.5540 mle=1.6870 pcon=4.7124 forget=0.0000 orth=0.1545 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 37 total=6.4183 mle=1.5514 pcon=4.7124 forget=0.0000 orth=0.1545 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=6.4410 mle=1.5743 pcon=4.7123 forget=0.0000 orth=0.1545 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=6.4779 mle=1.6112 pcon=4.7123 forget=0.0000 orth=0.1544 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=6.4689 mle=1.6022 pcon=4.7123 forget=0.0000 orth=0.1544 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=6.4066 mle=1.5399 pcon=4.7123 forget=0.0000 orth=0.1544 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=6.4679 mle=1.6013 pcon=4.7122 forget=0.0000 orth=0.1543 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=6.4669 mle=1.6002 pcon=4.7124 forget=0.0000 orth=0.1543 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=6.4599 mle=1.5934 pcon=4.7122 forget=0.0000 orth=0.1543 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 46 total=6.3696 mle=1.5032 pcon=4.7121 forget=0.0000 orth=0.1542 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=6.3711 mle=1.5046 pcon=4.7123 forget=0.0000 orth=0.1542 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=6.5624 mle=1.6961 pcon=4.7122 forget=0.0000 orth=0.1542 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=6.4490 mle=1.5829 pcon=4.7120 forget=0.0000 orth=0.1542 favg=0.0000 nr=99 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=6.3770 mle=1.5109 pcon=4.7120 forget=0.0000 orth=0.1541 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=6.4668 mle=1.6008 pcon=4.7119 forget=0.0000 orth=0.1541 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=6.4514 mle=1.5852 pcon=4.7121 forget=0.0000 orth=0.1541 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[loss] ep 45 it 5 total=6.5058 mle=1.6396 pcon=4.7121 forget=0.0000 orth=0.1541 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 55 total=6.4050 mle=1.5388 pcon=4.7121 forget=0.0000 orth=0.1541 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 105 total=6.4176 mle=1.5512 pcon=4.7123 forget=0.0000 orth=0.1540 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 155 total=6.3998 mle=1.5333 pcon=4.7124 forget=0.0000 orth=0.1540 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 205 total=6.5623 mle=1.6961 pcon=4.7122 forget=0.0000 orth=0.1540 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 255 total=6.4415 mle=1.5753 pcon=4.7122 forget=0.0000 orth=0.1540 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 305 total=6.3974 mle=1.5313 pcon=4.7121 forget=0.0000 orth=0.1540 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 355 total=6.3624 mle=1.4963 pcon=4.7121 forget=0.0000 orth=0.1540 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 14 total=6.5404 mle=1.6744 pcon=4.7121 forget=0.0000 orth=0.1540 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 64 total=6.4144 mle=1.5484 pcon=4.7121 forget=0.0000 orth=0.1539 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 114 total=6.5480 mle=1.6820 pcon=4.7121 forget=0.0000 orth=0.1539 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 164 total=6.4132 mle=1.5473 pcon=4.7119 forget=0.0000 orth=0.1539 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 214 total=6.5026 mle=1.6367 pcon=4.7119 forget=0.0000 orth=0.1539 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 264 total=6.3908 mle=1.5250 pcon=4.7119 forget=0.0000 orth=0.1539 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
 94%|█████████▍| 47/50 [11:10<00:38, 12.77s/it] 96%|█████████▌| 48/50 [11:23<00:25, 12.95s/it] 98%|█████████▊| 49/50 [11:37<00:13, 13.24s/it]100%|██████████| 50/50 [11:51<00:00, 13.39s/it]100%|██████████| 50/50 [11:51<00:00, 14.22s/it]
[loss] ep 46 it 314 total=6.4556 mle=1.5899 pcon=4.7119 forget=0.0000 orth=0.1539 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 364 total=6.4468 mle=1.5810 pcon=4.7119 forget=0.0000 orth=0.1539 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 23 total=6.5259 mle=1.6601 pcon=4.7120 forget=0.0000 orth=0.1539 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 73 total=6.5958 mle=1.7300 pcon=4.7119 forget=0.0000 orth=0.1539 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 123 total=6.4123 mle=1.5463 pcon=4.7121 forget=0.0000 orth=0.1539 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 173 total=6.4344 mle=1.5685 pcon=4.7120 forget=0.0000 orth=0.1539 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 223 total=6.3717 mle=1.5059 pcon=4.7120 forget=0.0000 orth=0.1539 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 273 total=6.4986 mle=1.6326 pcon=4.7121 forget=0.0000 orth=0.1539 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 323 total=6.4463 mle=1.5802 pcon=4.7122 forget=0.0000 orth=0.1538 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 373 total=6.4089 mle=1.5430 pcon=4.7121 forget=0.0000 orth=0.1538 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 32 total=6.4396 mle=1.5738 pcon=4.7120 forget=0.0000 orth=0.1538 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 82 total=6.5809 mle=1.7150 pcon=4.7120 forget=0.0000 orth=0.1538 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 132 total=6.4147 mle=1.5488 pcon=4.7121 forget=0.0000 orth=0.1538 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 182 total=6.4458 mle=1.5798 pcon=4.7122 forget=0.0000 orth=0.1538 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 232 total=6.4955 mle=1.6295 pcon=4.7122 forget=0.0000 orth=0.1538 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 282 total=6.4709 mle=1.6049 pcon=4.7121 forget=0.0000 orth=0.1538 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 332 total=6.4409 mle=1.5749 pcon=4.7121 forget=0.0000 orth=0.1538 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 382 total=6.3705 mle=1.5045 pcon=4.7122 forget=0.0000 orth=0.1538 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 41 total=6.5562 mle=1.6904 pcon=4.7120 forget=0.0000 orth=0.1538 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 91 total=6.5660 mle=1.7002 pcon=4.7120 forget=0.0000 orth=0.1538 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 141 total=6.3961 mle=1.5304 pcon=4.7120 forget=0.0000 orth=0.1538 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 191 total=6.4819 mle=1.6161 pcon=4.7120 forget=0.0000 orth=0.1538 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 241 total=6.4375 mle=1.5719 pcon=4.7118 forget=0.0000 orth=0.1538 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 291 total=6.4937 mle=1.6281 pcon=4.7118 forget=0.0000 orth=0.1538 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 341 total=6.4339 mle=1.5681 pcon=4.7120 forget=0.0000 orth=0.1538 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc1-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:38,  2.46it/s]  3%|▎         | 10/391 [00:00<00:15, 24.94it/s]  5%|▌         | 20/391 [00:00<00:08, 43.89it/s]  8%|▊         | 30/391 [00:00<00:06, 57.99it/s] 10%|▉         | 39/391 [00:00<00:05, 65.96it/s] 12%|█▏        | 48/391 [00:00<00:04, 69.72it/s] 15%|█▍        | 57/391 [00:01<00:04, 73.76it/s] 17%|█▋        | 67/391 [00:01<00:04, 79.67it/s] 20%|█▉        | 77/391 [00:01<00:03, 84.36it/s] 22%|██▏       | 87/391 [00:01<00:03, 87.90it/s] 25%|██▍       | 97/391 [00:01<00:03, 90.32it/s] 27%|██▋       | 107/391 [00:01<00:03, 91.92it/s] 30%|██▉       | 117/391 [00:01<00:02, 93.14it/s] 32%|███▏      | 127/391 [00:01<00:02, 93.94it/s] 35%|███▌      | 137/391 [00:01<00:02, 94.53it/s] 38%|███▊      | 147/391 [00:01<00:02, 94.93it/s] 40%|████      | 157/391 [00:02<00:02, 95.40it/s] 43%|████▎     | 167/391 [00:02<00:02, 95.64it/s] 45%|████▌     | 177/391 [00:02<00:02, 95.72it/s] 48%|████▊     | 187/391 [00:02<00:02, 95.92it/s] 50%|█████     | 197/391 [00:02<00:02, 95.75it/s] 53%|█████▎    | 207/391 [00:02<00:01, 95.91it/s] 55%|█████▌    | 217/391 [00:02<00:01, 96.16it/s] 58%|█████▊    | 227/391 [00:02<00:01, 96.15it/s] 61%|██████    | 237/391 [00:02<00:01, 96.14it/s] 63%|██████▎   | 247/391 [00:03<00:01, 96.30it/s] 66%|██████▌   | 257/391 [00:03<00:01, 96.18it/s] 68%|██████▊   | 267/391 [00:03<00:01, 96.29it/s] 71%|███████   | 277/391 [00:03<00:01, 96.42it/s] 73%|███████▎  | 287/391 [00:03<00:01, 96.13it/s] 76%|███████▌  | 297/391 [00:03<00:00, 96.10it/s] 79%|███████▊  | 307/391 [00:03<00:00, 96.25it/s] 81%|████████  | 317/391 [00:03<00:00, 96.02it/s] 84%|████████▎ | 327/391 [00:03<00:00, 96.03it/s] 86%|████████▌ | 337/391 [00:03<00:00, 96.04it/s] 89%|████████▊ | 347/391 [00:04<00:00, 96.04it/s] 91%|█████████▏| 357/391 [00:04<00:00, 96.00it/s] 94%|█████████▍| 367/391 [00:04<00:00, 95.86it/s] 96%|█████████▋| 377/391 [00:04<00:00, 96.47it/s] 99%|█████████▉| 387/391 [00:04<00:00, 96.91it/s]100%|██████████| 391/391 [00:04<00:00, 86.14it/s]
50000 images processed, 4.645366430282593 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:28,  2.71it/s] 10%|█         | 8/79 [00:00<00:03, 21.28it/s] 22%|██▏       | 17/79 [00:00<00:01, 40.09it/s] 34%|███▍      | 27/79 [00:00<00:00, 55.64it/s] 47%|████▋     | 37/79 [00:00<00:00, 66.28it/s] 59%|█████▉    | 47/79 [00:00<00:00, 73.87it/s] 72%|███████▏  | 57/79 [00:01<00:00, 79.73it/s] 85%|████████▍ | 67/79 [00:01<00:00, 84.04it/s] 97%|█████████▋| 77/79 [00:01<00:00, 87.11it/s]100%|██████████| 79/79 [00:02<00:00, 39.23it/s]
10000 images processed, 2.052823305130005 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc1-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:28,  2.29it/s]  4%|▍         | 9/204 [00:00<00:09, 21.42it/s]  9%|▉         | 19/204 [00:00<00:04, 41.38it/s] 14%|█▍        | 29/204 [00:00<00:03, 56.40it/s] 19%|█▉        | 39/204 [00:00<00:02, 67.34it/s] 24%|██▍       | 49/204 [00:00<00:02, 75.52it/s] 29%|██▉       | 59/204 [00:01<00:01, 81.24it/s] 34%|███▍      | 69/204 [00:01<00:01, 85.36it/s] 39%|███▊      | 79/204 [00:01<00:01, 88.17it/s] 44%|████▎     | 89/204 [00:01<00:01, 89.92it/s] 49%|████▊     | 99/204 [00:01<00:01, 91.57it/s] 53%|█████▎    | 109/204 [00:01<00:01, 92.80it/s] 58%|█████▊    | 119/204 [00:01<00:00, 93.72it/s] 63%|██████▎   | 129/204 [00:01<00:00, 94.24it/s] 68%|██████▊   | 139/204 [00:01<00:00, 94.47it/s] 73%|███████▎  | 149/204 [00:02<00:00, 94.52it/s] 78%|███████▊  | 159/204 [00:02<00:00, 94.71it/s] 83%|████████▎ | 169/204 [00:02<00:00, 94.74it/s] 88%|████████▊ | 179/204 [00:02<00:00, 94.99it/s] 93%|█████████▎| 189/204 [00:02<00:00, 95.51it/s] 98%|█████████▊| 199/204 [00:02<00:00, 95.89it/s]100%|██████████| 204/204 [00:02<00:00, 78.93it/s]
26032 images processed, 2.6234185695648193 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.76it/s] 13%|█▎        | 10/79 [00:00<00:03, 19.28it/s] 25%|██▌       | 20/79 [00:00<00:01, 36.37it/s] 38%|███▊      | 30/79 [00:00<00:00, 50.36it/s] 51%|█████     | 40/79 [00:01<00:00, 61.30it/s] 63%|██████▎   | 50/79 [00:01<00:00, 69.74it/s] 76%|███████▌  | 60/79 [00:01<00:00, 77.04it/s] 87%|████████▋ | 69/79 [00:01<00:00, 78.85it/s]100%|██████████| 79/79 [00:01<00:00, 55.74it/s]
10000 images processed, 1.4494948387145996 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.12it/s] 13%|█▎        | 10/79 [00:00<00:03, 22.25it/s] 25%|██▌       | 20/79 [00:00<00:01, 40.61it/s] 38%|███▊      | 30/79 [00:00<00:00, 55.16it/s] 51%|█████     | 40/79 [00:00<00:00, 66.21it/s] 63%|██████▎   | 50/79 [00:01<00:00, 74.40it/s] 76%|███████▌  | 60/79 [00:01<00:00, 80.83it/s] 89%|████████▊ | 70/79 [00:01<00:00, 85.51it/s]100%|██████████| 79/79 [00:01<00:00, 61.13it/s]
10000 images processed, 1.3150873184204102 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:32,  2.14it/s] 16%|█▌        | 11/70 [00:00<00:02, 24.65it/s] 30%|███       | 21/70 [00:00<00:01, 42.57it/s] 44%|████▍     | 31/70 [00:00<00:00, 56.39it/s] 59%|█████▊    | 41/70 [00:00<00:00, 66.89it/s] 73%|███████▎  | 51/70 [00:00<00:00, 75.29it/s] 87%|████████▋ | 61/70 [00:01<00:00, 81.50it/s]100%|██████████| 70/70 [00:01<00:00, 58.51it/s]
8925 images processed, 1.2245938777923584 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:39,  1.11it/s]  4%|▍         | 2/45 [00:01<00:18,  2.32it/s] 27%|██▋       | 12/45 [00:01<00:01, 18.14it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.55it/s] 51%|█████     | 23/45 [00:01<00:01, 16.22it/s] 73%|███████▎  | 33/45 [00:01<00:00, 25.40it/s] 87%|████████▋ | 39/45 [00:02<00:00, 24.91it/s]100%|██████████| 45/45 [00:02<00:00, 19.65it/s]
5640 images processed, 2.3112940788269043 seconds used

17.356024265289307
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.66  98.93  96.84
places365     73.69  79.16  78.04
LSUN          34.90  92.98  93.23
iSUN          78.52  78.75  82.32
dtd           43.79  89.95  93.70
AVG           47.11  87.95  88.83
Retain-Acc: 0.7452
Forget-as-OOD (retain known vs forget novel):
  FPR: 46.20 AUROC: 88.64 AUIN: 99.24
7.866558074951172
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc2-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:13,  2.02it/s]  3%|▎         | 11/391 [00:00<00:16, 23.41it/s]  5%|▌         | 21/391 [00:00<00:09, 40.69it/s]  8%|▊         | 31/391 [00:00<00:06, 54.08it/s] 10%|█         | 41/391 [00:00<00:05, 64.62it/s] 13%|█▎        | 51/391 [00:01<00:04, 72.47it/s] 15%|█▌        | 60/391 [00:01<00:04, 76.90it/s] 18%|█▊        | 70/391 [00:01<00:03, 81.66it/s] 20%|██        | 80/391 [00:01<00:03, 84.42it/s] 23%|██▎       | 90/391 [00:01<00:03, 87.40it/s] 26%|██▌       | 100/391 [00:01<00:03, 90.12it/s] 28%|██▊       | 110/391 [00:01<00:03, 92.10it/s] 31%|███       | 120/391 [00:01<00:02, 93.50it/s] 33%|███▎      | 130/391 [00:01<00:02, 94.47it/s] 36%|███▌      | 140/391 [00:01<00:02, 95.12it/s] 38%|███▊      | 150/391 [00:02<00:02, 95.60it/s] 41%|████      | 160/391 [00:02<00:02, 95.43it/s] 43%|████▎     | 170/391 [00:02<00:02, 91.54it/s] 46%|████▌     | 180/391 [00:02<00:02, 92.81it/s] 49%|████▊     | 190/391 [00:02<00:02, 93.84it/s] 51%|█████     | 200/391 [00:02<00:02, 94.69it/s] 54%|█████▎    | 210/391 [00:02<00:01, 95.14it/s] 56%|█████▋    | 220/391 [00:02<00:01, 92.92it/s] 59%|█████▉    | 230/391 [00:02<00:01, 90.67it/s] 61%|██████▏   | 240/391 [00:03<00:01, 92.41it/s] 64%|██████▍   | 250/391 [00:03<00:01, 93.28it/s] 66%|██████▋   | 260/391 [00:03<00:01, 91.67it/s] 69%|██████▉   | 270/391 [00:03<00:01, 88.33it/s] 71%|███████▏  | 279/391 [00:03<00:01, 82.42it/s] 74%|███████▎  | 288/391 [00:03<00:01, 77.86it/s] 76%|███████▌  | 296/391 [00:03<00:01, 75.89it/s] 78%|███████▊  | 306/391 [00:03<00:01, 81.36it/s] 81%|████████  | 316/391 [00:03<00:00, 85.69it/s] 83%|████████▎ | 326/391 [00:04<00:00, 88.77it/s] 86%|████████▌ | 336/391 [00:04<00:00, 90.89it/s] 88%|████████▊ | 346/391 [00:04<00:00, 92.54it/s] 91%|█████████ | 356/391 [00:04<00:00, 93.42it/s] 94%|█████████▎| 366/391 [00:04<00:00, 93.77it/s] 96%|█████████▌| 376/391 [00:04<00:00, 94.98it/s] 99%|█████████▊| 386/391 [00:04<00:00, 95.83it/s]100%|██████████| 391/391 [00:04<00:00, 82.00it/s]
50000 images processed, 4.858728408813477 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:29,  2.64it/s] 13%|█▎        | 10/79 [00:00<00:02, 26.09it/s] 24%|██▍       | 19/79 [00:00<00:01, 43.21it/s] 35%|███▌      | 28/79 [00:00<00:00, 56.31it/s] 48%|████▊     | 38/79 [00:00<00:00, 66.84it/s] 59%|█████▉    | 47/79 [00:00<00:00, 73.16it/s] 72%|███████▏  | 57/79 [00:01<00:00, 79.26it/s] 85%|████████▍ | 67/79 [00:01<00:00, 83.63it/s] 97%|█████████▋| 77/79 [00:01<00:00, 86.87it/s]100%|██████████| 79/79 [00:01<00:00, 55.44it/s]
10000 images processed, 1.4516024589538574 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc2-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:51,  1.82it/s]  5%|▌         | 11/204 [00:00<00:08, 21.61it/s] 10%|█         | 21/204 [00:00<00:04, 38.60it/s] 15%|█▌        | 31/204 [00:00<00:03, 52.42it/s] 20%|██        | 41/204 [00:00<00:02, 63.69it/s] 25%|██▌       | 51/204 [00:01<00:02, 72.23it/s] 30%|██▉       | 61/204 [00:01<00:01, 78.20it/s] 35%|███▍      | 71/204 [00:01<00:01, 82.95it/s] 40%|███▉      | 81/204 [00:01<00:01, 86.50it/s] 45%|████▍     | 91/204 [00:01<00:01, 89.04it/s] 50%|████▉     | 101/204 [00:01<00:01, 90.73it/s] 54%|█████▍    | 111/204 [00:01<00:01, 91.32it/s] 59%|█████▉    | 121/204 [00:01<00:00, 92.58it/s] 64%|██████▍   | 131/204 [00:01<00:00, 93.57it/s] 69%|██████▉   | 141/204 [00:02<00:00, 94.23it/s] 74%|███████▍  | 151/204 [00:02<00:00, 94.48it/s] 79%|███████▉  | 161/204 [00:02<00:00, 94.70it/s] 84%|████████▍ | 171/204 [00:02<00:00, 94.91it/s] 89%|████████▊ | 181/204 [00:02<00:00, 95.11it/s] 94%|█████████▎| 191/204 [00:02<00:00, 95.68it/s] 99%|█████████▊| 201/204 [00:02<00:00, 95.88it/s]100%|██████████| 204/204 [00:02<00:00, 75.74it/s]
26032 images processed, 2.7403502464294434 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:47,  1.64it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.97it/s] 23%|██▎       | 18/79 [00:00<00:02, 30.49it/s] 35%|███▌      | 28/79 [00:00<00:01, 46.09it/s] 48%|████▊     | 38/79 [00:01<00:00, 58.57it/s] 61%|██████    | 48/79 [00:01<00:00, 68.26it/s] 73%|███████▎  | 58/79 [00:01<00:00, 75.45it/s] 86%|████████▌ | 68/79 [00:01<00:00, 81.45it/s] 99%|█████████▊| 78/79 [00:01<00:00, 85.84it/s]100%|██████████| 79/79 [00:01<00:00, 54.45it/s]
10000 images processed, 1.484250783920288 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:39,  1.99it/s] 11%|█▏        | 9/79 [00:00<00:03, 18.86it/s] 24%|██▍       | 19/79 [00:00<00:01, 37.43it/s] 37%|███▋      | 29/79 [00:00<00:00, 51.77it/s] 49%|████▉     | 39/79 [00:00<00:00, 63.29it/s] 62%|██████▏   | 49/79 [00:01<00:00, 71.24it/s] 75%|███████▍  | 59/79 [00:01<00:00, 78.01it/s] 87%|████████▋ | 69/79 [00:01<00:00, 83.29it/s]100%|██████████| 79/79 [00:01<00:00, 58.58it/s]
10000 images processed, 1.3697845935821533 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:32,  2.12it/s] 13%|█▎        | 9/70 [00:00<00:03, 20.20it/s] 27%|██▋       | 19/70 [00:00<00:01, 39.31it/s] 41%|████▏     | 29/70 [00:00<00:00, 54.14it/s] 56%|█████▌    | 39/70 [00:00<00:00, 65.19it/s] 70%|███████   | 49/70 [00:00<00:00, 74.01it/s] 84%|████████▍ | 59/70 [00:01<00:00, 80.55it/s] 99%|█████████▊| 69/70 [00:01<00:00, 85.33it/s]100%|██████████| 70/70 [00:01<00:00, 57.56it/s]
8925 images processed, 1.246553897857666 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.05it/s]  9%|▉         | 4/45 [00:01<00:08,  4.77it/s] 31%|███       | 14/45 [00:01<00:01, 19.37it/s] 44%|████▍     | 20/45 [00:01<00:01, 19.47it/s] 56%|█████▌    | 25/45 [00:01<00:00, 23.93it/s] 67%|██████▋   | 30/45 [00:01<00:00, 25.56it/s] 76%|███████▌  | 34/45 [00:02<00:00, 20.58it/s] 98%|█████████▊| 44/45 [00:02<00:00, 33.25it/s]100%|██████████| 45/45 [00:02<00:00, 20.75it/s]
5640 images processed, 2.191091775894165 seconds used

16.89770746231079
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.66  98.94  96.86
places365     73.53  79.68  78.57
LSUN          29.85  94.34  94.62
iSUN          78.63  79.10  82.59
dtd           43.30  90.17  93.83
AVG           45.99  88.45  89.29
Retain-Acc: 0.7433
Forget-as-OOD (retain known vs forget novel):
  FPR: 49.00 AUROC: 91.87 AUIN: 99.52
7.472808837890625
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc2-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc2-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc3-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:26,  2.66it/s]  2%|▏         | 6/391 [00:00<00:24, 15.68it/s]  4%|▍         | 16/391 [00:00<00:09, 38.36it/s]  7%|▋         | 26/391 [00:00<00:06, 54.43it/s]  9%|▉         | 36/391 [00:00<00:05, 66.15it/s] 12%|█▏        | 46/391 [00:00<00:04, 75.07it/s] 14%|█▍        | 56/391 [00:01<00:04, 81.35it/s] 17%|█▋        | 66/391 [00:01<00:03, 85.80it/s] 19%|█▉        | 76/391 [00:01<00:03, 88.72it/s] 22%|██▏       | 86/391 [00:01<00:03, 91.13it/s] 25%|██▍       | 96/391 [00:01<00:03, 92.84it/s] 27%|██▋       | 106/391 [00:01<00:03, 93.98it/s] 30%|██▉       | 116/391 [00:01<00:02, 94.92it/s] 32%|███▏      | 126/391 [00:01<00:02, 95.28it/s] 35%|███▍      | 136/391 [00:01<00:02, 95.72it/s] 37%|███▋      | 146/391 [00:01<00:02, 96.18it/s] 40%|███▉      | 156/391 [00:02<00:02, 96.30it/s] 42%|████▏     | 166/391 [00:02<00:02, 96.09it/s] 45%|████▌     | 176/391 [00:02<00:02, 96.34it/s] 48%|████▊     | 186/391 [00:02<00:02, 96.02it/s] 50%|█████     | 196/391 [00:02<00:02, 95.97it/s] 53%|█████▎    | 206/391 [00:02<00:01, 96.23it/s] 55%|█████▌    | 216/391 [00:02<00:01, 96.01it/s] 58%|█████▊    | 226/391 [00:02<00:01, 96.16it/s] 60%|██████    | 236/391 [00:02<00:01, 96.26it/s] 63%|██████▎   | 246/391 [00:02<00:01, 96.15it/s] 65%|██████▌   | 256/391 [00:03<00:01, 96.28it/s] 68%|██████▊   | 266/391 [00:03<00:01, 94.78it/s] 71%|███████   | 276/391 [00:03<00:01, 95.13it/s] 73%|███████▎  | 286/391 [00:03<00:01, 95.61it/s] 76%|███████▌  | 296/391 [00:03<00:00, 95.70it/s] 78%|███████▊  | 306/391 [00:03<00:00, 96.08it/s] 81%|████████  | 316/391 [00:03<00:00, 96.15it/s] 83%|████████▎ | 326/391 [00:03<00:00, 96.35it/s] 86%|████████▌ | 336/391 [00:03<00:00, 96.47it/s] 88%|████████▊ | 346/391 [00:04<00:00, 96.60it/s] 91%|█████████ | 356/391 [00:04<00:00, 96.81it/s] 94%|█████████▎| 366/391 [00:04<00:00, 96.52it/s] 96%|█████████▌| 376/391 [00:04<00:00, 96.96it/s] 99%|█████████▊| 386/391 [00:04<00:00, 97.20it/s]100%|██████████| 391/391 [00:04<00:00, 87.03it/s]
50000 images processed, 4.582469940185547 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:34,  2.26it/s] 11%|█▏        | 9/79 [00:00<00:03, 20.98it/s] 23%|██▎       | 18/79 [00:00<00:01, 38.35it/s] 34%|███▍      | 27/79 [00:00<00:01, 51.80it/s] 47%|████▋     | 37/79 [00:00<00:00, 63.23it/s] 59%|█████▉    | 47/79 [00:00<00:00, 71.68it/s] 72%|███████▏  | 57/79 [00:01<00:00, 78.05it/s] 85%|████████▍ | 67/79 [00:01<00:00, 82.62it/s] 97%|█████████▋| 77/79 [00:01<00:00, 85.99it/s]100%|██████████| 79/79 [00:01<00:00, 59.21it/s]
10000 images processed, 1.3586673736572266 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:32,  2.20it/s]  5%|▌         | 11/204 [00:00<00:07, 24.88it/s] 10%|█         | 21/204 [00:00<00:04, 42.86it/s] 15%|█▍        | 30/204 [00:00<00:03, 54.57it/s] 19%|█▉        | 39/204 [00:00<00:02, 64.04it/s] 24%|██▍       | 49/204 [00:00<00:02, 73.07it/s] 29%|██▉       | 59/204 [00:01<00:01, 79.63it/s] 34%|███▍      | 69/204 [00:01<00:01, 84.04it/s] 39%|███▊      | 79/204 [00:01<00:01, 87.16it/s] 44%|████▎     | 89/204 [00:01<00:01, 89.14it/s] 49%|████▊     | 99/204 [00:01<00:01, 90.62it/s] 53%|█████▎    | 109/204 [00:01<00:01, 91.64it/s] 58%|█████▊    | 119/204 [00:01<00:00, 92.59it/s] 63%|██████▎   | 129/204 [00:01<00:00, 93.32it/s] 68%|██████▊   | 139/204 [00:01<00:00, 93.62it/s] 73%|███████▎  | 149/204 [00:02<00:00, 93.95it/s] 78%|███████▊  | 159/204 [00:02<00:00, 94.30it/s] 83%|████████▎ | 169/204 [00:02<00:00, 94.65it/s] 88%|████████▊ | 179/204 [00:02<00:00, 95.00it/s] 93%|█████████▎| 189/204 [00:02<00:00, 95.63it/s] 98%|█████████▊| 199/204 [00:02<00:00, 96.09it/s]100%|██████████| 204/204 [00:02<00:00, 78.04it/s]
26032 images processed, 2.65051007270813 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:47,  1.63it/s] 13%|█▎        | 10/79 [00:00<00:03, 18.27it/s] 24%|██▍       | 19/79 [00:00<00:01, 32.93it/s] 35%|███▌      | 28/79 [00:00<00:01, 46.00it/s] 48%|████▊     | 38/79 [00:01<00:00, 57.75it/s] 61%|██████    | 48/79 [00:01<00:00, 67.08it/s] 72%|███████▏  | 57/79 [00:01<00:00, 61.41it/s] 84%|████████▎ | 66/79 [00:01<00:00, 67.19it/s] 96%|█████████▌| 76/79 [00:01<00:00, 74.75it/s]100%|██████████| 79/79 [00:01<00:00, 50.89it/s]
10000 images processed, 1.5844626426696777 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.17it/s] 10%|█         | 8/79 [00:00<00:03, 17.88it/s] 23%|██▎       | 18/79 [00:00<00:01, 37.84it/s] 35%|███▌      | 28/79 [00:00<00:00, 53.29it/s] 48%|████▊     | 38/79 [00:00<00:00, 64.97it/s] 61%|██████    | 48/79 [00:00<00:00, 73.56it/s] 73%|███████▎  | 58/79 [00:01<00:00, 79.99it/s] 86%|████████▌ | 68/79 [00:01<00:00, 84.83it/s] 99%|█████████▊| 78/79 [00:01<00:00, 88.37it/s]100%|██████████| 79/79 [00:01<00:00, 60.60it/s]
10000 images processed, 1.3228628635406494 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:34,  2.00it/s] 16%|█▌        | 11/70 [00:00<00:02, 23.19it/s] 30%|███       | 21/70 [00:00<00:01, 40.38it/s] 44%|████▍     | 31/70 [00:00<00:00, 54.19it/s] 59%|█████▊    | 41/70 [00:00<00:00, 65.03it/s] 73%|███████▎  | 51/70 [00:01<00:00, 73.12it/s] 87%|████████▋ | 61/70 [00:01<00:00, 79.81it/s]100%|██████████| 70/70 [00:01<00:00, 56.43it/s]
8925 images processed, 1.2690255641937256 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:37,  1.17it/s]  4%|▍         | 2/45 [00:01<00:19,  2.24it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.62it/s] 38%|███▊      | 17/45 [00:01<00:01, 20.10it/s] 47%|████▋     | 21/45 [00:01<00:01, 18.74it/s] 69%|██████▉   | 31/45 [00:01<00:00, 32.32it/s] 82%|████████▏ | 37/45 [00:02<00:00, 23.79it/s]100%|██████████| 45/45 [00:02<00:00, 20.91it/s]
5640 images processed, 2.1730597019195557 seconds used

16.537436485290527
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.57  98.95  97.03
places365     73.25  79.28  78.94
LSUN          33.97  93.16  93.67
iSUN          77.92  78.93  83.09
dtd           43.32  90.04  94.02
AVG           46.60  88.07  89.35
Retain-Acc: 0.7418
7.881643056869507
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-inc3-forget_domain.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-seen-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:01<08:31,  1.31s/it]  3%|▎         | 11/391 [00:01<00:36, 10.46it/s]  5%|▌         | 21/391 [00:01<00:17, 21.34it/s]  8%|▊         | 31/391 [00:01<00:10, 32.80it/s] 10%|█         | 41/391 [00:01<00:07, 44.23it/s] 13%|█▎        | 51/391 [00:01<00:06, 54.87it/s] 16%|█▌        | 61/391 [00:01<00:05, 64.25it/s] 18%|█▊        | 71/391 [00:02<00:04, 72.06it/s] 21%|██        | 81/391 [00:02<00:03, 78.31it/s] 23%|██▎       | 91/391 [00:02<00:03, 83.29it/s] 26%|██▌       | 101/391 [00:02<00:03, 87.04it/s] 28%|██▊       | 111/391 [00:02<00:03, 89.57it/s] 31%|███       | 121/391 [00:02<00:02, 91.56it/s] 34%|███▎      | 131/391 [00:02<00:02, 92.93it/s] 36%|███▌      | 141/391 [00:02<00:02, 93.84it/s] 39%|███▊      | 151/391 [00:02<00:02, 94.80it/s] 41%|████      | 161/391 [00:02<00:02, 95.08it/s] 44%|████▎     | 171/391 [00:03<00:02, 95.56it/s] 46%|████▋     | 181/391 [00:03<00:02, 95.71it/s] 49%|████▉     | 191/391 [00:03<00:02, 95.92it/s] 51%|█████▏    | 201/391 [00:03<00:01, 96.15it/s] 54%|█████▍    | 211/391 [00:03<00:01, 96.43it/s] 57%|█████▋    | 221/391 [00:03<00:01, 96.28it/s] 59%|█████▉    | 231/391 [00:03<00:01, 96.43it/s] 62%|██████▏   | 241/391 [00:03<00:01, 96.51it/s] 64%|██████▍   | 251/391 [00:03<00:01, 96.14it/s] 67%|██████▋   | 261/391 [00:04<00:01, 96.27it/s] 69%|██████▉   | 271/391 [00:04<00:01, 94.37it/s] 72%|███████▏  | 281/391 [00:04<00:01, 94.27it/s] 74%|███████▍  | 291/391 [00:04<00:01, 95.25it/s] 77%|███████▋  | 301/391 [00:04<00:00, 95.58it/s] 80%|███████▉  | 311/391 [00:04<00:00, 95.75it/s] 82%|████████▏ | 321/391 [00:04<00:00, 96.07it/s] 85%|████████▍ | 331/391 [00:04<00:00, 96.16it/s] 87%|████████▋ | 341/391 [00:04<00:00, 96.30it/s] 90%|████████▉ | 351/391 [00:04<00:00, 96.39it/s] 92%|█████████▏| 361/391 [00:05<00:00, 95.25it/s] 95%|█████████▍| 371/391 [00:05<00:00, 96.03it/s] 97%|█████████▋| 381/391 [00:05<00:00, 96.62it/s]100%|██████████| 391/391 [00:05<00:00, 94.62it/s]100%|██████████| 391/391 [00:05<00:00, 72.74it/s]
50000 images processed, 5.494633913040161 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.17it/s] 13%|█▎        | 10/79 [00:00<00:03, 22.50it/s] 24%|██▍       | 19/79 [00:00<00:01, 38.83it/s] 37%|███▋      | 29/79 [00:00<00:00, 53.45it/s] 48%|████▊     | 38/79 [00:00<00:00, 62.80it/s] 59%|█████▉    | 47/79 [00:00<00:00, 70.12it/s] 72%|███████▏  | 57/79 [00:01<00:00, 77.00it/s] 85%|████████▍ | 67/79 [00:01<00:00, 81.78it/s] 97%|█████████▋| 77/79 [00:01<00:00, 85.46it/s]100%|██████████| 79/79 [00:02<00:00, 33.88it/s]
10000 images processed, 2.392460584640503 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-seen-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:00,  1.69it/s]  4%|▍         | 9/204 [00:00<00:11, 16.79it/s]  9%|▉         | 18/204 [00:00<00:05, 32.28it/s] 14%|█▎        | 28/204 [00:00<00:03, 47.23it/s] 19%|█▊        | 38/204 [00:01<00:02, 58.72it/s] 23%|██▎       | 47/204 [00:01<00:02, 66.29it/s] 27%|██▋       | 56/204 [00:01<00:02, 72.54it/s] 32%|███▏      | 66/204 [00:01<00:01, 77.49it/s] 37%|███▋      | 75/204 [00:01<00:01, 80.23it/s] 41%|████      | 84/204 [00:01<00:01, 82.85it/s] 46%|████▌     | 94/204 [00:01<00:01, 86.22it/s] 51%|█████     | 104/204 [00:01<00:01, 88.69it/s] 56%|█████▌    | 114/204 [00:01<00:00, 90.58it/s] 61%|██████    | 124/204 [00:01<00:00, 91.87it/s] 66%|██████▌   | 134/204 [00:02<00:00, 93.03it/s] 71%|███████   | 144/204 [00:02<00:00, 92.91it/s] 75%|███████▌  | 154/204 [00:02<00:00, 93.15it/s] 80%|████████  | 164/204 [00:02<00:00, 93.64it/s] 85%|████████▌ | 174/204 [00:02<00:00, 93.95it/s] 90%|█████████ | 184/204 [00:02<00:00, 95.00it/s] 95%|█████████▌| 194/204 [00:02<00:00, 95.75it/s]100%|██████████| 204/204 [00:02<00:00, 94.83it/s]100%|██████████| 204/204 [00:02<00:00, 72.75it/s]
26032 images processed, 2.853228807449341 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:54,  1.42it/s] 13%|█▎        | 10/79 [00:00<00:04, 16.37it/s] 23%|██▎       | 18/79 [00:00<00:02, 28.39it/s] 35%|███▌      | 28/79 [00:01<00:01, 43.32it/s] 48%|████▊     | 38/79 [00:01<00:00, 55.26it/s] 61%|██████    | 48/79 [00:01<00:00, 64.60it/s] 73%|███████▎  | 58/79 [00:01<00:00, 72.48it/s] 86%|████████▌ | 68/79 [00:01<00:00, 78.00it/s] 99%|█████████▊| 78/79 [00:01<00:00, 83.27it/s]100%|██████████| 79/79 [00:01<00:00, 50.76it/s]
10000 images processed, 1.5830891132354736 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.04it/s]  9%|▉         | 7/79 [00:00<00:04, 15.00it/s] 22%|██▏       | 17/79 [00:00<00:01, 35.14it/s] 34%|███▍      | 27/79 [00:00<00:01, 50.71it/s] 47%|████▋     | 37/79 [00:00<00:00, 62.82it/s] 59%|█████▉    | 47/79 [00:01<00:00, 71.21it/s] 72%|███████▏  | 57/79 [00:01<00:00, 77.11it/s] 85%|████████▍ | 67/79 [00:01<00:00, 82.71it/s] 97%|█████████▋| 77/79 [00:01<00:00, 86.60it/s]100%|██████████| 79/79 [00:01<00:00, 58.48it/s]
10000 images processed, 1.3702540397644043 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:41,  1.65it/s] 16%|█▌        | 11/70 [00:00<00:02, 20.04it/s] 30%|███       | 21/70 [00:00<00:01, 36.15it/s] 44%|████▍     | 31/70 [00:00<00:00, 49.72it/s] 59%|█████▊    | 41/70 [00:01<00:00, 60.74it/s] 73%|███████▎  | 51/70 [00:01<00:00, 70.10it/s] 87%|████████▋ | 61/70 [00:01<00:00, 77.39it/s]100%|██████████| 70/70 [00:01<00:00, 52.03it/s]
8925 images processed, 1.374565839767456 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:43,  1.01it/s]  4%|▍         | 2/45 [00:01<00:20,  2.08it/s] 27%|██▋       | 12/45 [00:01<00:02, 16.46it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.08it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.61it/s] 56%|█████▌    | 25/45 [00:01<00:00, 24.62it/s] 73%|███████▎  | 33/45 [00:02<00:00, 23.01it/s] 82%|████████▏ | 37/45 [00:02<00:00, 24.75it/s]100%|██████████| 45/45 [00:02<00:00, 19.93it/s]
5640 images processed, 2.2800042629241943 seconds used

19.004089832305908
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.73  98.92  96.65
places365     73.45  79.58  77.61
LSUN          30.55  94.20  94.23
iSUN          78.44  78.92  81.77
dtd           43.53  90.10  93.49
AVG           46.14  88.34  88.75
Retain-Acc: 0.7463
Forget-as-OOD (retain known vs forget novel):
  FPR: 48.60 AUROC: 90.29 AUIN: 98.73
7.395358562469482
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage3-seen-forget_rf.png
==== Stage 4: inc={105,106,107,108,109}; seen={0,8,11,40,51,66,67,88,94,57,100,101,102,103,104}; all(union)={0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109} ====
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3', lora_stack=False, lora_orth_enable=True, lora_orth_lambda=1.0, lora_orth_ref_paths='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage1,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage2,checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3', forget_classes='0,8,11,40,51,57,66,67,88,94,100,101,102,103,104,105,106,107,108,109', forget_list_path=None, forget_classes_inc='105,106,107,108,109', forget_classes_seen='0,8,11,40,51,66,67,88,94,57,100,101,102,103,104', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='none', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage3
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
[trainable] param_count=238592 tensors=16
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:168: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/shaokun/PALM/trainer.py:274: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):
  2%|▏         | 1/50 [00:19<16:09, 19.78s/it]  4%|▍         | 2/50 [00:34<13:12, 16.51s/it]  6%|▌         | 3/50 [00:47<11:47, 15.05s/it]  8%|▊         | 4/50 [01:02<11:41, 15.24s/it] 10%|█         | 5/50 [01:17<11:21, 15.14s/it] 12%|█▏        | 6/50 [01:32<11:00, 15.02s/it][loss] ep 0 it 0 total=9.2240 mle=1.6354 pcon=5.2947 forget=0.0000 orth=2.2939 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 50 total=9.1790 mle=1.6104 pcon=5.2752 forget=0.0000 orth=2.2934 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 100 total=9.2439 mle=1.6955 pcon=5.2559 forget=0.0000 orth=2.2925 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 150 total=9.1101 mle=1.5815 pcon=5.2377 forget=0.0000 orth=2.2909 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 200 total=9.2432 mle=1.7348 pcon=5.2198 forget=0.0000 orth=2.2886 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 250 total=9.0153 mle=1.5271 pcon=5.2026 forget=0.0000 orth=2.2857 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 300 total=9.0156 mle=1.5479 pcon=5.1856 forget=0.0000 orth=2.2820 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 0 it 350 total=8.9805 mle=1.5334 pcon=5.1694 forget=0.0000 orth=2.2777 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 1 it 9 total=8.8583 mle=1.4317 pcon=5.1538 forget=0.0000 orth=2.2727 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 59 total=8.9582 mle=1.5527 pcon=5.1386 forget=0.0000 orth=2.2670 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 109 total=8.8686 mle=1.4842 pcon=5.1240 forget=0.0000 orth=2.2604 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 159 total=8.9468 mle=1.5839 pcon=5.1098 forget=0.0000 orth=2.2531 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 209 total=8.8209 mle=1.4797 pcon=5.0962 forget=0.0000 orth=2.2450 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 259 total=8.8439 mle=1.5246 pcon=5.0832 forget=0.0000 orth=2.2361 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 309 total=8.7250 mle=1.4286 pcon=5.0701 forget=0.0000 orth=2.2263 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 1 it 359 total=8.8039 mle=1.5302 pcon=5.0582 forget=0.0000 orth=2.2155 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 2 it 18 total=8.7282 mle=1.4775 pcon=5.0469 forget=0.0000 orth=2.2039 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 68 total=8.6953 mle=1.4684 pcon=5.0357 forget=0.0000 orth=2.1912 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 118 total=8.6080 mle=1.4054 pcon=5.0251 forget=0.0000 orth=2.1775 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 168 total=8.6821 mle=1.5051 pcon=5.0142 forget=0.0000 orth=2.1627 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 218 total=8.4924 mle=1.3414 pcon=5.0042 forget=0.0000 orth=2.1468 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 268 total=8.5595 mle=1.4353 pcon=4.9944 forget=0.0000 orth=2.1298 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 318 total=8.5664 mle=1.4698 pcon=4.9851 forget=0.0000 orth=2.1115 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 2 it 368 total=8.4786 mle=1.4105 pcon=4.9762 forget=0.0000 orth=2.0919 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 3 it 27 total=8.5716 mle=1.5329 pcon=4.9676 forget=0.0000 orth=2.0710 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 77 total=8.4560 mle=1.4481 pcon=4.9590 forget=0.0000 orth=2.0488 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 127 total=8.4324 mle=1.4564 pcon=4.9508 forget=0.0000 orth=2.0252 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 177 total=8.4010 mle=1.4579 pcon=4.9430 forget=0.0000 orth=2.0001 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 227 total=8.3714 mle=1.4622 pcon=4.9356 forget=0.0000 orth=1.9735 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 277 total=8.3862 mle=1.5121 pcon=4.9286 forget=0.0000 orth=1.9455 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 327 total=8.3124 mle=1.4749 pcon=4.9215 forget=0.0000 orth=1.9160 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 3 it 377 total=8.3661 mle=1.5663 pcon=4.9148 forget=0.0000 orth=1.8850 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 4 it 36 total=8.2811 mle=1.5201 pcon=4.9084 forget=0.0000 orth=1.8525 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 86 total=8.1620 mle=1.4411 pcon=4.9022 forget=0.0000 orth=1.8186 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 136 total=8.1245 mle=1.4449 pcon=4.8962 forget=0.0000 orth=1.7834 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 186 total=8.1343 mle=1.4973 pcon=4.8902 forget=0.0000 orth=1.7468 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 236 total=8.1115 mle=1.5176 pcon=4.8847 forget=0.0000 orth=1.7092 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 286 total=8.0142 mle=1.4644 pcon=4.8794 forget=0.0000 orth=1.6704 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 336 total=8.0088 mle=1.5038 pcon=4.8741 forget=0.0000 orth=1.6309 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 4 it 386 total=7.9266 mle=1.4668 pcon=4.8691 forget=0.0000 orth=1.5907 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 5 it 45 total=7.8961 mle=1.4822 pcon=4.8639 forget=0.0000 orth=1.5501 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 95 total=7.8527 mle=1.4843 pcon=4.8593 forget=0.0000 orth=1.5091 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 145 total=7.8079 mle=1.4850 pcon=4.8548 forget=0.0000 orth=1.4680 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 195 total=7.7276 mle=1.4497 pcon=4.8507 forget=0.0000 orth=1.4272 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 245 total=7.8148 mle=1.5819 pcon=4.8464 forget=0.0000 orth=1.3866 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 295 total=7.6961 mle=1.5073 pcon=4.8425 forget=0.0000 orth=1.3464 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 5 it 345 total=7.7092 mle=1.5637 pcon=4.8387 forget=0.0000 orth=1.3068 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 6 it 4 total=7.5681 mle=1.4651 pcon=4.8350 forget=0.0000 orth=1.2680 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 54 total=7.6113 mle=1.5500 pcon=4.8315 forget=0.0000 orth=1.2299 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 104 total=7.4587 mle=1.4380 pcon=4.8281 forget=0.0000 orth=1.1926 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 154 total=7.5044 mle=1.5233 pcon=4.8250 forget=0.0000 orth=1.1561 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 204 total=7.4932 mle=1.5512 pcon=4.8217 forget=0.0000 orth=1.1204 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
 14%|█▍        | 7/50 [01:48<11:02, 15.41s/it] 16%|█▌        | 8/50 [02:03<10:43, 15.33s/it] 18%|█▊        | 9/50 [02:20<10:48, 15.81s/it] 20%|██        | 10/50 [02:36<10:34, 15.86s/it] 22%|██▏       | 11/50 [02:52<10:14, 15.77s/it] 24%|██▍       | 12/50 [03:08<10:03, 15.87s/it] 26%|██▌       | 13/50 [03:24<09:53, 16.03s/it][loss] ep 6 it 254 total=7.4003 mle=1.4961 pcon=4.8188 forget=0.0000 orth=1.0854 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 304 total=7.5282 mle=1.6609 pcon=4.8160 forget=0.0000 orth=1.0513 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 6 it 354 total=7.3545 mle=1.5235 pcon=4.8132 forget=0.0000 orth=1.0178 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 7 it 13 total=7.3040 mle=1.5083 pcon=4.8106 forget=0.0000 orth=0.9851 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 63 total=7.3217 mle=1.5605 pcon=4.8082 forget=0.0000 orth=0.9531 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 113 total=7.4007 mle=1.6732 pcon=4.8057 forget=0.0000 orth=0.9218 favg=0.0000 nr=106 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 163 total=7.3505 mle=1.6560 pcon=4.8034 forget=0.0000 orth=0.8911 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 213 total=7.0960 mle=1.4337 pcon=4.8011 forget=0.0000 orth=0.8612 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 263 total=7.1741 mle=1.5429 pcon=4.7990 forget=0.0000 orth=0.8322 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 313 total=7.1880 mle=1.5872 pcon=4.7969 forget=0.0000 orth=0.8039 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 7 it 363 total=7.1767 mle=1.6054 pcon=4.7948 forget=0.0000 orth=0.7764 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 8 it 22 total=7.1187 mle=1.5759 pcon=4.7929 forget=0.0000 orth=0.7499 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 72 total=7.0992 mle=1.5838 pcon=4.7910 forget=0.0000 orth=0.7244 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 122 total=7.0230 mle=1.5340 pcon=4.7893 forget=0.0000 orth=0.6997 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 172 total=6.8847 mle=1.4208 pcon=4.7877 forget=0.0000 orth=0.6761 favg=0.0000 nr=124 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 222 total=6.9845 mle=1.5448 pcon=4.7861 forget=0.0000 orth=0.6536 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 272 total=7.0439 mle=1.6273 pcon=4.7845 forget=0.0000 orth=0.6321 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 322 total=6.9403 mle=1.5455 pcon=4.7831 forget=0.0000 orth=0.6117 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 8 it 372 total=6.9723 mle=1.5981 pcon=4.7818 forget=0.0000 orth=0.5924 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 9 it 31 total=6.9840 mle=1.6295 pcon=4.7804 forget=0.0000 orth=0.5742 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 81 total=6.8232 mle=1.4872 pcon=4.7791 forget=0.0000 orth=0.5569 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 131 total=6.7895 mle=1.4710 pcon=4.7778 forget=0.0000 orth=0.5407 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 181 total=6.8432 mle=1.5413 pcon=4.7766 forget=0.0000 orth=0.5253 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 231 total=6.7966 mle=1.5103 pcon=4.7755 forget=0.0000 orth=0.5108 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 281 total=6.9129 mle=1.6411 pcon=4.7746 forget=0.0000 orth=0.4971 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 331 total=6.7559 mle=1.4979 pcon=4.7737 forget=0.0000 orth=0.4843 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 9 it 381 total=6.6869 mle=1.4424 pcon=4.7725 forget=0.0000 orth=0.4721 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 10 it 40 total=6.7757 mle=1.5434 pcon=4.7718 forget=0.0000 orth=0.4605 favg=0.0000 nr=123 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 90 total=6.7855 mle=1.5652 pcon=4.7706 forget=0.0000 orth=0.4497 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 140 total=6.6903 mle=1.4807 pcon=4.7700 forget=0.0000 orth=0.4395 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 190 total=6.8041 mle=1.6050 pcon=4.7692 forget=0.0000 orth=0.4299 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 240 total=6.7621 mle=1.5727 pcon=4.7686 forget=0.0000 orth=0.4208 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 290 total=6.7632 mle=1.5832 pcon=4.7678 forget=0.0000 orth=0.4122 favg=0.0000 nr=107 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 340 total=6.6464 mle=1.4750 pcon=4.7674 forget=0.0000 orth=0.4040 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 10 it 390 total=6.8219 mle=1.6588 pcon=4.7669 forget=0.0000 orth=0.3961 favg=0.0000 nr=74 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 11 it 49 total=6.6986 mle=1.5437 pcon=4.7663 forget=0.0000 orth=0.3886 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 99 total=6.6605 mle=1.5135 pcon=4.7657 forget=0.0000 orth=0.3814 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 149 total=6.7571 mle=1.6176 pcon=4.7650 forget=0.0000 orth=0.3745 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 199 total=6.6694 mle=1.5372 pcon=4.7643 forget=0.0000 orth=0.3678 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 249 total=6.7417 mle=1.6166 pcon=4.7637 forget=0.0000 orth=0.3614 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 299 total=6.7201 mle=1.6016 pcon=4.7633 forget=0.0000 orth=0.3552 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 11 it 349 total=6.6421 mle=1.5302 pcon=4.7626 forget=0.0000 orth=0.3493 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 12 it 8 total=6.8190 mle=1.7137 pcon=4.7619 forget=0.0000 orth=0.3435 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 58 total=6.7523 mle=1.6531 pcon=4.7613 forget=0.0000 orth=0.3378 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 108 total=6.6828 mle=1.5897 pcon=4.7607 forget=0.0000 orth=0.3323 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 158 total=6.6262 mle=1.5390 pcon=4.7602 forget=0.0000 orth=0.3270 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 208 total=6.6148 mle=1.5334 pcon=4.7596 forget=0.0000 orth=0.3218 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 258 total=6.7196 mle=1.6438 pcon=4.7591 forget=0.0000 orth=0.3168 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 308 total=6.6766 mle=1.6060 pcon=4.7587 forget=0.0000 orth=0.3119 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 12 it 358 total=6.6029 mle=1.5375 pcon=4.7584 forget=0.0000 orth=0.3071 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
 28%|██▊       | 14/50 [03:43<10:02, 16.72s/it] 30%|███       | 15/50 [03:59<09:37, 16.51s/it] 32%|███▏      | 16/50 [04:16<09:30, 16.79s/it] 34%|███▍      | 17/50 [04:31<08:57, 16.30s/it] 36%|███▌      | 18/50 [04:48<08:41, 16.31s/it] 38%|███▊      | 19/50 [05:03<08:20, 16.14s/it][loss] ep 13 it 17 total=6.6701 mle=1.6098 pcon=4.7579 forget=0.0000 orth=0.3024 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 67 total=6.5733 mle=1.5179 pcon=4.7575 forget=0.0000 orth=0.2979 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 117 total=6.6003 mle=1.5499 pcon=4.7571 forget=0.0000 orth=0.2934 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 167 total=6.5911 mle=1.5455 pcon=4.7566 forget=0.0000 orth=0.2891 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 217 total=6.5938 mle=1.5527 pcon=4.7563 forget=0.0000 orth=0.2848 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 267 total=6.5290 mle=1.4926 pcon=4.7558 forget=0.0000 orth=0.2806 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 317 total=6.5046 mle=1.4727 pcon=4.7553 forget=0.0000 orth=0.2765 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 13 it 367 total=6.5533 mle=1.5257 pcon=4.7550 forget=0.0000 orth=0.2725 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 14 it 26 total=6.6571 mle=1.6337 pcon=4.7548 forget=0.0000 orth=0.2686 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 76 total=6.5783 mle=1.5588 pcon=4.7546 forget=0.0000 orth=0.2648 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 126 total=6.6014 mle=1.5861 pcon=4.7542 forget=0.0000 orth=0.2611 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 176 total=6.6198 mle=1.6084 pcon=4.7539 forget=0.0000 orth=0.2574 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 226 total=6.5333 mle=1.5259 pcon=4.7535 forget=0.0000 orth=0.2539 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 276 total=6.5907 mle=1.5870 pcon=4.7533 forget=0.0000 orth=0.2504 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 326 total=6.5803 mle=1.5805 pcon=4.7528 forget=0.0000 orth=0.2470 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 14 it 376 total=6.5182 mle=1.5218 pcon=4.7527 forget=0.0000 orth=0.2436 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 15 it 35 total=6.4773 mle=1.4846 pcon=4.7523 forget=0.0000 orth=0.2404 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 85 total=6.4946 mle=1.5054 pcon=4.7520 forget=0.0000 orth=0.2372 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 135 total=6.6241 mle=1.6383 pcon=4.7518 forget=0.0000 orth=0.2341 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 185 total=6.5457 mle=1.5631 pcon=4.7516 forget=0.0000 orth=0.2310 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 235 total=6.5338 mle=1.5546 pcon=4.7513 forget=0.0000 orth=0.2279 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 285 total=6.5025 mle=1.5264 pcon=4.7511 forget=0.0000 orth=0.2250 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 335 total=6.6036 mle=1.6307 pcon=4.7508 forget=0.0000 orth=0.2221 favg=0.0000 nr=107 nf=0 protos=None fproto_sim=NA
[loss] ep 15 it 385 total=6.5353 mle=1.5655 pcon=4.7505 forget=0.0000 orth=0.2193 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 16 it 44 total=6.5973 mle=1.6307 pcon=4.7500 forget=0.0000 orth=0.2165 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 94 total=6.5323 mle=1.5686 pcon=4.7498 forget=0.0000 orth=0.2139 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 144 total=6.4979 mle=1.5371 pcon=4.7496 forget=0.0000 orth=0.2112 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 194 total=6.5534 mle=1.5956 pcon=4.7492 forget=0.0000 orth=0.2086 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 244 total=6.4659 mle=1.5109 pcon=4.7489 forget=0.0000 orth=0.2061 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 294 total=6.5091 mle=1.5567 pcon=4.7487 forget=0.0000 orth=0.2037 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 16 it 344 total=6.5201 mle=1.5704 pcon=4.7485 forget=0.0000 orth=0.2012 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 17 it 3 total=6.4175 mle=1.4703 pcon=4.7484 forget=0.0000 orth=0.1989 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 53 total=6.4931 mle=1.5485 pcon=4.7480 forget=0.0000 orth=0.1966 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 103 total=6.5495 mle=1.6074 pcon=4.7478 forget=0.0000 orth=0.1943 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 153 total=6.5806 mle=1.6410 pcon=4.7475 forget=0.0000 orth=0.1922 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 203 total=6.5490 mle=1.6119 pcon=4.7472 forget=0.0000 orth=0.1900 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 253 total=6.5206 mle=1.5859 pcon=4.7468 forget=0.0000 orth=0.1879 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 303 total=6.4714 mle=1.5391 pcon=4.7465 forget=0.0000 orth=0.1858 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 17 it 353 total=6.4599 mle=1.5299 pcon=4.7461 forget=0.0000 orth=0.1839 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 18 it 12 total=6.5035 mle=1.5757 pcon=4.7459 forget=0.0000 orth=0.1819 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 62 total=6.5150 mle=1.5895 pcon=4.7455 forget=0.0000 orth=0.1800 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 112 total=6.3622 mle=1.4386 pcon=4.7454 forget=0.0000 orth=0.1782 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 162 total=6.3812 mle=1.4598 pcon=4.7450 forget=0.0000 orth=0.1764 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 212 total=6.4799 mle=1.5606 pcon=4.7447 forget=0.0000 orth=0.1746 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 262 total=6.4040 mle=1.4867 pcon=4.7444 forget=0.0000 orth=0.1728 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 312 total=6.5078 mle=1.5925 pcon=4.7442 forget=0.0000 orth=0.1712 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 18 it 362 total=6.4905 mle=1.5772 pcon=4.7438 forget=0.0000 orth=0.1695 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 19 it 21 total=6.4820 mle=1.5703 pcon=4.7437 forget=0.0000 orth=0.1680 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 71 total=6.4967 mle=1.5869 pcon=4.7434 forget=0.0000 orth=0.1664 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 121 total=6.4031 mle=1.4952 pcon=4.7430 forget=0.0000 orth=0.1649 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 171 total=6.4630 mle=1.5568 pcon=4.7427 forget=0.0000 orth=0.1634 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
 40%|████      | 20/50 [05:19<08:02, 16.09s/it] 42%|████▏     | 21/50 [05:36<07:47, 16.12s/it] 44%|████▍     | 22/50 [05:51<07:27, 15.99s/it] 46%|████▌     | 23/50 [06:06<07:00, 15.57s/it] 48%|████▊     | 24/50 [06:22<06:50, 15.79s/it] 50%|█████     | 25/50 [06:36<06:20, 15.23s/it][loss] ep 19 it 221 total=6.5780 mle=1.6735 pcon=4.7425 forget=0.0000 orth=0.1620 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 271 total=6.5734 mle=1.6706 pcon=4.7422 forget=0.0000 orth=0.1606 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 321 total=6.4727 mle=1.5715 pcon=4.7420 forget=0.0000 orth=0.1592 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 19 it 371 total=6.4543 mle=1.5549 pcon=4.7416 forget=0.0000 orth=0.1578 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 20 it 30 total=6.4354 mle=1.5374 pcon=4.7415 forget=0.0000 orth=0.1565 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 80 total=6.4647 mle=1.5685 pcon=4.7410 forget=0.0000 orth=0.1552 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 130 total=6.4797 mle=1.5848 pcon=4.7409 forget=0.0000 orth=0.1540 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 180 total=6.6099 mle=1.7165 pcon=4.7407 forget=0.0000 orth=0.1528 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 230 total=6.4320 mle=1.5400 pcon=4.7405 forget=0.0000 orth=0.1516 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 280 total=6.4141 mle=1.5234 pcon=4.7403 forget=0.0000 orth=0.1504 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 330 total=6.5236 mle=1.6342 pcon=4.7401 forget=0.0000 orth=0.1493 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 20 it 380 total=6.5430 mle=1.6548 pcon=4.7400 forget=0.0000 orth=0.1482 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 21 it 39 total=6.4165 mle=1.5296 pcon=4.7398 forget=0.0000 orth=0.1471 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 89 total=6.3953 mle=1.5097 pcon=4.7396 forget=0.0000 orth=0.1461 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 139 total=6.4312 mle=1.5468 pcon=4.7394 forget=0.0000 orth=0.1450 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 189 total=6.5186 mle=1.6353 pcon=4.7392 forget=0.0000 orth=0.1440 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 239 total=6.4149 mle=1.5327 pcon=4.7392 forget=0.0000 orth=0.1430 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 289 total=6.4247 mle=1.5436 pcon=4.7390 forget=0.0000 orth=0.1421 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 339 total=6.3818 mle=1.5018 pcon=4.7389 forget=0.0000 orth=0.1411 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 21 it 389 total=6.4979 mle=1.6190 pcon=4.7387 forget=0.0000 orth=0.1402 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 22 it 48 total=6.3851 mle=1.5074 pcon=4.7384 forget=0.0000 orth=0.1393 favg=0.0000 nr=109 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 98 total=6.4276 mle=1.5508 pcon=4.7384 forget=0.0000 orth=0.1384 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 148 total=6.4172 mle=1.5415 pcon=4.7382 forget=0.0000 orth=0.1375 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 198 total=6.4225 mle=1.5478 pcon=4.7380 forget=0.0000 orth=0.1367 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 248 total=6.4601 mle=1.5863 pcon=4.7379 forget=0.0000 orth=0.1358 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 298 total=6.4440 mle=1.5712 pcon=4.7378 forget=0.0000 orth=0.1350 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 22 it 348 total=6.4527 mle=1.5808 pcon=4.7377 forget=0.0000 orth=0.1342 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 23 it 7 total=6.4688 mle=1.5979 pcon=4.7375 forget=0.0000 orth=0.1334 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 57 total=6.4950 mle=1.6251 pcon=4.7372 forget=0.0000 orth=0.1327 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 107 total=6.4148 mle=1.5459 pcon=4.7370 forget=0.0000 orth=0.1319 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 157 total=6.4662 mle=1.5979 pcon=4.7371 forget=0.0000 orth=0.1312 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 207 total=6.4785 mle=1.6112 pcon=4.7369 forget=0.0000 orth=0.1305 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 257 total=6.4035 mle=1.5372 pcon=4.7365 forget=0.0000 orth=0.1298 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 307 total=6.6054 mle=1.7400 pcon=4.7363 forget=0.0000 orth=0.1291 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 23 it 357 total=6.4001 mle=1.5356 pcon=4.7361 forget=0.0000 orth=0.1284 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 24 it 16 total=6.3809 mle=1.5171 pcon=4.7361 forget=0.0000 orth=0.1277 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 66 total=6.3828 mle=1.5198 pcon=4.7359 forget=0.0000 orth=0.1271 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 116 total=6.5276 mle=1.6654 pcon=4.7357 forget=0.0000 orth=0.1265 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 166 total=6.5222 mle=1.6607 pcon=4.7357 forget=0.0000 orth=0.1258 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 216 total=6.2918 mle=1.4310 pcon=4.7356 forget=0.0000 orth=0.1252 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 266 total=6.3955 mle=1.5354 pcon=4.7354 forget=0.0000 orth=0.1246 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 316 total=6.3647 mle=1.5053 pcon=4.7354 forget=0.0000 orth=0.1240 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 24 it 366 total=6.5438 mle=1.6851 pcon=4.7353 forget=0.0000 orth=0.1234 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 25 it 25 total=6.4203 mle=1.5623 pcon=4.7351 forget=0.0000 orth=0.1229 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 75 total=6.3985 mle=1.5413 pcon=4.7349 forget=0.0000 orth=0.1223 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 125 total=6.5089 mle=1.6523 pcon=4.7348 forget=0.0000 orth=0.1217 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 175 total=6.4294 mle=1.5735 pcon=4.7347 forget=0.0000 orth=0.1212 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 225 total=6.5224 mle=1.6671 pcon=4.7346 forget=0.0000 orth=0.1207 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 275 total=6.4391 mle=1.5843 pcon=4.7346 forget=0.0000 orth=0.1202 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 325 total=6.5573 mle=1.7032 pcon=4.7345 forget=0.0000 orth=0.1197 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 25 it 375 total=6.5130 mle=1.6592 pcon=4.7346 forget=0.0000 orth=0.1192 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
 52%|█████▏    | 26/50 [06:51<06:06, 15.28s/it] 54%|█████▍    | 27/50 [07:06<05:42, 14.90s/it] 56%|█████▌    | 28/50 [07:22<05:37, 15.34s/it] 58%|█████▊    | 29/50 [07:37<05:19, 15.24s/it] 60%|██████    | 30/50 [07:54<05:15, 15.80s/it] 62%|██████▏   | 31/50 [08:10<05:01, 15.86s/it] 64%|██████▍   | 32/50 [08:26<04:44, 15.81s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 26 it 34 total=6.3929 mle=1.5396 pcon=4.7346 forget=0.0000 orth=0.1187 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 84 total=6.3699 mle=1.5173 pcon=4.7344 forget=0.0000 orth=0.1182 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 134 total=6.4144 mle=1.5622 pcon=4.7344 forget=0.0000 orth=0.1177 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 184 total=6.5336 mle=1.6821 pcon=4.7342 forget=0.0000 orth=0.1173 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 234 total=6.3946 mle=1.5437 pcon=4.7341 forget=0.0000 orth=0.1168 favg=0.0000 nr=124 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 284 total=6.3893 mle=1.5389 pcon=4.7341 forget=0.0000 orth=0.1163 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 334 total=6.4446 mle=1.5946 pcon=4.7341 forget=0.0000 orth=0.1159 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 26 it 384 total=6.4645 mle=1.6152 pcon=4.7339 forget=0.0000 orth=0.1155 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 27 it 43 total=6.4927 mle=1.6439 pcon=4.7337 forget=0.0000 orth=0.1151 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 93 total=6.3752 mle=1.5269 pcon=4.7337 forget=0.0000 orth=0.1146 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 143 total=6.3605 mle=1.5127 pcon=4.7336 forget=0.0000 orth=0.1142 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 193 total=6.3888 mle=1.5416 pcon=4.7334 forget=0.0000 orth=0.1138 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 243 total=6.3488 mle=1.5021 pcon=4.7333 forget=0.0000 orth=0.1134 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 293 total=6.4973 mle=1.6512 pcon=4.7332 forget=0.0000 orth=0.1130 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 27 it 343 total=6.3503 mle=1.5045 pcon=4.7331 forget=0.0000 orth=0.1126 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 28 it 2 total=6.4625 mle=1.6171 pcon=4.7332 forget=0.0000 orth=0.1123 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 52 total=6.4597 mle=1.6146 pcon=4.7332 forget=0.0000 orth=0.1119 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 102 total=6.4309 mle=1.5863 pcon=4.7331 forget=0.0000 orth=0.1115 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 152 total=6.4903 mle=1.6461 pcon=4.7330 forget=0.0000 orth=0.1112 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 202 total=6.4536 mle=1.6100 pcon=4.7328 forget=0.0000 orth=0.1108 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 252 total=6.5711 mle=1.7279 pcon=4.7328 forget=0.0000 orth=0.1105 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 302 total=6.3879 mle=1.5450 pcon=4.7328 forget=0.0000 orth=0.1101 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
[loss] ep 28 it 352 total=6.4106 mle=1.5681 pcon=4.7327 forget=0.0000 orth=0.1098 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 29 it 11 total=6.3596 mle=1.5177 pcon=4.7325 forget=0.0000 orth=0.1095 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 61 total=6.3930 mle=1.5516 pcon=4.7323 forget=0.0000 orth=0.1091 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 111 total=6.5916 mle=1.7504 pcon=4.7324 forget=0.0000 orth=0.1088 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 161 total=6.3872 mle=1.5464 pcon=4.7323 forget=0.0000 orth=0.1085 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 211 total=6.4577 mle=1.6174 pcon=4.7321 forget=0.0000 orth=0.1082 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 261 total=6.3720 mle=1.5322 pcon=4.7319 forget=0.0000 orth=0.1078 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 311 total=6.3709 mle=1.5316 pcon=4.7317 forget=0.0000 orth=0.1075 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 29 it 361 total=6.4035 mle=1.5645 pcon=4.7317 forget=0.0000 orth=0.1072 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 30 it 20 total=6.4188 mle=1.5802 pcon=4.7316 forget=0.0000 orth=0.1070 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 70 total=6.5012 mle=1.6629 pcon=4.7316 forget=0.0000 orth=0.1067 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 120 total=6.3640 mle=1.5260 pcon=4.7317 forget=0.0000 orth=0.1064 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 170 total=6.4179 mle=1.5804 pcon=4.7314 forget=0.0000 orth=0.1061 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 220 total=6.4202 mle=1.5830 pcon=4.7314 forget=0.0000 orth=0.1058 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 270 total=6.3874 mle=1.5504 pcon=4.7314 forget=0.0000 orth=0.1055 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 320 total=6.4707 mle=1.6341 pcon=4.7313 forget=0.0000 orth=0.1053 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 30 it 370 total=6.3867 mle=1.5505 pcon=4.7311 forget=0.0000 orth=0.1050 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 29 total=6.4201 mle=1.5842 pcon=4.7311 forget=0.0000 orth=0.1048 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 79 total=6.5078 mle=1.6722 pcon=4.7311 forget=0.0000 orth=0.1045 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 129 total=6.3856 mle=1.5503 pcon=4.7311 forget=0.0000 orth=0.1043 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 179 total=6.4192 mle=1.5840 pcon=4.7312 forget=0.0000 orth=0.1040 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 229 total=6.4575 mle=1.6226 pcon=4.7311 forget=0.0000 orth=0.1038 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 279 total=6.3364 mle=1.5018 pcon=4.7311 forget=0.0000 orth=0.1035 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 329 total=6.4740 mle=1.6396 pcon=4.7311 forget=0.0000 orth=0.1033 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 31 it 379 total=6.3961 mle=1.5619 pcon=4.7311 forget=0.0000 orth=0.1031 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 32 it 38 total=6.3568 mle=1.5227 pcon=4.7313 forget=0.0000 orth=0.1028 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 88 total=6.4324 mle=1.5985 pcon=4.7313 forget=0.0000 orth=0.1026 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 138 total=6.3928 mle=1.5592 pcon=4.7312 forget=0.0000 orth=0.1024 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 188 total=6.4428 mle=1.6095 pcon=4.7312 forget=0.0000 orth=0.1022 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
 66%|██████▌   | 33/50 [08:42<04:33, 16.06s/it] 68%|██████▊   | 34/50 [08:58<04:16, 16.00s/it] 70%|███████   | 35/50 [09:13<03:54, 15.62s/it] 72%|███████▏  | 36/50 [09:29<03:38, 15.63s/it] 74%|███████▍  | 37/50 [09:45<03:27, 15.95s/it] 76%|███████▌  | 38/50 [10:01<03:12, 16.04s/it] 78%|███████▊  | 39/50 [10:18<02:59, 16.28s/it][loss] ep 32 it 238 total=6.3980 mle=1.5649 pcon=4.7311 forget=0.0000 orth=0.1020 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 288 total=6.3165 mle=1.4835 pcon=4.7312 forget=0.0000 orth=0.1018 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 338 total=6.4744 mle=1.6416 pcon=4.7312 forget=0.0000 orth=0.1016 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 32 it 388 total=6.4551 mle=1.6225 pcon=4.7313 forget=0.0000 orth=0.1014 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 33 it 47 total=6.4852 mle=1.6529 pcon=4.7312 forget=0.0000 orth=0.1012 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 97 total=6.4557 mle=1.6236 pcon=4.7311 forget=0.0000 orth=0.1010 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 147 total=6.4998 mle=1.6680 pcon=4.7310 forget=0.0000 orth=0.1008 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 197 total=6.3354 mle=1.5039 pcon=4.7309 forget=0.0000 orth=0.1006 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 247 total=6.3918 mle=1.5604 pcon=4.7309 forget=0.0000 orth=0.1004 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 297 total=6.4098 mle=1.5786 pcon=4.7310 forget=0.0000 orth=0.1002 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 33 it 347 total=6.4098 mle=1.5788 pcon=4.7309 forget=0.0000 orth=0.1001 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 6 total=6.3876 mle=1.5571 pcon=4.7306 forget=0.0000 orth=0.0999 favg=0.0000 nr=109 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 56 total=6.3684 mle=1.5383 pcon=4.7304 forget=0.0000 orth=0.0997 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 106 total=6.3820 mle=1.5520 pcon=4.7304 forget=0.0000 orth=0.0995 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 156 total=6.4166 mle=1.5870 pcon=4.7302 forget=0.0000 orth=0.0994 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 206 total=6.2868 mle=1.4576 pcon=4.7301 forget=0.0000 orth=0.0992 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 256 total=6.3767 mle=1.5474 pcon=4.7303 forget=0.0000 orth=0.0991 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 306 total=6.3542 mle=1.5249 pcon=4.7304 forget=0.0000 orth=0.0989 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 34 it 356 total=6.4054 mle=1.5764 pcon=4.7303 forget=0.0000 orth=0.0987 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 35 it 15 total=6.3611 mle=1.5323 pcon=4.7302 forget=0.0000 orth=0.0986 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 65 total=6.4751 mle=1.6464 pcon=4.7303 forget=0.0000 orth=0.0985 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 115 total=6.3753 mle=1.5467 pcon=4.7303 forget=0.0000 orth=0.0983 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 165 total=6.4119 mle=1.5837 pcon=4.7301 forget=0.0000 orth=0.0982 favg=0.0000 nr=106 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 215 total=6.3649 mle=1.5370 pcon=4.7298 forget=0.0000 orth=0.0980 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 265 total=6.4357 mle=1.6079 pcon=4.7299 forget=0.0000 orth=0.0979 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 315 total=6.4130 mle=1.5853 pcon=4.7299 forget=0.0000 orth=0.0978 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 35 it 365 total=6.3868 mle=1.5593 pcon=4.7299 forget=0.0000 orth=0.0976 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 36 it 24 total=6.4350 mle=1.6079 pcon=4.7297 forget=0.0000 orth=0.0975 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 74 total=6.4263 mle=1.5995 pcon=4.7294 forget=0.0000 orth=0.0974 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 124 total=6.3586 mle=1.5319 pcon=4.7294 forget=0.0000 orth=0.0973 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 174 total=6.4163 mle=1.5897 pcon=4.7295 forget=0.0000 orth=0.0971 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 224 total=6.4807 mle=1.6544 pcon=4.7292 forget=0.0000 orth=0.0970 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 274 total=6.3693 mle=1.5429 pcon=4.7294 forget=0.0000 orth=0.0969 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 324 total=6.3874 mle=1.5614 pcon=4.7293 forget=0.0000 orth=0.0968 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 36 it 374 total=6.4201 mle=1.5943 pcon=4.7291 forget=0.0000 orth=0.0967 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 33 total=6.3763 mle=1.5507 pcon=4.7291 forget=0.0000 orth=0.0966 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 83 total=6.3702 mle=1.5446 pcon=4.7292 forget=0.0000 orth=0.0965 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 133 total=6.2872 mle=1.4616 pcon=4.7293 forget=0.0000 orth=0.0963 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 183 total=6.4411 mle=1.6155 pcon=4.7294 forget=0.0000 orth=0.0962 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 233 total=6.3433 mle=1.5179 pcon=4.7293 forget=0.0000 orth=0.0962 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 283 total=6.4586 mle=1.6331 pcon=4.7295 forget=0.0000 orth=0.0961 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 333 total=6.3577 mle=1.5324 pcon=4.7294 forget=0.0000 orth=0.0960 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 37 it 383 total=6.4433 mle=1.6180 pcon=4.7295 forget=0.0000 orth=0.0959 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 42 total=6.3889 mle=1.5632 pcon=4.7298 forget=0.0000 orth=0.0958 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 92 total=6.4582 mle=1.6327 pcon=4.7297 forget=0.0000 orth=0.0957 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 142 total=6.4089 mle=1.5835 pcon=4.7298 forget=0.0000 orth=0.0956 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 192 total=6.2932 mle=1.4678 pcon=4.7298 forget=0.0000 orth=0.0955 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 242 total=6.3640 mle=1.5386 pcon=4.7300 forget=0.0000 orth=0.0954 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 292 total=6.4248 mle=1.5995 pcon=4.7300 forget=0.0000 orth=0.0953 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 38 it 342 total=6.4385 mle=1.6132 pcon=4.7300 forget=0.0000 orth=0.0952 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 39 it 1 total=6.5415 mle=1.7164 pcon=4.7299 forget=0.0000 orth=0.0952 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 51 total=6.4233 mle=1.5984 pcon=4.7298 forget=0.0000 orth=0.0951 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 101 total=6.5509 mle=1.7261 pcon=4.7298 forget=0.0000 orth=0.0950 favg=0.0000 nr=107 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 151 total=6.3313 mle=1.5065 pcon=4.7299 forget=0.0000 orth=0.0949 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 201 total=6.4640 mle=1.6392 pcon=4.7300 forget=0.0000 orth=0.0949 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
 80%|████████  | 40/50 [10:33<02:36, 15.68s/it] 82%|████████▏ | 41/50 [10:47<02:17, 15.26s/it] 84%|████████▍ | 42/50 [11:04<02:05, 15.67s/it] 86%|████████▌ | 43/50 [11:19<01:49, 15.62s/it] 88%|████████▊ | 44/50 [11:35<01:34, 15.75s/it] 90%|█████████ | 45/50 [11:51<01:19, 15.89s/it] 92%|█████████▏| 46/50 [12:06<01:01, 15.48s/it] 94%|█████████▍| 47/50 [12:21<00:46, 15.41s/it][loss] ep 39 it 251 total=6.4316 mle=1.6067 pcon=4.7301 forget=0.0000 orth=0.0948 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 301 total=6.4530 mle=1.6282 pcon=4.7301 forget=0.0000 orth=0.0947 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 39 it 351 total=6.4715 mle=1.6465 pcon=4.7303 forget=0.0000 orth=0.0947 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 10 total=6.4375 mle=1.6128 pcon=4.7301 forget=0.0000 orth=0.0946 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 60 total=6.4347 mle=1.6102 pcon=4.7300 forget=0.0000 orth=0.0945 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 110 total=6.3494 mle=1.5252 pcon=4.7298 forget=0.0000 orth=0.0945 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 160 total=6.4832 mle=1.6590 pcon=4.7298 forget=0.0000 orth=0.0944 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 210 total=6.4328 mle=1.6087 pcon=4.7298 forget=0.0000 orth=0.0943 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 260 total=6.3744 mle=1.5503 pcon=4.7299 forget=0.0000 orth=0.0943 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 310 total=6.4892 mle=1.6649 pcon=4.7300 forget=0.0000 orth=0.0942 favg=0.0000 nr=108 nf=0 protos=None fproto_sim=NA
[loss] ep 40 it 360 total=6.5016 mle=1.6775 pcon=4.7299 forget=0.0000 orth=0.0942 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 41 it 19 total=6.4302 mle=1.6063 pcon=4.7298 forget=0.0000 orth=0.0941 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 69 total=6.3933 mle=1.5695 pcon=4.7298 forget=0.0000 orth=0.0941 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 119 total=6.5217 mle=1.6981 pcon=4.7296 forget=0.0000 orth=0.0940 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 169 total=6.4148 mle=1.5913 pcon=4.7296 forget=0.0000 orth=0.0940 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 219 total=6.3608 mle=1.5374 pcon=4.7294 forget=0.0000 orth=0.0939 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 269 total=6.3708 mle=1.5476 pcon=4.7294 forget=0.0000 orth=0.0939 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 319 total=6.5126 mle=1.6892 pcon=4.7295 forget=0.0000 orth=0.0938 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 41 it 369 total=6.4347 mle=1.6115 pcon=4.7294 forget=0.0000 orth=0.0938 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 28 total=6.3914 mle=1.5684 pcon=4.7292 forget=0.0000 orth=0.0937 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 78 total=6.5172 mle=1.6943 pcon=4.7291 forget=0.0000 orth=0.0937 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 128 total=6.3726 mle=1.5499 pcon=4.7290 forget=0.0000 orth=0.0937 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 178 total=6.3678 mle=1.5454 pcon=4.7288 forget=0.0000 orth=0.0936 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 228 total=6.3168 mle=1.4945 pcon=4.7288 forget=0.0000 orth=0.0936 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 278 total=6.4313 mle=1.6092 pcon=4.7286 forget=0.0000 orth=0.0936 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 328 total=6.4045 mle=1.5824 pcon=4.7286 forget=0.0000 orth=0.0935 favg=0.0000 nr=111 nf=0 protos=None fproto_sim=NA
[loss] ep 42 it 378 total=6.4921 mle=1.6702 pcon=4.7284 forget=0.0000 orth=0.0935 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 37 total=6.3773 mle=1.5554 pcon=4.7284 forget=0.0000 orth=0.0935 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 87 total=6.4011 mle=1.5794 pcon=4.7283 forget=0.0000 orth=0.0934 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 137 total=6.4326 mle=1.6109 pcon=4.7283 forget=0.0000 orth=0.0934 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 187 total=6.4209 mle=1.5993 pcon=4.7283 forget=0.0000 orth=0.0934 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 237 total=6.3758 mle=1.5541 pcon=4.7284 forget=0.0000 orth=0.0933 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 287 total=6.4353 mle=1.6136 pcon=4.7283 forget=0.0000 orth=0.0933 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 337 total=6.4104 mle=1.5887 pcon=4.7285 forget=0.0000 orth=0.0933 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 43 it 387 total=6.4146 mle=1.5929 pcon=4.7284 forget=0.0000 orth=0.0933 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 46 total=6.3451 mle=1.5236 pcon=4.7282 forget=0.0000 orth=0.0932 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 96 total=6.3153 mle=1.4936 pcon=4.7284 forget=0.0000 orth=0.0932 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 146 total=6.5102 mle=1.6886 pcon=4.7284 forget=0.0000 orth=0.0932 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 196 total=6.4076 mle=1.5862 pcon=4.7282 forget=0.0000 orth=0.0932 favg=0.0000 nr=99 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 246 total=6.3311 mle=1.5098 pcon=4.7282 forget=0.0000 orth=0.0932 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 296 total=6.4250 mle=1.6037 pcon=4.7281 forget=0.0000 orth=0.0931 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 44 it 346 total=6.4093 mle=1.5878 pcon=4.7284 forget=0.0000 orth=0.0931 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[loss] ep 45 it 5 total=6.4432 mle=1.6217 pcon=4.7285 forget=0.0000 orth=0.0931 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 55 total=6.3618 mle=1.5402 pcon=4.7285 forget=0.0000 orth=0.0931 favg=0.0000 nr=122 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 105 total=6.3730 mle=1.5512 pcon=4.7287 forget=0.0000 orth=0.0931 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 155 total=6.3568 mle=1.5349 pcon=4.7289 forget=0.0000 orth=0.0931 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 205 total=6.5276 mle=1.7059 pcon=4.7287 forget=0.0000 orth=0.0930 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 255 total=6.4028 mle=1.5811 pcon=4.7286 forget=0.0000 orth=0.0930 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 305 total=6.3500 mle=1.5284 pcon=4.7285 forget=0.0000 orth=0.0930 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 45 it 355 total=6.3293 mle=1.5078 pcon=4.7285 forget=0.0000 orth=0.0930 favg=0.0000 nr=115 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 14 total=6.5256 mle=1.7040 pcon=4.7285 forget=0.0000 orth=0.0930 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 64 total=6.3784 mle=1.5569 pcon=4.7285 forget=0.0000 orth=0.0930 favg=0.0000 nr=110 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 114 total=6.5098 mle=1.6883 pcon=4.7285 forget=0.0000 orth=0.0930 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 164 total=6.3788 mle=1.5573 pcon=4.7285 forget=0.0000 orth=0.0930 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 214 total=6.4552 mle=1.6337 pcon=4.7285 forget=0.0000 orth=0.0930 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 264 total=6.3556 mle=1.5342 pcon=4.7285 forget=0.0000 orth=0.0929 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 314 total=6.4057 mle=1.5843 pcon=4.7284 forget=0.0000 orth=0.0929 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 46 it 364 total=6.3956 mle=1.5743 pcon=4.7284 forget=0.0000 orth=0.0929 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
 96%|█████████▌| 48/50 [12:36<00:30, 15.40s/it] 98%|█████████▊| 49/50 [12:51<00:15, 15.05s/it]100%|██████████| 50/50 [13:05<00:00, 14.72s/it]100%|██████████| 50/50 [13:05<00:00, 15.70s/it]
[loss] ep 47 it 23 total=6.4768 mle=1.6554 pcon=4.7285 forget=0.0000 orth=0.0929 favg=0.0000 nr=112 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 73 total=6.5671 mle=1.7457 pcon=4.7285 forget=0.0000 orth=0.0929 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 123 total=6.3604 mle=1.5388 pcon=4.7286 forget=0.0000 orth=0.0929 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 173 total=6.3816 mle=1.5601 pcon=4.7285 forget=0.0000 orth=0.0929 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 223 total=6.3573 mle=1.5359 pcon=4.7285 forget=0.0000 orth=0.0929 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 273 total=6.4425 mle=1.6209 pcon=4.7286 forget=0.0000 orth=0.0929 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 323 total=6.3919 mle=1.5703 pcon=4.7287 forget=0.0000 orth=0.0929 favg=0.0000 nr=113 nf=0 protos=None fproto_sim=NA
[loss] ep 47 it 373 total=6.3653 mle=1.5437 pcon=4.7286 forget=0.0000 orth=0.0929 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 32 total=6.4212 mle=1.5997 pcon=4.7286 forget=0.0000 orth=0.0929 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 82 total=6.5307 mle=1.7092 pcon=4.7286 forget=0.0000 orth=0.0929 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 132 total=6.3708 mle=1.5493 pcon=4.7287 forget=0.0000 orth=0.0929 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 182 total=6.3880 mle=1.5664 pcon=4.7287 forget=0.0000 orth=0.0929 favg=0.0000 nr=116 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 232 total=6.4436 mle=1.6219 pcon=4.7288 forget=0.0000 orth=0.0929 favg=0.0000 nr=119 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 282 total=6.4266 mle=1.6050 pcon=4.7287 forget=0.0000 orth=0.0929 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 332 total=6.3962 mle=1.5746 pcon=4.7287 forget=0.0000 orth=0.0929 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 48 it 382 total=6.3223 mle=1.5007 pcon=4.7288 forget=0.0000 orth=0.0929 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 41 total=6.5052 mle=1.6837 pcon=4.7286 forget=0.0000 orth=0.0929 favg=0.0000 nr=117 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 91 total=6.5103 mle=1.6888 pcon=4.7287 forget=0.0000 orth=0.0929 favg=0.0000 nr=118 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 141 total=6.3406 mle=1.5191 pcon=4.7286 forget=0.0000 orth=0.0929 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 191 total=6.4325 mle=1.6110 pcon=4.7287 forget=0.0000 orth=0.0929 favg=0.0000 nr=120 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 241 total=6.4000 mle=1.5786 pcon=4.7285 forget=0.0000 orth=0.0929 favg=0.0000 nr=114 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 291 total=6.4737 mle=1.6523 pcon=4.7285 forget=0.0000 orth=0.0929 favg=0.0000 nr=105 nf=0 protos=None fproto_sim=NA
[loss] ep 49 it 341 total=6.4006 mle=1.5790 pcon=4.7287 forget=0.0000 orth=0.0929 favg=0.0000 nr=121 nf=0 protos=None fproto_sim=NA
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc1-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:04,  2.12it/s]  2%|▏         | 8/391 [00:00<00:21, 17.64it/s]  4%|▍         | 16/391 [00:00<00:11, 32.78it/s]  6%|▌         | 24/391 [00:00<00:08, 43.40it/s]  8%|▊         | 32/391 [00:00<00:06, 52.68it/s] 10%|█         | 40/391 [00:01<00:05, 59.29it/s] 12%|█▏        | 48/391 [00:01<00:05, 63.01it/s] 14%|█▍        | 56/391 [00:01<00:04, 67.10it/s] 16%|█▋        | 64/391 [00:01<00:04, 68.96it/s] 18%|█▊        | 72/391 [00:01<00:04, 70.43it/s] 20%|██        | 80/391 [00:01<00:04, 67.66it/s] 22%|██▏       | 87/391 [00:01<00:04, 63.56it/s] 24%|██▍       | 94/391 [00:01<00:04, 61.53it/s] 26%|██▌       | 101/391 [00:01<00:04, 63.38it/s] 28%|██▊       | 109/391 [00:02<00:04, 65.31it/s] 30%|██▉       | 117/391 [00:02<00:04, 68.42it/s] 32%|███▏      | 125/391 [00:02<00:03, 70.75it/s] 34%|███▍      | 133/391 [00:02<00:03, 70.67it/s] 36%|███▌      | 141/391 [00:02<00:03, 72.81it/s] 38%|███▊      | 149/391 [00:02<00:03, 73.80it/s] 40%|████      | 157/391 [00:02<00:03, 72.96it/s] 42%|████▏     | 165/391 [00:02<00:03, 74.21it/s] 44%|████▍     | 173/391 [00:02<00:02, 73.11it/s] 46%|████▋     | 181/391 [00:02<00:02, 74.59it/s] 48%|████▊     | 189/391 [00:03<00:02, 74.56it/s] 50%|█████     | 197/391 [00:03<00:02, 74.19it/s] 52%|█████▏    | 205/391 [00:03<00:02, 74.89it/s] 54%|█████▍    | 213/391 [00:03<00:02, 73.84it/s] 57%|█████▋    | 221/391 [00:03<00:02, 75.05it/s] 59%|█████▊    | 229/391 [00:03<00:02, 75.40it/s] 61%|██████    | 237/391 [00:03<00:02, 74.24it/s] 63%|██████▎   | 245/391 [00:03<00:01, 75.33it/s] 65%|██████▍   | 253/391 [00:03<00:01, 75.01it/s] 67%|██████▋   | 261/391 [00:04<00:01, 74.45it/s] 69%|██████▉   | 269/391 [00:04<00:01, 75.49it/s] 71%|███████   | 277/391 [00:04<00:01, 73.72it/s] 73%|███████▎  | 285/391 [00:04<00:01, 74.96it/s] 75%|███████▍  | 293/391 [00:04<00:01, 75.46it/s] 77%|███████▋  | 301/391 [00:04<00:01, 74.25it/s] 79%|███████▉  | 309/391 [00:04<00:01, 75.36it/s] 81%|████████  | 317/391 [00:04<00:00, 75.12it/s] 83%|████████▎ | 325/391 [00:04<00:00, 74.63it/s] 85%|████████▌ | 333/391 [00:05<00:00, 75.76it/s] 87%|████████▋ | 341/391 [00:05<00:00, 74.00it/s] 89%|████████▉ | 349/391 [00:05<00:00, 75.20it/s] 91%|█████████▏| 357/391 [00:05<00:00, 73.57it/s] 93%|█████████▎| 365/391 [00:05<00:00, 74.45it/s] 95%|█████████▌| 373/391 [00:05<00:00, 75.21it/s] 97%|█████████▋| 381/391 [00:05<00:00, 74.29it/s] 99%|█████████▉| 389/391 [00:05<00:00, 75.42it/s]100%|██████████| 391/391 [00:05<00:00, 67.36it/s]
50000 images processed, 5.912051200866699 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.22it/s] 11%|█▏        | 9/79 [00:00<00:03, 20.32it/s] 20%|██        | 16/79 [00:00<00:01, 32.47it/s] 30%|███       | 24/79 [00:00<00:01, 44.26it/s] 39%|███▉      | 31/79 [00:00<00:00, 50.33it/s] 49%|████▉     | 39/79 [00:00<00:00, 57.46it/s] 58%|█████▊    | 46/79 [00:01<00:00, 60.36it/s] 68%|██████▊   | 54/79 [00:01<00:00, 64.78it/s] 78%|███████▊  | 62/79 [00:01<00:00, 66.16it/s] 89%|████████▊ | 70/79 [00:01<00:00, 69.20it/s] 99%|█████████▊| 78/79 [00:01<00:00, 71.35it/s]100%|██████████| 79/79 [00:01<00:00, 51.27it/s]
10000 images processed, 1.5634639263153076 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc1-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:41,  2.01it/s]  4%|▍         | 8/204 [00:00<00:11, 16.93it/s]  8%|▊         | 16/204 [00:00<00:05, 31.37it/s] 12%|█▏        | 24/204 [00:00<00:04, 43.00it/s] 16%|█▌        | 32/204 [00:00<00:03, 52.16it/s] 20%|█▉        | 40/204 [00:01<00:02, 57.68it/s] 24%|██▎       | 48/204 [00:01<00:02, 62.66it/s] 27%|██▋       | 56/204 [00:01<00:02, 66.13it/s] 31%|███▏      | 64/204 [00:01<00:02, 67.34it/s] 35%|███▌      | 72/204 [00:01<00:01, 67.96it/s] 39%|███▉      | 80/204 [00:01<00:01, 70.31it/s] 43%|████▎     | 88/204 [00:01<00:01, 70.14it/s] 47%|████▋     | 96/204 [00:01<00:01, 70.29it/s] 51%|█████     | 104/204 [00:01<00:01, 71.50it/s] 55%|█████▍    | 112/204 [00:02<00:01, 70.75it/s] 59%|█████▉    | 120/204 [00:02<00:01, 71.83it/s] 63%|██████▎   | 128/204 [00:02<00:01, 71.31it/s] 67%|██████▋   | 136/204 [00:02<00:00, 68.80it/s] 70%|███████   | 143/204 [00:02<00:00, 65.88it/s] 74%|███████▍  | 151/204 [00:02<00:00, 66.84it/s] 78%|███████▊  | 159/204 [00:02<00:00, 69.53it/s] 81%|████████▏ | 166/204 [00:02<00:00, 69.39it/s] 85%|████████▌ | 174/204 [00:02<00:00, 71.07it/s] 89%|████████▉ | 182/204 [00:03<00:00, 70.65it/s] 93%|█████████▎| 190/204 [00:03<00:00, 72.55it/s] 97%|█████████▋| 198/204 [00:03<00:00, 73.18it/s]100%|██████████| 204/204 [00:03<00:00, 61.22it/s]
26032 images processed, 3.3689184188842773 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:49,  1.59it/s] 11%|█▏        | 9/79 [00:00<00:04, 15.73it/s] 20%|██        | 16/79 [00:00<00:02, 26.57it/s] 30%|███       | 24/79 [00:00<00:01, 37.04it/s] 41%|████      | 32/79 [00:01<00:01, 46.63it/s] 49%|████▉     | 39/79 [00:01<00:00, 52.00it/s] 59%|█████▉    | 47/79 [00:01<00:00, 58.08it/s] 68%|██████▊   | 54/79 [00:01<00:00, 60.81it/s] 78%|███████▊  | 62/79 [00:01<00:00, 64.72it/s] 89%|████████▊ | 70/79 [00:01<00:00, 67.10it/s] 99%|█████████▊| 78/79 [00:01<00:00, 69.63it/s]100%|██████████| 79/79 [00:01<00:00, 46.09it/s]
10000 images processed, 1.7488679885864258 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.20it/s] 14%|█▍        | 11/79 [00:00<00:02, 25.15it/s] 25%|██▌       | 20/79 [00:00<00:01, 40.16it/s] 34%|███▍      | 27/79 [00:00<00:01, 47.67it/s] 44%|████▍     | 35/79 [00:00<00:00, 55.51it/s] 54%|█████▍    | 43/79 [00:00<00:00, 60.93it/s] 65%|██████▍   | 51/79 [00:01<00:00, 63.78it/s] 75%|███████▍  | 59/79 [00:01<00:00, 66.03it/s] 85%|████████▍ | 67/79 [00:01<00:00, 68.81it/s] 95%|█████████▍| 75/79 [00:01<00:00, 70.93it/s]100%|██████████| 79/79 [00:01<00:00, 53.63it/s]
10000 images processed, 1.4953913688659668 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.91it/s] 13%|█▎        | 9/70 [00:00<00:03, 18.21it/s] 23%|██▎       | 16/70 [00:00<00:01, 30.00it/s] 34%|███▍      | 24/70 [00:00<00:01, 41.58it/s] 46%|████▌     | 32/70 [00:00<00:00, 49.54it/s] 57%|█████▋    | 40/70 [00:01<00:00, 56.81it/s] 69%|██████▊   | 48/70 [00:01<00:00, 60.67it/s] 80%|████████  | 56/70 [00:01<00:00, 65.37it/s] 91%|█████████▏| 64/70 [00:01<00:00, 67.25it/s]100%|██████████| 70/70 [00:01<00:00, 47.48it/s]
8925 images processed, 1.50522780418396 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:40,  1.09it/s]  4%|▍         | 2/45 [00:01<00:20,  2.10it/s] 22%|██▏       | 10/45 [00:01<00:02, 13.59it/s] 38%|███▊      | 17/45 [00:01<00:01, 20.59it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.24it/s] 56%|█████▌    | 25/45 [00:01<00:00, 22.45it/s] 73%|███████▎  | 33/45 [00:01<00:00, 25.36it/s] 80%|████████  | 36/45 [00:02<00:00, 25.06it/s] 98%|█████████▊| 44/45 [00:02<00:00, 34.53it/s]100%|██████████| 45/45 [00:02<00:00, 20.31it/s]
5640 images processed, 2.2386603355407715 seconds used

19.51913833618164
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.19  99.05  97.18
places365     69.29  80.82  79.50
LSUN          26.19  94.79  94.82
iSUN          77.55  78.75  81.90
dtd           40.89  90.75  94.17
AVG           43.62  88.83  89.51
Retain-Acc: 0.7464
Forget-as-OOD (retain known vs forget novel):
  FPR: 44.20 AUROC: 89.23 AUIN: 99.27
7.392128944396973
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc1-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc1-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc2-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:01<07:57,  1.22s/it]  3%|▎         | 10/391 [00:01<00:37, 10.09it/s]  5%|▌         | 20/391 [00:01<00:17, 21.44it/s]  8%|▊         | 30/391 [00:01<00:10, 33.16it/s] 10%|█         | 40/391 [00:01<00:07, 44.83it/s] 13%|█▎        | 50/391 [00:01<00:06, 55.53it/s] 15%|█▌        | 60/391 [00:01<00:05, 64.85it/s] 18%|█▊        | 70/391 [00:01<00:04, 72.35it/s] 20%|██        | 80/391 [00:02<00:03, 78.50it/s] 23%|██▎       | 90/391 [00:02<00:03, 83.33it/s] 26%|██▌       | 100/391 [00:02<00:03, 86.62it/s] 28%|██▊       | 110/391 [00:02<00:03, 89.17it/s] 31%|███       | 120/391 [00:02<00:02, 91.24it/s] 33%|███▎      | 130/391 [00:02<00:02, 92.66it/s] 36%|███▌      | 140/391 [00:02<00:02, 93.76it/s] 38%|███▊      | 150/391 [00:02<00:02, 94.44it/s] 41%|████      | 160/391 [00:02<00:02, 94.79it/s] 43%|████▎     | 170/391 [00:03<00:02, 94.98it/s] 46%|████▌     | 180/391 [00:03<00:02, 95.15it/s] 49%|████▊     | 190/391 [00:03<00:02, 95.50it/s] 51%|█████     | 200/391 [00:03<00:02, 95.49it/s] 54%|█████▎    | 210/391 [00:03<00:01, 95.76it/s] 56%|█████▋    | 220/391 [00:03<00:01, 95.95it/s] 59%|█████▉    | 230/391 [00:03<00:01, 95.93it/s] 61%|██████▏   | 240/391 [00:03<00:01, 95.30it/s] 64%|██████▍   | 250/391 [00:03<00:01, 95.45it/s] 66%|██████▋   | 260/391 [00:03<00:01, 95.61it/s] 69%|██████▉   | 270/391 [00:04<00:01, 95.59it/s] 72%|███████▏  | 280/391 [00:04<00:01, 95.67it/s] 74%|███████▍  | 290/391 [00:04<00:01, 95.01it/s] 77%|███████▋  | 300/391 [00:04<00:00, 95.39it/s] 79%|███████▉  | 310/391 [00:04<00:00, 95.21it/s] 82%|████████▏ | 320/391 [00:04<00:00, 95.36it/s] 84%|████████▍ | 330/391 [00:04<00:00, 95.59it/s] 87%|████████▋ | 340/391 [00:04<00:00, 95.73it/s] 90%|████████▉ | 350/391 [00:04<00:00, 95.56it/s] 92%|█████████▏| 360/391 [00:04<00:00, 94.98it/s] 95%|█████████▍| 370/391 [00:05<00:00, 95.81it/s] 97%|█████████▋| 380/391 [00:05<00:00, 96.41it/s]100%|█████████▉| 390/391 [00:05<00:00, 96.89it/s]100%|██████████| 391/391 [00:05<00:00, 73.47it/s]
50000 images processed, 5.407688617706299 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:28,  2.77it/s] 11%|█▏        | 9/79 [00:00<00:02, 24.25it/s] 22%|██▏       | 17/79 [00:00<00:01, 40.12it/s] 34%|███▍      | 27/79 [00:00<00:00, 55.84it/s] 47%|████▋     | 37/79 [00:00<00:00, 66.62it/s] 59%|█████▉    | 47/79 [00:00<00:00, 74.16it/s] 72%|███████▏  | 57/79 [00:01<00:00, 80.01it/s] 85%|████████▍ | 67/79 [00:01<00:00, 84.19it/s] 97%|█████████▋| 77/79 [00:01<00:00, 87.13it/s]100%|██████████| 79/79 [00:02<00:00, 34.07it/s]
10000 images processed, 2.358611583709717 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc2-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:38,  2.06it/s]  5%|▍         | 10/204 [00:00<00:08, 21.93it/s] 10%|▉         | 20/204 [00:00<00:04, 40.10it/s] 15%|█▍        | 30/204 [00:00<00:03, 54.09it/s] 19%|█▉        | 39/204 [00:00<00:02, 62.97it/s] 24%|██▎       | 48/204 [00:01<00:02, 70.17it/s] 28%|██▊       | 57/204 [00:01<00:01, 75.64it/s] 33%|███▎      | 67/204 [00:01<00:01, 80.51it/s] 37%|███▋      | 76/204 [00:01<00:01, 82.86it/s] 42%|████▏     | 85/204 [00:01<00:01, 81.59it/s] 46%|████▌     | 94/204 [00:01<00:01, 83.21it/s] 51%|█████     | 104/204 [00:01<00:01, 86.23it/s] 56%|█████▌    | 114/204 [00:01<00:01, 88.83it/s] 61%|██████    | 124/204 [00:01<00:00, 88.71it/s] 65%|██████▌   | 133/204 [00:01<00:00, 89.02it/s] 70%|███████   | 143/204 [00:02<00:00, 90.71it/s] 75%|███████▌  | 153/204 [00:02<00:00, 92.15it/s] 80%|███████▉  | 163/204 [00:02<00:00, 92.94it/s] 85%|████████▍ | 173/204 [00:02<00:00, 93.51it/s] 90%|████████▉ | 183/204 [00:02<00:00, 94.56it/s] 95%|█████████▍| 193/204 [00:02<00:00, 95.29it/s]100%|█████████▉| 203/204 [00:02<00:00, 95.81it/s]100%|██████████| 204/204 [00:02<00:00, 75.35it/s]
26032 images processed, 2.7461767196655273 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:44,  1.77it/s] 14%|█▍        | 11/79 [00:00<00:03, 21.11it/s] 27%|██▋       | 21/79 [00:00<00:01, 37.60it/s] 37%|███▋      | 29/79 [00:00<00:01, 44.94it/s] 47%|████▋     | 37/79 [00:01<00:00, 51.70it/s] 59%|█████▉    | 47/79 [00:01<00:00, 62.34it/s] 72%|███████▏  | 57/79 [00:01<00:00, 70.83it/s] 85%|████████▍ | 67/79 [00:01<00:00, 77.90it/s] 97%|█████████▋| 77/79 [00:01<00:00, 83.27it/s]100%|██████████| 79/79 [00:01<00:00, 54.06it/s]
10000 images processed, 1.4917991161346436 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.31it/s] 13%|█▎        | 10/79 [00:00<00:02, 24.07it/s] 25%|██▌       | 20/79 [00:00<00:01, 43.02it/s] 38%|███▊      | 30/79 [00:00<00:00, 57.14it/s] 51%|█████     | 40/79 [00:00<00:00, 67.43it/s] 63%|██████▎   | 50/79 [00:00<00:00, 75.18it/s] 76%|███████▌  | 60/79 [00:01<00:00, 81.40it/s] 89%|████████▊ | 70/79 [00:01<00:00, 85.93it/s]100%|██████████| 79/79 [00:01<00:00, 63.01it/s]
10000 images processed, 1.2731094360351562 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:36,  1.87it/s] 14%|█▍        | 10/70 [00:00<00:02, 20.29it/s] 29%|██▊       | 20/70 [00:00<00:01, 37.71it/s] 43%|████▎     | 30/70 [00:00<00:00, 51.59it/s] 57%|█████▋    | 40/70 [00:00<00:00, 62.56it/s] 71%|███████▏  | 50/70 [00:01<00:00, 71.51it/s] 86%|████████▌ | 60/70 [00:01<00:00, 78.56it/s]100%|██████████| 70/70 [00:01<00:00, 83.02it/s]100%|██████████| 70/70 [00:01<00:00, 54.61it/s]
8925 images processed, 1.311169147491455 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:37,  1.18it/s]  4%|▍         | 2/45 [00:01<00:19,  2.25it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.63it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.82it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.82it/s] 58%|█████▊    | 26/45 [00:01<00:00, 26.88it/s] 73%|███████▎  | 33/45 [00:01<00:00, 23.38it/s] 82%|████████▏ | 37/45 [00:02<00:00, 24.94it/s]100%|██████████| 45/45 [00:02<00:00, 21.05it/s]
5640 images processed, 2.1606850624084473 seconds used

18.37905526161194
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.21  99.06  97.20
places365     69.00  81.26  79.96
LSUN          22.39  95.71  95.77
iSUN          77.57  79.10  82.17
dtd           40.60  90.90  94.26
AVG           42.76  89.20  89.87
Retain-Acc: 0.7444
Forget-as-OOD (retain known vs forget novel):
  FPR: 45.40 AUROC: 91.55 AUIN: 99.49
7.443129777908325
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc2-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc2-forget_rf.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc3-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:24,  1.90it/s]  3%|▎         | 11/391 [00:00<00:16, 22.41it/s]  5%|▌         | 21/391 [00:00<00:09, 39.42it/s]  8%|▊         | 31/391 [00:00<00:06, 53.31it/s] 10%|█         | 41/391 [00:00<00:05, 64.08it/s] 13%|█▎        | 50/391 [00:01<00:04, 70.42it/s] 15%|█▌        | 60/391 [00:01<00:04, 77.03it/s] 18%|█▊        | 70/391 [00:01<00:03, 81.72it/s] 20%|██        | 80/391 [00:01<00:03, 85.64it/s] 23%|██▎       | 90/391 [00:01<00:03, 88.73it/s] 26%|██▌       | 100/391 [00:01<00:03, 90.94it/s] 28%|██▊       | 110/391 [00:01<00:03, 92.51it/s] 31%|███       | 120/391 [00:01<00:02, 93.40it/s] 33%|███▎      | 130/391 [00:01<00:02, 94.30it/s] 36%|███▌      | 140/391 [00:02<00:02, 94.87it/s] 38%|███▊      | 150/391 [00:02<00:02, 95.24it/s] 41%|████      | 160/391 [00:02<00:02, 95.03it/s] 43%|████▎     | 170/391 [00:02<00:02, 95.44it/s] 46%|████▌     | 180/391 [00:02<00:02, 95.24it/s] 49%|████▊     | 190/391 [00:02<00:02, 94.90it/s] 51%|█████     | 200/391 [00:02<00:02, 95.40it/s] 54%|█████▎    | 210/391 [00:02<00:01, 95.76it/s] 56%|█████▋    | 220/391 [00:02<00:01, 95.87it/s] 59%|█████▉    | 230/391 [00:02<00:01, 95.99it/s] 61%|██████▏   | 240/391 [00:03<00:01, 96.10it/s] 64%|██████▍   | 250/391 [00:03<00:01, 95.99it/s] 66%|██████▋   | 260/391 [00:03<00:01, 96.13it/s] 69%|██████▉   | 270/391 [00:03<00:01, 96.38it/s] 72%|███████▏  | 280/391 [00:03<00:01, 96.51it/s] 74%|███████▍  | 290/391 [00:03<00:01, 96.52it/s] 77%|███████▋  | 300/391 [00:03<00:00, 96.29it/s] 79%|███████▉  | 310/391 [00:03<00:00, 96.29it/s] 82%|████████▏ | 320/391 [00:03<00:00, 96.40it/s] 84%|████████▍ | 330/391 [00:03<00:00, 96.43it/s] 87%|████████▋ | 340/391 [00:04<00:00, 96.59it/s] 90%|████████▉ | 350/391 [00:04<00:00, 96.71it/s] 92%|█████████▏| 360/391 [00:04<00:00, 96.12it/s] 95%|█████████▍| 370/391 [00:04<00:00, 96.45it/s] 97%|█████████▋| 380/391 [00:04<00:00, 96.92it/s]100%|█████████▉| 390/391 [00:04<00:00, 96.60it/s]100%|██████████| 391/391 [00:04<00:00, 84.61it/s]
50000 images processed, 4.73514461517334 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:34,  2.29it/s] 13%|█▎        | 10/79 [00:00<00:02, 23.77it/s] 24%|██▍       | 19/79 [00:00<00:01, 40.25it/s] 35%|███▌      | 28/79 [00:00<00:00, 52.92it/s] 48%|████▊     | 38/79 [00:00<00:00, 64.21it/s] 59%|█████▉    | 47/79 [00:00<00:00, 71.33it/s] 72%|███████▏  | 57/79 [00:01<00:00, 77.97it/s] 85%|████████▍ | 67/79 [00:01<00:00, 82.80it/s] 97%|█████████▋| 77/79 [00:01<00:00, 86.19it/s]100%|██████████| 79/79 [00:02<00:00, 38.19it/s]
10000 images processed, 2.1120800971984863 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:38,  2.06it/s]  5%|▌         | 11/204 [00:00<00:08, 23.77it/s] 10%|▉         | 20/204 [00:00<00:04, 39.44it/s] 15%|█▍        | 30/204 [00:00<00:03, 53.68it/s] 20%|█▉        | 40/204 [00:00<00:02, 64.38it/s] 25%|██▍       | 50/204 [00:01<00:02, 72.31it/s] 29%|██▉       | 59/204 [00:01<00:01, 76.62it/s] 34%|███▍      | 69/204 [00:01<00:01, 80.94it/s] 39%|███▊      | 79/204 [00:01<00:01, 83.74it/s] 43%|████▎     | 88/204 [00:01<00:01, 85.09it/s] 48%|████▊     | 97/204 [00:01<00:01, 82.97it/s] 52%|█████▏    | 106/204 [00:01<00:01, 82.98it/s] 57%|█████▋    | 116/204 [00:01<00:01, 85.43it/s] 62%|██████▏   | 126/204 [00:01<00:00, 87.64it/s] 67%|██████▋   | 136/204 [00:01<00:00, 89.55it/s] 72%|███████▏  | 146/204 [00:02<00:00, 90.76it/s] 76%|███████▋  | 156/204 [00:02<00:00, 91.71it/s] 81%|████████▏ | 166/204 [00:02<00:00, 92.13it/s] 86%|████████▋ | 176/204 [00:02<00:00, 92.90it/s] 91%|█████████ | 186/204 [00:02<00:00, 94.03it/s] 96%|█████████▌| 196/204 [00:02<00:00, 94.84it/s]100%|██████████| 204/204 [00:02<00:00, 75.15it/s]
26032 images processed, 2.7551441192626953 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.62it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.79it/s] 27%|██▋       | 21/79 [00:00<00:01, 36.15it/s] 39%|███▉      | 31/79 [00:00<00:00, 50.01it/s] 52%|█████▏    | 41/79 [00:01<00:00, 61.26it/s] 65%|██████▍   | 51/79 [00:01<00:00, 70.04it/s] 77%|███████▋  | 61/79 [00:01<00:00, 76.91it/s] 90%|████████▉ | 71/79 [00:01<00:00, 82.34it/s]100%|██████████| 79/79 [00:01<00:00, 55.08it/s]
10000 images processed, 1.4689035415649414 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:36,  2.12it/s] 13%|█▎        | 10/79 [00:00<00:03, 22.44it/s] 24%|██▍       | 19/79 [00:00<00:01, 38.91it/s] 37%|███▋      | 29/79 [00:00<00:00, 53.69it/s] 49%|████▉     | 39/79 [00:00<00:00, 65.25it/s] 62%|██████▏   | 49/79 [00:00<00:00, 73.70it/s] 75%|███████▍  | 59/79 [00:01<00:00, 80.06it/s] 87%|████████▋ | 69/79 [00:01<00:00, 84.84it/s]100%|██████████| 79/79 [00:01<00:00, 60.84it/s]
10000 images processed, 1.318375587463379 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:33,  2.06it/s] 14%|█▍        | 10/70 [00:00<00:02, 21.77it/s] 27%|██▋       | 19/70 [00:00<00:01, 38.31it/s] 40%|████      | 28/70 [00:00<00:00, 51.40it/s] 53%|█████▎    | 37/70 [00:00<00:00, 60.72it/s] 67%|██████▋   | 47/70 [00:01<00:00, 70.47it/s] 81%|████████▏ | 57/70 [00:01<00:00, 78.02it/s] 96%|█████████▌| 67/70 [00:01<00:00, 83.50it/s]100%|██████████| 70/70 [00:01<00:00, 56.18it/s]
8925 images processed, 1.2802579402923584 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.05it/s]  4%|▍         | 2/45 [00:01<00:20,  2.12it/s] 27%|██▋       | 12/45 [00:01<00:01, 16.75it/s] 38%|███▊      | 17/45 [00:01<00:01, 18.74it/s] 47%|████▋     | 21/45 [00:01<00:01, 21.86it/s] 60%|██████    | 27/45 [00:01<00:00, 28.96it/s] 73%|███████▎  | 33/45 [00:02<00:00, 20.37it/s] 96%|█████████▌| 43/45 [00:02<00:00, 31.98it/s]100%|██████████| 45/45 [00:02<00:00, 20.37it/s]
5640 images processed, 2.23249888420105 seconds used

17.572556495666504
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.13  99.07  97.36
places365     68.87  80.86  80.30
LSUN          25.37  94.92  95.15
iSUN          77.39  78.87  82.64
dtd           40.25  90.79  94.45
AVG           43.20  88.90  89.98
Retain-Acc: 0.7425
7.655274152755737
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc3-forget_domain.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc4-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:23,  1.92it/s]  3%|▎         | 11/391 [00:00<00:16, 22.51it/s]  5%|▌         | 20/391 [00:00<00:09, 37.93it/s]  8%|▊         | 30/391 [00:00<00:06, 52.28it/s] 10%|█         | 40/391 [00:00<00:05, 63.94it/s] 13%|█▎        | 49/391 [00:01<00:04, 70.07it/s] 15%|█▌        | 59/391 [00:01<00:04, 76.99it/s] 18%|█▊        | 69/391 [00:01<00:03, 82.41it/s] 20%|██        | 79/391 [00:01<00:03, 86.32it/s] 23%|██▎       | 89/391 [00:01<00:03, 89.48it/s] 25%|██▌       | 99/391 [00:01<00:03, 91.28it/s] 28%|██▊       | 109/391 [00:01<00:03, 92.64it/s] 30%|███       | 119/391 [00:01<00:02, 93.58it/s] 33%|███▎      | 129/391 [00:01<00:02, 94.40it/s] 36%|███▌      | 139/391 [00:01<00:02, 95.07it/s] 38%|███▊      | 149/391 [00:02<00:02, 95.46it/s] 41%|████      | 159/391 [00:02<00:02, 95.25it/s] 43%|████▎     | 169/391 [00:02<00:02, 95.82it/s] 46%|████▌     | 179/391 [00:02<00:02, 95.11it/s] 48%|████▊     | 189/391 [00:02<00:02, 95.31it/s] 51%|█████     | 199/391 [00:02<00:02, 95.71it/s] 53%|█████▎    | 209/391 [00:02<00:01, 95.68it/s] 56%|█████▌    | 219/391 [00:02<00:01, 95.58it/s] 59%|█████▊    | 229/391 [00:02<00:01, 95.80it/s] 61%|██████    | 239/391 [00:03<00:01, 96.08it/s] 64%|██████▎   | 249/391 [00:03<00:01, 95.90it/s] 66%|██████▌   | 259/391 [00:03<00:01, 96.02it/s] 69%|██████▉   | 269/391 [00:03<00:01, 96.25it/s] 71%|███████▏  | 279/391 [00:03<00:01, 96.15it/s] 74%|███████▍  | 289/391 [00:03<00:01, 96.37it/s] 76%|███████▋  | 299/391 [00:03<00:00, 96.21it/s] 79%|███████▉  | 309/391 [00:03<00:00, 95.75it/s] 82%|████████▏ | 319/391 [00:03<00:00, 95.90it/s] 84%|████████▍ | 329/391 [00:03<00:00, 96.03it/s] 87%|████████▋ | 339/391 [00:04<00:00, 95.81it/s] 89%|████████▉ | 349/391 [00:04<00:00, 96.11it/s] 92%|█████████▏| 359/391 [00:04<00:00, 95.47it/s] 94%|█████████▍| 369/391 [00:04<00:00, 96.07it/s] 97%|█████████▋| 379/391 [00:04<00:00, 96.66it/s] 99%|█████████▉| 389/391 [00:04<00:00, 97.02it/s]100%|██████████| 391/391 [00:04<00:00, 84.65it/s]
50000 images processed, 4.712125062942505 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:32,  2.41it/s] 10%|█         | 8/79 [00:00<00:03, 19.69it/s] 23%|██▎       | 18/79 [00:00<00:01, 40.13it/s] 34%|███▍      | 27/79 [00:00<00:00, 53.07it/s] 46%|████▌     | 36/79 [00:00<00:00, 61.78it/s] 57%|█████▋    | 45/79 [00:00<00:00, 69.45it/s] 70%|██████▉   | 55/79 [00:01<00:00, 76.50it/s] 82%|████████▏ | 65/79 [00:01<00:00, 81.66it/s] 95%|█████████▍| 75/79 [00:01<00:00, 85.26it/s]100%|██████████| 79/79 [00:01<00:00, 50.68it/s]
10000 images processed, 1.6033804416656494 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:48,  1.87it/s]  5%|▍         | 10/204 [00:00<00:09, 20.05it/s] 10%|▉         | 20/204 [00:00<00:04, 37.79it/s] 14%|█▍        | 29/204 [00:00<00:03, 50.19it/s] 19%|█▉        | 39/204 [00:00<00:02, 62.05it/s] 24%|██▍       | 49/204 [00:01<00:02, 70.79it/s] 28%|██▊       | 58/204 [00:01<00:01, 75.92it/s] 33%|███▎      | 68/204 [00:01<00:01, 81.45it/s] 38%|███▊      | 78/204 [00:01<00:01, 85.26it/s] 43%|████▎     | 88/204 [00:01<00:01, 87.75it/s] 48%|████▊     | 98/204 [00:01<00:01, 89.69it/s] 53%|█████▎    | 108/204 [00:01<00:01, 90.98it/s] 58%|█████▊    | 118/204 [00:01<00:00, 91.66it/s] 63%|██████▎   | 128/204 [00:01<00:00, 92.50it/s] 68%|██████▊   | 138/204 [00:02<00:00, 92.71it/s] 73%|███████▎  | 148/204 [00:02<00:00, 93.22it/s] 77%|███████▋  | 158/204 [00:02<00:00, 93.50it/s] 82%|████████▏ | 168/204 [00:02<00:00, 93.29it/s] 87%|████████▋ | 178/204 [00:02<00:00, 93.71it/s] 92%|█████████▏| 188/204 [00:02<00:00, 94.68it/s] 97%|█████████▋| 198/204 [00:02<00:00, 95.40it/s]100%|██████████| 204/204 [00:02<00:00, 75.17it/s]
26032 images processed, 2.754204273223877 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:52,  1.50it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.69it/s] 22%|██▏       | 17/79 [00:00<00:02, 26.26it/s] 34%|███▍      | 27/79 [00:00<00:01, 41.80it/s] 47%|████▋     | 37/79 [00:01<00:00, 54.40it/s] 59%|█████▉    | 47/79 [00:01<00:00, 64.80it/s] 72%|███████▏  | 57/79 [00:01<00:00, 72.90it/s] 84%|████████▎ | 66/79 [00:01<00:00, 70.67it/s] 96%|█████████▌| 76/79 [00:01<00:00, 77.65it/s]100%|██████████| 79/79 [00:01<00:00, 50.21it/s]
10000 images processed, 1.608461618423462 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:38,  2.04it/s] 11%|█▏        | 9/79 [00:00<00:03, 19.47it/s] 24%|██▍       | 19/79 [00:00<00:01, 38.02it/s] 37%|███▋      | 29/79 [00:00<00:00, 52.55it/s] 49%|████▉     | 39/79 [00:00<00:00, 64.14it/s] 62%|██████▏   | 49/79 [00:01<00:00, 72.57it/s] 75%|███████▍  | 59/79 [00:01<00:00, 79.30it/s] 87%|████████▋ | 69/79 [00:01<00:00, 84.06it/s]100%|██████████| 79/79 [00:01<00:00, 59.48it/s]
10000 images processed, 1.3496663570404053 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:40,  1.70it/s] 11%|█▏        | 8/70 [00:00<00:04, 15.06it/s] 26%|██▌       | 18/70 [00:00<00:01, 33.18it/s] 40%|████      | 28/70 [00:00<00:00, 48.20it/s] 54%|█████▍    | 38/70 [00:01<00:00, 60.01it/s] 69%|██████▊   | 48/70 [00:01<00:00, 69.77it/s] 83%|████████▎ | 58/70 [00:01<00:00, 77.08it/s] 97%|█████████▋| 68/70 [00:01<00:00, 82.65it/s]100%|██████████| 70/70 [00:01<00:00, 52.18it/s]
8925 images processed, 1.372326374053955 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:42,  1.03it/s]  9%|▉         | 4/45 [00:01<00:08,  4.70it/s] 13%|█▎        | 6/45 [00:01<00:07,  5.26it/s] 36%|███▌      | 16/45 [00:01<00:01, 18.42it/s] 47%|████▋     | 21/45 [00:01<00:01, 19.76it/s] 56%|█████▌    | 25/45 [00:02<00:01, 14.59it/s] 78%|███████▊  | 35/45 [00:02<00:00, 25.47it/s] 89%|████████▉ | 40/45 [00:02<00:00, 18.19it/s]100%|██████████| 45/45 [00:02<00:00, 15.89it/s]
5640 images processed, 2.8533222675323486 seconds used

17.980132579803467
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.13  99.07  97.36
places365     68.87  80.86  80.30
LSUN          25.37  94.92  95.15
iSUN          77.39  78.87  82.64
dtd           40.25  90.79  94.45
AVG           43.20  88.90  89.98
Retain-Acc: 0.7425
7.7069313526153564
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-inc4-forget_domain.png
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stack/stage4
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-seen-forget: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:15,  1.99it/s]  3%|▎         | 10/391 [00:00<00:18, 21.12it/s]  5%|▌         | 20/391 [00:00<00:09, 39.13it/s]  8%|▊         | 30/391 [00:00<00:06, 53.24it/s] 10%|█         | 40/391 [00:00<00:05, 64.22it/s] 13%|█▎        | 50/391 [00:01<00:04, 72.81it/s] 15%|█▌        | 60/391 [00:01<00:04, 79.43it/s] 18%|█▊        | 70/391 [00:01<00:03, 84.41it/s] 20%|██        | 80/391 [00:01<00:03, 87.70it/s] 23%|██▎       | 90/391 [00:01<00:03, 90.08it/s] 26%|██▌       | 100/391 [00:01<00:03, 91.96it/s] 28%|██▊       | 110/391 [00:01<00:03, 93.19it/s] 31%|███       | 120/391 [00:01<00:02, 94.21it/s] 33%|███▎      | 130/391 [00:01<00:02, 93.40it/s] 36%|███▌      | 140/391 [00:01<00:02, 94.35it/s] 38%|███▊      | 150/391 [00:02<00:02, 94.81it/s] 41%|████      | 160/391 [00:02<00:02, 95.16it/s] 43%|████▎     | 170/391 [00:02<00:02, 95.43it/s] 46%|████▌     | 180/391 [00:02<00:02, 95.56it/s] 49%|████▊     | 190/391 [00:02<00:02, 95.71it/s] 51%|█████     | 200/391 [00:02<00:01, 95.85it/s] 54%|█████▎    | 210/391 [00:02<00:01, 94.48it/s] 56%|█████▋    | 220/391 [00:02<00:01, 94.89it/s] 59%|█████▉    | 230/391 [00:02<00:01, 95.27it/s] 61%|██████▏   | 240/391 [00:03<00:01, 95.47it/s] 64%|██████▍   | 250/391 [00:03<00:01, 95.09it/s] 66%|██████▋   | 260/391 [00:03<00:01, 95.32it/s] 69%|██████▉   | 270/391 [00:03<00:01, 94.75it/s] 72%|███████▏  | 280/391 [00:03<00:01, 94.85it/s] 74%|███████▍  | 290/391 [00:03<00:01, 95.21it/s] 77%|███████▋  | 300/391 [00:03<00:00, 95.35it/s] 79%|███████▉  | 310/391 [00:03<00:00, 95.47it/s] 82%|████████▏ | 320/391 [00:03<00:00, 95.39it/s] 84%|████████▍ | 330/391 [00:03<00:00, 95.47it/s] 87%|████████▋ | 340/391 [00:04<00:00, 95.83it/s] 90%|████████▉ | 350/391 [00:04<00:00, 95.35it/s] 92%|█████████▏| 360/391 [00:04<00:00, 94.37it/s] 95%|█████████▍| 370/391 [00:04<00:00, 95.32it/s] 97%|█████████▋| 380/391 [00:04<00:00, 95.96it/s]100%|█████████▉| 390/391 [00:04<00:00, 96.49it/s]100%|██████████| 391/391 [00:04<00:00, 84.74it/s]
50000 images processed, 4.70414662361145 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:34,  2.24it/s] 11%|█▏        | 9/79 [00:00<00:03, 20.67it/s] 23%|██▎       | 18/79 [00:00<00:01, 37.53it/s] 34%|███▍      | 27/79 [00:00<00:01, 50.79it/s] 46%|████▌     | 36/79 [00:00<00:00, 60.67it/s] 57%|█████▋    | 45/79 [00:00<00:00, 68.54it/s] 70%|██████▉   | 55/79 [00:01<00:00, 75.78it/s] 82%|████████▏ | 65/79 [00:01<00:00, 80.97it/s] 94%|█████████▎| 74/79 [00:01<00:00, 80.23it/s]100%|██████████| 79/79 [00:01<00:00, 40.72it/s]
10000 images processed, 2.005880832672119 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-seen-forget/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:38,  2.07it/s]  5%|▍         | 10/204 [00:00<00:08, 22.00it/s]  9%|▉         | 19/204 [00:00<00:04, 38.31it/s] 13%|█▎        | 27/204 [00:00<00:03, 47.78it/s] 17%|█▋        | 35/204 [00:00<00:03, 52.20it/s] 21%|██        | 43/204 [00:01<00:02, 57.69it/s] 25%|██▌       | 52/204 [00:01<00:02, 64.96it/s] 30%|███       | 62/204 [00:01<00:01, 73.48it/s] 35%|███▌      | 72/204 [00:01<00:01, 78.50it/s] 40%|████      | 82/204 [00:01<00:01, 83.25it/s] 45%|████▌     | 92/204 [00:01<00:01, 85.96it/s] 50%|█████     | 102/204 [00:01<00:01, 88.50it/s] 55%|█████▍    | 112/204 [00:01<00:01, 90.43it/s] 60%|█████▉    | 122/204 [00:01<00:00, 90.98it/s] 65%|██████▍   | 132/204 [00:02<00:00, 84.50it/s] 69%|██████▉   | 141/204 [00:02<00:00, 76.34it/s] 74%|███████▍  | 151/204 [00:02<00:00, 81.16it/s] 78%|███████▊  | 160/204 [00:02<00:00, 81.79it/s] 83%|████████▎ | 170/204 [00:02<00:00, 85.02it/s] 88%|████████▊ | 180/204 [00:02<00:00, 88.09it/s] 93%|█████████▎| 190/204 [00:02<00:00, 90.69it/s] 98%|█████████▊| 200/204 [00:02<00:00, 92.26it/s]100%|██████████| 204/204 [00:02<00:00, 71.37it/s]
26032 images processed, 2.903002977371216 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.73it/s] 14%|█▍        | 11/79 [00:00<00:03, 20.94it/s] 27%|██▋       | 21/79 [00:00<00:01, 37.78it/s] 38%|███▊      | 30/79 [00:00<00:00, 50.06it/s] 51%|█████     | 40/79 [00:01<00:00, 60.99it/s] 63%|██████▎   | 50/79 [00:01<00:00, 69.61it/s] 76%|███████▌  | 60/79 [00:01<00:00, 76.90it/s] 89%|████████▊ | 70/79 [00:01<00:00, 82.53it/s]100%|██████████| 79/79 [00:01<00:00, 56.34it/s]
10000 images processed, 1.4329054355621338 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:35,  2.18it/s] 13%|█▎        | 10/79 [00:00<00:02, 23.03it/s] 24%|██▍       | 19/79 [00:00<00:01, 39.05it/s] 37%|███▋      | 29/79 [00:00<00:00, 53.64it/s] 48%|████▊     | 38/79 [00:00<00:00, 62.62it/s] 61%|██████    | 48/79 [00:00<00:00, 71.11it/s] 73%|███████▎  | 58/79 [00:01<00:00, 78.24it/s] 86%|████████▌ | 68/79 [00:01<00:00, 83.62it/s] 99%|█████████▊| 78/79 [00:01<00:00, 87.39it/s]100%|██████████| 79/79 [00:01<00:00, 60.52it/s]
10000 images processed, 1.3273015022277832 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:33,  2.04it/s] 16%|█▌        | 11/70 [00:00<00:02, 23.75it/s] 30%|███       | 21/70 [00:00<00:01, 41.48it/s] 43%|████▎     | 30/70 [00:00<00:00, 53.46it/s] 57%|█████▋    | 40/70 [00:00<00:00, 64.94it/s] 71%|███████▏  | 50/70 [00:01<00:00, 73.86it/s] 86%|████████▌ | 60/70 [00:01<00:00, 80.42it/s]100%|██████████| 70/70 [00:01<00:00, 84.35it/s]100%|██████████| 70/70 [00:01<00:00, 57.19it/s]
8925 images processed, 1.2534875869750977 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:37,  1.16it/s]  4%|▍         | 2/45 [00:01<00:19,  2.25it/s] 27%|██▋       | 12/45 [00:01<00:01, 17.60it/s] 38%|███▊      | 17/45 [00:01<00:01, 20.02it/s] 47%|████▋     | 21/45 [00:01<00:01, 22.29it/s] 56%|█████▌    | 25/45 [00:01<00:00, 23.98it/s] 73%|███████▎  | 33/45 [00:01<00:00, 24.53it/s] 82%|████████▏ | 37/45 [00:02<00:00, 25.91it/s]100%|██████████| 45/45 [00:02<00:00, 21.22it/s]
5640 images processed, 2.142057418823242 seconds used

17.45428204536438
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.25  99.04  97.01
places365     68.92  81.24  79.11
LSUN          22.84  95.61  95.48
iSUN          77.36  78.99  81.39
dtd           40.60  90.87  93.97
AVG           42.79  89.15  89.39
Retain-Acc: 0.7484
Forget-as-OOD (retain known vs forget novel):
  FPR: 44.70 AUROC: 90.44 AUIN: 98.73
7.103228569030762
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-seen-forget_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmnone-fl0.2-lora_r8a32d0.05-temp0.08-ol1-continual-from-c90-to-CIFAR-100-forget-from-CIFAR-100-to-c90-stage4-seen-forget_rf.png
runner-incremental-continual-forget.sh: line 278: syntax error near unexpected token `fi'
