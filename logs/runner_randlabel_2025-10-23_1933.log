nohup: ignoring input
Disabling PyTorch because PyTorch >= 2.1 is required but found 2.0.1
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline_randlabel_forget.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=0.0, epsilon=0.05, incremental=False, use_lora=False, lora_impl='native', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='head', adapter_save_path=None, adapter_load_path=None, adapter_load_paths=None, lora_new_adapter_name=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, forget_classes='0,8,11,40,51,66,67,88,94,57', forget_list_path=None, forget_classes_inc=None, forget_classes_seen=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='randlabel', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
[debug] trainable_count = 112
[debug] trainable: encoder.conv1.weight
[debug] trainable: encoder.bn1.weight
[debug] trainable: encoder.bn1.bias
[debug] trainable: encoder.layer1.0.conv1.weight
[debug] trainable: encoder.layer1.0.bn1.weight
[debug] trainable: encoder.layer1.0.bn1.bias
[debug] trainable: encoder.layer1.0.conv2.weight
[debug] trainable: encoder.layer1.0.bn2.weight
[debug] trainable: encoder.layer1.0.bn2.bias
[debug] trainable: encoder.layer1.1.conv1.weight
[debug] trainable: encoder.layer1.1.bn1.weight
[debug] trainable: encoder.layer1.1.bn1.bias
[debug] trainable: encoder.layer1.1.conv2.weight
[debug] trainable: encoder.layer1.1.bn2.weight
[debug] trainable: encoder.layer1.1.bn2.bias
[debug] trainable: encoder.layer1.2.conv1.weight
[debug] trainable: encoder.layer1.2.bn1.weight
[debug] trainable: encoder.layer1.2.bn1.bias
[debug] trainable: encoder.layer1.2.conv2.weight
[debug] trainable: encoder.layer1.2.bn2.weight
[debug] trainable: encoder.layer1.2.bn2.bias
[debug] trainable: encoder.layer2.0.conv1.weight
[debug] trainable: encoder.layer2.0.bn1.weight
[debug] trainable: encoder.layer2.0.bn1.bias
[debug] trainable: encoder.layer2.0.conv2.weight
[debug] trainable: encoder.layer2.0.bn2.weight
[debug] trainable: encoder.layer2.0.bn2.bias
[debug] trainable: encoder.layer2.0.shortcut.0.weight
[debug] trainable: encoder.layer2.0.shortcut.1.weight
[debug] trainable: encoder.layer2.0.shortcut.1.bias
[debug] trainable: encoder.layer2.1.conv1.weight
[debug] trainable: encoder.layer2.1.bn1.weight
[debug] trainable: encoder.layer2.1.bn1.bias
[debug] trainable: encoder.layer2.1.conv2.weight
[debug] trainable: encoder.layer2.1.bn2.weight
[debug] trainable: encoder.layer2.1.bn2.bias
[debug] trainable: encoder.layer2.2.conv1.weight
[debug] trainable: encoder.layer2.2.bn1.weight
[debug] trainable: encoder.layer2.2.bn1.bias
[debug] trainable: encoder.layer2.2.conv2.weight
[debug] trainable: encoder.layer2.2.bn2.weight
[debug] trainable: encoder.layer2.2.bn2.bias
[debug] trainable: encoder.layer2.3.conv1.weight
[debug] trainable: encoder.layer2.3.bn1.weight
[debug] trainable: encoder.layer2.3.bn1.bias
[debug] trainable: encoder.layer2.3.conv2.weight
[debug] trainable: encoder.layer2.3.bn2.weight
[debug] trainable: encoder.layer2.3.bn2.bias
[debug] trainable: encoder.layer3.0.conv1.weight
[debug] trainable: encoder.layer3.0.bn1.weight
[debug][warn] non-LoRA trainables detected: ['encoder.conv1.weight', 'encoder.bn1.weight', 'encoder.bn1.bias', 'encoder.layer1.0.conv1.weight', 'encoder.layer1.0.bn1.weight', 'encoder.layer1.0.bn1.bias', 'encoder.layer1.0.conv2.weight', 'encoder.layer1.0.bn2.weight', 'encoder.layer1.0.bn2.bias', 'encoder.layer1.1.conv1.weight']
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:38<31:17, 38.31s/it]  4%|▍         | 2/50 [01:10<27:42, 34.64s/it]  6%|▌         | 3/50 [01:59<32:17, 41.23s/it]  8%|▊         | 4/50 [03:08<39:59, 52.16s/it] 10%|█         | 5/50 [04:27<46:24, 61.89s/it] 12%|█▏        | 6/50 [05:54<51:39, 70.45s/it] 14%|█▍        | 7/50 [07:29<56:17, 78.55s/it] 16%|█▌        | 8/50 [09:05<58:51, 84.09s/it] 18%|█▊        | 9/50 [10:39<59:32, 87.13s/it] 20%|██        | 10/50 [12:15<59:51, 89.79s/it] 22%|██▏       | 11/50 [13:47<58:56, 90.67s/it] 24%|██▍       | 12/50 [15:02<54:15, 85.67s/it] 26%|██▌       | 13/50 [15:48<45:25, 73.67s/it] 28%|██▊       | 14/50 [16:34<39:17, 65.50s/it] 30%|███       | 15/50 [17:22<34:59, 59.98s/it][loss-randlabel] ep 0 it 0 total=2.1744 ce_r=0.2464 ce_f=9.6403
[loss-randlabel] ep 0 it 50 total=2.1406 ce_r=0.2110 ce_f=9.6477
[loss-randlabel] ep 0 it 100 total=2.1672 ce_r=0.2421 ce_f=9.6254
[loss-randlabel] ep 0 it 150 total=2.1917 ce_r=0.3000 ce_f=9.4583
[loss-randlabel] ep 0 it 200 total=2.0155 ce_r=0.1273 ce_f=9.4412
[loss-randlabel] ep 0 it 250 total=2.0641 ce_r=0.1520 ce_f=9.5605
[loss-randlabel] ep 0 it 300 total=2.0526 ce_r=0.1846 ce_f=9.3401
[loss-randlabel] ep 0 it 350 total=1.9985 ce_r=0.1407 ce_f=9.2892
[loss-randlabel] ep 1 it 10 total=1.9053 ce_r=0.1930 ce_f=8.5619
[loss-randlabel] ep 1 it 60 total=1.9025 ce_r=0.0952 ce_f=9.0367
[loss-randlabel] ep 1 it 110 total=1.9584 ce_r=0.2244 ce_f=8.6700
[loss-randlabel] ep 1 it 160 total=1.7511 ce_r=0.1295 ce_f=8.1084
[loss-randlabel] ep 1 it 210 total=1.7541 ce_r=0.1415 ce_f=8.0626
[loss-randlabel] ep 1 it 260 total=1.7860 ce_r=0.1504 ce_f=8.1782
[loss-randlabel] ep 1 it 310 total=1.7117 ce_r=0.1653 ce_f=7.7320
[loss-randlabel] ep 1 it 360 total=1.7483 ce_r=0.2011 ce_f=7.7363
[loss-randlabel] ep 2 it 20 total=1.7885 ce_r=0.3024 ce_f=7.4305
[loss-randlabel] ep 2 it 70 total=1.7255 ce_r=0.1644 ce_f=7.8055
[loss-randlabel] ep 2 it 120 total=1.6495 ce_r=0.2194 ce_f=7.1506
[loss-randlabel] ep 2 it 170 total=1.7469 ce_r=0.3147 ce_f=7.1607
[loss-randlabel] ep 2 it 220 total=1.6067 ce_r=0.2136 ce_f=6.9657
[loss-randlabel] ep 2 it 270 total=1.7849 ce_r=0.3248 ce_f=7.3004
[loss-randlabel] ep 2 it 320 total=1.7418 ce_r=0.3170 ce_f=7.1241
[loss-randlabel] ep 2 it 370 total=1.6443 ce_r=0.2443 ce_f=6.9999
[loss-randlabel] ep 3 it 30 total=1.7093 ce_r=0.3083 ce_f=7.0051
[loss-randlabel] ep 3 it 80 total=1.6059 ce_r=0.1579 ce_f=7.2398
[loss-randlabel] ep 3 it 130 total=1.6653 ce_r=0.1519 ce_f=7.5666
[loss-randlabel] ep 3 it 180 total=1.6283 ce_r=0.1716 ce_f=7.2836
[loss-randlabel] ep 3 it 230 total=1.6146 ce_r=0.1811 ce_f=7.1673
[loss-randlabel] ep 3 it 280 total=1.5570 ce_r=0.1577 ce_f=6.9966
[loss-randlabel] ep 3 it 330 total=1.6725 ce_r=0.2752 ce_f=6.9864
[loss-randlabel] ep 3 it 380 total=1.5754 ce_r=0.2285 ce_f=6.7346
[loss-randlabel] ep 4 it 40 total=1.6610 ce_r=0.2317 ce_f=7.1465
[loss-randlabel] ep 4 it 90 total=1.6962 ce_r=0.3416 ce_f=6.7731
[loss-randlabel] ep 4 it 140 total=1.5824 ce_r=0.2141 ce_f=6.8416
[loss-randlabel] ep 4 it 190 total=1.5998 ce_r=0.2442 ce_f=6.7778
[loss-randlabel] ep 4 it 240 total=1.6227 ce_r=0.2746 ce_f=6.7406
[loss-randlabel] ep 4 it 290 total=1.5849 ce_r=0.2092 ce_f=6.8786
[loss-randlabel] ep 4 it 340 total=1.6817 ce_r=0.2990 ce_f=6.9133
[loss-randlabel] ep 5 it 0 total=1.6022 ce_r=0.2229 ce_f=6.8968
[loss-randlabel] ep 5 it 50 total=1.5575 ce_r=0.2411 ce_f=6.5817
[loss-randlabel] ep 5 it 100 total=1.5827 ce_r=0.2561 ce_f=6.6332
[loss-randlabel] ep 5 it 150 total=1.5346 ce_r=0.1918 ce_f=6.7139
[loss-randlabel] ep 5 it 200 total=1.5913 ce_r=0.2543 ce_f=6.6853
[loss-randlabel] ep 5 it 250 total=1.5635 ce_r=0.2324 ce_f=6.6555
[loss-randlabel] ep 5 it 300 total=1.5588 ce_r=0.2148 ce_f=6.7199
[loss-randlabel] ep 5 it 350 total=1.5598 ce_r=0.2101 ce_f=6.7486
[loss-randlabel] ep 6 it 10 total=1.5428 ce_r=0.2011 ce_f=6.7084
[loss-randlabel] ep 6 it 60 total=1.5457 ce_r=0.2454 ce_f=6.5013
[loss-randlabel] ep 6 it 110 total=1.5387 ce_r=0.1904 ce_f=6.7418
[loss-randlabel] ep 6 it 160 total=1.5542 ce_r=0.2310 ce_f=6.6156
[loss-randlabel] ep 6 it 210 total=1.5497 ce_r=0.1796 ce_f=6.8504
[loss-randlabel] ep 6 it 260 total=1.5565 ce_r=0.1712 ce_f=6.9263
[loss-randlabel] ep 6 it 310 total=1.5859 ce_r=0.3138 ce_f=6.3604
[loss-randlabel] ep 6 it 360 total=1.5027 ce_r=0.1785 ce_f=6.6208
[loss-randlabel] ep 7 it 20 total=1.5280 ce_r=0.2285 ce_f=6.4975
[loss-randlabel] ep 7 it 70 total=1.5511 ce_r=0.1949 ce_f=6.7811
[loss-randlabel] ep 7 it 120 total=1.5536 ce_r=0.2277 ce_f=6.6293
[loss-randlabel] ep 7 it 170 total=1.5479 ce_r=0.2479 ce_f=6.4996
[loss-randlabel] ep 7 it 220 total=1.5075 ce_r=0.1928 ce_f=6.5732
[loss-randlabel] ep 7 it 270 total=1.5813 ce_r=0.2470 ce_f=6.6711
[loss-randlabel] ep 7 it 320 total=1.4987 ce_r=0.1934 ce_f=6.5265
[loss-randlabel] ep 7 it 370 total=1.5131 ce_r=0.1963 ce_f=6.5841
[loss-randlabel] ep 8 it 30 total=1.5691 ce_r=0.2178 ce_f=6.7566
[loss-randlabel] ep 8 it 80 total=1.5667 ce_r=0.2187 ce_f=6.7399
[loss-randlabel] ep 8 it 130 total=1.5745 ce_r=0.2563 ce_f=6.5910
[loss-randlabel] ep 8 it 180 total=1.4995 ce_r=0.1502 ce_f=6.7465
[loss-randlabel] ep 8 it 230 total=1.4890 ce_r=0.1826 ce_f=6.5321
[loss-randlabel] ep 8 it 280 total=1.4913 ce_r=0.2108 ce_f=6.4025
[loss-randlabel] ep 8 it 330 total=1.5080 ce_r=0.1993 ce_f=6.5433
[loss-randlabel] ep 8 it 380 total=1.4929 ce_r=0.1976 ce_f=6.4762
[loss-randlabel] ep 9 it 40 total=1.4864 ce_r=0.1467 ce_f=6.6981
[loss-randlabel] ep 9 it 90 total=1.4944 ce_r=0.2164 ce_f=6.3901
[loss-randlabel] ep 9 it 140 total=1.4699 ce_r=0.1716 ce_f=6.4914
[loss-randlabel] ep 9 it 190 total=1.4787 ce_r=0.1875 ce_f=6.4562
[loss-randlabel] ep 9 it 240 total=1.4879 ce_r=0.1618 ce_f=6.6305
[loss-randlabel] ep 9 it 290 total=1.5451 ce_r=0.2631 ce_f=6.4100
[loss-randlabel] ep 9 it 340 total=1.4954 ce_r=0.2087 ce_f=6.4336
[loss-randlabel] ep 10 it 0 total=1.5455 ce_r=0.2426 ce_f=6.5144
[loss-randlabel] ep 10 it 50 total=1.5085 ce_r=0.1885 ce_f=6.6003
[loss-randlabel] ep 10 it 100 total=1.5463 ce_r=0.1871 ce_f=6.7962
[loss-randlabel] ep 10 it 150 total=1.5326 ce_r=0.1839 ce_f=6.7440
[loss-randlabel] ep 10 it 200 total=1.5222 ce_r=0.1680 ce_f=6.7707
[loss-randlabel] ep 10 it 250 total=1.5100 ce_r=0.2257 ce_f=6.4217
[loss-randlabel] ep 10 it 300 total=1.5159 ce_r=0.2860 ce_f=6.1496
[loss-randlabel] ep 10 it 350 total=1.5813 ce_r=0.2205 ce_f=6.8038
[loss-randlabel] ep 11 it 10 total=1.5153 ce_r=0.2191 ce_f=6.4814
[loss-randlabel] ep 11 it 60 total=1.5175 ce_r=0.1925 ce_f=6.6246
[loss-randlabel] ep 11 it 110 total=1.4723 ce_r=0.1923 ce_f=6.3998
[loss-randlabel] ep 11 it 160 total=1.5129 ce_r=0.1582 ce_f=6.7734
[loss-randlabel] ep 11 it 210 total=1.4678 ce_r=0.1669 ce_f=6.5042
[loss-randlabel] ep 11 it 260 total=1.4675 ce_r=0.2213 ce_f=6.2312
[loss-randlabel] ep 11 it 310 total=1.4988 ce_r=0.1700 ce_f=6.6443
[loss-randlabel] ep 11 it 360 total=1.5423 ce_r=0.2402 ce_f=6.5107
[loss-randlabel] ep 12 it 20 total=1.4808 ce_r=0.1621 ce_f=6.5932
[loss-randlabel] ep 12 it 70 total=1.5283 ce_r=0.2157 ce_f=6.5629
[loss-randlabel] ep 12 it 120 total=1.5073 ce_r=0.2245 ce_f=6.4137
[loss-randlabel] ep 12 it 170 total=1.5345 ce_r=0.2480 ce_f=6.4324
[loss-randlabel] ep 12 it 220 total=1.4635 ce_r=0.1632 ce_f=6.5015
[loss-randlabel] ep 12 it 270 total=1.5190 ce_r=0.2235 ce_f=6.4774
[loss-randlabel] ep 12 it 320 total=1.5878 ce_r=0.3195 ce_f=6.3415
[loss-randlabel] ep 12 it 370 total=1.5306 ce_r=0.2542 ce_f=6.3822
[loss-randlabel] ep 13 it 30 total=1.5254 ce_r=0.2283 ce_f=6.4851
[loss-randlabel] ep 13 it 80 total=1.5054 ce_r=0.2395 ce_f=6.3298
[loss-randlabel] ep 13 it 130 total=1.4729 ce_r=0.1742 ce_f=6.4936
[loss-randlabel] ep 13 it 180 total=1.4974 ce_r=0.1797 ce_f=6.5883
[loss-randlabel] ep 13 it 230 total=1.4872 ce_r=0.1344 ce_f=6.7639
[loss-randlabel] ep 13 it 280 total=1.5158 ce_r=0.1934 ce_f=6.6120
[loss-randlabel] ep 13 it 330 total=1.4839 ce_r=0.1858 ce_f=6.4907
[loss-randlabel] ep 13 it 380 total=1.4199 ce_r=0.1634 ce_f=6.2824
[loss-randlabel] ep 14 it 40 total=1.5084 ce_r=0.2257 ce_f=6.4137
[loss-randlabel] ep 14 it 90 total=1.5198 ce_r=0.1926 ce_f=6.6360
[loss-randlabel] ep 14 it 140 total=1.4958 ce_r=0.2168 ce_f=6.3948
[loss-randlabel] ep 14 it 190 total=1.4761 ce_r=0.1997 ce_f=6.3819
[loss-randlabel] ep 14 it 240 total=1.4980 ce_r=0.2225 ce_f=6.3774
[loss-randlabel] ep 14 it 290 total=1.4957 ce_r=0.1887 ce_f=6.5351
[loss-randlabel] ep 14 it 340 total=1.4970 ce_r=0.1887 ce_f=6.5412
[loss-randlabel] ep 15 it 0 total=1.4760 ce_r=0.1542 ce_f=6.6087
[loss-randlabel] ep 15 it 50 total=1.4904 ce_r=0.1729 ce_f=6.5877
[loss-randlabel] ep 15 it 100 total=1.5108 ce_r=0.1886 ce_f=6.6109
[loss-randlabel] ep 15 it 150 total=1.4956 ce_r=0.1779 ce_f=6.5886
[loss-randlabel] ep 15 it 200 total=1.5340 ce_r=0.2041 ce_f=6.6493
[loss-randlabel] ep 15 it 250 total=1.4826 ce_r=0.1959 ce_f=6.4338
 32%|███▏      | 16/50 [18:04<30:55, 54.58s/it] 34%|███▍      | 17/50 [18:46<28:03, 51.00s/it] 36%|███▌      | 18/50 [19:29<25:54, 48.57s/it] 38%|███▊      | 19/50 [20:11<24:05, 46.62s/it] 40%|████      | 20/50 [20:52<22:25, 44.84s/it] 42%|████▏     | 21/50 [21:35<21:28, 44.43s/it] 44%|████▍     | 22/50 [22:25<21:25, 45.91s/it] 46%|████▌     | 23/50 [23:08<20:19, 45.16s/it] 48%|████▊     | 24/50 [23:51<19:12, 44.34s/it] 50%|█████     | 25/50 [24:35<18:30, 44.42s/it] 52%|█████▏    | 26/50 [25:20<17:47, 44.49s/it] 54%|█████▍    | 27/50 [26:05<17:09, 44.76s/it] 56%|█████▌    | 28/50 [26:53<16:45, 45.69s/it] 58%|█████▊    | 29/50 [27:43<16:24, 46.90s/it] 60%|██████    | 30/50 [28:29<15:32, 46.61s/it] 62%|██████▏   | 31/50 [29:14<14:36, 46.12s/it][loss-randlabel] ep 15 it 300 total=1.4723 ce_r=0.2001 ce_f=6.3613
[loss-randlabel] ep 15 it 350 total=1.5037 ce_r=0.2639 ce_f=6.1989
[loss-randlabel] ep 16 it 10 total=1.4826 ce_r=0.1805 ce_f=6.5104
[loss-randlabel] ep 16 it 60 total=1.4627 ce_r=0.1587 ce_f=6.5198
[loss-randlabel] ep 16 it 110 total=1.4679 ce_r=0.1781 ce_f=6.4486
[loss-randlabel] ep 16 it 160 total=1.4652 ce_r=0.1879 ce_f=6.3862
[loss-randlabel] ep 16 it 210 total=1.5106 ce_r=0.2026 ce_f=6.5403
[loss-randlabel] ep 16 it 260 total=1.4664 ce_r=0.1682 ce_f=6.4907
[loss-randlabel] ep 16 it 310 total=1.4607 ce_r=0.1496 ce_f=6.5552
[loss-randlabel] ep 16 it 360 total=1.4994 ce_r=0.2306 ce_f=6.3441
[loss-randlabel] ep 17 it 20 total=1.5084 ce_r=0.1980 ce_f=6.5521
[loss-randlabel] ep 17 it 70 total=1.5043 ce_r=0.2414 ce_f=6.3148
[loss-randlabel] ep 17 it 120 total=1.5270 ce_r=0.2704 ce_f=6.2828
[loss-randlabel] ep 17 it 170 total=1.5157 ce_r=0.2196 ce_f=6.4809
[loss-randlabel] ep 17 it 220 total=1.5001 ce_r=0.1972 ce_f=6.5142
[loss-randlabel] ep 17 it 270 total=1.4722 ce_r=0.2027 ce_f=6.3477
[loss-randlabel] ep 17 it 320 total=1.4660 ce_r=0.1565 ce_f=6.5473
[loss-randlabel] ep 17 it 370 total=1.4803 ce_r=0.2238 ce_f=6.2827
[loss-randlabel] ep 18 it 30 total=1.4704 ce_r=0.2107 ce_f=6.2984
[loss-randlabel] ep 18 it 80 total=1.5003 ce_r=0.2401 ce_f=6.3010
[loss-randlabel] ep 18 it 130 total=1.5082 ce_r=0.1951 ce_f=6.5656
[loss-randlabel] ep 18 it 180 total=1.4687 ce_r=0.2240 ce_f=6.2235
[loss-randlabel] ep 18 it 230 total=1.4855 ce_r=0.2110 ce_f=6.3724
[loss-randlabel] ep 18 it 280 total=1.4372 ce_r=0.1744 ce_f=6.3142
[loss-randlabel] ep 18 it 330 total=1.4506 ce_r=0.1757 ce_f=6.3746
[loss-randlabel] ep 18 it 380 total=1.5722 ce_r=0.2835 ce_f=6.4434
[loss-randlabel] ep 19 it 40 total=1.5344 ce_r=0.2405 ce_f=6.4698
[loss-randlabel] ep 19 it 90 total=1.5029 ce_r=0.2100 ce_f=6.4646
[loss-randlabel] ep 19 it 140 total=1.4758 ce_r=0.1702 ce_f=6.5279
[loss-randlabel] ep 19 it 190 total=1.4942 ce_r=0.2133 ce_f=6.4045
[loss-randlabel] ep 19 it 240 total=1.5090 ce_r=0.2153 ce_f=6.4686
[loss-randlabel] ep 19 it 290 total=1.4804 ce_r=0.2104 ce_f=6.3503
[loss-randlabel] ep 19 it 340 total=1.4795 ce_r=0.1976 ce_f=6.4096
[loss-randlabel] ep 20 it 0 total=1.4743 ce_r=0.1651 ce_f=6.5459
[loss-randlabel] ep 20 it 50 total=1.4564 ce_r=0.1946 ce_f=6.3088
[loss-randlabel] ep 20 it 100 total=1.5434 ce_r=0.2549 ce_f=6.4426
[loss-randlabel] ep 20 it 150 total=1.4521 ce_r=0.1924 ce_f=6.2984
[loss-randlabel] ep 20 it 200 total=1.4609 ce_r=0.1761 ce_f=6.4239
[loss-randlabel] ep 20 it 250 total=1.4973 ce_r=0.1792 ce_f=6.5908
[loss-randlabel] ep 20 it 300 total=1.4700 ce_r=0.1971 ce_f=6.3648
[loss-randlabel] ep 20 it 350 total=1.4607 ce_r=0.1586 ce_f=6.5104
[loss-randlabel] ep 21 it 10 total=1.4975 ce_r=0.2132 ce_f=6.4219
[loss-randlabel] ep 21 it 60 total=1.4859 ce_r=0.2295 ce_f=6.2818
[loss-randlabel] ep 21 it 110 total=1.4720 ce_r=0.1861 ce_f=6.4294
[loss-randlabel] ep 21 it 160 total=1.4657 ce_r=0.1964 ce_f=6.3467
[loss-randlabel] ep 21 it 210 total=1.4775 ce_r=0.1840 ce_f=6.4673
[loss-randlabel] ep 21 it 260 total=1.4877 ce_r=0.2359 ce_f=6.2587
[loss-randlabel] ep 21 it 310 total=1.4791 ce_r=0.2246 ce_f=6.2728
[loss-randlabel] ep 21 it 360 total=1.4780 ce_r=0.2131 ce_f=6.3243
[loss-randlabel] ep 22 it 20 total=1.4739 ce_r=0.2206 ce_f=6.2662
[loss-randlabel] ep 22 it 70 total=1.4802 ce_r=0.2268 ce_f=6.2670
[loss-randlabel] ep 22 it 120 total=1.4544 ce_r=0.1723 ce_f=6.4108
[loss-randlabel] ep 22 it 170 total=1.4836 ce_r=0.2118 ce_f=6.3590
[loss-randlabel] ep 22 it 220 total=1.5221 ce_r=0.1934 ce_f=6.6436
[loss-randlabel] ep 22 it 270 total=1.4824 ce_r=0.1692 ce_f=6.5661
[loss-randlabel] ep 22 it 320 total=1.4554 ce_r=0.1930 ce_f=6.3123
[loss-randlabel] ep 22 it 370 total=1.5356 ce_r=0.2767 ce_f=6.2941
[loss-randlabel] ep 23 it 30 total=1.4177 ce_r=0.1671 ce_f=6.2532
[loss-randlabel] ep 23 it 80 total=1.4945 ce_r=0.2203 ce_f=6.3709
[loss-randlabel] ep 23 it 130 total=1.4445 ce_r=0.1701 ce_f=6.3722
[loss-randlabel] ep 23 it 180 total=1.4776 ce_r=0.1786 ce_f=6.4947
[loss-randlabel] ep 23 it 230 total=1.4868 ce_r=0.2119 ce_f=6.3745
[loss-randlabel] ep 23 it 280 total=1.4966 ce_r=0.1927 ce_f=6.5198
[loss-randlabel] ep 23 it 330 total=1.4514 ce_r=0.1857 ce_f=6.3283
[loss-randlabel] ep 23 it 380 total=1.4699 ce_r=0.1793 ce_f=6.4531
[loss-randlabel] ep 24 it 40 total=1.4617 ce_r=0.2352 ce_f=6.1328
[loss-randlabel] ep 24 it 90 total=1.3738 ce_r=0.1866 ce_f=5.9365
[loss-randlabel] ep 24 it 140 total=1.5149 ce_r=0.2428 ce_f=6.3608
[loss-randlabel] ep 24 it 190 total=1.4407 ce_r=0.1693 ce_f=6.3566
[loss-randlabel] ep 24 it 240 total=1.4112 ce_r=0.1913 ce_f=6.0996
[loss-randlabel] ep 24 it 290 total=1.5012 ce_r=0.2137 ce_f=6.4375
[loss-randlabel] ep 24 it 340 total=1.4473 ce_r=0.2207 ce_f=6.1330
[loss-randlabel] ep 25 it 0 total=1.4804 ce_r=0.1994 ce_f=6.4050
[loss-randlabel] ep 25 it 50 total=1.4934 ce_r=0.2233 ce_f=6.3505
[loss-randlabel] ep 25 it 100 total=1.4734 ce_r=0.1740 ce_f=6.4971
[loss-randlabel] ep 25 it 150 total=1.4974 ce_r=0.1895 ce_f=6.5396
[loss-randlabel] ep 25 it 200 total=1.5049 ce_r=0.2209 ce_f=6.4199
[loss-randlabel] ep 25 it 250 total=1.4692 ce_r=0.1725 ce_f=6.4832
[loss-randlabel] ep 25 it 300 total=1.4742 ce_r=0.1481 ce_f=6.6305
[loss-randlabel] ep 25 it 350 total=1.4624 ce_r=0.1966 ce_f=6.3285
[loss-randlabel] ep 26 it 10 total=1.4489 ce_r=0.1863 ce_f=6.3127
[loss-randlabel] ep 26 it 60 total=1.4667 ce_r=0.1851 ce_f=6.4083
[loss-randlabel] ep 26 it 110 total=1.4545 ce_r=0.1648 ce_f=6.4485
[loss-randlabel] ep 26 it 160 total=1.4666 ce_r=0.2168 ce_f=6.2490
[loss-randlabel] ep 26 it 210 total=1.4611 ce_r=0.1809 ce_f=6.4014
[loss-randlabel] ep 26 it 260 total=1.4899 ce_r=0.2277 ce_f=6.3115
[loss-randlabel] ep 26 it 310 total=1.4696 ce_r=0.2376 ce_f=6.1602
[loss-randlabel] ep 26 it 360 total=1.5195 ce_r=0.2513 ce_f=6.3410
[loss-randlabel] ep 27 it 20 total=1.4373 ce_r=0.1690 ce_f=6.3414
[loss-randlabel] ep 27 it 70 total=1.4712 ce_r=0.1646 ce_f=6.5329
[loss-randlabel] ep 27 it 120 total=1.4857 ce_r=0.2070 ce_f=6.3932
[loss-randlabel] ep 27 it 170 total=1.4766 ce_r=0.1815 ce_f=6.4755
[loss-randlabel] ep 27 it 220 total=1.4317 ce_r=0.1603 ce_f=6.3570
[loss-randlabel] ep 27 it 270 total=1.4581 ce_r=0.1965 ce_f=6.3082
[loss-randlabel] ep 27 it 320 total=1.4509 ce_r=0.1877 ce_f=6.3162
[loss-randlabel] ep 27 it 370 total=1.4839 ce_r=0.1876 ce_f=6.4816
[loss-randlabel] ep 28 it 30 total=1.4626 ce_r=0.2544 ce_f=6.0413
[loss-randlabel] ep 28 it 80 total=1.4645 ce_r=0.1752 ce_f=6.4464
[loss-randlabel] ep 28 it 130 total=1.4719 ce_r=0.2021 ce_f=6.3489
[loss-randlabel] ep 28 it 180 total=1.4474 ce_r=0.1962 ce_f=6.2563
[loss-randlabel] ep 28 it 230 total=1.4441 ce_r=0.1641 ce_f=6.3997
[loss-randlabel] ep 28 it 280 total=1.4896 ce_r=0.2124 ce_f=6.3861
[loss-randlabel] ep 28 it 330 total=1.4725 ce_r=0.2384 ce_f=6.1709
[loss-randlabel] ep 28 it 380 total=1.4756 ce_r=0.1752 ce_f=6.5020
[loss-randlabel] ep 29 it 40 total=1.4448 ce_r=0.2132 ce_f=6.1579
[loss-randlabel] ep 29 it 90 total=1.4743 ce_r=0.1878 ce_f=6.4326
[loss-randlabel] ep 29 it 140 total=1.4662 ce_r=0.2255 ce_f=6.2038
[loss-randlabel] ep 29 it 190 total=1.4851 ce_r=0.1970 ce_f=6.4408
[loss-randlabel] ep 29 it 240 total=1.4492 ce_r=0.1862 ce_f=6.3151
[loss-randlabel] ep 29 it 290 total=1.4595 ce_r=0.1627 ce_f=6.4838
[loss-randlabel] ep 29 it 340 total=1.4721 ce_r=0.1756 ce_f=6.4828
[loss-randlabel] ep 30 it 0 total=1.4706 ce_r=0.1913 ce_f=6.3964
[loss-randlabel] ep 30 it 50 total=1.4320 ce_r=0.1605 ce_f=6.3574
[loss-randlabel] ep 30 it 100 total=1.4667 ce_r=0.2141 ce_f=6.2626
[loss-randlabel] ep 30 it 150 total=1.4522 ce_r=0.1673 ce_f=6.4244
[loss-randlabel] ep 30 it 200 total=1.4657 ce_r=0.1778 ce_f=6.4397
[loss-randlabel] ep 30 it 250 total=1.4840 ce_r=0.2752 ce_f=6.0440
[loss-randlabel] ep 30 it 300 total=1.4757 ce_r=0.2049 ce_f=6.3539
[loss-randlabel] ep 30 it 350 total=1.4930 ce_r=0.2572 ce_f=6.1788
[loss-randlabel] ep 31 it 10 total=1.4342 ce_r=0.2216 ce_f=6.0628
[loss-randlabel] ep 31 it 60 total=1.4567 ce_r=0.1723 ce_f=6.4218
[loss-randlabel] ep 31 it 110 total=1.4940 ce_r=0.2335 ce_f=6.3027
 64%|██████▍   | 32/50 [30:06<14:24, 48.03s/it] 66%|██████▌   | 33/50 [31:01<14:08, 49.94s/it] 68%|██████▊   | 34/50 [31:54<13:33, 50.85s/it] 70%|███████   | 35/50 [32:46<12:49, 51.27s/it] 72%|███████▏  | 36/50 [33:39<12:05, 51.84s/it] 74%|███████▍  | 37/50 [34:28<11:03, 51.03s/it] 76%|███████▌  | 38/50 [35:21<10:17, 51.49s/it] 78%|███████▊  | 39/50 [36:07<09:07, 49.82s/it] 80%|████████  | 40/50 [36:45<07:43, 46.33s/it] 82%|████████▏ | 41/50 [37:21<06:28, 43.20s/it] 84%|████████▍ | 42/50 [37:54<05:22, 40.33s/it] 86%|████████▌ | 43/50 [38:28<04:28, 38.31s/it] 88%|████████▊ | 44/50 [39:03<03:43, 37.21s/it] 90%|█████████ | 45/50 [39:35<02:59, 35.86s/it] 92%|█████████▏| 46/50 [40:15<02:28, 37.07s/it] 94%|█████████▍| 47/50 [40:45<01:44, 34.78s/it][loss-randlabel] ep 31 it 160 total=1.4312 ce_r=0.1965 ce_f=6.1736
[loss-randlabel] ep 31 it 210 total=1.4561 ce_r=0.2128 ce_f=6.2167
[loss-randlabel] ep 31 it 260 total=1.4471 ce_r=0.1836 ce_f=6.3174
[loss-randlabel] ep 31 it 310 total=1.4633 ce_r=0.2095 ce_f=6.2692
[loss-randlabel] ep 31 it 360 total=1.4701 ce_r=0.2164 ce_f=6.2684
[loss-randlabel] ep 32 it 20 total=1.4706 ce_r=0.1863 ce_f=6.4214
[loss-randlabel] ep 32 it 70 total=1.4736 ce_r=0.2124 ce_f=6.3060
[loss-randlabel] ep 32 it 120 total=1.4871 ce_r=0.1917 ce_f=6.4771
[loss-randlabel] ep 32 it 170 total=1.4833 ce_r=0.1999 ce_f=6.4172
[loss-randlabel] ep 32 it 220 total=1.4658 ce_r=0.1761 ce_f=6.4484
[loss-randlabel] ep 32 it 270 total=1.4404 ce_r=0.1799 ce_f=6.3025
[loss-randlabel] ep 32 it 320 total=1.4189 ce_r=0.1884 ce_f=6.1522
[loss-randlabel] ep 32 it 370 total=1.4465 ce_r=0.1740 ce_f=6.3627
[loss-randlabel] ep 33 it 30 total=1.4492 ce_r=0.2009 ce_f=6.2414
[loss-randlabel] ep 33 it 80 total=1.4856 ce_r=0.2562 ce_f=6.1473
[loss-randlabel] ep 33 it 130 total=1.4626 ce_r=0.1924 ce_f=6.3510
[loss-randlabel] ep 33 it 180 total=1.4754 ce_r=0.1877 ce_f=6.4386
[loss-randlabel] ep 33 it 230 total=1.4681 ce_r=0.1935 ce_f=6.3728
[loss-randlabel] ep 33 it 280 total=1.4583 ce_r=0.2328 ce_f=6.1274
[loss-randlabel] ep 33 it 330 total=1.4771 ce_r=0.2182 ce_f=6.2948
[loss-randlabel] ep 33 it 380 total=1.4526 ce_r=0.2317 ce_f=6.1045
[loss-randlabel] ep 34 it 40 total=1.4177 ce_r=0.1601 ce_f=6.2884
[loss-randlabel] ep 34 it 90 total=1.4430 ce_r=0.1594 ce_f=6.4181
[loss-randlabel] ep 34 it 140 total=1.4979 ce_r=0.2117 ce_f=6.4307
[loss-randlabel] ep 34 it 190 total=1.4604 ce_r=0.1830 ce_f=6.3869
[loss-randlabel] ep 34 it 240 total=1.4771 ce_r=0.2325 ce_f=6.2229
[loss-randlabel] ep 34 it 290 total=1.5043 ce_r=0.2823 ce_f=6.1099
[loss-randlabel] ep 34 it 340 total=1.4450 ce_r=0.2471 ce_f=5.9896
[loss-randlabel] ep 35 it 0 total=1.4500 ce_r=0.1756 ce_f=6.3720
[loss-randlabel] ep 35 it 50 total=1.4741 ce_r=0.1935 ce_f=6.4026
[loss-randlabel] ep 35 it 100 total=1.4504 ce_r=0.1744 ce_f=6.3802
[loss-randlabel] ep 35 it 150 total=1.4807 ce_r=0.2551 ce_f=6.1281
[loss-randlabel] ep 35 it 200 total=1.4718 ce_r=0.2276 ce_f=6.2210
[loss-randlabel] ep 35 it 250 total=1.4540 ce_r=0.2118 ce_f=6.2108
[loss-randlabel] ep 35 it 300 total=1.4336 ce_r=0.1967 ce_f=6.1843
[loss-randlabel] ep 35 it 350 total=1.4686 ce_r=0.2035 ce_f=6.3255
[loss-randlabel] ep 36 it 10 total=1.4504 ce_r=0.2228 ce_f=6.1383
[loss-randlabel] ep 36 it 60 total=1.4633 ce_r=0.1899 ce_f=6.3672
[loss-randlabel] ep 36 it 110 total=1.4948 ce_r=0.2028 ce_f=6.4598
[loss-randlabel] ep 36 it 160 total=1.4704 ce_r=0.1683 ce_f=6.5102
[loss-randlabel] ep 36 it 210 total=1.4526 ce_r=0.1923 ce_f=6.3014
[loss-randlabel] ep 36 it 260 total=1.4705 ce_r=0.1900 ce_f=6.4023
[loss-randlabel] ep 36 it 310 total=1.4499 ce_r=0.2355 ce_f=6.0723
[loss-randlabel] ep 36 it 360 total=1.4688 ce_r=0.1689 ce_f=6.4993
[loss-randlabel] ep 37 it 20 total=1.4378 ce_r=0.1789 ce_f=6.2946
[loss-randlabel] ep 37 it 70 total=1.4404 ce_r=0.2314 ce_f=6.0451
[loss-randlabel] ep 37 it 120 total=1.4615 ce_r=0.1669 ce_f=6.4730
[loss-randlabel] ep 37 it 170 total=1.4790 ce_r=0.1937 ce_f=6.4265
[loss-randlabel] ep 37 it 220 total=1.4441 ce_r=0.1388 ce_f=6.5269
[loss-randlabel] ep 37 it 270 total=1.4562 ce_r=0.1861 ce_f=6.3504
[loss-randlabel] ep 37 it 320 total=1.4823 ce_r=0.2337 ce_f=6.2429
[loss-randlabel] ep 37 it 370 total=1.4207 ce_r=0.1813 ce_f=6.1969
[loss-randlabel] ep 38 it 30 total=1.4479 ce_r=0.1663 ce_f=6.4080
[loss-randlabel] ep 38 it 80 total=1.4287 ce_r=0.1492 ce_f=6.3973
[loss-randlabel] ep 38 it 130 total=1.4282 ce_r=0.1800 ce_f=6.2412
[loss-randlabel] ep 38 it 180 total=1.4481 ce_r=0.1973 ce_f=6.2540
[loss-randlabel] ep 38 it 230 total=1.4503 ce_r=0.1839 ce_f=6.3320
[loss-randlabel] ep 38 it 280 total=1.4658 ce_r=0.1885 ce_f=6.3869
[loss-randlabel] ep 38 it 330 total=1.4457 ce_r=0.1652 ce_f=6.4025
[loss-randlabel] ep 38 it 380 total=1.4496 ce_r=0.1827 ce_f=6.3347
[loss-randlabel] ep 39 it 40 total=1.4270 ce_r=0.1665 ce_f=6.3023
[loss-randlabel] ep 39 it 90 total=1.4393 ce_r=0.1921 ce_f=6.2360
[loss-randlabel] ep 39 it 140 total=1.4824 ce_r=0.2253 ce_f=6.2855
[loss-randlabel] ep 39 it 190 total=1.4179 ce_r=0.1698 ce_f=6.2403
[loss-randlabel] ep 39 it 240 total=1.4842 ce_r=0.2235 ce_f=6.3034
[loss-randlabel] ep 39 it 290 total=1.4462 ce_r=0.1606 ce_f=6.4283
[loss-randlabel] ep 39 it 340 total=1.4926 ce_r=0.2472 ce_f=6.2271
[loss-randlabel] ep 40 it 0 total=1.4395 ce_r=0.2087 ce_f=6.1537
[loss-randlabel] ep 40 it 50 total=1.4247 ce_r=0.1516 ce_f=6.3658
[loss-randlabel] ep 40 it 100 total=1.4917 ce_r=0.2398 ce_f=6.2596
[loss-randlabel] ep 40 it 150 total=1.4377 ce_r=0.1609 ce_f=6.3839
[loss-randlabel] ep 40 it 200 total=1.4693 ce_r=0.1995 ce_f=6.3490
[loss-randlabel] ep 40 it 250 total=1.4569 ce_r=0.2086 ce_f=6.2416
[loss-randlabel] ep 40 it 300 total=1.4626 ce_r=0.2046 ce_f=6.2901
[loss-randlabel] ep 40 it 350 total=1.4503 ce_r=0.2098 ce_f=6.2024
[loss-randlabel] ep 41 it 10 total=1.4113 ce_r=0.1655 ce_f=6.2291
[loss-randlabel] ep 41 it 60 total=1.5213 ce_r=0.2780 ce_f=6.2163
[loss-randlabel] ep 41 it 110 total=1.4549 ce_r=0.1753 ce_f=6.3977
[loss-randlabel] ep 41 it 160 total=1.4415 ce_r=0.1793 ce_f=6.3112
[loss-randlabel] ep 41 it 210 total=1.4613 ce_r=0.1996 ce_f=6.3083
[loss-randlabel] ep 41 it 260 total=1.4614 ce_r=0.2147 ce_f=6.2334
[loss-randlabel] ep 41 it 310 total=1.4622 ce_r=0.2111 ce_f=6.2557
[loss-randlabel] ep 41 it 360 total=1.4456 ce_r=0.1812 ce_f=6.3220
[loss-randlabel] ep 42 it 20 total=1.4895 ce_r=0.2159 ce_f=6.3680
[loss-randlabel] ep 42 it 70 total=1.4433 ce_r=0.1778 ce_f=6.3275
[loss-randlabel] ep 42 it 120 total=1.4462 ce_r=0.1647 ce_f=6.4075
[loss-randlabel] ep 42 it 170 total=1.4578 ce_r=0.2023 ce_f=6.2777
[loss-randlabel] ep 42 it 220 total=1.4291 ce_r=0.1871 ce_f=6.2101
[loss-randlabel] ep 42 it 270 total=1.4568 ce_r=0.2525 ce_f=6.0215
[loss-randlabel] ep 42 it 320 total=1.4622 ce_r=0.1759 ce_f=6.4316
[loss-randlabel] ep 42 it 370 total=1.4545 ce_r=0.2382 ce_f=6.0818
[loss-randlabel] ep 43 it 30 total=1.4583 ce_r=0.1825 ce_f=6.3790
[loss-randlabel] ep 43 it 80 total=1.4695 ce_r=0.2308 ce_f=6.1934
[loss-randlabel] ep 43 it 130 total=1.4388 ce_r=0.1926 ce_f=6.2311
[loss-randlabel] ep 43 it 180 total=1.4868 ce_r=0.2009 ce_f=6.4293
[loss-randlabel] ep 43 it 230 total=1.4511 ce_r=0.1411 ce_f=6.5501
[loss-randlabel] ep 43 it 280 total=1.4491 ce_r=0.1753 ce_f=6.3690
[loss-randlabel] ep 43 it 330 total=1.4710 ce_r=0.2178 ce_f=6.2662
[loss-randlabel] ep 43 it 380 total=1.4486 ce_r=0.2075 ce_f=6.2055
[loss-randlabel] ep 44 it 40 total=1.4621 ce_r=0.1977 ce_f=6.3220
[loss-randlabel] ep 44 it 90 total=1.4625 ce_r=0.2102 ce_f=6.2611
[loss-randlabel] ep 44 it 140 total=1.4800 ce_r=0.2273 ce_f=6.2639
[loss-randlabel] ep 44 it 190 total=1.4449 ce_r=0.2142 ce_f=6.1534
[loss-randlabel] ep 44 it 240 total=1.4378 ce_r=0.1579 ce_f=6.3995
[loss-randlabel] ep 44 it 290 total=1.4316 ce_r=0.1687 ce_f=6.3144
[loss-randlabel] ep 44 it 340 total=1.4396 ce_r=0.1747 ce_f=6.3244
[loss-randlabel] ep 45 it 0 total=1.4414 ce_r=0.1502 ce_f=6.4561
[loss-randlabel] ep 45 it 50 total=1.4197 ce_r=0.1935 ce_f=6.1310
[loss-randlabel] ep 45 it 100 total=1.4579 ce_r=0.1976 ce_f=6.3014
[loss-randlabel] ep 45 it 150 total=1.4498 ce_r=0.1954 ce_f=6.2717
[loss-randlabel] ep 45 it 200 total=1.4626 ce_r=0.1810 ce_f=6.4082
[loss-randlabel] ep 45 it 250 total=1.4579 ce_r=0.1798 ce_f=6.3904
[loss-randlabel] ep 45 it 300 total=1.4363 ce_r=0.1978 ce_f=6.1923
[loss-randlabel] ep 45 it 350 total=1.4209 ce_r=0.1612 ce_f=6.2988
[loss-randlabel] ep 46 it 10 total=1.4399 ce_r=0.1824 ce_f=6.2876
[loss-randlabel] ep 46 it 60 total=1.4543 ce_r=0.2000 ce_f=6.2716
[loss-randlabel] ep 46 it 110 total=1.4479 ce_r=0.1769 ce_f=6.3553
[loss-randlabel] ep 46 it 160 total=1.4590 ce_r=0.2219 ce_f=6.1853
[loss-randlabel] ep 46 it 210 total=1.4365 ce_r=0.1880 ce_f=6.2427
[loss-randlabel] ep 46 it 260 total=1.4573 ce_r=0.2310 ce_f=6.1314
[loss-randlabel] ep 46 it 310 total=1.4596 ce_r=0.2063 ce_f=6.2666
[loss-randlabel] ep 46 it 360 total=1.4574 ce_r=0.1664 ce_f=6.4551
 96%|█████████▌| 48/50 [41:15<01:07, 33.51s/it] 98%|█████████▊| 49/50 [41:43<00:31, 31.79s/it]100%|██████████| 50/50 [42:13<00:00, 31.34s/it]100%|██████████| 50/50 [42:13<00:00, 50.68s/it]
[loss-randlabel] ep 47 it 20 total=1.4416 ce_r=0.1893 ce_f=6.2615
[loss-randlabel] ep 47 it 70 total=1.4533 ce_r=0.1692 ce_f=6.4206
[loss-randlabel] ep 47 it 120 total=1.4388 ce_r=0.1619 ce_f=6.3846
[loss-randlabel] ep 47 it 170 total=1.4226 ce_r=0.1765 ce_f=6.2308
[loss-randlabel] ep 47 it 220 total=1.4521 ce_r=0.1940 ce_f=6.2909
[loss-randlabel] ep 47 it 270 total=1.4745 ce_r=0.2321 ce_f=6.2120
[loss-randlabel] ep 47 it 320 total=1.4648 ce_r=0.2242 ce_f=6.2027
[loss-randlabel] ep 47 it 370 total=1.4216 ce_r=0.1697 ce_f=6.2593
[loss-randlabel] ep 48 it 30 total=1.4452 ce_r=0.2387 ce_f=6.0327
[loss-randlabel] ep 48 it 80 total=1.4506 ce_r=0.1888 ce_f=6.3094
[loss-randlabel] ep 48 it 130 total=1.3953 ce_r=0.1503 ce_f=6.2247
[loss-randlabel] ep 48 it 180 total=1.4216 ce_r=0.1931 ce_f=6.1421
[loss-randlabel] ep 48 it 230 total=1.4049 ce_r=0.1584 ce_f=6.2327
[loss-randlabel] ep 48 it 280 total=1.4765 ce_r=0.2298 ce_f=6.2335
[loss-randlabel] ep 48 it 330 total=1.4541 ce_r=0.1917 ce_f=6.3120
[loss-randlabel] ep 48 it 380 total=1.4660 ce_r=0.2407 ce_f=6.1266
[loss-randlabel] ep 49 it 40 total=1.4220 ce_r=0.1840 ce_f=6.1899
[loss-randlabel] ep 49 it 90 total=1.4281 ce_r=0.1889 ce_f=6.1958
[loss-randlabel] ep 49 it 140 total=1.4403 ce_r=0.1971 ce_f=6.2159
[loss-randlabel] ep 49 it 190 total=1.4926 ce_r=0.2211 ce_f=6.3575
[loss-randlabel] ep 49 it 240 total=1.4620 ce_r=0.1892 ce_f=6.3640
[loss-randlabel] ep 49 it 290 total=1.4237 ce_r=0.1783 ce_f=6.2268
[loss-randlabel] ep 49 it 340 total=1.4614 ce_r=0.1736 ce_f=6.4393
Disabling PyTorch because PyTorch >= 2.1 is required but found 2.0.1
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline_randlabel_forget.pt
resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl0.2: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:08,  2.07it/s]  2%|▏         | 9/391 [00:00<00:19, 19.81it/s]  5%|▍         | 18/391 [00:00<00:10, 36.90it/s]  7%|▋         | 27/391 [00:00<00:07, 50.13it/s]  9%|▉         | 37/391 [00:00<00:05, 62.49it/s] 12%|█▏        | 47/391 [00:01<00:04, 70.89it/s] 14%|█▍        | 56/391 [00:01<00:04, 75.45it/s] 17%|█▋        | 66/391 [00:01<00:04, 79.45it/s] 19%|█▉        | 76/391 [00:01<00:03, 83.67it/s] 22%|██▏       | 85/391 [00:01<00:03, 85.32it/s] 24%|██▍       | 94/391 [00:01<00:03, 85.12it/s] 26%|██▋       | 103/391 [00:01<00:03, 85.95it/s] 29%|██▊       | 112/391 [00:01<00:03, 82.74it/s] 31%|███       | 121/391 [00:01<00:03, 83.98it/s] 34%|███▎      | 131/391 [00:01<00:03, 85.90it/s] 36%|███▌      | 140/391 [00:02<00:02, 86.42it/s] 38%|███▊      | 149/391 [00:02<00:02, 84.90it/s] 40%|████      | 158/391 [00:02<00:02, 85.89it/s] 43%|████▎     | 167/391 [00:02<00:02, 86.28it/s] 45%|████▌     | 177/391 [00:02<00:02, 88.56it/s] 48%|████▊     | 187/391 [00:02<00:02, 88.49it/s] 50%|█████     | 196/391 [00:02<00:02, 88.73it/s] 52%|█████▏    | 205/391 [00:02<00:02, 88.58it/s] 55%|█████▍    | 214/391 [00:02<00:02, 87.10it/s] 57%|█████▋    | 224/391 [00:03<00:01, 89.16it/s] 60%|█████▉    | 233/391 [00:03<00:01, 88.70it/s] 62%|██████▏   | 242/391 [00:03<00:01, 88.69it/s] 64%|██████▍   | 251/391 [00:03<00:01, 86.60it/s] 67%|██████▋   | 261/391 [00:03<00:01, 87.04it/s] 69%|██████▉   | 271/391 [00:03<00:01, 88.26it/s] 72%|███████▏  | 280/391 [00:03<00:01, 88.50it/s] 74%|███████▍  | 290/391 [00:03<00:01, 89.30it/s] 77%|███████▋  | 300/391 [00:03<00:01, 90.26it/s] 79%|███████▉  | 310/391 [00:03<00:00, 89.90it/s] 82%|████████▏ | 319/391 [00:04<00:00, 89.56it/s] 84%|████████▍ | 328/391 [00:04<00:00, 89.44it/s] 86%|████████▌ | 337/391 [00:04<00:00, 89.30it/s] 88%|████████▊ | 346/391 [00:04<00:00, 89.34it/s] 91%|█████████ | 356/391 [00:04<00:00, 89.32it/s] 94%|█████████▎| 366/391 [00:04<00:00, 89.99it/s] 96%|█████████▌| 376/391 [00:04<00:00, 91.58it/s] 99%|█████████▊| 386/391 [00:04<00:00, 92.86it/s]100%|██████████| 391/391 [00:04<00:00, 79.75it/s]
50000 images processed, 4.993144512176514 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:31,  2.45it/s] 13%|█▎        | 10/79 [00:00<00:02, 24.88it/s] 25%|██▌       | 20/79 [00:00<00:01, 43.83it/s] 38%|███▊      | 30/79 [00:00<00:00, 57.67it/s] 49%|████▉     | 39/79 [00:00<00:00, 64.95it/s] 61%|██████    | 48/79 [00:00<00:00, 70.95it/s] 73%|███████▎  | 58/79 [00:01<00:00, 77.88it/s] 86%|████████▌ | 68/79 [00:01<00:00, 83.14it/s] 99%|█████████▊| 78/79 [00:01<00:00, 86.64it/s]100%|██████████| 79/79 [00:01<00:00, 44.84it/s]
10000 images processed, 1.7983877658843994 seconds used

Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:43,  1.96it/s]  4%|▍         | 8/204 [00:00<00:11, 16.74it/s]  8%|▊         | 17/204 [00:00<00:05, 33.50it/s] 13%|█▎        | 26/204 [00:00<00:03, 46.84it/s] 17%|█▋        | 35/204 [00:00<00:02, 57.86it/s] 22%|██▏       | 44/204 [00:01<00:02, 66.14it/s] 26%|██▌       | 53/204 [00:01<00:02, 71.24it/s] 30%|███       | 62/204 [00:01<00:01, 74.38it/s] 35%|███▍      | 71/204 [00:01<00:01, 77.49it/s] 40%|███▉      | 81/204 [00:01<00:01, 82.20it/s] 44%|████▍     | 90/204 [00:01<00:01, 83.12it/s] 49%|████▊     | 99/204 [00:01<00:01, 82.92it/s] 53%|█████▎    | 108/204 [00:01<00:01, 84.17it/s] 57%|█████▋    | 117/204 [00:01<00:01, 85.05it/s] 62%|██████▏   | 126/204 [00:01<00:00, 85.45it/s] 66%|██████▌   | 135/204 [00:02<00:00, 84.55it/s] 71%|███████   | 144/204 [00:02<00:00, 84.14it/s] 75%|███████▌  | 153/204 [00:02<00:00, 83.70it/s] 79%|███████▉  | 162/204 [00:02<00:00, 83.29it/s] 84%|████████▍ | 172/204 [00:02<00:00, 86.14it/s] 89%|████████▉ | 182/204 [00:02<00:00, 88.28it/s] 94%|█████████▍| 192/204 [00:02<00:00, 89.92it/s] 99%|█████████▉| 202/204 [00:02<00:00, 90.95it/s]100%|██████████| 204/204 [00:02<00:00, 70.35it/s]
26032 images processed, 2.9551498889923096 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:53,  1.47it/s] 11%|█▏        | 9/79 [00:00<00:04, 15.06it/s] 23%|██▎       | 18/79 [00:00<00:02, 28.56it/s] 35%|███▌      | 28/79 [00:01<00:01, 42.80it/s] 46%|████▌     | 36/79 [00:01<00:00, 49.71it/s] 57%|█████▋    | 45/79 [00:01<00:00, 57.65it/s] 70%|██████▉   | 55/79 [00:01<00:00, 67.66it/s] 84%|████████▎ | 66/79 [00:01<00:00, 77.87it/s] 97%|█████████▋| 77/79 [00:01<00:00, 86.01it/s]100%|██████████| 79/79 [00:01<00:00, 50.42it/s]
10000 images processed, 1.609910011291504 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:43,  1.80it/s] 13%|█▎        | 10/79 [00:00<00:03, 19.44it/s] 23%|██▎       | 18/79 [00:00<00:01, 32.74it/s] 34%|███▍      | 27/79 [00:00<00:01, 45.57it/s] 46%|████▌     | 36/79 [00:00<00:00, 55.78it/s] 57%|█████▋    | 45/79 [00:01<00:00, 63.53it/s] 70%|██████▉   | 55/79 [00:01<00:00, 71.38it/s] 82%|████████▏ | 65/79 [00:01<00:00, 78.33it/s] 95%|█████████▍| 75/79 [00:01<00:00, 83.08it/s]100%|██████████| 79/79 [00:01<00:00, 54.66it/s]
10000 images processed, 1.4690961837768555 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.75it/s] 14%|█▍        | 10/70 [00:00<00:03, 19.19it/s] 27%|██▋       | 19/70 [00:00<00:01, 33.99it/s] 40%|████      | 28/70 [00:00<00:00, 46.71it/s] 54%|█████▍    | 38/70 [00:01<00:00, 58.57it/s] 69%|██████▊   | 48/70 [00:01<00:00, 68.13it/s] 83%|████████▎ | 58/70 [00:01<00:00, 75.29it/s] 97%|█████████▋| 68/70 [00:01<00:00, 80.59it/s]100%|██████████| 70/70 [00:01<00:00, 51.05it/s]
8925 images processed, 1.404749870300293 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:45,  1.03s/it]  4%|▍         | 2/45 [00:01<00:23,  1.86it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.92it/s] 38%|███▊      | 17/45 [00:01<00:01, 15.70it/s] 47%|████▋     | 21/45 [00:01<00:01, 16.81it/s] 67%|██████▋   | 30/45 [00:01<00:00, 27.95it/s] 78%|███████▊  | 35/45 [00:02<00:00, 17.97it/s]100%|██████████| 45/45 [00:02<00:00, 27.29it/s]100%|██████████| 45/45 [00:02<00:00, 17.34it/s]
5640 images processed, 2.623324155807495 seconds used

18.618687629699707
Disabling PyTorch because PyTorch >= 2.1 is required but found 2.0.1
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.20  98.96
places365     69.80  79.38
LSUN          25.56  94.57
iSUN          60.22  86.43
dtd           41.91  89.76
AVG           40.34  89.82
Retain-Acc: 0.7346
Forget-as-OOD (retain known vs forget novel):
  FPR: 51.00 AUROC: 89.91 AUIN: 98.73
16.377327919006348
[umap] visualization failed: No module named 'umap'
