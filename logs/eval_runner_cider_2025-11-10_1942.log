nohup: ignoring input
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
[ckpt] unexpected keys: ['fc.weight', 'fc.bias']
ckpt loaded from /home/shaokun/cider-master/checkpoints/CIFAR-100/30_10_18:17_cider_resnet34_lr_0.5_cosine_True_bsz_512_cider_wd_1.0_500_128_trial_0_temp_0.1_CIFAR-100_pm_0.5/checkpoint_500.pth.tar
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-test-palm-cider-b128-e50-lr0.001-wd1e-4-fd128-w1-pm0.999-temp0.08-bfmbalanced-fl0.2-adapter
[peft] active adapters set to: default
resnet34-test-palm-cider-b128-e50-lr0.001-wd1e-4-fd128-w1-pm0.999-temp0.08-bfmbalanced-fl0.2: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:12,  2.03it/s]  2%|▏         | 6/391 [00:00<00:30, 12.47it/s]  3%|▎         | 11/391 [00:00<00:18, 21.11it/s]  4%|▍         | 16/391 [00:00<00:13, 27.92it/s]  5%|▌         | 21/391 [00:00<00:11, 33.21it/s]  7%|▋         | 26/391 [00:01<00:09, 37.14it/s]  8%|▊         | 31/391 [00:01<00:08, 40.01it/s]  9%|▉         | 36/391 [00:01<00:08, 42.08it/s] 10%|█         | 41/391 [00:01<00:08, 43.60it/s] 12%|█▏        | 46/391 [00:01<00:07, 44.67it/s] 13%|█▎        | 51/391 [00:01<00:07, 45.43it/s] 14%|█▍        | 56/391 [00:01<00:07, 46.54it/s] 16%|█▌        | 61/391 [00:01<00:07, 46.40it/s] 17%|█▋        | 66/391 [00:01<00:07, 46.34it/s] 18%|█▊        | 71/391 [00:01<00:06, 46.40it/s] 19%|█▉        | 76/391 [00:02<00:06, 46.32it/s] 21%|██        | 81/391 [00:02<00:06, 46.27it/s] 22%|██▏       | 87/391 [00:02<00:06, 49.87it/s] 24%|██▍       | 93/391 [00:02<00:06, 49.16it/s] 25%|██▌       | 98/391 [00:02<00:06, 48.59it/s] 26%|██▋       | 103/391 [00:02<00:05, 48.19it/s] 28%|██▊       | 108/391 [00:02<00:05, 47.89it/s] 29%|██▉       | 113/391 [00:02<00:05, 47.69it/s] 30%|███       | 118/391 [00:02<00:05, 47.60it/s] 31%|███▏      | 123/391 [00:03<00:05, 47.47it/s] 33%|███▎      | 128/391 [00:03<00:05, 47.40it/s] 34%|███▍      | 133/391 [00:03<00:05, 47.35it/s] 35%|███▌      | 138/391 [00:03<00:05, 47.03it/s] 37%|███▋      | 143/391 [00:03<00:05, 47.09it/s] 38%|███▊      | 148/391 [00:03<00:05, 47.10it/s] 39%|███▉      | 153/391 [00:03<00:05, 47.16it/s] 40%|████      | 158/391 [00:03<00:04, 47.17it/s] 42%|████▏     | 163/391 [00:03<00:04, 47.18it/s] 43%|████▎     | 169/391 [00:04<00:04, 49.24it/s] 45%|████▍     | 174/391 [00:04<00:04, 48.64it/s] 46%|████▌     | 179/391 [00:04<00:04, 47.91it/s] 47%|████▋     | 184/391 [00:04<00:04, 47.39it/s] 48%|████▊     | 189/391 [00:04<00:04, 46.99it/s] 50%|████▉     | 194/391 [00:04<00:04, 46.71it/s] 51%|█████     | 199/391 [00:04<00:04, 46.49it/s] 52%|█████▏    | 204/391 [00:04<00:04, 46.37it/s] 53%|█████▎    | 209/391 [00:04<00:03, 46.28it/s] 55%|█████▍    | 214/391 [00:04<00:03, 46.25it/s] 56%|█████▌    | 219/391 [00:05<00:03, 46.22it/s] 57%|█████▋    | 224/391 [00:05<00:03, 46.11it/s] 59%|█████▊    | 229/391 [00:05<00:03, 46.09it/s] 60%|█████▉    | 234/391 [00:05<00:03, 46.11it/s] 61%|██████    | 239/391 [00:05<00:03, 46.11it/s] 62%|██████▏   | 244/391 [00:05<00:03, 46.13it/s] 64%|██████▎   | 249/391 [00:05<00:03, 46.10it/s] 65%|██████▍   | 254/391 [00:05<00:02, 46.12it/s] 66%|██████▌   | 259/391 [00:05<00:02, 46.17it/s] 68%|██████▊   | 264/391 [00:06<00:02, 46.14it/s] 69%|██████▉   | 269/391 [00:06<00:02, 46.15it/s] 71%|███████   | 276/391 [00:06<00:02, 50.63it/s] 72%|███████▏  | 282/391 [00:06<00:02, 49.94it/s] 73%|███████▎  | 287/391 [00:06<00:02, 48.79it/s] 75%|███████▍  | 292/391 [00:06<00:02, 48.04it/s] 76%|███████▌  | 297/391 [00:06<00:01, 47.47it/s] 77%|███████▋  | 302/391 [00:06<00:01, 47.09it/s] 79%|███████▊  | 307/391 [00:06<00:01, 46.81it/s] 80%|███████▉  | 312/391 [00:07<00:01, 46.60it/s] 81%|████████  | 317/391 [00:07<00:01, 46.41it/s] 82%|████████▏ | 322/391 [00:07<00:01, 46.38it/s] 84%|████████▎ | 327/391 [00:07<00:01, 46.28it/s] 85%|████████▍ | 332/391 [00:07<00:01, 46.44it/s] 86%|████████▌ | 337/391 [00:07<00:01, 46.35it/s] 87%|████████▋ | 342/391 [00:07<00:01, 46.28it/s] 89%|████████▊ | 347/391 [00:07<00:00, 46.22it/s] 90%|█████████ | 352/391 [00:07<00:00, 46.18it/s] 91%|█████████▏| 357/391 [00:08<00:00, 46.12it/s] 93%|█████████▎| 362/391 [00:08<00:00, 46.17it/s] 94%|█████████▍| 367/391 [00:08<00:00, 46.16it/s] 95%|█████████▌| 372/391 [00:08<00:00, 46.13it/s] 96%|█████████▋| 377/391 [00:08<00:00, 46.11it/s] 98%|█████████▊| 384/391 [00:08<00:00, 50.81it/s]100%|█████████▉| 390/391 [00:08<00:00, 51.83it/s]100%|██████████| 391/391 [00:08<00:00, 44.77it/s]
50000 images processed, 8.825662612915039 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:32,  2.41it/s]  8%|▊         | 6/79 [00:00<00:05, 14.30it/s] 14%|█▍        | 11/79 [00:00<00:02, 22.94it/s] 20%|██        | 16/79 [00:00<00:02, 29.28it/s] 27%|██▋       | 21/79 [00:00<00:01, 33.60it/s] 33%|███▎      | 26/79 [00:00<00:01, 36.41it/s] 39%|███▉      | 31/79 [00:01<00:01, 39.18it/s] 46%|████▌     | 36/79 [00:01<00:01, 40.95it/s] 52%|█████▏    | 41/79 [00:01<00:00, 42.48it/s] 58%|█████▊    | 46/79 [00:01<00:00, 43.57it/s] 65%|██████▍   | 51/79 [00:01<00:00, 44.33it/s] 72%|███████▏  | 57/79 [00:01<00:00, 48.65it/s] 78%|███████▊  | 62/79 [00:01<00:00, 48.35it/s] 85%|████████▍ | 67/79 [00:01<00:00, 48.03it/s] 91%|█████████ | 72/79 [00:01<00:00, 47.79it/s] 97%|█████████▋| 77/79 [00:02<00:00, 47.62it/s]100%|██████████| 79/79 [00:02<00:00, 37.92it/s]
10000 images processed, 2.1151747703552246 seconds used

Saved forget OOD features to cache/resnet34-test-palm-cider-b128-e50-lr0.001-wd1e-4-fd128-w1-pm0.999-temp0.08-bfmbalanced-fl0.2/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:01<03:26,  1.02s/it]  2%|▏         | 5/204 [00:01<00:34,  5.74it/s]  4%|▍         | 9/204 [00:01<00:18, 10.55it/s]  6%|▋         | 13/204 [00:01<00:12, 15.56it/s]  8%|▊         | 17/204 [00:01<00:09, 20.27it/s] 10%|█         | 21/204 [00:01<00:07, 24.28it/s] 12%|█▏        | 25/204 [00:01<00:06, 27.12it/s] 14%|█▍        | 29/204 [00:01<00:05, 30.29it/s] 16%|█▌        | 33/204 [00:01<00:05, 32.41it/s] 19%|█▊        | 38/204 [00:01<00:04, 34.83it/s] 21%|██        | 43/204 [00:02<00:04, 37.50it/s] 24%|██▎       | 48/204 [00:02<00:04, 37.90it/s] 25%|██▌       | 52/204 [00:02<00:04, 37.84it/s] 27%|██▋       | 56/204 [00:02<00:03, 38.10it/s] 29%|██▉       | 60/204 [00:02<00:03, 38.12it/s] 31%|███▏      | 64/204 [00:02<00:03, 36.16it/s] 34%|███▍      | 69/204 [00:02<00:03, 37.68it/s] 36%|███▋      | 74/204 [00:02<00:03, 38.90it/s] 39%|███▊      | 79/204 [00:03<00:03, 39.76it/s] 41%|████      | 84/204 [00:03<00:02, 40.48it/s] 44%|████▎     | 89/204 [00:03<00:02, 40.86it/s] 46%|████▌     | 94/204 [00:03<00:02, 41.10it/s] 49%|████▊     | 99/204 [00:03<00:02, 41.27it/s] 51%|█████     | 104/204 [00:03<00:02, 41.42it/s] 53%|█████▎    | 109/204 [00:03<00:02, 41.51it/s] 56%|█████▌    | 114/204 [00:03<00:02, 41.50it/s] 58%|█████▊    | 119/204 [00:03<00:02, 41.65it/s] 61%|██████▏   | 125/204 [00:04<00:01, 45.91it/s] 64%|██████▎   | 130/204 [00:04<00:01, 45.18it/s] 66%|██████▌   | 135/204 [00:04<00:01, 44.18it/s] 69%|██████▊   | 140/204 [00:04<00:01, 43.43it/s] 71%|███████   | 145/204 [00:04<00:01, 42.92it/s] 74%|███████▎  | 150/204 [00:04<00:01, 42.55it/s] 76%|███████▌  | 155/204 [00:04<00:01, 42.28it/s] 78%|███████▊  | 160/204 [00:04<00:01, 42.10it/s] 81%|████████  | 165/204 [00:05<00:00, 42.02it/s] 83%|████████▎ | 170/204 [00:05<00:00, 41.94it/s] 86%|████████▌ | 175/204 [00:05<00:00, 41.79it/s] 88%|████████▊ | 180/204 [00:05<00:00, 41.78it/s] 91%|█████████ | 185/204 [00:05<00:00, 41.76it/s] 93%|█████████▎| 190/204 [00:05<00:00, 41.77it/s] 96%|█████████▌| 195/204 [00:05<00:00, 41.77it/s] 98%|█████████▊| 200/204 [00:05<00:00, 41.76it/s]100%|██████████| 204/204 [00:05<00:00, 34.12it/s]
26032 images processed, 6.022775888442993 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:45,  1.70it/s]  3%|▎         | 2/79 [00:00<00:23,  3.26it/s]  9%|▉         | 7/79 [00:00<00:05, 12.75it/s] 15%|█▌        | 12/79 [00:00<00:03, 20.21it/s] 24%|██▍       | 19/79 [00:01<00:01, 30.66it/s] 30%|███       | 24/79 [00:01<00:01, 34.18it/s] 37%|███▋      | 29/79 [00:01<00:01, 35.11it/s] 43%|████▎     | 34/79 [00:01<00:01, 36.40it/s] 48%|████▊     | 38/79 [00:01<00:01, 37.19it/s] 54%|█████▍    | 43/79 [00:01<00:00, 38.54it/s] 61%|██████    | 48/79 [00:01<00:00, 39.48it/s] 67%|██████▋   | 53/79 [00:01<00:00, 40.15it/s] 73%|███████▎  | 58/79 [00:02<00:00, 40.63it/s] 80%|███████▉  | 63/79 [00:02<00:00, 41.04it/s] 86%|████████▌ | 68/79 [00:02<00:00, 41.24it/s] 92%|█████████▏| 73/79 [00:02<00:00, 41.39it/s] 99%|█████████▊| 78/79 [00:02<00:00, 41.46it/s]100%|██████████| 79/79 [00:02<00:00, 31.59it/s]
10000 images processed, 2.5327322483062744 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:41,  1.90it/s]  8%|▊         | 6/79 [00:00<00:06, 11.73it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.64it/s] 22%|██▏       | 17/79 [00:00<00:02, 28.37it/s] 28%|██▊       | 22/79 [00:00<00:01, 32.16it/s] 34%|███▍      | 27/79 [00:01<00:01, 34.91it/s] 41%|████      | 32/79 [00:01<00:01, 35.78it/s] 47%|████▋     | 37/79 [00:01<00:01, 36.26it/s] 53%|█████▎    | 42/79 [00:01<00:00, 37.33it/s] 58%|█████▊    | 46/79 [00:01<00:00, 37.58it/s] 63%|██████▎   | 50/79 [00:01<00:00, 37.75it/s] 70%|██████▉   | 55/79 [00:01<00:00, 38.57it/s] 76%|███████▌  | 60/79 [00:01<00:00, 39.44it/s] 82%|████████▏ | 65/79 [00:02<00:00, 40.06it/s] 89%|████████▊ | 70/79 [00:02<00:00, 39.13it/s] 94%|█████████▎| 74/79 [00:02<00:00, 39.18it/s] 99%|█████████▊| 78/79 [00:02<00:00, 38.27it/s]100%|██████████| 79/79 [00:02<00:00, 32.28it/s]
10000 images processed, 2.490234136581421 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<01:06,  1.04it/s]  9%|▊         | 6/70 [00:01<00:08,  7.20it/s] 16%|█▌        | 11/70 [00:01<00:04, 13.63it/s] 23%|██▎       | 16/70 [00:01<00:02, 19.51it/s] 29%|██▊       | 20/70 [00:01<00:02, 23.46it/s] 36%|███▌      | 25/70 [00:01<00:01, 28.24it/s] 43%|████▎     | 30/70 [00:01<00:01, 32.02it/s] 50%|█████     | 35/70 [00:01<00:01, 34.92it/s] 57%|█████▋    | 40/70 [00:01<00:00, 37.10it/s] 64%|██████▍   | 45/70 [00:01<00:00, 38.68it/s] 71%|███████▏  | 50/70 [00:02<00:00, 39.85it/s] 79%|███████▊  | 55/70 [00:02<00:00, 40.62it/s] 86%|████████▌ | 60/70 [00:02<00:00, 41.27it/s] 96%|█████████▌| 67/70 [00:02<00:00, 47.12it/s]100%|██████████| 70/70 [00:02<00:00, 27.71it/s]
8925 images processed, 2.566673755645752 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.06it/s]  4%|▍         | 2/45 [00:01<00:19,  2.23it/s] 16%|█▌        | 7/45 [00:01<00:04,  9.50it/s] 22%|██▏       | 10/45 [00:01<00:02, 12.09it/s] 33%|███▎      | 15/45 [00:01<00:01, 18.71it/s] 44%|████▍     | 20/45 [00:01<00:01, 24.36it/s] 53%|█████▎    | 24/45 [00:01<00:00, 21.03it/s] 64%|██████▍   | 29/45 [00:01<00:00, 25.68it/s] 76%|███████▌  | 34/45 [00:02<00:00, 28.83it/s] 87%|████████▋ | 39/45 [00:02<00:00, 32.10it/s] 96%|█████████▌| 43/45 [00:02<00:00, 24.05it/s]100%|██████████| 45/45 [00:02<00:00, 18.12it/s]
5640 images processed, 2.5056488513946533 seconds used

28.70315170288086
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN          20.89  94.80  86.66
places365     81.16  75.27  75.02
LSUN          36.86  92.11  92.17
iSUN          71.27  82.20  84.89
dtd           44.01  89.64  93.32
AVG           50.84  86.81  86.41
Retain-Acc: 0.7157
Forget-as-OOD (retain known vs forget novel):
  FPR: 88.00 AUROC: 70.69 AUIN: 95.93
7.850863218307495
