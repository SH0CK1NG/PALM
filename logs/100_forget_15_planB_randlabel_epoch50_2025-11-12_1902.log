nohup: ignoring input
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:61: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget15.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=0.0, epsilon=0.05, palm_enable=True, palm_mle_mode='all', palm_retain_only=False, pcon_inc=None, incremental=False, use_lora=False, lora_impl='native', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='head', adapter_save_path=None, adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,66,67,88,94,57,59,58,44,93,10', forget_list_path=None, forget_classes_inc=None, forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=1.0, forget_margin=100.0, forget_strategy='randlabel', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21605312
[debug] trainable_count = 112
[debug] trainable: encoder.conv1.weight
[debug] trainable: encoder.bn1.weight
[debug] trainable: encoder.bn1.bias
[debug] trainable: encoder.layer1.0.conv1.weight
[debug] trainable: encoder.layer1.0.bn1.weight
[debug] trainable: encoder.layer1.0.bn1.bias
[debug] trainable: encoder.layer1.0.conv2.weight
[debug] trainable: encoder.layer1.0.bn2.weight
[debug] trainable: encoder.layer1.0.bn2.bias
[debug] trainable: encoder.layer1.1.conv1.weight
[debug] trainable: encoder.layer1.1.bn1.weight
[debug] trainable: encoder.layer1.1.bn1.bias
[debug] trainable: encoder.layer1.1.conv2.weight
[debug] trainable: encoder.layer1.1.bn2.weight
[debug] trainable: encoder.layer1.1.bn2.bias
[debug] trainable: encoder.layer1.2.conv1.weight
[debug] trainable: encoder.layer1.2.bn1.weight
[debug] trainable: encoder.layer1.2.bn1.bias
[debug] trainable: encoder.layer1.2.conv2.weight
[debug] trainable: encoder.layer1.2.bn2.weight
[debug] trainable: encoder.layer1.2.bn2.bias
[debug] trainable: encoder.layer2.0.conv1.weight
[debug] trainable: encoder.layer2.0.bn1.weight
[debug] trainable: encoder.layer2.0.bn1.bias
[debug] trainable: encoder.layer2.0.conv2.weight
[debug] trainable: encoder.layer2.0.bn2.weight
[debug] trainable: encoder.layer2.0.bn2.bias
[debug] trainable: encoder.layer2.0.shortcut.0.weight
[debug] trainable: encoder.layer2.0.shortcut.1.weight
[debug] trainable: encoder.layer2.0.shortcut.1.bias
[debug] trainable: encoder.layer2.1.conv1.weight
[debug] trainable: encoder.layer2.1.bn1.weight
[debug] trainable: encoder.layer2.1.bn1.bias
[debug] trainable: encoder.layer2.1.conv2.weight
[debug] trainable: encoder.layer2.1.bn2.weight
[debug] trainable: encoder.layer2.1.bn2.bias
[debug] trainable: encoder.layer2.2.conv1.weight
[debug] trainable: encoder.layer2.2.bn1.weight
[debug] trainable: encoder.layer2.2.bn1.bias
[debug] trainable: encoder.layer2.2.conv2.weight
[debug] trainable: encoder.layer2.2.bn2.weight
[debug] trainable: encoder.layer2.2.bn2.bias
[debug] trainable: encoder.layer2.3.conv1.weight
[debug] trainable: encoder.layer2.3.bn1.weight
[debug] trainable: encoder.layer2.3.bn1.bias
[debug] trainable: encoder.layer2.3.conv2.weight
[debug] trainable: encoder.layer2.3.bn2.weight
[debug] trainable: encoder.layer2.3.bn2.bias
[debug] trainable: encoder.layer3.0.conv1.weight
[debug] trainable: encoder.layer3.0.bn1.weight
[debug][warn] non-LoRA trainables detected: ['encoder.conv1.weight', 'encoder.bn1.weight', 'encoder.bn1.bias', 'encoder.layer1.0.conv1.weight', 'encoder.layer1.0.bn1.weight', 'encoder.layer1.0.bn1.bias', 'encoder.layer1.0.conv2.weight', 'encoder.layer1.0.bn2.weight', 'encoder.layer1.0.bn2.bias', 'encoder.layer1.1.conv1.weight']
[trainable] param_count=21605312 tensors=112
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:550: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=bool(scaler is not None)):
/home/shaokun/PALM/trainer.py:638: UserWarning: Converting a tensor with requires_grad=True to a scalar may lead to unexpected behavior.
Consider using tensor.detach() first. (Triggered internally at /pytorch/torch/csrc/autograd/generated/python_variable_methods.cpp:835.)
  print(f"[loss-{args.forget_strategy}] ep {epoch} it {it} total={loss.item():.4f} ce_r={float(loss_retain):.4f} ce_f={float(loss_forget):.4f}")
  2%|▏         | 1/50 [00:32<26:54, 32.95s/it]  4%|▍         | 2/50 [00:49<18:27, 23.07s/it]  6%|▌         | 3/50 [01:05<15:39, 19.98s/it]  8%|▊         | 4/50 [01:22<14:22, 18.74s/it] 10%|█         | 5/50 [01:38<13:26, 17.92s/it] 12%|█▏        | 6/50 [01:54<12:43, 17.35s/it] 14%|█▍        | 7/50 [02:10<12:00, 16.76s/it] 16%|█▌        | 8/50 [02:27<11:49, 16.90s/it] 18%|█▊        | 9/50 [02:44<11:25, 16.73s/it] 20%|██        | 10/50 [03:00<11:02, 16.57s/it] 22%|██▏       | 11/50 [03:16<10:39, 16.40s/it] 24%|██▍       | 12/50 [03:32<10:25, 16.45s/it] 26%|██▌       | 13/50 [03:49<10:09, 16.47s/it] 28%|██▊       | 14/50 [04:06<09:58, 16.61s/it] 30%|███       | 15/50 [04:21<09:24, 16.13s/it][loss-randlabel] ep 0 it 0 total=10.4157 ce_r=0.0170 ce_f=10.3988
[loss-randlabel] ep 0 it 50 total=10.1020 ce_r=0.0319 ce_f=10.0701
[loss-randlabel] ep 0 it 100 total=9.6119 ce_r=0.0327 ce_f=9.5792
[loss-randlabel] ep 0 it 150 total=7.8346 ce_r=0.6542 ce_f=7.1805
[loss-randlabel] ep 0 it 200 total=6.9108 ce_r=0.8832 ce_f=6.0276
[loss-randlabel] ep 0 it 250 total=6.5794 ce_r=0.9252 ce_f=5.6542
[loss-randlabel] ep 0 it 300 total=6.6069 ce_r=0.8662 ce_f=5.7407
[loss-randlabel] ep 0 it 350 total=6.4258 ce_r=0.8599 ce_f=5.5659
[loss-randlabel] ep 1 it 10 total=6.1085 ce_r=0.8458 ce_f=5.2627
[loss-randlabel] ep 1 it 60 total=6.3504 ce_r=0.8864 ce_f=5.4640
[loss-randlabel] ep 1 it 110 total=6.0649 ce_r=0.6538 ce_f=5.4111
[loss-randlabel] ep 1 it 160 total=6.1146 ce_r=0.8747 ce_f=5.2399
[loss-randlabel] ep 1 it 210 total=6.1913 ce_r=0.6052 ce_f=5.5860
[loss-randlabel] ep 1 it 260 total=6.0893 ce_r=0.6600 ce_f=5.4294
[loss-randlabel] ep 1 it 310 total=6.1178 ce_r=0.9335 ce_f=5.1843
[loss-randlabel] ep 1 it 360 total=6.1183 ce_r=0.7706 ce_f=5.3477
[loss-randlabel] ep 2 it 20 total=6.0519 ce_r=0.9238 ce_f=5.1281
[loss-randlabel] ep 2 it 70 total=5.9491 ce_r=0.6108 ce_f=5.3383
[loss-randlabel] ep 2 it 120 total=5.8569 ce_r=0.7226 ce_f=5.1343
[loss-randlabel] ep 2 it 170 total=6.0552 ce_r=0.7553 ce_f=5.2998
[loss-randlabel] ep 2 it 220 total=5.8075 ce_r=0.7187 ce_f=5.0887
[loss-randlabel] ep 2 it 270 total=5.9554 ce_r=0.7012 ce_f=5.2542
[loss-randlabel] ep 2 it 320 total=6.0658 ce_r=0.7186 ce_f=5.3472
[loss-randlabel] ep 2 it 370 total=5.9462 ce_r=0.7580 ce_f=5.1882
[loss-randlabel] ep 3 it 30 total=6.0383 ce_r=0.7193 ce_f=5.3190
[loss-randlabel] ep 3 it 80 total=5.8822 ce_r=0.8000 ce_f=5.0822
[loss-randlabel] ep 3 it 130 total=5.9070 ce_r=0.6229 ce_f=5.2841
[loss-randlabel] ep 3 it 180 total=5.9420 ce_r=0.8278 ce_f=5.1141
[loss-randlabel] ep 3 it 230 total=5.7789 ce_r=0.8025 ce_f=4.9764
[loss-randlabel] ep 3 it 280 total=5.9881 ce_r=0.8062 ce_f=5.1818
[loss-randlabel] ep 3 it 330 total=5.8287 ce_r=0.6736 ce_f=5.1551
[loss-randlabel] ep 3 it 380 total=5.9045 ce_r=0.8795 ce_f=5.0249
[loss-randlabel] ep 4 it 40 total=5.8933 ce_r=0.7427 ce_f=5.1505
[loss-randlabel] ep 4 it 90 total=5.7645 ce_r=0.6882 ce_f=5.0762
[loss-randlabel] ep 4 it 140 total=5.9240 ce_r=0.7163 ce_f=5.2077
[loss-randlabel] ep 4 it 190 total=5.9138 ce_r=0.7807 ce_f=5.1331
[loss-randlabel] ep 4 it 240 total=5.7543 ce_r=0.7029 ce_f=5.0514
[loss-randlabel] ep 4 it 290 total=5.8205 ce_r=0.8149 ce_f=5.0055
[loss-randlabel] ep 4 it 340 total=5.8067 ce_r=0.7913 ce_f=5.0154
[loss-randlabel] ep 5 it 0 total=5.7761 ce_r=0.6582 ce_f=5.1179
[loss-randlabel] ep 5 it 50 total=5.7289 ce_r=0.7533 ce_f=4.9757
[loss-randlabel] ep 5 it 100 total=5.7700 ce_r=0.5432 ce_f=5.2268
[loss-randlabel] ep 5 it 150 total=5.7735 ce_r=0.6943 ce_f=5.0792
[loss-randlabel] ep 5 it 200 total=5.8775 ce_r=0.7038 ce_f=5.1737
[loss-randlabel] ep 5 it 250 total=5.8236 ce_r=0.7841 ce_f=5.0395
[loss-randlabel] ep 5 it 300 total=5.8253 ce_r=0.7204 ce_f=5.1049
[loss-randlabel] ep 5 it 350 total=5.6202 ce_r=0.6348 ce_f=4.9854
[loss-randlabel] ep 6 it 10 total=5.8091 ce_r=0.8239 ce_f=4.9852
[loss-randlabel] ep 6 it 60 total=5.8554 ce_r=0.7328 ce_f=5.1226
[loss-randlabel] ep 6 it 110 total=5.8083 ce_r=0.7323 ce_f=5.0760
[loss-randlabel] ep 6 it 160 total=5.7658 ce_r=0.6857 ce_f=5.0802
[loss-randlabel] ep 6 it 210 total=5.6962 ce_r=0.6529 ce_f=5.0434
[loss-randlabel] ep 6 it 260 total=5.7223 ce_r=0.7608 ce_f=4.9615
[loss-randlabel] ep 6 it 310 total=5.7012 ce_r=0.6236 ce_f=5.0776
[loss-randlabel] ep 6 it 360 total=5.8322 ce_r=0.6664 ce_f=5.1658
[loss-randlabel] ep 7 it 20 total=5.8041 ce_r=0.7552 ce_f=5.0490
[loss-randlabel] ep 7 it 70 total=5.7050 ce_r=0.6081 ce_f=5.0969
[loss-randlabel] ep 7 it 120 total=5.8473 ce_r=0.6942 ce_f=5.1531
[loss-randlabel] ep 7 it 170 total=5.8273 ce_r=0.7553 ce_f=5.0720
[loss-randlabel] ep 7 it 220 total=5.6219 ce_r=0.6255 ce_f=4.9964
[loss-randlabel] ep 7 it 270 total=5.5368 ce_r=0.7449 ce_f=4.7919
[loss-randlabel] ep 7 it 320 total=5.7341 ce_r=0.6029 ce_f=5.1312
[loss-randlabel] ep 7 it 370 total=5.6853 ce_r=0.6810 ce_f=5.0044
[loss-randlabel] ep 8 it 30 total=5.6961 ce_r=0.5936 ce_f=5.1024
[loss-randlabel] ep 8 it 80 total=5.7835 ce_r=0.7312 ce_f=5.0523
[loss-randlabel] ep 8 it 130 total=5.7868 ce_r=0.7110 ce_f=5.0758
[loss-randlabel] ep 8 it 180 total=5.6785 ce_r=0.6155 ce_f=5.0630
[loss-randlabel] ep 8 it 230 total=5.7404 ce_r=0.7641 ce_f=4.9763
[loss-randlabel] ep 8 it 280 total=5.6507 ce_r=0.6300 ce_f=5.0207
[loss-randlabel] ep 8 it 330 total=5.6699 ce_r=0.5731 ce_f=5.0968
[loss-randlabel] ep 8 it 380 total=5.7449 ce_r=0.7020 ce_f=5.0429
[loss-randlabel] ep 9 it 40 total=5.6726 ce_r=0.6926 ce_f=4.9801
[loss-randlabel] ep 9 it 90 total=5.6446 ce_r=0.6858 ce_f=4.9588
[loss-randlabel] ep 9 it 140 total=5.6810 ce_r=0.7387 ce_f=4.9423
[loss-randlabel] ep 9 it 190 total=5.6172 ce_r=0.7597 ce_f=4.8575
[loss-randlabel] ep 9 it 240 total=5.7512 ce_r=0.6688 ce_f=5.0824
[loss-randlabel] ep 9 it 290 total=5.8040 ce_r=0.7300 ce_f=5.0740
[loss-randlabel] ep 9 it 340 total=5.6232 ce_r=0.5980 ce_f=5.0251
[loss-randlabel] ep 10 it 0 total=5.7199 ce_r=0.6595 ce_f=5.0604
[loss-randlabel] ep 10 it 50 total=5.6763 ce_r=0.7134 ce_f=4.9629
[loss-randlabel] ep 10 it 100 total=5.7081 ce_r=0.6579 ce_f=5.0502
[loss-randlabel] ep 10 it 150 total=5.7170 ce_r=0.6212 ce_f=5.0959
[loss-randlabel] ep 10 it 200 total=5.6680 ce_r=0.6276 ce_f=5.0403
[loss-randlabel] ep 10 it 250 total=5.7001 ce_r=0.6798 ce_f=5.0203
[loss-randlabel] ep 10 it 300 total=5.7557 ce_r=0.7247 ce_f=5.0310
[loss-randlabel] ep 10 it 350 total=5.6432 ce_r=0.6538 ce_f=4.9894
[loss-randlabel] ep 11 it 10 total=5.6063 ce_r=0.5959 ce_f=5.0104
[loss-randlabel] ep 11 it 60 total=5.7451 ce_r=0.7157 ce_f=5.0294
[loss-randlabel] ep 11 it 110 total=5.4695 ce_r=0.6579 ce_f=4.8116
[loss-randlabel] ep 11 it 160 total=5.5437 ce_r=0.6106 ce_f=4.9331
[loss-randlabel] ep 11 it 210 total=5.7461 ce_r=0.6352 ce_f=5.1109
[loss-randlabel] ep 11 it 260 total=5.6676 ce_r=0.7639 ce_f=4.9038
[loss-randlabel] ep 11 it 310 total=5.5651 ce_r=0.5962 ce_f=4.9689
[loss-randlabel] ep 11 it 360 total=5.7555 ce_r=0.6015 ce_f=5.1540
[loss-randlabel] ep 12 it 20 total=5.5930 ce_r=0.6329 ce_f=4.9601
[loss-randlabel] ep 12 it 70 total=5.6288 ce_r=0.6241 ce_f=5.0047
[loss-randlabel] ep 12 it 120 total=5.7035 ce_r=0.6662 ce_f=5.0373
[loss-randlabel] ep 12 it 170 total=5.5588 ce_r=0.6161 ce_f=4.9427
[loss-randlabel] ep 12 it 220 total=5.7001 ce_r=0.5971 ce_f=5.1030
[loss-randlabel] ep 12 it 270 total=5.6480 ce_r=0.5729 ce_f=5.0750
[loss-randlabel] ep 12 it 320 total=5.6107 ce_r=0.6829 ce_f=4.9278
[loss-randlabel] ep 12 it 370 total=5.6494 ce_r=0.5862 ce_f=5.0632
[loss-randlabel] ep 13 it 30 total=5.6795 ce_r=0.7557 ce_f=4.9238
[loss-randlabel] ep 13 it 80 total=5.7248 ce_r=0.6707 ce_f=5.0541
[loss-randlabel] ep 13 it 130 total=5.6509 ce_r=0.5877 ce_f=5.0632
[loss-randlabel] ep 13 it 180 total=5.6932 ce_r=0.6971 ce_f=4.9961
[loss-randlabel] ep 13 it 230 total=5.6460 ce_r=0.6561 ce_f=4.9899
[loss-randlabel] ep 13 it 280 total=5.7491 ce_r=0.6864 ce_f=5.0627
[loss-randlabel] ep 13 it 330 total=5.6233 ce_r=0.6554 ce_f=4.9679
[loss-randlabel] ep 13 it 380 total=5.6001 ce_r=0.6883 ce_f=4.9118
[loss-randlabel] ep 14 it 40 total=5.6013 ce_r=0.6972 ce_f=4.9041
[loss-randlabel] ep 14 it 90 total=5.6335 ce_r=0.6081 ce_f=5.0254
[loss-randlabel] ep 14 it 140 total=5.5661 ce_r=0.7014 ce_f=4.8647
[loss-randlabel] ep 14 it 190 total=5.7260 ce_r=0.6572 ce_f=5.0688
[loss-randlabel] ep 14 it 240 total=5.7526 ce_r=0.5307 ce_f=5.2219
[loss-randlabel] ep 14 it 290 total=5.6353 ce_r=0.5734 ce_f=5.0618
[loss-randlabel] ep 14 it 340 total=5.7392 ce_r=0.6329 ce_f=5.1063
[loss-randlabel] ep 15 it 0 total=5.5426 ce_r=0.7345 ce_f=4.8081
[loss-randlabel] ep 15 it 50 total=5.6817 ce_r=0.5672 ce_f=5.1145
[loss-randlabel] ep 15 it 100 total=5.6480 ce_r=0.6688 ce_f=4.9792
[loss-randlabel] ep 15 it 150 total=5.7340 ce_r=0.6435 ce_f=5.0905
[loss-randlabel] ep 15 it 200 total=5.6863 ce_r=0.6546 ce_f=5.0317
[loss-randlabel] ep 15 it 250 total=5.6066 ce_r=0.7068 ce_f=4.8998
 32%|███▏      | 16/50 [04:36<09:01, 15.92s/it] 34%|███▍      | 17/50 [04:52<08:44, 15.89s/it] 36%|███▌      | 18/50 [05:08<08:31, 15.98s/it] 38%|███▊      | 19/50 [05:25<08:19, 16.12s/it] 40%|████      | 20/50 [05:39<07:50, 15.69s/it] 42%|████▏     | 21/50 [05:55<07:36, 15.72s/it] 44%|████▍     | 22/50 [06:11<07:19, 15.71s/it] 46%|████▌     | 23/50 [06:28<07:14, 16.08s/it] 48%|████▊     | 24/50 [06:44<07:00, 16.17s/it] 50%|█████     | 25/50 [07:00<06:39, 15.99s/it] 52%|█████▏    | 26/50 [07:15<06:18, 15.78s/it] 54%|█████▍    | 27/50 [07:32<06:07, 15.99s/it] 56%|█████▌    | 28/50 [07:48<05:57, 16.25s/it] 58%|█████▊    | 29/50 [08:05<05:40, 16.24s/it] 60%|██████    | 30/50 [08:21<05:28, 16.41s/it] 62%|██████▏   | 31/50 [08:39<05:18, 16.78s/it][loss-randlabel] ep 15 it 300 total=5.6687 ce_r=0.6324 ce_f=5.0363
[loss-randlabel] ep 15 it 350 total=5.6305 ce_r=0.6466 ce_f=4.9839
[loss-randlabel] ep 16 it 10 total=5.6014 ce_r=0.5522 ce_f=5.0492
[loss-randlabel] ep 16 it 60 total=5.6774 ce_r=0.6417 ce_f=5.0356
[loss-randlabel] ep 16 it 110 total=5.6647 ce_r=0.6839 ce_f=4.9808
[loss-randlabel] ep 16 it 160 total=5.5751 ce_r=0.5899 ce_f=4.9852
[loss-randlabel] ep 16 it 210 total=5.7782 ce_r=0.5564 ce_f=5.2218
[loss-randlabel] ep 16 it 260 total=5.7278 ce_r=0.6983 ce_f=5.0295
[loss-randlabel] ep 16 it 310 total=5.7010 ce_r=0.5958 ce_f=5.1052
[loss-randlabel] ep 16 it 360 total=5.6762 ce_r=0.6153 ce_f=5.0609
[loss-randlabel] ep 17 it 20 total=5.6445 ce_r=0.5841 ce_f=5.0603
[loss-randlabel] ep 17 it 70 total=5.6601 ce_r=0.7226 ce_f=4.9375
[loss-randlabel] ep 17 it 120 total=5.6644 ce_r=0.6423 ce_f=5.0221
[loss-randlabel] ep 17 it 170 total=5.7131 ce_r=0.7338 ce_f=4.9793
[loss-randlabel] ep 17 it 220 total=5.7239 ce_r=0.6187 ce_f=5.1053
[loss-randlabel] ep 17 it 270 total=5.6402 ce_r=0.6044 ce_f=5.0358
[loss-randlabel] ep 17 it 320 total=5.7094 ce_r=0.6614 ce_f=5.0480
[loss-randlabel] ep 17 it 370 total=5.6323 ce_r=0.6242 ce_f=5.0081
[loss-randlabel] ep 18 it 30 total=5.6547 ce_r=0.5394 ce_f=5.1153
[loss-randlabel] ep 18 it 80 total=5.7302 ce_r=0.6274 ce_f=5.1028
[loss-randlabel] ep 18 it 130 total=5.6879 ce_r=0.6699 ce_f=5.0180
[loss-randlabel] ep 18 it 180 total=5.6346 ce_r=0.5662 ce_f=5.0684
[loss-randlabel] ep 18 it 230 total=5.6845 ce_r=0.6173 ce_f=5.0672
[loss-randlabel] ep 18 it 280 total=5.6347 ce_r=0.6664 ce_f=4.9683
[loss-randlabel] ep 18 it 330 total=5.6407 ce_r=0.5969 ce_f=5.0438
[loss-randlabel] ep 18 it 380 total=5.6601 ce_r=0.5810 ce_f=5.0792
[loss-randlabel] ep 19 it 40 total=5.6266 ce_r=0.5835 ce_f=5.0430
[loss-randlabel] ep 19 it 90 total=5.7112 ce_r=0.6838 ce_f=5.0274
[loss-randlabel] ep 19 it 140 total=5.6351 ce_r=0.5835 ce_f=5.0516
[loss-randlabel] ep 19 it 190 total=5.5828 ce_r=0.6545 ce_f=4.9283
[loss-randlabel] ep 19 it 240 total=5.6866 ce_r=0.6422 ce_f=5.0444
[loss-randlabel] ep 19 it 290 total=5.4895 ce_r=0.6071 ce_f=4.8824
[loss-randlabel] ep 19 it 340 total=5.6939 ce_r=0.6495 ce_f=5.0444
[loss-randlabel] ep 20 it 0 total=5.6897 ce_r=0.6449 ce_f=5.0448
[loss-randlabel] ep 20 it 50 total=5.6712 ce_r=0.5692 ce_f=5.1020
[loss-randlabel] ep 20 it 100 total=5.6790 ce_r=0.6299 ce_f=5.0491
[loss-randlabel] ep 20 it 150 total=5.4722 ce_r=0.5980 ce_f=4.8742
[loss-randlabel] ep 20 it 200 total=5.6197 ce_r=0.6095 ce_f=5.0102
[loss-randlabel] ep 20 it 250 total=5.5568 ce_r=0.5814 ce_f=4.9755
[loss-randlabel] ep 20 it 300 total=5.7313 ce_r=0.6529 ce_f=5.0784
[loss-randlabel] ep 20 it 350 total=5.7006 ce_r=0.6828 ce_f=5.0178
[loss-randlabel] ep 21 it 10 total=5.6940 ce_r=0.6637 ce_f=5.0303
[loss-randlabel] ep 21 it 60 total=5.6940 ce_r=0.5854 ce_f=5.1085
[loss-randlabel] ep 21 it 110 total=5.6559 ce_r=0.5938 ce_f=5.0620
[loss-randlabel] ep 21 it 160 total=5.6360 ce_r=0.6004 ce_f=5.0356
[loss-randlabel] ep 21 it 210 total=5.6922 ce_r=0.6119 ce_f=5.0804
[loss-randlabel] ep 21 it 260 total=5.5302 ce_r=0.6256 ce_f=4.9046
[loss-randlabel] ep 21 it 310 total=5.6195 ce_r=0.5754 ce_f=5.0440
[loss-randlabel] ep 21 it 360 total=5.7245 ce_r=0.7170 ce_f=5.0074
[loss-randlabel] ep 22 it 20 total=5.6565 ce_r=0.6426 ce_f=5.0139
[loss-randlabel] ep 22 it 70 total=5.5741 ce_r=0.6065 ce_f=4.9677
[loss-randlabel] ep 22 it 120 total=5.6503 ce_r=0.5995 ce_f=5.0508
[loss-randlabel] ep 22 it 170 total=5.7942 ce_r=0.7322 ce_f=5.0620
[loss-randlabel] ep 22 it 220 total=5.7105 ce_r=0.5997 ce_f=5.1108
[loss-randlabel] ep 22 it 270 total=5.6349 ce_r=0.5821 ce_f=5.0528
[loss-randlabel] ep 22 it 320 total=5.5601 ce_r=0.6651 ce_f=4.8950
[loss-randlabel] ep 22 it 370 total=5.6354 ce_r=0.6069 ce_f=5.0285
[loss-randlabel] ep 23 it 30 total=5.6146 ce_r=0.6149 ce_f=4.9997
[loss-randlabel] ep 23 it 80 total=5.5498 ce_r=0.6589 ce_f=4.8909
[loss-randlabel] ep 23 it 130 total=5.5526 ce_r=0.5495 ce_f=5.0031
[loss-randlabel] ep 23 it 180 total=5.6826 ce_r=0.6834 ce_f=4.9992
[loss-randlabel] ep 23 it 230 total=5.6283 ce_r=0.7066 ce_f=4.9217
[loss-randlabel] ep 23 it 280 total=5.5942 ce_r=0.7233 ce_f=4.8709
[loss-randlabel] ep 23 it 330 total=5.5515 ce_r=0.6021 ce_f=4.9494
[loss-randlabel] ep 23 it 380 total=5.6826 ce_r=0.6029 ce_f=5.0797
[loss-randlabel] ep 24 it 40 total=5.6030 ce_r=0.6623 ce_f=4.9407
[loss-randlabel] ep 24 it 90 total=5.6221 ce_r=0.6755 ce_f=4.9467
[loss-randlabel] ep 24 it 140 total=5.4863 ce_r=0.5910 ce_f=4.8953
[loss-randlabel] ep 24 it 190 total=5.5557 ce_r=0.5736 ce_f=4.9821
[loss-randlabel] ep 24 it 240 total=5.5199 ce_r=0.5711 ce_f=4.9487
[loss-randlabel] ep 24 it 290 total=5.6974 ce_r=0.6561 ce_f=5.0413
[loss-randlabel] ep 24 it 340 total=5.6367 ce_r=0.6413 ce_f=4.9954
[loss-randlabel] ep 25 it 0 total=5.6947 ce_r=0.6769 ce_f=5.0177
[loss-randlabel] ep 25 it 50 total=5.6778 ce_r=0.6487 ce_f=5.0291
[loss-randlabel] ep 25 it 100 total=5.6576 ce_r=0.5659 ce_f=5.0917
[loss-randlabel] ep 25 it 150 total=5.7279 ce_r=0.6457 ce_f=5.0822
[loss-randlabel] ep 25 it 200 total=5.4235 ce_r=0.5353 ce_f=4.8882
[loss-randlabel] ep 25 it 250 total=5.6208 ce_r=0.6479 ce_f=4.9729
[loss-randlabel] ep 25 it 300 total=5.6130 ce_r=0.6732 ce_f=4.9399
[loss-randlabel] ep 25 it 350 total=5.4322 ce_r=0.6201 ce_f=4.8122
[loss-randlabel] ep 26 it 10 total=5.6137 ce_r=0.6130 ce_f=5.0007
[loss-randlabel] ep 26 it 60 total=5.7053 ce_r=0.5882 ce_f=5.1171
[loss-randlabel] ep 26 it 110 total=5.5742 ce_r=0.6212 ce_f=4.9531
[loss-randlabel] ep 26 it 160 total=5.6314 ce_r=0.5545 ce_f=5.0769
[loss-randlabel] ep 26 it 210 total=5.6136 ce_r=0.6330 ce_f=4.9806
[loss-randlabel] ep 26 it 260 total=5.6939 ce_r=0.6453 ce_f=5.0486
[loss-randlabel] ep 26 it 310 total=5.7177 ce_r=0.5911 ce_f=5.1266
[loss-randlabel] ep 26 it 360 total=5.4882 ce_r=0.6218 ce_f=4.8664
[loss-randlabel] ep 27 it 20 total=5.6441 ce_r=0.5451 ce_f=5.0990
[loss-randlabel] ep 27 it 70 total=5.4735 ce_r=0.6663 ce_f=4.8072
[loss-randlabel] ep 27 it 120 total=5.6091 ce_r=0.5933 ce_f=5.0159
[loss-randlabel] ep 27 it 170 total=5.6684 ce_r=0.6525 ce_f=5.0158
[loss-randlabel] ep 27 it 220 total=5.6865 ce_r=0.6311 ce_f=5.0554
[loss-randlabel] ep 27 it 270 total=5.5981 ce_r=0.5310 ce_f=5.0672
[loss-randlabel] ep 27 it 320 total=5.5599 ce_r=0.5922 ce_f=4.9677
[loss-randlabel] ep 27 it 370 total=5.6559 ce_r=0.5759 ce_f=5.0800
[loss-randlabel] ep 28 it 30 total=5.7336 ce_r=0.6153 ce_f=5.1183
[loss-randlabel] ep 28 it 80 total=5.5870 ce_r=0.6650 ce_f=4.9221
[loss-randlabel] ep 28 it 130 total=5.6803 ce_r=0.6316 ce_f=5.0487
[loss-randlabel] ep 28 it 180 total=5.6817 ce_r=0.5733 ce_f=5.1083
[loss-randlabel] ep 28 it 230 total=5.6527 ce_r=0.6383 ce_f=5.0144
[loss-randlabel] ep 28 it 280 total=5.6234 ce_r=0.7443 ce_f=4.8791
[loss-randlabel] ep 28 it 330 total=5.6737 ce_r=0.6337 ce_f=5.0399
[loss-randlabel] ep 28 it 380 total=5.5698 ce_r=0.5572 ce_f=5.0125
[loss-randlabel] ep 29 it 40 total=5.6258 ce_r=0.5710 ce_f=5.0548
[loss-randlabel] ep 29 it 90 total=5.6193 ce_r=0.6779 ce_f=4.9414
[loss-randlabel] ep 29 it 140 total=5.6483 ce_r=0.6550 ce_f=4.9933
[loss-randlabel] ep 29 it 190 total=5.7288 ce_r=0.6846 ce_f=5.0443
[loss-randlabel] ep 29 it 240 total=5.5281 ce_r=0.5171 ce_f=5.0111
[loss-randlabel] ep 29 it 290 total=5.5657 ce_r=0.5878 ce_f=4.9779
[loss-randlabel] ep 29 it 340 total=5.6816 ce_r=0.6759 ce_f=5.0057
[loss-randlabel] ep 30 it 0 total=5.6210 ce_r=0.5570 ce_f=5.0640
[loss-randlabel] ep 30 it 50 total=5.5813 ce_r=0.5902 ce_f=4.9911
[loss-randlabel] ep 30 it 100 total=5.6145 ce_r=0.5991 ce_f=5.0153
[loss-randlabel] ep 30 it 150 total=5.5851 ce_r=0.6702 ce_f=4.9148
[loss-randlabel] ep 30 it 200 total=5.6115 ce_r=0.5992 ce_f=5.0122
[loss-randlabel] ep 30 it 250 total=5.4952 ce_r=0.5652 ce_f=4.9300
[loss-randlabel] ep 30 it 300 total=5.6583 ce_r=0.6289 ce_f=5.0294
[loss-randlabel] ep 30 it 350 total=5.6448 ce_r=0.6117 ce_f=5.0331
[loss-randlabel] ep 31 it 10 total=5.6836 ce_r=0.5924 ce_f=5.0913
[loss-randlabel] ep 31 it 60 total=5.5543 ce_r=0.6131 ce_f=4.9412
[loss-randlabel] ep 31 it 110 total=5.6555 ce_r=0.5327 ce_f=5.1228
 64%|██████▍   | 32/50 [08:55<04:56, 16.46s/it] 66%|██████▌   | 33/50 [09:10<04:35, 16.22s/it] 68%|██████▊   | 34/50 [09:26<04:18, 16.13s/it] 70%|███████   | 35/50 [09:42<04:01, 16.09s/it] 72%|███████▏  | 36/50 [09:58<03:42, 15.91s/it] 74%|███████▍  | 37/50 [10:12<03:21, 15.50s/it] 76%|███████▌  | 38/50 [10:28<03:07, 15.65s/it] 78%|███████▊  | 39/50 [10:43<02:50, 15.49s/it] 80%|████████  | 40/50 [10:59<02:33, 15.39s/it] 82%|████████▏ | 41/50 [11:14<02:18, 15.38s/it] 84%|████████▍ | 42/50 [11:30<02:03, 15.44s/it] 86%|████████▌ | 43/50 [11:46<01:49, 15.65s/it] 88%|████████▊ | 44/50 [12:02<01:35, 15.87s/it] 90%|█████████ | 45/50 [12:18<01:18, 15.73s/it] 92%|█████████▏| 46/50 [12:33<01:02, 15.74s/it] 94%|█████████▍| 47/50 [12:50<00:48, 16.18s/it][loss-randlabel] ep 31 it 160 total=5.7025 ce_r=0.7024 ce_f=5.0001
[loss-randlabel] ep 31 it 210 total=5.6335 ce_r=0.5998 ce_f=5.0337
[loss-randlabel] ep 31 it 260 total=5.6814 ce_r=0.6685 ce_f=5.0130
[loss-randlabel] ep 31 it 310 total=5.5433 ce_r=0.5709 ce_f=4.9724
[loss-randlabel] ep 31 it 360 total=5.7089 ce_r=0.6688 ce_f=5.0401
[loss-randlabel] ep 32 it 20 total=5.5612 ce_r=0.6476 ce_f=4.9136
[loss-randlabel] ep 32 it 70 total=5.7012 ce_r=0.7047 ce_f=4.9965
[loss-randlabel] ep 32 it 120 total=5.7210 ce_r=0.6275 ce_f=5.0935
[loss-randlabel] ep 32 it 170 total=5.6796 ce_r=0.7308 ce_f=4.9489
[loss-randlabel] ep 32 it 220 total=5.6368 ce_r=0.6014 ce_f=5.0354
[loss-randlabel] ep 32 it 270 total=5.6589 ce_r=0.7205 ce_f=4.9384
[loss-randlabel] ep 32 it 320 total=5.4777 ce_r=0.5901 ce_f=4.8876
[loss-randlabel] ep 32 it 370 total=5.6580 ce_r=0.5895 ce_f=5.0685
[loss-randlabel] ep 33 it 30 total=5.6460 ce_r=0.7264 ce_f=4.9196
[loss-randlabel] ep 33 it 80 total=5.7398 ce_r=0.6246 ce_f=5.1151
[loss-randlabel] ep 33 it 130 total=5.5698 ce_r=0.5822 ce_f=4.9876
[loss-randlabel] ep 33 it 180 total=5.6820 ce_r=0.6489 ce_f=5.0332
[loss-randlabel] ep 33 it 230 total=5.6467 ce_r=0.5589 ce_f=5.0878
[loss-randlabel] ep 33 it 280 total=5.6399 ce_r=0.5785 ce_f=5.0614
[loss-randlabel] ep 33 it 330 total=5.5474 ce_r=0.5732 ce_f=4.9742
[loss-randlabel] ep 33 it 380 total=5.5597 ce_r=0.5788 ce_f=4.9809
[loss-randlabel] ep 34 it 40 total=5.6481 ce_r=0.5628 ce_f=5.0854
[loss-randlabel] ep 34 it 90 total=5.6615 ce_r=0.5656 ce_f=5.0959
[loss-randlabel] ep 34 it 140 total=5.4503 ce_r=0.6000 ce_f=4.8503
[loss-randlabel] ep 34 it 190 total=5.6330 ce_r=0.6202 ce_f=5.0128
[loss-randlabel] ep 34 it 240 total=5.6750 ce_r=0.6601 ce_f=5.0149
[loss-randlabel] ep 34 it 290 total=5.6399 ce_r=0.6317 ce_f=5.0081
[loss-randlabel] ep 34 it 340 total=5.3749 ce_r=0.6384 ce_f=4.7364
[loss-randlabel] ep 35 it 0 total=5.5568 ce_r=0.5819 ce_f=4.9749
[loss-randlabel] ep 35 it 50 total=5.6777 ce_r=0.6155 ce_f=5.0622
[loss-randlabel] ep 35 it 100 total=5.6522 ce_r=0.5311 ce_f=5.1211
[loss-randlabel] ep 35 it 150 total=5.6520 ce_r=0.5875 ce_f=5.0645
[loss-randlabel] ep 35 it 200 total=5.5342 ce_r=0.5527 ce_f=4.9815
[loss-randlabel] ep 35 it 250 total=5.6066 ce_r=0.7034 ce_f=4.9032
[loss-randlabel] ep 35 it 300 total=5.6094 ce_r=0.5661 ce_f=5.0433
[loss-randlabel] ep 35 it 350 total=5.6492 ce_r=0.6141 ce_f=5.0352
[loss-randlabel] ep 36 it 10 total=5.5644 ce_r=0.6073 ce_f=4.9571
[loss-randlabel] ep 36 it 60 total=5.5801 ce_r=0.5818 ce_f=4.9983
[loss-randlabel] ep 36 it 110 total=5.6226 ce_r=0.5833 ce_f=5.0393
[loss-randlabel] ep 36 it 160 total=5.6064 ce_r=0.6039 ce_f=5.0025
[loss-randlabel] ep 36 it 210 total=5.6689 ce_r=0.5784 ce_f=5.0905
[loss-randlabel] ep 36 it 260 total=5.6626 ce_r=0.6237 ce_f=5.0388
[loss-randlabel] ep 36 it 310 total=5.5413 ce_r=0.6158 ce_f=4.9255
[loss-randlabel] ep 36 it 360 total=5.5997 ce_r=0.6179 ce_f=4.9818
[loss-randlabel] ep 37 it 20 total=5.5291 ce_r=0.6286 ce_f=4.9005
[loss-randlabel] ep 37 it 70 total=5.6518 ce_r=0.6951 ce_f=4.9567
[loss-randlabel] ep 37 it 120 total=5.6476 ce_r=0.6237 ce_f=5.0239
[loss-randlabel] ep 37 it 170 total=5.6358 ce_r=0.5666 ce_f=5.0692
[loss-randlabel] ep 37 it 220 total=5.6371 ce_r=0.5653 ce_f=5.0718
[loss-randlabel] ep 37 it 270 total=5.6577 ce_r=0.6101 ce_f=5.0476
[loss-randlabel] ep 37 it 320 total=5.6184 ce_r=0.5661 ce_f=5.0523
[loss-randlabel] ep 37 it 370 total=5.6541 ce_r=0.6027 ce_f=5.0515
[loss-randlabel] ep 38 it 30 total=5.5946 ce_r=0.5753 ce_f=5.0194
[loss-randlabel] ep 38 it 80 total=5.5826 ce_r=0.6198 ce_f=4.9628
[loss-randlabel] ep 38 it 130 total=5.5630 ce_r=0.6614 ce_f=4.9016
[loss-randlabel] ep 38 it 180 total=5.6074 ce_r=0.6213 ce_f=4.9861
[loss-randlabel] ep 38 it 230 total=5.6934 ce_r=0.5812 ce_f=5.1122
[loss-randlabel] ep 38 it 280 total=5.6828 ce_r=0.6026 ce_f=5.0802
[loss-randlabel] ep 38 it 330 total=5.6397 ce_r=0.5586 ce_f=5.0811
[loss-randlabel] ep 38 it 380 total=5.6658 ce_r=0.5589 ce_f=5.1069
[loss-randlabel] ep 39 it 40 total=5.5615 ce_r=0.5765 ce_f=4.9850
[loss-randlabel] ep 39 it 90 total=5.6965 ce_r=0.5999 ce_f=5.0966
[loss-randlabel] ep 39 it 140 total=5.6313 ce_r=0.6343 ce_f=4.9969
[loss-randlabel] ep 39 it 190 total=5.5201 ce_r=0.6474 ce_f=4.8727
[loss-randlabel] ep 39 it 240 total=5.4922 ce_r=0.5896 ce_f=4.9026
[loss-randlabel] ep 39 it 290 total=5.5770 ce_r=0.6088 ce_f=4.9682
[loss-randlabel] ep 39 it 340 total=5.7241 ce_r=0.5745 ce_f=5.1496
[loss-randlabel] ep 40 it 0 total=5.4885 ce_r=0.5584 ce_f=4.9301
[loss-randlabel] ep 40 it 50 total=5.6574 ce_r=0.5535 ce_f=5.1038
[loss-randlabel] ep 40 it 100 total=5.6247 ce_r=0.6033 ce_f=5.0214
[loss-randlabel] ep 40 it 150 total=5.3653 ce_r=0.5829 ce_f=4.7824
[loss-randlabel] ep 40 it 200 total=5.6192 ce_r=0.5259 ce_f=5.0933
[loss-randlabel] ep 40 it 250 total=5.6235 ce_r=0.6205 ce_f=5.0030
[loss-randlabel] ep 40 it 300 total=5.6112 ce_r=0.6393 ce_f=4.9719
[loss-randlabel] ep 40 it 350 total=5.6858 ce_r=0.6110 ce_f=5.0748
[loss-randlabel] ep 41 it 10 total=5.5629 ce_r=0.5893 ce_f=4.9737
[loss-randlabel] ep 41 it 60 total=5.6821 ce_r=0.6358 ce_f=5.0463
[loss-randlabel] ep 41 it 110 total=5.6032 ce_r=0.5812 ce_f=5.0219
[loss-randlabel] ep 41 it 160 total=5.6331 ce_r=0.5750 ce_f=5.0580
[loss-randlabel] ep 41 it 210 total=5.6231 ce_r=0.5619 ce_f=5.0612
[loss-randlabel] ep 41 it 260 total=5.5889 ce_r=0.5730 ce_f=5.0158
[loss-randlabel] ep 41 it 310 total=5.6002 ce_r=0.6180 ce_f=4.9822
[loss-randlabel] ep 41 it 360 total=5.4964 ce_r=0.6574 ce_f=4.8390
[loss-randlabel] ep 42 it 20 total=5.6754 ce_r=0.6412 ce_f=5.0342
[loss-randlabel] ep 42 it 70 total=5.6141 ce_r=0.6269 ce_f=4.9872
[loss-randlabel] ep 42 it 120 total=5.4955 ce_r=0.5839 ce_f=4.9115
[loss-randlabel] ep 42 it 170 total=5.4559 ce_r=0.6183 ce_f=4.8376
[loss-randlabel] ep 42 it 220 total=5.6586 ce_r=0.6198 ce_f=5.0388
[loss-randlabel] ep 42 it 270 total=5.4677 ce_r=0.6467 ce_f=4.8210
[loss-randlabel] ep 42 it 320 total=5.6007 ce_r=0.6035 ce_f=4.9972
[loss-randlabel] ep 42 it 370 total=5.6043 ce_r=0.6429 ce_f=4.9614
[loss-randlabel] ep 43 it 30 total=5.6044 ce_r=0.6151 ce_f=4.9892
[loss-randlabel] ep 43 it 80 total=5.5680 ce_r=0.5765 ce_f=4.9915
[loss-randlabel] ep 43 it 130 total=5.6286 ce_r=0.6276 ce_f=5.0010
[loss-randlabel] ep 43 it 180 total=5.6977 ce_r=0.5740 ce_f=5.1237
[loss-randlabel] ep 43 it 230 total=5.5024 ce_r=0.6075 ce_f=4.8949
[loss-randlabel] ep 43 it 280 total=5.5564 ce_r=0.6766 ce_f=4.8798
[loss-randlabel] ep 43 it 330 total=5.6270 ce_r=0.5702 ce_f=5.0568
[loss-randlabel] ep 43 it 380 total=5.4627 ce_r=0.5543 ce_f=4.9084
[loss-randlabel] ep 44 it 40 total=5.5536 ce_r=0.6316 ce_f=4.9220
[loss-randlabel] ep 44 it 90 total=5.6818 ce_r=0.5710 ce_f=5.1108
[loss-randlabel] ep 44 it 140 total=5.6296 ce_r=0.5832 ce_f=5.0464
[loss-randlabel] ep 44 it 190 total=5.6050 ce_r=0.6012 ce_f=5.0038
[loss-randlabel] ep 44 it 240 total=5.5959 ce_r=0.6891 ce_f=4.9067
[loss-randlabel] ep 44 it 290 total=5.6498 ce_r=0.5975 ce_f=5.0523
[loss-randlabel] ep 44 it 340 total=5.5937 ce_r=0.6123 ce_f=4.9814
[loss-randlabel] ep 45 it 0 total=5.6341 ce_r=0.6009 ce_f=5.0332
[loss-randlabel] ep 45 it 50 total=5.5351 ce_r=0.6188 ce_f=4.9163
[loss-randlabel] ep 45 it 100 total=5.6033 ce_r=0.5616 ce_f=5.0416
[loss-randlabel] ep 45 it 150 total=5.5466 ce_r=0.6011 ce_f=4.9455
[loss-randlabel] ep 45 it 200 total=5.6581 ce_r=0.5956 ce_f=5.0626
[loss-randlabel] ep 45 it 250 total=5.4618 ce_r=0.6199 ce_f=4.8419
[loss-randlabel] ep 45 it 300 total=5.6052 ce_r=0.5826 ce_f=5.0226
[loss-randlabel] ep 45 it 350 total=5.6200 ce_r=0.5869 ce_f=5.0331
[loss-randlabel] ep 46 it 10 total=5.6429 ce_r=0.5662 ce_f=5.0767
[loss-randlabel] ep 46 it 60 total=5.6001 ce_r=0.5118 ce_f=5.0883
[loss-randlabel] ep 46 it 110 total=5.5536 ce_r=0.6401 ce_f=4.9135
[loss-randlabel] ep 46 it 160 total=5.5883 ce_r=0.5248 ce_f=5.0635
[loss-randlabel] ep 46 it 210 total=5.5652 ce_r=0.6024 ce_f=4.9628
[loss-randlabel] ep 46 it 260 total=5.6032 ce_r=0.5999 ce_f=5.0033
[loss-randlabel] ep 46 it 310 total=5.6438 ce_r=0.6282 ce_f=5.0156
[loss-randlabel] ep 46 it 360 total=5.6465 ce_r=0.6662 ce_f=4.9803
 96%|█████████▌| 48/50 [13:06<00:32, 16.03s/it] 98%|█████████▊| 49/50 [13:23<00:16, 16.19s/it]100%|██████████| 50/50 [13:39<00:00, 16.24s/it]100%|██████████| 50/50 [13:39<00:00, 16.39s/it]
[loss-randlabel] ep 47 it 20 total=5.5539 ce_r=0.5936 ce_f=4.9602
[loss-randlabel] ep 47 it 70 total=5.5827 ce_r=0.6944 ce_f=4.8882
[loss-randlabel] ep 47 it 120 total=5.5404 ce_r=0.5529 ce_f=4.9875
[loss-randlabel] ep 47 it 170 total=5.6014 ce_r=0.5803 ce_f=5.0212
[loss-randlabel] ep 47 it 220 total=5.5888 ce_r=0.6411 ce_f=4.9477
[loss-randlabel] ep 47 it 270 total=5.5152 ce_r=0.6443 ce_f=4.8709
[loss-randlabel] ep 47 it 320 total=5.5390 ce_r=0.6010 ce_f=4.9380
[loss-randlabel] ep 47 it 370 total=5.5722 ce_r=0.6202 ce_f=4.9520
[loss-randlabel] ep 48 it 30 total=5.6419 ce_r=0.5953 ce_f=5.0466
[loss-randlabel] ep 48 it 80 total=5.7221 ce_r=0.6437 ce_f=5.0784
[loss-randlabel] ep 48 it 130 total=5.5403 ce_r=0.5437 ce_f=4.9965
[loss-randlabel] ep 48 it 180 total=5.5279 ce_r=0.5320 ce_f=4.9959
[loss-randlabel] ep 48 it 230 total=5.6112 ce_r=0.6371 ce_f=4.9741
[loss-randlabel] ep 48 it 280 total=5.6078 ce_r=0.6151 ce_f=4.9927
[loss-randlabel] ep 48 it 330 total=5.6115 ce_r=0.6140 ce_f=4.9975
[loss-randlabel] ep 48 it 380 total=5.5688 ce_r=0.6172 ce_f=4.9517
[loss-randlabel] ep 49 it 40 total=5.6077 ce_r=0.5528 ce_f=5.0549
[loss-randlabel] ep 49 it 90 total=5.5512 ce_r=0.6021 ce_f=4.9492
[loss-randlabel] ep 49 it 140 total=5.6097 ce_r=0.6300 ce_f=4.9797
[loss-randlabel] ep 49 it 190 total=5.7080 ce_r=0.6436 ce_f=5.0644
[loss-randlabel] ep 49 it 240 total=5.6650 ce_r=0.6736 ce_f=4.9914
[loss-randlabel] ep 49 it 290 total=5.5786 ce_r=0.5746 ce_f=5.0041
[loss-randlabel] ep 49 it 340 total=5.6142 ce_r=0.5572 ce_f=5.0570
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget15.pt
resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget15: Number of model parameters: 21605312
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:14,  1.53it/s]  3%|▎         | 11/391 [00:00<00:20, 18.91it/s]  6%|▌         | 22/391 [00:00<00:10, 36.57it/s]  8%|▊         | 33/391 [00:00<00:06, 51.66it/s] 11%|█         | 42/391 [00:01<00:05, 58.34it/s] 13%|█▎        | 51/391 [00:01<00:05, 64.67it/s] 16%|█▌        | 61/391 [00:01<00:04, 73.62it/s] 18%|█▊        | 72/391 [00:01<00:03, 81.47it/s] 21%|██        | 83/391 [00:01<00:03, 86.95it/s] 24%|██▍       | 94/391 [00:01<00:03, 91.04it/s] 27%|██▋       | 104/391 [00:01<00:03, 93.02it/s] 29%|██▉       | 115/391 [00:01<00:02, 95.39it/s] 32%|███▏      | 126/391 [00:01<00:02, 97.17it/s] 35%|███▌      | 137/391 [00:02<00:02, 98.17it/s] 38%|███▊      | 148/391 [00:02<00:02, 98.95it/s] 41%|████      | 159/391 [00:02<00:02, 99.70it/s] 43%|████▎     | 170/391 [00:02<00:02, 100.05it/s] 46%|████▋     | 181/391 [00:02<00:02, 99.94it/s]  49%|████▉     | 192/391 [00:02<00:01, 100.28it/s] 52%|█████▏    | 203/391 [00:02<00:01, 100.30it/s] 55%|█████▍    | 214/391 [00:02<00:01, 99.74it/s]  57%|█████▋    | 224/391 [00:02<00:01, 95.15it/s] 60%|█████▉    | 234/391 [00:03<00:01, 95.90it/s] 63%|██████▎   | 245/391 [00:03<00:01, 97.42it/s] 65%|██████▌   | 255/391 [00:03<00:01, 95.98it/s] 68%|██████▊   | 265/391 [00:03<00:01, 96.83it/s] 71%|███████   | 276/391 [00:03<00:01, 98.30it/s] 73%|███████▎  | 286/391 [00:03<00:01, 97.19it/s] 76%|███████▌  | 296/391 [00:03<00:01, 87.56it/s] 78%|███████▊  | 305/391 [00:03<00:00, 88.14it/s] 81%|████████  | 316/391 [00:03<00:00, 91.85it/s] 84%|████████▎ | 327/391 [00:04<00:00, 94.59it/s] 86%|████████▌ | 337/391 [00:04<00:00, 92.47it/s] 89%|████████▊ | 347/391 [00:04<00:00, 90.62it/s] 91%|█████████▏| 357/391 [00:04<00:00, 87.59it/s] 94%|█████████▎| 366/391 [00:04<00:00, 84.15it/s] 96%|█████████▌| 376/391 [00:04<00:00, 87.31it/s] 99%|█████████▊| 386/391 [00:04<00:00, 90.10it/s]100%|██████████| 391/391 [00:04<00:00, 81.44it/s]
50000 images processed, 4.932810068130493 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:29,  2.62it/s] 10%|█         | 8/79 [00:00<00:03, 20.63it/s] 22%|██▏       | 17/79 [00:00<00:01, 39.66it/s] 34%|███▍      | 27/79 [00:00<00:00, 55.71it/s] 47%|████▋     | 37/79 [00:00<00:00, 67.24it/s] 59%|█████▉    | 47/79 [00:00<00:00, 75.33it/s] 72%|███████▏  | 57/79 [00:01<00:00, 81.88it/s] 85%|████████▍ | 67/79 [00:01<00:00, 86.72it/s] 97%|█████████▋| 77/79 [00:01<00:00, 90.00it/s]100%|██████████| 79/79 [00:01<00:00, 52.97it/s]
10000 images processed, 1.546433687210083 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget15/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:58,  1.72it/s]  5%|▌         | 11/204 [00:00<00:09, 20.75it/s] 10%|█         | 21/204 [00:00<00:04, 37.44it/s] 15%|█▌        | 31/204 [00:00<00:03, 51.65it/s] 20%|██        | 41/204 [00:01<00:02, 61.00it/s] 25%|██▌       | 51/204 [00:01<00:02, 70.76it/s] 30%|██▉       | 61/204 [00:01<00:01, 78.19it/s] 35%|███▍      | 71/204 [00:01<00:01, 83.40it/s] 40%|███▉      | 81/204 [00:01<00:01, 87.27it/s] 45%|████▍     | 91/204 [00:01<00:01, 90.46it/s] 50%|████▉     | 101/204 [00:01<00:01, 93.14it/s] 54%|█████▍    | 111/204 [00:01<00:00, 94.65it/s] 59%|█████▉    | 121/204 [00:01<00:00, 96.20it/s] 64%|██████▍   | 131/204 [00:01<00:00, 97.29it/s] 69%|██████▉   | 141/204 [00:02<00:00, 98.07it/s] 74%|███████▍  | 151/204 [00:02<00:00, 97.83it/s] 79%|███████▉  | 161/204 [00:02<00:00, 98.06it/s] 84%|████████▍ | 171/204 [00:02<00:00, 97.70it/s] 89%|████████▉ | 182/204 [00:02<00:00, 98.51it/s] 95%|█████████▍| 193/204 [00:02<00:00, 99.66it/s]100%|██████████| 204/204 [00:02<00:00, 100.14it/s]100%|██████████| 204/204 [00:02<00:00, 76.57it/s] 
26032 images processed, 2.7041962146759033 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.59it/s] 14%|█▍        | 11/79 [00:00<00:03, 19.78it/s] 25%|██▌       | 20/79 [00:00<00:01, 34.05it/s] 35%|███▌      | 28/79 [00:00<00:01, 40.38it/s] 48%|████▊     | 38/79 [00:01<00:00, 53.31it/s] 61%|██████    | 48/79 [00:01<00:00, 63.43it/s] 72%|███████▏  | 57/79 [00:01<00:00, 67.23it/s] 82%|████████▏ | 65/79 [00:01<00:00, 64.41it/s] 96%|█████████▌| 76/79 [00:01<00:00, 74.38it/s]100%|██████████| 79/79 [00:01<00:00, 50.04it/s]
10000 images processed, 1.6066999435424805 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.92it/s] 11%|█▏        | 9/79 [00:00<00:03, 18.44it/s] 24%|██▍       | 19/79 [00:00<00:01, 36.91it/s] 37%|███▋      | 29/79 [00:00<00:00, 51.93it/s] 49%|████▉     | 39/79 [00:00<00:00, 63.45it/s] 62%|██████▏   | 49/79 [00:01<00:00, 73.14it/s] 76%|███████▌  | 60/79 [00:01<00:00, 81.20it/s] 90%|████████▉ | 71/79 [00:01<00:00, 87.25it/s]100%|██████████| 79/79 [00:01<00:00, 59.27it/s]
10000 images processed, 1.3514890670776367 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:39,  1.76it/s] 16%|█▌        | 11/70 [00:00<00:02, 21.03it/s] 31%|███▏      | 22/70 [00:00<00:01, 39.66it/s] 46%|████▌     | 32/70 [00:00<00:00, 53.41it/s] 61%|██████▏   | 43/70 [00:01<00:00, 65.92it/s] 77%|███████▋  | 54/70 [00:01<00:00, 75.59it/s] 93%|█████████▎| 65/70 [00:01<00:00, 82.77it/s]100%|██████████| 70/70 [00:01<00:00, 55.04it/s]
8925 images processed, 1.3074986934661865 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:38,  1.14it/s]  4%|▍         | 2/45 [00:00<00:18,  2.34it/s] 13%|█▎        | 6/45 [00:01<00:05,  7.48it/s] 33%|███▎      | 15/45 [00:01<00:01, 21.52it/s] 44%|████▍     | 20/45 [00:01<00:01, 21.16it/s] 53%|█████▎    | 24/45 [00:01<00:00, 21.58it/s] 73%|███████▎  | 33/45 [00:01<00:00, 25.98it/s] 87%|████████▋ | 39/45 [00:02<00:00, 29.94it/s] 96%|█████████▌| 43/45 [00:02<00:00, 28.26it/s]100%|██████████| 45/45 [00:02<00:00, 18.77it/s]
5640 images processed, 2.4370880126953125 seconds used

17.45815086364746
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/CILPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           4.64  98.89  96.68
places365     71.60  79.33  75.49
LSUN          25.50  94.89  94.80
iSUN          66.32  84.82  86.52
dtd           45.11  89.88  93.08
AVG           42.63  89.56  89.31
Retain-Acc: 0.7529
Forget-as-OOD (retain known vs forget novel):
  FPR: 47.00 AUROC: 90.55 AUIN: 98.07
8.869054794311523
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget15_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-baseline-randlabel-b128-e50-lr0.001-wd1e-4-fl1-CIFAR-100forget15_rf.png
