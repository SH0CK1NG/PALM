nohup: ignoring input
==== Stage 1: forget_inc={0,8,11,40,51}; forget_seen={}; all={0,8,11,40,51,66,67,88,94,57} ====
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:54: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1', adapter_load_path=None, lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,66,67,88,94,57', forget_list_path=None, forget_classes_inc='0,8,11,40,51', forget_classes_seen=None, retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:163: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [00:38<31:14, 38.25s/it]  4%|▍         | 2/50 [01:15<30:17, 37.87s/it]  6%|▌         | 3/50 [01:50<28:25, 36.29s/it]  8%|▊         | 4/50 [02:24<27:07, 35.37s/it] 10%|█         | 5/50 [02:58<26:12, 34.94s/it] 12%|█▏        | 6/50 [03:32<25:22, 34.60s/it][loss] ep 0 it 0 total=8.5977 mle=1.8293 pcon=5.2950 forget=1.4733 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 50 total=8.6425 mle=1.9035 pcon=5.2884 forget=1.4506 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 100 total=8.5285 mle=1.7937 pcon=5.2815 forget=1.4534 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 150 total=8.4503 mle=1.7177 pcon=5.2750 forget=1.4576 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 200 total=8.4973 mle=1.7454 pcon=5.2685 forget=1.4834 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 250 total=8.5017 mle=1.7720 pcon=5.2623 forget=1.4675 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 300 total=8.4491 mle=1.7796 pcon=5.2562 forget=1.4134 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 0 it 350 total=8.4942 mle=1.8205 pcon=5.2502 forget=1.4235 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 1 it 10 total=8.4306 mle=1.7634 pcon=5.2445 forget=1.4227 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 60 total=8.4302 mle=1.7535 pcon=5.2386 forget=1.4380 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 110 total=8.3021 mle=1.6298 pcon=5.2328 forget=1.4395 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 160 total=8.3852 mle=1.7727 pcon=5.2273 forget=1.3852 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 210 total=8.5324 mle=1.8929 pcon=5.2216 forget=1.4179 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 260 total=8.5410 mle=1.9197 pcon=5.2166 forget=1.4047 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 310 total=8.5246 mle=1.8776 pcon=5.2118 forget=1.4352 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 1 it 360 total=8.4084 mle=1.7377 pcon=5.2067 forget=1.4640 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 2 it 20 total=8.4201 mle=1.7942 pcon=5.2015 forget=1.4244 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 70 total=8.3202 mle=1.7351 pcon=5.1964 forget=1.3887 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 120 total=8.3617 mle=1.7632 pcon=5.1913 forget=1.4072 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 170 total=8.1841 mle=1.5783 pcon=5.1867 forget=1.4191 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 220 total=8.5176 mle=1.9285 pcon=5.1819 forget=1.4072 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 270 total=8.3466 mle=1.7575 pcon=5.1773 forget=1.4117 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 320 total=8.4557 mle=1.8544 pcon=5.1729 forget=1.4284 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 2 it 370 total=8.2939 mle=1.7250 pcon=5.1683 forget=1.4006 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 3 it 30 total=8.4086 mle=1.8506 pcon=5.1641 forget=1.3939 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 80 total=8.4613 mle=1.9261 pcon=5.1595 forget=1.3757 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 130 total=8.2603 mle=1.7048 pcon=5.1554 forget=1.4000 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 180 total=8.3622 mle=1.8257 pcon=5.1509 forget=1.3855 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 230 total=8.2368 mle=1.6840 pcon=5.1468 forget=1.4060 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 280 total=8.2284 mle=1.6609 pcon=5.1430 forget=1.4245 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 330 total=8.2957 mle=1.7349 pcon=5.1396 forget=1.4212 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 3 it 380 total=8.2177 mle=1.6832 pcon=5.1357 forget=1.3988 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 4 it 40 total=8.1217 mle=1.5625 pcon=5.1321 forget=1.4271 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 90 total=8.2743 mle=1.7436 pcon=5.1286 forget=1.4021 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 140 total=8.1066 mle=1.5867 pcon=5.1250 forget=1.3949 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 190 total=8.4356 mle=1.8985 pcon=5.1215 forget=1.4157 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 240 total=8.3868 mle=1.8173 pcon=5.1180 forget=1.4515 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 290 total=8.2603 mle=1.7325 pcon=5.1146 forget=1.4132 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 4 it 340 total=8.1194 mle=1.6161 pcon=5.1113 forget=1.3920 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 5 it 0 total=8.1513 mle=1.6442 pcon=5.1079 forget=1.3991 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 50 total=8.2176 mle=1.7285 pcon=5.1048 forget=1.3842 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 100 total=8.3075 mle=1.7833 pcon=5.1016 forget=1.4226 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 150 total=8.4534 mle=1.9554 pcon=5.0988 forget=1.3991 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 200 total=8.2773 mle=1.7876 pcon=5.0959 forget=1.3938 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 250 total=8.2096 mle=1.7155 pcon=5.0928 forget=1.4013 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 300 total=8.2841 mle=1.8000 pcon=5.0902 forget=1.3939 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 5 it 350 total=8.2353 mle=1.7383 pcon=5.0872 forget=1.4098 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 6 it 10 total=8.3859 mle=1.9008 pcon=5.0839 forget=1.4012 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 60 total=8.1604 mle=1.6959 pcon=5.0813 forget=1.3832 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 110 total=8.1229 mle=1.6664 pcon=5.0788 forget=1.3776 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 160 total=8.2216 mle=1.7502 pcon=5.0764 forget=1.3950 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 210 total=8.2963 mle=1.8401 pcon=5.0734 forget=1.3828 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 260 total=8.3773 mle=1.9181 pcon=5.0710 forget=1.3882 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 310 total=8.3629 mle=1.8857 pcon=5.0684 forget=1.4088 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 6 it 360 total=8.2492 mle=1.7967 pcon=5.0662 forget=1.3863 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 14%|█▍        | 7/50 [04:07<25:01, 34.91s/it] 16%|█▌        | 8/50 [04:45<25:08, 35.92s/it] 18%|█▊        | 9/50 [05:21<24:25, 35.75s/it] 20%|██        | 10/50 [05:57<23:55, 35.88s/it] 22%|██▏       | 11/50 [06:33<23:17, 35.85s/it] 24%|██▍       | 12/50 [07:08<22:36, 35.71s/it] 26%|██▌       | 13/50 [07:45<22:11, 35.98s/it] 28%|██▊       | 14/50 [08:22<21:51, 36.42s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 7 it 20 total=8.1648 mle=1.6980 pcon=5.0637 forget=1.4032 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 70 total=8.0091 mle=1.5601 pcon=5.0617 forget=1.3872 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 120 total=8.0506 mle=1.6355 pcon=5.0592 forget=1.3559 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 170 total=8.1335 mle=1.7032 pcon=5.0570 forget=1.3733 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 220 total=8.2960 mle=1.8494 pcon=5.0549 forget=1.3917 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 270 total=8.2141 mle=1.7790 pcon=5.0527 forget=1.3824 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 320 total=8.3028 mle=1.8620 pcon=5.0507 forget=1.3901 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 7 it 370 total=8.0247 mle=1.5857 pcon=5.0486 forget=1.3903 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 8 it 30 total=8.1949 mle=1.7240 pcon=5.0467 forget=1.4242 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 80 total=7.9578 mle=1.5440 pcon=5.0445 forget=1.3693 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 130 total=8.2205 mle=1.7860 pcon=5.0425 forget=1.3920 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 180 total=8.1193 mle=1.7035 pcon=5.0402 forget=1.3755 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 230 total=8.0504 mle=1.6567 pcon=5.0382 forget=1.3555 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 280 total=8.0247 mle=1.6261 pcon=5.0358 forget=1.3628 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 330 total=7.9085 mle=1.4992 pcon=5.0337 forget=1.3756 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 8 it 380 total=8.4101 mle=2.0015 pcon=5.0317 forget=1.3769 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 9 it 40 total=8.1284 mle=1.7485 pcon=5.0297 forget=1.3502 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 90 total=8.0428 mle=1.6573 pcon=5.0276 forget=1.3579 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 140 total=8.0196 mle=1.6066 pcon=5.0255 forget=1.3875 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 190 total=8.1203 mle=1.7539 pcon=5.0235 forget=1.3429 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 240 total=8.1875 mle=1.7748 pcon=5.0214 forget=1.3913 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 290 total=8.0269 mle=1.6604 pcon=5.0197 forget=1.3468 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 9 it 340 total=8.0575 mle=1.6890 pcon=5.0177 forget=1.3509 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 10 it 0 total=7.8122 mle=1.4430 pcon=5.0157 forget=1.3534 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 50 total=7.9852 mle=1.6276 pcon=5.0141 forget=1.3435 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 100 total=8.0959 mle=1.7326 pcon=5.0121 forget=1.3512 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 150 total=8.1067 mle=1.7523 pcon=5.0102 forget=1.3442 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 200 total=7.9430 mle=1.5850 pcon=5.0081 forget=1.3499 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 250 total=8.0003 mle=1.6119 pcon=5.0062 forget=1.3821 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 300 total=7.9239 mle=1.5599 pcon=5.0044 forget=1.3595 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 10 it 350 total=7.9531 mle=1.5916 pcon=5.0027 forget=1.3588 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 11 it 10 total=8.0788 mle=1.7016 pcon=5.0008 forget=1.3764 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 60 total=8.0128 mle=1.6512 pcon=4.9992 forget=1.3624 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 110 total=8.0002 mle=1.6280 pcon=4.9977 forget=1.3745 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 160 total=7.9502 mle=1.5927 pcon=4.9958 forget=1.3617 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 210 total=8.0677 mle=1.7044 pcon=4.9942 forget=1.3692 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 260 total=7.9964 mle=1.6248 pcon=4.9930 forget=1.3786 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 310 total=8.1455 mle=1.7753 pcon=4.9914 forget=1.3788 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 11 it 360 total=7.9818 mle=1.6020 pcon=4.9899 forget=1.3899 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 20 total=8.0321 mle=1.6254 pcon=4.9885 forget=1.4182 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 70 total=7.8733 mle=1.4834 pcon=4.9873 forget=1.4026 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 120 total=8.0351 mle=1.6381 pcon=4.9860 forget=1.4110 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 170 total=8.1147 mle=1.7008 pcon=4.9848 forget=1.4292 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 220 total=7.9594 mle=1.5590 pcon=4.9837 forget=1.4167 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 270 total=8.0987 mle=1.6935 pcon=4.9827 forget=1.4225 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 320 total=8.2826 mle=1.8548 pcon=4.9818 forget=1.4460 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 12 it 370 total=8.2948 mle=1.8804 pcon=4.9807 forget=1.4338 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 30 total=7.9825 mle=1.5548 pcon=4.9799 forget=1.4478 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 80 total=8.1268 mle=1.6890 pcon=4.9790 forget=1.4588 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 130 total=7.9648 mle=1.5162 pcon=4.9779 forget=1.4707 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 180 total=8.0293 mle=1.5465 pcon=4.9770 forget=1.5058 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 230 total=8.1446 mle=1.7025 pcon=4.9759 forget=1.4662 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 280 total=8.0220 mle=1.5657 pcon=4.9746 forget=1.4817 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 330 total=8.1274 mle=1.6743 pcon=4.9735 forget=1.4796 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 13 it 380 total=8.1777 mle=1.7234 pcon=4.9723 forget=1.4820 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 40 total=8.1525 mle=1.6824 pcon=4.9708 forget=1.4994 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 30%|███       | 15/50 [08:58<21:08, 36.25s/it] 32%|███▏      | 16/50 [09:34<20:25, 36.03s/it] 34%|███▍      | 17/50 [10:10<19:49, 36.04s/it] 36%|███▌      | 18/50 [10:45<19:02, 35.71s/it] 38%|███▊      | 19/50 [11:21<18:30, 35.82s/it] 40%|████      | 20/50 [11:57<17:57, 35.91s/it] 42%|████▏     | 21/50 [12:35<17:40, 36.55s/it][loss] ep 14 it 90 total=8.1213 mle=1.6695 pcon=4.9696 forget=1.4822 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 140 total=8.0222 mle=1.5562 pcon=4.9679 forget=1.4981 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 190 total=8.0220 mle=1.5635 pcon=4.9662 forget=1.4922 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 240 total=8.1080 mle=1.6611 pcon=4.9645 forget=1.4825 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 290 total=8.0849 mle=1.6154 pcon=4.9627 forget=1.5069 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 14 it 340 total=8.3223 mle=1.8476 pcon=4.9609 forget=1.5139 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 0 total=8.1470 mle=1.6925 pcon=4.9584 forget=1.4962 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 50 total=8.0666 mle=1.6314 pcon=4.9558 forget=1.4794 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 100 total=8.0868 mle=1.6927 pcon=4.9536 forget=1.4405 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 150 total=7.9754 mle=1.5497 pcon=4.9509 forget=1.4747 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 200 total=7.9277 mle=1.5404 pcon=4.9483 forget=1.4390 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 250 total=8.0442 mle=1.6470 pcon=4.9459 forget=1.4513 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 300 total=8.0640 mle=1.7184 pcon=4.9433 forget=1.4023 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 15 it 350 total=8.0972 mle=1.7931 pcon=4.9405 forget=1.3637 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 16 it 10 total=8.0291 mle=1.7586 pcon=4.9376 forget=1.3329 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 60 total=8.0179 mle=1.7638 pcon=4.9343 forget=1.3198 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 110 total=7.9027 mle=1.6622 pcon=4.9314 forget=1.3090 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 160 total=7.7141 mle=1.5530 pcon=4.9283 forget=1.2327 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 210 total=7.8414 mle=1.6147 pcon=4.9246 forget=1.3021 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 260 total=7.7117 mle=1.5031 pcon=4.9211 forget=1.2875 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 310 total=7.8690 mle=1.6793 pcon=4.9176 forget=1.2721 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 16 it 360 total=7.7374 mle=1.6700 pcon=4.9143 forget=1.1531 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 17 it 20 total=7.9051 mle=1.8127 pcon=4.9106 forget=1.1818 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 70 total=7.6191 mle=1.5155 pcon=4.9068 forget=1.1968 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 120 total=7.7063 mle=1.6462 pcon=4.9027 forget=1.1575 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 170 total=7.8347 mle=1.8132 pcon=4.8990 forget=1.1225 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 220 total=7.8252 mle=1.7736 pcon=4.8952 forget=1.1564 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 270 total=7.8368 mle=1.7871 pcon=4.8912 forget=1.1585 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 320 total=7.6958 mle=1.6199 pcon=4.8870 forget=1.1889 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 17 it 370 total=7.6826 mle=1.5481 pcon=4.8830 forget=1.2516 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 18 it 30 total=7.6197 mle=1.5257 pcon=4.8788 forget=1.2152 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 80 total=7.8096 mle=1.7948 pcon=4.8748 forget=1.1400 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 130 total=7.6601 mle=1.5755 pcon=4.8705 forget=1.2141 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 180 total=7.6858 mle=1.5684 pcon=4.8663 forget=1.2511 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 230 total=7.5816 mle=1.4955 pcon=4.8621 forget=1.2240 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 280 total=7.6273 mle=1.5681 pcon=4.8574 forget=1.2018 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 330 total=7.8871 mle=1.8131 pcon=4.8531 forget=1.2208 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 18 it 380 total=7.7219 mle=1.6924 pcon=4.8486 forget=1.1809 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 19 it 40 total=7.7182 mle=1.5934 pcon=4.8443 forget=1.2805 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 90 total=7.6332 mle=1.6082 pcon=4.8400 forget=1.1850 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 140 total=7.7181 mle=1.6604 pcon=4.8355 forget=1.2222 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 190 total=7.7721 mle=1.7275 pcon=4.8313 forget=1.2132 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 240 total=7.8524 mle=1.7999 pcon=4.8270 forget=1.2255 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 290 total=7.7088 mle=1.5796 pcon=4.8226 forget=1.3066 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 19 it 340 total=7.7801 mle=1.6875 pcon=4.8185 forget=1.2741 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 0 total=7.8773 mle=1.8028 pcon=4.8142 forget=1.2603 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 50 total=7.6846 mle=1.6146 pcon=4.8102 forget=1.2598 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 100 total=7.5769 mle=1.4817 pcon=4.8062 forget=1.2890 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 150 total=7.9202 mle=1.8536 pcon=4.8024 forget=1.2642 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 200 total=7.6920 mle=1.6438 pcon=4.7985 forget=1.2497 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 250 total=7.7408 mle=1.6894 pcon=4.7945 forget=1.2570 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 300 total=7.9277 mle=1.9093 pcon=4.7904 forget=1.2281 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 20 it 350 total=7.7415 mle=1.7026 pcon=4.7863 forget=1.2526 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 10 total=7.7258 mle=1.6898 pcon=4.7825 forget=1.2535 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 60 total=7.6085 mle=1.5717 pcon=4.7789 forget=1.2580 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 110 total=7.6541 mle=1.6146 pcon=4.7752 forget=1.2643 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 160 total=7.6019 mle=1.5632 pcon=4.7717 forget=1.2671 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 44%|████▍     | 22/50 [13:09<16:45, 35.90s/it] 46%|████▌     | 23/50 [13:43<15:55, 35.39s/it] 48%|████▊     | 24/50 [14:28<16:34, 38.26s/it] 50%|█████     | 25/50 [15:20<17:34, 42.19s/it] 52%|█████▏    | 26/50 [16:11<18:00, 45.04s/it] 54%|█████▍    | 27/50 [17:05<18:13, 47.53s/it] 56%|█████▌    | 28/50 [17:56<17:50, 48.66s/it] 58%|█████▊    | 29/50 [18:47<17:16, 49.34s/it][loss] ep 21 it 210 total=7.7108 mle=1.6547 pcon=4.7683 forget=1.2877 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 260 total=7.8364 mle=1.7905 pcon=4.7651 forget=1.2807 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 310 total=7.7305 mle=1.6720 pcon=4.7620 forget=1.2965 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 21 it 360 total=7.8344 mle=1.7552 pcon=4.7592 forget=1.3200 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 20 total=7.7195 mle=1.6538 pcon=4.7564 forget=1.3093 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 70 total=7.5553 mle=1.4851 pcon=4.7537 forget=1.3166 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 120 total=7.5894 mle=1.4951 pcon=4.7512 forget=1.3431 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 170 total=7.6865 mle=1.6014 pcon=4.7488 forget=1.3363 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 220 total=7.8788 mle=1.7921 pcon=4.7464 forget=1.3403 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 270 total=7.8443 mle=1.7489 pcon=4.7440 forget=1.3515 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 320 total=7.7336 mle=1.6294 pcon=4.7418 forget=1.3624 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 22 it 370 total=7.8542 mle=1.7483 pcon=4.7397 forget=1.3662 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 30 total=7.9486 mle=1.8309 pcon=4.7377 forget=1.3800 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 80 total=7.7560 mle=1.6438 pcon=4.7358 forget=1.3765 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 130 total=7.8255 mle=1.7191 pcon=4.7337 forget=1.3727 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 180 total=7.8069 mle=1.6973 pcon=4.7319 forget=1.3777 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 230 total=7.8574 mle=1.7487 pcon=4.7301 forget=1.3786 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 280 total=7.7824 mle=1.6516 pcon=4.7284 forget=1.4024 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 330 total=7.9618 mle=1.8585 pcon=4.7267 forget=1.3765 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 23 it 380 total=7.7130 mle=1.5973 pcon=4.7253 forget=1.3904 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 40 total=7.7616 mle=1.6425 pcon=4.7237 forget=1.3955 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 90 total=7.8554 mle=1.7467 pcon=4.7220 forget=1.3867 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 140 total=7.8731 mle=1.7595 pcon=4.7203 forget=1.3933 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 190 total=7.8252 mle=1.7096 pcon=4.7187 forget=1.3969 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 240 total=7.8115 mle=1.6992 pcon=4.7173 forget=1.3950 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 290 total=7.6224 mle=1.4958 pcon=4.7159 forget=1.4106 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 24 it 340 total=7.6401 mle=1.5365 pcon=4.7147 forget=1.3888 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 0 total=7.7751 mle=1.6532 pcon=4.7132 forget=1.4086 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 50 total=7.8474 mle=1.7344 pcon=4.7121 forget=1.4009 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 100 total=7.6555 mle=1.5470 pcon=4.7108 forget=1.3977 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 150 total=7.8145 mle=1.7160 pcon=4.7096 forget=1.3889 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 200 total=8.0704 mle=1.9515 pcon=4.7083 forget=1.4107 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 250 total=7.9178 mle=1.8312 pcon=4.7070 forget=1.3796 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 300 total=7.6227 mle=1.5239 pcon=4.7058 forget=1.3929 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 25 it 350 total=7.7041 mle=1.5967 pcon=4.7047 forget=1.4026 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 10 total=7.8195 mle=1.7406 pcon=4.7036 forget=1.3753 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 60 total=7.7639 mle=1.6670 pcon=4.7023 forget=1.3947 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 110 total=7.6974 mle=1.6274 pcon=4.7013 forget=1.3687 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 160 total=7.7337 mle=1.6692 pcon=4.7004 forget=1.3641 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 210 total=7.7260 mle=1.6636 pcon=4.6995 forget=1.3630 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 260 total=7.6550 mle=1.6116 pcon=4.6985 forget=1.3449 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 310 total=7.7023 mle=1.6535 pcon=4.6976 forget=1.3513 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 26 it 360 total=7.6791 mle=1.6035 pcon=4.6964 forget=1.3792 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 20 total=7.7329 mle=1.6832 pcon=4.6954 forget=1.3543 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 70 total=7.6586 mle=1.6165 pcon=4.6945 forget=1.3476 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 120 total=7.6451 mle=1.6083 pcon=4.6934 forget=1.3434 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 170 total=7.6929 mle=1.6578 pcon=4.6925 forget=1.3426 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 220 total=7.7252 mle=1.6936 pcon=4.6915 forget=1.3401 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 270 total=7.8217 mle=1.7932 pcon=4.6905 forget=1.3380 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 320 total=7.5401 mle=1.5141 pcon=4.6898 forget=1.3362 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 27 it 370 total=7.7326 mle=1.7140 pcon=4.6888 forget=1.3299 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 28 it 30 total=7.6759 mle=1.6584 pcon=4.6879 forget=1.3296 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 80 total=7.7473 mle=1.7357 pcon=4.6869 forget=1.3247 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 130 total=7.5946 mle=1.5795 pcon=4.6859 forget=1.3293 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 180 total=7.5675 mle=1.5461 pcon=4.6850 forget=1.3364 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 230 total=7.7489 mle=1.7395 pcon=4.6842 forget=1.3253 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 280 total=7.7179 mle=1.7223 pcon=4.6832 forget=1.3123 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 330 total=7.7542 mle=1.7478 pcon=4.6823 forget=1.3240 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 28 it 380 total=7.7711 mle=1.7714 pcon=4.6813 forget=1.3184 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 29 it 40 total=7.6406 mle=1.6414 pcon=4.6804 forget=1.3187 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 60%|██████    | 30/50 [19:36<16:24, 49.23s/it] 62%|██████▏   | 31/50 [20:26<15:37, 49.36s/it] 64%|██████▍   | 32/50 [21:14<14:44, 49.14s/it] 66%|██████▌   | 33/50 [22:09<14:24, 50.83s/it] 68%|██████▊   | 34/50 [22:57<13:21, 50.07s/it] 70%|███████   | 35/50 [23:46<12:26, 49.79s/it] 72%|███████▏  | 36/50 [24:35<11:31, 49.39s/it][loss] ep 29 it 90 total=7.6649 mle=1.6746 pcon=4.6797 forget=1.3106 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 140 total=7.9264 mle=1.9381 pcon=4.6787 forget=1.3096 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 190 total=7.4897 mle=1.4932 pcon=4.6780 forget=1.3185 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 240 total=7.6452 mle=1.6601 pcon=4.6771 forget=1.3080 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 290 total=7.5689 mle=1.5811 pcon=4.6763 forget=1.3114 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 29 it 340 total=7.6710 mle=1.6848 pcon=4.6754 forget=1.3109 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 30 it 0 total=7.8338 mle=1.8523 pcon=4.6745 forget=1.3069 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 50 total=7.5018 mle=1.5093 pcon=4.6737 forget=1.3188 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 100 total=7.6280 mle=1.6480 pcon=4.6729 forget=1.3071 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 150 total=7.7230 mle=1.7327 pcon=4.6722 forget=1.3181 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 200 total=7.6120 mle=1.6212 pcon=4.6716 forget=1.3193 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 250 total=7.7928 mle=1.8081 pcon=4.6709 forget=1.3139 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 300 total=7.6458 mle=1.6582 pcon=4.6701 forget=1.3175 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 30 it 350 total=7.5592 mle=1.5697 pcon=4.6691 forget=1.3204 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[loss] ep 31 it 10 total=7.8690 mle=1.8746 pcon=4.6685 forget=1.3259 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 60 total=7.5630 mle=1.5751 pcon=4.6678 forget=1.3202 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 110 total=7.5471 mle=1.5520 pcon=4.6670 forget=1.3281 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 160 total=7.6236 mle=1.6249 pcon=4.6665 forget=1.3323 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 210 total=7.5831 mle=1.5754 pcon=4.6658 forget=1.3419 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 260 total=7.6361 mle=1.6262 pcon=4.6653 forget=1.3446 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 310 total=7.8061 mle=1.7976 pcon=4.6645 forget=1.3439 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 31 it 360 total=7.6500 mle=1.6379 pcon=4.6639 forget=1.3482 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 20 total=7.7237 mle=1.7085 pcon=4.6631 forget=1.3520 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 70 total=7.6562 mle=1.6400 pcon=4.6626 forget=1.3535 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 120 total=7.9728 mle=1.9469 pcon=4.6620 forget=1.3639 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 170 total=7.7759 mle=1.7646 pcon=4.6613 forget=1.3500 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 220 total=7.6690 mle=1.6396 pcon=4.6607 forget=1.3687 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 270 total=7.7844 mle=1.7530 pcon=4.6602 forget=1.3713 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 320 total=7.8146 mle=1.7834 pcon=4.6597 forget=1.3715 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 32 it 370 total=7.6980 mle=1.6580 pcon=4.6592 forget=1.3808 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 30 total=7.5986 mle=1.5645 pcon=4.6586 forget=1.3755 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 80 total=7.6112 mle=1.5647 pcon=4.6580 forget=1.3884 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 130 total=7.7105 mle=1.6589 pcon=4.6574 forget=1.3943 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 180 total=7.7613 mle=1.7019 pcon=4.6568 forget=1.4026 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 230 total=7.6962 mle=1.6433 pcon=4.6564 forget=1.3965 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 280 total=7.7800 mle=1.7221 pcon=4.6559 forget=1.4020 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 330 total=7.7438 mle=1.6865 pcon=4.6555 forget=1.4018 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 33 it 380 total=7.5538 mle=1.4950 pcon=4.6551 forget=1.4036 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 40 total=7.7695 mle=1.7067 pcon=4.6547 forget=1.4081 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 90 total=7.8010 mle=1.7253 pcon=4.6542 forget=1.4215 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 140 total=7.6922 mle=1.6148 pcon=4.6536 forget=1.4237 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 190 total=7.9116 mle=1.8395 pcon=4.6533 forget=1.4188 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 240 total=7.8425 mle=1.7491 pcon=4.6528 forget=1.4405 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 290 total=7.9000 mle=1.8208 pcon=4.6524 forget=1.4268 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 34 it 340 total=7.7221 mle=1.6358 pcon=4.6520 forget=1.4343 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 0 total=7.7619 mle=1.6732 pcon=4.6516 forget=1.4372 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 50 total=7.8559 mle=1.7678 pcon=4.6512 forget=1.4368 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 100 total=7.7823 mle=1.6923 pcon=4.6508 forget=1.4392 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 150 total=7.9533 mle=1.8505 pcon=4.6503 forget=1.4524 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 200 total=7.7977 mle=1.6913 pcon=4.6499 forget=1.4565 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 250 total=7.6473 mle=1.5353 pcon=4.6496 forget=1.4624 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 300 total=7.7453 mle=1.6312 pcon=4.6492 forget=1.4648 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 35 it 350 total=7.7686 mle=1.6367 pcon=4.6488 forget=1.4831 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 10 total=7.8008 mle=1.6820 pcon=4.6485 forget=1.4703 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 60 total=7.7530 mle=1.6257 pcon=4.6481 forget=1.4791 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 110 total=7.8981 mle=1.7886 pcon=4.6477 forget=1.4618 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 160 total=7.8452 mle=1.7208 pcon=4.6474 forget=1.4770 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 210 total=7.9226 mle=1.7976 pcon=4.6470 forget=1.4781 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 260 total=7.9204 mle=1.7783 pcon=4.6468 forget=1.4952 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 36 it 310 total=7.7072 mle=1.5702 pcon=4.6466 forget=1.4903 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 74%|███████▍  | 37/50 [25:23<10:38, 49.14s/it] 76%|███████▌  | 38/50 [26:04<09:19, 46.64s/it] 78%|███████▊  | 39/50 [26:38<07:50, 42.73s/it] 80%|████████  | 40/50 [27:09<06:31, 39.12s/it] 82%|████████▏ | 41/50 [27:38<05:25, 36.20s/it] 84%|████████▍ | 42/50 [28:08<04:35, 34.42s/it] 86%|████████▌ | 43/50 [28:39<03:52, 33.25s/it] 88%|████████▊ | 44/50 [29:11<03:17, 32.90s/it][loss] ep 36 it 360 total=7.7771 mle=1.6419 pcon=4.6464 forget=1.4889 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 20 total=7.7778 mle=1.6366 pcon=4.6462 forget=1.4949 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 70 total=7.7492 mle=1.6124 pcon=4.6459 forget=1.4909 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 120 total=7.7802 mle=1.6381 pcon=4.6457 forget=1.4965 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 170 total=7.7354 mle=1.5862 pcon=4.6454 forget=1.5039 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 220 total=7.8377 mle=1.6942 pcon=4.6453 forget=1.4983 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 270 total=7.8143 mle=1.6849 pcon=4.6450 forget=1.4844 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 320 total=7.7676 mle=1.6237 pcon=4.6449 forget=1.4990 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 37 it 370 total=7.8037 mle=1.6410 pcon=4.6448 forget=1.5179 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 30 total=7.6277 mle=1.4864 pcon=4.6448 forget=1.4966 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 80 total=7.8775 mle=1.7266 pcon=4.6444 forget=1.5065 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 130 total=7.9252 mle=1.7733 pcon=4.6442 forget=1.5076 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 180 total=7.7441 mle=1.5752 pcon=4.6440 forget=1.5249 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 230 total=7.6913 mle=1.5382 pcon=4.6438 forget=1.5093 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 280 total=7.8847 mle=1.7052 pcon=4.6437 forget=1.5358 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 330 total=7.8187 mle=1.6339 pcon=4.6436 forget=1.5412 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 38 it 380 total=8.0142 mle=1.8459 pcon=4.6436 forget=1.5247 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 40 total=7.7499 mle=1.5821 pcon=4.6435 forget=1.5243 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 90 total=7.7803 mle=1.6194 pcon=4.6433 forget=1.5177 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 140 total=7.8400 mle=1.6593 pcon=4.6433 forget=1.5375 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 190 total=7.8303 mle=1.6564 pcon=4.6431 forget=1.5307 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 240 total=8.0279 mle=1.8526 pcon=4.6431 forget=1.5322 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 290 total=7.7553 mle=1.5747 pcon=4.6430 forget=1.5376 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 39 it 340 total=7.8130 mle=1.6282 pcon=4.6432 forget=1.5415 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 0 total=7.7893 mle=1.6094 pcon=4.6432 forget=1.5367 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 50 total=7.8280 mle=1.6460 pcon=4.6429 forget=1.5390 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 100 total=7.8462 mle=1.6658 pcon=4.6429 forget=1.5375 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 150 total=7.7650 mle=1.5670 pcon=4.6429 forget=1.5551 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 200 total=8.0032 mle=1.7902 pcon=4.6427 forget=1.5704 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 250 total=8.1438 mle=1.9537 pcon=4.6425 forget=1.5477 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 300 total=7.9452 mle=1.7446 pcon=4.6424 forget=1.5582 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 40 it 350 total=8.0007 mle=1.8067 pcon=4.6423 forget=1.5518 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 10 total=7.8762 mle=1.6760 pcon=4.6422 forget=1.5581 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 60 total=7.9433 mle=1.7501 pcon=4.6421 forget=1.5511 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 110 total=7.8804 mle=1.6759 pcon=4.6418 forget=1.5627 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 160 total=7.9784 mle=1.7964 pcon=4.6418 forget=1.5402 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 210 total=7.8166 mle=1.6198 pcon=4.6418 forget=1.5550 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 260 total=7.9513 mle=1.7464 pcon=4.6414 forget=1.5634 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 310 total=7.7217 mle=1.5147 pcon=4.6413 forget=1.5656 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 41 it 360 total=7.8722 mle=1.6746 pcon=4.6410 forget=1.5566 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 20 total=7.8069 mle=1.5925 pcon=4.6409 forget=1.5734 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 70 total=7.7445 mle=1.5472 pcon=4.6409 forget=1.5565 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 120 total=8.0326 mle=1.8221 pcon=4.6409 forget=1.5696 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 170 total=7.9488 mle=1.7463 pcon=4.6406 forget=1.5619 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 220 total=7.7730 mle=1.5600 pcon=4.6407 forget=1.5723 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 270 total=8.0727 mle=1.8698 pcon=4.6405 forget=1.5623 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 320 total=7.8475 mle=1.6482 pcon=4.6403 forget=1.5590 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 42 it 370 total=7.7628 mle=1.5521 pcon=4.6403 forget=1.5704 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 30 total=7.8776 mle=1.6679 pcon=4.6403 forget=1.5694 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 80 total=7.8385 mle=1.6379 pcon=4.6403 forget=1.5604 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 130 total=7.9686 mle=1.7565 pcon=4.6401 forget=1.5720 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 180 total=7.8724 mle=1.6684 pcon=4.6401 forget=1.5639 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 230 total=7.8039 mle=1.6048 pcon=4.6401 forget=1.5590 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 280 total=7.8344 mle=1.6346 pcon=4.6401 forget=1.5598 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 330 total=7.7295 mle=1.5134 pcon=4.6400 forget=1.5761 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 43 it 380 total=7.8849 mle=1.6745 pcon=4.6398 forget=1.5707 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 40 total=8.1127 mle=1.8804 pcon=4.6398 forget=1.5925 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 90 total=7.6827 mle=1.4865 pcon=4.6399 forget=1.5563 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 140 total=7.9900 mle=1.7603 pcon=4.6398 forget=1.5899 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 190 total=7.9887 mle=1.7761 pcon=4.6400 forget=1.5727 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 240 total=7.8638 mle=1.6376 pcon=4.6399 forget=1.5864 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 44 it 290 total=7.9109 mle=1.6856 pcon=4.6398 forget=1.5855 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
 90%|█████████ | 45/50 [29:44<02:44, 32.86s/it] 92%|█████████▏| 46/50 [30:15<02:09, 32.46s/it] 94%|█████████▍| 47/50 [31:01<01:49, 36.45s/it] 96%|█████████▌| 48/50 [31:41<01:15, 37.61s/it] 98%|█████████▊| 49/50 [32:16<00:36, 36.75s/it]100%|██████████| 50/50 [32:48<00:00, 35.41s/it]100%|██████████| 50/50 [32:48<00:00, 39.38s/it]
[loss] ep 44 it 340 total=7.8966 mle=1.6657 pcon=4.6397 forget=1.5912 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 0 total=7.8905 mle=1.6636 pcon=4.6398 forget=1.5871 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 50 total=7.9133 mle=1.6933 pcon=4.6397 forget=1.5803 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 100 total=7.8849 mle=1.6530 pcon=4.6397 forget=1.5922 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 150 total=7.8830 mle=1.6730 pcon=4.6397 forget=1.5702 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 200 total=7.7607 mle=1.5443 pcon=4.6397 forget=1.5768 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 250 total=7.8973 mle=1.6634 pcon=4.6397 forget=1.5941 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 300 total=7.8228 mle=1.6039 pcon=4.6398 forget=1.5790 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 45 it 350 total=8.0003 mle=1.7704 pcon=4.6398 forget=1.5901 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 10 total=7.8990 mle=1.6752 pcon=4.6397 forget=1.5841 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 60 total=8.0317 mle=1.8034 pcon=4.6397 forget=1.5886 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 110 total=7.9372 mle=1.7146 pcon=4.6398 forget=1.5828 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 160 total=7.8282 mle=1.5995 pcon=4.6397 forget=1.5890 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 210 total=7.8237 mle=1.5872 pcon=4.6397 forget=1.5968 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 260 total=7.8964 mle=1.6552 pcon=4.6394 forget=1.6017 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 310 total=7.9507 mle=1.7159 pcon=4.6393 forget=1.5955 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 46 it 360 total=7.7600 mle=1.5202 pcon=4.6393 forget=1.6005 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 20 total=8.1065 mle=1.8716 pcon=4.6395 forget=1.5954 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 70 total=7.7966 mle=1.5624 pcon=4.6395 forget=1.5947 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 120 total=7.8944 mle=1.6533 pcon=4.6397 forget=1.6014 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 170 total=7.9878 mle=1.7465 pcon=4.6396 forget=1.6018 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 220 total=7.9484 mle=1.7160 pcon=4.6394 forget=1.5930 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 270 total=7.9248 mle=1.6820 pcon=4.6394 forget=1.6034 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 320 total=7.8721 mle=1.6212 pcon=4.6393 forget=1.6116 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 47 it 370 total=7.9795 mle=1.7314 pcon=4.6393 forget=1.6088 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 30 total=7.9270 mle=1.6744 pcon=4.6393 forget=1.6132 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 80 total=7.9477 mle=1.7202 pcon=4.6393 forget=1.5881 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 130 total=7.7785 mle=1.5334 pcon=4.6393 forget=1.6058 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 180 total=7.8714 mle=1.6279 pcon=4.6393 forget=1.6042 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 230 total=7.9687 mle=1.7116 pcon=4.6394 forget=1.6177 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 280 total=7.9096 mle=1.6588 pcon=4.6394 forget=1.6113 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 330 total=7.9176 mle=1.6673 pcon=4.6395 forget=1.6108 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 48 it 380 total=7.8521 mle=1.6028 pcon=4.6395 forget=1.6097 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 40 total=7.9908 mle=1.7486 pcon=4.6398 forget=1.6024 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 90 total=8.0276 mle=1.7634 pcon=4.6399 forget=1.6244 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 140 total=8.1181 mle=1.8614 pcon=4.6399 forget=1.6168 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 190 total=8.0003 mle=1.7539 pcon=4.6401 forget=1.6063 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 240 total=7.9025 mle=1.6438 pcon=4.6401 forget=1.6186 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 290 total=7.8602 mle=1.6064 pcon=4.6401 forget=1.6136 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
[loss] ep 49 it 340 total=8.0395 mle=1.7797 pcon=4.6400 forget=1.6197 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=570 fproto_sim=NA
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-inc1: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<04:02,  1.61it/s]  2%|▏         | 6/391 [00:00<00:36, 10.55it/s]  3%|▎         | 12/391 [00:00<00:18, 20.48it/s]  5%|▌         | 20/391 [00:00<00:11, 33.24it/s]  7%|▋         | 29/391 [00:01<00:07, 46.52it/s] 10%|▉         | 38/391 [00:01<00:06, 56.96it/s] 12%|█▏        | 46/391 [00:01<00:06, 55.91it/s] 14%|█▎        | 53/391 [00:01<00:06, 54.85it/s] 15%|█▌        | 60/391 [00:01<00:06, 54.52it/s] 17%|█▋        | 68/391 [00:01<00:05, 60.45it/s] 20%|█▉        | 77/391 [00:01<00:04, 66.94it/s] 22%|██▏       | 86/391 [00:01<00:04, 72.80it/s] 24%|██▍       | 94/391 [00:02<00:04, 62.64it/s] 26%|██▌       | 101/391 [00:02<00:04, 63.77it/s] 28%|██▊       | 108/391 [00:02<00:04, 60.29it/s] 30%|██▉       | 117/391 [00:02<00:04, 66.51it/s] 32%|███▏      | 126/391 [00:02<00:03, 71.69it/s] 34%|███▍      | 134/391 [00:02<00:03, 65.52it/s] 36%|███▌      | 141/391 [00:02<00:04, 60.85it/s] 38%|███▊      | 148/391 [00:02<00:04, 60.32it/s] 40%|███▉      | 156/391 [00:03<00:03, 64.93it/s] 42%|████▏     | 165/391 [00:03<00:03, 71.33it/s] 45%|████▍     | 174/391 [00:03<00:02, 74.34it/s] 47%|████▋     | 182/391 [00:03<00:02, 71.41it/s] 49%|████▊     | 190/391 [00:03<00:03, 61.84it/s] 50%|█████     | 197/391 [00:03<00:03, 63.23it/s] 52%|█████▏    | 204/391 [00:03<00:02, 63.73it/s] 54%|█████▍    | 213/391 [00:03<00:02, 69.50it/s] 57%|█████▋    | 222/391 [00:03<00:02, 74.92it/s] 59%|█████▉    | 230/391 [00:04<00:02, 67.80it/s] 61%|██████    | 238/391 [00:04<00:02, 63.11it/s] 63%|██████▎   | 245/391 [00:04<00:02, 63.54it/s] 64%|██████▍   | 252/391 [00:04<00:02, 62.75it/s] 67%|██████▋   | 261/391 [00:04<00:01, 68.84it/s] 69%|██████▉   | 269/391 [00:04<00:01, 64.71it/s] 71%|███████   | 276/391 [00:04<00:01, 59.28it/s] 73%|███████▎  | 285/391 [00:04<00:01, 63.69it/s] 75%|███████▍  | 292/391 [00:05<00:01, 64.08it/s] 77%|███████▋  | 301/391 [00:05<00:01, 70.61it/s] 79%|███████▉  | 310/391 [00:05<00:01, 74.05it/s] 82%|████████▏ | 319/391 [00:05<00:00, 78.38it/s] 84%|████████▎ | 327/391 [00:05<00:00, 64.82it/s] 85%|████████▌ | 334/391 [00:05<00:00, 65.97it/s] 87%|████████▋ | 341/391 [00:05<00:00, 62.23it/s] 90%|████████▉ | 350/391 [00:05<00:00, 68.75it/s] 92%|█████████▏| 359/391 [00:05<00:00, 73.21it/s] 94%|█████████▍| 368/391 [00:06<00:00, 77.54it/s] 96%|█████████▋| 377/391 [00:06<00:00, 80.59it/s] 99%|█████████▊| 386/391 [00:06<00:00, 72.96it/s]100%|██████████| 391/391 [00:06<00:00, 60.59it/s]
50000 images processed, 6.559429168701172 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:40,  1.94it/s]  6%|▋         | 5/79 [00:00<00:07, 10.12it/s] 16%|█▋        | 13/79 [00:00<00:02, 25.42it/s] 24%|██▍       | 19/79 [00:00<00:01, 33.82it/s] 35%|███▌      | 28/79 [00:00<00:01, 46.85it/s] 47%|████▋     | 37/79 [00:01<00:00, 56.55it/s] 56%|█████▌    | 44/79 [00:01<00:00, 58.39it/s] 65%|██████▍   | 51/79 [00:01<00:00, 54.11it/s] 76%|███████▌  | 60/79 [00:01<00:00, 61.64it/s] 85%|████████▍ | 67/79 [00:01<00:00, 60.02it/s] 96%|█████████▌| 76/79 [00:01<00:00, 67.22it/s]100%|██████████| 79/79 [00:01<00:00, 46.33it/s]
10000 images processed, 1.7322885990142822 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-inc1/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:46,  1.90it/s]  2%|▏         | 4/204 [00:00<00:25,  7.85it/s]  5%|▌         | 11/204 [00:00<00:08, 21.49it/s]  8%|▊         | 17/204 [00:00<00:06, 30.14it/s] 13%|█▎        | 26/204 [00:00<00:03, 44.84it/s] 17%|█▋        | 35/204 [00:01<00:03, 55.76it/s] 22%|██▏       | 44/204 [00:01<00:02, 63.80it/s] 25%|██▌       | 52/204 [00:01<00:02, 56.14it/s] 29%|██▉       | 59/204 [00:01<00:02, 57.56it/s] 32%|███▏      | 66/204 [00:01<00:02, 58.23it/s] 37%|███▋      | 75/204 [00:01<00:01, 65.84it/s] 41%|████      | 84/204 [00:01<00:01, 70.80it/s] 46%|████▌     | 93/204 [00:01<00:01, 73.42it/s] 50%|████▉     | 101/204 [00:02<00:01, 60.46it/s] 53%|█████▎    | 109/204 [00:02<00:01, 63.19it/s] 57%|█████▋    | 116/204 [00:02<00:01, 63.33it/s] 61%|██████▏   | 125/204 [00:02<00:01, 68.84it/s] 66%|██████▌   | 134/204 [00:02<00:00, 72.67it/s] 70%|███████   | 143/204 [00:02<00:00, 72.86it/s] 74%|███████▍  | 151/204 [00:02<00:00, 62.13it/s] 77%|███████▋  | 158/204 [00:02<00:00, 59.38it/s] 81%|████████▏ | 166/204 [00:03<00:00, 64.05it/s] 86%|████████▌ | 175/204 [00:03<00:00, 69.14it/s] 90%|█████████ | 184/204 [00:03<00:00, 74.18it/s] 94%|█████████▍| 192/204 [00:03<00:00, 62.97it/s] 98%|█████████▊| 199/204 [00:03<00:00, 62.78it/s]100%|██████████| 204/204 [00:03<00:00, 55.69it/s]
26032 images processed, 3.7175729274749756 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:03,  1.22it/s]  8%|▊         | 6/79 [00:00<00:08,  8.43it/s] 16%|█▋        | 13/79 [00:01<00:03, 18.83it/s] 24%|██▍       | 19/79 [00:01<00:02, 26.14it/s] 30%|███       | 24/79 [00:01<00:01, 29.60it/s] 39%|███▉      | 31/79 [00:01<00:01, 37.95it/s] 47%|████▋     | 37/79 [00:01<00:01, 40.79it/s] 57%|█████▋    | 45/79 [00:01<00:00, 49.80it/s] 67%|██████▋   | 53/79 [00:01<00:00, 57.48it/s] 76%|███████▌  | 60/79 [00:01<00:00, 53.21it/s] 85%|████████▍ | 67/79 [00:01<00:00, 56.07it/s] 94%|█████████▎| 74/79 [00:02<00:00, 59.57it/s]100%|██████████| 79/79 [00:02<00:00, 36.74it/s]
10000 images processed, 2.197913646697998 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:54,  1.42it/s]  5%|▌         | 4/79 [00:00<00:12,  6.22it/s] 10%|█         | 8/79 [00:00<00:05, 12.68it/s] 20%|██        | 16/79 [00:01<00:02, 26.21it/s] 29%|██▉       | 23/79 [00:01<00:01, 35.53it/s] 41%|████      | 32/79 [00:01<00:00, 47.69it/s] 52%|█████▏    | 41/79 [00:01<00:00, 57.77it/s] 63%|██████▎   | 50/79 [00:01<00:00, 65.11it/s] 73%|███████▎  | 58/79 [00:01<00:00, 63.80it/s] 84%|████████▎ | 66/79 [00:01<00:00, 59.67it/s] 92%|█████████▏| 73/79 [00:01<00:00, 58.11it/s]100%|██████████| 79/79 [00:01<00:00, 40.94it/s]
10000 images processed, 1.9574830532073975 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:50,  1.36it/s] 13%|█▎        | 9/70 [00:00<00:04, 13.80it/s] 20%|██        | 14/70 [00:00<00:02, 19.91it/s] 27%|██▋       | 19/70 [00:01<00:01, 25.97it/s] 39%|███▊      | 27/70 [00:01<00:01, 37.57it/s] 47%|████▋     | 33/70 [00:01<00:00, 41.27it/s] 60%|██████    | 42/70 [00:01<00:00, 51.92it/s] 73%|███████▎  | 51/70 [00:01<00:00, 61.40it/s] 86%|████████▌ | 60/70 [00:01<00:00, 67.82it/s] 97%|█████████▋| 68/70 [00:01<00:00, 57.18it/s]100%|██████████| 70/70 [00:01<00:00, 38.28it/s]
8925 images processed, 1.876103401184082 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:45,  1.04s/it]  4%|▍         | 2/45 [00:01<00:22,  1.93it/s] 16%|█▌        | 7/45 [00:01<00:04,  8.13it/s] 27%|██▋       | 12/45 [00:01<00:02, 14.52it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.86it/s] 47%|████▋     | 21/45 [00:01<00:01, 19.08it/s] 53%|█████▎    | 24/45 [00:02<00:01, 14.38it/s] 76%|███████▌  | 34/45 [00:02<00:00, 19.36it/s] 87%|████████▋ | 39/45 [00:02<00:00, 21.61it/s]100%|██████████| 45/45 [00:02<00:00, 27.29it/s]100%|██████████| 45/45 [00:02<00:00, 16.09it/s]
5640 images processed, 2.832699775695801 seconds used

22.717103481292725
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.46  98.78
places365     72.67  79.75
LSUN          27.04  94.18
iSUN          76.19  79.51
dtd           47.16  89.36
AVG           45.70  88.32
Retain-Acc: 0.7385
Forget-as-OOD (retain known vs forget novel):
  FPR: 38.00 AUROC: 88.86 AUIN: 99.23
37.775691509246826
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-inc1_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-inc1_rf.png
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-seen: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:13,  2.01it/s]  2%|▏         | 6/391 [00:00<00:31, 12.12it/s]  4%|▎         | 14/391 [00:00<00:13, 27.70it/s]  5%|▍         | 19/391 [00:00<00:11, 32.92it/s]  7%|▋         | 28/391 [00:00<00:07, 46.32it/s]  9%|▉         | 37/391 [00:01<00:06, 56.88it/s] 12%|█▏        | 46/391 [00:01<00:05, 65.58it/s] 14%|█▍        | 54/391 [00:01<00:05, 60.45it/s] 16%|█▌        | 61/391 [00:01<00:05, 58.44it/s] 17%|█▋        | 68/391 [00:01<00:05, 60.45it/s] 19%|█▉        | 75/391 [00:01<00:05, 62.48it/s] 21%|██▏       | 84/391 [00:01<00:04, 69.23it/s] 24%|██▍       | 93/391 [00:01<00:04, 73.42it/s] 26%|██▌       | 102/391 [00:01<00:03, 77.10it/s] 28%|██▊       | 110/391 [00:02<00:03, 72.08it/s] 30%|███       | 118/391 [00:02<00:04, 64.11it/s] 32%|███▏      | 125/391 [00:02<00:04, 61.61it/s] 34%|███▍      | 133/391 [00:02<00:03, 65.21it/s] 36%|███▋      | 142/391 [00:02<00:03, 70.44it/s] 38%|███▊      | 150/391 [00:02<00:03, 72.98it/s] 40%|████      | 158/391 [00:02<00:03, 62.85it/s] 42%|████▏     | 165/391 [00:02<00:03, 63.36it/s] 44%|████▍     | 172/391 [00:03<00:03, 59.48it/s] 46%|████▋     | 181/391 [00:03<00:03, 66.22it/s] 49%|████▊     | 190/391 [00:03<00:02, 71.48it/s] 51%|█████     | 199/391 [00:03<00:02, 75.03it/s] 53%|█████▎    | 207/391 [00:03<00:02, 67.15it/s] 55%|█████▍    | 214/391 [00:03<00:02, 63.36it/s] 57%|█████▋    | 221/391 [00:03<00:02, 60.57it/s] 59%|█████▉    | 230/391 [00:03<00:02, 66.57it/s] 61%|██████    | 239/391 [00:04<00:02, 70.81it/s] 63%|██████▎   | 248/391 [00:04<00:01, 73.72it/s] 65%|██████▌   | 256/391 [00:04<00:02, 62.53it/s] 67%|██████▋   | 263/391 [00:04<00:01, 64.31it/s] 69%|██████▉   | 270/391 [00:04<00:01, 61.33it/s] 71%|███████▏  | 279/391 [00:04<00:01, 66.24it/s] 74%|███████▎  | 288/391 [00:04<00:01, 70.68it/s] 76%|███████▌  | 296/391 [00:04<00:01, 72.80it/s] 78%|███████▊  | 304/391 [00:05<00:01, 62.03it/s] 80%|███████▉  | 311/391 [00:05<00:01, 62.19it/s] 81%|████████▏ | 318/391 [00:05<00:01, 62.36it/s] 84%|████████▎ | 327/391 [00:05<00:00, 67.40it/s] 86%|████████▌ | 336/391 [00:05<00:00, 71.93it/s] 88%|████████▊ | 344/391 [00:05<00:00, 73.40it/s] 90%|█████████ | 352/391 [00:05<00:00, 62.63it/s] 92%|█████████▏| 359/391 [00:05<00:00, 63.12it/s] 94%|█████████▎| 366/391 [00:06<00:00, 61.52it/s] 96%|█████████▌| 376/391 [00:06<00:00, 69.50it/s] 99%|█████████▊| 386/391 [00:06<00:00, 75.38it/s]100%|██████████| 391/391 [00:06<00:00, 62.13it/s]
50000 images processed, 6.396674156188965 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:57,  1.35it/s] 13%|█▎        | 10/79 [00:00<00:04, 15.52it/s] 24%|██▍       | 19/79 [00:00<00:02, 28.44it/s] 34%|███▍      | 27/79 [00:01<00:01, 37.34it/s] 43%|████▎     | 34/79 [00:01<00:01, 39.51it/s] 52%|█████▏    | 41/79 [00:01<00:00, 44.12it/s] 61%|██████    | 48/79 [00:01<00:00, 48.99it/s] 72%|███████▏  | 57/79 [00:01<00:00, 58.38it/s] 84%|████████▎ | 66/79 [00:01<00:00, 65.59it/s] 94%|█████████▎| 74/79 [00:01<00:00, 69.12it/s]100%|██████████| 79/79 [00:01<00:00, 41.72it/s]
10000 images processed, 1.9213554859161377 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-seen/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:44,  1.23it/s]  3%|▎         | 7/204 [00:00<00:19, 10.02it/s]  7%|▋         | 14/204 [00:01<00:09, 20.37it/s] 11%|█▏        | 23/204 [00:01<00:05, 33.48it/s] 15%|█▌        | 31/204 [00:01<00:04, 43.24it/s] 19%|█▊        | 38/204 [00:01<00:03, 46.22it/s] 22%|██▏       | 45/204 [00:01<00:03, 47.13it/s] 25%|██▌       | 51/204 [00:01<00:03, 47.76it/s] 29%|██▉       | 60/204 [00:01<00:02, 56.68it/s] 34%|███▍      | 69/204 [00:01<00:02, 63.71it/s] 38%|███▊      | 78/204 [00:01<00:01, 69.65it/s] 42%|████▏     | 86/204 [00:02<00:01, 62.75it/s] 46%|████▌     | 93/204 [00:02<00:01, 61.42it/s] 49%|████▉     | 100/204 [00:02<00:01, 58.89it/s] 53%|█████▎    | 109/204 [00:02<00:01, 65.86it/s] 58%|█████▊    | 118/204 [00:02<00:01, 70.71it/s] 62%|██████▏   | 127/204 [00:02<00:01, 74.51it/s] 66%|██████▌   | 135/204 [00:02<00:01, 66.80it/s] 70%|██████▉   | 142/204 [00:02<00:00, 63.81it/s] 73%|███████▎  | 149/204 [00:03<00:00, 60.69it/s] 77%|███████▋  | 158/204 [00:03<00:00, 66.98it/s] 82%|████████▏ | 167/204 [00:03<00:00, 71.39it/s] 86%|████████▋ | 176/204 [00:03<00:00, 74.59it/s] 90%|█████████ | 184/204 [00:03<00:00, 63.18it/s] 94%|█████████▎| 191/204 [00:03<00:00, 63.98it/s] 97%|█████████▋| 198/204 [00:03<00:00, 62.21it/s]100%|██████████| 204/204 [00:03<00:00, 52.53it/s]
26032 images processed, 3.9323508739471436 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:09,  1.12it/s]  6%|▋         | 5/79 [00:00<00:11,  6.43it/s] 18%|█▊        | 14/79 [00:01<00:03, 19.87it/s] 29%|██▉       | 23/79 [00:01<00:01, 32.31it/s] 38%|███▊      | 30/79 [00:01<00:01, 35.34it/s] 47%|████▋     | 37/79 [00:01<00:01, 41.06it/s] 54%|█████▍    | 43/79 [00:01<00:00, 44.90it/s] 66%|██████▌   | 52/79 [00:01<00:00, 55.12it/s] 77%|███████▋  | 61/79 [00:01<00:00, 62.83it/s] 89%|████████▊ | 70/79 [00:01<00:00, 68.27it/s] 99%|█████████▊| 78/79 [00:02<00:00, 60.86it/s]100%|██████████| 79/79 [00:02<00:00, 37.71it/s]
10000 images processed, 2.1400973796844482 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:01,  1.26it/s]  4%|▍         | 3/79 [00:00<00:18,  4.10it/s] 10%|█         | 8/79 [00:00<00:05, 12.26it/s] 18%|█▊        | 14/79 [00:01<00:02, 21.74it/s] 27%|██▋       | 21/79 [00:01<00:01, 31.88it/s] 38%|███▊      | 30/79 [00:01<00:01, 44.95it/s] 47%|████▋     | 37/79 [00:01<00:00, 50.45it/s] 56%|█████▌    | 44/79 [00:01<00:00, 46.38it/s] 63%|██████▎   | 50/79 [00:01<00:00, 49.05it/s] 72%|███████▏  | 57/79 [00:01<00:00, 53.21it/s] 84%|████████▎ | 66/79 [00:01<00:00, 62.50it/s] 95%|█████████▍| 75/79 [00:02<00:00, 69.10it/s]100%|██████████| 79/79 [00:02<00:00, 38.38it/s]
10000 images processed, 2.080676317214966 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:54,  1.26it/s]  3%|▎         | 2/70 [00:00<00:27,  2.51it/s] 13%|█▎        | 9/70 [00:01<00:04, 14.10it/s] 26%|██▌       | 18/70 [00:01<00:01, 28.65it/s] 37%|███▋      | 26/70 [00:01<00:01, 39.36it/s] 47%|████▋     | 33/70 [00:01<00:00, 43.71it/s] 56%|█████▌    | 39/70 [00:01<00:00, 44.59it/s] 64%|██████▍   | 45/70 [00:01<00:00, 45.87it/s] 77%|███████▋  | 54/70 [00:01<00:00, 56.12it/s] 90%|█████████ | 63/70 [00:01<00:00, 64.61it/s]100%|██████████| 70/70 [00:01<00:00, 36.73it/s]
8925 images processed, 1.9401922225952148 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<01:07,  1.54s/it]  4%|▍         | 2/45 [00:01<00:30,  1.41it/s] 22%|██▏       | 10/45 [00:01<00:03,  9.62it/s] 38%|███▊      | 17/45 [00:02<00:02, 12.51it/s] 47%|████▋     | 21/45 [00:02<00:01, 14.93it/s] 56%|█████▌    | 25/45 [00:02<00:01, 18.24it/s] 64%|██████▍   | 29/45 [00:02<00:00, 21.64it/s] 73%|███████▎  | 33/45 [00:02<00:00, 16.03it/s] 82%|████████▏ | 37/45 [00:03<00:00, 18.82it/s]100%|██████████| 45/45 [00:03<00:00, 27.98it/s]100%|██████████| 45/45 [00:03<00:00, 14.11it/s]
5640 images processed, 3.2117462158203125 seconds used

23.713943243026733
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.46  98.78
places365     72.67  79.75
LSUN          27.04  94.18
iSUN          76.19  79.51
dtd           47.16  89.36
AVG           45.70  88.32
Retain-Acc: 0.7385
Forget-as-OOD (retain known vs forget novel):
  FPR: 38.00 AUROC: 88.86 AUIN: 99.23
44.16717314720154
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-seen_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage1-seen_rf.png
==== Stage 2: forget_inc={66,67,88,94,57}; forget_seen={0,8,11,40,51}; all={0,8,11,40,51,66,67,88,94,57} ====
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/PALM/main.py:54: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Namespace(in_dataset='CIFAR-100', out_datasets=['inat', 'sun50', 'places50', 'dtd'], backbone='resnet34', method='top5-palm-cache6-ema0.999', seed=1, gpu='0', epochs=50, batch_size=128, lr=0.001, weight_decay=0.0001, print_every=50, fine_tune=False, temp=0.08, cosine=True, warm=False, lr_decay_epochs='700,800,900', lr_decay_rate=0.1, layers=100, depth=40, width=4, growth=12, droprate=0.0, save_path='CIFAR-10-ResNet18.pt', load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt', reduce=0.5, score='mahalanobis', threshold=1.0, k=5, momentum=0.9, proto_m=0.999, cache_size=6, nviews=2, lambda_pcon=1.0, epsilon=0.05, incremental=False, use_lora=True, lora_impl='peft', lora_r=8, lora_alpha=32, lora_dropout=0.05, lora_target='both', adapter_save_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2', adapter_load_path='checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1', lora_stack=False, lora_orth_enable=False, lora_orth_lambda=0.1, lora_orth_ref_paths=None, forget_classes='0,8,11,40,51,66,67,88,94,57', forget_list_path=None, forget_classes_inc='66,67,88,94,57', forget_classes_seen='0,8,11,40,51', retain_exclude_csv=None, forget_csv=None, forget_lambda=0.2, forget_margin=100.0, forget_strategy='proto', centers_path=None, precision_path=None, batch_forget_mode='balanced', forget_proto_enable=False, forget_attr_w=1.0, forget_proto_rep_w=1.0, forget_avgproto_enable=False, forget_avgproto_w=1.0, umap_enable=False, umap_by='domain', umap_max_points=20000, umap_neighbors=15, umap_min_dist=0.05, umap_metric='cosine', umap_save_path=None, umap_rf_only=False, keep_cache=False, argument=True)
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage1
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999: Number of model parameters: 21843904
[debug] trainable_count = 16
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.1.conv2.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv1.lora_B.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_A.default.weight
[debug] trainable: base_model.model.encoder.layer4.2.conv2.lora_B.default.weight
[debug] trainable: base_model.model.head.2.lora_A.default.weight
[debug] trainable: base_model.model.head.2.lora_B.default.weight
[debug][warn] non-LoRA trainables detected: ['base_model.model.encoder.layer4.0.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.0.conv2.lora_B.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_A.default.weight', 'base_model.model.encoder.layer4.0.shortcut.0.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv1.lora_B.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_A.default.weight', 'base_model.model.encoder.layer4.1.conv2.lora_B.default.weight']
  0%|          | 0/50 [00:00<?, ?it/s]/home/shaokun/PALM/trainer.py:163: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
  2%|▏         | 1/50 [01:12<59:32, 72.91s/it]  4%|▍         | 2/50 [01:57<45:09, 56.44s/it]  6%|▌         | 3/50 [02:43<40:18, 51.46s/it]  8%|▊         | 4/50 [03:28<37:28, 48.88s/it] 10%|█         | 5/50 [04:16<36:35, 48.79s/it] 12%|█▏        | 6/50 [04:58<33:58, 46.33s/it][loss] ep 0 it 0 total=8.6046 mle=1.9348 pcon=5.2948 forget=1.3749 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 0 it 50 total=8.5193 mle=1.8787 pcon=5.2809 forget=1.3597 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 0 it 100 total=8.5643 mle=1.9471 pcon=5.2666 forget=1.3505 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 0 it 150 total=8.4621 mle=1.8480 pcon=5.2527 forget=1.3614 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 0 it 200 total=8.5427 mle=1.9478 pcon=5.2390 forget=1.3559 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 0 it 250 total=8.4125 mle=1.8245 pcon=5.2257 forget=1.3623 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 0 it 300 total=8.4244 mle=1.8512 pcon=5.2128 forget=1.3603 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 0 it 350 total=8.4977 mle=1.9358 pcon=5.2001 forget=1.3617 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 1 it 10 total=8.3975 mle=1.8458 pcon=5.1876 forget=1.3641 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 1 it 60 total=8.3012 mle=1.7795 pcon=5.1753 forget=1.3464 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 1 it 110 total=8.3772 mle=1.8521 pcon=5.1641 forget=1.3610 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 1 it 160 total=8.3214 mle=1.8078 pcon=5.1527 forget=1.3608 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 1 it 210 total=8.3604 mle=1.8437 pcon=5.1415 forget=1.3752 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 1 it 260 total=8.0885 mle=1.5867 pcon=5.1305 forget=1.3713 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 1 it 310 total=8.0909 mle=1.5984 pcon=5.1197 forget=1.3727 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 1 it 360 total=8.2173 mle=1.6999 pcon=5.1093 forget=1.4080 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 2 it 20 total=8.0213 mle=1.5701 pcon=5.0993 forget=1.3519 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 2 it 70 total=8.2150 mle=1.7739 pcon=5.0894 forget=1.3517 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 2 it 120 total=8.1236 mle=1.6798 pcon=5.0797 forget=1.3641 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 2 it 170 total=8.0934 mle=1.6366 pcon=5.0704 forget=1.3864 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 2 it 220 total=8.2037 mle=1.7880 pcon=5.0611 forget=1.3546 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 2 it 270 total=7.9539 mle=1.5584 pcon=5.0524 forget=1.3430 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 2 it 320 total=8.0777 mle=1.6652 pcon=5.0439 forget=1.3686 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 2 it 370 total=8.1823 mle=1.7804 pcon=5.0353 forget=1.3667 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 3 it 30 total=8.1780 mle=1.8115 pcon=5.0269 forget=1.3396 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 80 total=8.0119 mle=1.6432 pcon=5.0187 forget=1.3500 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 130 total=7.9975 mle=1.6269 pcon=5.0105 forget=1.3601 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 3 it 180 total=7.9559 mle=1.5874 pcon=5.0027 forget=1.3658 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 230 total=8.0371 mle=1.6925 pcon=4.9950 forget=1.3496 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 3 it 280 total=8.0138 mle=1.6511 pcon=4.9874 forget=1.3753 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 3 it 330 total=7.8952 mle=1.5537 pcon=4.9800 forget=1.3614 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 3 it 380 total=8.0561 mle=1.7230 pcon=4.9729 forget=1.3601 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 4 it 40 total=8.2204 mle=1.8756 pcon=4.9658 forget=1.3790 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 4 it 90 total=8.0821 mle=1.7603 pcon=4.9591 forget=1.3628 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 4 it 140 total=7.9926 mle=1.6544 pcon=4.9526 forget=1.3856 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 4 it 190 total=7.9584 mle=1.6358 pcon=4.9457 forget=1.3770 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 4 it 240 total=7.8869 mle=1.5735 pcon=4.9393 forget=1.3740 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 4 it 290 total=8.1361 mle=1.8400 pcon=4.9329 forget=1.3632 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 4 it 340 total=8.1357 mle=1.8468 pcon=4.9267 forget=1.3622 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 5 it 0 total=8.0136 mle=1.7276 pcon=4.9207 forget=1.3653 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 5 it 50 total=7.9378 mle=1.6712 pcon=4.9148 forget=1.3519 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 5 it 100 total=7.7785 mle=1.4888 pcon=4.9087 forget=1.3810 orth=0.0000 favg=0.0000 nr=55 nf=55 protos=540 fproto_sim=NA
[loss] ep 5 it 150 total=7.9624 mle=1.6956 pcon=4.9033 forget=1.3635 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 5 it 200 total=7.9602 mle=1.6964 pcon=4.8977 forget=1.3661 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 5 it 250 total=7.8200 mle=1.5724 pcon=4.8924 forget=1.3552 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 5 it 300 total=8.0002 mle=1.7750 pcon=4.8870 forget=1.3382 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 5 it 350 total=8.0078 mle=1.7859 pcon=4.8818 forget=1.3401 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 6 it 10 total=7.8999 mle=1.6658 pcon=4.8767 forget=1.3574 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 6 it 60 total=7.9441 mle=1.7059 pcon=4.8719 forget=1.3662 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 110 total=7.8087 mle=1.5780 pcon=4.8669 forget=1.3638 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 6 it 160 total=7.8071 mle=1.5943 pcon=4.8621 forget=1.3507 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 6 it 210 total=8.1812 mle=1.9636 pcon=4.8573 forget=1.3603 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 260 total=7.8292 mle=1.6358 pcon=4.8526 forget=1.3408 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 310 total=7.7538 mle=1.5380 pcon=4.8480 forget=1.3678 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 6 it 360 total=7.8273 mle=1.6238 pcon=4.8435 forget=1.3600 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
 14%|█▍        | 7/50 [05:40<32:14, 45.00s/it] 16%|█▌        | 8/50 [06:21<30:35, 43.71s/it] 18%|█▊        | 9/50 [07:01<28:57, 42.37s/it] 20%|██        | 10/50 [07:39<27:27, 41.19s/it] 22%|██▏       | 11/50 [08:20<26:39, 41.01s/it] 24%|██▍       | 12/50 [09:02<26:07, 41.26s/it] 26%|██▌       | 13/50 [09:43<25:34, 41.46s/it][peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 7 it 20 total=7.8562 mle=1.6840 pcon=4.8391 forget=1.3331 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 7 it 70 total=7.9434 mle=1.7614 pcon=4.8347 forget=1.3473 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 7 it 120 total=7.7999 mle=1.6529 pcon=4.8305 forget=1.3165 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 7 it 170 total=7.9674 mle=1.7958 pcon=4.8266 forget=1.3450 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 7 it 220 total=7.8137 mle=1.6493 pcon=4.8230 forget=1.3414 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 7 it 270 total=7.6830 mle=1.5294 pcon=4.8194 forget=1.3343 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 7 it 320 total=7.9055 mle=1.7449 pcon=4.8156 forget=1.3449 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 7 it 370 total=7.8454 mle=1.6706 pcon=4.8119 forget=1.3629 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 8 it 30 total=7.6550 mle=1.5045 pcon=4.8084 forget=1.3421 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 80 total=7.6796 mle=1.5391 pcon=4.8050 forget=1.3354 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 130 total=7.7871 mle=1.6577 pcon=4.8014 forget=1.3280 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 8 it 180 total=7.7141 mle=1.5814 pcon=4.7980 forget=1.3347 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 8 it 230 total=7.7397 mle=1.5996 pcon=4.7947 forget=1.3454 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 280 total=7.8217 mle=1.6838 pcon=4.7916 forget=1.3464 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 8 it 330 total=7.7956 mle=1.6475 pcon=4.7886 forget=1.3595 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 8 it 380 total=7.7604 mle=1.6359 pcon=4.7857 forget=1.3388 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 9 it 40 total=7.7354 mle=1.6242 pcon=4.7827 forget=1.3285 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 9 it 90 total=7.8314 mle=1.7291 pcon=4.7797 forget=1.3227 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 9 it 140 total=7.7468 mle=1.6287 pcon=4.7769 forget=1.3413 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 9 it 190 total=7.6729 mle=1.5642 pcon=4.7740 forget=1.3348 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 9 it 240 total=7.8772 mle=1.7699 pcon=4.7714 forget=1.3359 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 9 it 290 total=7.8086 mle=1.7132 pcon=4.7687 forget=1.3268 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 9 it 340 total=7.6429 mle=1.5521 pcon=4.7660 forget=1.3247 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 10 it 0 total=7.8046 mle=1.7106 pcon=4.7635 forget=1.3305 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 10 it 50 total=7.7652 mle=1.6895 pcon=4.7611 forget=1.3146 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 10 it 100 total=7.7255 mle=1.6187 pcon=4.7589 forget=1.3480 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 10 it 150 total=7.6125 mle=1.5245 pcon=4.7565 forget=1.3314 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 10 it 200 total=7.7053 mle=1.6092 pcon=4.7543 forget=1.3417 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 10 it 250 total=7.6887 mle=1.5973 pcon=4.7520 forget=1.3394 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 10 it 300 total=7.9244 mle=1.8524 pcon=4.7497 forget=1.3223 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 10 it 350 total=7.7066 mle=1.6489 pcon=4.7477 forget=1.3100 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 11 it 10 total=7.6711 mle=1.6099 pcon=4.7456 forget=1.3157 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 11 it 60 total=7.6334 mle=1.5880 pcon=4.7437 forget=1.3017 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 11 it 110 total=7.7548 mle=1.7110 pcon=4.7418 forget=1.3020 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 11 it 160 total=7.6059 mle=1.5668 pcon=4.7399 forget=1.2991 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 11 it 210 total=7.5927 mle=1.5597 pcon=4.7380 forget=1.2950 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 11 it 260 total=7.7272 mle=1.6943 pcon=4.7364 forget=1.2965 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 11 it 310 total=7.8455 mle=1.8049 pcon=4.7346 forget=1.3060 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 11 it 360 total=7.7292 mle=1.7123 pcon=4.7330 forget=1.2839 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 12 it 20 total=7.7005 mle=1.6980 pcon=4.7313 forget=1.2712 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 12 it 70 total=7.6718 mle=1.6554 pcon=4.7297 forget=1.2866 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 12 it 120 total=7.6435 mle=1.6335 pcon=4.7282 forget=1.2818 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 12 it 170 total=7.6176 mle=1.6087 pcon=4.7267 forget=1.2822 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 12 it 220 total=7.5523 mle=1.5482 pcon=4.7252 forget=1.2789 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 12 it 270 total=7.5377 mle=1.5344 pcon=4.7237 forget=1.2795 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 12 it 320 total=7.6497 mle=1.6482 pcon=4.7223 forget=1.2793 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 12 it 370 total=7.6165 mle=1.6465 pcon=4.7207 forget=1.2494 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 13 it 30 total=7.6228 mle=1.6364 pcon=4.7191 forget=1.2674 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 80 total=7.6185 mle=1.6530 pcon=4.7178 forget=1.2477 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 130 total=7.6171 mle=1.6405 pcon=4.7165 forget=1.2601 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 13 it 180 total=7.6224 mle=1.6588 pcon=4.7152 forget=1.2484 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 230 total=7.6069 mle=1.6532 pcon=4.7139 forget=1.2398 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 13 it 280 total=7.5826 mle=1.6264 pcon=4.7124 forget=1.2438 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
 28%|██▊       | 14/50 [10:25<24:49, 41.37s/it] 30%|███       | 15/50 [11:06<24:11, 41.47s/it] 32%|███▏      | 16/50 [11:45<23:01, 40.62s/it] 34%|███▍      | 17/50 [12:25<22:14, 40.44s/it] 36%|███▌      | 18/50 [13:04<21:24, 40.15s/it] 38%|███▊      | 19/50 [13:45<20:49, 40.31s/it] 40%|████      | 20/50 [14:28<20:34, 41.14s/it] 42%|████▏     | 21/50 [15:15<20:41, 42.82s/it][loss] ep 13 it 330 total=7.5057 mle=1.5643 pcon=4.7110 forget=1.2305 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 13 it 380 total=7.4949 mle=1.5570 pcon=4.7098 forget=1.2281 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 14 it 40 total=7.5660 mle=1.6203 pcon=4.7083 forget=1.2374 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 14 it 90 total=7.7846 mle=1.8568 pcon=4.7070 forget=1.2208 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 14 it 140 total=7.6363 mle=1.7032 pcon=4.7057 forget=1.2275 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 14 it 190 total=7.5245 mle=1.5987 pcon=4.7044 forget=1.2215 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 14 it 240 total=7.8086 mle=1.8680 pcon=4.7031 forget=1.2375 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 14 it 290 total=7.7618 mle=1.8304 pcon=4.7021 forget=1.2294 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 14 it 340 total=7.5969 mle=1.6575 pcon=4.7010 forget=1.2384 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 15 it 0 total=7.5385 mle=1.6111 pcon=4.6997 forget=1.2277 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 15 it 50 total=7.6957 mle=1.7440 pcon=4.6986 forget=1.2531 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 100 total=7.6472 mle=1.7280 pcon=4.6975 forget=1.2217 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 15 it 150 total=7.5109 mle=1.5890 pcon=4.6964 forget=1.2256 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 200 total=7.5915 mle=1.6777 pcon=4.6952 forget=1.2186 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 250 total=7.6566 mle=1.7334 pcon=4.6941 forget=1.2291 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 15 it 300 total=7.5776 mle=1.6569 pcon=4.6930 forget=1.2276 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 15 it 350 total=7.5026 mle=1.5827 pcon=4.6920 forget=1.2279 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[peft] adapter saved to checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[loss] ep 16 it 10 total=7.4853 mle=1.5673 pcon=4.6909 forget=1.2270 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 16 it 60 total=7.6606 mle=1.7404 pcon=4.6899 forget=1.2303 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 16 it 110 total=7.4748 mle=1.5570 pcon=4.6891 forget=1.2287 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 16 it 160 total=7.4881 mle=1.5676 pcon=4.6881 forget=1.2324 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 16 it 210 total=7.6076 mle=1.6837 pcon=4.6871 forget=1.2368 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 16 it 260 total=7.6573 mle=1.7175 pcon=4.6862 forget=1.2536 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 16 it 310 total=7.4927 mle=1.5615 pcon=4.6852 forget=1.2460 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 16 it 360 total=7.4511 mle=1.5270 pcon=4.6843 forget=1.2398 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 17 it 20 total=7.9728 mle=2.0360 pcon=4.6834 forget=1.2534 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 70 total=7.7226 mle=1.7917 pcon=4.6825 forget=1.2483 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 120 total=7.5825 mle=1.6434 pcon=4.6816 forget=1.2574 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 17 it 170 total=7.5046 mle=1.5612 pcon=4.6808 forget=1.2626 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 220 total=7.7465 mle=1.8044 pcon=4.6801 forget=1.2620 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 17 it 270 total=7.7605 mle=1.8093 pcon=4.6792 forget=1.2720 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 17 it 320 total=7.5622 mle=1.6193 pcon=4.6783 forget=1.2647 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 17 it 370 total=7.5407 mle=1.5838 pcon=4.6775 forget=1.2794 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 30 total=7.5401 mle=1.5860 pcon=4.6768 forget=1.2773 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 80 total=7.6384 mle=1.6796 pcon=4.6762 forget=1.2827 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 130 total=7.6372 mle=1.6752 pcon=4.6756 forget=1.2864 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 18 it 180 total=7.6656 mle=1.7041 pcon=4.6749 forget=1.2866 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 18 it 230 total=7.5667 mle=1.6054 pcon=4.6744 forget=1.2870 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 18 it 280 total=7.7261 mle=1.7582 pcon=4.6736 forget=1.2943 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 18 it 330 total=7.7693 mle=1.8071 pcon=4.6731 forget=1.2891 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 18 it 380 total=7.6735 mle=1.7009 pcon=4.6724 forget=1.3002 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 19 it 40 total=7.6829 mle=1.7169 pcon=4.6719 forget=1.2941 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 19 it 90 total=7.5026 mle=1.5336 pcon=4.6713 forget=1.2977 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 19 it 140 total=7.7190 mle=1.7407 pcon=4.6707 forget=1.3077 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 19 it 190 total=7.7517 mle=1.7765 pcon=4.6700 forget=1.3051 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 19 it 240 total=7.6580 mle=1.6809 pcon=4.6694 forget=1.3077 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 19 it 290 total=7.6258 mle=1.6462 pcon=4.6690 forget=1.3106 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 19 it 340 total=7.6721 mle=1.6815 pcon=4.6685 forget=1.3221 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 20 it 0 total=7.6471 mle=1.6572 pcon=4.6679 forget=1.3220 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 20 it 50 total=7.4832 mle=1.4990 pcon=4.6676 forget=1.3167 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 20 it 100 total=7.7791 mle=1.7976 pcon=4.6672 forget=1.3144 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 150 total=7.7487 mle=1.7581 pcon=4.6670 forget=1.3236 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 200 total=7.6024 mle=1.6065 pcon=4.6666 forget=1.3293 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 20 it 250 total=7.6492 mle=1.6540 pcon=4.6663 forget=1.3289 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 300 total=7.7473 mle=1.7456 pcon=4.6658 forget=1.3359 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 20 it 350 total=7.7217 mle=1.7261 pcon=4.6654 forget=1.3302 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 21 it 10 total=7.6160 mle=1.6254 pcon=4.6649 forget=1.3257 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 21 it 60 total=7.6849 mle=1.6842 pcon=4.6645 forget=1.3362 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
 44%|████▍     | 22/50 [15:57<19:52, 42.60s/it] 46%|████▌     | 23/50 [16:38<18:56, 42.10s/it] 48%|████▊     | 24/50 [17:18<18:01, 41.58s/it] 50%|█████     | 25/50 [17:58<17:04, 40.97s/it] 52%|█████▏    | 26/50 [18:40<16:31, 41.32s/it] 54%|█████▍    | 27/50 [19:22<15:51, 41.37s/it] 56%|█████▌    | 28/50 [20:01<14:58, 40.83s/it] 58%|█████▊    | 29/50 [20:41<14:13, 40.62s/it][loss] ep 21 it 110 total=7.8045 mle=1.8051 pcon=4.6641 forget=1.3352 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 21 it 160 total=7.6512 mle=1.6522 pcon=4.6638 forget=1.3352 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 21 it 210 total=7.5818 mle=1.5819 pcon=4.6635 forget=1.3364 orth=0.0000 favg=0.0000 nr=55 nf=55 protos=540 fproto_sim=NA
[loss] ep 21 it 260 total=7.6743 mle=1.6725 pcon=4.6632 forget=1.3386 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 21 it 310 total=7.5498 mle=1.5396 pcon=4.6629 forget=1.3472 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 21 it 360 total=7.6037 mle=1.5996 pcon=4.6627 forget=1.3414 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 22 it 20 total=7.8162 mle=1.8163 pcon=4.6624 forget=1.3374 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 22 it 70 total=7.5934 mle=1.5814 pcon=4.6621 forget=1.3499 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 120 total=7.6297 mle=1.6248 pcon=4.6619 forget=1.3430 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 22 it 170 total=7.6138 mle=1.6095 pcon=4.6617 forget=1.3426 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 220 total=7.6823 mle=1.6646 pcon=4.6614 forget=1.3562 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 22 it 270 total=7.9893 mle=1.9755 pcon=4.6612 forget=1.3527 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 320 total=7.6926 mle=1.6750 pcon=4.6609 forget=1.3568 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 22 it 370 total=7.7015 mle=1.6920 pcon=4.6607 forget=1.3488 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 23 it 30 total=7.7532 mle=1.7293 pcon=4.6604 forget=1.3635 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 23 it 80 total=7.7218 mle=1.7110 pcon=4.6601 forget=1.3507 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 23 it 130 total=7.6099 mle=1.5998 pcon=4.6598 forget=1.3504 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 23 it 180 total=7.7165 mle=1.7080 pcon=4.6596 forget=1.3489 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 23 it 230 total=7.8716 mle=1.8517 pcon=4.6593 forget=1.3606 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 23 it 280 total=7.6098 mle=1.5921 pcon=4.6590 forget=1.3587 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 23 it 330 total=7.6803 mle=1.6694 pcon=4.6586 forget=1.3523 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 23 it 380 total=7.6630 mle=1.6530 pcon=4.6585 forget=1.3515 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 24 it 40 total=7.6764 mle=1.6638 pcon=4.6583 forget=1.3543 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 24 it 90 total=7.6300 mle=1.6090 pcon=4.6581 forget=1.3629 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 24 it 140 total=7.6950 mle=1.6759 pcon=4.6578 forget=1.3612 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 24 it 190 total=7.8449 mle=1.8268 pcon=4.6575 forget=1.3606 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 24 it 240 total=7.7871 mle=1.7619 pcon=4.6573 forget=1.3680 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 24 it 290 total=7.8554 mle=1.8301 pcon=4.6571 forget=1.3682 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 24 it 340 total=7.7419 mle=1.7216 pcon=4.6569 forget=1.3634 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 0 total=7.6418 mle=1.6244 pcon=4.6567 forget=1.3607 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 50 total=7.7045 mle=1.6841 pcon=4.6565 forget=1.3639 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 100 total=7.5427 mle=1.5280 pcon=4.6562 forget=1.3585 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 25 it 150 total=7.7671 mle=1.7493 pcon=4.6562 forget=1.3616 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 25 it 200 total=7.8791 mle=1.8436 pcon=4.6561 forget=1.3793 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 25 it 250 total=7.5861 mle=1.5716 pcon=4.6557 forget=1.3587 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 25 it 300 total=7.7957 mle=1.7717 pcon=4.6555 forget=1.3685 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 25 it 350 total=7.6687 mle=1.6563 pcon=4.6553 forget=1.3571 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 10 total=7.7260 mle=1.7138 pcon=4.6551 forget=1.3572 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 26 it 60 total=7.6570 mle=1.6397 pcon=4.6548 forget=1.3625 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 110 total=7.6240 mle=1.6160 pcon=4.6547 forget=1.3533 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 26 it 160 total=7.6790 mle=1.6629 pcon=4.6545 forget=1.3616 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 210 total=7.9584 mle=1.9488 pcon=4.6542 forget=1.3553 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 260 total=7.6723 mle=1.6616 pcon=4.6540 forget=1.3567 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 26 it 310 total=7.6412 mle=1.6350 pcon=4.6538 forget=1.3524 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 26 it 360 total=7.6332 mle=1.6159 pcon=4.6535 forget=1.3638 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 27 it 20 total=7.6465 mle=1.6376 pcon=4.6534 forget=1.3556 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 27 it 70 total=7.6579 mle=1.6416 pcon=4.6532 forget=1.3630 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 27 it 120 total=7.8914 mle=1.8767 pcon=4.6528 forget=1.3619 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 27 it 170 total=7.5985 mle=1.5906 pcon=4.6526 forget=1.3552 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 27 it 220 total=7.7589 mle=1.7450 pcon=4.6525 forget=1.3614 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 27 it 270 total=7.6601 mle=1.6504 pcon=4.6523 forget=1.3573 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 27 it 320 total=7.5773 mle=1.5580 pcon=4.6522 forget=1.3671 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 27 it 370 total=7.7127 mle=1.6991 pcon=4.6520 forget=1.3617 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 28 it 30 total=7.6449 mle=1.6361 pcon=4.6518 forget=1.3570 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 28 it 80 total=7.6560 mle=1.6353 pcon=4.6515 forget=1.3692 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 28 it 130 total=7.6775 mle=1.6671 pcon=4.6514 forget=1.3590 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 28 it 180 total=7.6177 mle=1.5977 pcon=4.6512 forget=1.3687 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 28 it 230 total=7.7221 mle=1.7139 pcon=4.6511 forget=1.3571 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 28 it 280 total=7.7170 mle=1.7042 pcon=4.6509 forget=1.3619 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 28 it 330 total=7.6666 mle=1.6415 pcon=4.6507 forget=1.3745 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 28 it 380 total=7.7893 mle=1.7738 pcon=4.6504 forget=1.3651 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 29 it 40 total=7.7389 mle=1.7192 pcon=4.6501 forget=1.3696 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
 60%|██████    | 30/50 [21:24<13:42, 41.12s/it] 62%|██████▏   | 31/50 [22:05<13:04, 41.27s/it] 64%|██████▍   | 32/50 [22:47<12:23, 41.30s/it] 66%|██████▌   | 33/50 [23:27<11:37, 41.04s/it] 68%|██████▊   | 34/50 [24:13<11:22, 42.65s/it] 70%|███████   | 35/50 [24:57<10:42, 42.83s/it] 72%|███████▏  | 36/50 [25:37<09:49, 42.13s/it] 74%|███████▍  | 37/50 [26:20<09:08, 42.22s/it][loss] ep 29 it 90 total=7.7263 mle=1.7069 pcon=4.6501 forget=1.3693 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 29 it 140 total=7.6334 mle=1.6198 pcon=4.6501 forget=1.3636 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 29 it 190 total=7.6603 mle=1.6477 pcon=4.6499 forget=1.3627 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 29 it 240 total=7.5875 mle=1.5734 pcon=4.6498 forget=1.3644 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 29 it 290 total=7.6709 mle=1.6490 pcon=4.6496 forget=1.3724 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 29 it 340 total=7.6228 mle=1.6115 pcon=4.6494 forget=1.3619 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 30 it 0 total=7.7577 mle=1.7378 pcon=4.6493 forget=1.3707 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 30 it 50 total=7.7306 mle=1.7143 pcon=4.6490 forget=1.3672 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 30 it 100 total=7.6263 mle=1.6108 pcon=4.6489 forget=1.3666 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 30 it 150 total=7.7098 mle=1.6974 pcon=4.6488 forget=1.3637 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 30 it 200 total=7.7194 mle=1.7068 pcon=4.6486 forget=1.3639 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 30 it 250 total=7.9453 mle=1.9315 pcon=4.6486 forget=1.3651 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 30 it 300 total=7.8644 mle=1.8525 pcon=4.6485 forget=1.3634 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 30 it 350 total=7.7789 mle=1.7604 pcon=4.6482 forget=1.3702 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 10 total=7.6780 mle=1.6642 pcon=4.6480 forget=1.3657 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 31 it 60 total=7.5913 mle=1.5670 pcon=4.6478 forget=1.3765 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 31 it 110 total=7.6746 mle=1.6590 pcon=4.6476 forget=1.3680 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 160 total=7.6492 mle=1.6360 pcon=4.6474 forget=1.3658 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 210 total=7.6513 mle=1.6305 pcon=4.6472 forget=1.3736 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 31 it 260 total=7.5588 mle=1.5391 pcon=4.6472 forget=1.3724 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 31 it 310 total=7.6717 mle=1.6508 pcon=4.6471 forget=1.3737 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 31 it 360 total=7.5854 mle=1.5714 pcon=4.6469 forget=1.3670 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 32 it 20 total=7.7014 mle=1.6816 pcon=4.6468 forget=1.3730 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 70 total=7.6501 mle=1.6269 pcon=4.6466 forget=1.3766 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 32 it 120 total=7.7483 mle=1.7266 pcon=4.6463 forget=1.3753 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 32 it 170 total=7.6576 mle=1.6388 pcon=4.6460 forget=1.3728 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 32 it 220 total=7.6611 mle=1.6407 pcon=4.6460 forget=1.3743 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 270 total=7.7081 mle=1.6806 pcon=4.6458 forget=1.3817 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 320 total=7.6852 mle=1.6626 pcon=4.6456 forget=1.3769 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 32 it 370 total=7.7091 mle=1.6839 pcon=4.6455 forget=1.3797 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 33 it 30 total=7.9647 mle=1.9469 pcon=4.6455 forget=1.3723 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 33 it 80 total=7.9981 mle=1.9721 pcon=4.6454 forget=1.3806 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 33 it 130 total=7.8760 mle=1.8528 pcon=4.6453 forget=1.3779 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 33 it 180 total=7.6932 mle=1.6601 pcon=4.6452 forget=1.3879 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 33 it 230 total=7.6360 mle=1.6081 pcon=4.6451 forget=1.3828 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 33 it 280 total=7.7718 mle=1.7446 pcon=4.6451 forget=1.3820 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 33 it 330 total=7.7802 mle=1.7587 pcon=4.6451 forget=1.3763 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 33 it 380 total=7.6713 mle=1.6507 pcon=4.6450 forget=1.3757 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 34 it 40 total=7.8600 mle=1.8356 pcon=4.6449 forget=1.3795 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 34 it 90 total=7.6785 mle=1.6538 pcon=4.6448 forget=1.3800 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 34 it 140 total=8.0169 mle=1.9807 pcon=4.6446 forget=1.3915 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 34 it 190 total=7.8397 mle=1.8045 pcon=4.6445 forget=1.3907 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 34 it 240 total=7.6898 mle=1.6685 pcon=4.6444 forget=1.3769 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 34 it 290 total=7.6747 mle=1.6528 pcon=4.6443 forget=1.3776 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 34 it 340 total=7.5418 mle=1.5132 pcon=4.6442 forget=1.3844 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 0 total=7.5509 mle=1.5254 pcon=4.6440 forget=1.3814 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 50 total=7.8403 mle=1.8135 pcon=4.6438 forget=1.3830 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 35 it 100 total=7.6077 mle=1.5727 pcon=4.6438 forget=1.3911 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 150 total=7.7174 mle=1.6892 pcon=4.6438 forget=1.3844 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 35 it 200 total=7.6614 mle=1.6305 pcon=4.6438 forget=1.3871 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 35 it 250 total=7.6195 mle=1.5812 pcon=4.6438 forget=1.3944 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 35 it 300 total=7.5462 mle=1.5183 pcon=4.6437 forget=1.3842 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 35 it 350 total=7.5133 mle=1.4888 pcon=4.6436 forget=1.3809 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 36 it 10 total=7.7456 mle=1.7198 pcon=4.6434 forget=1.3824 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 36 it 60 total=7.8574 mle=1.8348 pcon=4.6434 forget=1.3792 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 36 it 110 total=7.7521 mle=1.7160 pcon=4.6433 forget=1.3928 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 36 it 160 total=7.8643 mle=1.8253 pcon=4.6433 forget=1.3958 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 36 it 210 total=7.7595 mle=1.7313 pcon=4.6431 forget=1.3852 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 36 it 260 total=7.7736 mle=1.7466 pcon=4.6430 forget=1.3840 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 36 it 310 total=7.6819 mle=1.6573 pcon=4.6430 forget=1.3817 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 36 it 360 total=7.6393 mle=1.6173 pcon=4.6429 forget=1.3791 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 37 it 20 total=7.6557 mle=1.6271 pcon=4.6428 forget=1.3859 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
 76%|███████▌  | 38/50 [27:02<08:27, 42.32s/it] 78%|███████▊  | 39/50 [27:46<07:49, 42.68s/it] 80%|████████  | 40/50 [28:27<07:01, 42.16s/it] 82%|████████▏ | 41/50 [29:08<06:16, 41.87s/it] 84%|████████▍ | 42/50 [29:50<05:35, 41.93s/it] 86%|████████▌ | 43/50 [30:31<04:52, 41.79s/it] 88%|████████▊ | 44/50 [31:12<04:09, 41.58s/it] 90%|█████████ | 45/50 [31:55<03:28, 41.79s/it][loss] ep 37 it 70 total=7.6182 mle=1.5842 pcon=4.6428 forget=1.3912 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 37 it 120 total=7.7042 mle=1.6720 pcon=4.6429 forget=1.3893 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 37 it 170 total=7.7516 mle=1.7224 pcon=4.6428 forget=1.3864 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 37 it 220 total=7.6567 mle=1.6213 pcon=4.6426 forget=1.3927 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 37 it 270 total=7.7625 mle=1.7315 pcon=4.6426 forget=1.3885 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 37 it 320 total=7.8757 mle=1.8374 pcon=4.6426 forget=1.3957 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 37 it 370 total=7.6369 mle=1.6052 pcon=4.6426 forget=1.3892 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 38 it 30 total=7.5815 mle=1.5615 pcon=4.6426 forget=1.3774 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 38 it 80 total=7.6592 mle=1.6277 pcon=4.6425 forget=1.3889 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 38 it 130 total=7.7179 mle=1.6768 pcon=4.6425 forget=1.3986 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 38 it 180 total=7.7434 mle=1.7075 pcon=4.6424 forget=1.3934 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 38 it 230 total=7.7675 mle=1.7353 pcon=4.6424 forget=1.3898 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 38 it 280 total=7.7296 mle=1.6985 pcon=4.6424 forget=1.3887 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 38 it 330 total=7.6747 mle=1.6325 pcon=4.6425 forget=1.3997 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 38 it 380 total=7.8898 mle=1.8562 pcon=4.6423 forget=1.3913 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 39 it 40 total=7.6984 mle=1.6711 pcon=4.6422 forget=1.3851 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 90 total=7.6614 mle=1.6237 pcon=4.6421 forget=1.3956 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 140 total=7.6227 mle=1.5920 pcon=4.6420 forget=1.3887 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 190 total=7.7523 mle=1.7265 pcon=4.6420 forget=1.3838 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 39 it 240 total=7.7425 mle=1.7101 pcon=4.6419 forget=1.3906 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 39 it 290 total=7.9061 mle=1.8781 pcon=4.6419 forget=1.3862 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 39 it 340 total=7.6913 mle=1.6723 pcon=4.6420 forget=1.3769 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 40 it 0 total=7.6602 mle=1.6352 pcon=4.6419 forget=1.3831 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 40 it 50 total=7.6090 mle=1.5828 pcon=4.6418 forget=1.3845 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 40 it 100 total=7.5958 mle=1.5645 pcon=4.6416 forget=1.3897 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 40 it 150 total=7.7862 mle=1.7675 pcon=4.6414 forget=1.3772 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 40 it 200 total=7.6395 mle=1.6131 pcon=4.6414 forget=1.3849 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 40 it 250 total=7.7523 mle=1.7295 pcon=4.6413 forget=1.3815 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 40 it 300 total=7.6403 mle=1.6057 pcon=4.6413 forget=1.3933 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 40 it 350 total=7.8425 mle=1.8135 pcon=4.6412 forget=1.3878 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 41 it 10 total=7.8890 mle=1.8674 pcon=4.6411 forget=1.3805 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 41 it 60 total=7.6021 mle=1.5840 pcon=4.6410 forget=1.3771 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 41 it 110 total=7.7253 mle=1.7036 pcon=4.6410 forget=1.3807 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 41 it 160 total=7.8538 mle=1.8293 pcon=4.6410 forget=1.3836 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 41 it 210 total=7.6568 mle=1.6376 pcon=4.6410 forget=1.3783 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 41 it 260 total=7.6453 mle=1.6181 pcon=4.6408 forget=1.3864 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 41 it 310 total=7.6737 mle=1.6553 pcon=4.6406 forget=1.3777 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 41 it 360 total=7.6082 mle=1.5860 pcon=4.6406 forget=1.3817 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 42 it 20 total=7.6968 mle=1.6788 pcon=4.6405 forget=1.3775 orth=0.0000 favg=0.0000 nr=56 nf=56 protos=540 fproto_sim=NA
[loss] ep 42 it 70 total=7.7230 mle=1.6999 pcon=4.6404 forget=1.3826 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 42 it 120 total=7.6193 mle=1.6033 pcon=4.6405 forget=1.3755 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 42 it 170 total=7.6523 mle=1.6366 pcon=4.6404 forget=1.3753 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 42 it 220 total=7.7127 mle=1.6897 pcon=4.6403 forget=1.3826 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 42 it 270 total=7.8207 mle=1.7886 pcon=4.6402 forget=1.3919 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 42 it 320 total=7.8392 mle=1.8231 pcon=4.6400 forget=1.3760 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 42 it 370 total=7.4641 mle=1.4459 pcon=4.6399 forget=1.3783 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 43 it 30 total=7.8131 mle=1.7967 pcon=4.6399 forget=1.3766 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
[loss] ep 43 it 80 total=7.6606 mle=1.6430 pcon=4.6399 forget=1.3778 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 43 it 130 total=7.6652 mle=1.6460 pcon=4.6398 forget=1.3794 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 43 it 180 total=7.7427 mle=1.7247 pcon=4.6398 forget=1.3782 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 43 it 230 total=7.7746 mle=1.7639 pcon=4.6397 forget=1.3711 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 43 it 280 total=7.8230 mle=1.8124 pcon=4.6397 forget=1.3709 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 43 it 330 total=7.7515 mle=1.7204 pcon=4.6396 forget=1.3915 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 43 it 380 total=7.6134 mle=1.6000 pcon=4.6398 forget=1.3737 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 44 it 40 total=7.6641 mle=1.6453 pcon=4.6398 forget=1.3790 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 44 it 90 total=7.7511 mle=1.7393 pcon=4.6398 forget=1.3720 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 44 it 140 total=7.6732 mle=1.6547 pcon=4.6397 forget=1.3788 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 44 it 190 total=7.7293 mle=1.7125 pcon=4.6397 forget=1.3771 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 44 it 240 total=7.6016 mle=1.5803 pcon=4.6397 forget=1.3816 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 44 it 290 total=7.6903 mle=1.6748 pcon=4.6397 forget=1.3759 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 44 it 340 total=7.6126 mle=1.6040 pcon=4.6397 forget=1.3689 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 0 total=7.5983 mle=1.5838 pcon=4.6397 forget=1.3749 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
 92%|█████████▏| 46/50 [32:31<02:40, 40.06s/it] 94%|█████████▍| 47/50 [33:02<01:52, 37.59s/it] 96%|█████████▌| 48/50 [33:33<01:11, 35.51s/it] 98%|█████████▊| 49/50 [34:03<00:33, 33.95s/it]100%|██████████| 50/50 [34:35<00:00, 33.32s/it]100%|██████████| 50/50 [34:35<00:00, 41.52s/it]
[loss] ep 45 it 50 total=7.7692 mle=1.7547 pcon=4.6396 forget=1.3749 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 45 it 100 total=7.8335 mle=1.8199 pcon=4.6398 forget=1.3739 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 150 total=7.6735 mle=1.6551 pcon=4.6398 forget=1.3787 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 45 it 200 total=7.7537 mle=1.7396 pcon=4.6397 forget=1.3744 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 45 it 250 total=7.7034 mle=1.6966 pcon=4.6397 forget=1.3671 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 45 it 300 total=7.5845 mle=1.5613 pcon=4.6397 forget=1.3835 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 45 it 350 total=7.7092 mle=1.6864 pcon=4.6397 forget=1.3831 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 46 it 10 total=7.6343 mle=1.6171 pcon=4.6398 forget=1.3774 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 46 it 60 total=7.7357 mle=1.7215 pcon=4.6399 forget=1.3744 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 46 it 110 total=7.7377 mle=1.7153 pcon=4.6399 forget=1.3825 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 46 it 160 total=7.6318 mle=1.6125 pcon=4.6398 forget=1.3795 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 46 it 210 total=7.7405 mle=1.7228 pcon=4.6397 forget=1.3780 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 46 it 260 total=7.5942 mle=1.5733 pcon=4.6395 forget=1.3814 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 46 it 310 total=7.6573 mle=1.6386 pcon=4.6395 forget=1.3792 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 46 it 360 total=7.7303 mle=1.7145 pcon=4.6395 forget=1.3763 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 47 it 20 total=7.9720 mle=1.9503 pcon=4.6394 forget=1.3822 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 47 it 70 total=7.5595 mle=1.5470 pcon=4.6395 forget=1.3730 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 47 it 120 total=7.8195 mle=1.7952 pcon=4.6395 forget=1.3848 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 47 it 170 total=7.6708 mle=1.6558 pcon=4.6393 forget=1.3756 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 47 it 220 total=7.7191 mle=1.7049 pcon=4.6393 forget=1.3750 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 47 it 270 total=7.7794 mle=1.7531 pcon=4.6392 forget=1.3871 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 47 it 320 total=7.5940 mle=1.5750 pcon=4.6392 forget=1.3798 orth=0.0000 favg=0.0000 nr=57 nf=57 protos=540 fproto_sim=NA
[loss] ep 47 it 370 total=7.7975 mle=1.7777 pcon=4.6391 forget=1.3807 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 48 it 30 total=7.7043 mle=1.6924 pcon=4.6391 forget=1.3728 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 48 it 80 total=7.8281 mle=1.8154 pcon=4.6391 forget=1.3735 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 130 total=7.5262 mle=1.5104 pcon=4.6391 forget=1.3767 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 180 total=7.6352 mle=1.6194 pcon=4.6393 forget=1.3765 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 230 total=7.7101 mle=1.7001 pcon=4.6392 forget=1.3709 orth=0.0000 favg=0.0000 nr=60 nf=60 protos=540 fproto_sim=NA
[loss] ep 48 it 280 total=7.7534 mle=1.7355 pcon=4.6391 forget=1.3788 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 48 it 330 total=7.6954 mle=1.6818 pcon=4.6390 forget=1.3745 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 48 it 380 total=7.7133 mle=1.7020 pcon=4.6390 forget=1.3722 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 49 it 40 total=7.7572 mle=1.7416 pcon=4.6389 forget=1.3766 orth=0.0000 favg=0.0000 nr=59 nf=59 protos=540 fproto_sim=NA
[loss] ep 49 it 90 total=7.8164 mle=1.8088 pcon=4.6390 forget=1.3686 orth=0.0000 favg=0.0000 nr=58 nf=58 protos=540 fproto_sim=NA
[loss] ep 49 it 140 total=7.6651 mle=1.6528 pcon=4.6390 forget=1.3733 orth=0.0000 favg=0.0000 nr=62 nf=62 protos=540 fproto_sim=NA
[loss] ep 49 it 190 total=7.8451 mle=1.8263 pcon=4.6392 forget=1.3797 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 49 it 240 total=7.5747 mle=1.5611 pcon=4.6392 forget=1.3744 orth=0.0000 favg=0.0000 nr=61 nf=61 protos=540 fproto_sim=NA
[loss] ep 49 it 290 total=7.7797 mle=1.7658 pcon=4.6393 forget=1.3746 orth=0.0000 favg=0.0000 nr=64 nf=64 protos=540 fproto_sim=NA
[loss] ep 49 it 340 total=7.7056 mle=1.6937 pcon=4.6393 forget=1.3727 orth=0.0000 favg=0.0000 nr=63 nf=63 protos=540 fproto_sim=NA
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc1: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:47,  1.72it/s]  2%|▏         | 8/391 [00:00<00:25, 14.98it/s]  4%|▍         | 16/391 [00:00<00:12, 28.86it/s]  6%|▋         | 25/391 [00:00<00:08, 42.51it/s]  8%|▊         | 33/391 [00:01<00:07, 50.58it/s] 10%|█         | 40/391 [00:01<00:07, 47.99it/s] 12%|█▏        | 48/391 [00:01<00:06, 54.62it/s] 14%|█▍        | 55/391 [00:01<00:06, 55.67it/s] 16%|█▋        | 64/391 [00:01<00:05, 63.88it/s] 19%|█▊        | 73/391 [00:01<00:04, 69.40it/s] 21%|██        | 81/391 [00:01<00:04, 71.98it/s] 23%|██▎       | 89/391 [00:01<00:04, 74.12it/s] 25%|██▍       | 97/391 [00:01<00:04, 62.05it/s] 27%|██▋       | 105/391 [00:02<00:04, 64.24it/s] 29%|██▊       | 112/391 [00:02<00:04, 61.83it/s] 31%|███       | 121/391 [00:02<00:03, 67.98it/s] 33%|███▎      | 130/391 [00:02<00:03, 73.04it/s] 36%|███▌      | 139/391 [00:02<00:03, 76.42it/s] 38%|███▊      | 147/391 [00:02<00:03, 71.29it/s] 40%|███▉      | 155/391 [00:02<00:03, 63.43it/s] 41%|████▏     | 162/391 [00:02<00:03, 64.56it/s] 43%|████▎     | 169/391 [00:03<00:03, 64.32it/s] 46%|████▌     | 178/391 [00:03<00:03, 68.55it/s] 48%|████▊     | 186/391 [00:03<00:02, 70.97it/s] 50%|████▉     | 194/391 [00:03<00:03, 65.57it/s] 51%|█████▏    | 201/391 [00:03<00:03, 60.77it/s] 53%|█████▎    | 209/391 [00:03<00:02, 64.10it/s] 55%|█████▌    | 216/391 [00:03<00:02, 61.38it/s] 58%|█████▊    | 225/391 [00:03<00:02, 67.10it/s] 60%|█████▉    | 234/391 [00:03<00:02, 72.32it/s] 62%|██████▏   | 243/391 [00:04<00:01, 76.12it/s] 64%|██████▍   | 251/391 [00:04<00:01, 71.60it/s] 66%|██████▌   | 259/391 [00:04<00:02, 64.39it/s] 69%|██████▊   | 268/391 [00:04<00:01, 67.93it/s] 70%|███████   | 275/391 [00:04<00:01, 65.23it/s] 72%|███████▏  | 283/391 [00:04<00:01, 67.64it/s] 75%|███████▍  | 292/391 [00:04<00:01, 71.91it/s] 77%|███████▋  | 300/391 [00:04<00:01, 69.24it/s] 79%|███████▉  | 308/391 [00:05<00:01, 61.04it/s] 81%|████████  | 317/391 [00:05<00:01, 64.99it/s] 83%|████████▎ | 324/391 [00:05<00:01, 63.44it/s] 85%|████████▌ | 333/391 [00:05<00:00, 69.52it/s] 87%|████████▋ | 342/391 [00:05<00:00, 74.04it/s] 90%|████████▉ | 350/391 [00:05<00:00, 75.22it/s] 92%|█████████▏| 358/391 [00:05<00:00, 72.79it/s] 94%|█████████▎| 366/391 [00:05<00:00, 61.89it/s] 96%|█████████▌| 375/391 [00:06<00:00, 66.64it/s] 98%|█████████▊| 382/391 [00:06<00:00, 65.78it/s]100%|██████████| 391/391 [00:06<00:00, 68.47it/s]100%|██████████| 391/391 [00:06<00:00, 61.86it/s]
50000 images processed, 6.444344997406006 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:01,  1.26it/s] 10%|█         | 8/79 [00:00<00:06, 11.46it/s] 16%|█▋        | 13/79 [00:01<00:03, 17.64it/s] 25%|██▌       | 20/79 [00:01<00:02, 27.58it/s] 33%|███▎      | 26/79 [00:01<00:01, 33.51it/s] 43%|████▎     | 34/79 [00:01<00:01, 43.90it/s] 53%|█████▎    | 42/79 [00:01<00:00, 52.09it/s] 63%|██████▎   | 50/79 [00:01<00:00, 58.81it/s] 72%|███████▏  | 57/79 [00:01<00:00, 54.38it/s] 81%|████████  | 64/79 [00:01<00:00, 56.60it/s] 90%|████████▉ | 71/79 [00:01<00:00, 58.56it/s] 99%|█████████▊| 78/79 [00:02<00:00, 61.47it/s]100%|██████████| 79/79 [00:02<00:00, 38.37it/s]
10000 images processed, 2.090643882751465 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc1/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<03:04,  1.10it/s]  5%|▍         | 10/204 [00:01<00:14, 13.04it/s]  9%|▉         | 19/204 [00:01<00:07, 25.17it/s] 13%|█▎        | 26/204 [00:01<00:05, 29.76it/s] 16%|█▌        | 33/204 [00:01<00:04, 36.78it/s] 19%|█▉        | 39/204 [00:01<00:04, 40.45it/s] 23%|██▎       | 47/204 [00:01<00:03, 49.13it/s] 27%|██▋       | 55/204 [00:01<00:02, 55.73it/s] 30%|███       | 62/204 [00:01<00:02, 50.81it/s] 33%|███▎      | 68/204 [00:01<00:02, 52.58it/s] 36%|███▋      | 74/204 [00:02<00:02, 53.79it/s] 41%|████      | 83/204 [00:02<00:01, 63.02it/s] 45%|████▍     | 91/204 [00:02<00:01, 66.94it/s] 49%|████▊     | 99/204 [00:02<00:01, 70.17it/s] 52%|█████▏    | 107/204 [00:02<00:01, 59.85it/s] 56%|█████▌    | 114/204 [00:02<00:01, 61.55it/s] 59%|█████▉    | 121/204 [00:02<00:01, 58.22it/s] 64%|██████▎   | 130/204 [00:02<00:01, 65.17it/s] 68%|██████▊   | 139/204 [00:03<00:00, 71.06it/s] 73%|███████▎  | 148/204 [00:03<00:00, 73.83it/s] 76%|███████▋  | 156/204 [00:03<00:00, 66.58it/s] 80%|███████▉  | 163/204 [00:03<00:00, 62.36it/s] 84%|████████▍ | 171/204 [00:03<00:00, 63.93it/s] 87%|████████▋ | 178/204 [00:03<00:00, 62.84it/s] 92%|█████████▏| 187/204 [00:03<00:00, 69.64it/s] 96%|█████████▌| 196/204 [00:03<00:00, 74.82it/s]100%|██████████| 204/204 [00:03<00:00, 51.52it/s]
26032 images processed, 4.0076000690460205 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:01<01:20,  1.04s/it] 13%|█▎        | 10/79 [00:01<00:05, 11.53it/s] 23%|██▎       | 18/79 [00:01<00:02, 21.27it/s] 34%|███▍      | 27/79 [00:01<00:01, 32.57it/s] 43%|████▎     | 34/79 [00:01<00:01, 36.41it/s] 52%|█████▏    | 41/79 [00:01<00:00, 41.05it/s] 61%|██████    | 48/79 [00:01<00:00, 45.74it/s] 71%|███████   | 56/79 [00:01<00:00, 53.12it/s] 82%|████████▏ | 65/79 [00:01<00:00, 61.71it/s] 94%|█████████▎| 74/79 [00:02<00:00, 68.09it/s]100%|██████████| 79/79 [00:02<00:00, 37.24it/s]
10000 images processed, 2.1676063537597656 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:04,  1.21it/s]  6%|▋         | 5/79 [00:00<00:10,  6.87it/s] 16%|█▋        | 13/79 [00:01<00:03, 18.98it/s] 24%|██▍       | 19/79 [00:01<00:02, 26.69it/s] 34%|███▍      | 27/79 [00:01<00:01, 37.45it/s] 46%|████▌     | 36/79 [00:01<00:00, 49.06it/s] 57%|█████▋    | 45/79 [00:01<00:00, 57.78it/s] 67%|██████▋   | 53/79 [00:01<00:00, 53.63it/s] 77%|███████▋  | 61/79 [00:01<00:00, 58.50it/s] 86%|████████▌ | 68/79 [00:01<00:00, 58.04it/s] 97%|█████████▋| 77/79 [00:01<00:00, 65.33it/s]100%|██████████| 79/79 [00:01<00:00, 39.51it/s]
10000 images processed, 2.0199854373931885 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:56,  1.23it/s]  6%|▌         | 4/70 [00:00<00:11,  5.50it/s] 19%|█▊        | 13/70 [00:01<00:02, 20.26it/s] 30%|███       | 21/70 [00:01<00:01, 32.19it/s] 43%|████▎     | 30/70 [00:01<00:00, 44.14it/s] 53%|█████▎    | 37/70 [00:01<00:00, 46.07it/s] 63%|██████▎   | 44/70 [00:01<00:00, 47.56it/s] 73%|███████▎  | 51/70 [00:01<00:00, 52.86it/s] 83%|████████▎ | 58/70 [00:01<00:00, 56.82it/s] 96%|█████████▌| 67/70 [00:01<00:00, 65.28it/s]100%|██████████| 70/70 [00:01<00:00, 37.88it/s]
8925 images processed, 1.885268211364746 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:56,  1.29s/it]  4%|▍         | 2/45 [00:01<00:28,  1.50it/s] 16%|█▌        | 7/45 [00:01<00:05,  6.77it/s] 36%|███▌      | 16/45 [00:01<00:01, 17.97it/s] 47%|████▋     | 21/45 [00:02<00:01, 16.65it/s] 56%|█████▌    | 25/45 [00:02<00:01, 18.62it/s] 67%|██████▋   | 30/45 [00:02<00:00, 22.28it/s] 76%|███████▌  | 34/45 [00:02<00:00, 15.72it/s] 93%|█████████▎| 42/45 [00:02<00:00, 22.80it/s]100%|██████████| 45/45 [00:03<00:00, 14.94it/s]
5640 images processed, 3.0370123386383057 seconds used

23.5510196685791
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           7.04  98.45
places365     75.68  77.74
LSUN          44.42  87.13
iSUN          79.78  77.44
dtd           49.38  88.38
AVG           51.26  85.83
Retain-Acc: 0.7281
Forget-as-OOD (retain known vs forget novel):
  FPR: 42.00 AUROC: 89.11 AUIN: 99.26
32.09877967834473
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc1_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc1_rf.png
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc2: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<03:17,  1.98it/s]  2%|▏         | 9/391 [00:00<00:20, 18.88it/s]  4%|▍         | 17/391 [00:00<00:11, 33.32it/s]  7%|▋         | 26/391 [00:00<00:07, 46.62it/s]  8%|▊         | 33/391 [00:00<00:07, 49.57it/s] 10%|█         | 40/391 [00:01<00:07, 49.46it/s] 13%|█▎        | 49/391 [00:01<00:05, 58.29it/s] 14%|█▍        | 56/391 [00:01<00:05, 58.02it/s] 17%|█▋        | 65/391 [00:01<00:04, 65.35it/s] 19%|█▊        | 73/391 [00:01<00:04, 68.34it/s] 21%|██        | 82/391 [00:01<00:04, 73.26it/s] 23%|██▎       | 90/391 [00:01<00:04, 63.99it/s] 25%|██▍       | 97/391 [00:01<00:04, 63.55it/s] 27%|██▋       | 105/391 [00:02<00:04, 63.99it/s] 29%|██▊       | 112/391 [00:02<00:04, 62.40it/s] 31%|███       | 121/391 [00:02<00:03, 68.32it/s] 33%|███▎      | 130/391 [00:02<00:03, 72.98it/s] 36%|███▌      | 139/391 [00:02<00:03, 75.44it/s] 38%|███▊      | 147/391 [00:02<00:03, 64.10it/s] 39%|███▉      | 154/391 [00:02<00:03, 63.55it/s] 41%|████      | 161/391 [00:02<00:03, 60.63it/s] 43%|████▎     | 170/391 [00:02<00:03, 66.48it/s] 46%|████▌     | 178/391 [00:03<00:03, 69.75it/s] 48%|████▊     | 186/391 [00:03<00:03, 67.77it/s] 49%|████▉     | 193/391 [00:03<00:03, 59.76it/s] 52%|█████▏    | 203/391 [00:03<00:02, 66.93it/s] 54%|█████▎    | 210/391 [00:03<00:02, 63.87it/s] 56%|█████▌    | 219/391 [00:03<00:02, 68.71it/s] 58%|█████▊    | 227/391 [00:03<00:02, 69.40it/s] 60%|██████    | 235/391 [00:03<00:02, 63.77it/s] 62%|██████▏   | 242/391 [00:04<00:02, 59.07it/s] 64%|██████▎   | 249/391 [00:04<00:02, 58.49it/s] 66%|██████▌   | 258/391 [00:04<00:02, 64.78it/s] 68%|██████▊   | 267/391 [00:04<00:01, 70.40it/s] 71%|███████   | 276/391 [00:04<00:01, 73.85it/s] 73%|███████▎  | 284/391 [00:04<00:01, 64.45it/s] 74%|███████▍  | 291/391 [00:04<00:01, 64.30it/s] 76%|███████▌  | 298/391 [00:04<00:01, 60.82it/s] 78%|███████▊  | 306/391 [00:05<00:01, 65.01it/s] 81%|████████  | 315/391 [00:05<00:01, 70.21it/s] 83%|████████▎ | 323/391 [00:05<00:00, 72.00it/s] 85%|████████▍ | 331/391 [00:05<00:00, 60.40it/s] 87%|████████▋ | 339/391 [00:05<00:00, 64.45it/s] 88%|████████▊ | 346/391 [00:05<00:00, 60.32it/s] 91%|█████████ | 354/391 [00:05<00:00, 64.13it/s] 93%|█████████▎| 362/391 [00:05<00:00, 67.17it/s] 95%|█████████▍| 371/391 [00:06<00:00, 71.31it/s] 97%|█████████▋| 379/391 [00:06<00:00, 61.60it/s] 99%|█████████▉| 388/391 [00:06<00:00, 67.88it/s]100%|██████████| 391/391 [00:06<00:00, 61.31it/s]
50000 images processed, 6.506408214569092 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:41,  1.87it/s] 10%|█         | 8/79 [00:00<00:04, 15.94it/s] 22%|██▏       | 17/79 [00:00<00:01, 32.14it/s] 33%|███▎      | 26/79 [00:00<00:01, 45.31it/s] 44%|████▍     | 35/79 [00:00<00:00, 54.28it/s] 54%|█████▍    | 43/79 [00:01<00:00, 50.20it/s] 66%|██████▌   | 52/79 [00:01<00:00, 58.54it/s] 75%|███████▍  | 59/79 [00:01<00:00, 57.38it/s] 86%|████████▌ | 68/79 [00:01<00:00, 64.99it/s] 97%|█████████▋| 77/79 [00:01<00:00, 70.91it/s]100%|██████████| 79/79 [00:01<00:00, 48.36it/s]
10000 images processed, 1.659785270690918 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc2/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<02:03,  1.64it/s]  3%|▎         | 6/204 [00:00<00:18, 10.83it/s]  7%|▋         | 15/204 [00:00<00:06, 27.16it/s] 12%|█▏        | 24/204 [00:00<00:04, 41.18it/s] 16%|█▌        | 33/204 [00:01<00:03, 52.39it/s] 21%|██        | 42/204 [00:01<00:02, 60.61it/s] 25%|██▍       | 50/204 [00:01<00:02, 52.50it/s] 28%|██▊       | 58/204 [00:01<00:02, 56.00it/s] 32%|███▏      | 66/204 [00:01<00:02, 60.56it/s] 37%|███▋      | 75/204 [00:01<00:01, 67.40it/s] 41%|████      | 84/204 [00:01<00:01, 72.55it/s] 46%|████▌     | 93/204 [00:01<00:01, 75.79it/s] 50%|████▉     | 101/204 [00:02<00:01, 68.53it/s] 53%|█████▎    | 109/204 [00:02<00:01, 63.40it/s] 57%|█████▋    | 116/204 [00:02<00:01, 60.22it/s] 61%|██████▏   | 125/204 [00:02<00:01, 65.30it/s] 66%|██████▌   | 134/204 [00:02<00:01, 69.50it/s] 70%|██████▉   | 142/204 [00:02<00:00, 63.51it/s] 73%|███████▎  | 149/204 [00:02<00:00, 60.44it/s] 76%|███████▋  | 156/204 [00:02<00:00, 57.96it/s] 80%|████████  | 164/204 [00:03<00:00, 62.08it/s] 84%|████████▍ | 172/204 [00:03<00:00, 64.08it/s] 88%|████████▊ | 179/204 [00:03<00:00, 55.67it/s] 92%|█████████▏| 188/204 [00:03<00:00, 63.36it/s] 97%|█████████▋| 197/204 [00:03<00:00, 67.95it/s]100%|██████████| 204/204 [00:03<00:00, 55.45it/s]
26032 images processed, 3.764575481414795 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:01<01:23,  1.07s/it]  9%|▉         | 7/79 [00:01<00:09,  7.75it/s] 15%|█▌        | 12/79 [00:01<00:04, 13.47it/s] 27%|██▋       | 21/79 [00:01<00:02, 25.95it/s] 34%|███▍      | 27/79 [00:01<00:01, 31.23it/s] 43%|████▎     | 34/79 [00:01<00:01, 39.23it/s] 53%|█████▎    | 42/79 [00:01<00:00, 47.42it/s] 62%|██████▏   | 49/79 [00:01<00:00, 47.63it/s] 70%|██████▉   | 55/79 [00:01<00:00, 48.77it/s] 77%|███████▋  | 61/79 [00:02<00:00, 50.28it/s] 87%|████████▋ | 69/79 [00:02<00:00, 57.15it/s] 99%|█████████▊| 78/79 [00:02<00:00, 64.48it/s]100%|██████████| 79/79 [00:02<00:00, 33.97it/s]
10000 images processed, 2.3868627548217773 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<01:13,  1.06it/s]  6%|▋         | 5/79 [00:01<00:12,  5.95it/s] 15%|█▌        | 12/79 [00:01<00:04, 15.76it/s] 27%|██▋       | 21/79 [00:01<00:02, 28.46it/s] 37%|███▋      | 29/79 [00:01<00:01, 38.46it/s] 46%|████▌     | 36/79 [00:01<00:01, 42.80it/s] 54%|█████▍    | 43/79 [00:01<00:00, 45.19it/s] 65%|██████▍   | 51/79 [00:01<00:00, 52.46it/s] 73%|███████▎  | 58/79 [00:01<00:00, 55.37it/s] 85%|████████▍ | 67/79 [00:01<00:00, 63.70it/s] 96%|█████████▌| 76/79 [00:02<00:00, 69.97it/s]100%|██████████| 79/79 [00:02<00:00, 37.49it/s]
10000 images processed, 2.168031692504883 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<01:02,  1.11it/s] 10%|█         | 7/70 [00:01<00:06,  9.08it/s] 17%|█▋        | 12/70 [00:01<00:03, 15.55it/s] 29%|██▊       | 20/70 [00:01<00:01, 27.50it/s] 40%|████      | 28/70 [00:01<00:01, 38.04it/s] 53%|█████▎    | 37/70 [00:01<00:00, 48.97it/s] 63%|██████▎   | 44/70 [00:01<00:00, 48.05it/s] 73%|███████▎  | 51/70 [00:01<00:00, 51.87it/s] 86%|████████▌ | 60/70 [00:01<00:00, 58.53it/s] 96%|█████████▌| 67/70 [00:01<00:00, 60.11it/s]100%|██████████| 70/70 [00:01<00:00, 35.56it/s]
8925 images processed, 2.0068421363830566 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:01<00:59,  1.35s/it]  4%|▍         | 2/45 [00:01<00:30,  1.42it/s] 24%|██▍       | 11/45 [00:01<00:03, 10.86it/s] 36%|███▌      | 16/45 [00:01<00:01, 15.89it/s] 47%|████▋     | 21/45 [00:02<00:01, 15.07it/s] 60%|██████    | 27/45 [00:02<00:00, 21.11it/s] 73%|███████▎  | 33/45 [00:02<00:00, 14.82it/s] 87%|████████▋ | 39/45 [00:03<00:00, 19.77it/s]100%|██████████| 45/45 [00:03<00:00, 14.58it/s]
5640 images processed, 3.1099038124084473 seconds used

23.501030206680298
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.60  98.76
places365     72.78  80.09
LSUN          21.66  95.81
iSUN          77.75  78.95
dtd           45.57  89.68
AVG           44.67  88.66
Retain-Acc: 0.7292
Forget-as-OOD (retain known vs forget novel):
  FPR: 46.00 AUROC: 91.97 AUIN: 99.52
41.83747339248657
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc2_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-inc2_rf.png
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Files already downloaded and verified
Files already downloaded and verified
ckpt loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-with-prototypes.pt
[peft] adapter loaded from checkpoints/CIFAR-100-resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stack/stage2
[peft] active adapters set to: default
resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-seen: Number of model parameters: 21843904
Processing in-distribution CIFAR-100 images
  0%|          | 0/391 [00:00<?, ?it/s]  0%|          | 1/391 [00:00<02:47,  2.33it/s]  3%|▎         | 11/391 [00:00<00:14, 26.21it/s]  5%|▌         | 20/391 [00:00<00:08, 42.37it/s]  8%|▊         | 30/391 [00:00<00:06, 56.77it/s] 10%|▉         | 39/391 [00:00<00:05, 65.78it/s] 13%|█▎        | 49/391 [00:00<00:04, 73.61it/s] 15%|█▌        | 59/391 [00:01<00:04, 79.87it/s] 18%|█▊        | 69/391 [00:01<00:03, 83.73it/s] 20%|██        | 79/391 [00:01<00:03, 85.06it/s] 23%|██▎       | 88/391 [00:01<00:03, 85.87it/s] 25%|██▍       | 97/391 [00:01<00:03, 86.60it/s] 27%|██▋       | 106/391 [00:01<00:03, 87.20it/s] 30%|██▉       | 116/391 [00:01<00:03, 89.88it/s] 32%|███▏      | 126/391 [00:01<00:02, 90.11it/s] 35%|███▍      | 136/391 [00:01<00:02, 89.13it/s] 37%|███▋      | 145/391 [00:02<00:02, 86.63it/s] 39%|███▉      | 154/391 [00:02<00:02, 85.77it/s] 42%|████▏     | 163/391 [00:02<00:02, 86.06it/s] 44%|████▍     | 172/391 [00:02<00:02, 84.39it/s] 46%|████▋     | 181/391 [00:02<00:02, 85.35it/s] 49%|████▊     | 190/391 [00:02<00:02, 84.82it/s] 51%|█████     | 199/391 [00:02<00:02, 75.03it/s] 53%|█████▎    | 208/391 [00:02<00:02, 76.80it/s] 55%|█████▌    | 217/391 [00:02<00:02, 78.98it/s] 58%|█████▊    | 226/391 [00:03<00:02, 79.47it/s] 60%|██████    | 235/391 [00:03<00:01, 79.31it/s] 62%|██████▏   | 243/391 [00:03<00:01, 74.95it/s] 64%|██████▍   | 251/391 [00:03<00:02, 65.01it/s] 66%|██████▌   | 259/391 [00:03<00:01, 68.64it/s] 68%|██████▊   | 267/391 [00:03<00:01, 67.26it/s] 70%|███████   | 275/391 [00:03<00:01, 70.25it/s] 73%|███████▎  | 284/391 [00:03<00:01, 74.75it/s] 75%|███████▍  | 293/391 [00:03<00:01, 78.39it/s] 77%|███████▋  | 302/391 [00:04<00:01, 80.55it/s] 80%|███████▉  | 311/391 [00:04<00:01, 69.68it/s] 82%|████████▏ | 319/391 [00:04<00:01, 65.49it/s] 83%|████████▎ | 326/391 [00:04<00:01, 64.89it/s] 85%|████████▌ | 333/391 [00:04<00:00, 63.85it/s] 87%|████████▋ | 341/391 [00:04<00:00, 66.65it/s] 90%|████████▉ | 350/391 [00:04<00:00, 70.34it/s] 92%|█████████▏| 358/391 [00:04<00:00, 66.60it/s] 93%|█████████▎| 365/391 [00:05<00:00, 59.87it/s] 95%|█████████▌| 372/391 [00:05<00:00, 62.11it/s] 97%|█████████▋| 380/391 [00:05<00:00, 64.95it/s]100%|█████████▉| 390/391 [00:05<00:00, 72.26it/s]100%|██████████| 391/391 [00:05<00:00, 71.49it/s]
50000 images processed, 5.589549541473389 seconds used

Processing in-distribution CIFAR-100 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:33,  2.30it/s]  9%|▉         | 7/79 [00:00<00:04, 16.14it/s] 19%|█▉        | 15/79 [00:00<00:02, 30.99it/s] 25%|██▌       | 20/79 [00:00<00:01, 34.74it/s] 33%|███▎      | 26/79 [00:00<00:01, 39.71it/s] 39%|███▉      | 31/79 [00:00<00:01, 41.96it/s] 49%|████▉     | 39/79 [00:01<00:00, 51.12it/s] 58%|█████▊    | 46/79 [00:01<00:00, 56.12it/s] 68%|██████▊   | 54/79 [00:01<00:00, 62.18it/s] 77%|███████▋  | 61/79 [00:01<00:00, 55.63it/s] 87%|████████▋ | 69/79 [00:01<00:00, 60.95it/s] 96%|█████████▌| 76/79 [00:01<00:00, 58.94it/s]100%|██████████| 79/79 [00:01<00:00, 45.09it/s]
10000 images processed, 1.7920174598693848 seconds used

Saved forget OOD features to cache/resnet34-top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-seen/CIFAR-100/forget
Processing out-of-distribution SVHN images
  0%|          | 0/204 [00:00<?, ?it/s]  0%|          | 1/204 [00:00<01:52,  1.81it/s]  5%|▍         | 10/204 [00:00<00:09, 19.73it/s]  8%|▊         | 16/204 [00:00<00:06, 27.57it/s] 12%|█▏        | 25/204 [00:00<00:04, 41.38it/s] 16%|█▌        | 33/204 [00:00<00:03, 50.72it/s] 21%|██        | 42/204 [00:01<00:02, 60.43it/s] 25%|██▍       | 50/204 [00:01<00:02, 60.77it/s] 28%|██▊       | 58/204 [00:01<00:02, 56.07it/s] 32%|███▏      | 65/204 [00:01<00:02, 55.42it/s] 36%|███▌      | 73/204 [00:01<00:02, 60.55it/s] 40%|████      | 82/204 [00:01<00:01, 67.62it/s] 44%|████▍     | 90/204 [00:01<00:01, 66.81it/s] 48%|████▊     | 97/204 [00:02<00:01, 58.90it/s] 52%|█████▏    | 107/204 [00:02<00:01, 66.56it/s] 56%|█████▌    | 114/204 [00:02<00:01, 63.38it/s] 60%|██████    | 123/204 [00:02<00:01, 69.22it/s] 65%|██████▍   | 132/204 [00:02<00:00, 74.19it/s] 69%|██████▉   | 141/204 [00:02<00:00, 76.32it/s] 73%|███████▎  | 149/204 [00:02<00:00, 76.69it/s] 77%|███████▋  | 157/204 [00:02<00:00, 62.21it/s] 81%|████████  | 165/204 [00:02<00:00, 64.71it/s] 84%|████████▍ | 172/204 [00:03<00:00, 61.86it/s] 89%|████████▊ | 181/204 [00:03<00:00, 68.63it/s] 93%|█████████▎| 190/204 [00:03<00:00, 74.15it/s] 98%|█████████▊| 199/204 [00:03<00:00, 78.28it/s]100%|██████████| 204/204 [00:03<00:00, 58.98it/s]
26032 images processed, 3.508378505706787 seconds used

Processing out-of-distribution places365 images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:48,  1.62it/s]  6%|▋         | 5/79 [00:00<00:08,  8.45it/s] 14%|█▍        | 11/79 [00:00<00:03, 18.84it/s] 22%|██▏       | 17/79 [00:00<00:02, 27.65it/s] 32%|███▏      | 25/79 [00:01<00:01, 39.91it/s] 43%|████▎     | 34/79 [00:01<00:00, 52.19it/s] 54%|█████▍    | 43/79 [00:01<00:00, 61.37it/s] 66%|██████▌   | 52/79 [00:01<00:00, 68.44it/s] 77%|███████▋  | 61/79 [00:01<00:00, 70.26it/s] 87%|████████▋ | 69/79 [00:01<00:00, 60.40it/s] 97%|█████████▋| 77/79 [00:01<00:00, 65.16it/s]100%|██████████| 79/79 [00:01<00:00, 44.00it/s]
10000 images processed, 1.8243093490600586 seconds used

Processing out-of-distribution LSUN images
  0%|          | 0/79 [00:00<?, ?it/s]  1%|▏         | 1/79 [00:00<00:41,  1.89it/s] 11%|█▏        | 9/79 [00:00<00:03, 18.16it/s] 23%|██▎       | 18/79 [00:00<00:01, 34.35it/s] 32%|███▏      | 25/79 [00:00<00:01, 37.10it/s] 42%|████▏     | 33/79 [00:01<00:01, 44.27it/s] 49%|████▉     | 39/79 [00:01<00:00, 47.69it/s] 59%|█████▉    | 47/79 [00:01<00:00, 55.50it/s] 71%|███████   | 56/79 [00:01<00:00, 64.23it/s] 82%|████████▏ | 65/79 [00:01<00:00, 71.03it/s] 94%|█████████▎| 74/79 [00:01<00:00, 76.17it/s]100%|██████████| 79/79 [00:01<00:00, 48.48it/s]
10000 images processed, 1.6499581336975098 seconds used

Processing out-of-distribution iSUN images
  0%|          | 0/70 [00:00<?, ?it/s]  1%|▏         | 1/70 [00:00<00:33,  2.08it/s]  9%|▊         | 6/70 [00:00<00:05, 12.75it/s] 16%|█▌        | 11/70 [00:00<00:02, 21.59it/s] 27%|██▋       | 19/70 [00:00<00:01, 35.75it/s] 40%|████      | 28/70 [00:00<00:00, 49.39it/s] 51%|█████▏    | 36/70 [00:01<00:00, 57.41it/s] 61%|██████▏   | 43/70 [00:01<00:00, 54.32it/s] 71%|███████▏  | 50/70 [00:01<00:00, 55.82it/s] 81%|████████▏ | 57/70 [00:01<00:00, 55.54it/s] 94%|█████████▍| 66/70 [00:01<00:00, 64.27it/s]100%|██████████| 70/70 [00:01<00:00, 45.10it/s]
8925 images processed, 1.5878324508666992 seconds used

Processing out-of-distribution dtd images
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:41,  1.05it/s]  4%|▍         | 2/45 [00:01<00:21,  2.00it/s] 16%|█▌        | 7/45 [00:01<00:04,  8.76it/s] 27%|██▋       | 12/45 [00:01<00:02, 15.20it/s] 38%|███▊      | 17/45 [00:01<00:01, 19.28it/s] 44%|████▍     | 20/45 [00:01<00:01, 17.62it/s] 51%|█████     | 23/45 [00:01<00:01, 17.17it/s] 64%|██████▍   | 29/45 [00:02<00:00, 24.66it/s] 73%|███████▎  | 33/45 [00:02<00:00, 21.71it/s] 80%|████████  | 36/45 [00:02<00:00, 19.50it/s]100%|██████████| 45/45 [00:02<00:00, 31.85it/s]100%|██████████| 45/45 [00:02<00:00, 17.37it/s]
5640 images processed, 2.610399007797241 seconds used

20.34480357170105
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
/home/shaokun/anaconda3/envs/PPALM/lib/python3.10/site-packages/umap/umap_.py:1952: UserWarning: n_jobs value 1 overridden to 1 by setting random_state. Use no seed for parallelism.
  warn(
Evaluating SVHN
Evaluating places365
Evaluating LSUN
Evaluating iSUN
Evaluating dtd
 OOD detection method: SSD+
              FPR    AUROC  AUIN  
SVHN           5.70  98.74
places365     73.23  79.90
LSUN          22.63  95.67
iSUN          78.23  78.54
dtd           46.37  89.52
AVG           45.23  88.47
Retain-Acc: 0.7328
Forget-as-OOD (retain known vs forget novel):
  FPR: 43.40 AUROC: 90.85 AUIN: 98.79
42.9202196598053
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-seen_domain.png
[umap] saved to figs/umap_CIFAR-100_resnet34_top5-palm-cache6-ema0.999-b128-e50-lr0.001-wd1e-4-ltboth-bfmbalanced-fl0.2-lora_r8a32d0.05-temp0.08-stage2-seen_rf.png
